nohup: ignoring input
Seed: 42
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_96       Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.7824656
	speed: 0.0415s/iter; left time: 471.8480s
	iters: 200, epoch: 1 | loss: 0.3582357
	speed: 0.0310s/iter; left time: 349.7153s
	iters: 300, epoch: 1 | loss: 0.5502912
	speed: 0.0289s/iter; left time: 322.7228s
	iters: 400, epoch: 1 | loss: 0.2928463
	speed: 0.0278s/iter; left time: 307.5962s
	iters: 500, epoch: 1 | loss: 0.3576382
	speed: 0.0271s/iter; left time: 297.7667s
	iters: 600, epoch: 1 | loss: 0.2966831
	speed: 0.0267s/iter; left time: 289.7707s
	iters: 700, epoch: 1 | loss: 0.4490575
	speed: 0.0263s/iter; left time: 283.4709s
	iters: 800, epoch: 1 | loss: 0.3392016
	speed: 0.0260s/iter; left time: 277.3758s
	iters: 900, epoch: 1 | loss: 0.3288089
	speed: 0.0258s/iter; left time: 272.6786s
	iters: 1000, epoch: 1 | loss: 0.3826259
	speed: 0.0256s/iter; left time: 268.4271s
	iters: 1100, epoch: 1 | loss: 0.3879690
	speed: 0.0255s/iter; left time: 264.4428s
Epoch: 1 cost time: 29.296435594558716
Epoch: 1, Steps: 1147 | Train Loss: 0.4971809 Vali Loss: 0.4342107 Test Loss: 0.1836109
Validation loss decreased (inf --> 0.434211).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4435616
	speed: 0.0265s/iter; left time: 271.1111s
	iters: 200, epoch: 2 | loss: 0.3426061
	speed: 0.0243s/iter; left time: 245.7514s
	iters: 300, epoch: 2 | loss: 0.5199605
	speed: 0.0236s/iter; left time: 236.4170s
	iters: 400, epoch: 2 | loss: 0.3463661
	speed: 0.0233s/iter; left time: 231.0023s
	iters: 500, epoch: 2 | loss: 0.3288127
	speed: 0.0237s/iter; left time: 233.2136s
	iters: 600, epoch: 2 | loss: 0.4107187
	speed: 0.0239s/iter; left time: 232.2251s
	iters: 700, epoch: 2 | loss: 0.3294517
	speed: 0.0240s/iter; left time: 231.1242s
	iters: 800, epoch: 2 | loss: 1.1089914
	speed: 0.0241s/iter; left time: 229.5722s
	iters: 900, epoch: 2 | loss: 0.4001588
	speed: 0.0242s/iter; left time: 227.7719s
	iters: 1000, epoch: 2 | loss: 0.2758092
	speed: 0.0242s/iter; left time: 225.6813s
	iters: 1100, epoch: 2 | loss: 0.3341279
	speed: 0.0243s/iter; left time: 223.7089s
Epoch: 2 cost time: 27.975038051605225
Epoch: 2, Steps: 1147 | Train Loss: 0.4511385 Vali Loss: 0.4341208 Test Loss: 0.1790424
Validation loss decreased (0.434211 --> 0.434121).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 1.2185652
	speed: 0.0230s/iter; left time: 208.3974s
	iters: 200, epoch: 3 | loss: 0.4473268
	speed: 0.0211s/iter; left time: 189.0801s
	iters: 300, epoch: 3 | loss: 0.2818884
	speed: 0.0208s/iter; left time: 184.4234s
	iters: 400, epoch: 3 | loss: 0.3198118
	speed: 0.0221s/iter; left time: 194.0558s
	iters: 500, epoch: 3 | loss: 0.5275287
	speed: 0.0230s/iter; left time: 199.3137s
	iters: 600, epoch: 3 | loss: 0.3312829
	speed: 0.0244s/iter; left time: 209.5829s
	iters: 700, epoch: 3 | loss: 0.6288927
	speed: 0.0247s/iter; left time: 209.3312s
	iters: 800, epoch: 3 | loss: 0.4050891
	speed: 0.0259s/iter; left time: 217.2006s
	iters: 900, epoch: 3 | loss: 1.2188931
	speed: 0.0258s/iter; left time: 213.6644s
	iters: 1000, epoch: 3 | loss: 0.4095501
	speed: 0.0257s/iter; left time: 210.0110s
	iters: 1100, epoch: 3 | loss: 0.2429654
	speed: 0.0255s/iter; left time: 206.2985s
Epoch: 3 cost time: 29.366185426712036
Epoch: 3, Steps: 1147 | Train Loss: 0.4310687 Vali Loss: 0.4425396 Test Loss: 0.1775255
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3806880
	speed: 0.0167s/iter; left time: 132.6694s
	iters: 200, epoch: 4 | loss: 0.2536792
	speed: 0.0157s/iter; left time: 122.8833s
	iters: 300, epoch: 4 | loss: 0.4231600
	speed: 0.0175s/iter; left time: 135.5323s
	iters: 400, epoch: 4 | loss: 0.3303947
	speed: 0.0182s/iter; left time: 138.8038s
	iters: 500, epoch: 4 | loss: 0.3582715
	speed: 0.0198s/iter; left time: 148.9552s
	iters: 600, epoch: 4 | loss: 1.2481313
	speed: 0.0194s/iter; left time: 143.8019s
	iters: 700, epoch: 4 | loss: 1.0601763
	speed: 0.0194s/iter; left time: 142.0550s
	iters: 800, epoch: 4 | loss: 0.3650142
	speed: 0.0201s/iter; left time: 144.9902s
	iters: 900, epoch: 4 | loss: 0.2679131
	speed: 0.0206s/iter; left time: 146.6606s
	iters: 1000, epoch: 4 | loss: 1.2756411
	speed: 0.0210s/iter; left time: 147.5899s
	iters: 1100, epoch: 4 | loss: 0.3043012
	speed: 0.0213s/iter; left time: 147.8353s
Epoch: 4 cost time: 24.741626262664795
Epoch: 4, Steps: 1147 | Train Loss: 0.4199984 Vali Loss: 0.4282989 Test Loss: 0.1741749
Validation loss decreased (0.434121 --> 0.428299).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2949955
	speed: 0.0257s/iter; left time: 174.3200s
	iters: 200, epoch: 5 | loss: 1.2849829
	speed: 0.0225s/iter; left time: 150.7014s
	iters: 300, epoch: 5 | loss: 0.2717600
	speed: 0.0216s/iter; left time: 141.9751s
	iters: 400, epoch: 5 | loss: 0.4599288
	speed: 0.0231s/iter; left time: 149.8756s
	iters: 500, epoch: 5 | loss: 0.3177216
	speed: 0.0234s/iter; left time: 149.3721s
	iters: 600, epoch: 5 | loss: 0.2965599
	speed: 0.0232s/iter; left time: 145.7371s
	iters: 700, epoch: 5 | loss: 0.4259522
	speed: 0.0228s/iter; left time: 141.0970s
	iters: 800, epoch: 5 | loss: 0.3279852
	speed: 0.0225s/iter; left time: 137.1297s
	iters: 900, epoch: 5 | loss: 0.3510402
	speed: 0.0225s/iter; left time: 134.6100s
	iters: 1000, epoch: 5 | loss: 0.3158646
	speed: 0.0227s/iter; left time: 133.4301s
	iters: 1100, epoch: 5 | loss: 0.2749826
	speed: 0.0229s/iter; left time: 132.2968s
Epoch: 5 cost time: 26.46587038040161
Epoch: 5, Steps: 1147 | Train Loss: 0.4139837 Vali Loss: 0.4364333 Test Loss: 0.1748886
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2267412
	speed: 0.0331s/iter; left time: 186.5609s
	iters: 200, epoch: 6 | loss: 0.2166162
	speed: 0.0267s/iter; left time: 147.6239s
	iters: 300, epoch: 6 | loss: 0.2400032
	speed: 0.0242s/iter; left time: 131.4344s
	iters: 400, epoch: 6 | loss: 0.4511187
	speed: 0.0231s/iter; left time: 123.1778s
	iters: 500, epoch: 6 | loss: 0.3100919
	speed: 0.0221s/iter; left time: 115.7061s
	iters: 600, epoch: 6 | loss: 0.4514148
	speed: 0.0218s/iter; left time: 111.7948s
	iters: 700, epoch: 6 | loss: 0.3012080
	speed: 0.0217s/iter; left time: 109.2545s
	iters: 800, epoch: 6 | loss: 0.2922159
	speed: 0.0217s/iter; left time: 106.9131s
	iters: 900, epoch: 6 | loss: 0.4009949
	speed: 0.0220s/iter; left time: 106.2530s
	iters: 1000, epoch: 6 | loss: 0.2496178
	speed: 0.0222s/iter; left time: 105.2759s
	iters: 1100, epoch: 6 | loss: 0.2972650
	speed: 0.0224s/iter; left time: 103.9272s
Epoch: 6 cost time: 25.92577314376831
Epoch: 6, Steps: 1147 | Train Loss: 0.4106119 Vali Loss: 0.4335898 Test Loss: 0.1736216
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5121707
	speed: 0.0269s/iter; left time: 120.7296s
	iters: 200, epoch: 7 | loss: 0.3424311
	speed: 0.0240s/iter; left time: 105.4997s
	iters: 300, epoch: 7 | loss: 0.2228528
	speed: 0.0225s/iter; left time: 96.4950s
	iters: 400, epoch: 7 | loss: 0.2670910
	speed: 0.0214s/iter; left time: 89.4640s
	iters: 500, epoch: 7 | loss: 0.2031454
	speed: 0.0206s/iter; left time: 84.3600s
	iters: 600, epoch: 7 | loss: 0.2494277
	speed: 0.0194s/iter; left time: 77.5455s
	iters: 700, epoch: 7 | loss: 0.2655933
	speed: 0.0189s/iter; left time: 73.5701s
	iters: 800, epoch: 7 | loss: 0.4788841
	speed: 0.0188s/iter; left time: 71.0583s
	iters: 900, epoch: 7 | loss: 0.4320010
	speed: 0.0187s/iter; left time: 68.8172s
	iters: 1000, epoch: 7 | loss: 0.2665943
	speed: 0.0186s/iter; left time: 66.5966s
	iters: 1100, epoch: 7 | loss: 0.2455065
	speed: 0.0190s/iter; left time: 66.3234s
Epoch: 7 cost time: 22.338510513305664
Epoch: 7, Steps: 1147 | Train Loss: 0.4088748 Vali Loss: 0.4333697 Test Loss: 0.1735105
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4385804
	speed: 0.0370s/iter; left time: 123.7272s
	iters: 200, epoch: 8 | loss: 0.2732384
	speed: 0.0296s/iter; left time: 96.0237s
	iters: 300, epoch: 8 | loss: 0.4201292
	speed: 0.0263s/iter; left time: 82.5351s
	iters: 400, epoch: 8 | loss: 0.2825139
	speed: 0.0251s/iter; left time: 76.2569s
	iters: 500, epoch: 8 | loss: 0.6469606
	speed: 0.0241s/iter; left time: 70.7788s
	iters: 600, epoch: 8 | loss: 0.3195708
	speed: 0.0238s/iter; left time: 67.7720s
	iters: 700, epoch: 8 | loss: 0.4601902
	speed: 0.0242s/iter; left time: 66.4629s
	iters: 800, epoch: 8 | loss: 0.3576939
	speed: 0.0249s/iter; left time: 65.7846s
	iters: 900, epoch: 8 | loss: 0.2358261
	speed: 0.0252s/iter; left time: 63.9454s
	iters: 1000, epoch: 8 | loss: 0.3656298
	speed: 0.0250s/iter; left time: 61.1359s
	iters: 1100, epoch: 8 | loss: 0.3599743
	speed: 0.0250s/iter; left time: 58.6030s
Epoch: 8 cost time: 28.80470871925354
Epoch: 8, Steps: 1147 | Train Loss: 0.4078094 Vali Loss: 0.4347114 Test Loss: 0.1740877
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3347896
	speed: 0.0411s/iter; left time: 90.2604s
	iters: 200, epoch: 9 | loss: 0.3477300
	speed: 0.0352s/iter; left time: 73.7839s
	iters: 300, epoch: 9 | loss: 0.3382004
	speed: 0.0326s/iter; left time: 65.0103s
	iters: 400, epoch: 9 | loss: 0.3439259
	speed: 0.0293s/iter; left time: 55.4837s
	iters: 500, epoch: 9 | loss: 0.3378774
	speed: 0.0277s/iter; left time: 49.8017s
	iters: 600, epoch: 9 | loss: 0.2667434
	speed: 0.0273s/iter; left time: 46.2994s
	iters: 700, epoch: 9 | loss: 0.2165425
	speed: 0.0273s/iter; left time: 43.5487s
	iters: 800, epoch: 9 | loss: 0.2677560
	speed: 0.0267s/iter; left time: 39.9117s
	iters: 900, epoch: 9 | loss: 0.3824413
	speed: 0.0262s/iter; left time: 36.5722s
	iters: 1000, epoch: 9 | loss: 0.2417755
	speed: 0.0258s/iter; left time: 33.3640s
	iters: 1100, epoch: 9 | loss: 0.2365618
	speed: 0.0255s/iter; left time: 30.4344s
Epoch: 9 cost time: 29.204105854034424
Epoch: 9, Steps: 1147 | Train Loss: 0.4072786 Vali Loss: 0.4346150 Test Loss: 0.1735488
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.1741749346256256, mae:0.21379731595516205
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.7234271
	speed: 0.0237s/iter; left time: 269.0800s
	iters: 200, epoch: 1 | loss: 0.3586176
	speed: 0.0231s/iter; left time: 260.8993s
	iters: 300, epoch: 1 | loss: 0.5279028
	speed: 0.0220s/iter; left time: 245.7748s
	iters: 400, epoch: 1 | loss: 0.3100003
	speed: 0.0214s/iter; left time: 236.9763s
	iters: 500, epoch: 1 | loss: 0.3359316
	speed: 0.0208s/iter; left time: 228.3925s
	iters: 600, epoch: 1 | loss: 0.3423657
	speed: 0.0203s/iter; left time: 220.8993s
	iters: 700, epoch: 1 | loss: 0.4581698
	speed: 0.0200s/iter; left time: 215.8044s
	iters: 800, epoch: 1 | loss: 0.5723804
	speed: 0.0202s/iter; left time: 215.6425s
	iters: 900, epoch: 1 | loss: 0.5200045
	speed: 0.0205s/iter; left time: 216.7889s
	iters: 1000, epoch: 1 | loss: 0.4405901
	speed: 0.0220s/iter; left time: 230.2275s
	iters: 1100, epoch: 1 | loss: 0.4041405
	speed: 0.0231s/iter; left time: 239.1692s
Epoch: 1 cost time: 26.955827951431274
Epoch: 1, Steps: 1147 | Train Loss: 0.4942858 Vali Loss: 0.4379221 Test Loss: 0.1856380
Validation loss decreased (inf --> 0.437922).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4147125
	speed: 0.0270s/iter; left time: 275.5741s
	iters: 200, epoch: 2 | loss: 0.3586918
	speed: 0.0231s/iter; left time: 234.2113s
	iters: 300, epoch: 2 | loss: 0.2946235
	speed: 0.0216s/iter; left time: 216.5098s
	iters: 400, epoch: 2 | loss: 0.3456014
	speed: 0.0212s/iter; left time: 210.4096s
	iters: 500, epoch: 2 | loss: 0.2827525
	speed: 0.0217s/iter; left time: 212.7975s
	iters: 600, epoch: 2 | loss: 0.4108952
	speed: 0.0218s/iter; left time: 212.0771s
	iters: 700, epoch: 2 | loss: 0.3713642
	speed: 0.0219s/iter; left time: 211.0295s
	iters: 800, epoch: 2 | loss: 0.3617580
	speed: 0.0220s/iter; left time: 209.4022s
	iters: 900, epoch: 2 | loss: 0.4041722
	speed: 0.0220s/iter; left time: 207.3883s
	iters: 1000, epoch: 2 | loss: 0.4632482
	speed: 0.0221s/iter; left time: 205.6592s
	iters: 1100, epoch: 2 | loss: 0.3337242
	speed: 0.0222s/iter; left time: 205.1370s
Epoch: 2 cost time: 25.70230746269226
Epoch: 2, Steps: 1147 | Train Loss: 0.4514455 Vali Loss: 0.4259755 Test Loss: 0.1786300
Validation loss decreased (0.437922 --> 0.425975).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 1.0935609
	speed: 0.0433s/iter; left time: 392.7120s
	iters: 200, epoch: 3 | loss: 0.2558938
	speed: 0.0377s/iter; left time: 338.6483s
	iters: 300, epoch: 3 | loss: 0.4713674
	speed: 0.0336s/iter; left time: 298.1337s
	iters: 400, epoch: 3 | loss: 0.6434717
	speed: 0.0315s/iter; left time: 276.2152s
	iters: 500, epoch: 3 | loss: 0.2402499
	speed: 0.0324s/iter; left time: 281.4735s
	iters: 600, epoch: 3 | loss: 0.2961462
	speed: 0.0320s/iter; left time: 274.6267s
	iters: 700, epoch: 3 | loss: 2.0287640
	speed: 0.0306s/iter; left time: 259.0252s
	iters: 800, epoch: 3 | loss: 0.2834013
	speed: 0.0296s/iter; left time: 248.1361s
	iters: 900, epoch: 3 | loss: 0.2275320
	speed: 0.0289s/iter; left time: 239.3450s
	iters: 1000, epoch: 3 | loss: 0.3296053
	speed: 0.0283s/iter; left time: 231.6512s
	iters: 1100, epoch: 3 | loss: 0.4416252
	speed: 0.0279s/iter; left time: 224.9706s
Epoch: 3 cost time: 31.91531801223755
Epoch: 3, Steps: 1147 | Train Loss: 0.4302591 Vali Loss: 0.4314392 Test Loss: 0.1781912
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 1.3703878
	speed: 0.0202s/iter; left time: 160.3262s
	iters: 200, epoch: 4 | loss: 0.3537233
	speed: 0.0190s/iter; left time: 148.7184s
	iters: 300, epoch: 4 | loss: 0.2915556
	speed: 0.0204s/iter; left time: 157.6454s
	iters: 400, epoch: 4 | loss: 0.2445115
	speed: 0.0213s/iter; left time: 162.8492s
	iters: 500, epoch: 4 | loss: 0.3298944
	speed: 0.0209s/iter; left time: 157.7402s
	iters: 600, epoch: 4 | loss: 0.3656141
	speed: 0.0209s/iter; left time: 155.4640s
	iters: 700, epoch: 4 | loss: 0.3155819
	speed: 0.0213s/iter; left time: 156.0679s
	iters: 800, epoch: 4 | loss: 0.3834785
	speed: 0.0214s/iter; left time: 154.6623s
	iters: 900, epoch: 4 | loss: 0.2882362
	speed: 0.0215s/iter; left time: 153.4319s
	iters: 1000, epoch: 4 | loss: 0.2444670
	speed: 0.0226s/iter; left time: 159.1373s
	iters: 1100, epoch: 4 | loss: 0.3943111
	speed: 0.0235s/iter; left time: 162.6137s
Epoch: 4 cost time: 27.167245864868164
Epoch: 4, Steps: 1147 | Train Loss: 0.4189347 Vali Loss: 0.4220781 Test Loss: 0.1731139
Validation loss decreased (0.425975 --> 0.422078).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 1.2203282
	speed: 0.0297s/iter; left time: 201.4371s
	iters: 200, epoch: 5 | loss: 0.3453913
	speed: 0.0261s/iter; left time: 174.7591s
	iters: 300, epoch: 5 | loss: 0.3190979
	speed: 0.0238s/iter; left time: 156.7219s
	iters: 400, epoch: 5 | loss: 0.2545482
	speed: 0.0240s/iter; left time: 155.3611s
	iters: 500, epoch: 5 | loss: 0.2897676
	speed: 0.0236s/iter; left time: 150.4881s
	iters: 600, epoch: 5 | loss: 0.4104694
	speed: 0.0233s/iter; left time: 146.6009s
	iters: 700, epoch: 5 | loss: 0.2709938
	speed: 0.0231s/iter; left time: 142.5885s
	iters: 800, epoch: 5 | loss: 0.2810530
	speed: 0.0232s/iter; left time: 141.4246s
	iters: 900, epoch: 5 | loss: 0.3381468
	speed: 0.0233s/iter; left time: 139.2993s
	iters: 1000, epoch: 5 | loss: 0.3333276
	speed: 0.0231s/iter; left time: 135.7050s
	iters: 1100, epoch: 5 | loss: 0.3419430
	speed: 0.0230s/iter; left time: 133.1101s
Epoch: 5 cost time: 26.53123116493225
Epoch: 5, Steps: 1147 | Train Loss: 0.4126474 Vali Loss: 0.4239624 Test Loss: 0.1738715
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2736448
	speed: 0.0319s/iter; left time: 179.6710s
	iters: 200, epoch: 6 | loss: 0.4071985
	speed: 0.0270s/iter; left time: 149.3694s
	iters: 300, epoch: 6 | loss: 0.2179483
	speed: 0.0271s/iter; left time: 147.5699s
	iters: 400, epoch: 6 | loss: 0.3243339
	speed: 0.0285s/iter; left time: 152.1701s
	iters: 500, epoch: 6 | loss: 0.2833927
	speed: 0.0275s/iter; left time: 144.0203s
	iters: 600, epoch: 6 | loss: 0.4590989
	speed: 0.0268s/iter; left time: 137.3887s
	iters: 700, epoch: 6 | loss: 0.4648623
	speed: 0.0278s/iter; left time: 139.7800s
	iters: 800, epoch: 6 | loss: 1.1879704
	speed: 0.0276s/iter; left time: 136.2882s
	iters: 900, epoch: 6 | loss: 0.6266358
	speed: 0.0279s/iter; left time: 134.8819s
	iters: 1000, epoch: 6 | loss: 0.3349491
	speed: 0.0276s/iter; left time: 130.8940s
	iters: 1100, epoch: 6 | loss: 0.3155085
	speed: 0.0272s/iter; left time: 125.9841s
Epoch: 6 cost time: 31.078003883361816
Epoch: 6, Steps: 1147 | Train Loss: 0.4090488 Vali Loss: 0.4255081 Test Loss: 0.1748079
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5936938
	speed: 0.0198s/iter; left time: 88.7189s
	iters: 200, epoch: 7 | loss: 0.3010988
	speed: 0.0208s/iter; left time: 91.1977s
	iters: 300, epoch: 7 | loss: 0.3168558
	speed: 0.0205s/iter; left time: 87.7223s
	iters: 400, epoch: 7 | loss: 0.2385317
	speed: 0.0192s/iter; left time: 80.5907s
	iters: 500, epoch: 7 | loss: 0.4496184
	speed: 0.0186s/iter; left time: 75.9860s
	iters: 600, epoch: 7 | loss: 0.3166221
	speed: 0.0182s/iter; left time: 72.7405s
	iters: 700, epoch: 7 | loss: 0.2313416
	speed: 0.0188s/iter; left time: 73.0997s
	iters: 800, epoch: 7 | loss: 0.2026819
	speed: 0.0192s/iter; left time: 72.7154s
	iters: 900, epoch: 7 | loss: 0.2947310
	speed: 0.0196s/iter; left time: 72.4646s
	iters: 1000, epoch: 7 | loss: 0.6393178
	speed: 0.0200s/iter; left time: 71.6238s
	iters: 1100, epoch: 7 | loss: 0.2419671
	speed: 0.0202s/iter; left time: 70.4430s
Epoch: 7 cost time: 23.395758152008057
Epoch: 7, Steps: 1147 | Train Loss: 0.4076438 Vali Loss: 0.4237602 Test Loss: 0.1741356
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3809073
	speed: 0.0377s/iter; left time: 126.1250s
	iters: 200, epoch: 8 | loss: 0.2920177
	speed: 0.0365s/iter; left time: 118.4492s
	iters: 300, epoch: 8 | loss: 0.3696207
	speed: 0.0337s/iter; left time: 105.8229s
	iters: 400, epoch: 8 | loss: 0.3935164
	speed: 0.0309s/iter; left time: 93.9832s
	iters: 500, epoch: 8 | loss: 0.2317256
	speed: 0.0292s/iter; left time: 85.9075s
	iters: 600, epoch: 8 | loss: 1.2134640
	speed: 0.0282s/iter; left time: 80.1029s
	iters: 700, epoch: 8 | loss: 0.2269901
	speed: 0.0272s/iter; left time: 74.6928s
	iters: 800, epoch: 8 | loss: 0.3800084
	speed: 0.0263s/iter; left time: 69.5049s
	iters: 900, epoch: 8 | loss: 0.2205882
	speed: 0.0257s/iter; left time: 65.4085s
	iters: 1000, epoch: 8 | loss: 0.3205810
	speed: 0.0254s/iter; left time: 62.0642s
	iters: 1100, epoch: 8 | loss: 0.2038105
	speed: 0.0251s/iter; left time: 58.8581s
Epoch: 8 cost time: 28.83646869659424
Epoch: 8, Steps: 1147 | Train Loss: 0.4064823 Vali Loss: 0.4235961 Test Loss: 0.1741088
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2611521
	speed: 0.0329s/iter; left time: 72.2530s
	iters: 200, epoch: 9 | loss: 0.2106058
	speed: 0.0278s/iter; left time: 58.2450s
	iters: 300, epoch: 9 | loss: 0.5009205
	speed: 0.0261s/iter; left time: 52.0642s
	iters: 400, epoch: 9 | loss: 0.3033182
	speed: 0.0262s/iter; left time: 49.7177s
	iters: 500, epoch: 9 | loss: 0.2723437
	speed: 0.0271s/iter; left time: 48.6191s
	iters: 600, epoch: 9 | loss: 0.5557064
	speed: 0.0264s/iter; left time: 44.6728s
	iters: 700, epoch: 9 | loss: 0.2946693
	speed: 0.0258s/iter; left time: 41.2119s
	iters: 800, epoch: 9 | loss: 0.4046300
	speed: 0.0255s/iter; left time: 38.0879s
	iters: 900, epoch: 9 | loss: 0.3321353
	speed: 0.0256s/iter; left time: 35.7231s
	iters: 1000, epoch: 9 | loss: 1.2020822
	speed: 0.0255s/iter; left time: 32.9807s
	iters: 1100, epoch: 9 | loss: 0.3994274
	speed: 0.0254s/iter; left time: 30.3069s
Epoch: 9 cost time: 29.32285475730896
Epoch: 9, Steps: 1147 | Train Loss: 0.4062988 Vali Loss: 0.4231073 Test Loss: 0.1738517
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.18941687047481537, mae:0.22932110726833344
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.3945594
	speed: 0.0202s/iter; left time: 229.2054s
	iters: 200, epoch: 1 | loss: 0.4027196
	speed: 0.0192s/iter; left time: 216.7904s
	iters: 300, epoch: 1 | loss: 0.3600874
	speed: 0.0191s/iter; left time: 212.9336s
	iters: 400, epoch: 1 | loss: 0.3758594
	speed: 0.0189s/iter; left time: 209.0403s
	iters: 500, epoch: 1 | loss: 0.2911883
	speed: 0.0185s/iter; left time: 203.0043s
	iters: 600, epoch: 1 | loss: 0.3474983
	speed: 0.0185s/iter; left time: 200.8086s
	iters: 700, epoch: 1 | loss: 0.3592605
	speed: 0.0183s/iter; left time: 196.7673s
	iters: 800, epoch: 1 | loss: 0.2957284
	speed: 0.0181s/iter; left time: 193.6561s
	iters: 900, epoch: 1 | loss: 0.3534034
	speed: 0.0195s/iter; left time: 205.9464s
	iters: 1000, epoch: 1 | loss: 0.2995781
	speed: 0.0192s/iter; left time: 201.2487s
	iters: 1100, epoch: 1 | loss: 0.5351945
	speed: 0.0194s/iter; left time: 201.2432s
Epoch: 1 cost time: 22.731217622756958
Epoch: 1, Steps: 1147 | Train Loss: 0.5010464 Vali Loss: 0.4406711 Test Loss: 0.1848707
Validation loss decreased (inf --> 0.440671).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 1.4104949
	speed: 0.0330s/iter; left time: 337.0146s
	iters: 200, epoch: 2 | loss: 0.3228423
	speed: 0.0277s/iter; left time: 280.9298s
	iters: 300, epoch: 2 | loss: 0.5744752
	speed: 0.0260s/iter; left time: 260.7134s
	iters: 400, epoch: 2 | loss: 0.2865312
	speed: 0.0254s/iter; left time: 251.7073s
	iters: 500, epoch: 2 | loss: 0.4201893
	speed: 0.0246s/iter; left time: 241.7471s
	iters: 600, epoch: 2 | loss: 0.2896217
	speed: 0.0239s/iter; left time: 232.8391s
	iters: 700, epoch: 2 | loss: 0.3915500
	speed: 0.0236s/iter; left time: 227.4826s
	iters: 800, epoch: 2 | loss: 0.2978487
	speed: 0.0243s/iter; left time: 231.3612s
	iters: 900, epoch: 2 | loss: 0.2963071
	speed: 0.0243s/iter; left time: 228.5916s
	iters: 1000, epoch: 2 | loss: 0.2397463
	speed: 0.0249s/iter; left time: 231.7664s
	iters: 1100, epoch: 2 | loss: 0.4856450
	speed: 0.0248s/iter; left time: 228.7551s
Epoch: 2 cost time: 28.409424543380737
Epoch: 2, Steps: 1147 | Train Loss: 0.4520972 Vali Loss: 0.4298724 Test Loss: 0.1798199
Validation loss decreased (0.440671 --> 0.429872).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 1.2358124
	speed: 0.0296s/iter; left time: 268.5307s
	iters: 200, epoch: 3 | loss: 0.3353324
	speed: 0.0255s/iter; left time: 229.0726s
	iters: 300, epoch: 3 | loss: 0.4305868
	speed: 0.0243s/iter; left time: 215.9058s
	iters: 400, epoch: 3 | loss: 0.3284539
	speed: 0.0247s/iter; left time: 216.3750s
	iters: 500, epoch: 3 | loss: 0.2920676
	speed: 0.0260s/iter; left time: 225.9904s
	iters: 600, epoch: 3 | loss: 0.4138315
	speed: 0.0255s/iter; left time: 218.4967s
	iters: 700, epoch: 3 | loss: 0.5873612
	speed: 0.0250s/iter; left time: 212.1179s
	iters: 800, epoch: 3 | loss: 0.2941558
	speed: 0.0244s/iter; left time: 204.7877s
	iters: 900, epoch: 3 | loss: 0.4486642
	speed: 0.0243s/iter; left time: 201.4901s
	iters: 1000, epoch: 3 | loss: 0.4236256
	speed: 0.0244s/iter; left time: 199.1815s
	iters: 1100, epoch: 3 | loss: 0.3301050
	speed: 0.0239s/iter; left time: 193.0838s
Epoch: 3 cost time: 27.371021509170532
Epoch: 3, Steps: 1147 | Train Loss: 0.4310830 Vali Loss: 0.4268442 Test Loss: 0.1759721
Validation loss decreased (0.429872 --> 0.426844).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2578738
	speed: 0.0301s/iter; left time: 239.0187s
	iters: 200, epoch: 4 | loss: 0.2794825
	speed: 0.0275s/iter; left time: 215.6677s
	iters: 300, epoch: 4 | loss: 0.3588211
	speed: 0.0266s/iter; left time: 205.5064s
	iters: 400, epoch: 4 | loss: 1.4533130
	speed: 0.0261s/iter; left time: 199.1174s
	iters: 500, epoch: 4 | loss: 0.3245560
	speed: 0.0251s/iter; left time: 188.7651s
	iters: 600, epoch: 4 | loss: 0.3656100
	speed: 0.0238s/iter; left time: 176.9643s
	iters: 700, epoch: 4 | loss: 0.4453217
	speed: 0.0228s/iter; left time: 167.3805s
	iters: 800, epoch: 4 | loss: 1.1105056
	speed: 0.0222s/iter; left time: 160.4041s
	iters: 900, epoch: 4 | loss: 0.3174801
	speed: 0.0216s/iter; left time: 153.9357s
	iters: 1000, epoch: 4 | loss: 0.2511829
	speed: 0.0211s/iter; left time: 148.3716s
	iters: 1100, epoch: 4 | loss: 0.3137561
	speed: 0.0205s/iter; left time: 141.7719s
Epoch: 4 cost time: 23.191069841384888
Epoch: 4, Steps: 1147 | Train Loss: 0.4195968 Vali Loss: 0.4329996 Test Loss: 0.1767810
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3441053
	speed: 0.0257s/iter; left time: 174.2403s
	iters: 200, epoch: 5 | loss: 0.2837315
	speed: 0.0246s/iter; left time: 164.1917s
	iters: 300, epoch: 5 | loss: 0.3492336
	speed: 0.0244s/iter; left time: 160.5489s
	iters: 400, epoch: 5 | loss: 0.3730049
	speed: 0.0244s/iter; left time: 158.3862s
	iters: 500, epoch: 5 | loss: 0.2679801
	speed: 0.0246s/iter; left time: 156.8371s
	iters: 600, epoch: 5 | loss: 0.3713067
	speed: 0.0246s/iter; left time: 154.2741s
	iters: 700, epoch: 5 | loss: 0.5898948
	speed: 0.0255s/iter; left time: 157.8845s
	iters: 800, epoch: 5 | loss: 0.4200253
	speed: 0.0253s/iter; left time: 154.0226s
	iters: 900, epoch: 5 | loss: 0.3797063
	speed: 0.0249s/iter; left time: 149.2700s
	iters: 1000, epoch: 5 | loss: 0.3077915
	speed: 0.0252s/iter; left time: 148.3439s
	iters: 1100, epoch: 5 | loss: 0.2243107
	speed: 0.0251s/iter; left time: 144.8802s
Epoch: 5 cost time: 28.92511010169983
Epoch: 5, Steps: 1147 | Train Loss: 0.4132506 Vali Loss: 0.4247600 Test Loss: 0.1732993
Validation loss decreased (0.426844 --> 0.424760).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3024357
	speed: 0.0260s/iter; left time: 146.3806s
	iters: 200, epoch: 6 | loss: 1.2408674
	speed: 0.0239s/iter; left time: 132.3713s
	iters: 300, epoch: 6 | loss: 0.3304355
	speed: 0.0232s/iter; left time: 126.1289s
	iters: 400, epoch: 6 | loss: 0.3210525
	speed: 0.0228s/iter; left time: 121.8789s
	iters: 500, epoch: 6 | loss: 0.3383318
	speed: 0.0243s/iter; left time: 127.0071s
	iters: 600, epoch: 6 | loss: 1.2840601
	speed: 0.0245s/iter; left time: 125.5818s
	iters: 700, epoch: 6 | loss: 0.2995730
	speed: 0.0245s/iter; left time: 123.4136s
	iters: 800, epoch: 6 | loss: 0.3352793
	speed: 0.0245s/iter; left time: 120.7532s
	iters: 900, epoch: 6 | loss: 0.3830090
	speed: 0.0243s/iter; left time: 117.5904s
	iters: 1000, epoch: 6 | loss: 0.2817615
	speed: 0.0241s/iter; left time: 114.1472s
	iters: 1100, epoch: 6 | loss: 0.3087055
	speed: 0.0245s/iter; left time: 113.6528s
Epoch: 6 cost time: 28.56506061553955
Epoch: 6, Steps: 1147 | Train Loss: 0.4096310 Vali Loss: 0.4279602 Test Loss: 0.1736289
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3181082
	speed: 0.0250s/iter; left time: 112.1099s
	iters: 200, epoch: 7 | loss: 0.3698922
	speed: 0.0221s/iter; left time: 96.8753s
	iters: 300, epoch: 7 | loss: 0.3605993
	speed: 0.0214s/iter; left time: 91.8007s
	iters: 400, epoch: 7 | loss: 0.3303937
	speed: 0.0220s/iter; left time: 92.1860s
	iters: 500, epoch: 7 | loss: 0.2701168
	speed: 0.0245s/iter; left time: 100.2239s
	iters: 600, epoch: 7 | loss: 0.3093273
	speed: 0.0251s/iter; left time: 100.0877s
	iters: 700, epoch: 7 | loss: 1.2760940
	speed: 0.0248s/iter; left time: 96.3550s
	iters: 800, epoch: 7 | loss: 0.3264018
	speed: 0.0245s/iter; left time: 92.8313s
	iters: 900, epoch: 7 | loss: 0.2142008
	speed: 0.0239s/iter; left time: 88.1792s
	iters: 1000, epoch: 7 | loss: 0.2887534
	speed: 0.0233s/iter; left time: 83.6494s
	iters: 1100, epoch: 7 | loss: 0.2972173
	speed: 0.0228s/iter; left time: 79.7148s
Epoch: 7 cost time: 26.182609796524048
Epoch: 7, Steps: 1147 | Train Loss: 0.4078489 Vali Loss: 0.4276049 Test Loss: 0.1734583
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2812296
	speed: 0.0248s/iter; left time: 82.8783s
	iters: 200, epoch: 8 | loss: 0.2624540
	speed: 0.0217s/iter; left time: 70.2622s
	iters: 300, epoch: 8 | loss: 0.2757514
	speed: 0.0209s/iter; left time: 65.7224s
	iters: 400, epoch: 8 | loss: 0.2612359
	speed: 0.0207s/iter; left time: 63.0138s
	iters: 500, epoch: 8 | loss: 0.2773226
	speed: 0.0210s/iter; left time: 61.8063s
	iters: 600, epoch: 8 | loss: 0.2980790
	speed: 0.0217s/iter; left time: 61.6047s
	iters: 700, epoch: 8 | loss: 0.4180592
	speed: 0.0221s/iter; left time: 60.5946s
	iters: 800, epoch: 8 | loss: 0.2699137
	speed: 0.0224s/iter; left time: 59.1879s
	iters: 900, epoch: 8 | loss: 0.2603728
	speed: 0.0224s/iter; left time: 56.8762s
	iters: 1000, epoch: 8 | loss: 0.2424484
	speed: 0.0223s/iter; left time: 54.5095s
	iters: 1100, epoch: 8 | loss: 0.3046623
	speed: 0.0224s/iter; left time: 52.3643s
Epoch: 8 cost time: 25.786060333251953
Epoch: 8, Steps: 1147 | Train Loss: 0.4071358 Vali Loss: 0.4275524 Test Loss: 0.1732660
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3245993
	speed: 0.0438s/iter; left time: 96.1974s
	iters: 200, epoch: 9 | loss: 0.3931470
	speed: 0.0395s/iter; left time: 82.6646s
	iters: 300, epoch: 9 | loss: 0.2562726
	speed: 0.0359s/iter; left time: 71.5904s
	iters: 400, epoch: 9 | loss: 0.2277963
	speed: 0.0325s/iter; left time: 61.6533s
	iters: 500, epoch: 9 | loss: 0.3793880
	speed: 0.0307s/iter; left time: 55.1160s
	iters: 600, epoch: 9 | loss: 0.2901674
	speed: 0.0296s/iter; left time: 50.1837s
	iters: 700, epoch: 9 | loss: 0.2832255
	speed: 0.0289s/iter; left time: 46.0286s
	iters: 800, epoch: 9 | loss: 0.3807176
	speed: 0.0283s/iter; left time: 42.2786s
	iters: 900, epoch: 9 | loss: 0.2808559
	speed: 0.0276s/iter; left time: 38.5193s
	iters: 1000, epoch: 9 | loss: 1.2712111
	speed: 0.0270s/iter; left time: 35.0108s
	iters: 1100, epoch: 9 | loss: 0.3853057
	speed: 0.0266s/iter; left time: 31.8252s
Epoch: 9 cost time: 30.63902497291565
Epoch: 9, Steps: 1147 | Train Loss: 0.4065410 Vali Loss: 0.4285493 Test Loss: 0.1734739
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.5206224
	speed: 0.0315s/iter; left time: 32.9824s
	iters: 200, epoch: 10 | loss: 0.3957244
	speed: 0.0303s/iter; left time: 28.7062s
	iters: 300, epoch: 10 | loss: 0.2901545
	speed: 0.0281s/iter; left time: 23.8644s
	iters: 400, epoch: 10 | loss: 0.2571506
	speed: 0.0286s/iter; left time: 21.4139s
	iters: 500, epoch: 10 | loss: 0.5309207
	speed: 0.0297s/iter; left time: 19.2170s
	iters: 600, epoch: 10 | loss: 0.4859185
	speed: 0.0300s/iter; left time: 16.4296s
	iters: 700, epoch: 10 | loss: 0.3177066
	speed: 0.0295s/iter; left time: 13.2189s
	iters: 800, epoch: 10 | loss: 0.2795645
	speed: 0.0283s/iter; left time: 9.8475s
	iters: 900, epoch: 10 | loss: 0.2200563
	speed: 0.0271s/iter; left time: 6.7259s
	iters: 1000, epoch: 10 | loss: 0.2645164
	speed: 0.0261s/iter; left time: 3.8614s
	iters: 1100, epoch: 10 | loss: 0.3100745
	speed: 0.0255s/iter; left time: 1.2243s
Epoch: 10 cost time: 29.13313317298889
Epoch: 10, Steps: 1147 | Train Loss: 0.4063566 Vali Loss: 0.4289095 Test Loss: 0.1734532
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.17329935729503632, mae:0.21259507536888123
Seed: 42
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_192      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.4540133
	speed: 0.0528s/iter; left time: 598.6702s
	iters: 200, epoch: 1 | loss: 0.4790784
	speed: 0.0465s/iter; left time: 523.2619s
	iters: 300, epoch: 1 | loss: 0.4030911
	speed: 0.0444s/iter; left time: 494.7079s
	iters: 400, epoch: 1 | loss: 0.4142451
	speed: 0.0438s/iter; left time: 483.6037s
	iters: 500, epoch: 1 | loss: 0.4641989
	speed: 0.0433s/iter; left time: 473.5641s
	iters: 600, epoch: 1 | loss: 0.5661390
	speed: 0.0423s/iter; left time: 458.8082s
	iters: 700, epoch: 1 | loss: 0.5612612
	speed: 0.0391s/iter; left time: 419.4606s
	iters: 800, epoch: 1 | loss: 0.5752594
	speed: 0.0373s/iter; left time: 396.9693s
	iters: 900, epoch: 1 | loss: 0.5769552
	speed: 0.0355s/iter; left time: 374.6592s
	iters: 1000, epoch: 1 | loss: 0.7164701
	speed: 0.0339s/iter; left time: 354.1828s
	iters: 1100, epoch: 1 | loss: 0.4329656
	speed: 0.0326s/iter; left time: 337.6161s
Epoch: 1 cost time: 36.82825541496277
Epoch: 1, Steps: 1144 | Train Loss: 0.5610558 Vali Loss: 0.5211034 Test Loss: 0.2321133
Validation loss decreased (inf --> 0.521103).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9440860
	speed: 0.0292s/iter; left time: 298.2082s
	iters: 200, epoch: 2 | loss: 0.5164982
	speed: 0.0269s/iter; left time: 271.5038s
	iters: 300, epoch: 2 | loss: 0.3876766
	speed: 0.0261s/iter; left time: 260.6662s
	iters: 400, epoch: 2 | loss: 0.4346026
	speed: 0.0257s/iter; left time: 254.2989s
	iters: 500, epoch: 2 | loss: 0.4885059
	speed: 0.0255s/iter; left time: 249.7257s
	iters: 600, epoch: 2 | loss: 0.3767800
	speed: 0.0251s/iter; left time: 243.3694s
	iters: 700, epoch: 2 | loss: 0.3768423
	speed: 0.0248s/iter; left time: 237.7552s
	iters: 800, epoch: 2 | loss: 0.9182708
	speed: 0.0244s/iter; left time: 231.3942s
	iters: 900, epoch: 2 | loss: 0.5359703
	speed: 0.0244s/iter; left time: 229.4378s
	iters: 1000, epoch: 2 | loss: 0.4540565
	speed: 0.0242s/iter; left time: 225.1035s
	iters: 1100, epoch: 2 | loss: 0.4440922
	speed: 0.0239s/iter; left time: 220.2232s
Epoch: 2 cost time: 27.458356618881226
Epoch: 2, Steps: 1144 | Train Loss: 0.5194576 Vali Loss: 0.5086243 Test Loss: 0.2278755
Validation loss decreased (0.521103 --> 0.508624).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4161756
	speed: 0.0195s/iter; left time: 176.8733s
	iters: 200, epoch: 3 | loss: 0.3839639
	speed: 0.0193s/iter; left time: 172.4560s
	iters: 300, epoch: 3 | loss: 0.3850448
	speed: 0.0199s/iter; left time: 176.3342s
	iters: 400, epoch: 3 | loss: 0.2820757
	speed: 0.0204s/iter; left time: 178.6559s
	iters: 500, epoch: 3 | loss: 0.4163577
	speed: 0.0208s/iter; left time: 180.1476s
	iters: 600, epoch: 3 | loss: 0.4809263
	speed: 0.0216s/iter; left time: 184.5217s
	iters: 700, epoch: 3 | loss: 0.4993657
	speed: 0.0217s/iter; left time: 183.6342s
	iters: 800, epoch: 3 | loss: 0.3835165
	speed: 0.0218s/iter; left time: 182.2226s
	iters: 900, epoch: 3 | loss: 0.3832541
	speed: 0.0219s/iter; left time: 180.5981s
	iters: 1000, epoch: 3 | loss: 0.4378608
	speed: 0.0220s/iter; left time: 179.0143s
	iters: 1100, epoch: 3 | loss: 0.4016654
	speed: 0.0222s/iter; left time: 178.6436s
Epoch: 3 cost time: 25.583783864974976
Epoch: 3, Steps: 1144 | Train Loss: 0.5004666 Vali Loss: 0.4970767 Test Loss: 0.2222617
Validation loss decreased (0.508624 --> 0.497077).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4161609
	speed: 0.0324s/iter; left time: 256.5758s
	iters: 200, epoch: 4 | loss: 0.6685589
	speed: 0.0274s/iter; left time: 213.9240s
	iters: 300, epoch: 4 | loss: 0.4844930
	speed: 0.0258s/iter; left time: 199.1721s
	iters: 400, epoch: 4 | loss: 0.3995182
	speed: 0.0253s/iter; left time: 192.2390s
	iters: 500, epoch: 4 | loss: 0.4138392
	speed: 0.0274s/iter; left time: 206.0354s
	iters: 600, epoch: 4 | loss: 0.3295172
	speed: 0.0266s/iter; left time: 197.1945s
	iters: 700, epoch: 4 | loss: 0.3772725
	speed: 0.0266s/iter; left time: 194.0591s
	iters: 800, epoch: 4 | loss: 0.8921015
	speed: 0.0275s/iter; left time: 197.9030s
	iters: 900, epoch: 4 | loss: 0.2885437
	speed: 0.0280s/iter; left time: 199.1590s
	iters: 1000, epoch: 4 | loss: 0.4250590
	speed: 0.0277s/iter; left time: 193.9624s
	iters: 1100, epoch: 4 | loss: 0.3894560
	speed: 0.0274s/iter; left time: 189.5346s
Epoch: 4 cost time: 31.355998754501343
Epoch: 4, Steps: 1144 | Train Loss: 0.4894793 Vali Loss: 0.5066628 Test Loss: 0.2255555
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3238066
	speed: 0.0309s/iter; left time: 208.9491s
	iters: 200, epoch: 5 | loss: 0.4705639
	speed: 0.0293s/iter; left time: 195.5007s
	iters: 300, epoch: 5 | loss: 1.0005081
	speed: 0.0274s/iter; left time: 180.1479s
	iters: 400, epoch: 5 | loss: 0.6206525
	speed: 0.0283s/iter; left time: 183.1189s
	iters: 500, epoch: 5 | loss: 0.4634954
	speed: 0.0291s/iter; left time: 185.3329s
	iters: 600, epoch: 5 | loss: 0.4397905
	speed: 0.0280s/iter; left time: 175.5806s
	iters: 700, epoch: 5 | loss: 0.3662077
	speed: 0.0271s/iter; left time: 167.3003s
	iters: 800, epoch: 5 | loss: 0.3399035
	speed: 0.0266s/iter; left time: 161.1257s
	iters: 900, epoch: 5 | loss: 0.4426277
	speed: 0.0262s/iter; left time: 156.0078s
	iters: 1000, epoch: 5 | loss: 0.3536379
	speed: 0.0256s/iter; left time: 150.4139s
	iters: 1100, epoch: 5 | loss: 0.4451326
	speed: 0.0256s/iter; left time: 147.4415s
Epoch: 5 cost time: 29.106439352035522
Epoch: 5, Steps: 1144 | Train Loss: 0.4834021 Vali Loss: 0.5055319 Test Loss: 0.2236396
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5200038
	speed: 0.0262s/iter; left time: 147.0754s
	iters: 200, epoch: 6 | loss: 0.3372290
	speed: 0.0231s/iter; left time: 127.7297s
	iters: 300, epoch: 6 | loss: 0.4976822
	speed: 0.0230s/iter; left time: 124.4210s
	iters: 400, epoch: 6 | loss: 0.3897480
	speed: 0.0228s/iter; left time: 121.2818s
	iters: 500, epoch: 6 | loss: 0.3181539
	speed: 0.0230s/iter; left time: 120.0501s
	iters: 600, epoch: 6 | loss: 0.3090081
	speed: 0.0231s/iter; left time: 118.0806s
	iters: 700, epoch: 6 | loss: 0.3689182
	speed: 0.0241s/iter; left time: 120.9404s
	iters: 800, epoch: 6 | loss: 0.4386749
	speed: 0.0254s/iter; left time: 125.0103s
	iters: 900, epoch: 6 | loss: 0.4243522
	speed: 0.0251s/iter; left time: 121.0666s
	iters: 1000, epoch: 6 | loss: 0.4190197
	speed: 0.0254s/iter; left time: 119.8174s
	iters: 1100, epoch: 6 | loss: 0.4787713
	speed: 0.0255s/iter; left time: 117.8465s
Epoch: 6 cost time: 29.763251543045044
Epoch: 6, Steps: 1144 | Train Loss: 0.4800439 Vali Loss: 0.5083476 Test Loss: 0.2237968
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2973228
	speed: 0.0241s/iter; left time: 107.6728s
	iters: 200, epoch: 7 | loss: 0.4940570
	speed: 0.0242s/iter; left time: 105.7207s
	iters: 300, epoch: 7 | loss: 0.4420549
	speed: 0.0235s/iter; left time: 100.4896s
	iters: 400, epoch: 7 | loss: 0.4195846
	speed: 0.0231s/iter; left time: 96.5172s
	iters: 500, epoch: 7 | loss: 0.3940740
	speed: 0.0235s/iter; left time: 95.8637s
	iters: 600, epoch: 7 | loss: 0.3802181
	speed: 0.0236s/iter; left time: 93.9392s
	iters: 700, epoch: 7 | loss: 0.4916902
	speed: 0.0237s/iter; left time: 91.7922s
	iters: 800, epoch: 7 | loss: 0.4356779
	speed: 0.0235s/iter; left time: 88.8549s
	iters: 900, epoch: 7 | loss: 0.8485093
	speed: 0.0236s/iter; left time: 86.8222s
	iters: 1000, epoch: 7 | loss: 0.8294406
	speed: 0.0235s/iter; left time: 84.0602s
	iters: 1100, epoch: 7 | loss: 0.3303077
	speed: 0.0234s/iter; left time: 81.3844s
Epoch: 7 cost time: 27.00142765045166
Epoch: 7, Steps: 1144 | Train Loss: 0.4782147 Vali Loss: 0.5081284 Test Loss: 0.2239408
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3498748
	speed: 0.0302s/iter; left time: 100.7487s
	iters: 200, epoch: 8 | loss: 0.4237438
	speed: 0.0277s/iter; left time: 89.6943s
	iters: 300, epoch: 8 | loss: 0.3855599
	speed: 0.0252s/iter; left time: 79.0518s
	iters: 400, epoch: 8 | loss: 0.4511757
	speed: 0.0243s/iter; left time: 73.6432s
	iters: 500, epoch: 8 | loss: 0.9519460
	speed: 0.0244s/iter; left time: 71.5481s
	iters: 600, epoch: 8 | loss: 0.3749101
	speed: 0.0245s/iter; left time: 69.3098s
	iters: 700, epoch: 8 | loss: 0.4533598
	speed: 0.0245s/iter; left time: 66.9043s
	iters: 800, epoch: 8 | loss: 0.3650892
	speed: 0.0245s/iter; left time: 64.5839s
	iters: 900, epoch: 8 | loss: 0.4712437
	speed: 0.0242s/iter; left time: 61.2119s
	iters: 1000, epoch: 8 | loss: 0.4582339
	speed: 0.0238s/iter; left time: 57.8458s
	iters: 1100, epoch: 8 | loss: 0.4079244
	speed: 0.0232s/iter; left time: 54.2349s
Epoch: 8 cost time: 26.434449434280396
Epoch: 8, Steps: 1144 | Train Loss: 0.4775052 Vali Loss: 0.5081304 Test Loss: 0.2236526
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.23587283492088318, mae:0.26653674244880676
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.4762629
	speed: 0.0210s/iter; left time: 237.6813s
	iters: 200, epoch: 1 | loss: 0.5337216
	speed: 0.0232s/iter; left time: 260.4994s
	iters: 300, epoch: 1 | loss: 0.3361587
	speed: 0.0234s/iter; left time: 260.6198s
	iters: 400, epoch: 1 | loss: 0.3954393
	speed: 0.0235s/iter; left time: 259.3048s
	iters: 500, epoch: 1 | loss: 0.4405350
	speed: 0.0235s/iter; left time: 257.0772s
	iters: 600, epoch: 1 | loss: 0.7415619
	speed: 0.0231s/iter; left time: 250.5718s
	iters: 700, epoch: 1 | loss: 0.4462809
	speed: 0.0228s/iter; left time: 244.9661s
	iters: 800, epoch: 1 | loss: 0.4595491
	speed: 0.0227s/iter; left time: 241.4768s
	iters: 900, epoch: 1 | loss: 0.4732206
	speed: 0.0229s/iter; left time: 241.3276s
	iters: 1000, epoch: 1 | loss: 0.9775860
	speed: 0.0231s/iter; left time: 241.0660s
	iters: 1100, epoch: 1 | loss: 0.5483860
	speed: 0.0233s/iter; left time: 240.5598s
Epoch: 1 cost time: 26.827208042144775
Epoch: 1, Steps: 1144 | Train Loss: 0.5651020 Vali Loss: 0.5177897 Test Loss: 0.2322680
Validation loss decreased (inf --> 0.517790).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4511737
	speed: 0.0346s/iter; left time: 353.3252s
	iters: 200, epoch: 2 | loss: 0.3908759
	speed: 0.0295s/iter; left time: 297.7331s
	iters: 300, epoch: 2 | loss: 0.4789673
	speed: 0.0272s/iter; left time: 272.3214s
	iters: 400, epoch: 2 | loss: 0.4326077
	speed: 0.0277s/iter; left time: 273.7369s
	iters: 500, epoch: 2 | loss: 0.4152203
	speed: 0.0262s/iter; left time: 256.3297s
	iters: 600, epoch: 2 | loss: 0.5375149
	speed: 0.0254s/iter; left time: 246.7530s
	iters: 700, epoch: 2 | loss: 0.3623441
	speed: 0.0251s/iter; left time: 240.4870s
	iters: 800, epoch: 2 | loss: 0.3906268
	speed: 0.0248s/iter; left time: 235.3145s
	iters: 900, epoch: 2 | loss: 1.0341125
	speed: 0.0246s/iter; left time: 231.1157s
	iters: 1000, epoch: 2 | loss: 0.5148972
	speed: 0.0246s/iter; left time: 228.6190s
	iters: 1100, epoch: 2 | loss: 0.5412809
	speed: 0.0246s/iter; left time: 226.0181s
Epoch: 2 cost time: 28.198096752166748
Epoch: 2, Steps: 1144 | Train Loss: 0.5204671 Vali Loss: 0.5222042 Test Loss: 0.2320596
EarlyStopping counter: 1 out of 5
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 1.3090045
	speed: 0.0366s/iter; left time: 331.7110s
	iters: 200, epoch: 3 | loss: 0.3503360
	speed: 0.0339s/iter; left time: 303.7183s
	iters: 300, epoch: 3 | loss: 0.4201560
	speed: 0.0292s/iter; left time: 258.5331s
	iters: 400, epoch: 3 | loss: 0.3430790
	speed: 0.0275s/iter; left time: 240.6605s
	iters: 500, epoch: 3 | loss: 0.5121872
	speed: 0.0265s/iter; left time: 229.3344s
	iters: 600, epoch: 3 | loss: 0.4170155
	speed: 0.0258s/iter; left time: 220.5330s
	iters: 700, epoch: 3 | loss: 0.8510115
	speed: 0.0254s/iter; left time: 214.6995s
	iters: 800, epoch: 3 | loss: 0.9062090
	speed: 0.0264s/iter; left time: 220.1220s
	iters: 900, epoch: 3 | loss: 0.3848407
	speed: 0.0272s/iter; left time: 224.7460s
	iters: 1000, epoch: 3 | loss: 0.3587413
	speed: 0.0283s/iter; left time: 230.3345s
	iters: 1100, epoch: 3 | loss: 0.5595483
	speed: 0.0290s/iter; left time: 233.7830s
Epoch: 3 cost time: 33.03794288635254
Epoch: 3, Steps: 1144 | Train Loss: 0.5031875 Vali Loss: 0.5050237 Test Loss: 0.2260274
Validation loss decreased (0.517790 --> 0.505024).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3708741
	speed: 0.0250s/iter; left time: 197.9329s
	iters: 200, epoch: 4 | loss: 0.4799365
	speed: 0.0194s/iter; left time: 151.5826s
	iters: 300, epoch: 4 | loss: 0.8076284
	speed: 0.0190s/iter; left time: 146.7184s
	iters: 400, epoch: 4 | loss: 0.3236713
	speed: 0.0183s/iter; left time: 139.2591s
	iters: 500, epoch: 4 | loss: 0.3399204
	speed: 0.0182s/iter; left time: 137.0268s
	iters: 600, epoch: 4 | loss: 0.3989909
	speed: 0.0186s/iter; left time: 137.7975s
	iters: 700, epoch: 4 | loss: 0.4575009
	speed: 0.0196s/iter; left time: 143.2862s
	iters: 800, epoch: 4 | loss: 0.3972650
	speed: 0.0203s/iter; left time: 146.0249s
	iters: 900, epoch: 4 | loss: 0.4765022
	speed: 0.0208s/iter; left time: 147.7570s
	iters: 1000, epoch: 4 | loss: 0.4298682
	speed: 0.0212s/iter; left time: 148.2428s
	iters: 1100, epoch: 4 | loss: 0.3941445
	speed: 0.0215s/iter; left time: 148.2066s
Epoch: 4 cost time: 24.80542778968811
Epoch: 4, Steps: 1144 | Train Loss: 0.4920764 Vali Loss: 0.4999732 Test Loss: 0.2245973
Validation loss decreased (0.505024 --> 0.499973).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3753235
	speed: 0.0392s/iter; left time: 264.9226s
	iters: 200, epoch: 5 | loss: 0.4314204
	speed: 0.0298s/iter; left time: 198.6349s
	iters: 300, epoch: 5 | loss: 0.5184987
	speed: 0.0261s/iter; left time: 171.3102s
	iters: 400, epoch: 5 | loss: 0.4165117
	speed: 0.0242s/iter; left time: 156.2028s
	iters: 500, epoch: 5 | loss: 1.3995832
	speed: 0.0225s/iter; left time: 143.2523s
	iters: 600, epoch: 5 | loss: 0.4443018
	speed: 0.0228s/iter; left time: 143.0618s
	iters: 700, epoch: 5 | loss: 0.4415164
	speed: 0.0235s/iter; left time: 144.8922s
	iters: 800, epoch: 5 | loss: 0.3263225
	speed: 0.0234s/iter; left time: 141.8215s
	iters: 900, epoch: 5 | loss: 0.8202629
	speed: 0.0233s/iter; left time: 138.8075s
	iters: 1000, epoch: 5 | loss: 0.3803342
	speed: 0.0231s/iter; left time: 135.3768s
	iters: 1100, epoch: 5 | loss: 0.3288067
	speed: 0.0239s/iter; left time: 138.0249s
Epoch: 5 cost time: 28.00679922103882
Epoch: 5, Steps: 1144 | Train Loss: 0.4852040 Vali Loss: 0.5014497 Test Loss: 0.2233832
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4194437
	speed: 0.0321s/iter; left time: 180.6102s
	iters: 200, epoch: 6 | loss: 0.4146529
	speed: 0.0264s/iter; left time: 145.5192s
	iters: 300, epoch: 6 | loss: 0.2924688
	speed: 0.0242s/iter; left time: 131.0158s
	iters: 400, epoch: 6 | loss: 0.3617688
	speed: 0.0234s/iter; left time: 124.2538s
	iters: 500, epoch: 6 | loss: 0.3893316
	speed: 0.0240s/iter; left time: 125.3026s
	iters: 600, epoch: 6 | loss: 0.8868890
	speed: 0.0237s/iter; left time: 121.4402s
	iters: 700, epoch: 6 | loss: 0.4388556
	speed: 0.0248s/iter; left time: 124.5451s
	iters: 800, epoch: 6 | loss: 0.3354421
	speed: 0.0248s/iter; left time: 122.0120s
	iters: 900, epoch: 6 | loss: 0.4690846
	speed: 0.0245s/iter; left time: 118.2606s
	iters: 1000, epoch: 6 | loss: 0.8651491
	speed: 0.0244s/iter; left time: 115.0035s
	iters: 1100, epoch: 6 | loss: 0.4234541
	speed: 0.0243s/iter; left time: 112.4247s
Epoch: 6 cost time: 28.025046825408936
Epoch: 6, Steps: 1144 | Train Loss: 0.4819472 Vali Loss: 0.5041931 Test Loss: 0.2237541
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5875420
	speed: 0.0217s/iter; left time: 97.3708s
	iters: 200, epoch: 7 | loss: 0.3859826
	speed: 0.0177s/iter; left time: 77.6874s
	iters: 300, epoch: 7 | loss: 0.3566249
	speed: 0.0165s/iter; left time: 70.5941s
	iters: 400, epoch: 7 | loss: 0.3675247
	speed: 0.0163s/iter; left time: 67.9940s
	iters: 500, epoch: 7 | loss: 0.4084788
	speed: 0.0168s/iter; left time: 68.5537s
	iters: 600, epoch: 7 | loss: 0.2751969
	speed: 0.0177s/iter; left time: 70.3904s
	iters: 700, epoch: 7 | loss: 0.3545738
	speed: 0.0187s/iter; left time: 72.3162s
	iters: 800, epoch: 7 | loss: 0.3986984
	speed: 0.0193s/iter; left time: 72.7313s
	iters: 900, epoch: 7 | loss: 0.3690077
	speed: 0.0196s/iter; left time: 72.0841s
	iters: 1000, epoch: 7 | loss: 0.3819832
	speed: 0.0199s/iter; left time: 71.0681s
	iters: 1100, epoch: 7 | loss: 0.8277968
	speed: 0.0201s/iter; left time: 69.9275s
Epoch: 7 cost time: 23.238292932510376
Epoch: 7, Steps: 1144 | Train Loss: 0.4802863 Vali Loss: 0.5042377 Test Loss: 0.2238082
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.8284354
	speed: 0.0396s/iter; left time: 131.8881s
	iters: 200, epoch: 8 | loss: 0.6683722
	speed: 0.0340s/iter; left time: 109.9953s
	iters: 300, epoch: 8 | loss: 0.3146472
	speed: 0.0290s/iter; left time: 90.7681s
	iters: 400, epoch: 8 | loss: 0.4412487
	speed: 0.0265s/iter; left time: 80.3121s
	iters: 500, epoch: 8 | loss: 0.4640428
	speed: 0.0251s/iter; left time: 73.6945s
	iters: 600, epoch: 8 | loss: 0.3223480
	speed: 0.0242s/iter; left time: 68.6101s
	iters: 700, epoch: 8 | loss: 0.4284380
	speed: 0.0242s/iter; left time: 66.0323s
	iters: 800, epoch: 8 | loss: 0.7811198
	speed: 0.0242s/iter; left time: 63.7400s
	iters: 900, epoch: 8 | loss: 1.0778555
	speed: 0.0244s/iter; left time: 61.6999s
	iters: 1000, epoch: 8 | loss: 0.3434013
	speed: 0.0241s/iter; left time: 58.6882s
	iters: 1100, epoch: 8 | loss: 0.4002600
	speed: 0.0239s/iter; left time: 55.8200s
Epoch: 8 cost time: 27.435811281204224
Epoch: 8, Steps: 1144 | Train Loss: 0.4791545 Vali Loss: 0.5032966 Test Loss: 0.2232932
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.7260485
	speed: 0.0336s/iter; left time: 73.6438s
	iters: 200, epoch: 9 | loss: 0.3274463
	speed: 0.0293s/iter; left time: 61.1994s
	iters: 300, epoch: 9 | loss: 0.3977368
	speed: 0.0272s/iter; left time: 54.0780s
	iters: 400, epoch: 9 | loss: 0.3341610
	speed: 0.0253s/iter; left time: 47.7709s
	iters: 500, epoch: 9 | loss: 0.4730062
	speed: 0.0240s/iter; left time: 42.9412s
	iters: 600, epoch: 9 | loss: 0.4635749
	speed: 0.0231s/iter; left time: 39.0283s
	iters: 700, epoch: 9 | loss: 0.3531038
	speed: 0.0226s/iter; left time: 35.8952s
	iters: 800, epoch: 9 | loss: 0.4400129
	speed: 0.0229s/iter; left time: 34.0348s
	iters: 900, epoch: 9 | loss: 0.7799328
	speed: 0.0230s/iter; left time: 31.9810s
	iters: 1000, epoch: 9 | loss: 0.4825034
	speed: 0.0231s/iter; left time: 29.7440s
	iters: 1100, epoch: 9 | loss: 0.4365528
	speed: 0.0229s/iter; left time: 27.2082s
Epoch: 9 cost time: 26.21849751472473
Epoch: 9, Steps: 1144 | Train Loss: 0.4790981 Vali Loss: 0.5035918 Test Loss: 0.2235007
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.23950894176959991, mae:0.2689492404460907
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.4723401
	speed: 0.0210s/iter; left time: 237.7224s
	iters: 200, epoch: 1 | loss: 1.0111145
	speed: 0.0199s/iter; left time: 223.5983s
	iters: 300, epoch: 1 | loss: 0.9217300
	speed: 0.0204s/iter; left time: 227.6634s
	iters: 400, epoch: 1 | loss: 0.5250839
	speed: 0.0200s/iter; left time: 221.3103s
	iters: 500, epoch: 1 | loss: 0.5273214
	speed: 0.0198s/iter; left time: 216.6824s
	iters: 600, epoch: 1 | loss: 0.4559908
	speed: 0.0197s/iter; left time: 213.6351s
	iters: 700, epoch: 1 | loss: 0.4569860
	speed: 0.0199s/iter; left time: 213.9248s
	iters: 800, epoch: 1 | loss: 0.4572925
	speed: 0.0210s/iter; left time: 223.3887s
	iters: 900, epoch: 1 | loss: 0.5094019
	speed: 0.0218s/iter; left time: 229.5572s
	iters: 1000, epoch: 1 | loss: 0.5473484
	speed: 0.0219s/iter; left time: 228.2902s
	iters: 1100, epoch: 1 | loss: 0.4800819
	speed: 0.0219s/iter; left time: 226.7430s
Epoch: 1 cost time: 25.244666814804077
Epoch: 1, Steps: 1144 | Train Loss: 0.5644469 Vali Loss: 0.5187158 Test Loss: 0.2309285
Validation loss decreased (inf --> 0.518716).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4396840
	speed: 0.0435s/iter; left time: 443.2382s
	iters: 200, epoch: 2 | loss: 0.5055223
	speed: 0.0361s/iter; left time: 364.0202s
	iters: 300, epoch: 2 | loss: 1.4040010
	speed: 0.0337s/iter; left time: 336.7194s
	iters: 400, epoch: 2 | loss: 0.4601867
	speed: 0.0321s/iter; left time: 317.9046s
	iters: 500, epoch: 2 | loss: 0.8383672
	speed: 0.0318s/iter; left time: 311.6200s
	iters: 600, epoch: 2 | loss: 0.4556624
	speed: 0.0305s/iter; left time: 295.4455s
	iters: 700, epoch: 2 | loss: 0.3824740
	speed: 0.0293s/iter; left time: 281.5948s
	iters: 800, epoch: 2 | loss: 0.9514753
	speed: 0.0285s/iter; left time: 270.8420s
	iters: 900, epoch: 2 | loss: 0.4150521
	speed: 0.0278s/iter; left time: 261.3172s
	iters: 1000, epoch: 2 | loss: 0.3936597
	speed: 0.0273s/iter; left time: 253.7153s
	iters: 1100, epoch: 2 | loss: 0.3725849
	speed: 0.0269s/iter; left time: 247.3525s
Epoch: 2 cost time: 30.61741328239441
Epoch: 2, Steps: 1144 | Train Loss: 0.5205750 Vali Loss: 0.5076578 Test Loss: 0.2293159
Validation loss decreased (0.518716 --> 0.507658).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4998385
	speed: 0.0236s/iter; left time: 213.9866s
	iters: 200, epoch: 3 | loss: 0.3973837
	speed: 0.0241s/iter; left time: 215.8982s
	iters: 300, epoch: 3 | loss: 0.7910565
	speed: 0.0220s/iter; left time: 195.1817s
	iters: 400, epoch: 3 | loss: 0.9584424
	speed: 0.0234s/iter; left time: 205.1881s
	iters: 500, epoch: 3 | loss: 0.4080745
	speed: 0.0259s/iter; left time: 224.1586s
	iters: 600, epoch: 3 | loss: 0.9357421
	speed: 0.0260s/iter; left time: 222.4130s
	iters: 700, epoch: 3 | loss: 0.4681371
	speed: 0.0257s/iter; left time: 217.3465s
	iters: 800, epoch: 3 | loss: 0.3531455
	speed: 0.0255s/iter; left time: 212.9704s
	iters: 900, epoch: 3 | loss: 0.3481243
	speed: 0.0253s/iter; left time: 208.8891s
	iters: 1000, epoch: 3 | loss: 0.5261491
	speed: 0.0252s/iter; left time: 205.4275s
	iters: 1100, epoch: 3 | loss: 0.5075061
	speed: 0.0248s/iter; left time: 200.0402s
Epoch: 3 cost time: 28.3701593875885
Epoch: 3, Steps: 1144 | Train Loss: 0.5018752 Vali Loss: 0.5095477 Test Loss: 0.2258468
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3892730
	speed: 0.0223s/iter; left time: 176.4169s
	iters: 200, epoch: 4 | loss: 0.4580566
	speed: 0.0208s/iter; left time: 162.0420s
	iters: 300, epoch: 4 | loss: 1.4938530
	speed: 0.0201s/iter; left time: 154.5868s
	iters: 400, epoch: 4 | loss: 0.4113573
	speed: 0.0209s/iter; left time: 158.6700s
	iters: 500, epoch: 4 | loss: 0.4272286
	speed: 0.0222s/iter; left time: 166.6307s
	iters: 600, epoch: 4 | loss: 0.4323587
	speed: 0.0235s/iter; left time: 174.4040s
	iters: 700, epoch: 4 | loss: 0.3451636
	speed: 0.0233s/iter; left time: 170.5885s
	iters: 800, epoch: 4 | loss: 0.4269745
	speed: 0.0232s/iter; left time: 167.1135s
	iters: 900, epoch: 4 | loss: 0.4150114
	speed: 0.0230s/iter; left time: 163.5947s
	iters: 1000, epoch: 4 | loss: 0.3256164
	speed: 0.0230s/iter; left time: 161.2878s
	iters: 1100, epoch: 4 | loss: 0.3675764
	speed: 0.0241s/iter; left time: 166.7060s
Epoch: 4 cost time: 28.21068501472473
Epoch: 4, Steps: 1144 | Train Loss: 0.4915682 Vali Loss: 0.5036509 Test Loss: 0.2218869
Validation loss decreased (0.507658 --> 0.503651).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.7823886
	speed: 0.0318s/iter; left time: 215.3555s
	iters: 200, epoch: 5 | loss: 0.4138571
	speed: 0.0308s/iter; left time: 205.1658s
	iters: 300, epoch: 5 | loss: 0.4352669
	speed: 0.0290s/iter; left time: 190.2272s
	iters: 400, epoch: 5 | loss: 0.3887862
	speed: 0.0304s/iter; left time: 196.3048s
	iters: 500, epoch: 5 | loss: 0.8506513
	speed: 0.0304s/iter; left time: 193.7122s
	iters: 600, epoch: 5 | loss: 0.5333380
	speed: 0.0291s/iter; left time: 182.5448s
	iters: 700, epoch: 5 | loss: 0.4240922
	speed: 0.0283s/iter; left time: 174.3396s
	iters: 800, epoch: 5 | loss: 0.3889012
	speed: 0.0276s/iter; left time: 167.1999s
	iters: 900, epoch: 5 | loss: 0.5073143
	speed: 0.0270s/iter; left time: 161.1075s
	iters: 1000, epoch: 5 | loss: 0.9661335
	speed: 0.0273s/iter; left time: 160.3273s
	iters: 1100, epoch: 5 | loss: 0.4177026
	speed: 0.0278s/iter; left time: 160.1655s
Epoch: 5 cost time: 31.787494659423828
Epoch: 5, Steps: 1144 | Train Loss: 0.4856229 Vali Loss: 0.5031893 Test Loss: 0.2223822
Validation loss decreased (0.503651 --> 0.503189).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3825407
	speed: 0.0303s/iter; left time: 170.1696s
	iters: 200, epoch: 6 | loss: 0.5073382
	speed: 0.0273s/iter; left time: 150.9322s
	iters: 300, epoch: 6 | loss: 0.4450591
	speed: 0.0274s/iter; left time: 148.6237s
	iters: 400, epoch: 6 | loss: 0.4592593
	speed: 0.0264s/iter; left time: 140.3190s
	iters: 500, epoch: 6 | loss: 0.2985852
	speed: 0.0257s/iter; left time: 134.1410s
	iters: 600, epoch: 6 | loss: 0.4100538
	speed: 0.0255s/iter; left time: 130.5056s
	iters: 700, epoch: 6 | loss: 0.3560710
	speed: 0.0252s/iter; left time: 126.6649s
	iters: 800, epoch: 6 | loss: 0.8522921
	speed: 0.0250s/iter; left time: 123.2613s
	iters: 900, epoch: 6 | loss: 0.3362460
	speed: 0.0246s/iter; left time: 118.5940s
	iters: 1000, epoch: 6 | loss: 0.9141167
	speed: 0.0239s/iter; left time: 112.7819s
	iters: 1100, epoch: 6 | loss: 0.8146418
	speed: 0.0233s/iter; left time: 107.6779s
Epoch: 6 cost time: 26.729552268981934
Epoch: 6, Steps: 1144 | Train Loss: 0.4825991 Vali Loss: 0.5033467 Test Loss: 0.2217802
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5778885
	speed: 0.0379s/iter; left time: 169.6592s
	iters: 200, epoch: 7 | loss: 0.3434826
	speed: 0.0351s/iter; left time: 153.7289s
	iters: 300, epoch: 7 | loss: 0.4212266
	speed: 0.0324s/iter; left time: 138.4505s
	iters: 400, epoch: 7 | loss: 0.3722321
	speed: 0.0298s/iter; left time: 124.5522s
	iters: 500, epoch: 7 | loss: 0.3283360
	speed: 0.0290s/iter; left time: 118.2098s
	iters: 600, epoch: 7 | loss: 0.4463221
	speed: 0.0287s/iter; left time: 114.0972s
	iters: 700, epoch: 7 | loss: 0.3391336
	speed: 0.0281s/iter; left time: 108.9338s
	iters: 800, epoch: 7 | loss: 0.5449460
	speed: 0.0277s/iter; left time: 104.4524s
	iters: 900, epoch: 7 | loss: 0.4161397
	speed: 0.0281s/iter; left time: 103.4902s
	iters: 1000, epoch: 7 | loss: 0.3923348
	speed: 0.0276s/iter; left time: 98.7392s
	iters: 1100, epoch: 7 | loss: 0.4136435
	speed: 0.0271s/iter; left time: 94.3255s
Epoch: 7 cost time: 30.93274474143982
Epoch: 7, Steps: 1144 | Train Loss: 0.4806329 Vali Loss: 0.5034494 Test Loss: 0.2218815
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4452850
	speed: 0.0316s/iter; left time: 105.3021s
	iters: 200, epoch: 8 | loss: 0.9046046
	speed: 0.0279s/iter; left time: 90.2507s
	iters: 300, epoch: 8 | loss: 0.4126003
	speed: 0.0266s/iter; left time: 83.3711s
	iters: 400, epoch: 8 | loss: 0.4066775
	speed: 0.0255s/iter; left time: 77.3703s
	iters: 500, epoch: 8 | loss: 0.5598900
	speed: 0.0253s/iter; left time: 74.3015s
	iters: 600, epoch: 8 | loss: 0.3447700
	speed: 0.0263s/iter; left time: 74.4718s
	iters: 700, epoch: 8 | loss: 0.3183363
	speed: 0.0265s/iter; left time: 72.3008s
	iters: 800, epoch: 8 | loss: 0.3934766
	speed: 0.0264s/iter; left time: 69.5466s
	iters: 900, epoch: 8 | loss: 0.4343500
	speed: 0.0263s/iter; left time: 66.5082s
	iters: 1000, epoch: 8 | loss: 0.2965272
	speed: 0.0261s/iter; left time: 63.5293s
	iters: 1100, epoch: 8 | loss: 0.3271551
	speed: 0.0260s/iter; left time: 60.6400s
Epoch: 8 cost time: 29.874345302581787
Epoch: 8, Steps: 1144 | Train Loss: 0.4800296 Vali Loss: 0.5051391 Test Loss: 0.2220450
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.8812864
	speed: 0.0348s/iter; left time: 76.2002s
	iters: 200, epoch: 9 | loss: 0.3781776
	speed: 0.0365s/iter; left time: 76.1701s
	iters: 300, epoch: 9 | loss: 0.8972639
	speed: 0.0361s/iter; left time: 71.8518s
	iters: 400, epoch: 9 | loss: 0.4431455
	speed: 0.0328s/iter; left time: 61.8932s
	iters: 500, epoch: 9 | loss: 0.4364329
	speed: 0.0308s/iter; left time: 55.0559s
	iters: 600, epoch: 9 | loss: 0.8542968
	speed: 0.0295s/iter; left time: 49.7422s
	iters: 700, epoch: 9 | loss: 0.3487424
	speed: 0.0284s/iter; left time: 45.1923s
	iters: 800, epoch: 9 | loss: 0.3959456
	speed: 0.0276s/iter; left time: 41.0677s
	iters: 900, epoch: 9 | loss: 1.0754455
	speed: 0.0267s/iter; left time: 37.0738s
	iters: 1000, epoch: 9 | loss: 0.3698896
	speed: 0.0263s/iter; left time: 33.8921s
	iters: 1100, epoch: 9 | loss: 0.3652115
	speed: 0.0255s/iter; left time: 30.3130s
Epoch: 9 cost time: 28.734725952148438
Epoch: 9, Steps: 1144 | Train Loss: 0.4794289 Vali Loss: 0.5045960 Test Loss: 0.2218530
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3696545
	speed: 0.0288s/iter; left time: 30.1238s
	iters: 200, epoch: 10 | loss: 0.3942644
	speed: 0.0235s/iter; left time: 22.1933s
	iters: 300, epoch: 10 | loss: 0.8134377
	speed: 0.0219s/iter; left time: 18.5236s
	iters: 400, epoch: 10 | loss: 0.2473368
	speed: 0.0221s/iter; left time: 16.4857s
	iters: 500, epoch: 10 | loss: 0.5480722
	speed: 0.0213s/iter; left time: 13.7604s
	iters: 600, epoch: 10 | loss: 0.5133466
	speed: 0.0205s/iter; left time: 11.1787s
	iters: 700, epoch: 10 | loss: 0.3727056
	speed: 0.0199s/iter; left time: 8.8534s
	iters: 800, epoch: 10 | loss: 0.3745003
	speed: 0.0192s/iter; left time: 6.6185s
	iters: 900, epoch: 10 | loss: 0.3046132
	speed: 0.0190s/iter; left time: 4.6558s
	iters: 1000, epoch: 10 | loss: 0.6619726
	speed: 0.0193s/iter; left time: 2.8020s
	iters: 1100, epoch: 10 | loss: 0.5048443
	speed: 0.0198s/iter; left time: 0.8913s
Epoch: 10 cost time: 22.863248348236084
Epoch: 10, Steps: 1144 | Train Loss: 0.4791947 Vali Loss: 0.5045418 Test Loss: 0.2218866
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.22238227725028992, mae:0.25534242391586304
Seed: 42
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_336      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.5670646
	speed: 0.0498s/iter; left time: 562.2917s
	iters: 200, epoch: 1 | loss: 0.5796196
	speed: 0.0369s/iter; left time: 413.5265s
	iters: 300, epoch: 1 | loss: 0.5639460
	speed: 0.0326s/iter; left time: 361.8211s
	iters: 400, epoch: 1 | loss: 0.4429213
	speed: 0.0303s/iter; left time: 333.7684s
	iters: 500, epoch: 1 | loss: 0.4999581
	speed: 0.0288s/iter; left time: 313.4890s
	iters: 600, epoch: 1 | loss: 0.5159578
	speed: 0.0280s/iter; left time: 302.3927s
	iters: 700, epoch: 1 | loss: 0.8994080
	speed: 0.0274s/iter; left time: 293.3231s
	iters: 800, epoch: 1 | loss: 0.6960648
	speed: 0.0271s/iter; left time: 287.1459s
	iters: 900, epoch: 1 | loss: 0.4799012
	speed: 0.0271s/iter; left time: 284.5964s
	iters: 1000, epoch: 1 | loss: 0.5013754
	speed: 0.0269s/iter; left time: 279.4848s
	iters: 1100, epoch: 1 | loss: 1.0748820
	speed: 0.0268s/iter; left time: 275.6768s
Epoch: 1 cost time: 30.501939058303833
Epoch: 1, Steps: 1140 | Train Loss: 0.6308255 Vali Loss: 0.6000355 Test Loss: 0.2861440
Validation loss decreased (inf --> 0.600036).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5611085
	speed: 0.0315s/iter; left time: 319.7134s
	iters: 200, epoch: 2 | loss: 0.6007703
	speed: 0.0267s/iter; left time: 268.1597s
	iters: 300, epoch: 2 | loss: 0.9493411
	speed: 0.0251s/iter; left time: 250.2995s
	iters: 400, epoch: 2 | loss: 0.4494994
	speed: 0.0248s/iter; left time: 244.4412s
	iters: 500, epoch: 2 | loss: 0.4761202
	speed: 0.0248s/iter; left time: 242.2935s
	iters: 600, epoch: 2 | loss: 0.5504429
	speed: 0.0243s/iter; left time: 234.5904s
	iters: 700, epoch: 2 | loss: 0.5243859
	speed: 0.0234s/iter; left time: 223.7121s
	iters: 800, epoch: 2 | loss: 0.5187458
	speed: 0.0230s/iter; left time: 217.3877s
	iters: 900, epoch: 2 | loss: 0.5015861
	speed: 0.0226s/iter; left time: 211.7773s
	iters: 1000, epoch: 2 | loss: 0.4645322
	speed: 0.0223s/iter; left time: 206.4122s
	iters: 1100, epoch: 2 | loss: 0.5039551
	speed: 0.0224s/iter; left time: 205.4170s
Epoch: 2 cost time: 25.76112151145935
Epoch: 2, Steps: 1140 | Train Loss: 0.5925039 Vali Loss: 0.6092454 Test Loss: 0.2865889
EarlyStopping counter: 1 out of 5
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4382445
	speed: 0.0322s/iter; left time: 290.6723s
	iters: 200, epoch: 3 | loss: 0.4779150
	speed: 0.0262s/iter; left time: 233.7977s
	iters: 300, epoch: 3 | loss: 0.5029409
	speed: 0.0230s/iter; left time: 203.2242s
	iters: 400, epoch: 3 | loss: 0.7356858
	speed: 0.0220s/iter; left time: 191.7760s
	iters: 500, epoch: 3 | loss: 0.4601711
	speed: 0.0222s/iter; left time: 191.1648s
	iters: 600, epoch: 3 | loss: 0.3830967
	speed: 0.0224s/iter; left time: 190.5305s
	iters: 700, epoch: 3 | loss: 0.5345683
	speed: 0.0224s/iter; left time: 188.4545s
	iters: 800, epoch: 3 | loss: 0.5311645
	speed: 0.0220s/iter; left time: 182.7898s
	iters: 900, epoch: 3 | loss: 0.4257909
	speed: 0.0221s/iter; left time: 182.0488s
	iters: 1000, epoch: 3 | loss: 0.7691061
	speed: 0.0220s/iter; left time: 178.6872s
	iters: 1100, epoch: 3 | loss: 0.6159554
	speed: 0.0220s/iter; left time: 176.4005s
Epoch: 3 cost time: 25.24645447731018
Epoch: 3, Steps: 1140 | Train Loss: 0.5762645 Vali Loss: 0.5929290 Test Loss: 0.2815973
Validation loss decreased (0.600036 --> 0.592929).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4752589
	speed: 0.0416s/iter; left time: 327.5025s
	iters: 200, epoch: 4 | loss: 0.4664270
	speed: 0.0397s/iter; left time: 308.6157s
	iters: 300, epoch: 4 | loss: 0.4543517
	speed: 0.0376s/iter; left time: 288.4807s
	iters: 400, epoch: 4 | loss: 0.5621926
	speed: 0.0371s/iter; left time: 280.9692s
	iters: 500, epoch: 4 | loss: 0.4784601
	speed: 0.0338s/iter; left time: 252.9032s
	iters: 600, epoch: 4 | loss: 0.4086106
	speed: 0.0313s/iter; left time: 231.3296s
	iters: 700, epoch: 4 | loss: 0.5282983
	speed: 0.0296s/iter; left time: 215.8535s
	iters: 800, epoch: 4 | loss: 0.7167674
	speed: 0.0284s/iter; left time: 204.1186s
	iters: 900, epoch: 4 | loss: 0.5662495
	speed: 0.0275s/iter; left time: 194.6387s
	iters: 1000, epoch: 4 | loss: 0.4761056
	speed: 0.0276s/iter; left time: 192.9119s
	iters: 1100, epoch: 4 | loss: 0.4552668
	speed: 0.0282s/iter; left time: 194.3377s
Epoch: 4 cost time: 32.63529348373413
Epoch: 4, Steps: 1140 | Train Loss: 0.5637220 Vali Loss: 0.5928057 Test Loss: 0.2820185
Validation loss decreased (0.592929 --> 0.592806).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3882996
	speed: 0.0265s/iter; left time: 178.9018s
	iters: 200, epoch: 5 | loss: 0.3950227
	speed: 0.0245s/iter; left time: 162.5116s
	iters: 300, epoch: 5 | loss: 0.4165155
	speed: 0.0238s/iter; left time: 155.8856s
	iters: 400, epoch: 5 | loss: 0.4866949
	speed: 0.0249s/iter; left time: 160.5371s
	iters: 500, epoch: 5 | loss: 0.4628770
	speed: 0.0252s/iter; left time: 159.9682s
	iters: 600, epoch: 5 | loss: 0.4812213
	speed: 0.0245s/iter; left time: 152.6068s
	iters: 700, epoch: 5 | loss: 0.4430150
	speed: 0.0237s/iter; left time: 145.6371s
	iters: 800, epoch: 5 | loss: 0.4516079
	speed: 0.0230s/iter; left time: 138.9857s
	iters: 900, epoch: 5 | loss: 0.4473705
	speed: 0.0228s/iter; left time: 135.3211s
	iters: 1000, epoch: 5 | loss: 1.0243356
	speed: 0.0224s/iter; left time: 130.9510s
	iters: 1100, epoch: 5 | loss: 0.4273109
	speed: 0.0224s/iter; left time: 128.8605s
Epoch: 5 cost time: 25.477504014968872
Epoch: 5, Steps: 1140 | Train Loss: 0.5570842 Vali Loss: 0.5958198 Test Loss: 0.2820855
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4637171
	speed: 0.0240s/iter; left time: 134.6349s
	iters: 200, epoch: 6 | loss: 0.7049924
	speed: 0.0223s/iter; left time: 122.7644s
	iters: 300, epoch: 6 | loss: 0.5463477
	speed: 0.0212s/iter; left time: 114.6413s
	iters: 400, epoch: 6 | loss: 0.3786724
	speed: 0.0209s/iter; left time: 110.6581s
	iters: 500, epoch: 6 | loss: 0.4812709
	speed: 0.0213s/iter; left time: 110.9493s
	iters: 600, epoch: 6 | loss: 0.4431844
	speed: 0.0216s/iter; left time: 110.2831s
	iters: 700, epoch: 6 | loss: 0.3810338
	speed: 0.0217s/iter; left time: 108.6328s
	iters: 800, epoch: 6 | loss: 0.6919800
	speed: 0.0215s/iter; left time: 105.2803s
	iters: 900, epoch: 6 | loss: 0.6748514
	speed: 0.0211s/iter; left time: 101.4724s
	iters: 1000, epoch: 6 | loss: 0.4522565
	speed: 0.0209s/iter; left time: 98.4152s
	iters: 1100, epoch: 6 | loss: 0.4453492
	speed: 0.0207s/iter; left time: 95.2894s
Epoch: 6 cost time: 23.746517658233643
Epoch: 6, Steps: 1140 | Train Loss: 0.5532793 Vali Loss: 0.5926053 Test Loss: 0.2812384
Validation loss decreased (0.592806 --> 0.592605).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.6530194
	speed: 0.0288s/iter; left time: 128.5142s
	iters: 200, epoch: 7 | loss: 0.4077115
	speed: 0.0256s/iter; left time: 111.6057s
	iters: 300, epoch: 7 | loss: 0.4084630
	speed: 0.0245s/iter; left time: 104.5558s
	iters: 400, epoch: 7 | loss: 0.4425007
	speed: 0.0243s/iter; left time: 101.0246s
	iters: 500, epoch: 7 | loss: 0.4070822
	speed: 0.0245s/iter; left time: 99.3551s
	iters: 600, epoch: 7 | loss: 0.4166880
	speed: 0.0246s/iter; left time: 97.5354s
	iters: 700, epoch: 7 | loss: 0.4792250
	speed: 0.0243s/iter; left time: 93.8718s
	iters: 800, epoch: 7 | loss: 0.4467096
	speed: 0.0236s/iter; left time: 88.9394s
	iters: 900, epoch: 7 | loss: 0.4166369
	speed: 0.0232s/iter; left time: 84.9385s
	iters: 1000, epoch: 7 | loss: 0.4649194
	speed: 0.0227s/iter; left time: 80.7543s
	iters: 1100, epoch: 7 | loss: 0.4321647
	speed: 0.0226s/iter; left time: 78.2973s
Epoch: 7 cost time: 26.001683235168457
Epoch: 7, Steps: 1140 | Train Loss: 0.5513605 Vali Loss: 0.5900555 Test Loss: 0.2809124
Validation loss decreased (0.592605 --> 0.590056).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.6719173
	speed: 0.0396s/iter; left time: 131.3802s
	iters: 200, epoch: 8 | loss: 0.4783094
	speed: 0.0377s/iter; left time: 121.5405s
	iters: 300, epoch: 8 | loss: 0.3858759
	speed: 0.0360s/iter; left time: 112.4501s
	iters: 400, epoch: 8 | loss: 0.7640715
	speed: 0.0328s/iter; left time: 99.2387s
	iters: 500, epoch: 8 | loss: 0.6096704
	speed: 0.0307s/iter; left time: 89.6175s
	iters: 600, epoch: 8 | loss: 0.6695067
	speed: 0.0292s/iter; left time: 82.4874s
	iters: 700, epoch: 8 | loss: 0.4211365
	speed: 0.0281s/iter; left time: 76.5424s
	iters: 800, epoch: 8 | loss: 0.5144364
	speed: 0.0284s/iter; left time: 74.5126s
	iters: 900, epoch: 8 | loss: 0.7982069
	speed: 0.0284s/iter; left time: 71.6535s
	iters: 1000, epoch: 8 | loss: 0.5300310
	speed: 0.0286s/iter; left time: 69.3526s
	iters: 1100, epoch: 8 | loss: 0.4020379
	speed: 0.0282s/iter; left time: 65.5135s
Epoch: 8 cost time: 32.10025143623352
Epoch: 8, Steps: 1140 | Train Loss: 0.5504598 Vali Loss: 0.5908927 Test Loss: 0.2807757
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4590559
	speed: 0.0242s/iter; left time: 52.7143s
	iters: 200, epoch: 9 | loss: 0.6758305
	speed: 0.0228s/iter; left time: 47.3514s
	iters: 300, epoch: 9 | loss: 0.6946878
	speed: 0.0233s/iter; left time: 46.1297s
	iters: 400, epoch: 9 | loss: 0.7039868
	speed: 0.0230s/iter; left time: 43.2692s
	iters: 500, epoch: 9 | loss: 0.6894415
	speed: 0.0222s/iter; left time: 39.5412s
	iters: 600, epoch: 9 | loss: 1.0241235
	speed: 0.0216s/iter; left time: 36.3887s
	iters: 700, epoch: 9 | loss: 0.3857161
	speed: 0.0210s/iter; left time: 33.1288s
	iters: 800, epoch: 9 | loss: 0.7250345
	speed: 0.0207s/iter; left time: 30.5960s
	iters: 900, epoch: 9 | loss: 0.7730359
	speed: 0.0206s/iter; left time: 28.4662s
	iters: 1000, epoch: 9 | loss: 0.8097265
	speed: 0.0207s/iter; left time: 26.5778s
	iters: 1100, epoch: 9 | loss: 0.7112957
	speed: 0.0211s/iter; left time: 24.9454s
Epoch: 9 cost time: 24.360538959503174
Epoch: 9, Steps: 1140 | Train Loss: 0.5502034 Vali Loss: 0.5907376 Test Loss: 0.2809175
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.4391211
	speed: 0.0460s/iter; left time: 47.8932s
	iters: 200, epoch: 10 | loss: 0.4578711
	speed: 0.0383s/iter; left time: 36.0724s
	iters: 300, epoch: 10 | loss: 0.4785244
	speed: 0.0331s/iter; left time: 27.8310s
	iters: 400, epoch: 10 | loss: 0.5095197
	speed: 0.0304s/iter; left time: 22.5447s
	iters: 500, epoch: 10 | loss: 0.5142561
	speed: 0.0286s/iter; left time: 18.3502s
	iters: 600, epoch: 10 | loss: 0.4485600
	speed: 0.0266s/iter; left time: 14.3913s
	iters: 700, epoch: 10 | loss: 0.4351791
	speed: 0.0256s/iter; left time: 11.2785s
	iters: 800, epoch: 10 | loss: 0.4268451
	speed: 0.0249s/iter; left time: 8.4860s
	iters: 900, epoch: 10 | loss: 0.3856876
	speed: 0.0243s/iter; left time: 5.8659s
	iters: 1000, epoch: 10 | loss: 0.5213751
	speed: 0.0241s/iter; left time: 3.3966s
	iters: 1100, epoch: 10 | loss: 0.4266213
	speed: 0.0241s/iter; left time: 0.9878s
Epoch: 10 cost time: 27.607532024383545
Epoch: 10, Steps: 1140 | Train Loss: 0.5497509 Vali Loss: 0.5943166 Test Loss: 0.2810700
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.2809123992919922, mae:0.29945945739746094
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 1.0203986
	speed: 0.0365s/iter; left time: 411.9337s
	iters: 200, epoch: 1 | loss: 0.7763004
	speed: 0.0323s/iter; left time: 361.8402s
	iters: 300, epoch: 1 | loss: 0.4453030
	speed: 0.0291s/iter; left time: 323.1077s
	iters: 400, epoch: 1 | loss: 0.7419902
	speed: 0.0268s/iter; left time: 294.7556s
	iters: 500, epoch: 1 | loss: 1.0065507
	speed: 0.0255s/iter; left time: 278.1357s
	iters: 600, epoch: 1 | loss: 0.5362920
	speed: 0.0262s/iter; left time: 282.4957s
	iters: 700, epoch: 1 | loss: 0.4513112
	speed: 0.0259s/iter; left time: 277.0871s
	iters: 800, epoch: 1 | loss: 0.4069179
	speed: 0.0247s/iter; left time: 262.3716s
	iters: 900, epoch: 1 | loss: 0.5846109
	speed: 0.0240s/iter; left time: 251.7807s
	iters: 1000, epoch: 1 | loss: 0.5386731
	speed: 0.0233s/iter; left time: 242.7195s
	iters: 1100, epoch: 1 | loss: 0.7110226
	speed: 0.0227s/iter; left time: 233.9003s
Epoch: 1 cost time: 25.874130725860596
Epoch: 1, Steps: 1140 | Train Loss: 0.6352427 Vali Loss: 0.6194363 Test Loss: 0.2894516
Validation loss decreased (inf --> 0.619436).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8666630
	speed: 0.0242s/iter; left time: 246.3391s
	iters: 200, epoch: 2 | loss: 0.5122535
	speed: 0.0226s/iter; left time: 227.4040s
	iters: 300, epoch: 2 | loss: 0.4936013
	speed: 0.0217s/iter; left time: 215.7271s
	iters: 400, epoch: 2 | loss: 0.4893152
	speed: 0.0229s/iter; left time: 226.1339s
	iters: 500, epoch: 2 | loss: 0.5441429
	speed: 0.0250s/iter; left time: 243.5386s
	iters: 600, epoch: 2 | loss: 0.6031694
	speed: 0.0262s/iter; left time: 252.8469s
	iters: 700, epoch: 2 | loss: 0.4716539
	speed: 0.0260s/iter; left time: 248.2267s
	iters: 800, epoch: 2 | loss: 0.5675344
	speed: 0.0258s/iter; left time: 243.9477s
	iters: 900, epoch: 2 | loss: 0.4533732
	speed: 0.0257s/iter; left time: 240.1507s
	iters: 1000, epoch: 2 | loss: 0.4618858
	speed: 0.0256s/iter; left time: 236.7731s
	iters: 1100, epoch: 2 | loss: 0.8229024
	speed: 0.0255s/iter; left time: 233.4595s
Epoch: 2 cost time: 29.179619550704956
Epoch: 2, Steps: 1140 | Train Loss: 0.5942915 Vali Loss: 0.5960479 Test Loss: 0.2829904
Validation loss decreased (0.619436 --> 0.596048).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7744665
	speed: 0.0359s/iter; left time: 323.4435s
	iters: 200, epoch: 3 | loss: 0.5528427
	speed: 0.0345s/iter; left time: 307.6988s
	iters: 300, epoch: 3 | loss: 0.5194323
	speed: 0.0351s/iter; left time: 309.5271s
	iters: 400, epoch: 3 | loss: 0.6417800
	speed: 0.0352s/iter; left time: 307.3947s
	iters: 500, epoch: 3 | loss: 0.4876560
	speed: 0.0345s/iter; left time: 297.8338s
	iters: 600, epoch: 3 | loss: 0.4627208
	speed: 0.0337s/iter; left time: 287.2126s
	iters: 700, epoch: 3 | loss: 0.4941894
	speed: 0.0321s/iter; left time: 270.2128s
	iters: 800, epoch: 3 | loss: 0.4686837
	speed: 0.0311s/iter; left time: 258.5288s
	iters: 900, epoch: 3 | loss: 0.5001749
	speed: 0.0303s/iter; left time: 249.2043s
	iters: 1000, epoch: 3 | loss: 0.7212858
	speed: 0.0295s/iter; left time: 239.4708s
	iters: 1100, epoch: 3 | loss: 0.4427471
	speed: 0.0289s/iter; left time: 231.6915s
Epoch: 3 cost time: 32.804025650024414
Epoch: 3, Steps: 1140 | Train Loss: 0.5734429 Vali Loss: 0.5862291 Test Loss: 0.2800358
Validation loss decreased (0.596048 --> 0.586229).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6055111
	speed: 0.0389s/iter; left time: 306.6544s
	iters: 200, epoch: 4 | loss: 0.7218339
	speed: 0.0376s/iter; left time: 292.8891s
	iters: 300, epoch: 4 | loss: 0.4177620
	speed: 0.0377s/iter; left time: 289.2659s
	iters: 400, epoch: 4 | loss: 0.5224112
	speed: 0.0337s/iter; left time: 255.6953s
	iters: 500, epoch: 4 | loss: 0.7907917
	speed: 0.0304s/iter; left time: 227.7772s
	iters: 600, epoch: 4 | loss: 0.5289844
	speed: 0.0283s/iter; left time: 208.9923s
	iters: 700, epoch: 4 | loss: 0.4799259
	speed: 0.0274s/iter; left time: 199.1542s
	iters: 800, epoch: 4 | loss: 0.7669483
	speed: 0.0265s/iter; left time: 190.0585s
	iters: 900, epoch: 4 | loss: 0.5022625
	speed: 0.0257s/iter; left time: 182.1738s
	iters: 1000, epoch: 4 | loss: 0.4535142
	speed: 0.0249s/iter; left time: 174.0111s
	iters: 1100, epoch: 4 | loss: 0.7360570
	speed: 0.0243s/iter; left time: 166.8796s
Epoch: 4 cost time: 27.92439365386963
Epoch: 4, Steps: 1140 | Train Loss: 0.5619569 Vali Loss: 0.5914831 Test Loss: 0.2810236
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.7062706
	speed: 0.0426s/iter; left time: 286.9075s
	iters: 200, epoch: 5 | loss: 0.7195873
	speed: 0.0399s/iter; left time: 264.9227s
	iters: 300, epoch: 5 | loss: 0.4150407
	speed: 0.0377s/iter; left time: 246.5551s
	iters: 400, epoch: 5 | loss: 0.8087772
	speed: 0.0371s/iter; left time: 238.9485s
	iters: 500, epoch: 5 | loss: 0.5065419
	speed: 0.0346s/iter; left time: 219.2449s
	iters: 600, epoch: 5 | loss: 0.4256373
	speed: 0.0327s/iter; left time: 203.7768s
	iters: 700, epoch: 5 | loss: 0.5369469
	speed: 0.0320s/iter; left time: 196.3579s
	iters: 800, epoch: 5 | loss: 0.8136312
	speed: 0.0319s/iter; left time: 192.8484s
	iters: 900, epoch: 5 | loss: 0.4978099
	speed: 0.0315s/iter; left time: 187.3376s
	iters: 1000, epoch: 5 | loss: 0.5055603
	speed: 0.0304s/iter; left time: 177.5343s
	iters: 1100, epoch: 5 | loss: 0.6121107
	speed: 0.0294s/iter; left time: 168.5656s
Epoch: 5 cost time: 33.25631070137024
Epoch: 5, Steps: 1140 | Train Loss: 0.5551236 Vali Loss: 0.5897540 Test Loss: 0.2820062
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4720552
	speed: 0.0230s/iter; left time: 129.0856s
	iters: 200, epoch: 6 | loss: 0.4039880
	speed: 0.0278s/iter; left time: 153.1902s
	iters: 300, epoch: 6 | loss: 0.5000518
	speed: 0.0284s/iter; left time: 153.1950s
	iters: 400, epoch: 6 | loss: 0.4967886
	speed: 0.0270s/iter; left time: 143.0793s
	iters: 500, epoch: 6 | loss: 0.4766144
	speed: 0.0264s/iter; left time: 137.2136s
	iters: 600, epoch: 6 | loss: 0.4199403
	speed: 0.0258s/iter; left time: 131.4604s
	iters: 700, epoch: 6 | loss: 0.3811623
	speed: 0.0263s/iter; left time: 131.2940s
	iters: 800, epoch: 6 | loss: 0.6852484
	speed: 0.0260s/iter; left time: 127.5047s
	iters: 900, epoch: 6 | loss: 0.6031830
	speed: 0.0256s/iter; left time: 122.8971s
	iters: 1000, epoch: 6 | loss: 0.5013219
	speed: 0.0253s/iter; left time: 118.7583s
	iters: 1100, epoch: 6 | loss: 0.5189178
	speed: 0.0250s/iter; left time: 115.0124s
Epoch: 6 cost time: 28.532172203063965
Epoch: 6, Steps: 1140 | Train Loss: 0.5515731 Vali Loss: 0.5876583 Test Loss: 0.2805230
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5135459
	speed: 0.0358s/iter; left time: 159.8706s
	iters: 200, epoch: 7 | loss: 0.8108920
	speed: 0.0302s/iter; left time: 131.5835s
	iters: 300, epoch: 7 | loss: 0.8145273
	speed: 0.0284s/iter; left time: 121.1721s
	iters: 400, epoch: 7 | loss: 0.7711697
	speed: 0.0271s/iter; left time: 112.6580s
	iters: 500, epoch: 7 | loss: 0.7057678
	speed: 0.0258s/iter; left time: 104.6923s
	iters: 600, epoch: 7 | loss: 0.7551892
	speed: 0.0250s/iter; left time: 99.0746s
	iters: 700, epoch: 7 | loss: 0.4243825
	speed: 0.0243s/iter; left time: 93.6657s
	iters: 800, epoch: 7 | loss: 0.7531447
	speed: 0.0232s/iter; left time: 87.2355s
	iters: 900, epoch: 7 | loss: 0.4578434
	speed: 0.0223s/iter; left time: 81.6461s
	iters: 1000, epoch: 7 | loss: 0.4329165
	speed: 0.0215s/iter; left time: 76.6374s
	iters: 1100, epoch: 7 | loss: 0.7927671
	speed: 0.0211s/iter; left time: 73.1649s
Epoch: 7 cost time: 24.12507700920105
Epoch: 7, Steps: 1140 | Train Loss: 0.5498735 Vali Loss: 0.5886407 Test Loss: 0.2809249
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4730580
	speed: 0.0339s/iter; left time: 112.5021s
	iters: 200, epoch: 8 | loss: 0.5887069
	speed: 0.0339s/iter; left time: 109.3221s
	iters: 300, epoch: 8 | loss: 0.7184277
	speed: 0.0342s/iter; left time: 106.6923s
	iters: 400, epoch: 8 | loss: 0.8768316
	speed: 0.0346s/iter; left time: 104.4916s
	iters: 500, epoch: 8 | loss: 0.7566727
	speed: 0.0325s/iter; left time: 94.8751s
	iters: 600, epoch: 8 | loss: 0.5002317
	speed: 0.0307s/iter; left time: 86.6446s
	iters: 700, epoch: 8 | loss: 0.4960329
	speed: 0.0296s/iter; left time: 80.5062s
	iters: 800, epoch: 8 | loss: 0.5481994
	speed: 0.0286s/iter; left time: 74.9846s
	iters: 900, epoch: 8 | loss: 0.5172110
	speed: 0.0292s/iter; left time: 73.5492s
	iters: 1000, epoch: 8 | loss: 0.4377215
	speed: 0.0298s/iter; left time: 72.1940s
	iters: 1100, epoch: 8 | loss: 0.4653549
	speed: 0.0292s/iter; left time: 67.8287s
Epoch: 8 cost time: 33.14349102973938
Epoch: 8, Steps: 1140 | Train Loss: 0.5494236 Vali Loss: 0.5891916 Test Loss: 0.2810380
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.2800357937812805, mae:0.29843270778656006
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.8900770
	speed: 0.0393s/iter; left time: 444.5388s
	iters: 200, epoch: 1 | loss: 0.4655524
	speed: 0.0361s/iter; left time: 404.8025s
	iters: 300, epoch: 1 | loss: 0.5817633
	speed: 0.0356s/iter; left time: 395.4739s
	iters: 400, epoch: 1 | loss: 0.6270704
	speed: 0.0329s/iter; left time: 361.8607s
	iters: 500, epoch: 1 | loss: 0.8067304
	speed: 0.0307s/iter; left time: 334.5942s
	iters: 600, epoch: 1 | loss: 0.4693941
	speed: 0.0292s/iter; left time: 315.6028s
	iters: 700, epoch: 1 | loss: 0.4520603
	speed: 0.0283s/iter; left time: 302.6160s
	iters: 800, epoch: 1 | loss: 0.4949282
	speed: 0.0276s/iter; left time: 292.7348s
	iters: 900, epoch: 1 | loss: 0.6317562
	speed: 0.0273s/iter; left time: 287.1024s
	iters: 1000, epoch: 1 | loss: 0.4659834
	speed: 0.0271s/iter; left time: 282.3511s
	iters: 1100, epoch: 1 | loss: 0.8370923
	speed: 0.0267s/iter; left time: 275.4702s
Epoch: 1 cost time: 30.468671560287476
Epoch: 1, Steps: 1140 | Train Loss: 0.6374622 Vali Loss: 0.6109956 Test Loss: 0.2881451
Validation loss decreased (inf --> 0.610996).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7510977
	speed: 0.0400s/iter; left time: 406.3674s
	iters: 200, epoch: 2 | loss: 0.5502788
	speed: 0.0353s/iter; left time: 355.5397s
	iters: 300, epoch: 2 | loss: 0.5047489
	speed: 0.0310s/iter; left time: 309.0299s
	iters: 400, epoch: 2 | loss: 0.7412109
	speed: 0.0284s/iter; left time: 280.2739s
	iters: 500, epoch: 2 | loss: 0.4578215
	speed: 0.0262s/iter; left time: 255.7596s
	iters: 600, epoch: 2 | loss: 0.4784738
	speed: 0.0251s/iter; left time: 242.3370s
	iters: 700, epoch: 2 | loss: 0.5744460
	speed: 0.0252s/iter; left time: 241.2334s
	iters: 800, epoch: 2 | loss: 0.5406439
	speed: 0.0244s/iter; left time: 231.1941s
	iters: 900, epoch: 2 | loss: 0.4639544
	speed: 0.0248s/iter; left time: 231.8956s
	iters: 1000, epoch: 2 | loss: 0.6701461
	speed: 0.0255s/iter; left time: 236.2465s
	iters: 1100, epoch: 2 | loss: 0.8003002
	speed: 0.0252s/iter; left time: 230.7817s
Epoch: 2 cost time: 28.7332124710083
Epoch: 2, Steps: 1140 | Train Loss: 0.5962490 Vali Loss: 0.6083362 Test Loss: 0.2852035
Validation loss decreased (0.610996 --> 0.608336).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5010761
	speed: 0.0264s/iter; left time: 237.9827s
	iters: 200, epoch: 3 | loss: 0.5071522
	speed: 0.0243s/iter; left time: 217.1886s
	iters: 300, epoch: 3 | loss: 0.4916363
	speed: 0.0234s/iter; left time: 206.1260s
	iters: 400, epoch: 3 | loss: 0.3722756
	speed: 0.0229s/iter; left time: 199.5019s
	iters: 500, epoch: 3 | loss: 0.5864471
	speed: 0.0221s/iter; left time: 190.9092s
	iters: 600, epoch: 3 | loss: 0.4185627
	speed: 0.0219s/iter; left time: 186.8365s
	iters: 700, epoch: 3 | loss: 0.5470266
	speed: 0.0218s/iter; left time: 183.5712s
	iters: 800, epoch: 3 | loss: 0.4779171
	speed: 0.0222s/iter; left time: 184.3805s
	iters: 900, epoch: 3 | loss: 0.4731575
	speed: 0.0225s/iter; left time: 184.6105s
	iters: 1000, epoch: 3 | loss: 0.4723041
	speed: 0.0227s/iter; left time: 184.3430s
	iters: 1100, epoch: 3 | loss: 0.5219150
	speed: 0.0229s/iter; left time: 183.3573s
Epoch: 3 cost time: 26.3998281955719
Epoch: 3, Steps: 1140 | Train Loss: 0.5774338 Vali Loss: 0.5963982 Test Loss: 0.2823315
Validation loss decreased (0.608336 --> 0.596398).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4853162
	speed: 0.0424s/iter; left time: 334.0941s
	iters: 200, epoch: 4 | loss: 0.7177434
	speed: 0.0393s/iter; left time: 305.6819s
	iters: 300, epoch: 4 | loss: 0.5652546
	speed: 0.0346s/iter; left time: 265.9067s
	iters: 400, epoch: 4 | loss: 0.5800851
	speed: 0.0306s/iter; left time: 231.8874s
	iters: 500, epoch: 4 | loss: 0.5678237
	speed: 0.0300s/iter; left time: 224.4887s
	iters: 600, epoch: 4 | loss: 0.5814746
	speed: 0.0292s/iter; left time: 215.5746s
	iters: 700, epoch: 4 | loss: 0.5056089
	speed: 0.0285s/iter; left time: 207.7035s
	iters: 800, epoch: 4 | loss: 0.5088702
	speed: 0.0280s/iter; left time: 201.2164s
	iters: 900, epoch: 4 | loss: 0.4273703
	speed: 0.0276s/iter; left time: 195.5813s
	iters: 1000, epoch: 4 | loss: 0.5921781
	speed: 0.0274s/iter; left time: 191.0499s
	iters: 1100, epoch: 4 | loss: 0.4412822
	speed: 0.0271s/iter; left time: 186.6880s
Epoch: 4 cost time: 30.882845163345337
Epoch: 4, Steps: 1140 | Train Loss: 0.5670648 Vali Loss: 0.5918345 Test Loss: 0.2814983
Validation loss decreased (0.596398 --> 0.591834).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4632480
	speed: 0.0447s/iter; left time: 301.1260s
	iters: 200, epoch: 5 | loss: 0.7859991
	speed: 0.0391s/iter; left time: 259.7868s
	iters: 300, epoch: 5 | loss: 0.4907065
	speed: 0.0350s/iter; left time: 228.9071s
	iters: 400, epoch: 5 | loss: 0.6622939
	speed: 0.0315s/iter; left time: 203.0515s
	iters: 500, epoch: 5 | loss: 0.4443368
	speed: 0.0285s/iter; left time: 180.9210s
	iters: 600, epoch: 5 | loss: 0.5065222
	speed: 0.0271s/iter; left time: 168.9191s
	iters: 700, epoch: 5 | loss: 0.6703212
	speed: 0.0258s/iter; left time: 158.2294s
	iters: 800, epoch: 5 | loss: 0.5046874
	speed: 0.0248s/iter; left time: 149.8364s
	iters: 900, epoch: 5 | loss: 0.5625480
	speed: 0.0242s/iter; left time: 143.5354s
	iters: 1000, epoch: 5 | loss: 0.8286337
	speed: 0.0235s/iter; left time: 137.1236s
	iters: 1100, epoch: 5 | loss: 0.5331941
	speed: 0.0238s/iter; left time: 136.4242s
Epoch: 5 cost time: 27.14806032180786
Epoch: 5, Steps: 1140 | Train Loss: 0.5600606 Vali Loss: 0.5994193 Test Loss: 0.2821217
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5093144
	speed: 0.0359s/iter; left time: 201.0274s
	iters: 200, epoch: 6 | loss: 0.7699288
	speed: 0.0290s/iter; left time: 159.5408s
	iters: 300, epoch: 6 | loss: 0.9057350
	speed: 0.0272s/iter; left time: 146.7024s
	iters: 400, epoch: 6 | loss: 0.4562333
	speed: 0.0265s/iter; left time: 140.4835s
	iters: 500, epoch: 6 | loss: 1.0041417
	speed: 0.0262s/iter; left time: 136.5125s
	iters: 600, epoch: 6 | loss: 0.5657151
	speed: 0.0257s/iter; left time: 130.9352s
	iters: 700, epoch: 6 | loss: 0.5398471
	speed: 0.0252s/iter; left time: 126.0927s
	iters: 800, epoch: 6 | loss: 0.5808040
	speed: 0.0248s/iter; left time: 121.6396s
	iters: 900, epoch: 6 | loss: 0.7596041
	speed: 0.0245s/iter; left time: 117.6060s
	iters: 1000, epoch: 6 | loss: 0.7999123
	speed: 0.0250s/iter; left time: 117.6022s
	iters: 1100, epoch: 6 | loss: 0.4628461
	speed: 0.0249s/iter; left time: 114.6019s
Epoch: 6 cost time: 28.40272545814514
Epoch: 6, Steps: 1140 | Train Loss: 0.5565608 Vali Loss: 0.5948521 Test Loss: 0.2814953
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4984039
	speed: 0.0292s/iter; left time: 130.1446s
	iters: 200, epoch: 7 | loss: 0.5603070
	speed: 0.0262s/iter; left time: 114.0738s
	iters: 300, epoch: 7 | loss: 0.6999775
	speed: 0.0248s/iter; left time: 105.8744s
	iters: 400, epoch: 7 | loss: 0.4462439
	speed: 0.0245s/iter; left time: 102.0423s
	iters: 500, epoch: 7 | loss: 0.4694528
	speed: 0.0266s/iter; left time: 108.1171s
	iters: 600, epoch: 7 | loss: 0.5283592
	speed: 0.0278s/iter; left time: 110.1927s
	iters: 700, epoch: 7 | loss: 0.4529218
	speed: 0.0285s/iter; left time: 110.1886s
	iters: 800, epoch: 7 | loss: 0.4263659
	speed: 0.0291s/iter; left time: 109.5604s
	iters: 900, epoch: 7 | loss: 0.4394323
	speed: 0.0294s/iter; left time: 107.5140s
	iters: 1000, epoch: 7 | loss: 0.3714716
	speed: 0.0286s/iter; left time: 101.7067s
	iters: 1100, epoch: 7 | loss: 0.6540597
	speed: 0.0287s/iter; left time: 99.4008s
Epoch: 7 cost time: 32.79928994178772
Epoch: 7, Steps: 1140 | Train Loss: 0.5546877 Vali Loss: 0.5948577 Test Loss: 0.2813965
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.7816039
	speed: 0.0397s/iter; left time: 131.8908s
	iters: 200, epoch: 8 | loss: 0.4465699
	speed: 0.0348s/iter; left time: 112.2230s
	iters: 300, epoch: 8 | loss: 0.4089558
	speed: 0.0298s/iter; left time: 93.0631s
	iters: 400, epoch: 8 | loss: 0.4078328
	speed: 0.0273s/iter; left time: 82.4441s
	iters: 500, epoch: 8 | loss: 0.7621177
	speed: 0.0259s/iter; left time: 75.5745s
	iters: 600, epoch: 8 | loss: 0.4693208
	speed: 0.0245s/iter; left time: 69.0736s
	iters: 700, epoch: 8 | loss: 0.8056809
	speed: 0.0234s/iter; left time: 63.6887s
	iters: 800, epoch: 8 | loss: 0.7533159
	speed: 0.0228s/iter; left time: 59.6751s
	iters: 900, epoch: 8 | loss: 0.5096861
	speed: 0.0240s/iter; left time: 60.5362s
	iters: 1000, epoch: 8 | loss: 0.4360055
	speed: 0.0241s/iter; left time: 58.4122s
	iters: 1100, epoch: 8 | loss: 0.4474483
	speed: 0.0241s/iter; left time: 55.9132s
Epoch: 8 cost time: 27.52772092819214
Epoch: 8, Steps: 1140 | Train Loss: 0.5537206 Vali Loss: 0.5930667 Test Loss: 0.2813098
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 1.0421802
	speed: 0.0267s/iter; left time: 58.2911s
	iters: 200, epoch: 9 | loss: 0.4813460
	speed: 0.0293s/iter; left time: 60.9521s
	iters: 300, epoch: 9 | loss: 0.4990345
	speed: 0.0317s/iter; left time: 62.7201s
	iters: 400, epoch: 9 | loss: 0.5286697
	speed: 0.0327s/iter; left time: 61.5391s
	iters: 500, epoch: 9 | loss: 0.4550661
	speed: 0.0329s/iter; left time: 58.5755s
	iters: 600, epoch: 9 | loss: 0.7743670
	speed: 0.0329s/iter; left time: 55.3613s
	iters: 700, epoch: 9 | loss: 0.5659912
	speed: 0.0322s/iter; left time: 50.8570s
	iters: 800, epoch: 9 | loss: 0.4218269
	speed: 0.0312s/iter; left time: 46.1831s
	iters: 900, epoch: 9 | loss: 0.4693363
	speed: 0.0304s/iter; left time: 42.0315s
	iters: 1000, epoch: 9 | loss: 0.4270380
	speed: 0.0298s/iter; left time: 38.2261s
	iters: 1100, epoch: 9 | loss: 0.4029976
	speed: 0.0293s/iter; left time: 34.6368s
Epoch: 9 cost time: 33.222933769226074
Epoch: 9, Steps: 1140 | Train Loss: 0.5534483 Vali Loss: 0.5951473 Test Loss: 0.2811111
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.28149834275245667, mae:0.29902446269989014
Seed: 42
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_720      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.6918570
	speed: 0.0485s/iter; left time: 542.5389s
	iters: 200, epoch: 1 | loss: 0.6654167
	speed: 0.0363s/iter; left time: 402.2743s
	iters: 300, epoch: 1 | loss: 0.8210723
	speed: 0.0319s/iter; left time: 350.7756s
	iters: 400, epoch: 1 | loss: 0.9432852
	speed: 0.0297s/iter; left time: 323.2636s
	iters: 500, epoch: 1 | loss: 0.6218445
	speed: 0.0287s/iter; left time: 309.9258s
	iters: 600, epoch: 1 | loss: 0.5660880
	speed: 0.0279s/iter; left time: 298.1734s
	iters: 700, epoch: 1 | loss: 0.7252625
	speed: 0.0276s/iter; left time: 292.0451s
	iters: 800, epoch: 1 | loss: 0.5707015
	speed: 0.0270s/iter; left time: 282.6121s
	iters: 900, epoch: 1 | loss: 0.6964831
	speed: 0.0263s/iter; left time: 273.4592s
	iters: 1000, epoch: 1 | loss: 0.8644144
	speed: 0.0254s/iter; left time: 261.6323s
	iters: 1100, epoch: 1 | loss: 0.5916067
	speed: 0.0250s/iter; left time: 254.3855s
Epoch: 1 cost time: 28.45784091949463
Epoch: 1, Steps: 1128 | Train Loss: 0.7206801 Vali Loss: 0.7340674 Test Loss: 0.3621874
Validation loss decreased (inf --> 0.734067).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8165647
	speed: 0.0421s/iter; left time: 423.1746s
	iters: 200, epoch: 2 | loss: 0.8410226
	speed: 0.0388s/iter; left time: 386.5937s
	iters: 300, epoch: 2 | loss: 0.7391536
	speed: 0.0335s/iter; left time: 330.1387s
	iters: 400, epoch: 2 | loss: 0.8115995
	speed: 0.0320s/iter; left time: 312.4739s
	iters: 500, epoch: 2 | loss: 0.8027664
	speed: 0.0316s/iter; left time: 305.2991s
	iters: 600, epoch: 2 | loss: 0.5819653
	speed: 0.0298s/iter; left time: 284.4739s
	iters: 700, epoch: 2 | loss: 0.6416617
	speed: 0.0297s/iter; left time: 280.4434s
	iters: 800, epoch: 2 | loss: 0.5676811
	speed: 0.0301s/iter; left time: 281.6750s
	iters: 900, epoch: 2 | loss: 0.7336000
	speed: 0.0307s/iter; left time: 283.7030s
	iters: 1000, epoch: 2 | loss: 0.7247569
	speed: 0.0310s/iter; left time: 283.4365s
	iters: 1100, epoch: 2 | loss: 0.6308433
	speed: 0.0301s/iter; left time: 272.0809s
Epoch: 2 cost time: 33.78337550163269
Epoch: 2, Steps: 1128 | Train Loss: 0.6830877 Vali Loss: 0.7218344 Test Loss: 0.3612089
Validation loss decreased (0.734067 --> 0.721834).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7618015
	speed: 0.0417s/iter; left time: 372.0876s
	iters: 200, epoch: 3 | loss: 0.6997165
	speed: 0.0373s/iter; left time: 329.2724s
	iters: 300, epoch: 3 | loss: 0.6524608
	speed: 0.0336s/iter; left time: 293.1008s
	iters: 400, epoch: 3 | loss: 0.7686604
	speed: 0.0311s/iter; left time: 267.8332s
	iters: 500, epoch: 3 | loss: 0.6065133
	speed: 0.0293s/iter; left time: 249.5985s
	iters: 600, epoch: 3 | loss: 0.8351479
	speed: 0.0287s/iter; left time: 241.8812s
	iters: 700, epoch: 3 | loss: 0.5474482
	speed: 0.0294s/iter; left time: 244.3870s
	iters: 800, epoch: 3 | loss: 0.6157476
	speed: 0.0297s/iter; left time: 244.4535s
	iters: 900, epoch: 3 | loss: 0.6419638
	speed: 0.0287s/iter; left time: 232.9314s
	iters: 1000, epoch: 3 | loss: 0.6381745
	speed: 0.0280s/iter; left time: 224.9092s
	iters: 1100, epoch: 3 | loss: 0.6750118
	speed: 0.0272s/iter; left time: 215.7301s
Epoch: 3 cost time: 30.488274812698364
Epoch: 3, Steps: 1128 | Train Loss: 0.6630502 Vali Loss: 0.7208502 Test Loss: 0.3615138
Validation loss decreased (0.721834 --> 0.720850).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5456755
	speed: 0.0313s/iter; left time: 243.8612s
	iters: 200, epoch: 4 | loss: 0.5415593
	speed: 0.0311s/iter; left time: 239.3664s
	iters: 300, epoch: 4 | loss: 0.7097179
	speed: 0.0281s/iter; left time: 213.5111s
	iters: 400, epoch: 4 | loss: 0.8896776
	speed: 0.0267s/iter; left time: 200.0975s
	iters: 500, epoch: 4 | loss: 0.8053639
	speed: 0.0258s/iter; left time: 191.2069s
	iters: 600, epoch: 4 | loss: 0.6710528
	speed: 0.0253s/iter; left time: 184.7786s
	iters: 700, epoch: 4 | loss: 0.5408301
	speed: 0.0245s/iter; left time: 176.6665s
	iters: 800, epoch: 4 | loss: 0.6788320
	speed: 0.0239s/iter; left time: 169.6912s
	iters: 900, epoch: 4 | loss: 0.5765298
	speed: 0.0240s/iter; left time: 167.7349s
	iters: 1000, epoch: 4 | loss: 0.6605436
	speed: 0.0234s/iter; left time: 161.2879s
	iters: 1100, epoch: 4 | loss: 0.8035585
	speed: 0.0228s/iter; left time: 154.9237s
Epoch: 4 cost time: 25.79331374168396
Epoch: 4, Steps: 1128 | Train Loss: 0.6516881 Vali Loss: 0.7266065 Test Loss: 0.3646940
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6932979
	speed: 0.0258s/iter; left time: 172.1409s
	iters: 200, epoch: 5 | loss: 0.6454256
	speed: 0.0219s/iter; left time: 143.8716s
	iters: 300, epoch: 5 | loss: 0.5947095
	speed: 0.0235s/iter; left time: 152.0528s
	iters: 400, epoch: 5 | loss: 0.5290982
	speed: 0.0245s/iter; left time: 155.7569s
	iters: 500, epoch: 5 | loss: 0.8390980
	speed: 0.0252s/iter; left time: 158.1751s
	iters: 600, epoch: 5 | loss: 0.5733689
	speed: 0.0249s/iter; left time: 153.7745s
	iters: 700, epoch: 5 | loss: 0.4887938
	speed: 0.0248s/iter; left time: 150.7991s
	iters: 800, epoch: 5 | loss: 0.6163962
	speed: 0.0248s/iter; left time: 147.9505s
	iters: 900, epoch: 5 | loss: 0.5797096
	speed: 0.0247s/iter; left time: 145.1874s
	iters: 1000, epoch: 5 | loss: 0.6906282
	speed: 0.0247s/iter; left time: 142.4672s
	iters: 1100, epoch: 5 | loss: 0.5527328
	speed: 0.0247s/iter; left time: 139.7514s
Epoch: 5 cost time: 27.931635856628418
Epoch: 5, Steps: 1128 | Train Loss: 0.6455288 Vali Loss: 0.7222874 Test Loss: 0.3630488
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6314253
	speed: 0.0330s/iter; left time: 182.6894s
	iters: 200, epoch: 6 | loss: 0.7457048
	speed: 0.0304s/iter; left time: 165.3537s
	iters: 300, epoch: 6 | loss: 0.5736843
	speed: 0.0300s/iter; left time: 160.3088s
	iters: 400, epoch: 6 | loss: 0.7837633
	speed: 0.0283s/iter; left time: 148.4603s
	iters: 500, epoch: 6 | loss: 0.6462572
	speed: 0.0292s/iter; left time: 150.0500s
	iters: 600, epoch: 6 | loss: 0.6710805
	speed: 0.0284s/iter; left time: 143.2337s
	iters: 700, epoch: 6 | loss: 0.5859255
	speed: 0.0276s/iter; left time: 136.5483s
	iters: 800, epoch: 6 | loss: 0.4966877
	speed: 0.0270s/iter; left time: 130.7358s
	iters: 900, epoch: 6 | loss: 0.6420705
	speed: 0.0266s/iter; left time: 126.0912s
	iters: 1000, epoch: 6 | loss: 0.5451149
	speed: 0.0264s/iter; left time: 122.5214s
	iters: 1100, epoch: 6 | loss: 0.5666240
	speed: 0.0263s/iter; left time: 119.2451s
Epoch: 6 cost time: 29.692199230194092
Epoch: 6, Steps: 1128 | Train Loss: 0.6423204 Vali Loss: 0.7245123 Test Loss: 0.3635785
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8662972
	speed: 0.0269s/iter; left time: 118.5546s
	iters: 200, epoch: 7 | loss: 0.5680756
	speed: 0.0231s/iter; left time: 99.5779s
	iters: 300, epoch: 7 | loss: 0.5512225
	speed: 0.0228s/iter; left time: 96.1420s
	iters: 400, epoch: 7 | loss: 0.6540877
	speed: 0.0229s/iter; left time: 94.2832s
	iters: 500, epoch: 7 | loss: 0.7158170
	speed: 0.0222s/iter; left time: 88.9348s
	iters: 600, epoch: 7 | loss: 0.6456136
	speed: 0.0226s/iter; left time: 88.2488s
	iters: 700, epoch: 7 | loss: 0.5521204
	speed: 0.0218s/iter; left time: 83.0655s
	iters: 800, epoch: 7 | loss: 0.7619577
	speed: 0.0212s/iter; left time: 78.6624s
	iters: 900, epoch: 7 | loss: 0.5827395
	speed: 0.0210s/iter; left time: 75.7187s
	iters: 1000, epoch: 7 | loss: 0.5155551
	speed: 0.0208s/iter; left time: 73.0814s
	iters: 1100, epoch: 7 | loss: 0.7464200
	speed: 0.0207s/iter; left time: 70.6737s
Epoch: 7 cost time: 23.478325128555298
Epoch: 7, Steps: 1128 | Train Loss: 0.6403084 Vali Loss: 0.7238826 Test Loss: 0.3638364
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.8813959
	speed: 0.0241s/iter; left time: 79.0542s
	iters: 200, epoch: 8 | loss: 0.5682444
	speed: 0.0214s/iter; left time: 68.2942s
	iters: 300, epoch: 8 | loss: 0.7680175
	speed: 0.0211s/iter; left time: 65.1635s
	iters: 400, epoch: 8 | loss: 0.7601068
	speed: 0.0214s/iter; left time: 64.0029s
	iters: 500, epoch: 8 | loss: 0.5824055
	speed: 0.0227s/iter; left time: 65.5474s
	iters: 600, epoch: 8 | loss: 0.5141340
	speed: 0.0248s/iter; left time: 69.1748s
	iters: 700, epoch: 8 | loss: 0.8713492
	speed: 0.0261s/iter; left time: 70.1381s
	iters: 800, epoch: 8 | loss: 0.5787028
	speed: 0.0257s/iter; left time: 66.5042s
	iters: 900, epoch: 8 | loss: 0.4879462
	speed: 0.0254s/iter; left time: 63.0898s
	iters: 1000, epoch: 8 | loss: 0.5529331
	speed: 0.0251s/iter; left time: 59.9817s
	iters: 1100, epoch: 8 | loss: 0.6301050
	speed: 0.0250s/iter; left time: 57.0203s
Epoch: 8 cost time: 28.189124822616577
Epoch: 8, Steps: 1128 | Train Loss: 0.6394997 Vali Loss: 0.7241486 Test Loss: 0.3632674
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.3615137040615082, mae:0.35141080617904663
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.6476078
	speed: 0.0330s/iter; left time: 369.2001s
	iters: 200, epoch: 1 | loss: 0.8245688
	speed: 0.0318s/iter; left time: 352.8534s
	iters: 300, epoch: 1 | loss: 0.7616131
	speed: 0.0330s/iter; left time: 361.8260s
	iters: 400, epoch: 1 | loss: 0.8563531
	speed: 0.0336s/iter; left time: 365.5875s
	iters: 500, epoch: 1 | loss: 0.6906747
	speed: 0.0341s/iter; left time: 368.0272s
	iters: 600, epoch: 1 | loss: 0.6388937
	speed: 0.0344s/iter; left time: 367.6067s
	iters: 700, epoch: 1 | loss: 0.6114724
	speed: 0.0346s/iter; left time: 366.4703s
	iters: 800, epoch: 1 | loss: 0.7049436
	speed: 0.0335s/iter; left time: 350.7077s
	iters: 900, epoch: 1 | loss: 0.9365049
	speed: 0.0318s/iter; left time: 330.5975s
	iters: 1000, epoch: 1 | loss: 0.7293125
	speed: 0.0315s/iter; left time: 323.3601s
	iters: 1100, epoch: 1 | loss: 1.1275558
	speed: 0.0310s/iter; left time: 315.1221s
Epoch: 1 cost time: 35.256370544433594
Epoch: 1, Steps: 1128 | Train Loss: 0.7180449 Vali Loss: 0.7389550 Test Loss: 0.3615161
Validation loss decreased (inf --> 0.738955).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6752306
	speed: 0.0387s/iter; left time: 388.6409s
	iters: 200, epoch: 2 | loss: 0.7724808
	speed: 0.0308s/iter; left time: 306.1750s
	iters: 300, epoch: 2 | loss: 0.7436942
	speed: 0.0272s/iter; left time: 268.0252s
	iters: 400, epoch: 2 | loss: 0.5463411
	speed: 0.0260s/iter; left time: 253.7586s
	iters: 500, epoch: 2 | loss: 0.6054013
	speed: 0.0268s/iter; left time: 258.9908s
	iters: 600, epoch: 2 | loss: 0.6881112
	speed: 0.0269s/iter; left time: 256.9994s
	iters: 700, epoch: 2 | loss: 0.6428746
	speed: 0.0252s/iter; left time: 238.0648s
	iters: 800, epoch: 2 | loss: 0.5877964
	speed: 0.0235s/iter; left time: 219.5561s
	iters: 900, epoch: 2 | loss: 1.0507380
	speed: 0.0226s/iter; left time: 209.3470s
	iters: 1000, epoch: 2 | loss: 0.5277874
	speed: 0.0225s/iter; left time: 206.2706s
	iters: 1100, epoch: 2 | loss: 0.5768952
	speed: 0.0231s/iter; left time: 208.8255s
Epoch: 2 cost time: 26.199535369873047
Epoch: 2, Steps: 1128 | Train Loss: 0.6780917 Vali Loss: 0.7203707 Test Loss: 0.3582338
Validation loss decreased (0.738955 --> 0.720371).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 1.0052456
	speed: 0.0360s/iter; left time: 321.1090s
	iters: 200, epoch: 3 | loss: 0.7455186
	speed: 0.0303s/iter; left time: 267.8277s
	iters: 300, epoch: 3 | loss: 0.5451841
	speed: 0.0285s/iter; left time: 248.3029s
	iters: 400, epoch: 3 | loss: 0.7561995
	speed: 0.0276s/iter; left time: 238.0573s
	iters: 500, epoch: 3 | loss: 0.8834968
	speed: 0.0271s/iter; left time: 230.6203s
	iters: 600, epoch: 3 | loss: 0.8105935
	speed: 0.0265s/iter; left time: 223.1053s
	iters: 700, epoch: 3 | loss: 0.4842382
	speed: 0.0255s/iter; left time: 212.4650s
	iters: 800, epoch: 3 | loss: 0.6716655
	speed: 0.0247s/iter; left time: 203.2068s
	iters: 900, epoch: 3 | loss: 0.5332434
	speed: 0.0242s/iter; left time: 196.5630s
	iters: 1000, epoch: 3 | loss: 0.7028610
	speed: 0.0238s/iter; left time: 191.0123s
	iters: 1100, epoch: 3 | loss: 0.5256921
	speed: 0.0237s/iter; left time: 187.4800s
Epoch: 3 cost time: 26.791181325912476
Epoch: 3, Steps: 1128 | Train Loss: 0.6579320 Vali Loss: 0.7276171 Test Loss: 0.3607926
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.7620534
	speed: 0.0340s/iter; left time: 264.8441s
	iters: 200, epoch: 4 | loss: 0.5750428
	speed: 0.0341s/iter; left time: 262.4110s
	iters: 300, epoch: 4 | loss: 0.6979824
	speed: 0.0332s/iter; left time: 252.3742s
	iters: 400, epoch: 4 | loss: 0.5961921
	speed: 0.0343s/iter; left time: 257.2355s
	iters: 500, epoch: 4 | loss: 0.6683664
	speed: 0.0329s/iter; left time: 243.4975s
	iters: 600, epoch: 4 | loss: 0.5472069
	speed: 0.0325s/iter; left time: 237.0256s
	iters: 700, epoch: 4 | loss: 0.6469150
	speed: 0.0327s/iter; left time: 235.6258s
	iters: 800, epoch: 4 | loss: 0.5619784
	speed: 0.0323s/iter; left time: 228.8935s
	iters: 900, epoch: 4 | loss: 0.5539623
	speed: 0.0308s/iter; left time: 215.8028s
	iters: 1000, epoch: 4 | loss: 0.4980898
	speed: 0.0297s/iter; left time: 204.9887s
	iters: 1100, epoch: 4 | loss: 0.7858106
	speed: 0.0288s/iter; left time: 195.8475s
Epoch: 4 cost time: 32.416126012802124
Epoch: 4, Steps: 1128 | Train Loss: 0.6458814 Vali Loss: 0.7187842 Test Loss: 0.3603434
Validation loss decreased (0.720371 --> 0.718784).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6292254
	speed: 0.0442s/iter; left time: 294.9582s
	iters: 200, epoch: 5 | loss: 0.5906178
	speed: 0.0392s/iter; left time: 257.2006s
	iters: 300, epoch: 5 | loss: 0.4825030
	speed: 0.0345s/iter; left time: 223.4452s
	iters: 400, epoch: 5 | loss: 0.5474922
	speed: 0.0313s/iter; left time: 199.0922s
	iters: 500, epoch: 5 | loss: 0.5559197
	speed: 0.0290s/iter; left time: 181.9824s
	iters: 600, epoch: 5 | loss: 0.6113077
	speed: 0.0275s/iter; left time: 169.6869s
	iters: 700, epoch: 5 | loss: 0.7445620
	speed: 0.0257s/iter; left time: 156.0226s
	iters: 800, epoch: 5 | loss: 0.6772333
	speed: 0.0242s/iter; left time: 144.6781s
	iters: 900, epoch: 5 | loss: 0.6487544
	speed: 0.0238s/iter; left time: 139.4805s
	iters: 1000, epoch: 5 | loss: 0.8200959
	speed: 0.0233s/iter; left time: 134.3271s
	iters: 1100, epoch: 5 | loss: 0.5949023
	speed: 0.0229s/iter; left time: 129.7316s
Epoch: 5 cost time: 26.229023933410645
Epoch: 5, Steps: 1128 | Train Loss: 0.6390984 Vali Loss: 0.7191073 Test Loss: 0.3606687
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5231875
	speed: 0.0311s/iter; left time: 172.3858s
	iters: 200, epoch: 6 | loss: 0.5947167
	speed: 0.0277s/iter; left time: 150.4947s
	iters: 300, epoch: 6 | loss: 0.5289041
	speed: 0.0266s/iter; left time: 142.1501s
	iters: 400, epoch: 6 | loss: 0.5622846
	speed: 0.0259s/iter; left time: 135.8976s
	iters: 500, epoch: 6 | loss: 0.7270610
	speed: 0.0256s/iter; left time: 131.8048s
	iters: 600, epoch: 6 | loss: 0.6068763
	speed: 0.0255s/iter; left time: 128.6480s
	iters: 700, epoch: 6 | loss: 0.5883424
	speed: 0.0251s/iter; left time: 123.9627s
	iters: 800, epoch: 6 | loss: 0.5533372
	speed: 0.0247s/iter; left time: 119.7055s
	iters: 900, epoch: 6 | loss: 0.6323596
	speed: 0.0246s/iter; left time: 116.4824s
	iters: 1000, epoch: 6 | loss: 0.8537745
	speed: 0.0246s/iter; left time: 114.2198s
	iters: 1100, epoch: 6 | loss: 0.7267271
	speed: 0.0244s/iter; left time: 110.7096s
Epoch: 6 cost time: 27.584040880203247
Epoch: 6, Steps: 1128 | Train Loss: 0.6353573 Vali Loss: 0.7213469 Test Loss: 0.3612664
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5551865
	speed: 0.0258s/iter; left time: 114.0754s
	iters: 200, epoch: 7 | loss: 0.5211660
	speed: 0.0244s/iter; left time: 105.1203s
	iters: 300, epoch: 7 | loss: 0.5991267
	speed: 0.0238s/iter; left time: 100.3609s
	iters: 400, epoch: 7 | loss: 0.5813314
	speed: 0.0263s/iter; left time: 108.0072s
	iters: 500, epoch: 7 | loss: 0.6799204
	speed: 0.0279s/iter; left time: 112.1183s
	iters: 600, epoch: 7 | loss: 0.5667880
	speed: 0.0283s/iter; left time: 110.8537s
	iters: 700, epoch: 7 | loss: 0.6949432
	speed: 0.0276s/iter; left time: 105.0540s
	iters: 800, epoch: 7 | loss: 0.6584904
	speed: 0.0273s/iter; left time: 101.3762s
	iters: 900, epoch: 7 | loss: 0.5414379
	speed: 0.0274s/iter; left time: 98.8831s
	iters: 1000, epoch: 7 | loss: 0.5716786
	speed: 0.0267s/iter; left time: 93.8855s
	iters: 1100, epoch: 7 | loss: 0.8645685
	speed: 0.0262s/iter; left time: 89.5297s
Epoch: 7 cost time: 30.027398109436035
Epoch: 7, Steps: 1128 | Train Loss: 0.6332661 Vali Loss: 0.7210656 Test Loss: 0.3613991
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.6681778
	speed: 0.0278s/iter; left time: 91.3106s
	iters: 200, epoch: 8 | loss: 0.6291246
	speed: 0.0249s/iter; left time: 79.1716s
	iters: 300, epoch: 8 | loss: 0.7151493
	speed: 0.0228s/iter; left time: 70.2577s
	iters: 400, epoch: 8 | loss: 0.7336105
	speed: 0.0216s/iter; left time: 64.5151s
	iters: 500, epoch: 8 | loss: 0.5238558
	speed: 0.0211s/iter; left time: 60.8709s
	iters: 600, epoch: 8 | loss: 0.4900544
	speed: 0.0213s/iter; left time: 59.2962s
	iters: 700, epoch: 8 | loss: 0.5521353
	speed: 0.0219s/iter; left time: 58.8257s
	iters: 800, epoch: 8 | loss: 0.6637340
	speed: 0.0213s/iter; left time: 55.0231s
	iters: 900, epoch: 8 | loss: 0.5732107
	speed: 0.0211s/iter; left time: 52.3826s
	iters: 1000, epoch: 8 | loss: 0.5682808
	speed: 0.0211s/iter; left time: 50.2873s
	iters: 1100, epoch: 8 | loss: 0.8086611
	speed: 0.0213s/iter; left time: 48.5945s
Epoch: 8 cost time: 24.256658792495728
Epoch: 8, Steps: 1128 | Train Loss: 0.6322816 Vali Loss: 0.7213193 Test Loss: 0.3617029
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.6877671
	speed: 0.0400s/iter; left time: 86.1737s
	iters: 200, epoch: 9 | loss: 0.5455695
	speed: 0.0364s/iter; left time: 74.7933s
	iters: 300, epoch: 9 | loss: 0.6425245
	speed: 0.0357s/iter; left time: 69.9561s
	iters: 400, epoch: 9 | loss: 0.5472260
	speed: 0.0334s/iter; left time: 62.0349s
	iters: 500, epoch: 9 | loss: 0.7009737
	speed: 0.0316s/iter; left time: 55.5532s
	iters: 600, epoch: 9 | loss: 0.7684874
	speed: 0.0304s/iter; left time: 50.4208s
	iters: 700, epoch: 9 | loss: 0.4836993
	speed: 0.0292s/iter; left time: 45.5074s
	iters: 800, epoch: 9 | loss: 0.5895368
	speed: 0.0280s/iter; left time: 40.7478s
	iters: 900, epoch: 9 | loss: 0.6557972
	speed: 0.0270s/iter; left time: 36.7033s
	iters: 1000, epoch: 9 | loss: 0.5519672
	speed: 0.0264s/iter; left time: 33.1673s
	iters: 1100, epoch: 9 | loss: 0.6333884
	speed: 0.0259s/iter; left time: 29.9130s
Epoch: 9 cost time: 29.196918964385986
Epoch: 9, Steps: 1128 | Train Loss: 0.6319989 Vali Loss: 0.7227314 Test Loss: 0.3616890
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.36034345626831055, mae:0.35123133659362793
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.8047895
	speed: 0.0293s/iter; left time: 327.6901s
	iters: 200, epoch: 1 | loss: 0.7689227
	speed: 0.0268s/iter; left time: 296.7564s
	iters: 300, epoch: 1 | loss: 0.5826434
	speed: 0.0260s/iter; left time: 285.5796s
	iters: 400, epoch: 1 | loss: 0.6810948
	speed: 0.0254s/iter; left time: 276.1840s
	iters: 500, epoch: 1 | loss: 0.7759230
	speed: 0.0247s/iter; left time: 266.7870s
	iters: 600, epoch: 1 | loss: 0.6613028
	speed: 0.0251s/iter; left time: 267.7019s
	iters: 700, epoch: 1 | loss: 0.5982504
	speed: 0.0263s/iter; left time: 278.1940s
	iters: 800, epoch: 1 | loss: 0.8665755
	speed: 0.0255s/iter; left time: 267.1159s
	iters: 900, epoch: 1 | loss: 0.7318524
	speed: 0.0251s/iter; left time: 261.0475s
	iters: 1000, epoch: 1 | loss: 0.6054591
	speed: 0.0250s/iter; left time: 256.6846s
	iters: 1100, epoch: 1 | loss: 0.9219001
	speed: 0.0248s/iter; left time: 252.6618s
Epoch: 1 cost time: 28.072105169296265
Epoch: 1, Steps: 1128 | Train Loss: 0.7209425 Vali Loss: 0.7515831 Test Loss: 0.3655309
Validation loss decreased (inf --> 0.751583).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6341286
	speed: 0.0230s/iter; left time: 231.3722s
	iters: 200, epoch: 2 | loss: 0.6977746
	speed: 0.0201s/iter; left time: 200.4777s
	iters: 300, epoch: 2 | loss: 0.5982548
	speed: 0.0188s/iter; left time: 185.6806s
	iters: 400, epoch: 2 | loss: 0.5987109
	speed: 0.0187s/iter; left time: 182.4218s
	iters: 500, epoch: 2 | loss: 0.9904431
	speed: 0.0187s/iter; left time: 180.2533s
	iters: 600, epoch: 2 | loss: 0.6210990
	speed: 0.0192s/iter; left time: 183.5608s
	iters: 700, epoch: 2 | loss: 0.8744372
	speed: 0.0196s/iter; left time: 185.0586s
	iters: 800, epoch: 2 | loss: 0.8610352
	speed: 0.0198s/iter; left time: 185.4075s
	iters: 900, epoch: 2 | loss: 0.8212383
	speed: 0.0209s/iter; left time: 193.5555s
	iters: 1000, epoch: 2 | loss: 0.7596701
	speed: 0.0209s/iter; left time: 191.1937s
	iters: 1100, epoch: 2 | loss: 0.5953177
	speed: 0.0208s/iter; left time: 188.3620s
Epoch: 2 cost time: 23.615371704101562
Epoch: 2, Steps: 1128 | Train Loss: 0.6831948 Vali Loss: 0.7188960 Test Loss: 0.3587984
Validation loss decreased (0.751583 --> 0.718896).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5483499
	speed: 0.0258s/iter; left time: 230.6729s
	iters: 200, epoch: 3 | loss: 0.6165653
	speed: 0.0239s/iter; left time: 211.2412s
	iters: 300, epoch: 3 | loss: 0.5904852
	speed: 0.0234s/iter; left time: 203.9182s
	iters: 400, epoch: 3 | loss: 0.5958326
	speed: 0.0231s/iter; left time: 199.5682s
	iters: 500, epoch: 3 | loss: 0.8727711
	speed: 0.0252s/iter; left time: 214.8897s
	iters: 600, epoch: 3 | loss: 0.6113454
	speed: 0.0251s/iter; left time: 211.3049s
	iters: 700, epoch: 3 | loss: 0.7266968
	speed: 0.0247s/iter; left time: 205.2269s
	iters: 800, epoch: 3 | loss: 0.6586173
	speed: 0.0243s/iter; left time: 200.1396s
	iters: 900, epoch: 3 | loss: 0.5670269
	speed: 0.0241s/iter; left time: 196.1975s
	iters: 1000, epoch: 3 | loss: 0.5756342
	speed: 0.0240s/iter; left time: 192.7937s
	iters: 1100, epoch: 3 | loss: 0.7675141
	speed: 0.0239s/iter; left time: 189.5550s
Epoch: 3 cost time: 27.14142608642578
Epoch: 3, Steps: 1128 | Train Loss: 0.6632491 Vali Loss: 0.7136398 Test Loss: 0.3589558
Validation loss decreased (0.718896 --> 0.713640).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.7650332
	speed: 0.0300s/iter; left time: 233.6317s
	iters: 200, epoch: 4 | loss: 0.5704228
	speed: 0.0255s/iter; left time: 196.1442s
	iters: 300, epoch: 4 | loss: 0.7596352
	speed: 0.0244s/iter; left time: 185.6984s
	iters: 400, epoch: 4 | loss: 0.5128499
	speed: 0.0241s/iter; left time: 180.5536s
	iters: 500, epoch: 4 | loss: 0.5976335
	speed: 0.0238s/iter; left time: 176.3043s
	iters: 600, epoch: 4 | loss: 0.5489166
	speed: 0.0237s/iter; left time: 173.1122s
	iters: 700, epoch: 4 | loss: 0.6704625
	speed: 0.0239s/iter; left time: 171.6678s
	iters: 800, epoch: 4 | loss: 0.9074720
	speed: 0.0238s/iter; left time: 169.0915s
	iters: 900, epoch: 4 | loss: 0.5330363
	speed: 0.0236s/iter; left time: 165.3991s
	iters: 1000, epoch: 4 | loss: 0.8918087
	speed: 0.0235s/iter; left time: 162.1218s
	iters: 1100, epoch: 4 | loss: 0.6558359
	speed: 0.0233s/iter; left time: 158.3504s
Epoch: 4 cost time: 26.344502925872803
Epoch: 4, Steps: 1128 | Train Loss: 0.6526573 Vali Loss: 0.7142873 Test Loss: 0.3594327
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6425611
	speed: 0.0391s/iter; left time: 260.8245s
	iters: 200, epoch: 5 | loss: 0.5279993
	speed: 0.0295s/iter; left time: 193.7975s
	iters: 300, epoch: 5 | loss: 0.6434344
	speed: 0.0258s/iter; left time: 166.9607s
	iters: 400, epoch: 5 | loss: 0.5640949
	speed: 0.0237s/iter; left time: 151.1238s
	iters: 500, epoch: 5 | loss: 0.5955752
	speed: 0.0228s/iter; left time: 142.8375s
	iters: 600, epoch: 5 | loss: 0.6422471
	speed: 0.0230s/iter; left time: 142.1866s
	iters: 700, epoch: 5 | loss: 0.5913077
	speed: 0.0227s/iter; left time: 137.5047s
	iters: 800, epoch: 5 | loss: 0.7348537
	speed: 0.0233s/iter; left time: 139.3150s
	iters: 900, epoch: 5 | loss: 0.7354537
	speed: 0.0240s/iter; left time: 140.5666s
	iters: 1000, epoch: 5 | loss: 0.6488904
	speed: 0.0241s/iter; left time: 139.0932s
	iters: 1100, epoch: 5 | loss: 0.7649580
	speed: 0.0244s/iter; left time: 138.1810s
Epoch: 5 cost time: 27.846277475357056
Epoch: 5, Steps: 1128 | Train Loss: 0.6469718 Vali Loss: 0.7168714 Test Loss: 0.3596267
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5947087
	speed: 0.0252s/iter; left time: 139.6401s
	iters: 200, epoch: 6 | loss: 0.5682783
	speed: 0.0239s/iter; left time: 130.0756s
	iters: 300, epoch: 6 | loss: 0.5373228
	speed: 0.0238s/iter; left time: 127.2904s
	iters: 400, epoch: 6 | loss: 0.9376426
	speed: 0.0237s/iter; left time: 123.9770s
	iters: 500, epoch: 6 | loss: 0.5878972
	speed: 0.0241s/iter; left time: 124.1120s
	iters: 600, epoch: 6 | loss: 0.5329260
	speed: 0.0239s/iter; left time: 120.4205s
	iters: 700, epoch: 6 | loss: 0.5768021
	speed: 0.0236s/iter; left time: 116.6879s
	iters: 800, epoch: 6 | loss: 0.5843654
	speed: 0.0236s/iter; left time: 114.0605s
	iters: 900, epoch: 6 | loss: 0.7331050
	speed: 0.0234s/iter; left time: 110.8871s
	iters: 1000, epoch: 6 | loss: 0.5775377
	speed: 0.0233s/iter; left time: 108.0084s
	iters: 1100, epoch: 6 | loss: 0.6698507
	speed: 0.0232s/iter; left time: 105.2096s
Epoch: 6 cost time: 26.29803156852722
Epoch: 6, Steps: 1128 | Train Loss: 0.6433898 Vali Loss: 0.7166008 Test Loss: 0.3599860
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.6225144
	speed: 0.0308s/iter; left time: 136.0163s
	iters: 200, epoch: 7 | loss: 0.5941058
	speed: 0.0266s/iter; left time: 114.5887s
	iters: 300, epoch: 7 | loss: 0.4956667
	speed: 0.0256s/iter; left time: 108.0038s
	iters: 400, epoch: 7 | loss: 0.6646793
	speed: 0.0266s/iter; left time: 109.5853s
	iters: 500, epoch: 7 | loss: 0.4819716
	speed: 0.0262s/iter; left time: 105.1242s
	iters: 600, epoch: 7 | loss: 0.5851700
	speed: 0.0256s/iter; left time: 100.0779s
	iters: 700, epoch: 7 | loss: 0.6625717
	speed: 0.0251s/iter; left time: 95.8775s
	iters: 800, epoch: 7 | loss: 0.6711458
	speed: 0.0246s/iter; left time: 91.3217s
	iters: 900, epoch: 7 | loss: 0.8388814
	speed: 0.0242s/iter; left time: 87.4496s
	iters: 1000, epoch: 7 | loss: 0.5500989
	speed: 0.0241s/iter; left time: 84.4972s
	iters: 1100, epoch: 7 | loss: 0.6484044
	speed: 0.0240s/iter; left time: 81.7471s
Epoch: 7 cost time: 27.131886959075928
Epoch: 7, Steps: 1128 | Train Loss: 0.6417857 Vali Loss: 0.7187406 Test Loss: 0.3602036
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.6870409
	speed: 0.0331s/iter; left time: 108.8925s
	iters: 200, epoch: 8 | loss: 0.6488054
	speed: 0.0259s/iter; left time: 82.5324s
	iters: 300, epoch: 8 | loss: 0.4815065
	speed: 0.0232s/iter; left time: 71.5915s
	iters: 400, epoch: 8 | loss: 0.6405324
	speed: 0.0246s/iter; left time: 73.3007s
	iters: 500, epoch: 8 | loss: 0.7596094
	speed: 0.0236s/iter; left time: 67.9707s
	iters: 600, epoch: 8 | loss: 0.5722106
	speed: 0.0224s/iter; left time: 62.2625s
	iters: 700, epoch: 8 | loss: 0.4552220
	speed: 0.0217s/iter; left time: 58.2854s
	iters: 800, epoch: 8 | loss: 0.5926867
	speed: 0.0212s/iter; left time: 54.7985s
	iters: 900, epoch: 8 | loss: 0.5407398
	speed: 0.0206s/iter; left time: 51.2691s
	iters: 1000, epoch: 8 | loss: 0.5402755
	speed: 0.0202s/iter; left time: 48.0926s
	iters: 1100, epoch: 8 | loss: 0.6885790
	speed: 0.0200s/iter; left time: 45.7023s
Epoch: 8 cost time: 22.580897569656372
Epoch: 8, Steps: 1128 | Train Loss: 0.6408039 Vali Loss: 0.7166428 Test Loss: 0.3599527
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.35895583033561707, mae:0.35026815533638
Seed: 123
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_96       Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.6897447
	speed: 0.0439s/iter; left time: 499.7082s
	iters: 200, epoch: 1 | loss: 0.3712192
	speed: 0.0329s/iter; left time: 370.5223s
	iters: 300, epoch: 1 | loss: 0.5523918
	speed: 0.0293s/iter; left time: 327.2352s
	iters: 400, epoch: 1 | loss: 0.3243454
	speed: 0.0280s/iter; left time: 310.4351s
	iters: 500, epoch: 1 | loss: 0.7032411
	speed: 0.0299s/iter; left time: 328.0690s
	iters: 600, epoch: 1 | loss: 0.4961481
	speed: 0.0321s/iter; left time: 348.5183s
	iters: 700, epoch: 1 | loss: 0.3742256
	speed: 0.0318s/iter; left time: 342.1823s
	iters: 800, epoch: 1 | loss: 0.3856690
	speed: 0.0307s/iter; left time: 327.7095s
	iters: 900, epoch: 1 | loss: 0.3281321
	speed: 0.0298s/iter; left time: 314.8945s
	iters: 1000, epoch: 1 | loss: 0.3551676
	speed: 0.0291s/iter; left time: 304.2021s
	iters: 1100, epoch: 1 | loss: 1.3785985
	speed: 0.0284s/iter; left time: 295.0362s
Epoch: 1 cost time: 32.43495512008667
Epoch: 1, Steps: 1147 | Train Loss: 0.4982560 Vali Loss: 0.4590101 Test Loss: 0.1882369
Validation loss decreased (inf --> 0.459010).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4112620
	speed: 0.0204s/iter; left time: 209.0775s
	iters: 200, epoch: 2 | loss: 0.3775040
	speed: 0.0202s/iter; left time: 204.8159s
	iters: 300, epoch: 2 | loss: 1.2698498
	speed: 0.0195s/iter; left time: 195.6110s
	iters: 400, epoch: 2 | loss: 0.4142964
	speed: 0.0193s/iter; left time: 192.0111s
	iters: 500, epoch: 2 | loss: 0.3593507
	speed: 0.0202s/iter; left time: 198.0275s
	iters: 600, epoch: 2 | loss: 0.4047866
	speed: 0.0202s/iter; left time: 196.5608s
	iters: 700, epoch: 2 | loss: 0.3253558
	speed: 0.0205s/iter; left time: 197.4710s
	iters: 800, epoch: 2 | loss: 0.2912000
	speed: 0.0207s/iter; left time: 197.1661s
	iters: 900, epoch: 2 | loss: 0.4937353
	speed: 0.0218s/iter; left time: 205.0287s
	iters: 1000, epoch: 2 | loss: 0.4706848
	speed: 0.0221s/iter; left time: 206.0193s
	iters: 1100, epoch: 2 | loss: 1.2919414
	speed: 0.0223s/iter; left time: 206.1127s
Epoch: 2 cost time: 25.843412160873413
Epoch: 2, Steps: 1147 | Train Loss: 0.4521241 Vali Loss: 0.4262184 Test Loss: 0.1777542
Validation loss decreased (0.459010 --> 0.426218).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2750391
	speed: 0.0277s/iter; left time: 251.4210s
	iters: 200, epoch: 3 | loss: 0.3414277
	speed: 0.0252s/iter; left time: 226.0122s
	iters: 300, epoch: 3 | loss: 0.6028350
	speed: 0.0238s/iter; left time: 211.4949s
	iters: 400, epoch: 3 | loss: 0.2708392
	speed: 0.0227s/iter; left time: 199.5082s
	iters: 500, epoch: 3 | loss: 0.4645221
	speed: 0.0218s/iter; left time: 189.2472s
	iters: 600, epoch: 3 | loss: 0.2830568
	speed: 0.0209s/iter; left time: 179.6022s
	iters: 700, epoch: 3 | loss: 0.3752701
	speed: 0.0206s/iter; left time: 174.6194s
	iters: 800, epoch: 3 | loss: 0.5329866
	speed: 0.0205s/iter; left time: 171.8751s
	iters: 900, epoch: 3 | loss: 0.4745311
	speed: 0.0202s/iter; left time: 167.0111s
	iters: 1000, epoch: 3 | loss: 0.4270095
	speed: 0.0198s/iter; left time: 162.2298s
	iters: 1100, epoch: 3 | loss: 1.1898433
	speed: 0.0196s/iter; left time: 158.1908s
Epoch: 3 cost time: 22.43598437309265
Epoch: 3, Steps: 1147 | Train Loss: 0.4319697 Vali Loss: 0.4309385 Test Loss: 0.1748839
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3345750
	speed: 0.0433s/iter; left time: 343.4093s
	iters: 200, epoch: 4 | loss: 0.3400409
	speed: 0.0381s/iter; left time: 298.2422s
	iters: 300, epoch: 4 | loss: 0.3603230
	speed: 0.0337s/iter; left time: 260.1939s
	iters: 400, epoch: 4 | loss: 0.3536862
	speed: 0.0321s/iter; left time: 244.8881s
	iters: 500, epoch: 4 | loss: 1.2857574
	speed: 0.0295s/iter; left time: 222.1580s
	iters: 600, epoch: 4 | loss: 0.3429147
	speed: 0.0278s/iter; left time: 206.5411s
	iters: 700, epoch: 4 | loss: 0.3865881
	speed: 0.0265s/iter; left time: 194.0730s
	iters: 800, epoch: 4 | loss: 0.2663576
	speed: 0.0264s/iter; left time: 190.5119s
	iters: 900, epoch: 4 | loss: 0.3025721
	speed: 0.0276s/iter; left time: 197.1201s
	iters: 1000, epoch: 4 | loss: 0.2958800
	speed: 0.0271s/iter; left time: 190.2124s
	iters: 1100, epoch: 4 | loss: 0.2986628
	speed: 0.0267s/iter; left time: 185.1037s
Epoch: 4 cost time: 30.536865234375
Epoch: 4, Steps: 1147 | Train Loss: 0.4205469 Vali Loss: 0.4275890 Test Loss: 0.1737556
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5610002
	speed: 0.0444s/iter; left time: 300.9092s
	iters: 200, epoch: 5 | loss: 0.2498857
	speed: 0.0317s/iter; left time: 211.8654s
	iters: 300, epoch: 5 | loss: 0.2879126
	speed: 0.0275s/iter; left time: 181.1047s
	iters: 400, epoch: 5 | loss: 0.5982336
	speed: 0.0254s/iter; left time: 164.9739s
	iters: 500, epoch: 5 | loss: 0.2692711
	speed: 0.0252s/iter; left time: 160.9260s
	iters: 600, epoch: 5 | loss: 0.2108924
	speed: 0.0251s/iter; left time: 157.5350s
	iters: 700, epoch: 5 | loss: 0.2959228
	speed: 0.0250s/iter; left time: 154.6140s
	iters: 800, epoch: 5 | loss: 0.2870755
	speed: 0.0252s/iter; left time: 153.3690s
	iters: 900, epoch: 5 | loss: 0.4502869
	speed: 0.0251s/iter; left time: 150.0939s
	iters: 1000, epoch: 5 | loss: 0.4760346
	speed: 0.0255s/iter; left time: 150.2577s
	iters: 1100, epoch: 5 | loss: 0.3369941
	speed: 0.0254s/iter; left time: 146.7085s
Epoch: 5 cost time: 29.092998266220093
Epoch: 5, Steps: 1147 | Train Loss: 0.4144132 Vali Loss: 0.4314180 Test Loss: 0.1724645
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2630607
	speed: 0.0247s/iter; left time: 139.0292s
	iters: 200, epoch: 6 | loss: 0.2787557
	speed: 0.0232s/iter; left time: 128.2350s
	iters: 300, epoch: 6 | loss: 0.4531147
	speed: 0.0243s/iter; left time: 132.2927s
	iters: 400, epoch: 6 | loss: 0.4039497
	speed: 0.0241s/iter; left time: 128.7852s
	iters: 500, epoch: 6 | loss: 0.4200702
	speed: 0.0242s/iter; left time: 126.6388s
	iters: 600, epoch: 6 | loss: 0.2774951
	speed: 0.0238s/iter; left time: 122.0796s
	iters: 700, epoch: 6 | loss: 0.3195056
	speed: 0.0231s/iter; left time: 116.5296s
	iters: 800, epoch: 6 | loss: 0.2649113
	speed: 0.0228s/iter; left time: 112.7098s
	iters: 900, epoch: 6 | loss: 0.4310925
	speed: 0.0224s/iter; left time: 108.2479s
	iters: 1000, epoch: 6 | loss: 0.2449298
	speed: 0.0223s/iter; left time: 105.7743s
	iters: 1100, epoch: 6 | loss: 0.3863477
	speed: 0.0227s/iter; left time: 105.4669s
Epoch: 6 cost time: 26.716586589813232
Epoch: 6, Steps: 1147 | Train Loss: 0.4110069 Vali Loss: 0.4318322 Test Loss: 0.1733499
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3998323
	speed: 0.0287s/iter; left time: 129.0448s
	iters: 200, epoch: 7 | loss: 0.6454597
	speed: 0.0245s/iter; left time: 107.4901s
	iters: 300, epoch: 7 | loss: 0.2452591
	speed: 0.0230s/iter; left time: 98.5259s
	iters: 400, epoch: 7 | loss: 0.2585553
	speed: 0.0228s/iter; left time: 95.4512s
	iters: 500, epoch: 7 | loss: 0.2884511
	speed: 0.0242s/iter; left time: 98.8581s
	iters: 600, epoch: 7 | loss: 0.5971776
	speed: 0.0251s/iter; left time: 100.0049s
	iters: 700, epoch: 7 | loss: 0.2561587
	speed: 0.0250s/iter; left time: 97.1447s
	iters: 800, epoch: 7 | loss: 0.2607377
	speed: 0.0249s/iter; left time: 94.4030s
	iters: 900, epoch: 7 | loss: 0.3644266
	speed: 0.0248s/iter; left time: 91.6380s
	iters: 1000, epoch: 7 | loss: 0.4702714
	speed: 0.0247s/iter; left time: 88.6327s
	iters: 1100, epoch: 7 | loss: 0.4893007
	speed: 0.0246s/iter; left time: 85.7864s
Epoch: 7 cost time: 28.79198169708252
Epoch: 7, Steps: 1147 | Train Loss: 0.4093409 Vali Loss: 0.4345048 Test Loss: 0.1738219
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.17775431275367737, mae:0.21823272109031677
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.5819184
	speed: 0.0331s/iter; left time: 376.1611s
	iters: 200, epoch: 1 | loss: 0.3729376
	speed: 0.0320s/iter; left time: 360.5342s
	iters: 300, epoch: 1 | loss: 0.3635444
	speed: 0.0290s/iter; left time: 323.9035s
	iters: 400, epoch: 1 | loss: 1.2248005
	speed: 0.0273s/iter; left time: 302.6270s
	iters: 500, epoch: 1 | loss: 0.4014710
	speed: 0.0262s/iter; left time: 287.4270s
	iters: 600, epoch: 1 | loss: 0.4711165
	speed: 0.0259s/iter; left time: 281.5217s
	iters: 700, epoch: 1 | loss: 0.3943202
	speed: 0.0256s/iter; left time: 276.2496s
	iters: 800, epoch: 1 | loss: 0.4475178
	speed: 0.0253s/iter; left time: 269.5844s
	iters: 900, epoch: 1 | loss: 0.3222048
	speed: 0.0250s/iter; left time: 264.1423s
	iters: 1000, epoch: 1 | loss: 0.4175899
	speed: 0.0255s/iter; left time: 267.3284s
	iters: 1100, epoch: 1 | loss: 0.4154075
	speed: 0.0259s/iter; left time: 268.4242s
Epoch: 1 cost time: 29.94091296195984
Epoch: 1, Steps: 1147 | Train Loss: 0.4967894 Vali Loss: 0.4573134 Test Loss: 0.1887249
Validation loss decreased (inf --> 0.457313).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3104206
	speed: 0.0428s/iter; left time: 437.7335s
	iters: 200, epoch: 2 | loss: 0.3009716
	speed: 0.0336s/iter; left time: 339.7176s
	iters: 300, epoch: 2 | loss: 1.1035862
	speed: 0.0316s/iter; left time: 316.2820s
	iters: 400, epoch: 2 | loss: 0.3118901
	speed: 0.0316s/iter; left time: 313.9606s
	iters: 500, epoch: 2 | loss: 0.4600164
	speed: 0.0306s/iter; left time: 300.6393s
	iters: 600, epoch: 2 | loss: 0.4438687
	speed: 0.0295s/iter; left time: 286.8357s
	iters: 700, epoch: 2 | loss: 0.2954195
	speed: 0.0287s/iter; left time: 276.2299s
	iters: 800, epoch: 2 | loss: 0.2943183
	speed: 0.0279s/iter; left time: 265.6137s
	iters: 900, epoch: 2 | loss: 0.3644578
	speed: 0.0272s/iter; left time: 256.6340s
	iters: 1000, epoch: 2 | loss: 0.3035914
	speed: 0.0267s/iter; left time: 248.6789s
	iters: 1100, epoch: 2 | loss: 0.3729481
	speed: 0.0270s/iter; left time: 248.7620s
Epoch: 2 cost time: 31.477190494537354
Epoch: 2, Steps: 1147 | Train Loss: 0.4523530 Vali Loss: 0.4365195 Test Loss: 0.1820866
Validation loss decreased (0.457313 --> 0.436519).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2925089
	speed: 0.0385s/iter; left time: 349.5062s
	iters: 200, epoch: 3 | loss: 0.2980220
	speed: 0.0320s/iter; left time: 287.0724s
	iters: 300, epoch: 3 | loss: 0.2821231
	speed: 0.0289s/iter; left time: 256.2461s
	iters: 400, epoch: 3 | loss: 0.3177263
	speed: 0.0267s/iter; left time: 234.4495s
	iters: 500, epoch: 3 | loss: 0.3087754
	speed: 0.0256s/iter; left time: 222.4889s
	iters: 600, epoch: 3 | loss: 0.3829454
	speed: 0.0256s/iter; left time: 219.4587s
	iters: 700, epoch: 3 | loss: 0.2768982
	speed: 0.0253s/iter; left time: 214.6012s
	iters: 800, epoch: 3 | loss: 1.2532219
	speed: 0.0252s/iter; left time: 210.7187s
	iters: 900, epoch: 3 | loss: 0.3646630
	speed: 0.0250s/iter; left time: 207.1912s
	iters: 1000, epoch: 3 | loss: 0.3040521
	speed: 0.0254s/iter; left time: 207.3821s
	iters: 1100, epoch: 3 | loss: 0.4764868
	speed: 0.0256s/iter; left time: 206.3887s
Epoch: 3 cost time: 29.32112216949463
Epoch: 3, Steps: 1147 | Train Loss: 0.4312980 Vali Loss: 0.4380175 Test Loss: 0.1753935
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 1.2173814
	speed: 0.0400s/iter; left time: 316.9718s
	iters: 200, epoch: 4 | loss: 0.2644989
	speed: 0.0316s/iter; left time: 247.2137s
	iters: 300, epoch: 4 | loss: 0.3951118
	speed: 0.0286s/iter; left time: 220.9591s
	iters: 400, epoch: 4 | loss: 0.3326674
	speed: 0.0282s/iter; left time: 215.1528s
	iters: 500, epoch: 4 | loss: 0.4946559
	speed: 0.0281s/iter; left time: 211.5718s
	iters: 600, epoch: 4 | loss: 0.3145475
	speed: 0.0275s/iter; left time: 204.4787s
	iters: 700, epoch: 4 | loss: 0.2981190
	speed: 0.0271s/iter; left time: 198.5218s
	iters: 800, epoch: 4 | loss: 0.3652633
	speed: 0.0268s/iter; left time: 193.4155s
	iters: 900, epoch: 4 | loss: 0.3883592
	speed: 0.0265s/iter; left time: 188.9779s
	iters: 1000, epoch: 4 | loss: 0.2403526
	speed: 0.0261s/iter; left time: 183.6366s
	iters: 1100, epoch: 4 | loss: 0.4481997
	speed: 0.0254s/iter; left time: 175.8025s
Epoch: 4 cost time: 28.74060320854187
Epoch: 4, Steps: 1147 | Train Loss: 0.4198294 Vali Loss: 0.4377448 Test Loss: 0.1779098
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3196617
	speed: 0.0196s/iter; left time: 133.1223s
	iters: 200, epoch: 5 | loss: 0.2617483
	speed: 0.0176s/iter; left time: 117.5684s
	iters: 300, epoch: 5 | loss: 0.3379586
	speed: 0.0179s/iter; left time: 118.0290s
	iters: 400, epoch: 5 | loss: 0.2899475
	speed: 0.0187s/iter; left time: 120.9799s
	iters: 500, epoch: 5 | loss: 0.4168378
	speed: 0.0196s/iter; left time: 125.0670s
	iters: 600, epoch: 5 | loss: 0.4125656
	speed: 0.0205s/iter; left time: 128.7540s
	iters: 700, epoch: 5 | loss: 0.3248064
	speed: 0.0211s/iter; left time: 130.4452s
	iters: 800, epoch: 5 | loss: 0.2475775
	speed: 0.0216s/iter; left time: 131.2071s
	iters: 900, epoch: 5 | loss: 0.2498580
	speed: 0.0219s/iter; left time: 131.2044s
	iters: 1000, epoch: 5 | loss: 0.3422565
	speed: 0.0222s/iter; left time: 130.8166s
	iters: 1100, epoch: 5 | loss: 0.5640039
	speed: 0.0225s/iter; left time: 129.9763s
Epoch: 5 cost time: 26.017731189727783
Epoch: 5, Steps: 1147 | Train Loss: 0.4138272 Vali Loss: 0.4342848 Test Loss: 0.1757446
Validation loss decreased (0.436519 --> 0.434285).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2956271
	speed: 0.0290s/iter; left time: 163.2754s
	iters: 200, epoch: 6 | loss: 0.2743371
	speed: 0.0244s/iter; left time: 135.0215s
	iters: 300, epoch: 6 | loss: 0.2715615
	speed: 0.0220s/iter; left time: 119.6437s
	iters: 400, epoch: 6 | loss: 0.2816022
	speed: 0.0208s/iter; left time: 111.2111s
	iters: 500, epoch: 6 | loss: 1.2407305
	speed: 0.0204s/iter; left time: 106.9005s
	iters: 600, epoch: 6 | loss: 0.3046053
	speed: 0.0207s/iter; left time: 106.3044s
	iters: 700, epoch: 6 | loss: 0.2949997
	speed: 0.0210s/iter; left time: 105.7843s
	iters: 800, epoch: 6 | loss: 0.2933975
	speed: 0.0213s/iter; left time: 105.0369s
	iters: 900, epoch: 6 | loss: 0.2291410
	speed: 0.0213s/iter; left time: 102.7935s
	iters: 1000, epoch: 6 | loss: 0.3002322
	speed: 0.0216s/iter; left time: 102.2517s
	iters: 1100, epoch: 6 | loss: 0.2252780
	speed: 0.0218s/iter; left time: 100.8794s
Epoch: 6 cost time: 25.225854635238647
Epoch: 6, Steps: 1147 | Train Loss: 0.4105862 Vali Loss: 0.4389203 Test Loss: 0.1770773
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3874479
	speed: 0.0393s/iter; left time: 176.5044s
	iters: 200, epoch: 7 | loss: 0.4694338
	speed: 0.0367s/iter; left time: 161.2567s
	iters: 300, epoch: 7 | loss: 1.2709885
	speed: 0.0321s/iter; left time: 137.4958s
	iters: 400, epoch: 7 | loss: 0.4324614
	speed: 0.0291s/iter; left time: 121.7258s
	iters: 500, epoch: 7 | loss: 0.4418573
	speed: 0.0283s/iter; left time: 115.7258s
	iters: 600, epoch: 7 | loss: 0.2600834
	speed: 0.0276s/iter; left time: 109.9631s
	iters: 700, epoch: 7 | loss: 0.3763316
	speed: 0.0272s/iter; left time: 105.6081s
	iters: 800, epoch: 7 | loss: 0.3280922
	speed: 0.0268s/iter; left time: 101.6763s
	iters: 900, epoch: 7 | loss: 0.2970673
	speed: 0.0266s/iter; left time: 97.9900s
	iters: 1000, epoch: 7 | loss: 0.2914086
	speed: 0.0268s/iter; left time: 96.3476s
	iters: 1100, epoch: 7 | loss: 0.3908930
	speed: 0.0265s/iter; left time: 92.3764s
Epoch: 7 cost time: 30.435142278671265
Epoch: 7, Steps: 1147 | Train Loss: 0.4089302 Vali Loss: 0.4370789 Test Loss: 0.1759488
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3863208
	speed: 0.0275s/iter; left time: 91.7871s
	iters: 200, epoch: 8 | loss: 0.2374060
	speed: 0.0256s/iter; left time: 82.9472s
	iters: 300, epoch: 8 | loss: 0.4423448
	speed: 0.0236s/iter; left time: 74.1525s
	iters: 400, epoch: 8 | loss: 0.3057481
	speed: 0.0225s/iter; left time: 68.4826s
	iters: 500, epoch: 8 | loss: 0.2410830
	speed: 0.0229s/iter; left time: 67.3916s
	iters: 600, epoch: 8 | loss: 0.2622560
	speed: 0.0232s/iter; left time: 65.8998s
	iters: 700, epoch: 8 | loss: 0.2998806
	speed: 0.0231s/iter; left time: 63.4361s
	iters: 800, epoch: 8 | loss: 0.2208318
	speed: 0.0230s/iter; left time: 60.6395s
	iters: 900, epoch: 8 | loss: 0.3714399
	speed: 0.0229s/iter; left time: 58.2194s
	iters: 1000, epoch: 8 | loss: 1.2561163
	speed: 0.0229s/iter; left time: 55.8268s
	iters: 1100, epoch: 8 | loss: 0.6312405
	speed: 0.0228s/iter; left time: 53.4727s
Epoch: 8 cost time: 26.41050910949707
Epoch: 8, Steps: 1147 | Train Loss: 0.4079352 Vali Loss: 0.4375614 Test Loss: 0.1763564
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4581805
	speed: 0.0317s/iter; left time: 69.6511s
	iters: 200, epoch: 9 | loss: 0.3216996
	speed: 0.0268s/iter; left time: 56.0470s
	iters: 300, epoch: 9 | loss: 0.3904793
	speed: 0.0262s/iter; left time: 52.2670s
	iters: 400, epoch: 9 | loss: 0.6283385
	speed: 0.0247s/iter; left time: 46.7298s
	iters: 500, epoch: 9 | loss: 0.4519345
	speed: 0.0240s/iter; left time: 43.1051s
	iters: 600, epoch: 9 | loss: 0.3398031
	speed: 0.0243s/iter; left time: 41.1199s
	iters: 700, epoch: 9 | loss: 0.2275432
	speed: 0.0244s/iter; left time: 38.8895s
	iters: 800, epoch: 9 | loss: 0.4739387
	speed: 0.0241s/iter; left time: 36.0626s
	iters: 900, epoch: 9 | loss: 1.2210461
	speed: 0.0239s/iter; left time: 33.3678s
	iters: 1000, epoch: 9 | loss: 0.2926400
	speed: 0.0243s/iter; left time: 31.5058s
	iters: 1100, epoch: 9 | loss: 0.3028019
	speed: 0.0249s/iter; left time: 29.8131s
Epoch: 9 cost time: 28.67991280555725
Epoch: 9, Steps: 1147 | Train Loss: 0.4074017 Vali Loss: 0.4386096 Test Loss: 0.1763033
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2368770
	speed: 0.0332s/iter; left time: 34.8288s
	iters: 200, epoch: 10 | loss: 0.2750668
	speed: 0.0299s/iter; left time: 28.3172s
	iters: 300, epoch: 10 | loss: 0.3337669
	speed: 0.0264s/iter; left time: 22.4226s
	iters: 400, epoch: 10 | loss: 0.2518075
	speed: 0.0246s/iter; left time: 18.4305s
	iters: 500, epoch: 10 | loss: 1.2513518
	speed: 0.0243s/iter; left time: 15.7261s
	iters: 600, epoch: 10 | loss: 0.2588547
	speed: 0.0238s/iter; left time: 13.0560s
	iters: 700, epoch: 10 | loss: 0.3124102
	speed: 0.0236s/iter; left time: 10.5878s
	iters: 800, epoch: 10 | loss: 0.2929447
	speed: 0.0234s/iter; left time: 8.1454s
	iters: 900, epoch: 10 | loss: 0.2186610
	speed: 0.0236s/iter; left time: 5.8452s
	iters: 1000, epoch: 10 | loss: 0.2742461
	speed: 0.0236s/iter; left time: 3.4906s
	iters: 1100, epoch: 10 | loss: 0.3904160
	speed: 0.0240s/iter; left time: 1.1506s
Epoch: 10 cost time: 27.936291217803955
Epoch: 10, Steps: 1147 | Train Loss: 0.4073524 Vali Loss: 0.4379531 Test Loss: 0.1764601
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.1757446676492691, mae:0.21528621017932892
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.4613180
	speed: 0.0127s/iter; left time: 143.8550s
	iters: 200, epoch: 1 | loss: 0.4729212
	speed: 0.0128s/iter; left time: 143.7519s
	iters: 300, epoch: 1 | loss: 0.3847265
	speed: 0.0154s/iter; left time: 171.8755s
	iters: 400, epoch: 1 | loss: 0.5225949
	speed: 0.0171s/iter; left time: 189.0534s
	iters: 500, epoch: 1 | loss: 0.2897044
	speed: 0.0207s/iter; left time: 227.0550s
	iters: 600, epoch: 1 | loss: 0.5181388
	speed: 0.0231s/iter; left time: 251.3790s
	iters: 700, epoch: 1 | loss: 0.5779127
	speed: 0.0247s/iter; left time: 265.9288s
	iters: 800, epoch: 1 | loss: 0.4124424
	speed: 0.0260s/iter; left time: 277.1020s
	iters: 900, epoch: 1 | loss: 0.3750353
	speed: 0.0263s/iter; left time: 278.0260s
	iters: 1000, epoch: 1 | loss: 0.5984754
	speed: 0.0262s/iter; left time: 274.1014s
	iters: 1100, epoch: 1 | loss: 0.3353010
	speed: 0.0261s/iter; left time: 270.2310s
Epoch: 1 cost time: 29.834450006484985
Epoch: 1, Steps: 1147 | Train Loss: 0.4959629 Vali Loss: 0.4400156 Test Loss: 0.1811481
Validation loss decreased (inf --> 0.440016).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2696746
	speed: 0.0332s/iter; left time: 339.3604s
	iters: 200, epoch: 2 | loss: 0.2692748
	speed: 0.0311s/iter; left time: 315.1400s
	iters: 300, epoch: 2 | loss: 0.9481015
	speed: 0.0291s/iter; left time: 291.5986s
	iters: 400, epoch: 2 | loss: 0.3609955
	speed: 0.0275s/iter; left time: 272.8160s
	iters: 500, epoch: 2 | loss: 0.2740935
	speed: 0.0265s/iter; left time: 260.1206s
	iters: 600, epoch: 2 | loss: 0.2876596
	speed: 0.0260s/iter; left time: 252.9037s
	iters: 700, epoch: 2 | loss: 0.3299070
	speed: 0.0258s/iter; left time: 248.4463s
	iters: 800, epoch: 2 | loss: 0.3090010
	speed: 0.0256s/iter; left time: 244.1507s
	iters: 900, epoch: 2 | loss: 0.2961529
	speed: 0.0255s/iter; left time: 240.1239s
	iters: 1000, epoch: 2 | loss: 0.3211378
	speed: 0.0254s/iter; left time: 236.5056s
	iters: 1100, epoch: 2 | loss: 0.4501629
	speed: 0.0252s/iter; left time: 232.0287s
Epoch: 2 cost time: 28.810543537139893
Epoch: 2, Steps: 1147 | Train Loss: 0.4508059 Vali Loss: 0.4354421 Test Loss: 0.1784805
Validation loss decreased (0.440016 --> 0.435442).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4432682
	speed: 0.0445s/iter; left time: 403.7626s
	iters: 200, epoch: 3 | loss: 0.2807888
	speed: 0.0378s/iter; left time: 339.0314s
	iters: 300, epoch: 3 | loss: 0.3031066
	speed: 0.0326s/iter; left time: 289.1352s
	iters: 400, epoch: 3 | loss: 0.3145291
	speed: 0.0307s/iter; left time: 269.7962s
	iters: 500, epoch: 3 | loss: 0.4203313
	speed: 0.0308s/iter; left time: 267.5890s
	iters: 600, epoch: 3 | loss: 0.3003018
	speed: 0.0296s/iter; left time: 253.9059s
	iters: 700, epoch: 3 | loss: 0.2707836
	speed: 0.0288s/iter; left time: 244.1799s
	iters: 800, epoch: 3 | loss: 0.4278681
	speed: 0.0290s/iter; left time: 243.0945s
	iters: 900, epoch: 3 | loss: 0.3246097
	speed: 0.0299s/iter; left time: 247.8214s
	iters: 1000, epoch: 3 | loss: 0.2923298
	speed: 0.0292s/iter; left time: 238.4294s
	iters: 1100, epoch: 3 | loss: 0.3269727
	speed: 0.0278s/iter; left time: 224.7905s
Epoch: 3 cost time: 31.399616956710815
Epoch: 3, Steps: 1147 | Train Loss: 0.4307187 Vali Loss: 0.4350241 Test Loss: 0.1767235
Validation loss decreased (0.435442 --> 0.435024).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3524672
	speed: 0.0252s/iter; left time: 199.8240s
	iters: 200, epoch: 4 | loss: 0.3417817
	speed: 0.0240s/iter; left time: 187.9979s
	iters: 300, epoch: 4 | loss: 0.2962099
	speed: 0.0239s/iter; left time: 184.4188s
	iters: 400, epoch: 4 | loss: 0.2230177
	speed: 0.0237s/iter; left time: 180.4610s
	iters: 500, epoch: 4 | loss: 0.4568579
	speed: 0.0234s/iter; left time: 175.9928s
	iters: 600, epoch: 4 | loss: 0.2925839
	speed: 0.0238s/iter; left time: 177.1937s
	iters: 700, epoch: 4 | loss: 0.3763906
	speed: 0.0253s/iter; left time: 185.5123s
	iters: 800, epoch: 4 | loss: 0.3769587
	speed: 0.0266s/iter; left time: 192.0472s
	iters: 900, epoch: 4 | loss: 0.3773224
	speed: 0.0272s/iter; left time: 193.8090s
	iters: 1000, epoch: 4 | loss: 0.2782636
	speed: 0.0264s/iter; left time: 185.6063s
	iters: 1100, epoch: 4 | loss: 0.2899024
	speed: 0.0261s/iter; left time: 181.1753s
Epoch: 4 cost time: 30.168489694595337
Epoch: 4, Steps: 1147 | Train Loss: 0.4189158 Vali Loss: 0.4318185 Test Loss: 0.1755726
Validation loss decreased (0.435024 --> 0.431819).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5568349
	speed: 0.0284s/iter; left time: 192.5671s
	iters: 200, epoch: 5 | loss: 0.3349033
	speed: 0.0268s/iter; left time: 179.1722s
	iters: 300, epoch: 5 | loss: 0.2937786
	speed: 0.0262s/iter; left time: 172.2380s
	iters: 400, epoch: 5 | loss: 0.3580527
	speed: 0.0261s/iter; left time: 168.9203s
	iters: 500, epoch: 5 | loss: 0.2952678
	speed: 0.0253s/iter; left time: 161.6813s
	iters: 600, epoch: 5 | loss: 0.2622767
	speed: 0.0247s/iter; left time: 155.4018s
	iters: 700, epoch: 5 | loss: 0.2469676
	speed: 0.0244s/iter; left time: 150.5633s
	iters: 800, epoch: 5 | loss: 0.3163156
	speed: 0.0247s/iter; left time: 150.4751s
	iters: 900, epoch: 5 | loss: 0.3043239
	speed: 0.0245s/iter; left time: 146.3796s
	iters: 1000, epoch: 5 | loss: 0.2617108
	speed: 0.0244s/iter; left time: 143.6764s
	iters: 1100, epoch: 5 | loss: 0.3542122
	speed: 0.0244s/iter; left time: 141.2175s
Epoch: 5 cost time: 28.110843181610107
Epoch: 5, Steps: 1147 | Train Loss: 0.4128658 Vali Loss: 0.4304043 Test Loss: 0.1749429
Validation loss decreased (0.431819 --> 0.430404).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3154490
	speed: 0.0298s/iter; left time: 168.0303s
	iters: 200, epoch: 6 | loss: 0.2954949
	speed: 0.0266s/iter; left time: 147.4074s
	iters: 300, epoch: 6 | loss: 1.1519463
	speed: 0.0256s/iter; left time: 139.0891s
	iters: 400, epoch: 6 | loss: 0.2392460
	speed: 0.0251s/iter; left time: 133.9099s
	iters: 500, epoch: 6 | loss: 0.3209842
	speed: 0.0248s/iter; left time: 129.7314s
	iters: 600, epoch: 6 | loss: 0.3043796
	speed: 0.0246s/iter; left time: 126.2480s
	iters: 700, epoch: 6 | loss: 0.2760496
	speed: 0.0245s/iter; left time: 123.1944s
	iters: 800, epoch: 6 | loss: 0.3592261
	speed: 0.0243s/iter; left time: 120.1858s
	iters: 900, epoch: 6 | loss: 0.2499386
	speed: 0.0242s/iter; left time: 116.9395s
	iters: 1000, epoch: 6 | loss: 0.2570148
	speed: 0.0240s/iter; left time: 113.6889s
	iters: 1100, epoch: 6 | loss: 0.4555716
	speed: 0.0240s/iter; left time: 111.2853s
Epoch: 6 cost time: 27.607261657714844
Epoch: 6, Steps: 1147 | Train Loss: 0.4095233 Vali Loss: 0.4335290 Test Loss: 0.1765687
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3745126
	speed: 0.0192s/iter; left time: 86.2429s
	iters: 200, epoch: 7 | loss: 0.5071698
	speed: 0.0163s/iter; left time: 71.4644s
	iters: 300, epoch: 7 | loss: 0.4200878
	speed: 0.0170s/iter; left time: 72.7011s
	iters: 400, epoch: 7 | loss: 0.4664714
	speed: 0.0182s/iter; left time: 76.3640s
	iters: 500, epoch: 7 | loss: 0.3013473
	speed: 0.0188s/iter; left time: 76.7945s
	iters: 600, epoch: 7 | loss: 0.6126475
	speed: 0.0193s/iter; left time: 77.1199s
	iters: 700, epoch: 7 | loss: 0.2857846
	speed: 0.0196s/iter; left time: 76.3981s
	iters: 800, epoch: 7 | loss: 0.2575504
	speed: 0.0204s/iter; left time: 77.3082s
	iters: 900, epoch: 7 | loss: 0.3033094
	speed: 0.0210s/iter; left time: 77.4076s
	iters: 1000, epoch: 7 | loss: 0.2170753
	speed: 0.0227s/iter; left time: 81.4316s
	iters: 1100, epoch: 7 | loss: 0.2668739
	speed: 0.0235s/iter; left time: 81.8598s
Epoch: 7 cost time: 27.00099802017212
Epoch: 7, Steps: 1147 | Train Loss: 0.4077972 Vali Loss: 0.4350821 Test Loss: 0.1760387
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3547407
	speed: 0.0297s/iter; left time: 99.2166s
	iters: 200, epoch: 8 | loss: 0.6223022
	speed: 0.0259s/iter; left time: 84.0351s
	iters: 300, epoch: 8 | loss: 0.2478771
	speed: 0.0245s/iter; left time: 77.0655s
	iters: 400, epoch: 8 | loss: 0.3196505
	speed: 0.0232s/iter; left time: 70.5061s
	iters: 500, epoch: 8 | loss: 0.2761689
	speed: 0.0244s/iter; left time: 71.8018s
	iters: 600, epoch: 8 | loss: 0.3282387
	speed: 0.0265s/iter; left time: 75.2579s
	iters: 700, epoch: 8 | loss: 0.2262618
	speed: 0.0264s/iter; left time: 72.4466s
	iters: 800, epoch: 8 | loss: 0.4447330
	speed: 0.0263s/iter; left time: 69.4413s
	iters: 900, epoch: 8 | loss: 1.2633772
	speed: 0.0261s/iter; left time: 66.3773s
	iters: 1000, epoch: 8 | loss: 0.3566020
	speed: 0.0260s/iter; left time: 63.4195s
	iters: 1100, epoch: 8 | loss: 0.2469011
	speed: 0.0258s/iter; left time: 60.4071s
Epoch: 8 cost time: 29.5706946849823
Epoch: 8, Steps: 1147 | Train Loss: 0.4070577 Vali Loss: 0.4341307 Test Loss: 0.1762273
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4190041
	speed: 0.0362s/iter; left time: 79.4793s
	iters: 200, epoch: 9 | loss: 0.7692747
	speed: 0.0359s/iter; left time: 75.2491s
	iters: 300, epoch: 9 | loss: 0.2204022
	speed: 0.0335s/iter; left time: 66.8848s
	iters: 400, epoch: 9 | loss: 0.3234707
	speed: 0.0309s/iter; left time: 58.6049s
	iters: 500, epoch: 9 | loss: 1.2692795
	speed: 0.0291s/iter; left time: 52.1719s
	iters: 600, epoch: 9 | loss: 0.4325644
	speed: 0.0283s/iter; left time: 48.0379s
	iters: 700, epoch: 9 | loss: 1.0393355
	speed: 0.0278s/iter; left time: 44.3767s
	iters: 800, epoch: 9 | loss: 0.3227939
	speed: 0.0275s/iter; left time: 41.0575s
	iters: 900, epoch: 9 | loss: 0.5899793
	speed: 0.0271s/iter; left time: 37.8688s
	iters: 1000, epoch: 9 | loss: 0.2844679
	speed: 0.0269s/iter; left time: 34.8212s
	iters: 1100, epoch: 9 | loss: 0.3374136
	speed: 0.0265s/iter; left time: 31.7082s
Epoch: 9 cost time: 30.39322304725647
Epoch: 9, Steps: 1147 | Train Loss: 0.4064753 Vali Loss: 0.4344044 Test Loss: 0.1760719
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2344859
	speed: 0.0202s/iter; left time: 21.1743s
	iters: 200, epoch: 10 | loss: 0.2448009
	speed: 0.0211s/iter; left time: 20.0482s
	iters: 300, epoch: 10 | loss: 0.6089064
	speed: 0.0218s/iter; left time: 18.4462s
	iters: 400, epoch: 10 | loss: 0.2589402
	speed: 0.0224s/iter; left time: 16.7557s
	iters: 500, epoch: 10 | loss: 0.2858162
	speed: 0.0222s/iter; left time: 14.4118s
	iters: 600, epoch: 10 | loss: 0.3863339
	speed: 0.0235s/iter; left time: 12.9053s
	iters: 700, epoch: 10 | loss: 0.2817197
	speed: 0.0234s/iter; left time: 10.4991s
	iters: 800, epoch: 10 | loss: 0.2662672
	speed: 0.0235s/iter; left time: 8.1671s
	iters: 900, epoch: 10 | loss: 0.3395687
	speed: 0.0236s/iter; left time: 5.8491s
	iters: 1000, epoch: 10 | loss: 0.2829866
	speed: 0.0237s/iter; left time: 3.5101s
	iters: 1100, epoch: 10 | loss: 0.1841899
	speed: 0.0238s/iter; left time: 1.1421s
Epoch: 10 cost time: 27.412397623062134
Epoch: 10, Steps: 1147 | Train Loss: 0.4062040 Vali Loss: 0.4342498 Test Loss: 0.1762099
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.17494292557239532, mae:0.2136516124010086
Seed: 123
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_192      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.5047840
	speed: 0.0444s/iter; left time: 503.2442s
	iters: 200, epoch: 1 | loss: 0.5022653
	speed: 0.0334s/iter; left time: 375.3122s
	iters: 300, epoch: 1 | loss: 0.5732194
	speed: 0.0298s/iter; left time: 331.4547s
	iters: 400, epoch: 1 | loss: 0.4460410
	speed: 0.0281s/iter; left time: 309.8483s
	iters: 500, epoch: 1 | loss: 0.4375872
	speed: 0.0273s/iter; left time: 298.1504s
	iters: 600, epoch: 1 | loss: 0.9088525
	speed: 0.0265s/iter; left time: 287.8223s
	iters: 700, epoch: 1 | loss: 0.4058533
	speed: 0.0259s/iter; left time: 278.2577s
	iters: 800, epoch: 1 | loss: 0.6779702
	speed: 0.0256s/iter; left time: 272.4142s
	iters: 900, epoch: 1 | loss: 0.5228114
	speed: 0.0253s/iter; left time: 266.2272s
	iters: 1000, epoch: 1 | loss: 0.3206508
	speed: 0.0249s/iter; left time: 259.8948s
	iters: 1100, epoch: 1 | loss: 0.3751338
	speed: 0.0243s/iter; left time: 251.6538s
Epoch: 1 cost time: 28.0370352268219
Epoch: 1, Steps: 1144 | Train Loss: 0.5635973 Vali Loss: 0.5166664 Test Loss: 0.2308748
Validation loss decreased (inf --> 0.516666).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5163592
	speed: 0.0370s/iter; left time: 377.7509s
	iters: 200, epoch: 2 | loss: 0.3895660
	speed: 0.0294s/iter; left time: 296.9927s
	iters: 300, epoch: 2 | loss: 0.4940129
	speed: 0.0280s/iter; left time: 280.3966s
	iters: 400, epoch: 2 | loss: 0.4174728
	speed: 0.0266s/iter; left time: 263.4174s
	iters: 500, epoch: 2 | loss: 0.5380028
	speed: 0.0262s/iter; left time: 257.0496s
	iters: 600, epoch: 2 | loss: 0.4903975
	speed: 0.0262s/iter; left time: 254.5424s
	iters: 700, epoch: 2 | loss: 0.4045880
	speed: 0.0264s/iter; left time: 253.0062s
	iters: 800, epoch: 2 | loss: 0.3747351
	speed: 0.0256s/iter; left time: 242.9001s
	iters: 900, epoch: 2 | loss: 0.8601741
	speed: 0.0246s/iter; left time: 231.5160s
	iters: 1000, epoch: 2 | loss: 0.4203050
	speed: 0.0235s/iter; left time: 218.2808s
	iters: 1100, epoch: 2 | loss: 0.8358071
	speed: 0.0224s/iter; left time: 206.1880s
Epoch: 2 cost time: 25.361433267593384
Epoch: 2, Steps: 1144 | Train Loss: 0.5195400 Vali Loss: 0.5229936 Test Loss: 0.2310585
EarlyStopping counter: 1 out of 5
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5260308
	speed: 0.0263s/iter; left time: 238.3743s
	iters: 200, epoch: 3 | loss: 0.4364005
	speed: 0.0256s/iter; left time: 229.2436s
	iters: 300, epoch: 3 | loss: 0.3849486
	speed: 0.0244s/iter; left time: 216.2510s
	iters: 400, epoch: 3 | loss: 0.3962028
	speed: 0.0238s/iter; left time: 208.0236s
	iters: 500, epoch: 3 | loss: 0.8369209
	speed: 0.0245s/iter; left time: 212.4145s
	iters: 600, epoch: 3 | loss: 0.4220225
	speed: 0.0263s/iter; left time: 224.9608s
	iters: 700, epoch: 3 | loss: 0.4458302
	speed: 0.0274s/iter; left time: 231.3289s
	iters: 800, epoch: 3 | loss: 0.7767380
	speed: 0.0274s/iter; left time: 229.0153s
	iters: 900, epoch: 3 | loss: 0.5250748
	speed: 0.0266s/iter; left time: 219.2145s
	iters: 1000, epoch: 3 | loss: 0.4569658
	speed: 0.0258s/iter; left time: 210.4587s
	iters: 1100, epoch: 3 | loss: 0.3677380
	speed: 0.0252s/iter; left time: 203.1615s
Epoch: 3 cost time: 28.73030710220337
Epoch: 3, Steps: 1144 | Train Loss: 0.5018045 Vali Loss: 0.5084387 Test Loss: 0.2242954
Validation loss decreased (0.516666 --> 0.508439).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.9132611
	speed: 0.0277s/iter; left time: 218.9113s
	iters: 200, epoch: 4 | loss: 0.3965095
	speed: 0.0257s/iter; left time: 201.0481s
	iters: 300, epoch: 4 | loss: 0.8786541
	speed: 0.0252s/iter; left time: 194.3082s
	iters: 400, epoch: 4 | loss: 0.3778110
	speed: 0.0249s/iter; left time: 189.7924s
	iters: 500, epoch: 4 | loss: 0.3191636
	speed: 0.0244s/iter; left time: 183.3774s
	iters: 600, epoch: 4 | loss: 1.0880221
	speed: 0.0243s/iter; left time: 180.0066s
	iters: 700, epoch: 4 | loss: 0.4695133
	speed: 0.0239s/iter; left time: 174.7351s
	iters: 800, epoch: 4 | loss: 0.3425954
	speed: 0.0237s/iter; left time: 170.9721s
	iters: 900, epoch: 4 | loss: 0.5694525
	speed: 0.0236s/iter; left time: 167.6908s
	iters: 1000, epoch: 4 | loss: 0.4480833
	speed: 0.0234s/iter; left time: 163.8734s
	iters: 1100, epoch: 4 | loss: 0.3422744
	speed: 0.0231s/iter; left time: 159.8001s
Epoch: 4 cost time: 26.617021083831787
Epoch: 4, Steps: 1144 | Train Loss: 0.4909879 Vali Loss: 0.5125158 Test Loss: 0.2248676
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3179383
	speed: 0.0435s/iter; left time: 294.3914s
	iters: 200, epoch: 5 | loss: 0.4709957
	speed: 0.0382s/iter; left time: 254.8637s
	iters: 300, epoch: 5 | loss: 0.4031571
	speed: 0.0327s/iter; left time: 214.9028s
	iters: 400, epoch: 5 | loss: 0.3087852
	speed: 0.0299s/iter; left time: 193.3025s
	iters: 500, epoch: 5 | loss: 0.9027510
	speed: 0.0280s/iter; left time: 178.3841s
	iters: 600, epoch: 5 | loss: 0.3708507
	speed: 0.0265s/iter; left time: 166.0719s
	iters: 700, epoch: 5 | loss: 0.5210928
	speed: 0.0260s/iter; left time: 160.2780s
	iters: 800, epoch: 5 | loss: 0.3904773
	speed: 0.0256s/iter; left time: 155.0867s
	iters: 900, epoch: 5 | loss: 0.3707778
	speed: 0.0249s/iter; left time: 148.2920s
	iters: 1000, epoch: 5 | loss: 0.2940483
	speed: 0.0241s/iter; left time: 141.5130s
	iters: 1100, epoch: 5 | loss: 1.0028656
	speed: 0.0240s/iter; left time: 138.6070s
Epoch: 5 cost time: 27.348792552947998
Epoch: 5, Steps: 1144 | Train Loss: 0.4843975 Vali Loss: 0.5110818 Test Loss: 0.2243571
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3551588
	speed: 0.0360s/iter; left time: 202.5258s
	iters: 200, epoch: 6 | loss: 0.4890651
	speed: 0.0306s/iter; left time: 168.9288s
	iters: 300, epoch: 6 | loss: 0.3252448
	speed: 0.0284s/iter; left time: 154.1209s
	iters: 400, epoch: 6 | loss: 0.3642173
	speed: 0.0265s/iter; left time: 140.8628s
	iters: 500, epoch: 6 | loss: 0.3584251
	speed: 0.0251s/iter; left time: 130.9585s
	iters: 600, epoch: 6 | loss: 0.4361079
	speed: 0.0246s/iter; left time: 125.8190s
	iters: 700, epoch: 6 | loss: 0.4395322
	speed: 0.0243s/iter; left time: 121.8896s
	iters: 800, epoch: 6 | loss: 0.5467790
	speed: 0.0240s/iter; left time: 118.1835s
	iters: 900, epoch: 6 | loss: 0.4089913
	speed: 0.0240s/iter; left time: 115.6032s
	iters: 1000, epoch: 6 | loss: 0.3883390
	speed: 0.0245s/iter; left time: 115.7995s
	iters: 1100, epoch: 6 | loss: 0.3136149
	speed: 0.0246s/iter; left time: 113.7220s
Epoch: 6 cost time: 28.162437200546265
Epoch: 6, Steps: 1144 | Train Loss: 0.4809751 Vali Loss: 0.5174627 Test Loss: 0.2245998
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8456473
	speed: 0.0276s/iter; left time: 123.4201s
	iters: 200, epoch: 7 | loss: 0.3695761
	speed: 0.0254s/iter; left time: 111.3096s
	iters: 300, epoch: 7 | loss: 0.3937194
	speed: 0.0262s/iter; left time: 112.0009s
	iters: 400, epoch: 7 | loss: 0.4746951
	speed: 0.0258s/iter; left time: 107.5847s
	iters: 500, epoch: 7 | loss: 0.4205300
	speed: 0.0245s/iter; left time: 99.9608s
	iters: 600, epoch: 7 | loss: 0.3560416
	speed: 0.0242s/iter; left time: 96.3845s
	iters: 700, epoch: 7 | loss: 0.3889273
	speed: 0.0240s/iter; left time: 93.2217s
	iters: 800, epoch: 7 | loss: 0.3474175
	speed: 0.0239s/iter; left time: 90.3364s
	iters: 900, epoch: 7 | loss: 0.4862059
	speed: 0.0240s/iter; left time: 88.0983s
	iters: 1000, epoch: 7 | loss: 0.4659967
	speed: 0.0240s/iter; left time: 86.0046s
	iters: 1100, epoch: 7 | loss: 0.3595424
	speed: 0.0241s/iter; left time: 83.7470s
Epoch: 7 cost time: 27.680763959884644
Epoch: 7, Steps: 1144 | Train Loss: 0.4793143 Vali Loss: 0.5176181 Test Loss: 0.2245363
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3983487
	speed: 0.0238s/iter; left time: 79.2091s
	iters: 200, epoch: 8 | loss: 0.4849519
	speed: 0.0231s/iter; left time: 74.5863s
	iters: 300, epoch: 8 | loss: 0.4926793
	speed: 0.0231s/iter; left time: 72.2617s
	iters: 400, epoch: 8 | loss: 0.3996486
	speed: 0.0229s/iter; left time: 69.5730s
	iters: 500, epoch: 8 | loss: 0.2878212
	speed: 0.0239s/iter; left time: 69.9699s
	iters: 600, epoch: 8 | loss: 0.2993670
	speed: 0.0254s/iter; left time: 71.8453s
	iters: 700, epoch: 8 | loss: 0.4616848
	speed: 0.0258s/iter; left time: 70.3771s
	iters: 800, epoch: 8 | loss: 0.3578435
	speed: 0.0267s/iter; left time: 70.2864s
	iters: 900, epoch: 8 | loss: 0.4438352
	speed: 0.0268s/iter; left time: 67.9346s
	iters: 1000, epoch: 8 | loss: 0.3451433
	speed: 0.0260s/iter; left time: 63.3013s
	iters: 1100, epoch: 8 | loss: 0.3404306
	speed: 0.0254s/iter; left time: 59.2939s
Epoch: 8 cost time: 28.92413568496704
Epoch: 8, Steps: 1144 | Train Loss: 0.4783852 Vali Loss: 0.5161644 Test Loss: 0.2242936
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.22429554164409637, mae:0.2568235695362091
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.9655795
	speed: 0.0282s/iter; left time: 319.8556s
	iters: 200, epoch: 1 | loss: 0.4738988
	speed: 0.0248s/iter; left time: 278.9447s
	iters: 300, epoch: 1 | loss: 1.0157949
	speed: 0.0231s/iter; left time: 257.5673s
	iters: 400, epoch: 1 | loss: 0.3966616
	speed: 0.0225s/iter; left time: 248.8465s
	iters: 500, epoch: 1 | loss: 0.4601692
	speed: 0.0225s/iter; left time: 246.2752s
	iters: 600, epoch: 1 | loss: 0.5548615
	speed: 0.0225s/iter; left time: 243.7748s
	iters: 700, epoch: 1 | loss: 1.0870473
	speed: 0.0225s/iter; left time: 242.0737s
	iters: 800, epoch: 1 | loss: 0.5059314
	speed: 0.0225s/iter; left time: 239.4489s
	iters: 900, epoch: 1 | loss: 0.4625897
	speed: 0.0225s/iter; left time: 237.2036s
	iters: 1000, epoch: 1 | loss: 0.4274716
	speed: 0.0226s/iter; left time: 235.7112s
	iters: 1100, epoch: 1 | loss: 0.3857042
	speed: 0.0227s/iter; left time: 234.9211s
Epoch: 1 cost time: 26.19904899597168
Epoch: 1, Steps: 1144 | Train Loss: 0.5671155 Vali Loss: 0.5174100 Test Loss: 0.2303817
Validation loss decreased (inf --> 0.517410).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7029925
	speed: 0.0295s/iter; left time: 300.8352s
	iters: 200, epoch: 2 | loss: 0.4566071
	speed: 0.0256s/iter; left time: 258.0344s
	iters: 300, epoch: 2 | loss: 0.4009748
	speed: 0.0244s/iter; left time: 243.8223s
	iters: 400, epoch: 2 | loss: 0.3664599
	speed: 0.0238s/iter; left time: 235.3725s
	iters: 500, epoch: 2 | loss: 0.4105600
	speed: 0.0235s/iter; left time: 229.7729s
	iters: 600, epoch: 2 | loss: 0.4008518
	speed: 0.0232s/iter; left time: 224.6296s
	iters: 700, epoch: 2 | loss: 0.8543351
	speed: 0.0232s/iter; left time: 222.8988s
	iters: 800, epoch: 2 | loss: 0.4164640
	speed: 0.0232s/iter; left time: 220.2227s
	iters: 900, epoch: 2 | loss: 0.4124041
	speed: 0.0231s/iter; left time: 217.3534s
	iters: 1000, epoch: 2 | loss: 0.5289493
	speed: 0.0231s/iter; left time: 214.4319s
	iters: 1100, epoch: 2 | loss: 0.8178755
	speed: 0.0230s/iter; left time: 211.5556s
Epoch: 2 cost time: 26.427735567092896
Epoch: 2, Steps: 1144 | Train Loss: 0.5212765 Vali Loss: 0.5106981 Test Loss: 0.2273130
Validation loss decreased (0.517410 --> 0.510698).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4128556
	speed: 0.0369s/iter; left time: 334.1646s
	iters: 200, epoch: 3 | loss: 0.4726395
	speed: 0.0307s/iter; left time: 274.4641s
	iters: 300, epoch: 3 | loss: 0.3644059
	speed: 0.0287s/iter; left time: 253.8330s
	iters: 400, epoch: 3 | loss: 0.4747024
	speed: 0.0270s/iter; left time: 236.4726s
	iters: 500, epoch: 3 | loss: 0.3437136
	speed: 0.0260s/iter; left time: 225.0715s
	iters: 600, epoch: 3 | loss: 0.6135744
	speed: 0.0253s/iter; left time: 216.5373s
	iters: 700, epoch: 3 | loss: 0.5119566
	speed: 0.0249s/iter; left time: 210.4368s
	iters: 800, epoch: 3 | loss: 0.5154335
	speed: 0.0246s/iter; left time: 205.4640s
	iters: 900, epoch: 3 | loss: 0.3836582
	speed: 0.0252s/iter; left time: 208.0145s
	iters: 1000, epoch: 3 | loss: 0.8997352
	speed: 0.0255s/iter; left time: 207.9913s
	iters: 1100, epoch: 3 | loss: 0.3577006
	speed: 0.0251s/iter; left time: 201.7700s
Epoch: 3 cost time: 28.46287226676941
Epoch: 3, Steps: 1144 | Train Loss: 0.5018946 Vali Loss: 0.5166370 Test Loss: 0.2257950
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3720735
	speed: 0.0251s/iter; left time: 198.4461s
	iters: 200, epoch: 4 | loss: 0.4244158
	speed: 0.0310s/iter; left time: 242.1585s
	iters: 300, epoch: 4 | loss: 0.3854983
	speed: 0.0318s/iter; left time: 245.4012s
	iters: 400, epoch: 4 | loss: 0.4530229
	speed: 0.0311s/iter; left time: 236.2810s
	iters: 500, epoch: 4 | loss: 0.3645810
	speed: 0.0291s/iter; left time: 218.8709s
	iters: 600, epoch: 4 | loss: 0.4293941
	speed: 0.0279s/iter; left time: 206.7036s
	iters: 700, epoch: 4 | loss: 0.4190630
	speed: 0.0270s/iter; left time: 197.0534s
	iters: 800, epoch: 4 | loss: 0.3643431
	speed: 0.0263s/iter; left time: 189.2901s
	iters: 900, epoch: 4 | loss: 0.4789248
	speed: 0.0264s/iter; left time: 188.0167s
	iters: 1000, epoch: 4 | loss: 0.3990608
	speed: 0.0272s/iter; left time: 190.2952s
	iters: 1100, epoch: 4 | loss: 0.4121700
	speed: 0.0268s/iter; left time: 185.3710s
Epoch: 4 cost time: 30.694464206695557
Epoch: 4, Steps: 1144 | Train Loss: 0.4913590 Vali Loss: 0.5046144 Test Loss: 0.2230751
Validation loss decreased (0.510698 --> 0.504614).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3678709
	speed: 0.0395s/iter; left time: 267.5222s
	iters: 200, epoch: 5 | loss: 0.3794599
	speed: 0.0312s/iter; left time: 207.6153s
	iters: 300, epoch: 5 | loss: 0.5297919
	speed: 0.0288s/iter; left time: 189.0323s
	iters: 400, epoch: 5 | loss: 0.5102600
	speed: 0.0294s/iter; left time: 190.3464s
	iters: 500, epoch: 5 | loss: 0.3983903
	speed: 0.0281s/iter; left time: 178.7779s
	iters: 600, epoch: 5 | loss: 0.8527488
	speed: 0.0272s/iter; left time: 170.6610s
	iters: 700, epoch: 5 | loss: 0.4228099
	speed: 0.0268s/iter; left time: 165.1604s
	iters: 800, epoch: 5 | loss: 0.5605545
	speed: 0.0263s/iter; left time: 159.3087s
	iters: 900, epoch: 5 | loss: 0.4290968
	speed: 0.0258s/iter; left time: 154.1362s
	iters: 1000, epoch: 5 | loss: 0.4564955
	speed: 0.0256s/iter; left time: 149.8716s
	iters: 1100, epoch: 5 | loss: 0.8982177
	speed: 0.0255s/iter; left time: 146.9865s
Epoch: 5 cost time: 29.26706576347351
Epoch: 5, Steps: 1144 | Train Loss: 0.4852844 Vali Loss: 0.5021869 Test Loss: 0.2219599
Validation loss decreased (0.504614 --> 0.502187).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4078426
	speed: 0.0353s/iter; left time: 198.3749s
	iters: 200, epoch: 6 | loss: 0.3438009
	speed: 0.0281s/iter; left time: 155.3850s
	iters: 300, epoch: 6 | loss: 0.3999001
	speed: 0.0257s/iter; left time: 139.5846s
	iters: 400, epoch: 6 | loss: 0.4636672
	speed: 0.0247s/iter; left time: 131.2745s
	iters: 500, epoch: 6 | loss: 0.4263455
	speed: 0.0242s/iter; left time: 126.5961s
	iters: 600, epoch: 6 | loss: 0.9161163
	speed: 0.0240s/iter; left time: 123.0022s
	iters: 700, epoch: 6 | loss: 0.7198938
	speed: 0.0241s/iter; left time: 120.8086s
	iters: 800, epoch: 6 | loss: 0.3959217
	speed: 0.0241s/iter; left time: 118.4710s
	iters: 900, epoch: 6 | loss: 0.3225927
	speed: 0.0241s/iter; left time: 116.0353s
	iters: 1000, epoch: 6 | loss: 0.4076355
	speed: 0.0235s/iter; left time: 111.0998s
	iters: 1100, epoch: 6 | loss: 0.3499110
	speed: 0.0231s/iter; left time: 106.6713s
Epoch: 6 cost time: 26.2672700881958
Epoch: 6, Steps: 1144 | Train Loss: 0.4819983 Vali Loss: 0.5054796 Test Loss: 0.2221776
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3825464
	speed: 0.0322s/iter; left time: 143.9579s
	iters: 200, epoch: 7 | loss: 0.2957779
	speed: 0.0275s/iter; left time: 120.3970s
	iters: 300, epoch: 7 | loss: 0.4499734
	speed: 0.0259s/iter; left time: 110.7486s
	iters: 400, epoch: 7 | loss: 0.9634063
	speed: 0.0243s/iter; left time: 101.4743s
	iters: 500, epoch: 7 | loss: 0.2789274
	speed: 0.0237s/iter; left time: 96.7341s
	iters: 600, epoch: 7 | loss: 0.3954746
	speed: 0.0234s/iter; left time: 92.8643s
	iters: 700, epoch: 7 | loss: 0.4184710
	speed: 0.0231s/iter; left time: 89.5586s
	iters: 800, epoch: 7 | loss: 0.4087946
	speed: 0.0230s/iter; left time: 86.7168s
	iters: 900, epoch: 7 | loss: 0.4746139
	speed: 0.0232s/iter; left time: 85.1274s
	iters: 1000, epoch: 7 | loss: 0.4184609
	speed: 0.0230s/iter; left time: 82.3690s
	iters: 1100, epoch: 7 | loss: 0.4126961
	speed: 0.0229s/iter; left time: 79.6652s
Epoch: 7 cost time: 26.335132360458374
Epoch: 7, Steps: 1144 | Train Loss: 0.4805290 Vali Loss: 0.5074252 Test Loss: 0.2229152
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4072639
	speed: 0.0390s/iter; left time: 129.9101s
	iters: 200, epoch: 8 | loss: 0.4357170
	speed: 0.0315s/iter; left time: 101.9231s
	iters: 300, epoch: 8 | loss: 0.4839639
	speed: 0.0276s/iter; left time: 86.6035s
	iters: 400, epoch: 8 | loss: 0.4298695
	speed: 0.0255s/iter; left time: 77.2737s
	iters: 500, epoch: 8 | loss: 0.4885541
	speed: 0.0242s/iter; left time: 71.0530s
	iters: 600, epoch: 8 | loss: 0.4467014
	speed: 0.0240s/iter; left time: 68.0715s
	iters: 700, epoch: 8 | loss: 0.4000077
	speed: 0.0249s/iter; left time: 68.1193s
	iters: 800, epoch: 8 | loss: 0.4287764
	speed: 0.0246s/iter; left time: 64.6605s
	iters: 900, epoch: 8 | loss: 1.3301095
	speed: 0.0243s/iter; left time: 61.4792s
	iters: 1000, epoch: 8 | loss: 0.3984225
	speed: 0.0240s/iter; left time: 58.4883s
	iters: 1100, epoch: 8 | loss: 0.8689063
	speed: 0.0246s/iter; left time: 57.3462s
Epoch: 8 cost time: 28.818074703216553
Epoch: 8, Steps: 1144 | Train Loss: 0.4797108 Vali Loss: 0.5069686 Test Loss: 0.2230014
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4343212
	speed: 0.0341s/iter; left time: 74.7120s
	iters: 200, epoch: 9 | loss: 0.4416583
	speed: 0.0271s/iter; left time: 56.5704s
	iters: 300, epoch: 9 | loss: 0.3358922
	speed: 0.0245s/iter; left time: 48.6709s
	iters: 400, epoch: 9 | loss: 0.8622053
	speed: 0.0234s/iter; left time: 44.2630s
	iters: 500, epoch: 9 | loss: 0.2988257
	speed: 0.0225s/iter; left time: 40.2644s
	iters: 600, epoch: 9 | loss: 0.4113253
	speed: 0.0218s/iter; left time: 36.7712s
	iters: 700, epoch: 9 | loss: 0.4695459
	speed: 0.0211s/iter; left time: 33.4769s
	iters: 800, epoch: 9 | loss: 0.4538955
	speed: 0.0208s/iter; left time: 30.9334s
	iters: 900, epoch: 9 | loss: 0.9816008
	speed: 0.0206s/iter; left time: 28.5750s
	iters: 1000, epoch: 9 | loss: 0.4237779
	speed: 0.0204s/iter; left time: 26.3296s
	iters: 1100, epoch: 9 | loss: 0.4224336
	speed: 0.0210s/iter; left time: 24.9318s
Epoch: 9 cost time: 24.039190769195557
Epoch: 9, Steps: 1144 | Train Loss: 0.4792153 Vali Loss: 0.5078147 Test Loss: 0.2228556
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.4498447
	speed: 0.0399s/iter; left time: 41.6760s
	iters: 200, epoch: 10 | loss: 0.4171386
	speed: 0.0316s/iter; left time: 29.8475s
	iters: 300, epoch: 10 | loss: 0.4241897
	speed: 0.0287s/iter; left time: 24.2331s
	iters: 400, epoch: 10 | loss: 0.5106093
	speed: 0.0272s/iter; left time: 20.2309s
	iters: 500, epoch: 10 | loss: 0.6525727
	speed: 0.0263s/iter; left time: 16.9551s
	iters: 600, epoch: 10 | loss: 0.3646401
	speed: 0.0254s/iter; left time: 13.8455s
	iters: 700, epoch: 10 | loss: 0.3288282
	speed: 0.0248s/iter; left time: 11.0378s
	iters: 800, epoch: 10 | loss: 0.3397613
	speed: 0.0241s/iter; left time: 8.3277s
	iters: 900, epoch: 10 | loss: 0.3996872
	speed: 0.0237s/iter; left time: 5.7972s
	iters: 1000, epoch: 10 | loss: 0.4868111
	speed: 0.0233s/iter; left time: 3.3758s
	iters: 1100, epoch: 10 | loss: 0.8053133
	speed: 0.0233s/iter; left time: 1.0499s
Epoch: 10 cost time: 26.85832643508911
Epoch: 10, Steps: 1144 | Train Loss: 0.4790019 Vali Loss: 0.5069457 Test Loss: 0.2226462
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.2219599485397339, mae:0.2559719383716583
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 1.0212159
	speed: 0.0366s/iter; left time: 415.4194s
	iters: 200, epoch: 1 | loss: 0.9659734
	speed: 0.0308s/iter; left time: 346.6369s
	iters: 300, epoch: 1 | loss: 0.4458999
	speed: 0.0289s/iter; left time: 321.6460s
	iters: 400, epoch: 1 | loss: 0.3989233
	speed: 0.0269s/iter; left time: 296.5981s
	iters: 500, epoch: 1 | loss: 0.4012633
	speed: 0.0253s/iter; left time: 276.8487s
	iters: 600, epoch: 1 | loss: 0.4463042
	speed: 0.0244s/iter; left time: 264.5242s
	iters: 700, epoch: 1 | loss: 0.5242842
	speed: 0.0237s/iter; left time: 254.8809s
	iters: 800, epoch: 1 | loss: 0.4779181
	speed: 0.0240s/iter; left time: 255.5970s
	iters: 900, epoch: 1 | loss: 0.4740437
	speed: 0.0251s/iter; left time: 264.6529s
	iters: 1000, epoch: 1 | loss: 0.3824646
	speed: 0.0259s/iter; left time: 270.9254s
	iters: 1100, epoch: 1 | loss: 0.4162725
	speed: 0.0269s/iter; left time: 277.9080s
Epoch: 1 cost time: 30.828243494033813
Epoch: 1, Steps: 1144 | Train Loss: 0.5642371 Vali Loss: 0.5175900 Test Loss: 0.2317965
Validation loss decreased (inf --> 0.517590).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4777804
	speed: 0.0324s/iter; left time: 330.4275s
	iters: 200, epoch: 2 | loss: 0.6525753
	speed: 0.0271s/iter; left time: 273.3911s
	iters: 300, epoch: 2 | loss: 0.4237778
	speed: 0.0253s/iter; left time: 252.8118s
	iters: 400, epoch: 2 | loss: 0.5726549
	speed: 0.0250s/iter; left time: 247.1504s
	iters: 500, epoch: 2 | loss: 0.3139684
	speed: 0.0229s/iter; left time: 224.0254s
	iters: 600, epoch: 2 | loss: 0.4824233
	speed: 0.0220s/iter; left time: 213.1796s
	iters: 700, epoch: 2 | loss: 0.5553898
	speed: 0.0217s/iter; left time: 208.5963s
	iters: 800, epoch: 2 | loss: 0.4797359
	speed: 0.0229s/iter; left time: 217.0412s
	iters: 900, epoch: 2 | loss: 0.3970802
	speed: 0.0243s/iter; left time: 227.9615s
	iters: 1000, epoch: 2 | loss: 0.4486946
	speed: 0.0245s/iter; left time: 227.8954s
	iters: 1100, epoch: 2 | loss: 0.3882737
	speed: 0.0243s/iter; left time: 223.6948s
Epoch: 2 cost time: 28.37668013572693
Epoch: 2, Steps: 1144 | Train Loss: 0.5212574 Vali Loss: 0.5278509 Test Loss: 0.2314174
EarlyStopping counter: 1 out of 5
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5298948
	speed: 0.0333s/iter; left time: 301.1799s
	iters: 200, epoch: 3 | loss: 0.4524633
	speed: 0.0264s/iter; left time: 236.7171s
	iters: 300, epoch: 3 | loss: 0.5493307
	speed: 0.0244s/iter; left time: 215.6822s
	iters: 400, epoch: 3 | loss: 0.3483706
	speed: 0.0241s/iter; left time: 210.7007s
	iters: 500, epoch: 3 | loss: 0.4522088
	speed: 0.0237s/iter; left time: 205.0689s
	iters: 600, epoch: 3 | loss: 0.2974084
	speed: 0.0236s/iter; left time: 201.9132s
	iters: 700, epoch: 3 | loss: 0.4157940
	speed: 0.0238s/iter; left time: 200.8007s
	iters: 800, epoch: 3 | loss: 0.4423718
	speed: 0.0241s/iter; left time: 201.1944s
	iters: 900, epoch: 3 | loss: 0.3907703
	speed: 0.0240s/iter; left time: 197.8019s
	iters: 1000, epoch: 3 | loss: 0.3999153
	speed: 0.0240s/iter; left time: 195.4258s
	iters: 1100, epoch: 3 | loss: 0.3999006
	speed: 0.0239s/iter; left time: 192.2883s
Epoch: 3 cost time: 27.942505598068237
Epoch: 3, Steps: 1144 | Train Loss: 0.5023949 Vali Loss: 0.5052997 Test Loss: 0.2236170
Validation loss decreased (0.517590 --> 0.505300).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4552919
	speed: 0.0284s/iter; left time: 224.6416s
	iters: 200, epoch: 4 | loss: 0.3894721
	speed: 0.0250s/iter; left time: 195.4715s
	iters: 300, epoch: 4 | loss: 0.3319600
	speed: 0.0229s/iter; left time: 176.3125s
	iters: 400, epoch: 4 | loss: 0.2911885
	speed: 0.0222s/iter; left time: 168.9546s
	iters: 500, epoch: 4 | loss: 0.8405762
	speed: 0.0219s/iter; left time: 164.7453s
	iters: 600, epoch: 4 | loss: 0.4103229
	speed: 0.0224s/iter; left time: 165.9922s
	iters: 700, epoch: 4 | loss: 0.5168700
	speed: 0.0227s/iter; left time: 166.0939s
	iters: 800, epoch: 4 | loss: 0.3632541
	speed: 0.0229s/iter; left time: 165.3472s
	iters: 900, epoch: 4 | loss: 0.2880293
	speed: 0.0231s/iter; left time: 164.3464s
	iters: 1000, epoch: 4 | loss: 0.4985299
	speed: 0.0232s/iter; left time: 162.9574s
	iters: 1100, epoch: 4 | loss: 0.4995038
	speed: 0.0234s/iter; left time: 161.6555s
Epoch: 4 cost time: 26.877004861831665
Epoch: 4, Steps: 1144 | Train Loss: 0.4909646 Vali Loss: 0.5117658 Test Loss: 0.2247139
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3748712
	speed: 0.0310s/iter; left time: 209.8748s
	iters: 200, epoch: 5 | loss: 0.3098240
	speed: 0.0271s/iter; left time: 180.4562s
	iters: 300, epoch: 5 | loss: 0.4883519
	speed: 0.0256s/iter; left time: 168.3066s
	iters: 400, epoch: 5 | loss: 0.4827536
	speed: 0.0242s/iter; left time: 156.6324s
	iters: 500, epoch: 5 | loss: 0.9981526
	speed: 0.0229s/iter; left time: 145.9961s
	iters: 600, epoch: 5 | loss: 0.4125203
	speed: 0.0217s/iter; left time: 136.1667s
	iters: 700, epoch: 5 | loss: 0.3591387
	speed: 0.0210s/iter; left time: 129.3570s
	iters: 800, epoch: 5 | loss: 0.3945907
	speed: 0.0205s/iter; left time: 124.2605s
	iters: 900, epoch: 5 | loss: 0.3018523
	speed: 0.0201s/iter; left time: 120.0665s
	iters: 1000, epoch: 5 | loss: 0.3760648
	speed: 0.0202s/iter; left time: 118.2790s
	iters: 1100, epoch: 5 | loss: 0.3593494
	speed: 0.0205s/iter; left time: 117.9959s
Epoch: 5 cost time: 23.697455883026123
Epoch: 5, Steps: 1144 | Train Loss: 0.4847057 Vali Loss: 0.5076120 Test Loss: 0.2233994
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3296186
	speed: 0.0280s/iter; left time: 157.3893s
	iters: 200, epoch: 6 | loss: 0.3350315
	speed: 0.0259s/iter; left time: 142.7311s
	iters: 300, epoch: 6 | loss: 0.8144504
	speed: 0.0245s/iter; left time: 132.5955s
	iters: 400, epoch: 6 | loss: 0.3758186
	speed: 0.0241s/iter; left time: 128.1704s
	iters: 500, epoch: 6 | loss: 0.2982156
	speed: 0.0239s/iter; left time: 124.5273s
	iters: 600, epoch: 6 | loss: 0.3734364
	speed: 0.0236s/iter; left time: 120.8753s
	iters: 700, epoch: 6 | loss: 0.6376023
	speed: 0.0243s/iter; left time: 121.8862s
	iters: 800, epoch: 6 | loss: 0.7212043
	speed: 0.0252s/iter; left time: 124.0828s
	iters: 900, epoch: 6 | loss: 0.3105925
	speed: 0.0250s/iter; left time: 120.3797s
	iters: 1000, epoch: 6 | loss: 0.3928545
	speed: 0.0247s/iter; left time: 116.6926s
	iters: 1100, epoch: 6 | loss: 0.3750267
	speed: 0.0245s/iter; left time: 113.1879s
Epoch: 6 cost time: 28.134157180786133
Epoch: 6, Steps: 1144 | Train Loss: 0.4811419 Vali Loss: 0.5075928 Test Loss: 0.2231981
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4944740
	speed: 0.0398s/iter; left time: 178.0864s
	iters: 200, epoch: 7 | loss: 0.4381825
	speed: 0.0342s/iter; left time: 149.4896s
	iters: 300, epoch: 7 | loss: 0.5252922
	speed: 0.0303s/iter; left time: 129.7336s
	iters: 400, epoch: 7 | loss: 0.4346550
	speed: 0.0286s/iter; left time: 119.5722s
	iters: 500, epoch: 7 | loss: 0.3379502
	speed: 0.0293s/iter; left time: 119.2946s
	iters: 600, epoch: 7 | loss: 0.3352233
	speed: 0.0290s/iter; left time: 115.1583s
	iters: 700, epoch: 7 | loss: 0.3811991
	speed: 0.0286s/iter; left time: 110.8489s
	iters: 800, epoch: 7 | loss: 0.8796731
	speed: 0.0278s/iter; left time: 104.8140s
	iters: 900, epoch: 7 | loss: 0.4337267
	speed: 0.0271s/iter; left time: 99.6720s
	iters: 1000, epoch: 7 | loss: 0.3419591
	speed: 0.0266s/iter; left time: 95.2797s
	iters: 1100, epoch: 7 | loss: 0.4140973
	speed: 0.0264s/iter; left time: 91.7958s
Epoch: 7 cost time: 30.22069549560547
Epoch: 7, Steps: 1144 | Train Loss: 0.4796122 Vali Loss: 0.5096015 Test Loss: 0.2232765
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3314607
	speed: 0.0420s/iter; left time: 139.9463s
	iters: 200, epoch: 8 | loss: 0.8490708
	speed: 0.0369s/iter; left time: 119.2599s
	iters: 300, epoch: 8 | loss: 0.3789784
	speed: 0.0313s/iter; left time: 97.9499s
	iters: 400, epoch: 8 | loss: 0.4356122
	speed: 0.0278s/iter; left time: 84.3823s
	iters: 500, epoch: 8 | loss: 0.3880713
	speed: 0.0259s/iter; left time: 75.9402s
	iters: 600, epoch: 8 | loss: 0.4261729
	speed: 0.0242s/iter; left time: 68.5818s
	iters: 700, epoch: 8 | loss: 0.3017896
	speed: 0.0229s/iter; left time: 62.5706s
	iters: 800, epoch: 8 | loss: 0.8589641
	speed: 0.0220s/iter; left time: 57.9466s
	iters: 900, epoch: 8 | loss: 0.3558790
	speed: 0.0213s/iter; left time: 54.0695s
	iters: 1000, epoch: 8 | loss: 0.4348599
	speed: 0.0214s/iter; left time: 51.9934s
	iters: 1100, epoch: 8 | loss: 0.4709218
	speed: 0.0224s/iter; left time: 52.2278s
Epoch: 8 cost time: 25.47795271873474
Epoch: 8, Steps: 1144 | Train Loss: 0.4786424 Vali Loss: 0.5084582 Test Loss: 0.2231196
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.22361715137958527, mae:0.25689855217933655
Seed: 123
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_336      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.7483109
	speed: 0.0417s/iter; left time: 471.5322s
	iters: 200, epoch: 1 | loss: 0.5442199
	speed: 0.0370s/iter; left time: 414.8973s
	iters: 300, epoch: 1 | loss: 0.5590834
	speed: 0.0361s/iter; left time: 400.8104s
	iters: 400, epoch: 1 | loss: 0.5274429
	speed: 0.0331s/iter; left time: 364.5641s
	iters: 500, epoch: 1 | loss: 1.0609027
	speed: 0.0312s/iter; left time: 340.2427s
	iters: 600, epoch: 1 | loss: 0.6007740
	speed: 0.0298s/iter; left time: 321.4130s
	iters: 700, epoch: 1 | loss: 0.5418457
	speed: 0.0298s/iter; left time: 318.5917s
	iters: 800, epoch: 1 | loss: 0.5169795
	speed: 0.0303s/iter; left time: 321.3018s
	iters: 900, epoch: 1 | loss: 0.4740213
	speed: 0.0300s/iter; left time: 314.5537s
	iters: 1000, epoch: 1 | loss: 0.4957285
	speed: 0.0306s/iter; left time: 317.7570s
	iters: 1100, epoch: 1 | loss: 0.5740784
	speed: 0.0301s/iter; left time: 310.5377s
Epoch: 1 cost time: 34.034663915634155
Epoch: 1, Steps: 1140 | Train Loss: 0.6357528 Vali Loss: 0.6077885 Test Loss: 0.2869944
Validation loss decreased (inf --> 0.607789).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5645842
	speed: 0.0361s/iter; left time: 366.8636s
	iters: 200, epoch: 2 | loss: 0.4503911
	speed: 0.0359s/iter; left time: 360.6964s
	iters: 300, epoch: 2 | loss: 0.4607436
	speed: 0.0355s/iter; left time: 353.3253s
	iters: 400, epoch: 2 | loss: 0.5080496
	speed: 0.0345s/iter; left time: 340.1994s
	iters: 500, epoch: 2 | loss: 0.9345110
	speed: 0.0321s/iter; left time: 313.5209s
	iters: 600, epoch: 2 | loss: 0.8705133
	speed: 0.0316s/iter; left time: 305.5593s
	iters: 700, epoch: 2 | loss: 0.4520810
	speed: 0.0319s/iter; left time: 305.2846s
	iters: 800, epoch: 2 | loss: 0.4817746
	speed: 0.0315s/iter; left time: 298.0658s
	iters: 900, epoch: 2 | loss: 0.4998227
	speed: 0.0313s/iter; left time: 292.8337s
	iters: 1000, epoch: 2 | loss: 0.4277439
	speed: 0.0312s/iter; left time: 288.9382s
	iters: 1100, epoch: 2 | loss: 0.8011550
	speed: 0.0309s/iter; left time: 282.9056s
Epoch: 2 cost time: 34.87006378173828
Epoch: 2, Steps: 1140 | Train Loss: 0.5944562 Vali Loss: 0.6270620 Test Loss: 0.2886052
EarlyStopping counter: 1 out of 5
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5488146
	speed: 0.0326s/iter; left time: 293.9885s
	iters: 200, epoch: 3 | loss: 0.4190851
	speed: 0.0339s/iter; left time: 302.3773s
	iters: 300, epoch: 3 | loss: 0.5555472
	speed: 0.0291s/iter; left time: 256.9935s
	iters: 400, epoch: 3 | loss: 0.5589941
	speed: 0.0265s/iter; left time: 231.3213s
	iters: 500, epoch: 3 | loss: 0.5171037
	speed: 0.0247s/iter; left time: 212.9573s
	iters: 600, epoch: 3 | loss: 0.5103782
	speed: 0.0235s/iter; left time: 200.3018s
	iters: 700, epoch: 3 | loss: 0.4689526
	speed: 0.0227s/iter; left time: 191.1201s
	iters: 800, epoch: 3 | loss: 0.5063058
	speed: 0.0220s/iter; left time: 183.3486s
	iters: 900, epoch: 3 | loss: 0.5281196
	speed: 0.0211s/iter; left time: 173.1168s
	iters: 1000, epoch: 3 | loss: 0.4128203
	speed: 0.0205s/iter; left time: 166.5676s
	iters: 1100, epoch: 3 | loss: 0.4905240
	speed: 0.0200s/iter; left time: 160.0271s
Epoch: 3 cost time: 22.78888201713562
Epoch: 3, Steps: 1140 | Train Loss: 0.5749723 Vali Loss: 0.5954595 Test Loss: 0.2827993
Validation loss decreased (0.607789 --> 0.595460).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.7191709
	speed: 0.0372s/iter; left time: 293.3013s
	iters: 200, epoch: 4 | loss: 0.4919721
	speed: 0.0355s/iter; left time: 276.2333s
	iters: 300, epoch: 4 | loss: 0.6229900
	speed: 0.0358s/iter; left time: 275.3370s
	iters: 400, epoch: 4 | loss: 0.4481332
	speed: 0.0348s/iter; left time: 264.0192s
	iters: 500, epoch: 4 | loss: 0.4577282
	speed: 0.0323s/iter; left time: 241.8125s
	iters: 600, epoch: 4 | loss: 0.4970484
	speed: 0.0307s/iter; left time: 226.4405s
	iters: 700, epoch: 4 | loss: 0.7881741
	speed: 0.0296s/iter; left time: 215.1963s
	iters: 800, epoch: 4 | loss: 0.4118799
	speed: 0.0286s/iter; left time: 205.0627s
	iters: 900, epoch: 4 | loss: 0.7569990
	speed: 0.0279s/iter; left time: 197.6615s
	iters: 1000, epoch: 4 | loss: 0.7732221
	speed: 0.0274s/iter; left time: 190.9693s
	iters: 1100, epoch: 4 | loss: 0.7455511
	speed: 0.0266s/iter; left time: 183.3315s
Epoch: 4 cost time: 30.21800971031189
Epoch: 4, Steps: 1140 | Train Loss: 0.5629692 Vali Loss: 0.6014906 Test Loss: 0.2827993
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.8798124
	speed: 0.0250s/iter; left time: 168.7355s
	iters: 200, epoch: 5 | loss: 0.5722298
	speed: 0.0241s/iter; left time: 160.3421s
	iters: 300, epoch: 5 | loss: 0.5207221
	speed: 0.0249s/iter; left time: 162.8997s
	iters: 400, epoch: 5 | loss: 0.9876128
	speed: 0.0244s/iter; left time: 157.4049s
	iters: 500, epoch: 5 | loss: 0.4659232
	speed: 0.0245s/iter; left time: 155.1079s
	iters: 600, epoch: 5 | loss: 0.4802272
	speed: 0.0245s/iter; left time: 152.6019s
	iters: 700, epoch: 5 | loss: 0.5418201
	speed: 0.0242s/iter; left time: 148.3153s
	iters: 800, epoch: 5 | loss: 0.4389107
	speed: 0.0239s/iter; left time: 144.5949s
	iters: 900, epoch: 5 | loss: 0.6905934
	speed: 0.0238s/iter; left time: 141.1978s
	iters: 1000, epoch: 5 | loss: 0.4942621
	speed: 0.0236s/iter; left time: 138.1012s
	iters: 1100, epoch: 5 | loss: 0.4514838
	speed: 0.0238s/iter; left time: 136.3558s
Epoch: 5 cost time: 27.222975730895996
Epoch: 5, Steps: 1140 | Train Loss: 0.5564526 Vali Loss: 0.5998978 Test Loss: 0.2817201
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4560949
	speed: 0.0243s/iter; left time: 136.0943s
	iters: 200, epoch: 6 | loss: 0.6426270
	speed: 0.0220s/iter; left time: 120.7997s
	iters: 300, epoch: 6 | loss: 0.4088302
	speed: 0.0216s/iter; left time: 116.4599s
	iters: 400, epoch: 6 | loss: 0.5134061
	speed: 0.0215s/iter; left time: 114.2148s
	iters: 500, epoch: 6 | loss: 0.4439072
	speed: 0.0222s/iter; left time: 115.3492s
	iters: 600, epoch: 6 | loss: 0.7452304
	speed: 0.0226s/iter; left time: 115.5375s
	iters: 700, epoch: 6 | loss: 0.7474366
	speed: 0.0224s/iter; left time: 112.0306s
	iters: 800, epoch: 6 | loss: 0.3898349
	speed: 0.0218s/iter; left time: 106.7771s
	iters: 900, epoch: 6 | loss: 1.0029294
	speed: 0.0213s/iter; left time: 102.4101s
	iters: 1000, epoch: 6 | loss: 0.4681630
	speed: 0.0209s/iter; left time: 98.2980s
	iters: 1100, epoch: 6 | loss: 0.4350632
	speed: 0.0206s/iter; left time: 94.5566s
Epoch: 6 cost time: 23.379111289978027
Epoch: 6, Steps: 1140 | Train Loss: 0.5524140 Vali Loss: 0.5997621 Test Loss: 0.2825131
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4741344
	speed: 0.0267s/iter; left time: 118.9557s
	iters: 200, epoch: 7 | loss: 0.9821727
	speed: 0.0247s/iter; left time: 107.8570s
	iters: 300, epoch: 7 | loss: 0.6736439
	speed: 0.0241s/iter; left time: 102.7594s
	iters: 400, epoch: 7 | loss: 0.4390413
	speed: 0.0230s/iter; left time: 95.8498s
	iters: 500, epoch: 7 | loss: 0.3636598
	speed: 0.0221s/iter; left time: 89.8610s
	iters: 600, epoch: 7 | loss: 0.6607189
	speed: 0.0220s/iter; left time: 87.2460s
	iters: 700, epoch: 7 | loss: 0.4208783
	speed: 0.0220s/iter; left time: 85.0288s
	iters: 800, epoch: 7 | loss: 0.4760074
	speed: 0.0223s/iter; left time: 84.0353s
	iters: 900, epoch: 7 | loss: 0.4634986
	speed: 0.0226s/iter; left time: 82.6246s
	iters: 1000, epoch: 7 | loss: 0.7326011
	speed: 0.0227s/iter; left time: 80.9864s
	iters: 1100, epoch: 7 | loss: 0.4601604
	speed: 0.0229s/iter; left time: 79.1702s
Epoch: 7 cost time: 26.27411961555481
Epoch: 7, Steps: 1140 | Train Loss: 0.5505748 Vali Loss: 0.5986508 Test Loss: 0.2820239
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4911142
	speed: 0.0382s/iter; left time: 126.9563s
	iters: 200, epoch: 8 | loss: 0.5588784
	speed: 0.0297s/iter; left time: 95.5636s
	iters: 300, epoch: 8 | loss: 0.4094699
	speed: 0.0264s/iter; left time: 82.3981s
	iters: 400, epoch: 8 | loss: 0.8317695
	speed: 0.0243s/iter; left time: 73.2605s
	iters: 500, epoch: 8 | loss: 0.7537619
	speed: 0.0229s/iter; left time: 66.8343s
	iters: 600, epoch: 8 | loss: 0.4952406
	speed: 0.0219s/iter; left time: 61.6496s
	iters: 700, epoch: 8 | loss: 0.7013705
	speed: 0.0215s/iter; left time: 58.5787s
	iters: 800, epoch: 8 | loss: 0.5076227
	speed: 0.0217s/iter; left time: 56.8835s
	iters: 900, epoch: 8 | loss: 0.5096890
	speed: 0.0220s/iter; left time: 55.5457s
	iters: 1000, epoch: 8 | loss: 0.4355174
	speed: 0.0224s/iter; left time: 54.1846s
	iters: 1100, epoch: 8 | loss: 0.7386973
	speed: 0.0226s/iter; left time: 52.5350s
Epoch: 8 cost time: 26.03238868713379
Epoch: 8, Steps: 1140 | Train Loss: 0.5493497 Vali Loss: 0.6033273 Test Loss: 0.2824296
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.28279927372932434, mae:0.2997373640537262
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.8512337
	speed: 0.0218s/iter; left time: 246.8329s
	iters: 200, epoch: 1 | loss: 0.9131550
	speed: 0.0204s/iter; left time: 228.6997s
	iters: 300, epoch: 1 | loss: 0.5576817
	speed: 0.0206s/iter; left time: 228.6895s
	iters: 400, epoch: 1 | loss: 0.8174877
	speed: 0.0205s/iter; left time: 225.1377s
	iters: 500, epoch: 1 | loss: 0.4685928
	speed: 0.0203s/iter; left time: 220.7645s
	iters: 600, epoch: 1 | loss: 0.5213837
	speed: 0.0198s/iter; left time: 213.6343s
	iters: 700, epoch: 1 | loss: 0.8510963
	speed: 0.0195s/iter; left time: 208.5591s
	iters: 800, epoch: 1 | loss: 0.5711222
	speed: 0.0196s/iter; left time: 207.9946s
	iters: 900, epoch: 1 | loss: 0.6228775
	speed: 0.0196s/iter; left time: 206.1599s
	iters: 1000, epoch: 1 | loss: 0.5596986
	speed: 0.0197s/iter; left time: 205.1828s
	iters: 1100, epoch: 1 | loss: 0.6115850
	speed: 0.0196s/iter; left time: 201.5470s
Epoch: 1 cost time: 22.577837228775024
Epoch: 1, Steps: 1140 | Train Loss: 0.6347214 Vali Loss: 0.6083254 Test Loss: 0.2866805
Validation loss decreased (inf --> 0.608325).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7968611
	speed: 0.0375s/iter; left time: 380.5708s
	iters: 200, epoch: 2 | loss: 1.3528627
	speed: 0.0323s/iter; left time: 325.0108s
	iters: 300, epoch: 2 | loss: 0.4815191
	speed: 0.0300s/iter; left time: 298.8325s
	iters: 400, epoch: 2 | loss: 1.0263164
	speed: 0.0281s/iter; left time: 277.3372s
	iters: 500, epoch: 2 | loss: 0.9000067
	speed: 0.0269s/iter; left time: 262.9998s
	iters: 600, epoch: 2 | loss: 0.5063772
	speed: 0.0264s/iter; left time: 255.3705s
	iters: 700, epoch: 2 | loss: 0.4918390
	speed: 0.0259s/iter; left time: 247.8259s
	iters: 800, epoch: 2 | loss: 0.7408576
	speed: 0.0253s/iter; left time: 239.3857s
	iters: 900, epoch: 2 | loss: 0.4586625
	speed: 0.0250s/iter; left time: 234.1896s
	iters: 1000, epoch: 2 | loss: 0.4565037
	speed: 0.0248s/iter; left time: 229.3517s
	iters: 1100, epoch: 2 | loss: 0.5373814
	speed: 0.0245s/iter; left time: 224.2873s
Epoch: 2 cost time: 27.99883246421814
Epoch: 2, Steps: 1140 | Train Loss: 0.5953215 Vali Loss: 0.5989015 Test Loss: 0.2826804
Validation loss decreased (0.608325 --> 0.598901).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4871027
	speed: 0.0316s/iter; left time: 285.1822s
	iters: 200, epoch: 3 | loss: 0.4893806
	speed: 0.0268s/iter; left time: 239.0121s
	iters: 300, epoch: 3 | loss: 0.4842789
	speed: 0.0252s/iter; left time: 221.8906s
	iters: 400, epoch: 3 | loss: 0.8544277
	speed: 0.0244s/iter; left time: 213.0947s
	iters: 500, epoch: 3 | loss: 0.4599531
	speed: 0.0237s/iter; left time: 204.2162s
	iters: 600, epoch: 3 | loss: 0.5584962
	speed: 0.0238s/iter; left time: 202.5966s
	iters: 700, epoch: 3 | loss: 0.3977000
	speed: 0.0231s/iter; left time: 194.5211s
	iters: 800, epoch: 3 | loss: 0.5319981
	speed: 0.0228s/iter; left time: 189.7443s
	iters: 900, epoch: 3 | loss: 0.7075119
	speed: 0.0228s/iter; left time: 187.3586s
	iters: 1000, epoch: 3 | loss: 0.7507449
	speed: 0.0228s/iter; left time: 184.9932s
	iters: 1100, epoch: 3 | loss: 0.6959503
	speed: 0.0227s/iter; left time: 182.2203s
Epoch: 3 cost time: 26.03840160369873
Epoch: 3, Steps: 1140 | Train Loss: 0.5774083 Vali Loss: 0.5898100 Test Loss: 0.2831673
Validation loss decreased (0.598901 --> 0.589810).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5901409
	speed: 0.0371s/iter; left time: 292.4664s
	iters: 200, epoch: 4 | loss: 0.9833122
	speed: 0.0370s/iter; left time: 288.2018s
	iters: 300, epoch: 4 | loss: 0.4657749
	speed: 0.0345s/iter; left time: 265.2603s
	iters: 400, epoch: 4 | loss: 0.4877683
	speed: 0.0308s/iter; left time: 233.1695s
	iters: 500, epoch: 4 | loss: 0.4364689
	speed: 0.0285s/iter; left time: 213.1945s
	iters: 600, epoch: 4 | loss: 0.4924262
	speed: 0.0268s/iter; left time: 197.9688s
	iters: 700, epoch: 4 | loss: 0.7467768
	speed: 0.0257s/iter; left time: 187.0509s
	iters: 800, epoch: 4 | loss: 0.4861944
	speed: 0.0248s/iter; left time: 178.3130s
	iters: 900, epoch: 4 | loss: 0.4888348
	speed: 0.0242s/iter; left time: 171.3960s
	iters: 1000, epoch: 4 | loss: 0.4283246
	speed: 0.0237s/iter; left time: 165.4825s
	iters: 1100, epoch: 4 | loss: 0.4732598
	speed: 0.0231s/iter; left time: 158.9246s
Epoch: 4 cost time: 26.211677074432373
Epoch: 4, Steps: 1140 | Train Loss: 0.5660815 Vali Loss: 0.5911224 Test Loss: 0.2822833
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3684019
	speed: 0.0446s/iter; left time: 300.5991s
	iters: 200, epoch: 5 | loss: 0.5572261
	speed: 0.0383s/iter; left time: 254.5169s
	iters: 300, epoch: 5 | loss: 0.6472042
	speed: 0.0324s/iter; left time: 211.9602s
	iters: 400, epoch: 5 | loss: 0.6852295
	speed: 0.0290s/iter; left time: 187.0557s
	iters: 500, epoch: 5 | loss: 0.9930934
	speed: 0.0272s/iter; left time: 172.7350s
	iters: 600, epoch: 5 | loss: 0.4994548
	speed: 0.0262s/iter; left time: 163.5128s
	iters: 700, epoch: 5 | loss: 0.6782789
	speed: 0.0261s/iter; left time: 160.0583s
	iters: 800, epoch: 5 | loss: 0.4993321
	speed: 0.0265s/iter; left time: 160.3746s
	iters: 900, epoch: 5 | loss: 0.5826077
	speed: 0.0263s/iter; left time: 156.3201s
	iters: 1000, epoch: 5 | loss: 0.4877585
	speed: 0.0269s/iter; left time: 157.1855s
	iters: 1100, epoch: 5 | loss: 0.4531853
	speed: 0.0276s/iter; left time: 158.1901s
Epoch: 5 cost time: 31.866339683532715
Epoch: 5, Steps: 1140 | Train Loss: 0.5597228 Vali Loss: 0.5888243 Test Loss: 0.2809996
Validation loss decreased (0.589810 --> 0.588824).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4334103
	speed: 0.0252s/iter; left time: 141.2846s
	iters: 200, epoch: 6 | loss: 0.4785304
	speed: 0.0258s/iter; left time: 142.1552s
	iters: 300, epoch: 6 | loss: 0.3876524
	speed: 0.0250s/iter; left time: 135.0525s
	iters: 400, epoch: 6 | loss: 0.5187230
	speed: 0.0244s/iter; left time: 129.6077s
	iters: 500, epoch: 6 | loss: 0.5109856
	speed: 0.0240s/iter; left time: 124.7603s
	iters: 600, epoch: 6 | loss: 0.8136543
	speed: 0.0236s/iter; left time: 120.5767s
	iters: 700, epoch: 6 | loss: 0.4648413
	speed: 0.0252s/iter; left time: 126.1526s
	iters: 800, epoch: 6 | loss: 0.4379409
	speed: 0.0248s/iter; left time: 121.4644s
	iters: 900, epoch: 6 | loss: 0.5737100
	speed: 0.0244s/iter; left time: 116.9883s
	iters: 1000, epoch: 6 | loss: 0.5330068
	speed: 0.0240s/iter; left time: 112.8495s
	iters: 1100, epoch: 6 | loss: 0.3858131
	speed: 0.0239s/iter; left time: 109.8157s
Epoch: 6 cost time: 27.36467480659485
Epoch: 6, Steps: 1140 | Train Loss: 0.5561191 Vali Loss: 0.5884307 Test Loss: 0.2806824
Validation loss decreased (0.588824 --> 0.588431).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4333893
	speed: 0.0363s/iter; left time: 161.8574s
	iters: 200, epoch: 7 | loss: 0.5227993
	speed: 0.0346s/iter; left time: 150.7237s
	iters: 300, epoch: 7 | loss: 0.4291225
	speed: 0.0330s/iter; left time: 140.5909s
	iters: 400, epoch: 7 | loss: 0.7095370
	speed: 0.0293s/iter; left time: 121.8275s
	iters: 500, epoch: 7 | loss: 0.4642799
	speed: 0.0264s/iter; left time: 107.2404s
	iters: 600, epoch: 7 | loss: 0.4787017
	speed: 0.0245s/iter; left time: 96.9458s
	iters: 700, epoch: 7 | loss: 0.5889606
	speed: 0.0244s/iter; left time: 94.2507s
	iters: 800, epoch: 7 | loss: 0.4847418
	speed: 0.0248s/iter; left time: 93.1837s
	iters: 900, epoch: 7 | loss: 0.7047325
	speed: 0.0247s/iter; left time: 90.3954s
	iters: 1000, epoch: 7 | loss: 0.4603000
	speed: 0.0245s/iter; left time: 87.1759s
	iters: 1100, epoch: 7 | loss: 0.5224818
	speed: 0.0243s/iter; left time: 84.1096s
Epoch: 7 cost time: 27.737498998641968
Epoch: 7, Steps: 1140 | Train Loss: 0.5551001 Vali Loss: 0.5887211 Test Loss: 0.2811119
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.5015575
	speed: 0.0274s/iter; left time: 90.9522s
	iters: 200, epoch: 8 | loss: 0.6482294
	speed: 0.0260s/iter; left time: 83.7108s
	iters: 300, epoch: 8 | loss: 0.4605898
	speed: 0.0274s/iter; left time: 85.3921s
	iters: 400, epoch: 8 | loss: 0.3762836
	speed: 0.0258s/iter; left time: 77.8821s
	iters: 500, epoch: 8 | loss: 0.7316216
	speed: 0.0260s/iter; left time: 76.0265s
	iters: 600, epoch: 8 | loss: 0.5245308
	speed: 0.0265s/iter; left time: 74.7048s
	iters: 700, epoch: 8 | loss: 0.4580692
	speed: 0.0261s/iter; left time: 71.0569s
	iters: 800, epoch: 8 | loss: 0.4499737
	speed: 0.0258s/iter; left time: 67.7056s
	iters: 900, epoch: 8 | loss: 0.4404490
	speed: 0.0256s/iter; left time: 64.5852s
	iters: 1000, epoch: 8 | loss: 0.8106868
	speed: 0.0255s/iter; left time: 61.6328s
	iters: 1100, epoch: 8 | loss: 0.3752705
	speed: 0.0253s/iter; left time: 58.6410s
Epoch: 8 cost time: 28.783032655715942
Epoch: 8, Steps: 1140 | Train Loss: 0.5533119 Vali Loss: 0.5894974 Test Loss: 0.2812093
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4230196
	speed: 0.0259s/iter; left time: 56.4268s
	iters: 200, epoch: 9 | loss: 0.4385379
	speed: 0.0239s/iter; left time: 49.7906s
	iters: 300, epoch: 9 | loss: 0.5250542
	speed: 0.0235s/iter; left time: 46.4706s
	iters: 400, epoch: 9 | loss: 0.8326036
	speed: 0.0235s/iter; left time: 44.2636s
	iters: 500, epoch: 9 | loss: 0.4952244
	speed: 0.0233s/iter; left time: 41.5827s
	iters: 600, epoch: 9 | loss: 0.4759038
	speed: 0.0231s/iter; left time: 38.8706s
	iters: 700, epoch: 9 | loss: 0.4247524
	speed: 0.0229s/iter; left time: 36.2150s
	iters: 800, epoch: 9 | loss: 0.5403976
	speed: 0.0227s/iter; left time: 33.6899s
	iters: 900, epoch: 9 | loss: 0.5089340
	speed: 0.0226s/iter; left time: 31.2407s
	iters: 1000, epoch: 9 | loss: 0.6662981
	speed: 0.0227s/iter; left time: 29.0749s
	iters: 1100, epoch: 9 | loss: 0.4749338
	speed: 0.0228s/iter; left time: 26.9771s
Epoch: 9 cost time: 26.22823429107666
Epoch: 9, Steps: 1140 | Train Loss: 0.5531316 Vali Loss: 0.5921341 Test Loss: 0.2812881
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.4109346
	speed: 0.0355s/iter; left time: 36.9468s
	iters: 200, epoch: 10 | loss: 0.5418807
	speed: 0.0306s/iter; left time: 28.8411s
	iters: 300, epoch: 10 | loss: 0.4476587
	speed: 0.0291s/iter; left time: 24.5000s
	iters: 400, epoch: 10 | loss: 0.4753701
	speed: 0.0275s/iter; left time: 20.4004s
	iters: 500, epoch: 10 | loss: 0.5182186
	speed: 0.0269s/iter; left time: 17.2203s
	iters: 600, epoch: 10 | loss: 0.5301966
	speed: 0.0262s/iter; left time: 14.1524s
	iters: 700, epoch: 10 | loss: 0.3924131
	speed: 0.0247s/iter; left time: 10.9134s
	iters: 800, epoch: 10 | loss: 0.7579954
	speed: 0.0236s/iter; left time: 8.0633s
	iters: 900, epoch: 10 | loss: 0.5623046
	speed: 0.0229s/iter; left time: 5.5295s
	iters: 1000, epoch: 10 | loss: 0.5639851
	speed: 0.0228s/iter; left time: 3.2203s
	iters: 1100, epoch: 10 | loss: 0.4461586
	speed: 0.0228s/iter; left time: 0.9357s
Epoch: 10 cost time: 26.144598722457886
Epoch: 10, Steps: 1140 | Train Loss: 0.5527731 Vali Loss: 0.5903537 Test Loss: 0.2810947
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.2806825041770935, mae:0.299197256565094
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.6176807
	speed: 0.0303s/iter; left time: 342.3751s
	iters: 200, epoch: 1 | loss: 0.8105606
	speed: 0.0264s/iter; left time: 295.8931s
	iters: 300, epoch: 1 | loss: 0.8626423
	speed: 0.0248s/iter; left time: 275.8547s
	iters: 400, epoch: 1 | loss: 0.5791740
	speed: 0.0250s/iter; left time: 274.7534s
	iters: 500, epoch: 1 | loss: 0.5286090
	speed: 0.0243s/iter; left time: 264.9861s
	iters: 600, epoch: 1 | loss: 0.5480945
	speed: 0.0242s/iter; left time: 261.5106s
	iters: 700, epoch: 1 | loss: 0.5314527
	speed: 0.0239s/iter; left time: 255.3192s
	iters: 800, epoch: 1 | loss: 0.5829919
	speed: 0.0238s/iter; left time: 251.7791s
	iters: 900, epoch: 1 | loss: 0.4443681
	speed: 0.0237s/iter; left time: 248.8915s
	iters: 1000, epoch: 1 | loss: 0.6035316
	speed: 0.0236s/iter; left time: 245.7353s
	iters: 1100, epoch: 1 | loss: 1.0702600
	speed: 0.0237s/iter; left time: 243.7749s
Epoch: 1 cost time: 27.100185871124268
Epoch: 1, Steps: 1140 | Train Loss: 0.6341736 Vali Loss: 0.6230453 Test Loss: 0.2898813
Validation loss decreased (inf --> 0.623045).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5214393
	speed: 0.0360s/iter; left time: 366.1995s
	iters: 200, epoch: 2 | loss: 0.8476832
	speed: 0.0292s/iter; left time: 293.7714s
	iters: 300, epoch: 2 | loss: 0.6321777
	speed: 0.0269s/iter; left time: 268.0838s
	iters: 400, epoch: 2 | loss: 0.5314417
	speed: 0.0259s/iter; left time: 255.3570s
	iters: 500, epoch: 2 | loss: 0.4557702
	speed: 0.0252s/iter; left time: 245.9827s
	iters: 600, epoch: 2 | loss: 0.6169242
	speed: 0.0248s/iter; left time: 239.3854s
	iters: 700, epoch: 2 | loss: 0.7629979
	speed: 0.0245s/iter; left time: 234.6238s
	iters: 800, epoch: 2 | loss: 0.5910938
	speed: 0.0244s/iter; left time: 230.6559s
	iters: 900, epoch: 2 | loss: 0.5736516
	speed: 0.0242s/iter; left time: 226.4139s
	iters: 1000, epoch: 2 | loss: 0.5168127
	speed: 0.0240s/iter; left time: 222.6019s
	iters: 1100, epoch: 2 | loss: 0.7315888
	speed: 0.0239s/iter; left time: 219.0301s
Epoch: 2 cost time: 27.252958059310913
Epoch: 2, Steps: 1140 | Train Loss: 0.5959530 Vali Loss: 0.6075500 Test Loss: 0.2846348
Validation loss decreased (0.623045 --> 0.607550).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6909898
	speed: 0.0283s/iter; left time: 255.6900s
	iters: 200, epoch: 3 | loss: 0.5091107
	speed: 0.0250s/iter; left time: 223.3620s
	iters: 300, epoch: 3 | loss: 0.7300345
	speed: 0.0228s/iter; left time: 200.9663s
	iters: 400, epoch: 3 | loss: 0.4983535
	speed: 0.0212s/iter; left time: 185.1211s
	iters: 500, epoch: 3 | loss: 0.4740529
	speed: 0.0204s/iter; left time: 175.4642s
	iters: 600, epoch: 3 | loss: 0.5496186
	speed: 0.0193s/iter; left time: 164.3189s
	iters: 700, epoch: 3 | loss: 0.6983830
	speed: 0.0190s/iter; left time: 160.0884s
	iters: 800, epoch: 3 | loss: 0.5771912
	speed: 0.0180s/iter; left time: 149.7921s
	iters: 900, epoch: 3 | loss: 0.5521144
	speed: 0.0177s/iter; left time: 145.7600s
	iters: 1000, epoch: 3 | loss: 0.5066078
	speed: 0.0180s/iter; left time: 145.9373s
	iters: 1100, epoch: 3 | loss: 0.5011655
	speed: 0.0182s/iter; left time: 145.5936s
Epoch: 3 cost time: 21.15095281600952
Epoch: 3, Steps: 1140 | Train Loss: 0.5750837 Vali Loss: 0.6030924 Test Loss: 0.2837246
Validation loss decreased (0.607550 --> 0.603092).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4686992
	speed: 0.0467s/iter; left time: 367.8073s
	iters: 200, epoch: 4 | loss: 0.5049136
	speed: 0.0447s/iter; left time: 347.5047s
	iters: 300, epoch: 4 | loss: 0.5015503
	speed: 0.0427s/iter; left time: 328.2945s
	iters: 400, epoch: 4 | loss: 0.5495880
	speed: 0.0400s/iter; left time: 303.2278s
	iters: 500, epoch: 4 | loss: 0.5321042
	speed: 0.0378s/iter; left time: 282.8558s
	iters: 600, epoch: 4 | loss: 0.4924527
	speed: 0.0346s/iter; left time: 255.5095s
	iters: 700, epoch: 4 | loss: 0.4446643
	speed: 0.0328s/iter; left time: 238.8583s
	iters: 800, epoch: 4 | loss: 0.7833233
	speed: 0.0313s/iter; left time: 224.6175s
	iters: 900, epoch: 4 | loss: 1.1326507
	speed: 0.0301s/iter; left time: 213.1531s
	iters: 1000, epoch: 4 | loss: 0.4288687
	speed: 0.0290s/iter; left time: 202.5868s
	iters: 1100, epoch: 4 | loss: 0.5046036
	speed: 0.0283s/iter; left time: 194.9219s
Epoch: 4 cost time: 32.14461970329285
Epoch: 4, Steps: 1140 | Train Loss: 0.5636288 Vali Loss: 0.5976633 Test Loss: 0.2803681
Validation loss decreased (0.603092 --> 0.597663).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5437895
	speed: 0.0398s/iter; left time: 268.4163s
	iters: 200, epoch: 5 | loss: 0.6566665
	speed: 0.0385s/iter; left time: 255.8519s
	iters: 300, epoch: 5 | loss: 0.5031168
	speed: 0.0351s/iter; left time: 229.8006s
	iters: 400, epoch: 5 | loss: 0.4413646
	speed: 0.0320s/iter; left time: 206.1391s
	iters: 500, epoch: 5 | loss: 0.4577158
	speed: 0.0301s/iter; left time: 190.6098s
	iters: 600, epoch: 5 | loss: 0.4272267
	speed: 0.0287s/iter; left time: 179.2198s
	iters: 700, epoch: 5 | loss: 0.5166261
	speed: 0.0278s/iter; left time: 170.4927s
	iters: 800, epoch: 5 | loss: 0.4952438
	speed: 0.0268s/iter; left time: 161.6964s
	iters: 900, epoch: 5 | loss: 0.4536246
	speed: 0.0261s/iter; left time: 155.2450s
	iters: 1000, epoch: 5 | loss: 0.5012546
	speed: 0.0265s/iter; left time: 154.5838s
	iters: 1100, epoch: 5 | loss: 0.5689310
	speed: 0.0266s/iter; left time: 152.5137s
Epoch: 5 cost time: 30.506048440933228
Epoch: 5, Steps: 1140 | Train Loss: 0.5568539 Vali Loss: 0.6019814 Test Loss: 0.2811972
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4638352
	speed: 0.0280s/iter; left time: 156.6681s
	iters: 200, epoch: 6 | loss: 0.4626363
	speed: 0.0268s/iter; left time: 147.6251s
	iters: 300, epoch: 6 | loss: 0.6068193
	speed: 0.0231s/iter; left time: 124.8207s
	iters: 400, epoch: 6 | loss: 0.8137498
	speed: 0.0215s/iter; left time: 113.8512s
	iters: 500, epoch: 6 | loss: 0.4547815
	speed: 0.0204s/iter; left time: 106.1129s
	iters: 600, epoch: 6 | loss: 0.4829912
	speed: 0.0200s/iter; left time: 101.8773s
	iters: 700, epoch: 6 | loss: 0.6540676
	speed: 0.0195s/iter; left time: 97.4212s
	iters: 800, epoch: 6 | loss: 0.4571217
	speed: 0.0196s/iter; left time: 95.9256s
	iters: 900, epoch: 6 | loss: 0.4762954
	speed: 0.0196s/iter; left time: 94.0397s
	iters: 1000, epoch: 6 | loss: 0.7528567
	speed: 0.0197s/iter; left time: 92.5214s
	iters: 1100, epoch: 6 | loss: 0.5697796
	speed: 0.0199s/iter; left time: 91.5924s
Epoch: 6 cost time: 23.329185009002686
Epoch: 6, Steps: 1140 | Train Loss: 0.5531876 Vali Loss: 0.5992171 Test Loss: 0.2815173
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4606660
	speed: 0.0445s/iter; left time: 198.3021s
	iters: 200, epoch: 7 | loss: 0.4385128
	speed: 0.0387s/iter; left time: 168.8177s
	iters: 300, epoch: 7 | loss: 0.7577551
	speed: 0.0372s/iter; left time: 158.6690s
	iters: 400, epoch: 7 | loss: 0.7023965
	speed: 0.0350s/iter; left time: 145.6822s
	iters: 500, epoch: 7 | loss: 0.5430677
	speed: 0.0321s/iter; left time: 130.5356s
	iters: 600, epoch: 7 | loss: 0.4917651
	speed: 0.0300s/iter; left time: 118.9666s
	iters: 700, epoch: 7 | loss: 0.4463438
	speed: 0.0285s/iter; left time: 110.0576s
	iters: 800, epoch: 7 | loss: 0.4840537
	speed: 0.0274s/iter; left time: 103.0627s
	iters: 900, epoch: 7 | loss: 0.4325480
	speed: 0.0283s/iter; left time: 103.6735s
	iters: 1000, epoch: 7 | loss: 0.5252425
	speed: 0.0292s/iter; left time: 104.1326s
	iters: 1100, epoch: 7 | loss: 0.7364560
	speed: 0.0292s/iter; left time: 100.9997s
Epoch: 7 cost time: 33.23021459579468
Epoch: 7, Steps: 1140 | Train Loss: 0.5512715 Vali Loss: 0.5986454 Test Loss: 0.2807775
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.5054055
	speed: 0.0396s/iter; left time: 131.4936s
	iters: 200, epoch: 8 | loss: 0.4453809
	speed: 0.0309s/iter; left time: 99.6365s
	iters: 300, epoch: 8 | loss: 0.5198426
	speed: 0.0280s/iter; left time: 87.4992s
	iters: 400, epoch: 8 | loss: 0.5454831
	speed: 0.0260s/iter; left time: 78.4755s
	iters: 500, epoch: 8 | loss: 0.6201655
	speed: 0.0246s/iter; left time: 71.9112s
	iters: 600, epoch: 8 | loss: 0.5653603
	speed: 0.0238s/iter; left time: 67.0560s
	iters: 700, epoch: 8 | loss: 0.4948428
	speed: 0.0240s/iter; left time: 65.2634s
	iters: 800, epoch: 8 | loss: 0.3954460
	speed: 0.0236s/iter; left time: 61.9634s
	iters: 900, epoch: 8 | loss: 0.4517612
	speed: 0.0235s/iter; left time: 59.2510s
	iters: 1000, epoch: 8 | loss: 0.5476799
	speed: 0.0234s/iter; left time: 56.6022s
	iters: 1100, epoch: 8 | loss: 0.4185877
	speed: 0.0242s/iter; left time: 56.1023s
Epoch: 8 cost time: 28.20365047454834
Epoch: 8, Steps: 1140 | Train Loss: 0.5505642 Vali Loss: 0.6001989 Test Loss: 0.2813363
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.5039938
	speed: 0.0244s/iter; left time: 53.1673s
	iters: 200, epoch: 9 | loss: 0.4901868
	speed: 0.0202s/iter; left time: 42.0455s
	iters: 300, epoch: 9 | loss: 0.4628508
	speed: 0.0182s/iter; left time: 35.9696s
	iters: 400, epoch: 9 | loss: 0.4142989
	speed: 0.0172s/iter; left time: 32.3714s
	iters: 500, epoch: 9 | loss: 0.4244062
	speed: 0.0166s/iter; left time: 29.5619s
	iters: 600, epoch: 9 | loss: 0.3501541
	speed: 0.0165s/iter; left time: 27.7181s
	iters: 700, epoch: 9 | loss: 0.5423985
	speed: 0.0174s/iter; left time: 27.4701s
	iters: 800, epoch: 9 | loss: 0.4766071
	speed: 0.0179s/iter; left time: 26.5579s
	iters: 900, epoch: 9 | loss: 0.4518363
	speed: 0.0185s/iter; left time: 25.5268s
	iters: 1000, epoch: 9 | loss: 0.4596845
	speed: 0.0190s/iter; left time: 24.3567s
	iters: 1100, epoch: 9 | loss: 0.5708805
	speed: 0.0195s/iter; left time: 22.9832s
Epoch: 9 cost time: 22.498148441314697
Epoch: 9, Steps: 1140 | Train Loss: 0.5506584 Vali Loss: 0.6007766 Test Loss: 0.2814646
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.2803680896759033, mae:0.29900482296943665
Seed: 123
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_720      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.6783344
	speed: 0.0376s/iter; left time: 420.8441s
	iters: 200, epoch: 1 | loss: 0.5831972
	speed: 0.0308s/iter; left time: 340.9126s
	iters: 300, epoch: 1 | loss: 0.6761231
	speed: 0.0285s/iter; left time: 313.1726s
	iters: 400, epoch: 1 | loss: 0.6636981
	speed: 0.0274s/iter; left time: 298.3931s
	iters: 500, epoch: 1 | loss: 0.6228884
	speed: 0.0268s/iter; left time: 288.4218s
	iters: 600, epoch: 1 | loss: 0.6866677
	speed: 0.0263s/iter; left time: 280.6482s
	iters: 700, epoch: 1 | loss: 0.6856225
	speed: 0.0260s/iter; left time: 274.7903s
	iters: 800, epoch: 1 | loss: 0.6411269
	speed: 0.0256s/iter; left time: 268.4930s
	iters: 900, epoch: 1 | loss: 0.6357355
	speed: 0.0252s/iter; left time: 262.0893s
	iters: 1000, epoch: 1 | loss: 0.7132805
	speed: 0.0249s/iter; left time: 255.8087s
	iters: 1100, epoch: 1 | loss: 0.6478592
	speed: 0.0246s/iter; left time: 250.3963s
Epoch: 1 cost time: 27.755435466766357
Epoch: 1, Steps: 1128 | Train Loss: 0.7203087 Vali Loss: 0.7445967 Test Loss: 0.3624751
Validation loss decreased (inf --> 0.744597).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7164922
	speed: 0.0243s/iter; left time: 244.2555s
	iters: 200, epoch: 2 | loss: 0.7382239
	speed: 0.0228s/iter; left time: 226.5542s
	iters: 300, epoch: 2 | loss: 1.0563440
	speed: 0.0222s/iter; left time: 219.1046s
	iters: 400, epoch: 2 | loss: 0.6374344
	speed: 0.0243s/iter; left time: 236.5336s
	iters: 500, epoch: 2 | loss: 0.5510262
	speed: 0.0262s/iter; left time: 253.1719s
	iters: 600, epoch: 2 | loss: 0.5018724
	speed: 0.0282s/iter; left time: 269.4061s
	iters: 700, epoch: 2 | loss: 0.5884214
	speed: 0.0279s/iter; left time: 263.5152s
	iters: 800, epoch: 2 | loss: 0.9680361
	speed: 0.0270s/iter; left time: 252.9889s
	iters: 900, epoch: 2 | loss: 0.6943722
	speed: 0.0260s/iter; left time: 240.7246s
	iters: 1000, epoch: 2 | loss: 0.5044854
	speed: 0.0251s/iter; left time: 229.5589s
	iters: 1100, epoch: 2 | loss: 0.7366713
	speed: 0.0246s/iter; left time: 222.7058s
Epoch: 2 cost time: 27.80546808242798
Epoch: 2, Steps: 1128 | Train Loss: 0.6811525 Vali Loss: 0.7232835 Test Loss: 0.3571658
Validation loss decreased (0.744597 --> 0.723283).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7280046
	speed: 0.0186s/iter; left time: 165.5731s
	iters: 200, epoch: 3 | loss: 0.5002425
	speed: 0.0184s/iter; left time: 162.6743s
	iters: 300, epoch: 3 | loss: 0.6592720
	speed: 0.0182s/iter; left time: 158.4748s
	iters: 400, epoch: 3 | loss: 0.5295627
	speed: 0.0181s/iter; left time: 156.1932s
	iters: 500, epoch: 3 | loss: 0.5814363
	speed: 0.0191s/iter; left time: 163.1780s
	iters: 600, epoch: 3 | loss: 0.7095852
	speed: 0.0195s/iter; left time: 164.6501s
	iters: 700, epoch: 3 | loss: 0.7240158
	speed: 0.0199s/iter; left time: 165.9348s
	iters: 800, epoch: 3 | loss: 0.7149727
	speed: 0.0201s/iter; left time: 164.9239s
	iters: 900, epoch: 3 | loss: 0.6379203
	speed: 0.0207s/iter; left time: 167.8932s
	iters: 1000, epoch: 3 | loss: 0.6008811
	speed: 0.0211s/iter; left time: 169.1814s
	iters: 1100, epoch: 3 | loss: 0.6482030
	speed: 0.0214s/iter; left time: 169.7938s
Epoch: 3 cost time: 24.39743208885193
Epoch: 3, Steps: 1128 | Train Loss: 0.6609540 Vali Loss: 0.7209954 Test Loss: 0.3568276
Validation loss decreased (0.723283 --> 0.720995).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8908421
	speed: 0.0314s/iter; left time: 244.6657s
	iters: 200, epoch: 4 | loss: 0.6413998
	speed: 0.0313s/iter; left time: 240.6922s
	iters: 300, epoch: 4 | loss: 0.6848797
	speed: 0.0271s/iter; left time: 205.7599s
	iters: 400, epoch: 4 | loss: 0.6571097
	speed: 0.0253s/iter; left time: 189.4215s
	iters: 500, epoch: 4 | loss: 0.5679925
	speed: 0.0248s/iter; left time: 183.4524s
	iters: 600, epoch: 4 | loss: 0.6852962
	speed: 0.0243s/iter; left time: 177.1437s
	iters: 700, epoch: 4 | loss: 0.5097212
	speed: 0.0243s/iter; left time: 175.0800s
	iters: 800, epoch: 4 | loss: 0.7597329
	speed: 0.0242s/iter; left time: 171.5448s
	iters: 900, epoch: 4 | loss: 0.6263783
	speed: 0.0240s/iter; left time: 168.2128s
	iters: 1000, epoch: 4 | loss: 0.6649437
	speed: 0.0239s/iter; left time: 164.9476s
	iters: 1100, epoch: 4 | loss: 0.5687200
	speed: 0.0245s/iter; left time: 166.8290s
Epoch: 4 cost time: 27.850669384002686
Epoch: 4, Steps: 1128 | Train Loss: 0.6499342 Vali Loss: 0.7232226 Test Loss: 0.3582413
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5328242
	speed: 0.0241s/iter; left time: 160.5215s
	iters: 200, epoch: 5 | loss: 0.7017804
	speed: 0.0214s/iter; left time: 140.8683s
	iters: 300, epoch: 5 | loss: 0.6039561
	speed: 0.0203s/iter; left time: 131.4134s
	iters: 400, epoch: 5 | loss: 0.6574190
	speed: 0.0206s/iter; left time: 130.9827s
	iters: 500, epoch: 5 | loss: 0.8526430
	speed: 0.0206s/iter; left time: 129.0373s
	iters: 600, epoch: 5 | loss: 0.7865411
	speed: 0.0203s/iter; left time: 125.1676s
	iters: 700, epoch: 5 | loss: 0.6840333
	speed: 0.0201s/iter; left time: 122.0164s
	iters: 800, epoch: 5 | loss: 0.6543278
	speed: 0.0200s/iter; left time: 119.2112s
	iters: 900, epoch: 5 | loss: 0.6679015
	speed: 0.0207s/iter; left time: 121.6764s
	iters: 1000, epoch: 5 | loss: 0.6616622
	speed: 0.0217s/iter; left time: 125.1554s
	iters: 1100, epoch: 5 | loss: 0.5438448
	speed: 0.0221s/iter; left time: 125.1352s
Epoch: 5 cost time: 25.076072692871094
Epoch: 5, Steps: 1128 | Train Loss: 0.6436712 Vali Loss: 0.7275227 Test Loss: 0.3590022
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.7075925
	speed: 0.0376s/iter; left time: 208.3511s
	iters: 200, epoch: 6 | loss: 0.6559041
	speed: 0.0284s/iter; left time: 154.6896s
	iters: 300, epoch: 6 | loss: 0.6481887
	speed: 0.0264s/iter; left time: 140.9420s
	iters: 400, epoch: 6 | loss: 0.5972026
	speed: 0.0245s/iter; left time: 128.4797s
	iters: 500, epoch: 6 | loss: 0.5613114
	speed: 0.0238s/iter; left time: 122.2849s
	iters: 600, epoch: 6 | loss: 0.8682163
	speed: 0.0235s/iter; left time: 118.3046s
	iters: 700, epoch: 6 | loss: 0.8404056
	speed: 0.0234s/iter; left time: 115.7745s
	iters: 800, epoch: 6 | loss: 0.5521257
	speed: 0.0233s/iter; left time: 113.0069s
	iters: 900, epoch: 6 | loss: 0.6333580
	speed: 0.0233s/iter; left time: 110.5743s
	iters: 1000, epoch: 6 | loss: 0.4851471
	speed: 0.0234s/iter; left time: 108.8004s
	iters: 1100, epoch: 6 | loss: 0.6486451
	speed: 0.0236s/iter; left time: 106.9904s
Epoch: 6 cost time: 26.74127221107483
Epoch: 6, Steps: 1128 | Train Loss: 0.6410639 Vali Loss: 0.7341875 Test Loss: 0.3591782
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4516825
	speed: 0.0408s/iter; left time: 179.9288s
	iters: 200, epoch: 7 | loss: 0.5524197
	speed: 0.0332s/iter; left time: 143.2938s
	iters: 300, epoch: 7 | loss: 0.7235444
	speed: 0.0316s/iter; left time: 133.0094s
	iters: 400, epoch: 7 | loss: 0.7221825
	speed: 0.0286s/iter; left time: 117.6829s
	iters: 500, epoch: 7 | loss: 0.5647370
	speed: 0.0269s/iter; left time: 107.9474s
	iters: 600, epoch: 7 | loss: 0.5965358
	speed: 0.0261s/iter; left time: 102.1813s
	iters: 700, epoch: 7 | loss: 0.4974825
	speed: 0.0257s/iter; left time: 97.8774s
	iters: 800, epoch: 7 | loss: 0.7216057
	speed: 0.0253s/iter; left time: 94.1155s
	iters: 900, epoch: 7 | loss: 0.5109269
	speed: 0.0251s/iter; left time: 90.5611s
	iters: 1000, epoch: 7 | loss: 0.5551345
	speed: 0.0248s/iter; left time: 87.2215s
	iters: 1100, epoch: 7 | loss: 0.6362098
	speed: 0.0247s/iter; left time: 84.3217s
Epoch: 7 cost time: 27.952698945999146
Epoch: 7, Steps: 1128 | Train Loss: 0.6388182 Vali Loss: 0.7351878 Test Loss: 0.3596346
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.6472083
	speed: 0.0371s/iter; left time: 121.9091s
	iters: 200, epoch: 8 | loss: 0.6342221
	speed: 0.0313s/iter; left time: 99.7515s
	iters: 300, epoch: 8 | loss: 0.6873438
	speed: 0.0267s/iter; left time: 82.4293s
	iters: 400, epoch: 8 | loss: 0.6060569
	speed: 0.0236s/iter; left time: 70.5896s
	iters: 500, epoch: 8 | loss: 0.7275515
	speed: 0.0224s/iter; left time: 64.6933s
	iters: 600, epoch: 8 | loss: 0.6115872
	speed: 0.0223s/iter; left time: 61.9819s
	iters: 700, epoch: 8 | loss: 0.5260620
	speed: 0.0223s/iter; left time: 59.7446s
	iters: 800, epoch: 8 | loss: 0.6810933
	speed: 0.0214s/iter; left time: 55.1989s
	iters: 900, epoch: 8 | loss: 0.8231483
	speed: 0.0210s/iter; left time: 52.2212s
	iters: 1000, epoch: 8 | loss: 0.5463679
	speed: 0.0207s/iter; left time: 49.2963s
	iters: 1100, epoch: 8 | loss: 0.5300635
	speed: 0.0206s/iter; left time: 47.1067s
Epoch: 8 cost time: 23.31304407119751
Epoch: 8, Steps: 1128 | Train Loss: 0.6380810 Vali Loss: 0.7363107 Test Loss: 0.3597519
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.3568274974822998, mae:0.3485024869441986
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.8808959
	speed: 0.0331s/iter; left time: 370.5288s
	iters: 200, epoch: 1 | loss: 0.6686777
	speed: 0.0330s/iter; left time: 365.7123s
	iters: 300, epoch: 1 | loss: 0.6333205
	speed: 0.0341s/iter; left time: 374.8394s
	iters: 400, epoch: 1 | loss: 0.5549753
	speed: 0.0329s/iter; left time: 357.6245s
	iters: 500, epoch: 1 | loss: 0.6742300
	speed: 0.0308s/iter; left time: 332.3531s
	iters: 600, epoch: 1 | loss: 0.6072267
	speed: 0.0295s/iter; left time: 314.9380s
	iters: 700, epoch: 1 | loss: 0.6964680
	speed: 0.0286s/iter; left time: 302.1348s
	iters: 800, epoch: 1 | loss: 0.5245066
	speed: 0.0278s/iter; left time: 291.5098s
	iters: 900, epoch: 1 | loss: 0.6989666
	speed: 0.0281s/iter; left time: 291.9965s
	iters: 1000, epoch: 1 | loss: 0.9054928
	speed: 0.0289s/iter; left time: 297.2528s
	iters: 1100, epoch: 1 | loss: 0.7841657
	speed: 0.0294s/iter; left time: 299.4874s
Epoch: 1 cost time: 33.29946756362915
Epoch: 1, Steps: 1128 | Train Loss: 0.7186864 Vali Loss: 0.7373385 Test Loss: 0.3627360
Validation loss decreased (inf --> 0.737339).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6285892
	speed: 0.0305s/iter; left time: 307.0491s
	iters: 200, epoch: 2 | loss: 0.8012067
	speed: 0.0281s/iter; left time: 279.4796s
	iters: 300, epoch: 2 | loss: 0.6944978
	speed: 0.0270s/iter; left time: 266.3534s
	iters: 400, epoch: 2 | loss: 0.5161309
	speed: 0.0264s/iter; left time: 257.9334s
	iters: 500, epoch: 2 | loss: 0.5746856
	speed: 0.0260s/iter; left time: 251.2748s
	iters: 600, epoch: 2 | loss: 0.9603750
	speed: 0.0274s/iter; left time: 261.6363s
	iters: 700, epoch: 2 | loss: 0.7689015
	speed: 0.0281s/iter; left time: 265.2877s
	iters: 800, epoch: 2 | loss: 0.8111416
	speed: 0.0286s/iter; left time: 267.8264s
	iters: 900, epoch: 2 | loss: 0.7544754
	speed: 0.0284s/iter; left time: 262.9812s
	iters: 1000, epoch: 2 | loss: 0.6149825
	speed: 0.0279s/iter; left time: 255.0438s
	iters: 1100, epoch: 2 | loss: 0.8401605
	speed: 0.0277s/iter; left time: 251.0991s
Epoch: 2 cost time: 31.58324408531189
Epoch: 2, Steps: 1128 | Train Loss: 0.6808915 Vali Loss: 0.7284818 Test Loss: 0.3592902
Validation loss decreased (0.737339 --> 0.728482).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5684432
	speed: 0.0323s/iter; left time: 288.6734s
	iters: 200, epoch: 3 | loss: 0.5775605
	speed: 0.0261s/iter; left time: 230.4820s
	iters: 300, epoch: 3 | loss: 0.5355589
	speed: 0.0240s/iter; left time: 209.7086s
	iters: 400, epoch: 3 | loss: 0.5635607
	speed: 0.0246s/iter; left time: 212.4837s
	iters: 500, epoch: 3 | loss: 0.6315868
	speed: 0.0231s/iter; left time: 197.2311s
	iters: 600, epoch: 3 | loss: 0.6359556
	speed: 0.0220s/iter; left time: 185.3728s
	iters: 700, epoch: 3 | loss: 0.5143981
	speed: 0.0212s/iter; left time: 176.8666s
	iters: 800, epoch: 3 | loss: 0.6948325
	speed: 0.0208s/iter; left time: 170.8628s
	iters: 900, epoch: 3 | loss: 0.8574871
	speed: 0.0218s/iter; left time: 176.9564s
	iters: 1000, epoch: 3 | loss: 0.5460473
	speed: 0.0233s/iter; left time: 186.9930s
	iters: 1100, epoch: 3 | loss: 0.6258676
	speed: 0.0240s/iter; left time: 190.4540s
Epoch: 3 cost time: 27.156641960144043
Epoch: 3, Steps: 1128 | Train Loss: 0.6636456 Vali Loss: 0.7232782 Test Loss: 0.3595993
Validation loss decreased (0.728482 --> 0.723278).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.7560195
	speed: 0.0257s/iter; left time: 200.2658s
	iters: 200, epoch: 4 | loss: 0.7634668
	speed: 0.0251s/iter; left time: 193.2887s
	iters: 300, epoch: 4 | loss: 0.8568931
	speed: 0.0246s/iter; left time: 187.1717s
	iters: 400, epoch: 4 | loss: 0.8245401
	speed: 0.0238s/iter; left time: 178.6943s
	iters: 500, epoch: 4 | loss: 0.5248761
	speed: 0.0254s/iter; left time: 188.1349s
	iters: 600, epoch: 4 | loss: 0.7168605
	speed: 0.0253s/iter; left time: 184.8419s
	iters: 700, epoch: 4 | loss: 0.7047254
	speed: 0.0252s/iter; left time: 181.3190s
	iters: 800, epoch: 4 | loss: 0.5610599
	speed: 0.0254s/iter; left time: 179.9655s
	iters: 900, epoch: 4 | loss: 0.7355191
	speed: 0.0269s/iter; left time: 188.0704s
	iters: 1000, epoch: 4 | loss: 0.6019449
	speed: 0.0280s/iter; left time: 193.0004s
	iters: 1100, epoch: 4 | loss: 0.5431781
	speed: 0.0286s/iter; left time: 194.2486s
Epoch: 4 cost time: 32.52195739746094
Epoch: 4, Steps: 1128 | Train Loss: 0.6528115 Vali Loss: 0.7239428 Test Loss: 0.3600825
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5800515
	speed: 0.0465s/iter; left time: 310.0476s
	iters: 200, epoch: 5 | loss: 0.6892915
	speed: 0.0347s/iter; left time: 228.0683s
	iters: 300, epoch: 5 | loss: 0.6502826
	speed: 0.0309s/iter; left time: 199.6353s
	iters: 400, epoch: 5 | loss: 0.5302411
	speed: 0.0289s/iter; left time: 184.0758s
	iters: 500, epoch: 5 | loss: 0.6656262
	speed: 0.0277s/iter; left time: 173.5577s
	iters: 600, epoch: 5 | loss: 0.6487549
	speed: 0.0270s/iter; left time: 166.3928s
	iters: 700, epoch: 5 | loss: 0.7175725
	speed: 0.0264s/iter; left time: 160.4229s
	iters: 800, epoch: 5 | loss: 0.4840369
	speed: 0.0260s/iter; left time: 154.9898s
	iters: 900, epoch: 5 | loss: 0.7861880
	speed: 0.0261s/iter; left time: 153.4150s
	iters: 1000, epoch: 5 | loss: 0.6575336
	speed: 0.0257s/iter; left time: 148.2089s
	iters: 1100, epoch: 5 | loss: 0.6168144
	speed: 0.0252s/iter; left time: 143.1385s
Epoch: 5 cost time: 28.49151349067688
Epoch: 5, Steps: 1128 | Train Loss: 0.6464098 Vali Loss: 0.7248281 Test Loss: 0.3611462
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5337095
	speed: 0.0228s/iter; left time: 126.4721s
	iters: 200, epoch: 6 | loss: 0.6775746
	speed: 0.0219s/iter; left time: 118.9519s
	iters: 300, epoch: 6 | loss: 0.5849192
	speed: 0.0213s/iter; left time: 113.8456s
	iters: 400, epoch: 6 | loss: 0.5416312
	speed: 0.0210s/iter; left time: 110.2317s
	iters: 500, epoch: 6 | loss: 0.6269355
	speed: 0.0206s/iter; left time: 106.0399s
	iters: 600, epoch: 6 | loss: 0.7035598
	speed: 0.0202s/iter; left time: 102.0155s
	iters: 700, epoch: 6 | loss: 0.6455426
	speed: 0.0204s/iter; left time: 100.6253s
	iters: 800, epoch: 6 | loss: 0.8634368
	speed: 0.0208s/iter; left time: 100.9106s
	iters: 900, epoch: 6 | loss: 0.5527787
	speed: 0.0212s/iter; left time: 100.3216s
	iters: 1000, epoch: 6 | loss: 0.5417952
	speed: 0.0214s/iter; left time: 99.1122s
	iters: 1100, epoch: 6 | loss: 0.5773364
	speed: 0.0215s/iter; left time: 97.6287s
Epoch: 6 cost time: 24.437909603118896
Epoch: 6, Steps: 1128 | Train Loss: 0.6429701 Vali Loss: 0.7243853 Test Loss: 0.3602605
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.6687859
	speed: 0.0222s/iter; left time: 97.8751s
	iters: 200, epoch: 7 | loss: 0.5274864
	speed: 0.0208s/iter; left time: 89.8805s
	iters: 300, epoch: 7 | loss: 0.5177249
	speed: 0.0211s/iter; left time: 88.9442s
	iters: 400, epoch: 7 | loss: 0.7666991
	speed: 0.0219s/iter; left time: 90.0462s
	iters: 500, epoch: 7 | loss: 0.6738125
	speed: 0.0224s/iter; left time: 89.7898s
	iters: 600, epoch: 7 | loss: 0.6356333
	speed: 0.0227s/iter; left time: 88.9704s
	iters: 700, epoch: 7 | loss: 0.5918905
	speed: 0.0235s/iter; left time: 89.7170s
	iters: 800, epoch: 7 | loss: 0.8462121
	speed: 0.0250s/iter; left time: 92.9036s
	iters: 900, epoch: 7 | loss: 0.5348185
	speed: 0.0263s/iter; left time: 94.9915s
	iters: 1000, epoch: 7 | loss: 0.5816866
	speed: 0.0265s/iter; left time: 93.0710s
	iters: 1100, epoch: 7 | loss: 0.5489292
	speed: 0.0262s/iter; left time: 89.2963s
Epoch: 7 cost time: 29.528470516204834
Epoch: 7, Steps: 1128 | Train Loss: 0.6407844 Vali Loss: 0.7278741 Test Loss: 0.3600459
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.6002296
	speed: 0.0340s/iter; left time: 111.8003s
	iters: 200, epoch: 8 | loss: 0.5851231
	speed: 0.0278s/iter; left time: 88.6536s
	iters: 300, epoch: 8 | loss: 0.5380872
	speed: 0.0258s/iter; left time: 79.5099s
	iters: 400, epoch: 8 | loss: 0.6895332
	speed: 0.0255s/iter; left time: 76.1063s
	iters: 500, epoch: 8 | loss: 0.5207436
	speed: 0.0274s/iter; left time: 78.9676s
	iters: 600, epoch: 8 | loss: 0.5974391
	speed: 0.0290s/iter; left time: 80.8717s
	iters: 700, epoch: 8 | loss: 0.5295135
	speed: 0.0298s/iter; left time: 80.0548s
	iters: 800, epoch: 8 | loss: 0.6581641
	speed: 0.0292s/iter; left time: 75.4559s
	iters: 900, epoch: 8 | loss: 0.7004349
	speed: 0.0287s/iter; left time: 71.3609s
	iters: 1000, epoch: 8 | loss: 0.6281141
	speed: 0.0283s/iter; left time: 67.5561s
	iters: 1100, epoch: 8 | loss: 0.5377499
	speed: 0.0279s/iter; left time: 63.8260s
Epoch: 8 cost time: 31.483892679214478
Epoch: 8, Steps: 1128 | Train Loss: 0.6401790 Vali Loss: 0.7271094 Test Loss: 0.3606072
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.35959938168525696, mae:0.3510683476924896
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.8917195
	speed: 0.0308s/iter; left time: 344.0008s
	iters: 200, epoch: 1 | loss: 1.0602218
	speed: 0.0277s/iter; left time: 306.6873s
	iters: 300, epoch: 1 | loss: 0.6226676
	speed: 0.0268s/iter; left time: 294.2606s
	iters: 400, epoch: 1 | loss: 0.6565447
	speed: 0.0263s/iter; left time: 286.2302s
	iters: 500, epoch: 1 | loss: 0.7514254
	speed: 0.0259s/iter; left time: 279.2352s
	iters: 600, epoch: 1 | loss: 0.5261140
	speed: 0.0257s/iter; left time: 274.7346s
	iters: 700, epoch: 1 | loss: 0.5997091
	speed: 0.0254s/iter; left time: 268.4201s
	iters: 800, epoch: 1 | loss: 0.7878516
	speed: 0.0260s/iter; left time: 272.6075s
	iters: 900, epoch: 1 | loss: 0.8089348
	speed: 0.0271s/iter; left time: 281.1967s
	iters: 1000, epoch: 1 | loss: 0.6535494
	speed: 0.0263s/iter; left time: 270.6168s
	iters: 1100, epoch: 1 | loss: 0.6586292
	speed: 0.0262s/iter; left time: 266.5852s
Epoch: 1 cost time: 29.754351377487183
Epoch: 1, Steps: 1128 | Train Loss: 0.7213516 Vali Loss: 0.7507191 Test Loss: 0.3651295
Validation loss decreased (inf --> 0.750719).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8490689
	speed: 0.0323s/iter; left time: 324.5361s
	iters: 200, epoch: 2 | loss: 0.5703161
	speed: 0.0285s/iter; left time: 283.9676s
	iters: 300, epoch: 2 | loss: 0.6079140
	speed: 0.0274s/iter; left time: 269.6079s
	iters: 400, epoch: 2 | loss: 0.5388532
	speed: 0.0267s/iter; left time: 260.8098s
	iters: 500, epoch: 2 | loss: 0.6832587
	speed: 0.0262s/iter; left time: 253.1898s
	iters: 600, epoch: 2 | loss: 0.5984204
	speed: 0.0259s/iter; left time: 247.6424s
	iters: 700, epoch: 2 | loss: 0.6710580
	speed: 0.0255s/iter; left time: 241.3762s
	iters: 800, epoch: 2 | loss: 0.7602510
	speed: 0.0254s/iter; left time: 237.9826s
	iters: 900, epoch: 2 | loss: 0.5831681
	speed: 0.0251s/iter; left time: 231.8426s
	iters: 1000, epoch: 2 | loss: 0.6545370
	speed: 0.0245s/iter; left time: 224.1914s
	iters: 1100, epoch: 2 | loss: 0.7089683
	speed: 0.0241s/iter; left time: 218.2237s
Epoch: 2 cost time: 27.255373001098633
Epoch: 2, Steps: 1128 | Train Loss: 0.6839460 Vali Loss: 0.7287367 Test Loss: 0.3605712
Validation loss decreased (0.750719 --> 0.728737).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5209053
	speed: 0.0389s/iter; left time: 346.9127s
	iters: 200, epoch: 3 | loss: 0.7394271
	speed: 0.0371s/iter; left time: 327.4658s
	iters: 300, epoch: 3 | loss: 0.9467963
	speed: 0.0365s/iter; left time: 318.5093s
	iters: 400, epoch: 3 | loss: 0.8710843
	speed: 0.0335s/iter; left time: 289.3334s
	iters: 500, epoch: 3 | loss: 0.6904600
	speed: 0.0316s/iter; left time: 269.6076s
	iters: 600, epoch: 3 | loss: 0.5418690
	speed: 0.0301s/iter; left time: 253.6194s
	iters: 700, epoch: 3 | loss: 0.5567826
	speed: 0.0293s/iter; left time: 243.5345s
	iters: 800, epoch: 3 | loss: 0.8821312
	speed: 0.0282s/iter; left time: 231.6987s
	iters: 900, epoch: 3 | loss: 0.6486813
	speed: 0.0272s/iter; left time: 220.8761s
	iters: 1000, epoch: 3 | loss: 0.8114508
	speed: 0.0265s/iter; left time: 212.9765s
	iters: 1100, epoch: 3 | loss: 0.5488455
	speed: 0.0259s/iter; left time: 205.2255s
Epoch: 3 cost time: 29.124521732330322
Epoch: 3, Steps: 1128 | Train Loss: 0.6663067 Vali Loss: 0.7190093 Test Loss: 0.3583800
Validation loss decreased (0.728737 --> 0.719009).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6987048
	speed: 0.0354s/iter; left time: 276.3894s
	iters: 200, epoch: 4 | loss: 0.5482878
	speed: 0.0350s/iter; left time: 269.0638s
	iters: 300, epoch: 4 | loss: 0.6787384
	speed: 0.0353s/iter; left time: 267.9217s
	iters: 400, epoch: 4 | loss: 0.5639376
	speed: 0.0359s/iter; left time: 268.9585s
	iters: 500, epoch: 4 | loss: 0.5881437
	speed: 0.0358s/iter; left time: 265.0297s
	iters: 600, epoch: 4 | loss: 0.6778809
	speed: 0.0335s/iter; left time: 244.4695s
	iters: 700, epoch: 4 | loss: 0.4715070
	speed: 0.0333s/iter; left time: 239.5123s
	iters: 800, epoch: 4 | loss: 0.7363033
	speed: 0.0335s/iter; left time: 237.4065s
	iters: 900, epoch: 4 | loss: 0.7185109
	speed: 0.0323s/iter; left time: 225.9809s
	iters: 1000, epoch: 4 | loss: 0.4813681
	speed: 0.0311s/iter; left time: 214.3072s
	iters: 1100, epoch: 4 | loss: 0.5939760
	speed: 0.0299s/iter; left time: 203.4693s
Epoch: 4 cost time: 33.625317335128784
Epoch: 4, Steps: 1128 | Train Loss: 0.6550949 Vali Loss: 0.7258908 Test Loss: 0.3581398
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5139629
	speed: 0.0459s/iter; left time: 306.0536s
	iters: 200, epoch: 5 | loss: 0.5724918
	speed: 0.0443s/iter; left time: 291.3291s
	iters: 300, epoch: 5 | loss: 0.6816542
	speed: 0.0435s/iter; left time: 281.7068s
	iters: 400, epoch: 5 | loss: 0.6414213
	speed: 0.0428s/iter; left time: 272.8710s
	iters: 500, epoch: 5 | loss: 0.6539536
	speed: 0.0415s/iter; left time: 260.4648s
	iters: 600, epoch: 5 | loss: 0.6530389
	speed: 0.0384s/iter; left time: 237.0790s
	iters: 700, epoch: 5 | loss: 0.7220404
	speed: 0.0364s/iter; left time: 220.6534s
	iters: 800, epoch: 5 | loss: 0.6333773
	speed: 0.0339s/iter; left time: 202.4369s
	iters: 900, epoch: 5 | loss: 0.6688827
	speed: 0.0323s/iter; left time: 189.4028s
	iters: 1000, epoch: 5 | loss: 0.7204197
	speed: 0.0309s/iter; left time: 178.2769s
	iters: 1100, epoch: 5 | loss: 0.7569164
	speed: 0.0299s/iter; left time: 169.6019s
Epoch: 5 cost time: 33.88956379890442
Epoch: 5, Steps: 1128 | Train Loss: 0.6494948 Vali Loss: 0.7307167 Test Loss: 0.3589087
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6972374
	speed: 0.0420s/iter; left time: 232.7441s
	iters: 200, epoch: 6 | loss: 0.5962565
	speed: 0.0401s/iter; left time: 218.0856s
	iters: 300, epoch: 6 | loss: 0.5590331
	speed: 0.0398s/iter; left time: 212.7914s
	iters: 400, epoch: 6 | loss: 0.6532401
	speed: 0.0353s/iter; left time: 184.9550s
	iters: 500, epoch: 6 | loss: 0.8550100
	speed: 0.0312s/iter; left time: 160.3167s
	iters: 600, epoch: 6 | loss: 0.5256132
	speed: 0.0283s/iter; left time: 142.4715s
	iters: 700, epoch: 6 | loss: 0.5259475
	speed: 0.0262s/iter; left time: 129.2479s
	iters: 800, epoch: 6 | loss: 0.6148294
	speed: 0.0244s/iter; left time: 118.2117s
	iters: 900, epoch: 6 | loss: 0.6712300
	speed: 0.0233s/iter; left time: 110.3940s
	iters: 1000, epoch: 6 | loss: 0.5055637
	speed: 0.0225s/iter; left time: 104.5922s
	iters: 1100, epoch: 6 | loss: 0.5075197
	speed: 0.0226s/iter; left time: 102.6472s
Epoch: 6 cost time: 25.68953585624695
Epoch: 6, Steps: 1128 | Train Loss: 0.6458844 Vali Loss: 0.7345983 Test Loss: 0.3588245
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8613158
	speed: 0.0428s/iter; left time: 188.8080s
	iters: 200, epoch: 7 | loss: 0.6437176
	speed: 0.0404s/iter; left time: 174.3309s
	iters: 300, epoch: 7 | loss: 0.4477724
	speed: 0.0355s/iter; left time: 149.7211s
	iters: 400, epoch: 7 | loss: 0.4835862
	speed: 0.0328s/iter; left time: 134.8877s
	iters: 500, epoch: 7 | loss: 0.5069366
	speed: 0.0308s/iter; left time: 123.6652s
	iters: 600, epoch: 7 | loss: 0.8275408
	speed: 0.0288s/iter; left time: 112.7098s
	iters: 700, epoch: 7 | loss: 0.6915165
	speed: 0.0271s/iter; left time: 103.4213s
	iters: 800, epoch: 7 | loss: 0.5851957
	speed: 0.0258s/iter; left time: 95.8263s
	iters: 900, epoch: 7 | loss: 0.9597816
	speed: 0.0248s/iter; left time: 89.7243s
	iters: 1000, epoch: 7 | loss: 0.7522484
	speed: 0.0247s/iter; left time: 86.8084s
	iters: 1100, epoch: 7 | loss: 0.6222308
	speed: 0.0246s/iter; left time: 84.1206s
Epoch: 7 cost time: 27.872474670410156
Epoch: 7, Steps: 1128 | Train Loss: 0.6444542 Vali Loss: 0.7308257 Test Loss: 0.3581641
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.6845641
	speed: 0.0258s/iter; left time: 84.6435s
	iters: 200, epoch: 8 | loss: 0.8085961
	speed: 0.0253s/iter; left time: 80.6216s
	iters: 300, epoch: 8 | loss: 0.5577727
	speed: 0.0256s/iter; left time: 78.8403s
	iters: 400, epoch: 8 | loss: 0.5675200
	speed: 0.0253s/iter; left time: 75.4794s
	iters: 500, epoch: 8 | loss: 0.6576877
	speed: 0.0259s/iter; left time: 74.6936s
	iters: 600, epoch: 8 | loss: 0.4597288
	speed: 0.0257s/iter; left time: 71.4361s
	iters: 700, epoch: 8 | loss: 0.9392720
	speed: 0.0254s/iter; left time: 68.3193s
	iters: 800, epoch: 8 | loss: 0.6550106
	speed: 0.0247s/iter; left time: 63.8213s
	iters: 900, epoch: 8 | loss: 0.6710945
	speed: 0.0241s/iter; left time: 59.8636s
	iters: 1000, epoch: 8 | loss: 0.5229537
	speed: 0.0236s/iter; left time: 56.3394s
	iters: 1100, epoch: 8 | loss: 0.5863346
	speed: 0.0235s/iter; left time: 53.7285s
Epoch: 8 cost time: 26.614995002746582
Epoch: 8, Steps: 1128 | Train Loss: 0.6432156 Vali Loss: 0.7290561 Test Loss: 0.3583370
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.358379989862442, mae:0.3499346077442169
Seed: 456
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_96       Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.4811600
	speed: 0.0310s/iter; left time: 352.3174s
	iters: 200, epoch: 1 | loss: 0.4894670
	speed: 0.0276s/iter; left time: 310.9639s
	iters: 300, epoch: 1 | loss: 0.8007603
	speed: 0.0242s/iter; left time: 270.5403s
	iters: 400, epoch: 1 | loss: 0.4257529
	speed: 0.0218s/iter; left time: 240.9757s
	iters: 500, epoch: 1 | loss: 0.2880030
	speed: 0.0209s/iter; left time: 228.7525s
	iters: 600, epoch: 1 | loss: 0.4271231
	speed: 0.0201s/iter; left time: 218.6569s
	iters: 700, epoch: 1 | loss: 0.4205559
	speed: 0.0193s/iter; left time: 207.7018s
	iters: 800, epoch: 1 | loss: 0.2886093
	speed: 0.0190s/iter; left time: 202.5552s
	iters: 900, epoch: 1 | loss: 0.4340307
	speed: 0.0187s/iter; left time: 197.4384s
	iters: 1000, epoch: 1 | loss: 0.2816961
	speed: 0.0185s/iter; left time: 193.2507s
	iters: 1100, epoch: 1 | loss: 1.2609308
	speed: 0.0183s/iter; left time: 189.3443s
Epoch: 1 cost time: 20.924609184265137
Epoch: 1, Steps: 1147 | Train Loss: 0.4984852 Vali Loss: 0.4439597 Test Loss: 0.1833436
Validation loss decreased (inf --> 0.443960).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3650378
	speed: 0.0311s/iter; left time: 318.2102s
	iters: 200, epoch: 2 | loss: 0.5497590
	speed: 0.0256s/iter; left time: 258.9713s
	iters: 300, epoch: 2 | loss: 0.4051541
	speed: 0.0234s/iter; left time: 234.2531s
	iters: 400, epoch: 2 | loss: 0.3252937
	speed: 0.0227s/iter; left time: 225.7238s
	iters: 500, epoch: 2 | loss: 0.3072826
	speed: 0.0226s/iter; left time: 221.5433s
	iters: 600, epoch: 2 | loss: 0.3232729
	speed: 0.0229s/iter; left time: 222.3327s
	iters: 700, epoch: 2 | loss: 0.3452528
	speed: 0.0231s/iter; left time: 222.3533s
	iters: 800, epoch: 2 | loss: 1.2587216
	speed: 0.0235s/iter; left time: 224.2807s
	iters: 900, epoch: 2 | loss: 0.3525398
	speed: 0.0249s/iter; left time: 234.2759s
	iters: 1000, epoch: 2 | loss: 0.2897933
	speed: 0.0257s/iter; left time: 239.1952s
	iters: 1100, epoch: 2 | loss: 0.3217231
	speed: 0.0266s/iter; left time: 245.3057s
Epoch: 2 cost time: 31.132161140441895
Epoch: 2, Steps: 1147 | Train Loss: 0.4514632 Vali Loss: 0.4311972 Test Loss: 0.1831087
Validation loss decreased (0.443960 --> 0.431197).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3788518
	speed: 0.0264s/iter; left time: 239.1925s
	iters: 200, epoch: 3 | loss: 0.2589176
	speed: 0.0236s/iter; left time: 211.7502s
	iters: 300, epoch: 3 | loss: 0.3991844
	speed: 0.0238s/iter; left time: 211.0257s
	iters: 400, epoch: 3 | loss: 0.3338005
	speed: 0.0252s/iter; left time: 221.1623s
	iters: 500, epoch: 3 | loss: 0.3336468
	speed: 0.0247s/iter; left time: 214.1804s
	iters: 600, epoch: 3 | loss: 0.5103374
	speed: 0.0235s/iter; left time: 201.7661s
	iters: 700, epoch: 3 | loss: 0.2805204
	speed: 0.0229s/iter; left time: 194.2215s
	iters: 800, epoch: 3 | loss: 1.1652186
	speed: 0.0224s/iter; left time: 187.4534s
	iters: 900, epoch: 3 | loss: 0.3661976
	speed: 0.0221s/iter; left time: 182.7912s
	iters: 1000, epoch: 3 | loss: 0.2686274
	speed: 0.0220s/iter; left time: 179.6362s
	iters: 1100, epoch: 3 | loss: 0.4352572
	speed: 0.0222s/iter; left time: 179.3153s
Epoch: 3 cost time: 25.74216890335083
Epoch: 3, Steps: 1147 | Train Loss: 0.4305496 Vali Loss: 0.4212236 Test Loss: 0.1755437
Validation loss decreased (0.431197 --> 0.421224).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 1.0679009
	speed: 0.0330s/iter; left time: 261.7110s
	iters: 200, epoch: 4 | loss: 0.5135568
	speed: 0.0299s/iter; left time: 233.7431s
	iters: 300, epoch: 4 | loss: 1.2310852
	speed: 0.0265s/iter; left time: 205.0743s
	iters: 400, epoch: 4 | loss: 0.4603311
	speed: 0.0246s/iter; left time: 187.4316s
	iters: 500, epoch: 4 | loss: 0.5168039
	speed: 0.0226s/iter; left time: 169.9858s
	iters: 600, epoch: 4 | loss: 1.2845778
	speed: 0.0222s/iter; left time: 165.2075s
	iters: 700, epoch: 4 | loss: 0.3327832
	speed: 0.0221s/iter; left time: 161.7926s
	iters: 800, epoch: 4 | loss: 0.2819376
	speed: 0.0214s/iter; left time: 154.8289s
	iters: 900, epoch: 4 | loss: 0.2839389
	speed: 0.0214s/iter; left time: 152.4229s
	iters: 1000, epoch: 4 | loss: 0.3346930
	speed: 0.0215s/iter; left time: 151.4133s
	iters: 1100, epoch: 4 | loss: 0.2911597
	speed: 0.0217s/iter; left time: 150.1935s
Epoch: 4 cost time: 24.91343903541565
Epoch: 4, Steps: 1147 | Train Loss: 0.4191818 Vali Loss: 0.4230403 Test Loss: 0.1745488
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4144861
	speed: 0.0350s/iter; left time: 237.1016s
	iters: 200, epoch: 5 | loss: 0.3402275
	speed: 0.0282s/iter; left time: 188.7057s
	iters: 300, epoch: 5 | loss: 0.3680262
	speed: 0.0253s/iter; left time: 166.8333s
	iters: 400, epoch: 5 | loss: 0.2565606
	speed: 0.0236s/iter; left time: 153.1136s
	iters: 500, epoch: 5 | loss: 0.3424802
	speed: 0.0231s/iter; left time: 147.7263s
	iters: 600, epoch: 5 | loss: 0.2897979
	speed: 0.0230s/iter; left time: 144.3191s
	iters: 700, epoch: 5 | loss: 0.2661035
	speed: 0.0237s/iter; left time: 146.2311s
	iters: 800, epoch: 5 | loss: 0.3616399
	speed: 0.0250s/iter; left time: 152.0750s
	iters: 900, epoch: 5 | loss: 0.3148980
	speed: 0.0254s/iter; left time: 151.8849s
	iters: 1000, epoch: 5 | loss: 0.3479804
	speed: 0.0253s/iter; left time: 149.1210s
	iters: 1100, epoch: 5 | loss: 0.2373771
	speed: 0.0263s/iter; left time: 152.1222s
Epoch: 5 cost time: 30.771215200424194
Epoch: 5, Steps: 1147 | Train Loss: 0.4124329 Vali Loss: 0.4190744 Test Loss: 0.1726814
Validation loss decreased (0.421224 --> 0.419074).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 1.2729641
	speed: 0.0260s/iter; left time: 146.5512s
	iters: 200, epoch: 6 | loss: 0.2606820
	speed: 0.0227s/iter; left time: 125.8819s
	iters: 300, epoch: 6 | loss: 0.2683437
	speed: 0.0237s/iter; left time: 128.6874s
	iters: 400, epoch: 6 | loss: 0.2892135
	speed: 0.0234s/iter; left time: 124.6354s
	iters: 500, epoch: 6 | loss: 0.4782698
	speed: 0.0234s/iter; left time: 122.3681s
	iters: 600, epoch: 6 | loss: 0.4477650
	speed: 0.0232s/iter; left time: 119.1330s
	iters: 700, epoch: 6 | loss: 0.3545451
	speed: 0.0231s/iter; left time: 116.1133s
	iters: 800, epoch: 6 | loss: 0.3379469
	speed: 0.0230s/iter; left time: 113.5981s
	iters: 900, epoch: 6 | loss: 0.3250125
	speed: 0.0230s/iter; left time: 111.0161s
	iters: 1000, epoch: 6 | loss: 0.2717089
	speed: 0.0229s/iter; left time: 108.5117s
	iters: 1100, epoch: 6 | loss: 0.3414074
	speed: 0.0235s/iter; left time: 109.0527s
Epoch: 6 cost time: 27.75968098640442
Epoch: 6, Steps: 1147 | Train Loss: 0.4093974 Vali Loss: 0.4238527 Test Loss: 0.1732674
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2976011
	speed: 0.0286s/iter; left time: 128.5358s
	iters: 200, epoch: 7 | loss: 0.3383646
	speed: 0.0253s/iter; left time: 110.9222s
	iters: 300, epoch: 7 | loss: 0.3980505
	speed: 0.0245s/iter; left time: 105.0734s
	iters: 400, epoch: 7 | loss: 0.2675908
	speed: 0.0238s/iter; left time: 99.5255s
	iters: 500, epoch: 7 | loss: 0.3847817
	speed: 0.0230s/iter; left time: 93.9842s
	iters: 600, epoch: 7 | loss: 0.3343870
	speed: 0.0223s/iter; left time: 88.8159s
	iters: 700, epoch: 7 | loss: 0.3066040
	speed: 0.0227s/iter; left time: 88.1994s
	iters: 800, epoch: 7 | loss: 0.5079176
	speed: 0.0226s/iter; left time: 85.6013s
	iters: 900, epoch: 7 | loss: 0.2884288
	speed: 0.0225s/iter; left time: 83.1002s
	iters: 1000, epoch: 7 | loss: 0.2950284
	speed: 0.0225s/iter; left time: 80.6732s
	iters: 1100, epoch: 7 | loss: 0.3258896
	speed: 0.0225s/iter; left time: 78.5352s
Epoch: 7 cost time: 25.98043727874756
Epoch: 7, Steps: 1147 | Train Loss: 0.4078748 Vali Loss: 0.4199895 Test Loss: 0.1727680
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4760542
	speed: 0.0242s/iter; left time: 80.7856s
	iters: 200, epoch: 8 | loss: 0.2814671
	speed: 0.0235s/iter; left time: 76.2618s
	iters: 300, epoch: 8 | loss: 0.2895141
	speed: 0.0232s/iter; left time: 72.9369s
	iters: 400, epoch: 8 | loss: 0.2646933
	speed: 0.0231s/iter; left time: 70.3584s
	iters: 500, epoch: 8 | loss: 0.3070095
	speed: 0.0233s/iter; left time: 68.5642s
	iters: 600, epoch: 8 | loss: 0.3053850
	speed: 0.0234s/iter; left time: 66.5735s
	iters: 700, epoch: 8 | loss: 0.4409530
	speed: 0.0235s/iter; left time: 64.5664s
	iters: 800, epoch: 8 | loss: 0.4070507
	speed: 0.0237s/iter; left time: 62.7472s
	iters: 900, epoch: 8 | loss: 0.3052504
	speed: 0.0238s/iter; left time: 60.5703s
	iters: 1000, epoch: 8 | loss: 0.2726463
	speed: 0.0238s/iter; left time: 58.2110s
	iters: 1100, epoch: 8 | loss: 0.2356450
	speed: 0.0238s/iter; left time: 55.6975s
Epoch: 8 cost time: 27.746052980422974
Epoch: 8, Steps: 1147 | Train Loss: 0.4068345 Vali Loss: 0.4204865 Test Loss: 0.1725763
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2779187
	speed: 0.0278s/iter; left time: 61.0010s
	iters: 200, epoch: 9 | loss: 0.2975922
	speed: 0.0234s/iter; left time: 49.1102s
	iters: 300, epoch: 9 | loss: 0.4581601
	speed: 0.0222s/iter; left time: 44.2185s
	iters: 400, epoch: 9 | loss: 0.3238466
	speed: 0.0217s/iter; left time: 41.1394s
	iters: 500, epoch: 9 | loss: 0.2807766
	speed: 0.0217s/iter; left time: 38.8622s
	iters: 600, epoch: 9 | loss: 0.2822357
	speed: 0.0219s/iter; left time: 37.1632s
	iters: 700, epoch: 9 | loss: 0.4469031
	speed: 0.0223s/iter; left time: 35.6239s
	iters: 800, epoch: 9 | loss: 0.3163584
	speed: 0.0226s/iter; left time: 33.8040s
	iters: 900, epoch: 9 | loss: 0.2751250
	speed: 0.0230s/iter; left time: 32.0816s
	iters: 1000, epoch: 9 | loss: 0.3001281
	speed: 0.0241s/iter; left time: 31.1703s
	iters: 1100, epoch: 9 | loss: 0.2089993
	speed: 0.0242s/iter; left time: 28.9452s
Epoch: 9 cost time: 27.922528982162476
Epoch: 9, Steps: 1147 | Train Loss: 0.4064708 Vali Loss: 0.4214177 Test Loss: 0.1727074
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3101763
	speed: 0.0235s/iter; left time: 24.6261s
	iters: 200, epoch: 10 | loss: 0.2805478
	speed: 0.0221s/iter; left time: 20.9681s
	iters: 300, epoch: 10 | loss: 1.0086141
	speed: 0.0213s/iter; left time: 18.0724s
	iters: 400, epoch: 10 | loss: 0.4114344
	speed: 0.0214s/iter; left time: 16.0081s
	iters: 500, epoch: 10 | loss: 0.4736481
	speed: 0.0209s/iter; left time: 13.5119s
	iters: 600, epoch: 10 | loss: 0.2851293
	speed: 0.0202s/iter; left time: 11.0683s
	iters: 700, epoch: 10 | loss: 1.2172011
	speed: 0.0197s/iter; left time: 8.8439s
	iters: 800, epoch: 10 | loss: 0.2480640
	speed: 0.0193s/iter; left time: 6.7124s
	iters: 900, epoch: 10 | loss: 0.2381794
	speed: 0.0191s/iter; left time: 4.7369s
	iters: 1000, epoch: 10 | loss: 0.3058533
	speed: 0.0197s/iter; left time: 2.9139s
	iters: 1100, epoch: 10 | loss: 0.2735223
	speed: 0.0202s/iter; left time: 0.9684s
Epoch: 10 cost time: 23.5210599899292
Epoch: 10, Steps: 1147 | Train Loss: 0.4062566 Vali Loss: 0.4220378 Test Loss: 0.1726584
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.1726813018321991, mae:0.21221774816513062
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.3759614
	speed: 0.0355s/iter; left time: 403.9991s
	iters: 200, epoch: 1 | loss: 0.3819431
	speed: 0.0294s/iter; left time: 330.9800s
	iters: 300, epoch: 1 | loss: 0.2912441
	speed: 0.0270s/iter; left time: 301.8718s
	iters: 400, epoch: 1 | loss: 0.3983379
	speed: 0.0259s/iter; left time: 286.7376s
	iters: 500, epoch: 1 | loss: 0.3619398
	speed: 0.0252s/iter; left time: 276.8191s
	iters: 600, epoch: 1 | loss: 0.5112378
	speed: 0.0247s/iter; left time: 268.9682s
	iters: 700, epoch: 1 | loss: 0.2412076
	speed: 0.0248s/iter; left time: 267.2100s
	iters: 800, epoch: 1 | loss: 0.3528637
	speed: 0.0249s/iter; left time: 265.5199s
	iters: 900, epoch: 1 | loss: 0.3775434
	speed: 0.0247s/iter; left time: 261.3234s
	iters: 1000, epoch: 1 | loss: 0.2686503
	speed: 0.0245s/iter; left time: 256.3708s
	iters: 1100, epoch: 1 | loss: 0.3404250
	speed: 0.0245s/iter; left time: 253.9847s
Epoch: 1 cost time: 28.677659511566162
Epoch: 1, Steps: 1147 | Train Loss: 0.4949214 Vali Loss: 0.4416014 Test Loss: 0.1825044
Validation loss decreased (inf --> 0.441601).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3436434
	speed: 0.0344s/iter; left time: 351.3996s
	iters: 200, epoch: 2 | loss: 0.2746144
	speed: 0.0292s/iter; left time: 296.0435s
	iters: 300, epoch: 2 | loss: 0.3478740
	speed: 0.0269s/iter; left time: 270.1465s
	iters: 400, epoch: 2 | loss: 0.4738835
	speed: 0.0259s/iter; left time: 256.7457s
	iters: 500, epoch: 2 | loss: 0.2854646
	speed: 0.0271s/iter; left time: 266.2215s
	iters: 600, epoch: 2 | loss: 0.4041751
	speed: 0.0266s/iter; left time: 258.4631s
	iters: 700, epoch: 2 | loss: 0.4117393
	speed: 0.0263s/iter; left time: 253.2008s
	iters: 800, epoch: 2 | loss: 0.6840698
	speed: 0.0261s/iter; left time: 248.6855s
	iters: 900, epoch: 2 | loss: 0.4737943
	speed: 0.0259s/iter; left time: 244.5362s
	iters: 1000, epoch: 2 | loss: 0.4304779
	speed: 0.0257s/iter; left time: 239.8989s
	iters: 1100, epoch: 2 | loss: 0.3505506
	speed: 0.0255s/iter; left time: 234.9305s
Epoch: 2 cost time: 29.483542442321777
Epoch: 2, Steps: 1147 | Train Loss: 0.4489124 Vali Loss: 0.4329348 Test Loss: 0.1769986
Validation loss decreased (0.441601 --> 0.432935).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4323526
	speed: 0.0339s/iter; left time: 307.6864s
	iters: 200, epoch: 3 | loss: 0.3313138
	speed: 0.0302s/iter; left time: 271.3092s
	iters: 300, epoch: 3 | loss: 0.4451861
	speed: 0.0258s/iter; left time: 229.0502s
	iters: 400, epoch: 3 | loss: 0.2524639
	speed: 0.0238s/iter; left time: 208.6586s
	iters: 500, epoch: 3 | loss: 1.5446885
	speed: 0.0225s/iter; left time: 195.5720s
	iters: 600, epoch: 3 | loss: 0.3376016
	speed: 0.0216s/iter; left time: 185.0025s
	iters: 700, epoch: 3 | loss: 0.3471975
	speed: 0.0216s/iter; left time: 182.8210s
	iters: 800, epoch: 3 | loss: 0.3145178
	speed: 0.0229s/iter; left time: 191.4375s
	iters: 900, epoch: 3 | loss: 0.4127069
	speed: 0.0247s/iter; left time: 204.2377s
	iters: 1000, epoch: 3 | loss: 0.3007589
	speed: 0.0262s/iter; left time: 214.0222s
	iters: 1100, epoch: 3 | loss: 1.2660247
	speed: 0.0266s/iter; left time: 215.1846s
Epoch: 3 cost time: 30.578407764434814
Epoch: 3, Steps: 1147 | Train Loss: 0.4291994 Vali Loss: 0.4325646 Test Loss: 0.1743216
Validation loss decreased (0.432935 --> 0.432565).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3922729
	speed: 0.0379s/iter; left time: 300.9172s
	iters: 200, epoch: 4 | loss: 0.2974966
	speed: 0.0356s/iter; left time: 278.3842s
	iters: 300, epoch: 4 | loss: 0.3337648
	speed: 0.0322s/iter; left time: 248.9385s
	iters: 400, epoch: 4 | loss: 0.4796975
	speed: 0.0298s/iter; left time: 227.6550s
	iters: 500, epoch: 4 | loss: 0.2692079
	speed: 0.0284s/iter; left time: 214.1959s
	iters: 600, epoch: 4 | loss: 0.3356139
	speed: 0.0278s/iter; left time: 206.2343s
	iters: 700, epoch: 4 | loss: 0.3463389
	speed: 0.0273s/iter; left time: 199.8575s
	iters: 800, epoch: 4 | loss: 0.4368037
	speed: 0.0269s/iter; left time: 194.2915s
	iters: 900, epoch: 4 | loss: 0.3180155
	speed: 0.0265s/iter; left time: 189.1909s
	iters: 1000, epoch: 4 | loss: 0.2531412
	speed: 0.0259s/iter; left time: 182.3365s
	iters: 1100, epoch: 4 | loss: 0.2259015
	speed: 0.0258s/iter; left time: 178.7364s
Epoch: 4 cost time: 29.4200599193573
Epoch: 4, Steps: 1147 | Train Loss: 0.4175083 Vali Loss: 0.4396453 Test Loss: 0.1739912
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3480090
	speed: 0.0343s/iter; left time: 232.6833s
	iters: 200, epoch: 5 | loss: 0.3347554
	speed: 0.0359s/iter; left time: 240.1056s
	iters: 300, epoch: 5 | loss: 1.3143883
	speed: 0.0357s/iter; left time: 235.2760s
	iters: 400, epoch: 5 | loss: 0.3955866
	speed: 0.0341s/iter; left time: 221.1518s
	iters: 500, epoch: 5 | loss: 1.2670597
	speed: 0.0330s/iter; left time: 210.3234s
	iters: 600, epoch: 5 | loss: 0.2780963
	speed: 0.0323s/iter; left time: 202.9705s
	iters: 700, epoch: 5 | loss: 1.4008441
	speed: 0.0328s/iter; left time: 202.4957s
	iters: 800, epoch: 5 | loss: 0.3360830
	speed: 0.0322s/iter; left time: 195.7878s
	iters: 900, epoch: 5 | loss: 0.2856720
	speed: 0.0310s/iter; left time: 185.6639s
	iters: 1000, epoch: 5 | loss: 0.4519359
	speed: 0.0298s/iter; left time: 175.5868s
	iters: 1100, epoch: 5 | loss: 0.4936086
	speed: 0.0289s/iter; left time: 167.3264s
Epoch: 5 cost time: 32.93965530395508
Epoch: 5, Steps: 1147 | Train Loss: 0.4113581 Vali Loss: 0.4364364 Test Loss: 0.1714898
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2799686
	speed: 0.0225s/iter; left time: 126.9972s
	iters: 200, epoch: 6 | loss: 0.3928254
	speed: 0.0199s/iter; left time: 109.9243s
	iters: 300, epoch: 6 | loss: 1.2192744
	speed: 0.0201s/iter; left time: 109.2018s
	iters: 400, epoch: 6 | loss: 0.3184164
	speed: 0.0204s/iter; left time: 108.7903s
	iters: 500, epoch: 6 | loss: 0.2518272
	speed: 0.0213s/iter; left time: 111.7866s
	iters: 600, epoch: 6 | loss: 0.2244362
	speed: 0.0219s/iter; left time: 112.2918s
	iters: 700, epoch: 6 | loss: 0.4106519
	speed: 0.0223s/iter; left time: 112.1187s
	iters: 800, epoch: 6 | loss: 0.3521880
	speed: 0.0227s/iter; left time: 112.1475s
	iters: 900, epoch: 6 | loss: 0.3158651
	speed: 0.0223s/iter; left time: 107.7549s
	iters: 1000, epoch: 6 | loss: 0.3011639
	speed: 0.0219s/iter; left time: 103.7594s
	iters: 1100, epoch: 6 | loss: 0.5161125
	speed: 0.0217s/iter; left time: 100.4296s
Epoch: 6 cost time: 24.94969081878662
Epoch: 6, Steps: 1147 | Train Loss: 0.4078809 Vali Loss: 0.4392961 Test Loss: 0.1719236
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3191511
	speed: 0.0406s/iter; left time: 182.3047s
	iters: 200, epoch: 7 | loss: 0.2701150
	speed: 0.0353s/iter; left time: 154.9438s
	iters: 300, epoch: 7 | loss: 0.2328784
	speed: 0.0312s/iter; left time: 133.6044s
	iters: 400, epoch: 7 | loss: 0.3050162
	speed: 0.0307s/iter; left time: 128.6687s
	iters: 500, epoch: 7 | loss: 0.2703930
	speed: 0.0311s/iter; left time: 127.0171s
	iters: 600, epoch: 7 | loss: 0.2303581
	speed: 0.0294s/iter; left time: 117.4488s
	iters: 700, epoch: 7 | loss: 0.2432866
	speed: 0.0278s/iter; left time: 108.3059s
	iters: 800, epoch: 7 | loss: 0.3803085
	speed: 0.0264s/iter; left time: 99.8556s
	iters: 900, epoch: 7 | loss: 0.1896804
	speed: 0.0252s/iter; left time: 93.0671s
	iters: 1000, epoch: 7 | loss: 0.3002878
	speed: 0.0247s/iter; left time: 88.6167s
	iters: 1100, epoch: 7 | loss: 0.3221490
	speed: 0.0244s/iter; left time: 85.0573s
Epoch: 7 cost time: 28.114519596099854
Epoch: 7, Steps: 1147 | Train Loss: 0.4064997 Vali Loss: 0.4371962 Test Loss: 0.1719142
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2769926
	speed: 0.0410s/iter; left time: 136.9796s
	iters: 200, epoch: 8 | loss: 0.2771231
	speed: 0.0392s/iter; left time: 127.1815s
	iters: 300, epoch: 8 | loss: 0.2647811
	speed: 0.0388s/iter; left time: 122.0347s
	iters: 400, epoch: 8 | loss: 0.3067302
	speed: 0.0378s/iter; left time: 114.8858s
	iters: 500, epoch: 8 | loss: 0.2622253
	speed: 0.0356s/iter; left time: 104.6830s
	iters: 600, epoch: 8 | loss: 0.2736961
	speed: 0.0327s/iter; left time: 92.8992s
	iters: 700, epoch: 8 | loss: 0.3694467
	speed: 0.0307s/iter; left time: 84.1518s
	iters: 800, epoch: 8 | loss: 0.2594404
	speed: 0.0298s/iter; left time: 78.7146s
	iters: 900, epoch: 8 | loss: 0.2982243
	speed: 0.0291s/iter; left time: 73.8844s
	iters: 1000, epoch: 8 | loss: 0.2161923
	speed: 0.0287s/iter; left time: 70.1832s
	iters: 1100, epoch: 8 | loss: 0.3258387
	speed: 0.0285s/iter; left time: 66.8165s
Epoch: 8 cost time: 32.70233941078186
Epoch: 8, Steps: 1147 | Train Loss: 0.4055908 Vali Loss: 0.4392630 Test Loss: 0.1716466
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.17432153224945068, mae:0.2144256979227066
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.4008483
	speed: 0.0278s/iter; left time: 315.6325s
	iters: 200, epoch: 1 | loss: 0.3321768
	speed: 0.0223s/iter; left time: 251.7279s
	iters: 300, epoch: 1 | loss: 0.5437806
	speed: 0.0189s/iter; left time: 211.6767s
	iters: 400, epoch: 1 | loss: 0.3988764
	speed: 0.0173s/iter; left time: 191.4829s
	iters: 500, epoch: 1 | loss: 0.3984804
	speed: 0.0186s/iter; left time: 203.6622s
	iters: 600, epoch: 1 | loss: 0.3772657
	speed: 0.0197s/iter; left time: 213.8772s
	iters: 700, epoch: 1 | loss: 0.3228004
	speed: 0.0207s/iter; left time: 222.8707s
	iters: 800, epoch: 1 | loss: 1.3522065
	speed: 0.0212s/iter; left time: 226.4563s
	iters: 900, epoch: 1 | loss: 0.4828231
	speed: 0.0216s/iter; left time: 228.7428s
	iters: 1000, epoch: 1 | loss: 0.4157872
	speed: 0.0220s/iter; left time: 229.9625s
	iters: 1100, epoch: 1 | loss: 0.4492884
	speed: 0.0222s/iter; left time: 230.6982s
Epoch: 1 cost time: 25.763094902038574
Epoch: 1, Steps: 1147 | Train Loss: 0.4962972 Vali Loss: 0.4366286 Test Loss: 0.1825629
Validation loss decreased (inf --> 0.436629).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2848918
	speed: 0.0388s/iter; left time: 396.6419s
	iters: 200, epoch: 2 | loss: 2.1431353
	speed: 0.0359s/iter; left time: 363.3891s
	iters: 300, epoch: 2 | loss: 0.4422916
	speed: 0.0336s/iter; left time: 336.4078s
	iters: 400, epoch: 2 | loss: 1.2296345
	speed: 0.0296s/iter; left time: 293.6957s
	iters: 500, epoch: 2 | loss: 0.4290016
	speed: 0.0273s/iter; left time: 267.8629s
	iters: 600, epoch: 2 | loss: 0.4176413
	speed: 0.0259s/iter; left time: 251.7714s
	iters: 700, epoch: 2 | loss: 0.3482420
	speed: 0.0255s/iter; left time: 244.9760s
	iters: 800, epoch: 2 | loss: 0.3318458
	speed: 0.0253s/iter; left time: 240.9008s
	iters: 900, epoch: 2 | loss: 0.2621140
	speed: 0.0251s/iter; left time: 236.9388s
	iters: 1000, epoch: 2 | loss: 0.2897873
	speed: 0.0250s/iter; left time: 233.4404s
	iters: 1100, epoch: 2 | loss: 0.2297746
	speed: 0.0250s/iter; left time: 230.2465s
Epoch: 2 cost time: 28.70762825012207
Epoch: 2, Steps: 1147 | Train Loss: 0.4505187 Vali Loss: 0.4342170 Test Loss: 0.1814959
Validation loss decreased (0.436629 --> 0.434217).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3631867
	speed: 0.0310s/iter; left time: 281.8106s
	iters: 200, epoch: 3 | loss: 0.4433150
	speed: 0.0282s/iter; left time: 252.8738s
	iters: 300, epoch: 3 | loss: 0.4276952
	speed: 0.0266s/iter; left time: 236.5521s
	iters: 400, epoch: 3 | loss: 0.3532144
	speed: 0.0278s/iter; left time: 244.2007s
	iters: 500, epoch: 3 | loss: 0.4188848
	speed: 0.0263s/iter; left time: 228.5497s
	iters: 600, epoch: 3 | loss: 0.3777140
	speed: 0.0251s/iter; left time: 215.4746s
	iters: 700, epoch: 3 | loss: 0.4291332
	speed: 0.0240s/iter; left time: 203.0543s
	iters: 800, epoch: 3 | loss: 0.2375946
	speed: 0.0242s/iter; left time: 202.6617s
	iters: 900, epoch: 3 | loss: 0.2473697
	speed: 0.0252s/iter; left time: 208.8336s
	iters: 1000, epoch: 3 | loss: 0.3933163
	speed: 0.0259s/iter; left time: 211.8338s
	iters: 1100, epoch: 3 | loss: 0.3482791
	speed: 0.0258s/iter; left time: 208.7236s
Epoch: 3 cost time: 29.705798387527466
Epoch: 3, Steps: 1147 | Train Loss: 0.4296191 Vali Loss: 0.4297109 Test Loss: 0.1752589
Validation loss decreased (0.434217 --> 0.429711).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3600850
	speed: 0.0269s/iter; left time: 213.5940s
	iters: 200, epoch: 4 | loss: 0.2589070
	speed: 0.0210s/iter; left time: 164.4007s
	iters: 300, epoch: 4 | loss: 0.4411649
	speed: 0.0183s/iter; left time: 141.2239s
	iters: 400, epoch: 4 | loss: 0.3295727
	speed: 0.0173s/iter; left time: 132.3035s
	iters: 500, epoch: 4 | loss: 0.3903056
	speed: 0.0168s/iter; left time: 126.6502s
	iters: 600, epoch: 4 | loss: 0.4896764
	speed: 0.0161s/iter; left time: 119.4666s
	iters: 700, epoch: 4 | loss: 0.3302927
	speed: 0.0152s/iter; left time: 111.5948s
	iters: 800, epoch: 4 | loss: 0.2511330
	speed: 0.0155s/iter; left time: 112.4060s
	iters: 900, epoch: 4 | loss: 0.2819175
	speed: 0.0160s/iter; left time: 113.8269s
	iters: 1000, epoch: 4 | loss: 0.3519176
	speed: 0.0163s/iter; left time: 114.2474s
	iters: 1100, epoch: 4 | loss: 0.4728874
	speed: 0.0172s/iter; left time: 118.8675s
Epoch: 4 cost time: 20.450335025787354
Epoch: 4, Steps: 1147 | Train Loss: 0.4179347 Vali Loss: 0.4271032 Test Loss: 0.1743781
Validation loss decreased (0.429711 --> 0.427103).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3615170
	speed: 0.0433s/iter; left time: 293.5353s
	iters: 200, epoch: 5 | loss: 0.4460557
	speed: 0.0363s/iter; left time: 242.4224s
	iters: 300, epoch: 5 | loss: 0.2500885
	speed: 0.0317s/iter; left time: 208.8011s
	iters: 400, epoch: 5 | loss: 0.2970490
	speed: 0.0287s/iter; left time: 186.2529s
	iters: 500, epoch: 5 | loss: 0.2730532
	speed: 0.0269s/iter; left time: 171.6766s
	iters: 600, epoch: 5 | loss: 0.5523784
	speed: 0.0259s/iter; left time: 162.6463s
	iters: 700, epoch: 5 | loss: 0.2266337
	speed: 0.0253s/iter; left time: 156.6557s
	iters: 800, epoch: 5 | loss: 0.3055174
	speed: 0.0249s/iter; left time: 151.3401s
	iters: 900, epoch: 5 | loss: 0.3320939
	speed: 0.0246s/iter; left time: 147.3098s
	iters: 1000, epoch: 5 | loss: 0.4435691
	speed: 0.0245s/iter; left time: 143.8973s
	iters: 1100, epoch: 5 | loss: 0.3005996
	speed: 0.0243s/iter; left time: 140.4423s
Epoch: 5 cost time: 27.91242027282715
Epoch: 5, Steps: 1147 | Train Loss: 0.4119610 Vali Loss: 0.4259520 Test Loss: 0.1730631
Validation loss decreased (0.427103 --> 0.425952).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4064288
	speed: 0.0294s/iter; left time: 165.7114s
	iters: 200, epoch: 6 | loss: 0.3363233
	speed: 0.0269s/iter; left time: 148.8213s
	iters: 300, epoch: 6 | loss: 0.3595196
	speed: 0.0273s/iter; left time: 148.5073s
	iters: 400, epoch: 6 | loss: 0.3673072
	speed: 0.0280s/iter; left time: 149.2674s
	iters: 500, epoch: 6 | loss: 0.5456806
	speed: 0.0268s/iter; left time: 140.2390s
	iters: 600, epoch: 6 | loss: 0.2872337
	speed: 0.0255s/iter; left time: 131.1446s
	iters: 700, epoch: 6 | loss: 0.3197176
	speed: 0.0248s/iter; left time: 125.1364s
	iters: 800, epoch: 6 | loss: 0.4224301
	speed: 0.0247s/iter; left time: 122.0900s
	iters: 900, epoch: 6 | loss: 0.2783665
	speed: 0.0247s/iter; left time: 119.4478s
	iters: 1000, epoch: 6 | loss: 1.2477424
	speed: 0.0247s/iter; left time: 116.9360s
	iters: 1100, epoch: 6 | loss: 0.2561547
	speed: 0.0246s/iter; left time: 113.8362s
Epoch: 6 cost time: 28.242774963378906
Epoch: 6, Steps: 1147 | Train Loss: 0.4087277 Vali Loss: 0.4288957 Test Loss: 0.1744928
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3010049
	speed: 0.0450s/iter; left time: 201.8864s
	iters: 200, epoch: 7 | loss: 0.3921860
	speed: 0.0398s/iter; left time: 174.7723s
	iters: 300, epoch: 7 | loss: 0.3501440
	speed: 0.0329s/iter; left time: 141.0210s
	iters: 400, epoch: 7 | loss: 0.3913631
	speed: 0.0284s/iter; left time: 118.8404s
	iters: 500, epoch: 7 | loss: 0.3962429
	speed: 0.0256s/iter; left time: 104.8231s
	iters: 600, epoch: 7 | loss: 0.5193148
	speed: 0.0237s/iter; left time: 94.4655s
	iters: 700, epoch: 7 | loss: 0.2247439
	speed: 0.0235s/iter; left time: 91.4866s
	iters: 800, epoch: 7 | loss: 0.4149668
	speed: 0.0233s/iter; left time: 88.2519s
	iters: 900, epoch: 7 | loss: 0.2625583
	speed: 0.0234s/iter; left time: 86.2022s
	iters: 1000, epoch: 7 | loss: 0.3210052
	speed: 0.0235s/iter; left time: 84.4380s
	iters: 1100, epoch: 7 | loss: 0.4235310
	speed: 0.0233s/iter; left time: 81.2902s
Epoch: 7 cost time: 26.90371012687683
Epoch: 7, Steps: 1147 | Train Loss: 0.4071355 Vali Loss: 0.4265378 Test Loss: 0.1734220
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3642147
	speed: 0.0405s/iter; left time: 135.3755s
	iters: 200, epoch: 8 | loss: 0.3239563
	speed: 0.0362s/iter; left time: 117.2526s
	iters: 300, epoch: 8 | loss: 0.2863704
	speed: 0.0323s/iter; left time: 101.5738s
	iters: 400, epoch: 8 | loss: 0.3438926
	speed: 0.0299s/iter; left time: 91.0584s
	iters: 500, epoch: 8 | loss: 0.2384279
	speed: 0.0285s/iter; left time: 83.9186s
	iters: 600, epoch: 8 | loss: 0.2559326
	speed: 0.0282s/iter; left time: 80.1626s
	iters: 700, epoch: 8 | loss: 0.3590658
	speed: 0.0290s/iter; left time: 79.3815s
	iters: 800, epoch: 8 | loss: 0.3396253
	speed: 0.0277s/iter; left time: 73.2985s
	iters: 900, epoch: 8 | loss: 0.2441218
	speed: 0.0271s/iter; left time: 68.7622s
	iters: 1000, epoch: 8 | loss: 0.5158718
	speed: 0.0266s/iter; left time: 64.9628s
	iters: 1100, epoch: 8 | loss: 0.4487457
	speed: 0.0262s/iter; left time: 61.3669s
Epoch: 8 cost time: 30.22539234161377
Epoch: 8, Steps: 1147 | Train Loss: 0.4064071 Vali Loss: 0.4271242 Test Loss: 0.1734832
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3936390
	speed: 0.0355s/iter; left time: 77.9238s
	iters: 200, epoch: 9 | loss: 0.2970316
	speed: 0.0322s/iter; left time: 67.5377s
	iters: 300, epoch: 9 | loss: 0.4306773
	speed: 0.0323s/iter; left time: 64.3608s
	iters: 400, epoch: 9 | loss: 0.2584028
	speed: 0.0320s/iter; left time: 60.5511s
	iters: 500, epoch: 9 | loss: 0.2801737
	speed: 0.0300s/iter; left time: 53.8398s
	iters: 600, epoch: 9 | loss: 0.3118554
	speed: 0.0287s/iter; left time: 48.6314s
	iters: 700, epoch: 9 | loss: 0.3647348
	speed: 0.0274s/iter; left time: 43.7633s
	iters: 800, epoch: 9 | loss: 0.2851566
	speed: 0.0265s/iter; left time: 39.5870s
	iters: 900, epoch: 9 | loss: 0.3159756
	speed: 0.0261s/iter; left time: 36.3765s
	iters: 1000, epoch: 9 | loss: 0.2518448
	speed: 0.0257s/iter; left time: 33.3128s
	iters: 1100, epoch: 9 | loss: 0.5183212
	speed: 0.0255s/iter; left time: 30.4546s
Epoch: 9 cost time: 29.348421335220337
Epoch: 9, Steps: 1147 | Train Loss: 0.4059167 Vali Loss: 0.4265946 Test Loss: 0.1733918
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3797608
	speed: 0.0328s/iter; left time: 34.3689s
	iters: 200, epoch: 10 | loss: 0.3021045
	speed: 0.0320s/iter; left time: 30.3362s
	iters: 300, epoch: 10 | loss: 0.2291267
	speed: 0.0318s/iter; left time: 26.9821s
	iters: 400, epoch: 10 | loss: 0.3855578
	speed: 0.0290s/iter; left time: 21.7277s
	iters: 500, epoch: 10 | loss: 0.4778655
	speed: 0.0269s/iter; left time: 17.4255s
	iters: 600, epoch: 10 | loss: 0.2982968
	speed: 0.0256s/iter; left time: 14.0150s
	iters: 700, epoch: 10 | loss: 0.2676319
	speed: 0.0244s/iter; left time: 10.9220s
	iters: 800, epoch: 10 | loss: 0.2537271
	speed: 0.0237s/iter; left time: 8.2645s
	iters: 900, epoch: 10 | loss: 1.1801580
	speed: 0.0233s/iter; left time: 5.7888s
	iters: 1000, epoch: 10 | loss: 1.2084092
	speed: 0.0232s/iter; left time: 3.4342s
	iters: 1100, epoch: 10 | loss: 0.4296326
	speed: 0.0231s/iter; left time: 1.1091s
Epoch: 10 cost time: 26.63833260536194
Epoch: 10, Steps: 1147 | Train Loss: 0.4060411 Vali Loss: 0.4272444 Test Loss: 0.1734434
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.17306318879127502, mae:0.21286557614803314
Seed: 456
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_192      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.4219824
	speed: 0.0517s/iter; left time: 585.9097s
	iters: 200, epoch: 1 | loss: 0.4710928
	speed: 0.0415s/iter; left time: 466.3452s
	iters: 300, epoch: 1 | loss: 0.5604787
	speed: 0.0375s/iter; left time: 418.2726s
	iters: 400, epoch: 1 | loss: 0.3864689
	speed: 0.0363s/iter; left time: 400.7152s
	iters: 500, epoch: 1 | loss: 0.7292219
	speed: 0.0355s/iter; left time: 388.2000s
	iters: 600, epoch: 1 | loss: 0.4524288
	speed: 0.0356s/iter; left time: 385.8014s
	iters: 700, epoch: 1 | loss: 0.4325669
	speed: 0.0353s/iter; left time: 378.9777s
	iters: 800, epoch: 1 | loss: 0.3872831
	speed: 0.0336s/iter; left time: 357.7610s
	iters: 900, epoch: 1 | loss: 0.9485231
	speed: 0.0323s/iter; left time: 340.7576s
	iters: 1000, epoch: 1 | loss: 0.4332230
	speed: 0.0311s/iter; left time: 324.9772s
	iters: 1100, epoch: 1 | loss: 0.4288099
	speed: 0.0300s/iter; left time: 310.6466s
Epoch: 1 cost time: 34.08961796760559
Epoch: 1, Steps: 1144 | Train Loss: 0.5644548 Vali Loss: 0.5241400 Test Loss: 0.2335579
Validation loss decreased (inf --> 0.524140).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8596095
	speed: 0.0310s/iter; left time: 316.5555s
	iters: 200, epoch: 2 | loss: 0.4600721
	speed: 0.0237s/iter; left time: 239.3804s
	iters: 300, epoch: 2 | loss: 0.3856055
	speed: 0.0226s/iter; left time: 225.6753s
	iters: 400, epoch: 2 | loss: 0.4885561
	speed: 0.0220s/iter; left time: 217.7631s
	iters: 500, epoch: 2 | loss: 0.3435252
	speed: 0.0215s/iter; left time: 211.0033s
	iters: 600, epoch: 2 | loss: 0.4762984
	speed: 0.0213s/iter; left time: 206.2757s
	iters: 700, epoch: 2 | loss: 0.4470479
	speed: 0.0209s/iter; left time: 200.5372s
	iters: 800, epoch: 2 | loss: 0.4080716
	speed: 0.0218s/iter; left time: 206.9994s
	iters: 900, epoch: 2 | loss: 0.9238150
	speed: 0.0219s/iter; left time: 205.7386s
	iters: 1000, epoch: 2 | loss: 0.4417007
	speed: 0.0219s/iter; left time: 203.9593s
	iters: 1100, epoch: 2 | loss: 0.4822320
	speed: 0.0219s/iter; left time: 200.9610s
Epoch: 2 cost time: 25.50718879699707
Epoch: 2, Steps: 1144 | Train Loss: 0.5235464 Vali Loss: 0.5190048 Test Loss: 0.2294012
Validation loss decreased (0.524140 --> 0.519005).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4223254
	speed: 0.0404s/iter; left time: 365.5181s
	iters: 200, epoch: 3 | loss: 0.5549766
	speed: 0.0374s/iter; left time: 334.7935s
	iters: 300, epoch: 3 | loss: 0.3779818
	speed: 0.0352s/iter; left time: 311.2815s
	iters: 400, epoch: 3 | loss: 0.5197498
	speed: 0.0353s/iter; left time: 309.1324s
	iters: 500, epoch: 3 | loss: 0.4062206
	speed: 0.0354s/iter; left time: 306.5052s
	iters: 600, epoch: 3 | loss: 0.5151584
	speed: 0.0355s/iter; left time: 303.9695s
	iters: 700, epoch: 3 | loss: 0.5168960
	speed: 0.0348s/iter; left time: 294.4321s
	iters: 800, epoch: 3 | loss: 0.8495432
	speed: 0.0331s/iter; left time: 276.5048s
	iters: 900, epoch: 3 | loss: 0.5039986
	speed: 0.0316s/iter; left time: 260.5351s
	iters: 1000, epoch: 3 | loss: 0.6903386
	speed: 0.0310s/iter; left time: 252.9731s
	iters: 1100, epoch: 3 | loss: 0.9492233
	speed: 0.0300s/iter; left time: 241.9919s
Epoch: 3 cost time: 34.035584688186646
Epoch: 3, Steps: 1144 | Train Loss: 0.5053643 Vali Loss: 0.5063733 Test Loss: 0.2250835
Validation loss decreased (0.519005 --> 0.506373).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3944395
	speed: 0.0242s/iter; left time: 191.4882s
	iters: 200, epoch: 4 | loss: 0.3462494
	speed: 0.0225s/iter; left time: 175.4647s
	iters: 300, epoch: 4 | loss: 0.9303565
	speed: 0.0257s/iter; left time: 198.3248s
	iters: 400, epoch: 4 | loss: 0.9160616
	speed: 0.0288s/iter; left time: 219.4597s
	iters: 500, epoch: 4 | loss: 0.9326813
	speed: 0.0309s/iter; left time: 231.6986s
	iters: 600, epoch: 4 | loss: 0.5476847
	speed: 0.0321s/iter; left time: 237.8292s
	iters: 700, epoch: 4 | loss: 0.5190402
	speed: 0.0329s/iter; left time: 240.2217s
	iters: 800, epoch: 4 | loss: 0.7810539
	speed: 0.0322s/iter; left time: 232.1410s
	iters: 900, epoch: 4 | loss: 0.3252855
	speed: 0.0310s/iter; left time: 220.6795s
	iters: 1000, epoch: 4 | loss: 0.4013994
	speed: 0.0301s/iter; left time: 210.7343s
	iters: 1100, epoch: 4 | loss: 0.3062408
	speed: 0.0294s/iter; left time: 203.4155s
Epoch: 4 cost time: 33.74624228477478
Epoch: 4, Steps: 1144 | Train Loss: 0.4931338 Vali Loss: 0.5101383 Test Loss: 0.2238574
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4893614
	speed: 0.0182s/iter; left time: 122.8810s
	iters: 200, epoch: 5 | loss: 0.2789735
	speed: 0.0199s/iter; left time: 132.5334s
	iters: 300, epoch: 5 | loss: 0.4574308
	speed: 0.0213s/iter; left time: 139.7690s
	iters: 400, epoch: 5 | loss: 0.3149257
	speed: 0.0222s/iter; left time: 143.2540s
	iters: 500, epoch: 5 | loss: 0.4094897
	speed: 0.0226s/iter; left time: 143.6981s
	iters: 600, epoch: 5 | loss: 0.4504284
	speed: 0.0229s/iter; left time: 143.6272s
	iters: 700, epoch: 5 | loss: 0.9118195
	speed: 0.0232s/iter; left time: 142.7908s
	iters: 800, epoch: 5 | loss: 0.8695651
	speed: 0.0247s/iter; left time: 149.8905s
	iters: 900, epoch: 5 | loss: 0.9940463
	speed: 0.0247s/iter; left time: 147.2635s
	iters: 1000, epoch: 5 | loss: 0.4343532
	speed: 0.0244s/iter; left time: 143.1459s
	iters: 1100, epoch: 5 | loss: 0.3815499
	speed: 0.0240s/iter; left time: 138.3657s
Epoch: 5 cost time: 27.399463653564453
Epoch: 5, Steps: 1144 | Train Loss: 0.4867323 Vali Loss: 0.5122672 Test Loss: 0.2234066
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2936936
	speed: 0.0325s/iter; left time: 182.8753s
	iters: 200, epoch: 6 | loss: 0.4637287
	speed: 0.0331s/iter; left time: 182.9460s
	iters: 300, epoch: 6 | loss: 0.3965815
	speed: 0.0300s/iter; left time: 162.7242s
	iters: 400, epoch: 6 | loss: 0.4253001
	speed: 0.0284s/iter; left time: 151.2898s
	iters: 500, epoch: 6 | loss: 0.8933374
	speed: 0.0277s/iter; left time: 144.6737s
	iters: 600, epoch: 6 | loss: 0.3648460
	speed: 0.0272s/iter; left time: 139.3316s
	iters: 700, epoch: 6 | loss: 0.4556331
	speed: 0.0269s/iter; left time: 134.9129s
	iters: 800, epoch: 6 | loss: 0.4705901
	speed: 0.0266s/iter; left time: 130.9254s
	iters: 900, epoch: 6 | loss: 0.5128575
	speed: 0.0263s/iter; left time: 126.9816s
	iters: 1000, epoch: 6 | loss: 0.3992523
	speed: 0.0261s/iter; left time: 123.0218s
	iters: 1100, epoch: 6 | loss: 0.4558413
	speed: 0.0255s/iter; left time: 117.6609s
Epoch: 6 cost time: 29.025858163833618
Epoch: 6, Steps: 1144 | Train Loss: 0.4833130 Vali Loss: 0.5149190 Test Loss: 0.2240955
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 1.3673203
	speed: 0.0293s/iter; left time: 131.1130s
	iters: 200, epoch: 7 | loss: 0.3608119
	speed: 0.0259s/iter; left time: 113.3663s
	iters: 300, epoch: 7 | loss: 0.9281078
	speed: 0.0248s/iter; left time: 106.0534s
	iters: 400, epoch: 7 | loss: 0.5267177
	speed: 0.0247s/iter; left time: 102.9827s
	iters: 500, epoch: 7 | loss: 0.3361139
	speed: 0.0246s/iter; left time: 100.4900s
	iters: 600, epoch: 7 | loss: 0.5049959
	speed: 0.0246s/iter; left time: 97.8841s
	iters: 700, epoch: 7 | loss: 0.3793093
	speed: 0.0246s/iter; left time: 95.3883s
	iters: 800, epoch: 7 | loss: 0.2863364
	speed: 0.0246s/iter; left time: 93.0419s
	iters: 900, epoch: 7 | loss: 0.4314285
	speed: 0.0245s/iter; left time: 90.2577s
	iters: 1000, epoch: 7 | loss: 0.4460478
	speed: 0.0243s/iter; left time: 87.0720s
	iters: 1100, epoch: 7 | loss: 0.3087589
	speed: 0.0240s/iter; left time: 83.5868s
Epoch: 7 cost time: 27.3709876537323
Epoch: 7, Steps: 1144 | Train Loss: 0.4815128 Vali Loss: 0.5139850 Test Loss: 0.2235637
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3607015
	speed: 0.0216s/iter; left time: 71.9355s
	iters: 200, epoch: 8 | loss: 0.3316611
	speed: 0.0218s/iter; left time: 70.4421s
	iters: 300, epoch: 8 | loss: 0.4753918
	speed: 0.0202s/iter; left time: 63.2138s
	iters: 400, epoch: 8 | loss: 0.3859550
	speed: 0.0193s/iter; left time: 58.6248s
	iters: 500, epoch: 8 | loss: 0.4007188
	speed: 0.0183s/iter; left time: 53.6632s
	iters: 600, epoch: 8 | loss: 0.4059282
	speed: 0.0184s/iter; left time: 52.0926s
	iters: 700, epoch: 8 | loss: 1.2353101
	speed: 0.0194s/iter; left time: 52.9634s
	iters: 800, epoch: 8 | loss: 0.4277629
	speed: 0.0201s/iter; left time: 52.9054s
	iters: 900, epoch: 8 | loss: 0.3641264
	speed: 0.0206s/iter; left time: 52.3059s
	iters: 1000, epoch: 8 | loss: 0.3901408
	speed: 0.0209s/iter; left time: 50.9318s
	iters: 1100, epoch: 8 | loss: 0.5357863
	speed: 0.0211s/iter; left time: 49.1220s
Epoch: 8 cost time: 24.324175119400024
Epoch: 8, Steps: 1144 | Train Loss: 0.4805119 Vali Loss: 0.5146410 Test Loss: 0.2236715
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.22508355975151062, mae:0.25772351026535034
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 1.0436217
	speed: 0.0445s/iter; left time: 504.5502s
	iters: 200, epoch: 1 | loss: 0.5994443
	speed: 0.0405s/iter; left time: 455.2325s
	iters: 300, epoch: 1 | loss: 0.4804252
	speed: 0.0390s/iter; left time: 434.8972s
	iters: 400, epoch: 1 | loss: 0.8275424
	speed: 0.0385s/iter; left time: 424.5710s
	iters: 500, epoch: 1 | loss: 0.3881213
	speed: 0.0373s/iter; left time: 407.9281s
	iters: 600, epoch: 1 | loss: 0.4131814
	speed: 0.0348s/iter; left time: 377.1201s
	iters: 700, epoch: 1 | loss: 0.3895229
	speed: 0.0330s/iter; left time: 354.6532s
	iters: 800, epoch: 1 | loss: 0.4924720
	speed: 0.0317s/iter; left time: 337.6638s
	iters: 900, epoch: 1 | loss: 1.3989505
	speed: 0.0307s/iter; left time: 323.7160s
	iters: 1000, epoch: 1 | loss: 0.4140482
	speed: 0.0301s/iter; left time: 314.1989s
	iters: 1100, epoch: 1 | loss: 0.3787914
	speed: 0.0297s/iter; left time: 307.5537s
Epoch: 1 cost time: 34.30080842971802
Epoch: 1, Steps: 1144 | Train Loss: 0.5650129 Vali Loss: 0.5232031 Test Loss: 0.2356014
Validation loss decreased (inf --> 0.523203).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3790607
	speed: 0.0392s/iter; left time: 400.1482s
	iters: 200, epoch: 2 | loss: 0.4687255
	speed: 0.0379s/iter; left time: 382.4833s
	iters: 300, epoch: 2 | loss: 0.4134882
	speed: 0.0345s/iter; left time: 345.1820s
	iters: 400, epoch: 2 | loss: 0.3834102
	speed: 0.0328s/iter; left time: 324.3826s
	iters: 500, epoch: 2 | loss: 1.0591172
	speed: 0.0306s/iter; left time: 299.6965s
	iters: 600, epoch: 2 | loss: 0.5489941
	speed: 0.0291s/iter; left time: 281.9742s
	iters: 700, epoch: 2 | loss: 0.5272772
	speed: 0.0279s/iter; left time: 267.9039s
	iters: 800, epoch: 2 | loss: 0.3481553
	speed: 0.0274s/iter; left time: 260.6036s
	iters: 900, epoch: 2 | loss: 0.4616078
	speed: 0.0271s/iter; left time: 254.6627s
	iters: 1000, epoch: 2 | loss: 0.3988107
	speed: 0.0268s/iter; left time: 249.2735s
	iters: 1100, epoch: 2 | loss: 0.5131021
	speed: 0.0272s/iter; left time: 249.8148s
Epoch: 2 cost time: 31.37762141227722
Epoch: 2, Steps: 1144 | Train Loss: 0.5223643 Vali Loss: 0.5012633 Test Loss: 0.2271590
Validation loss decreased (0.523203 --> 0.501263).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.8369575
	speed: 0.0252s/iter; left time: 227.8156s
	iters: 200, epoch: 3 | loss: 0.4139698
	speed: 0.0241s/iter; left time: 216.0628s
	iters: 300, epoch: 3 | loss: 0.4103957
	speed: 0.0237s/iter; left time: 209.6807s
	iters: 400, epoch: 3 | loss: 0.4183775
	speed: 0.0235s/iter; left time: 205.3248s
	iters: 500, epoch: 3 | loss: 0.3732592
	speed: 0.0233s/iter; left time: 201.9223s
	iters: 600, epoch: 3 | loss: 0.4013043
	speed: 0.0233s/iter; left time: 198.9562s
	iters: 700, epoch: 3 | loss: 0.4499927
	speed: 0.0234s/iter; left time: 197.5081s
	iters: 800, epoch: 3 | loss: 0.8020094
	speed: 0.0247s/iter; left time: 206.0024s
	iters: 900, epoch: 3 | loss: 0.4528108
	speed: 0.0258s/iter; left time: 212.8092s
	iters: 1000, epoch: 3 | loss: 0.4213926
	speed: 0.0265s/iter; left time: 215.7467s
	iters: 1100, epoch: 3 | loss: 0.4904863
	speed: 0.0268s/iter; left time: 216.0611s
Epoch: 3 cost time: 30.58909010887146
Epoch: 3, Steps: 1144 | Train Loss: 0.5037159 Vali Loss: 0.5070829 Test Loss: 0.2265013
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4549250
	speed: 0.0303s/iter; left time: 239.3966s
	iters: 200, epoch: 4 | loss: 0.3138381
	speed: 0.0261s/iter; left time: 204.1508s
	iters: 300, epoch: 4 | loss: 0.3918487
	speed: 0.0248s/iter; left time: 191.4802s
	iters: 400, epoch: 4 | loss: 0.5888860
	speed: 0.0242s/iter; left time: 184.3181s
	iters: 500, epoch: 4 | loss: 0.9101095
	speed: 0.0239s/iter; left time: 179.4073s
	iters: 600, epoch: 4 | loss: 0.3915535
	speed: 0.0242s/iter; left time: 179.1523s
	iters: 700, epoch: 4 | loss: 0.3972109
	speed: 0.0242s/iter; left time: 176.9305s
	iters: 800, epoch: 4 | loss: 0.3532842
	speed: 0.0242s/iter; left time: 174.6505s
	iters: 900, epoch: 4 | loss: 0.7313471
	speed: 0.0252s/iter; left time: 179.2182s
	iters: 1000, epoch: 4 | loss: 0.4851135
	speed: 0.0250s/iter; left time: 175.3317s
	iters: 1100, epoch: 4 | loss: 0.5842984
	speed: 0.0252s/iter; left time: 173.8109s
Epoch: 4 cost time: 28.989396810531616
Epoch: 4, Steps: 1144 | Train Loss: 0.4930594 Vali Loss: 0.5085585 Test Loss: 0.2241032
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3248094
	speed: 0.0272s/iter; left time: 184.0404s
	iters: 200, epoch: 5 | loss: 0.4035667
	speed: 0.0253s/iter; left time: 168.5427s
	iters: 300, epoch: 5 | loss: 0.4081862
	speed: 0.0246s/iter; left time: 161.2752s
	iters: 400, epoch: 5 | loss: 0.3546866
	speed: 0.0246s/iter; left time: 159.2673s
	iters: 500, epoch: 5 | loss: 0.8711219
	speed: 0.0262s/iter; left time: 166.7877s
	iters: 600, epoch: 5 | loss: 0.2947996
	speed: 0.0257s/iter; left time: 160.7470s
	iters: 700, epoch: 5 | loss: 0.9510026
	speed: 0.0255s/iter; left time: 157.0689s
	iters: 800, epoch: 5 | loss: 0.7157191
	speed: 0.0253s/iter; left time: 153.6895s
	iters: 900, epoch: 5 | loss: 0.3808801
	speed: 0.0253s/iter; left time: 150.7776s
	iters: 1000, epoch: 5 | loss: 0.3581356
	speed: 0.0250s/iter; left time: 146.5966s
	iters: 1100, epoch: 5 | loss: 0.4218136
	speed: 0.0248s/iter; left time: 142.8397s
Epoch: 5 cost time: 28.75881314277649
Epoch: 5, Steps: 1144 | Train Loss: 0.4869101 Vali Loss: 0.5096068 Test Loss: 0.2242621
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3650706
	speed: 0.0263s/iter; left time: 147.8406s
	iters: 200, epoch: 6 | loss: 0.5983623
	speed: 0.0212s/iter; left time: 116.8409s
	iters: 300, epoch: 6 | loss: 0.4400962
	speed: 0.0223s/iter; left time: 120.9285s
	iters: 400, epoch: 6 | loss: 0.5226420
	speed: 0.0224s/iter; left time: 119.1838s
	iters: 500, epoch: 6 | loss: 0.4455904
	speed: 0.0231s/iter; left time: 120.4256s
	iters: 600, epoch: 6 | loss: 0.3244851
	speed: 0.0250s/iter; left time: 127.7764s
	iters: 700, epoch: 6 | loss: 0.3572277
	speed: 0.0256s/iter; left time: 128.3158s
	iters: 800, epoch: 6 | loss: 0.3413360
	speed: 0.0255s/iter; left time: 125.6335s
	iters: 900, epoch: 6 | loss: 0.3370528
	speed: 0.0255s/iter; left time: 122.8966s
	iters: 1000, epoch: 6 | loss: 0.4007995
	speed: 0.0254s/iter; left time: 119.9675s
	iters: 1100, epoch: 6 | loss: 0.3998884
	speed: 0.0252s/iter; left time: 116.5013s
Epoch: 6 cost time: 28.852728366851807
Epoch: 6, Steps: 1144 | Train Loss: 0.4835527 Vali Loss: 0.5116373 Test Loss: 0.2235551
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4600876
	speed: 0.0414s/iter; left time: 185.1348s
	iters: 200, epoch: 7 | loss: 0.3949750
	speed: 0.0327s/iter; left time: 143.2114s
	iters: 300, epoch: 7 | loss: 0.4017862
	speed: 0.0302s/iter; left time: 129.3715s
	iters: 400, epoch: 7 | loss: 0.8561295
	speed: 0.0285s/iter; left time: 119.1330s
	iters: 500, epoch: 7 | loss: 0.4083340
	speed: 0.0274s/iter; left time: 111.5642s
	iters: 600, epoch: 7 | loss: 0.5162653
	speed: 0.0264s/iter; left time: 105.1407s
	iters: 700, epoch: 7 | loss: 0.4392698
	speed: 0.0260s/iter; left time: 100.6781s
	iters: 800, epoch: 7 | loss: 0.4112880
	speed: 0.0258s/iter; left time: 97.2870s
	iters: 900, epoch: 7 | loss: 0.3620336
	speed: 0.0262s/iter; left time: 96.3656s
	iters: 1000, epoch: 7 | loss: 0.4329250
	speed: 0.0271s/iter; left time: 96.7925s
	iters: 1100, epoch: 7 | loss: 0.4157469
	speed: 0.0269s/iter; left time: 93.3682s
Epoch: 7 cost time: 30.664473295211792
Epoch: 7, Steps: 1144 | Train Loss: 0.4816302 Vali Loss: 0.5122908 Test Loss: 0.2239481
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.22715897858142853, mae:0.25955939292907715
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 1.0026524
	speed: 0.0268s/iter; left time: 303.4897s
	iters: 200, epoch: 1 | loss: 0.4575881
	speed: 0.0239s/iter; left time: 269.0025s
	iters: 300, epoch: 1 | loss: 1.4516182
	speed: 0.0235s/iter; left time: 262.0534s
	iters: 400, epoch: 1 | loss: 0.9464710
	speed: 0.0234s/iter; left time: 257.8163s
	iters: 500, epoch: 1 | loss: 0.9863800
	speed: 0.0233s/iter; left time: 254.6567s
	iters: 600, epoch: 1 | loss: 0.6024089
	speed: 0.0233s/iter; left time: 252.2429s
	iters: 700, epoch: 1 | loss: 0.3848765
	speed: 0.0232s/iter; left time: 249.6716s
	iters: 800, epoch: 1 | loss: 0.5651919
	speed: 0.0231s/iter; left time: 245.5272s
	iters: 900, epoch: 1 | loss: 0.5186964
	speed: 0.0231s/iter; left time: 243.5911s
	iters: 1000, epoch: 1 | loss: 0.3634968
	speed: 0.0228s/iter; left time: 238.1931s
	iters: 1100, epoch: 1 | loss: 0.4533347
	speed: 0.0226s/iter; left time: 233.3705s
Epoch: 1 cost time: 25.754900217056274
Epoch: 1, Steps: 1144 | Train Loss: 0.5634861 Vali Loss: 0.5153577 Test Loss: 0.2301455
Validation loss decreased (inf --> 0.515358).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5839534
	speed: 0.0193s/iter; left time: 197.1145s
	iters: 200, epoch: 2 | loss: 0.3561874
	speed: 0.0208s/iter; left time: 209.6592s
	iters: 300, epoch: 2 | loss: 0.3604059
	speed: 0.0214s/iter; left time: 214.0025s
	iters: 400, epoch: 2 | loss: 0.3877187
	speed: 0.0217s/iter; left time: 215.1556s
	iters: 500, epoch: 2 | loss: 0.4605896
	speed: 0.0219s/iter; left time: 214.8378s
	iters: 600, epoch: 2 | loss: 0.4518594
	speed: 0.0221s/iter; left time: 213.8785s
	iters: 700, epoch: 2 | loss: 0.4234958
	speed: 0.0221s/iter; left time: 211.6842s
	iters: 800, epoch: 2 | loss: 0.4493212
	speed: 0.0218s/iter; left time: 206.6407s
	iters: 900, epoch: 2 | loss: 0.3872143
	speed: 0.0216s/iter; left time: 202.6974s
	iters: 1000, epoch: 2 | loss: 0.5054856
	speed: 0.0214s/iter; left time: 199.2472s
	iters: 1100, epoch: 2 | loss: 0.3879972
	speed: 0.0215s/iter; left time: 198.1560s
Epoch: 2 cost time: 24.815739393234253
Epoch: 2, Steps: 1144 | Train Loss: 0.5230933 Vali Loss: 0.5193745 Test Loss: 0.2310153
EarlyStopping counter: 1 out of 5
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5692896
	speed: 0.0219s/iter; left time: 198.4584s
	iters: 200, epoch: 3 | loss: 0.3775037
	speed: 0.0216s/iter; left time: 193.7498s
	iters: 300, epoch: 3 | loss: 0.5516588
	speed: 0.0220s/iter; left time: 194.7397s
	iters: 400, epoch: 3 | loss: 0.3181432
	speed: 0.0222s/iter; left time: 194.1473s
	iters: 500, epoch: 3 | loss: 0.4294991
	speed: 0.0223s/iter; left time: 192.8935s
	iters: 600, epoch: 3 | loss: 0.5256129
	speed: 0.0224s/iter; left time: 191.2529s
	iters: 700, epoch: 3 | loss: 0.4696237
	speed: 0.0223s/iter; left time: 188.5245s
	iters: 800, epoch: 3 | loss: 0.3189595
	speed: 0.0220s/iter; left time: 183.5849s
	iters: 900, epoch: 3 | loss: 0.8709810
	speed: 0.0218s/iter; left time: 179.6663s
	iters: 1000, epoch: 3 | loss: 0.5772166
	speed: 0.0216s/iter; left time: 176.2176s
	iters: 1100, epoch: 3 | loss: 0.3471032
	speed: 0.0217s/iter; left time: 174.8758s
Epoch: 3 cost time: 24.987494945526123
Epoch: 3, Steps: 1144 | Train Loss: 0.5034455 Vali Loss: 0.5054631 Test Loss: 0.2242087
Validation loss decreased (0.515358 --> 0.505463).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5152630
	speed: 0.0221s/iter; left time: 174.7906s
	iters: 200, epoch: 4 | loss: 0.3608760
	speed: 0.0218s/iter; left time: 170.2877s
	iters: 300, epoch: 4 | loss: 0.3525403
	speed: 0.0221s/iter; left time: 170.4252s
	iters: 400, epoch: 4 | loss: 0.8348349
	speed: 0.0223s/iter; left time: 169.3976s
	iters: 500, epoch: 4 | loss: 0.3117813
	speed: 0.0224s/iter; left time: 167.8871s
	iters: 600, epoch: 4 | loss: 0.4430850
	speed: 0.0224s/iter; left time: 166.0830s
	iters: 700, epoch: 4 | loss: 0.4633400
	speed: 0.0223s/iter; left time: 163.0324s
	iters: 800, epoch: 4 | loss: 0.4275388
	speed: 0.0220s/iter; left time: 158.4198s
	iters: 900, epoch: 4 | loss: 0.4326797
	speed: 0.0218s/iter; left time: 154.8310s
	iters: 1000, epoch: 4 | loss: 0.3427809
	speed: 0.0216s/iter; left time: 151.1773s
	iters: 1100, epoch: 4 | loss: 0.4559965
	speed: 0.0214s/iter; left time: 148.1917s
Epoch: 4 cost time: 24.605353116989136
Epoch: 4, Steps: 1144 | Train Loss: 0.4921285 Vali Loss: 0.5058276 Test Loss: 0.2243563
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4245622
	speed: 0.0166s/iter; left time: 112.0288s
	iters: 200, epoch: 5 | loss: 0.4031619
	speed: 0.0156s/iter; left time: 103.7922s
	iters: 300, epoch: 5 | loss: 0.3861248
	speed: 0.0162s/iter; left time: 106.1553s
	iters: 400, epoch: 5 | loss: 0.4694325
	speed: 0.0165s/iter; left time: 106.4737s
	iters: 500, epoch: 5 | loss: 0.4986012
	speed: 0.0171s/iter; left time: 109.0304s
	iters: 600, epoch: 5 | loss: 0.3680862
	speed: 0.0181s/iter; left time: 113.3450s
	iters: 700, epoch: 5 | loss: 0.6061670
	speed: 0.0188s/iter; left time: 115.7775s
	iters: 800, epoch: 5 | loss: 0.3306103
	speed: 0.0193s/iter; left time: 117.0863s
	iters: 900, epoch: 5 | loss: 0.9160715
	speed: 0.0197s/iter; left time: 117.3109s
	iters: 1000, epoch: 5 | loss: 0.3039631
	speed: 0.0197s/iter; left time: 115.3326s
	iters: 1100, epoch: 5 | loss: 0.8753455
	speed: 0.0197s/iter; left time: 113.4729s
Epoch: 5 cost time: 22.642908811569214
Epoch: 5, Steps: 1144 | Train Loss: 0.4863428 Vali Loss: 0.5042920 Test Loss: 0.2230885
Validation loss decreased (0.505463 --> 0.504292).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3809595
	speed: 0.0221s/iter; left time: 124.1533s
	iters: 200, epoch: 6 | loss: 0.4203397
	speed: 0.0214s/iter; left time: 117.9780s
	iters: 300, epoch: 6 | loss: 0.3600263
	speed: 0.0218s/iter; left time: 118.2232s
	iters: 400, epoch: 6 | loss: 0.5411773
	speed: 0.0220s/iter; left time: 117.2129s
	iters: 500, epoch: 6 | loss: 0.3858066
	speed: 0.0222s/iter; left time: 115.7037s
	iters: 600, epoch: 6 | loss: 0.3609980
	speed: 0.0223s/iter; left time: 113.9770s
	iters: 700, epoch: 6 | loss: 0.3513225
	speed: 0.0223s/iter; left time: 112.0618s
	iters: 800, epoch: 6 | loss: 0.4404538
	speed: 0.0224s/iter; left time: 110.0556s
	iters: 900, epoch: 6 | loss: 0.5018905
	speed: 0.0223s/iter; left time: 107.6923s
	iters: 1000, epoch: 6 | loss: 0.7795044
	speed: 0.0221s/iter; left time: 104.2425s
	iters: 1100, epoch: 6 | loss: 0.3267486
	speed: 0.0219s/iter; left time: 101.1317s
Epoch: 6 cost time: 25.069412231445312
Epoch: 6, Steps: 1144 | Train Loss: 0.4827967 Vali Loss: 0.5107280 Test Loss: 0.2241119
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3570101
	speed: 0.0215s/iter; left time: 96.3128s
	iters: 200, epoch: 7 | loss: 0.4129758
	speed: 0.0209s/iter; left time: 91.5665s
	iters: 300, epoch: 7 | loss: 0.3171281
	speed: 0.0215s/iter; left time: 91.9517s
	iters: 400, epoch: 7 | loss: 0.3870765
	speed: 0.0218s/iter; left time: 91.0233s
	iters: 500, epoch: 7 | loss: 0.4495406
	speed: 0.0220s/iter; left time: 89.5536s
	iters: 600, epoch: 7 | loss: 0.3727054
	speed: 0.0221s/iter; left time: 87.8483s
	iters: 700, epoch: 7 | loss: 0.3749184
	speed: 0.0222s/iter; left time: 85.9587s
	iters: 800, epoch: 7 | loss: 0.4696565
	speed: 0.0222s/iter; left time: 83.9731s
	iters: 900, epoch: 7 | loss: 0.4923949
	speed: 0.0222s/iter; left time: 81.8117s
	iters: 1000, epoch: 7 | loss: 0.9655519
	speed: 0.0221s/iter; left time: 78.9145s
	iters: 1100, epoch: 7 | loss: 0.3833379
	speed: 0.0219s/iter; left time: 76.0419s
Epoch: 7 cost time: 25.044302225112915
Epoch: 7, Steps: 1144 | Train Loss: 0.4811569 Vali Loss: 0.5054256 Test Loss: 0.2227852
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3704690
	speed: 0.0217s/iter; left time: 72.2763s
	iters: 200, epoch: 8 | loss: 0.7892262
	speed: 0.0209s/iter; left time: 67.6926s
	iters: 300, epoch: 8 | loss: 0.3737229
	speed: 0.0215s/iter; left time: 67.3636s
	iters: 400, epoch: 8 | loss: 0.4236799
	speed: 0.0210s/iter; left time: 63.6631s
	iters: 500, epoch: 8 | loss: 0.3148330
	speed: 0.0203s/iter; left time: 59.5274s
	iters: 600, epoch: 8 | loss: 0.5011765
	speed: 0.0198s/iter; left time: 56.1552s
	iters: 700, epoch: 8 | loss: 0.8739024
	speed: 0.0195s/iter; left time: 53.2163s
	iters: 800, epoch: 8 | loss: 0.4314686
	speed: 0.0192s/iter; left time: 50.5920s
	iters: 900, epoch: 8 | loss: 0.3953355
	speed: 0.0194s/iter; left time: 49.0990s
	iters: 1000, epoch: 8 | loss: 0.4893194
	speed: 0.0194s/iter; left time: 47.2559s
	iters: 1100, epoch: 8 | loss: 0.8669060
	speed: 0.0194s/iter; left time: 45.3640s
Epoch: 8 cost time: 22.38592267036438
Epoch: 8, Steps: 1144 | Train Loss: 0.4803288 Vali Loss: 0.5067170 Test Loss: 0.2228302
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4153751
	speed: 0.0222s/iter; left time: 48.5726s
	iters: 200, epoch: 9 | loss: 0.3400325
	speed: 0.0206s/iter; left time: 43.1348s
	iters: 300, epoch: 9 | loss: 0.4030454
	speed: 0.0203s/iter; left time: 40.4594s
	iters: 400, epoch: 9 | loss: 0.3488218
	speed: 0.0199s/iter; left time: 37.6609s
	iters: 500, epoch: 9 | loss: 0.3996474
	speed: 0.0205s/iter; left time: 36.6560s
	iters: 600, epoch: 9 | loss: 0.7946005
	speed: 0.0209s/iter; left time: 35.2355s
	iters: 700, epoch: 9 | loss: 0.4697415
	speed: 0.0211s/iter; left time: 33.5732s
	iters: 800, epoch: 9 | loss: 0.3829328
	speed: 0.0213s/iter; left time: 31.7525s
	iters: 900, epoch: 9 | loss: 0.4462227
	speed: 0.0215s/iter; left time: 29.8356s
	iters: 1000, epoch: 9 | loss: 0.3877205
	speed: 0.0213s/iter; left time: 27.4633s
	iters: 1100, epoch: 9 | loss: 0.3780192
	speed: 0.0212s/iter; left time: 25.1750s
Epoch: 9 cost time: 24.304672479629517
Epoch: 9, Steps: 1144 | Train Loss: 0.4796643 Vali Loss: 0.5058935 Test Loss: 0.2226205
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.4158944
	speed: 0.0241s/iter; left time: 25.1960s
	iters: 200, epoch: 10 | loss: 0.3546945
	speed: 0.0217s/iter; left time: 20.5197s
	iters: 300, epoch: 10 | loss: 0.3573765
	speed: 0.0210s/iter; left time: 17.7714s
	iters: 400, epoch: 10 | loss: 0.3631630
	speed: 0.0207s/iter; left time: 15.4085s
	iters: 500, epoch: 10 | loss: 0.3676836
	speed: 0.0211s/iter; left time: 13.6006s
	iters: 600, epoch: 10 | loss: 0.4133353
	speed: 0.0214s/iter; left time: 11.6381s
	iters: 700, epoch: 10 | loss: 0.7934388
	speed: 0.0216s/iter; left time: 9.5910s
	iters: 800, epoch: 10 | loss: 0.3929281
	speed: 0.0217s/iter; left time: 7.4849s
	iters: 900, epoch: 10 | loss: 0.4176104
	speed: 0.0218s/iter; left time: 5.3439s
	iters: 1000, epoch: 10 | loss: 0.3252507
	speed: 0.0216s/iter; left time: 3.1371s
	iters: 1100, epoch: 10 | loss: 0.5772167
	speed: 0.0215s/iter; left time: 0.9656s
Epoch: 10 cost time: 24.623022079467773
Epoch: 10, Steps: 1144 | Train Loss: 0.4795208 Vali Loss: 0.5058697 Test Loss: 0.2227870
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.2230886071920395, mae:0.2559991180896759
Seed: 456
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_336      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.5674533
	speed: 0.0300s/iter; left time: 339.2354s
	iters: 200, epoch: 1 | loss: 0.8503105
	speed: 0.0229s/iter; left time: 256.9991s
	iters: 300, epoch: 1 | loss: 0.5286249
	speed: 0.0202s/iter; left time: 224.1091s
	iters: 400, epoch: 1 | loss: 0.3988252
	speed: 0.0189s/iter; left time: 207.4580s
	iters: 500, epoch: 1 | loss: 0.4904335
	speed: 0.0185s/iter; left time: 201.6524s
	iters: 600, epoch: 1 | loss: 0.5325177
	speed: 0.0192s/iter; left time: 207.7535s
	iters: 700, epoch: 1 | loss: 0.5684758
	speed: 0.0198s/iter; left time: 211.4535s
	iters: 800, epoch: 1 | loss: 0.5243676
	speed: 0.0202s/iter; left time: 213.6959s
	iters: 900, epoch: 1 | loss: 0.6045109
	speed: 0.0202s/iter; left time: 211.7963s
	iters: 1000, epoch: 1 | loss: 0.4927945
	speed: 0.0201s/iter; left time: 208.9562s
	iters: 1100, epoch: 1 | loss: 0.5817871
	speed: 0.0201s/iter; left time: 206.6053s
Epoch: 1 cost time: 22.875813722610474
Epoch: 1, Steps: 1140 | Train Loss: 0.6340693 Vali Loss: 0.6129233 Test Loss: 0.2874652
Validation loss decreased (inf --> 0.612923).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8644253
	speed: 0.0249s/iter; left time: 253.3646s
	iters: 200, epoch: 2 | loss: 0.8300343
	speed: 0.0238s/iter; left time: 239.7094s
	iters: 300, epoch: 2 | loss: 0.7576859
	speed: 0.0226s/iter; left time: 224.7406s
	iters: 400, epoch: 2 | loss: 0.5184867
	speed: 0.0219s/iter; left time: 215.4943s
	iters: 500, epoch: 2 | loss: 0.5353143
	speed: 0.0215s/iter; left time: 209.6371s
	iters: 600, epoch: 2 | loss: 0.5125470
	speed: 0.0216s/iter; left time: 208.6666s
	iters: 700, epoch: 2 | loss: 0.4740522
	speed: 0.0218s/iter; left time: 208.4939s
	iters: 800, epoch: 2 | loss: 0.4126363
	speed: 0.0220s/iter; left time: 207.9514s
	iters: 900, epoch: 2 | loss: 0.4373436
	speed: 0.0219s/iter; left time: 205.0257s
	iters: 1000, epoch: 2 | loss: 0.8912950
	speed: 0.0217s/iter; left time: 200.5231s
	iters: 1100, epoch: 2 | loss: 0.5618157
	speed: 0.0215s/iter; left time: 196.7807s
Epoch: 2 cost time: 24.49655795097351
Epoch: 2, Steps: 1140 | Train Loss: 0.5919421 Vali Loss: 0.6223824 Test Loss: 0.2888508
EarlyStopping counter: 1 out of 5
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4907291
	speed: 0.0247s/iter; left time: 223.0395s
	iters: 200, epoch: 3 | loss: 0.5545183
	speed: 0.0238s/iter; left time: 212.0043s
	iters: 300, epoch: 3 | loss: 0.4694300
	speed: 0.0226s/iter; left time: 199.5091s
	iters: 400, epoch: 3 | loss: 0.4981528
	speed: 0.0219s/iter; left time: 191.1284s
	iters: 500, epoch: 3 | loss: 0.5353472
	speed: 0.0215s/iter; left time: 185.6540s
	iters: 600, epoch: 3 | loss: 0.4791808
	speed: 0.0216s/iter; left time: 183.9675s
	iters: 700, epoch: 3 | loss: 0.4400396
	speed: 0.0218s/iter; left time: 183.2053s
	iters: 800, epoch: 3 | loss: 0.4083031
	speed: 0.0219s/iter; left time: 182.0627s
	iters: 900, epoch: 3 | loss: 0.4466744
	speed: 0.0218s/iter; left time: 179.4742s
	iters: 1000, epoch: 3 | loss: 0.4893378
	speed: 0.0216s/iter; left time: 175.3725s
	iters: 1100, epoch: 3 | loss: 0.5597102
	speed: 0.0214s/iter; left time: 171.9823s
Epoch: 3 cost time: 24.504469871520996
Epoch: 3, Steps: 1140 | Train Loss: 0.5716669 Vali Loss: 0.6143094 Test Loss: 0.2833215
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4243261
	speed: 0.0247s/iter; left time: 194.6124s
	iters: 200, epoch: 4 | loss: 0.5264079
	speed: 0.0237s/iter; left time: 184.3318s
	iters: 300, epoch: 4 | loss: 0.4786601
	speed: 0.0226s/iter; left time: 173.4155s
	iters: 400, epoch: 4 | loss: 0.7859353
	speed: 0.0213s/iter; left time: 161.7828s
	iters: 500, epoch: 4 | loss: 0.4597647
	speed: 0.0201s/iter; left time: 150.3715s
	iters: 600, epoch: 4 | loss: 0.5532373
	speed: 0.0191s/iter; left time: 140.7645s
	iters: 700, epoch: 4 | loss: 0.7484445
	speed: 0.0185s/iter; left time: 134.7327s
	iters: 800, epoch: 4 | loss: 0.5158631
	speed: 0.0178s/iter; left time: 128.1474s
	iters: 900, epoch: 4 | loss: 0.4363155
	speed: 0.0172s/iter; left time: 121.7772s
	iters: 1000, epoch: 4 | loss: 0.7965372
	speed: 0.0167s/iter; left time: 116.3317s
	iters: 1100, epoch: 4 | loss: 0.4567460
	speed: 0.0161s/iter; left time: 110.6325s
Epoch: 4 cost time: 18.045329570770264
Epoch: 4, Steps: 1140 | Train Loss: 0.5603250 Vali Loss: 0.6050716 Test Loss: 0.2820984
Validation loss decreased (0.612923 --> 0.605072).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 1.4814951
	speed: 0.0148s/iter; left time: 100.0362s
	iters: 200, epoch: 5 | loss: 0.4517780
	speed: 0.0146s/iter; left time: 97.2846s
	iters: 300, epoch: 5 | loss: 0.4385003
	speed: 0.0159s/iter; left time: 103.7631s
	iters: 400, epoch: 5 | loss: 0.4212891
	speed: 0.0176s/iter; left time: 113.3431s
	iters: 500, epoch: 5 | loss: 0.4584636
	speed: 0.0186s/iter; left time: 118.2131s
	iters: 600, epoch: 5 | loss: 0.7754070
	speed: 0.0193s/iter; left time: 120.7016s
	iters: 700, epoch: 5 | loss: 0.4848623
	speed: 0.0198s/iter; left time: 121.8053s
	iters: 800, epoch: 5 | loss: 0.3741506
	speed: 0.0202s/iter; left time: 122.0755s
	iters: 900, epoch: 5 | loss: 0.4987788
	speed: 0.0204s/iter; left time: 120.9286s
	iters: 1000, epoch: 5 | loss: 0.5239765
	speed: 0.0202s/iter; left time: 118.2752s
	iters: 1100, epoch: 5 | loss: 0.4051978
	speed: 0.0202s/iter; left time: 116.0064s
Epoch: 5 cost time: 23.155991315841675
Epoch: 5, Steps: 1140 | Train Loss: 0.5537437 Vali Loss: 0.6073924 Test Loss: 0.2813583
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4398735
	speed: 0.0221s/iter; left time: 123.8535s
	iters: 200, epoch: 6 | loss: 0.7699446
	speed: 0.0222s/iter; left time: 122.3058s
	iters: 300, epoch: 6 | loss: 0.6690453
	speed: 0.0224s/iter; left time: 121.1165s
	iters: 400, epoch: 6 | loss: 0.5181471
	speed: 0.0226s/iter; left time: 119.5766s
	iters: 500, epoch: 6 | loss: 0.4706837
	speed: 0.0226s/iter; left time: 117.6251s
	iters: 600, epoch: 6 | loss: 0.8024920
	speed: 0.0226s/iter; left time: 115.5298s
	iters: 700, epoch: 6 | loss: 0.4744873
	speed: 0.0227s/iter; left time: 113.3775s
	iters: 800, epoch: 6 | loss: 0.5002076
	speed: 0.0227s/iter; left time: 111.2210s
	iters: 900, epoch: 6 | loss: 0.4317448
	speed: 0.0226s/iter; left time: 108.2784s
	iters: 1000, epoch: 6 | loss: 0.5571773
	speed: 0.0223s/iter; left time: 104.6442s
	iters: 1100, epoch: 6 | loss: 0.3818393
	speed: 0.0221s/iter; left time: 101.4566s
Epoch: 6 cost time: 25.18272376060486
Epoch: 6, Steps: 1140 | Train Loss: 0.5501534 Vali Loss: 0.6064070 Test Loss: 0.2810958
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8909134
	speed: 0.0217s/iter; left time: 96.6268s
	iters: 200, epoch: 7 | loss: 0.4120578
	speed: 0.0220s/iter; left time: 96.0028s
	iters: 300, epoch: 7 | loss: 0.5151480
	speed: 0.0223s/iter; left time: 94.9300s
	iters: 400, epoch: 7 | loss: 0.4649987
	speed: 0.0224s/iter; left time: 93.2807s
	iters: 500, epoch: 7 | loss: 0.4744099
	speed: 0.0225s/iter; left time: 91.3807s
	iters: 600, epoch: 7 | loss: 0.4813071
	speed: 0.0226s/iter; left time: 89.3341s
	iters: 700, epoch: 7 | loss: 0.4386025
	speed: 0.0226s/iter; left time: 87.2310s
	iters: 800, epoch: 7 | loss: 0.4691401
	speed: 0.0226s/iter; left time: 85.0883s
	iters: 900, epoch: 7 | loss: 0.4078492
	speed: 0.0225s/iter; left time: 82.3311s
	iters: 1000, epoch: 7 | loss: 0.4597208
	speed: 0.0222s/iter; left time: 79.0201s
	iters: 1100, epoch: 7 | loss: 0.4042736
	speed: 0.0220s/iter; left time: 76.0661s
Epoch: 7 cost time: 25.10026717185974
Epoch: 7, Steps: 1140 | Train Loss: 0.5483647 Vali Loss: 0.6061360 Test Loss: 0.2814156
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 1.2067554
	speed: 0.0219s/iter; left time: 72.6363s
	iters: 200, epoch: 8 | loss: 0.6230994
	speed: 0.0207s/iter; left time: 66.7042s
	iters: 300, epoch: 8 | loss: 0.4951787
	speed: 0.0197s/iter; left time: 61.3732s
	iters: 400, epoch: 8 | loss: 0.4956369
	speed: 0.0191s/iter; left time: 57.7210s
	iters: 500, epoch: 8 | loss: 0.5290852
	speed: 0.0188s/iter; left time: 54.8890s
	iters: 600, epoch: 8 | loss: 0.3982216
	speed: 0.0186s/iter; left time: 52.4085s
	iters: 700, epoch: 8 | loss: 0.4557132
	speed: 0.0182s/iter; left time: 49.5538s
	iters: 800, epoch: 8 | loss: 0.6835373
	speed: 0.0184s/iter; left time: 48.2059s
	iters: 900, epoch: 8 | loss: 0.5228108
	speed: 0.0187s/iter; left time: 47.2292s
	iters: 1000, epoch: 8 | loss: 0.4764420
	speed: 0.0188s/iter; left time: 45.5359s
	iters: 1100, epoch: 8 | loss: 0.3370170
	speed: 0.0189s/iter; left time: 43.8303s
Epoch: 8 cost time: 21.685762643814087
Epoch: 8, Steps: 1140 | Train Loss: 0.5473387 Vali Loss: 0.6089366 Test Loss: 0.2816756
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4272121
	speed: 0.0190s/iter; left time: 41.3960s
	iters: 200, epoch: 9 | loss: 0.4261857
	speed: 0.0183s/iter; left time: 38.1836s
	iters: 300, epoch: 9 | loss: 0.6826386
	speed: 0.0181s/iter; left time: 35.8440s
	iters: 400, epoch: 9 | loss: 0.8932289
	speed: 0.0186s/iter; left time: 35.0609s
	iters: 500, epoch: 9 | loss: 0.5101192
	speed: 0.0195s/iter; left time: 34.7030s
	iters: 600, epoch: 9 | loss: 0.4893745
	speed: 0.0200s/iter; left time: 33.6800s
	iters: 700, epoch: 9 | loss: 0.5256951
	speed: 0.0204s/iter; left time: 32.3020s
	iters: 800, epoch: 9 | loss: 0.4991435
	speed: 0.0207s/iter; left time: 30.7073s
	iters: 900, epoch: 9 | loss: 0.4208670
	speed: 0.0210s/iter; left time: 28.9527s
	iters: 1000, epoch: 9 | loss: 0.4822705
	speed: 0.0211s/iter; left time: 27.0921s
	iters: 1100, epoch: 9 | loss: 0.4307667
	speed: 0.0213s/iter; left time: 25.1592s
Epoch: 9 cost time: 24.460609436035156
Epoch: 9, Steps: 1140 | Train Loss: 0.5467204 Vali Loss: 0.6056907 Test Loss: 0.2813435
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.28209835290908813, mae:0.30025023221969604
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.6130602
	speed: 0.0220s/iter; left time: 249.0663s
	iters: 200, epoch: 1 | loss: 0.7895547
	speed: 0.0212s/iter; left time: 237.0457s
	iters: 300, epoch: 1 | loss: 0.4980589
	speed: 0.0218s/iter; left time: 242.2221s
	iters: 400, epoch: 1 | loss: 0.5601091
	speed: 0.0222s/iter; left time: 243.9082s
	iters: 500, epoch: 1 | loss: 0.8673767
	speed: 0.0224s/iter; left time: 243.8599s
	iters: 600, epoch: 1 | loss: 0.7201614
	speed: 0.0225s/iter; left time: 243.0496s
	iters: 700, epoch: 1 | loss: 0.5417879
	speed: 0.0226s/iter; left time: 241.6552s
	iters: 800, epoch: 1 | loss: 0.4753645
	speed: 0.0227s/iter; left time: 240.2467s
	iters: 900, epoch: 1 | loss: 0.4502270
	speed: 0.0227s/iter; left time: 238.5213s
	iters: 1000, epoch: 1 | loss: 0.5075561
	speed: 0.0227s/iter; left time: 236.5503s
	iters: 1100, epoch: 1 | loss: 0.7512838
	speed: 0.0225s/iter; left time: 231.7342s
Epoch: 1 cost time: 25.613644123077393
Epoch: 1, Steps: 1140 | Train Loss: 0.6315135 Vali Loss: 0.5981545 Test Loss: 0.2839002
Validation loss decreased (inf --> 0.598154).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5278172
	speed: 0.0220s/iter; left time: 223.1449s
	iters: 200, epoch: 2 | loss: 0.5009910
	speed: 0.0209s/iter; left time: 210.4403s
	iters: 300, epoch: 2 | loss: 0.6244876
	speed: 0.0206s/iter; left time: 205.1950s
	iters: 400, epoch: 2 | loss: 0.5293206
	speed: 0.0199s/iter; left time: 195.8196s
	iters: 500, epoch: 2 | loss: 0.5042262
	speed: 0.0194s/iter; left time: 189.8098s
	iters: 600, epoch: 2 | loss: 0.6212971
	speed: 0.0191s/iter; left time: 184.7643s
	iters: 700, epoch: 2 | loss: 0.7662839
	speed: 0.0189s/iter; left time: 180.7871s
	iters: 800, epoch: 2 | loss: 0.4765830
	speed: 0.0192s/iter; left time: 181.4711s
	iters: 900, epoch: 2 | loss: 0.7371803
	speed: 0.0196s/iter; left time: 183.6563s
	iters: 1000, epoch: 2 | loss: 0.6074545
	speed: 0.0200s/iter; left time: 184.9559s
	iters: 1100, epoch: 2 | loss: 0.5256171
	speed: 0.0200s/iter; left time: 183.0142s
Epoch: 2 cost time: 22.786678075790405
Epoch: 2, Steps: 1140 | Train Loss: 0.5953401 Vali Loss: 0.5983419 Test Loss: 0.2833439
EarlyStopping counter: 1 out of 5
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4983666
	speed: 0.0222s/iter; left time: 200.3050s
	iters: 200, epoch: 3 | loss: 0.5210872
	speed: 0.0208s/iter; left time: 185.2207s
	iters: 300, epoch: 3 | loss: 0.4879563
	speed: 0.0214s/iter; left time: 189.1891s
	iters: 400, epoch: 3 | loss: 0.5001722
	speed: 0.0218s/iter; left time: 190.1384s
	iters: 500, epoch: 3 | loss: 0.4596629
	speed: 0.0220s/iter; left time: 189.7163s
	iters: 600, epoch: 3 | loss: 0.7991625
	speed: 0.0221s/iter; left time: 188.6998s
	iters: 700, epoch: 3 | loss: 0.4809338
	speed: 0.0222s/iter; left time: 187.3502s
	iters: 800, epoch: 3 | loss: 0.8128716
	speed: 0.0223s/iter; left time: 185.7252s
	iters: 900, epoch: 3 | loss: 0.4442122
	speed: 0.0224s/iter; left time: 183.9475s
	iters: 1000, epoch: 3 | loss: 0.5507640
	speed: 0.0224s/iter; left time: 182.1039s
	iters: 1100, epoch: 3 | loss: 0.7119096
	speed: 0.0222s/iter; left time: 178.0521s
Epoch: 3 cost time: 25.2725567817688
Epoch: 3, Steps: 1140 | Train Loss: 0.5758319 Vali Loss: 0.5996587 Test Loss: 0.2831866
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6636227
	speed: 0.0225s/iter; left time: 176.9352s
	iters: 200, epoch: 4 | loss: 0.3969842
	speed: 0.0210s/iter; left time: 163.5673s
	iters: 300, epoch: 4 | loss: 0.4589437
	speed: 0.0217s/iter; left time: 166.7353s
	iters: 400, epoch: 4 | loss: 0.5076283
	speed: 0.0221s/iter; left time: 167.3815s
	iters: 500, epoch: 4 | loss: 0.5979104
	speed: 0.0223s/iter; left time: 166.6164s
	iters: 600, epoch: 4 | loss: 0.6568434
	speed: 0.0224s/iter; left time: 165.0889s
	iters: 700, epoch: 4 | loss: 1.1301568
	speed: 0.0224s/iter; left time: 163.3279s
	iters: 800, epoch: 4 | loss: 0.5120190
	speed: 0.0225s/iter; left time: 161.4524s
	iters: 900, epoch: 4 | loss: 0.4667701
	speed: 0.0225s/iter; left time: 159.4893s
	iters: 1000, epoch: 4 | loss: 0.4869518
	speed: 0.0225s/iter; left time: 157.1234s
	iters: 1100, epoch: 4 | loss: 0.5229309
	speed: 0.0222s/iter; left time: 153.0881s
Epoch: 4 cost time: 25.38536286354065
Epoch: 4, Steps: 1140 | Train Loss: 0.5648628 Vali Loss: 0.5965813 Test Loss: 0.2814023
Validation loss decreased (0.598154 --> 0.596581).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.7846739
	speed: 0.0224s/iter; left time: 150.8277s
	iters: 200, epoch: 5 | loss: 0.8732492
	speed: 0.0210s/iter; left time: 139.6926s
	iters: 300, epoch: 5 | loss: 0.4213418
	speed: 0.0216s/iter; left time: 141.4714s
	iters: 400, epoch: 5 | loss: 0.4547685
	speed: 0.0219s/iter; left time: 141.2296s
	iters: 500, epoch: 5 | loss: 0.4871078
	speed: 0.0221s/iter; left time: 140.3700s
	iters: 600, epoch: 5 | loss: 0.7817353
	speed: 0.0219s/iter; left time: 136.8829s
	iters: 700, epoch: 5 | loss: 0.6646761
	speed: 0.0213s/iter; left time: 130.8108s
	iters: 800, epoch: 5 | loss: 1.0079472
	speed: 0.0209s/iter; left time: 126.1346s
	iters: 900, epoch: 5 | loss: 0.4255278
	speed: 0.0205s/iter; left time: 121.8612s
	iters: 1000, epoch: 5 | loss: 0.4927970
	speed: 0.0202s/iter; left time: 117.9518s
	iters: 1100, epoch: 5 | loss: 0.5341696
	speed: 0.0200s/iter; left time: 114.6020s
Epoch: 5 cost time: 22.82093119621277
Epoch: 5, Steps: 1140 | Train Loss: 0.5578998 Vali Loss: 0.5966434 Test Loss: 0.2819009
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5870887
	speed: 0.0190s/iter; left time: 106.3574s
	iters: 200, epoch: 6 | loss: 0.3878269
	speed: 0.0193s/iter; left time: 106.3079s
	iters: 300, epoch: 6 | loss: 0.7526669
	speed: 0.0206s/iter; left time: 111.2240s
	iters: 400, epoch: 6 | loss: 0.7093709
	speed: 0.0212s/iter; left time: 112.4740s
	iters: 500, epoch: 6 | loss: 0.5299264
	speed: 0.0216s/iter; left time: 112.3260s
	iters: 600, epoch: 6 | loss: 0.4685613
	speed: 0.0219s/iter; left time: 111.5359s
	iters: 700, epoch: 6 | loss: 0.4245765
	speed: 0.0220s/iter; left time: 110.2660s
	iters: 800, epoch: 6 | loss: 0.4077271
	speed: 0.0222s/iter; left time: 108.7524s
	iters: 900, epoch: 6 | loss: 0.4821135
	speed: 0.0223s/iter; left time: 107.0710s
	iters: 1000, epoch: 6 | loss: 0.3781090
	speed: 0.0224s/iter; left time: 105.2958s
	iters: 1100, epoch: 6 | loss: 0.4216950
	speed: 0.0225s/iter; left time: 103.3617s
Epoch: 6 cost time: 25.75273370742798
Epoch: 6, Steps: 1140 | Train Loss: 0.5539800 Vali Loss: 0.5987532 Test Loss: 0.2819685
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3827142
	speed: 0.0202s/iter; left time: 90.1978s
	iters: 200, epoch: 7 | loss: 0.4336649
	speed: 0.0199s/iter; left time: 86.8370s
	iters: 300, epoch: 7 | loss: 0.4978391
	speed: 0.0210s/iter; left time: 89.3334s
	iters: 400, epoch: 7 | loss: 0.4862769
	speed: 0.0215s/iter; left time: 89.5822s
	iters: 500, epoch: 7 | loss: 0.4330065
	speed: 0.0219s/iter; left time: 88.7552s
	iters: 600, epoch: 7 | loss: 0.5052373
	speed: 0.0221s/iter; left time: 87.3822s
	iters: 700, epoch: 7 | loss: 0.4230828
	speed: 0.0222s/iter; left time: 85.8290s
	iters: 800, epoch: 7 | loss: 0.9830773
	speed: 0.0223s/iter; left time: 84.0046s
	iters: 900, epoch: 7 | loss: 0.7753299
	speed: 0.0224s/iter; left time: 82.1468s
	iters: 1000, epoch: 7 | loss: 0.8378735
	speed: 0.0225s/iter; left time: 80.1994s
	iters: 1100, epoch: 7 | loss: 0.5187796
	speed: 0.0226s/iter; left time: 78.1466s
Epoch: 7 cost time: 25.880776405334473
Epoch: 7, Steps: 1140 | Train Loss: 0.5523577 Vali Loss: 0.5963177 Test Loss: 0.2812573
Validation loss decreased (0.596581 --> 0.596318).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.7113403
	speed: 0.0197s/iter; left time: 65.3528s
	iters: 200, epoch: 8 | loss: 0.4879379
	speed: 0.0198s/iter; left time: 63.7058s
	iters: 300, epoch: 8 | loss: 0.4119533
	speed: 0.0208s/iter; left time: 64.8984s
	iters: 400, epoch: 8 | loss: 0.4239989
	speed: 0.0213s/iter; left time: 64.3523s
	iters: 500, epoch: 8 | loss: 0.7638243
	speed: 0.0216s/iter; left time: 63.2116s
	iters: 600, epoch: 8 | loss: 0.4585526
	speed: 0.0218s/iter; left time: 61.6177s
	iters: 700, epoch: 8 | loss: 0.4162518
	speed: 0.0220s/iter; left time: 59.8113s
	iters: 800, epoch: 8 | loss: 0.4072310
	speed: 0.0220s/iter; left time: 57.7929s
	iters: 900, epoch: 8 | loss: 0.7295120
	speed: 0.0216s/iter; left time: 54.3573s
	iters: 1000, epoch: 8 | loss: 0.5348419
	speed: 0.0211s/iter; left time: 51.1793s
	iters: 1100, epoch: 8 | loss: 0.4105588
	speed: 0.0208s/iter; left time: 48.3839s
Epoch: 8 cost time: 23.75508427619934
Epoch: 8, Steps: 1140 | Train Loss: 0.5510832 Vali Loss: 0.5977753 Test Loss: 0.2817436
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4594981
	speed: 0.0197s/iter; left time: 42.8812s
	iters: 200, epoch: 9 | loss: 0.8271143
	speed: 0.0195s/iter; left time: 40.6600s
	iters: 300, epoch: 9 | loss: 0.5541462
	speed: 0.0198s/iter; left time: 39.1739s
	iters: 400, epoch: 9 | loss: 0.5064325
	speed: 0.0196s/iter; left time: 36.8691s
	iters: 500, epoch: 9 | loss: 0.5003566
	speed: 0.0203s/iter; left time: 36.0663s
	iters: 600, epoch: 9 | loss: 0.7873482
	speed: 0.0207s/iter; left time: 34.8014s
	iters: 700, epoch: 9 | loss: 0.5867271
	speed: 0.0210s/iter; left time: 33.2088s
	iters: 800, epoch: 9 | loss: 0.5225344
	speed: 0.0212s/iter; left time: 31.4521s
	iters: 900, epoch: 9 | loss: 0.5385208
	speed: 0.0214s/iter; left time: 29.5694s
	iters: 1000, epoch: 9 | loss: 0.4824466
	speed: 0.0216s/iter; left time: 27.6091s
	iters: 1100, epoch: 9 | loss: 0.4910230
	speed: 0.0217s/iter; left time: 25.5949s
Epoch: 9 cost time: 24.841562747955322
Epoch: 9, Steps: 1140 | Train Loss: 0.5505592 Vali Loss: 0.5968632 Test Loss: 0.2817252
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.4306637
	speed: 0.0214s/iter; left time: 22.3045s
	iters: 200, epoch: 10 | loss: 0.7203253
	speed: 0.0204s/iter; left time: 19.1931s
	iters: 300, epoch: 10 | loss: 0.8524805
	speed: 0.0202s/iter; left time: 16.9593s
	iters: 400, epoch: 10 | loss: 0.5079433
	speed: 0.0201s/iter; left time: 14.8884s
	iters: 500, epoch: 10 | loss: 0.8135406
	speed: 0.0206s/iter; left time: 13.2280s
	iters: 600, epoch: 10 | loss: 0.4993989
	speed: 0.0210s/iter; left time: 11.3550s
	iters: 700, epoch: 10 | loss: 0.4133695
	speed: 0.0213s/iter; left time: 9.3742s
	iters: 800, epoch: 10 | loss: 1.0032486
	speed: 0.0215s/iter; left time: 7.3155s
	iters: 900, epoch: 10 | loss: 0.4845771
	speed: 0.0216s/iter; left time: 5.2069s
	iters: 1000, epoch: 10 | loss: 0.7598572
	speed: 0.0217s/iter; left time: 3.0640s
	iters: 1100, epoch: 10 | loss: 0.5032141
	speed: 0.0218s/iter; left time: 0.8950s
Epoch: 10 cost time: 25.047749757766724
Epoch: 10, Steps: 1140 | Train Loss: 0.5504775 Vali Loss: 0.5996296 Test Loss: 0.2817722
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.28125718235969543, mae:0.29913660883903503
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.5145973
	speed: 0.0220s/iter; left time: 248.0850s
	iters: 200, epoch: 1 | loss: 0.5399540
	speed: 0.0211s/iter; left time: 236.1727s
	iters: 300, epoch: 1 | loss: 0.5552903
	speed: 0.0217s/iter; left time: 240.5442s
	iters: 400, epoch: 1 | loss: 0.6735672
	speed: 0.0220s/iter; left time: 241.5610s
	iters: 500, epoch: 1 | loss: 0.5677929
	speed: 0.0222s/iter; left time: 241.6160s
	iters: 600, epoch: 1 | loss: 0.6370704
	speed: 0.0223s/iter; left time: 241.2092s
	iters: 700, epoch: 1 | loss: 0.7651145
	speed: 0.0225s/iter; left time: 240.3328s
	iters: 800, epoch: 1 | loss: 0.7775362
	speed: 0.0225s/iter; left time: 239.0260s
	iters: 900, epoch: 1 | loss: 0.6375430
	speed: 0.0225s/iter; left time: 235.8156s
	iters: 1000, epoch: 1 | loss: 0.5609657
	speed: 0.0220s/iter; left time: 228.7710s
	iters: 1100, epoch: 1 | loss: 0.6036621
	speed: 0.0213s/iter; left time: 219.2301s
Epoch: 1 cost time: 24.05123996734619
Epoch: 1, Steps: 1140 | Train Loss: 0.6373824 Vali Loss: 0.6193506 Test Loss: 0.2897059
Validation loss decreased (inf --> 0.619351).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5960490
	speed: 0.0220s/iter; left time: 223.8734s
	iters: 200, epoch: 2 | loss: 0.7280327
	speed: 0.0214s/iter; left time: 215.0993s
	iters: 300, epoch: 2 | loss: 0.5166255
	speed: 0.0219s/iter; left time: 217.7725s
	iters: 400, epoch: 2 | loss: 0.4821526
	speed: 0.0221s/iter; left time: 218.0729s
	iters: 500, epoch: 2 | loss: 0.4434305
	speed: 0.0223s/iter; left time: 217.5356s
	iters: 600, epoch: 2 | loss: 0.7556298
	speed: 0.0224s/iter; left time: 216.1698s
	iters: 700, epoch: 2 | loss: 0.4965641
	speed: 0.0224s/iter; left time: 214.5779s
	iters: 800, epoch: 2 | loss: 0.8686398
	speed: 0.0225s/iter; left time: 212.8204s
	iters: 900, epoch: 2 | loss: 0.4793764
	speed: 0.0225s/iter; left time: 210.9146s
	iters: 1000, epoch: 2 | loss: 0.4925137
	speed: 0.0226s/iter; left time: 208.8998s
	iters: 1100, epoch: 2 | loss: 0.5324349
	speed: 0.0224s/iter; left time: 205.2091s
Epoch: 2 cost time: 25.546003818511963
Epoch: 2, Steps: 1140 | Train Loss: 0.5948204 Vali Loss: 0.6107992 Test Loss: 0.2829020
Validation loss decreased (0.619351 --> 0.610799).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4022145
	speed: 0.0223s/iter; left time: 200.9470s
	iters: 200, epoch: 3 | loss: 0.9375395
	speed: 0.0214s/iter; left time: 191.3066s
	iters: 300, epoch: 3 | loss: 0.4844915
	speed: 0.0219s/iter; left time: 193.2435s
	iters: 400, epoch: 3 | loss: 0.4628934
	speed: 0.0222s/iter; left time: 193.2841s
	iters: 500, epoch: 3 | loss: 0.7300237
	speed: 0.0223s/iter; left time: 192.4472s
	iters: 600, epoch: 3 | loss: 0.4164117
	speed: 0.0224s/iter; left time: 191.0012s
	iters: 700, epoch: 3 | loss: 0.5176433
	speed: 0.0225s/iter; left time: 189.2577s
	iters: 800, epoch: 3 | loss: 0.5331697
	speed: 0.0225s/iter; left time: 187.3760s
	iters: 900, epoch: 3 | loss: 0.8117806
	speed: 0.0226s/iter; left time: 185.4536s
	iters: 1000, epoch: 3 | loss: 0.4997006
	speed: 0.0226s/iter; left time: 183.4059s
	iters: 1100, epoch: 3 | loss: 0.4518206
	speed: 0.0224s/iter; left time: 179.7351s
Epoch: 3 cost time: 25.498367309570312
Epoch: 3, Steps: 1140 | Train Loss: 0.5768700 Vali Loss: 0.6025935 Test Loss: 0.2817611
Validation loss decreased (0.610799 --> 0.602593).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5417008
	speed: 0.0223s/iter; left time: 175.4091s
	iters: 200, epoch: 4 | loss: 0.4706659
	speed: 0.0215s/iter; left time: 167.1926s
	iters: 300, epoch: 4 | loss: 1.0060112
	speed: 0.0219s/iter; left time: 168.4779s
	iters: 400, epoch: 4 | loss: 0.5507249
	speed: 0.0222s/iter; left time: 167.9799s
	iters: 500, epoch: 4 | loss: 0.6703330
	speed: 0.0223s/iter; left time: 166.7733s
	iters: 600, epoch: 4 | loss: 0.8043638
	speed: 0.0224s/iter; left time: 165.1952s
	iters: 700, epoch: 4 | loss: 0.6619837
	speed: 0.0224s/iter; left time: 163.4192s
	iters: 800, epoch: 4 | loss: 0.7746634
	speed: 0.0225s/iter; left time: 161.5606s
	iters: 900, epoch: 4 | loss: 0.4740354
	speed: 0.0225s/iter; left time: 159.5668s
	iters: 1000, epoch: 4 | loss: 0.7730262
	speed: 0.0225s/iter; left time: 157.2951s
	iters: 1100, epoch: 4 | loss: 0.7929218
	speed: 0.0223s/iter; left time: 153.3197s
Epoch: 4 cost time: 25.43020272254944
Epoch: 4, Steps: 1140 | Train Loss: 0.5653841 Vali Loss: 0.6008776 Test Loss: 0.2807842
Validation loss decreased (0.602593 --> 0.600878).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5688411
	speed: 0.0171s/iter; left time: 115.1928s
	iters: 200, epoch: 5 | loss: 0.5767535
	speed: 0.0161s/iter; left time: 106.7543s
	iters: 300, epoch: 5 | loss: 0.6662730
	speed: 0.0171s/iter; left time: 111.6373s
	iters: 400, epoch: 5 | loss: 0.5807316
	speed: 0.0171s/iter; left time: 110.3106s
	iters: 500, epoch: 5 | loss: 0.3538900
	speed: 0.0173s/iter; left time: 109.4516s
	iters: 600, epoch: 5 | loss: 0.4154126
	speed: 0.0182s/iter; left time: 113.5154s
	iters: 700, epoch: 5 | loss: 0.6831248
	speed: 0.0189s/iter; left time: 115.7660s
	iters: 800, epoch: 5 | loss: 0.8046518
	speed: 0.0194s/iter; left time: 116.9056s
	iters: 900, epoch: 5 | loss: 0.4764289
	speed: 0.0197s/iter; left time: 117.2845s
	iters: 1000, epoch: 5 | loss: 0.4977736
	speed: 0.0199s/iter; left time: 116.3195s
	iters: 1100, epoch: 5 | loss: 0.6156481
	speed: 0.0199s/iter; left time: 114.2131s
Epoch: 5 cost time: 22.801039218902588
Epoch: 5, Steps: 1140 | Train Loss: 0.5585164 Vali Loss: 0.6045247 Test Loss: 0.2807329
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4663075
	speed: 0.0201s/iter; left time: 112.5992s
	iters: 200, epoch: 6 | loss: 0.8011503
	speed: 0.0202s/iter; left time: 111.3273s
	iters: 300, epoch: 6 | loss: 0.4635289
	speed: 0.0212s/iter; left time: 114.5522s
	iters: 400, epoch: 6 | loss: 0.6393053
	speed: 0.0217s/iter; left time: 115.0696s
	iters: 500, epoch: 6 | loss: 0.4266790
	speed: 0.0220s/iter; left time: 114.3462s
	iters: 600, epoch: 6 | loss: 0.4258013
	speed: 0.0222s/iter; left time: 113.0733s
	iters: 700, epoch: 6 | loss: 0.7489778
	speed: 0.0223s/iter; left time: 111.6022s
	iters: 800, epoch: 6 | loss: 0.3675949
	speed: 0.0224s/iter; left time: 109.9745s
	iters: 900, epoch: 6 | loss: 0.5021490
	speed: 0.0225s/iter; left time: 108.1590s
	iters: 1000, epoch: 6 | loss: 0.4978399
	speed: 0.0226s/iter; left time: 106.2712s
	iters: 1100, epoch: 6 | loss: 0.4922186
	speed: 0.0227s/iter; left time: 104.2362s
Epoch: 6 cost time: 25.983768939971924
Epoch: 6, Steps: 1140 | Train Loss: 0.5549647 Vali Loss: 0.6033932 Test Loss: 0.2814381
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4776023
	speed: 0.0199s/iter; left time: 88.5859s
	iters: 200, epoch: 7 | loss: 0.4573873
	speed: 0.0202s/iter; left time: 87.9994s
	iters: 300, epoch: 7 | loss: 0.4091186
	speed: 0.0211s/iter; left time: 89.7236s
	iters: 400, epoch: 7 | loss: 0.9638644
	speed: 0.0215s/iter; left time: 89.4439s
	iters: 500, epoch: 7 | loss: 0.5450681
	speed: 0.0218s/iter; left time: 88.3984s
	iters: 600, epoch: 7 | loss: 0.3968554
	speed: 0.0219s/iter; left time: 86.9119s
	iters: 700, epoch: 7 | loss: 0.4947960
	speed: 0.0221s/iter; left time: 85.2010s
	iters: 800, epoch: 7 | loss: 0.7055262
	speed: 0.0222s/iter; left time: 83.3650s
	iters: 900, epoch: 7 | loss: 0.4851249
	speed: 0.0222s/iter; left time: 81.4122s
	iters: 1000, epoch: 7 | loss: 0.5729269
	speed: 0.0223s/iter; left time: 79.3947s
	iters: 1100, epoch: 7 | loss: 0.4253062
	speed: 0.0223s/iter; left time: 77.3419s
Epoch: 7 cost time: 25.610708713531494
Epoch: 7, Steps: 1140 | Train Loss: 0.5532400 Vali Loss: 0.6021736 Test Loss: 0.2809100
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.5317317
	speed: 0.0199s/iter; left time: 66.1960s
	iters: 200, epoch: 8 | loss: 0.6261528
	speed: 0.0196s/iter; left time: 62.9893s
	iters: 300, epoch: 8 | loss: 1.0039122
	speed: 0.0188s/iter; left time: 58.6879s
	iters: 400, epoch: 8 | loss: 0.4821751
	speed: 0.0175s/iter; left time: 52.8671s
	iters: 500, epoch: 8 | loss: 0.4529691
	speed: 0.0172s/iter; left time: 50.1980s
	iters: 600, epoch: 8 | loss: 0.4700154
	speed: 0.0172s/iter; left time: 48.6527s
	iters: 700, epoch: 8 | loss: 0.5026885
	speed: 0.0173s/iter; left time: 47.0473s
	iters: 800, epoch: 8 | loss: 0.5234331
	speed: 0.0172s/iter; left time: 44.9967s
	iters: 900, epoch: 8 | loss: 0.4516474
	speed: 0.0173s/iter; left time: 43.7026s
	iters: 1000, epoch: 8 | loss: 0.5105967
	speed: 0.0179s/iter; left time: 43.3565s
	iters: 1100, epoch: 8 | loss: 0.5581780
	speed: 0.0184s/iter; left time: 42.6621s
Epoch: 8 cost time: 21.240447282791138
Epoch: 8, Steps: 1140 | Train Loss: 0.5523625 Vali Loss: 0.6031565 Test Loss: 0.2812639
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4863569
	speed: 0.0216s/iter; left time: 47.1330s
	iters: 200, epoch: 9 | loss: 0.7652211
	speed: 0.0209s/iter; left time: 43.5272s
	iters: 300, epoch: 9 | loss: 0.4828433
	speed: 0.0204s/iter; left time: 40.4209s
	iters: 400, epoch: 9 | loss: 0.4549360
	speed: 0.0202s/iter; left time: 38.0575s
	iters: 500, epoch: 9 | loss: 0.5488703
	speed: 0.0205s/iter; left time: 36.5323s
	iters: 600, epoch: 9 | loss: 0.7211799
	speed: 0.0209s/iter; left time: 35.1390s
	iters: 700, epoch: 9 | loss: 0.4146977
	speed: 0.0212s/iter; left time: 33.4803s
	iters: 800, epoch: 9 | loss: 0.5146951
	speed: 0.0214s/iter; left time: 31.6639s
	iters: 900, epoch: 9 | loss: 0.4294412
	speed: 0.0215s/iter; left time: 29.7515s
	iters: 1000, epoch: 9 | loss: 0.4982739
	speed: 0.0217s/iter; left time: 27.7593s
	iters: 1100, epoch: 9 | loss: 0.4045660
	speed: 0.0218s/iter; left time: 25.7149s
Epoch: 9 cost time: 24.991800546646118
Epoch: 9, Steps: 1140 | Train Loss: 0.5516673 Vali Loss: 0.6012539 Test Loss: 0.2812321
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.2807842791080475, mae:0.2988264858722687
Seed: 456
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_720      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.5952150
	speed: 0.0361s/iter; left time: 403.0989s
	iters: 200, epoch: 1 | loss: 0.6050654
	speed: 0.0295s/iter; left time: 326.4645s
	iters: 300, epoch: 1 | loss: 0.6111341
	speed: 0.0273s/iter; left time: 299.5067s
	iters: 400, epoch: 1 | loss: 0.7733548
	speed: 0.0262s/iter; left time: 284.8746s
	iters: 500, epoch: 1 | loss: 0.7161179
	speed: 0.0255s/iter; left time: 275.2644s
	iters: 600, epoch: 1 | loss: 0.5857803
	speed: 0.0247s/iter; left time: 264.1782s
	iters: 700, epoch: 1 | loss: 0.6680621
	speed: 0.0240s/iter; left time: 254.3981s
	iters: 800, epoch: 1 | loss: 0.8311317
	speed: 0.0235s/iter; left time: 246.7993s
	iters: 900, epoch: 1 | loss: 0.7130507
	speed: 0.0229s/iter; left time: 237.7705s
	iters: 1000, epoch: 1 | loss: 0.6212233
	speed: 0.0226s/iter; left time: 231.9140s
	iters: 1100, epoch: 1 | loss: 0.8086069
	speed: 0.0223s/iter; left time: 227.1851s
Epoch: 1 cost time: 25.175269603729248
Epoch: 1, Steps: 1128 | Train Loss: 0.7218153 Vali Loss: 0.7373539 Test Loss: 0.3634477
Validation loss decreased (inf --> 0.737354).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9017342
	speed: 0.0208s/iter; left time: 208.8207s
	iters: 200, epoch: 2 | loss: 0.6509116
	speed: 0.0190s/iter; left time: 189.2265s
	iters: 300, epoch: 2 | loss: 0.5287647
	speed: 0.0186s/iter; left time: 182.8374s
	iters: 400, epoch: 2 | loss: 0.6323256
	speed: 0.0183s/iter; left time: 178.7497s
	iters: 500, epoch: 2 | loss: 0.8034194
	speed: 0.0185s/iter; left time: 178.9984s
	iters: 600, epoch: 2 | loss: 0.6707664
	speed: 0.0190s/iter; left time: 181.9527s
	iters: 700, epoch: 2 | loss: 0.7133638
	speed: 0.0192s/iter; left time: 181.1693s
	iters: 800, epoch: 2 | loss: 0.6639998
	speed: 0.0193s/iter; left time: 180.3411s
	iters: 900, epoch: 2 | loss: 0.6272485
	speed: 0.0191s/iter; left time: 176.5142s
	iters: 1000, epoch: 2 | loss: 0.6250185
	speed: 0.0191s/iter; left time: 174.8959s
	iters: 1100, epoch: 2 | loss: 0.5270500
	speed: 0.0192s/iter; left time: 173.6212s
Epoch: 2 cost time: 21.72936177253723
Epoch: 2, Steps: 1128 | Train Loss: 0.6812907 Vali Loss: 0.7206780 Test Loss: 0.3616399
Validation loss decreased (0.737354 --> 0.720678).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5320908
	speed: 0.0250s/iter; left time: 223.4811s
	iters: 200, epoch: 3 | loss: 0.8350123
	speed: 0.0240s/iter; left time: 211.5118s
	iters: 300, epoch: 3 | loss: 0.7240543
	speed: 0.0236s/iter; left time: 206.0728s
	iters: 400, epoch: 3 | loss: 0.6894351
	speed: 0.0234s/iter; left time: 202.2098s
	iters: 500, epoch: 3 | loss: 0.5695045
	speed: 0.0233s/iter; left time: 198.9340s
	iters: 600, epoch: 3 | loss: 0.6042237
	speed: 0.0233s/iter; left time: 196.1902s
	iters: 700, epoch: 3 | loss: 0.7152256
	speed: 0.0228s/iter; left time: 189.9391s
	iters: 800, epoch: 3 | loss: 0.7131773
	speed: 0.0225s/iter; left time: 184.8911s
	iters: 900, epoch: 3 | loss: 0.7744253
	speed: 0.0219s/iter; left time: 178.2779s
	iters: 1000, epoch: 3 | loss: 0.7681505
	speed: 0.0217s/iter; left time: 174.2184s
	iters: 1100, epoch: 3 | loss: 0.8763025
	speed: 0.0215s/iter; left time: 170.6988s
Epoch: 3 cost time: 24.374457359313965
Epoch: 3, Steps: 1128 | Train Loss: 0.6614504 Vali Loss: 0.7170028 Test Loss: 0.3613074
Validation loss decreased (0.720678 --> 0.717003).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6743583
	speed: 0.0254s/iter; left time: 197.9294s
	iters: 200, epoch: 4 | loss: 0.5706784
	speed: 0.0242s/iter; left time: 186.6381s
	iters: 300, epoch: 4 | loss: 0.6470398
	speed: 0.0239s/iter; left time: 181.3965s
	iters: 400, epoch: 4 | loss: 0.5493774
	speed: 0.0237s/iter; left time: 177.6907s
	iters: 500, epoch: 4 | loss: 0.8019364
	speed: 0.0236s/iter; left time: 174.4422s
	iters: 600, epoch: 4 | loss: 0.6562878
	speed: 0.0235s/iter; left time: 171.5046s
	iters: 700, epoch: 4 | loss: 0.6048090
	speed: 0.0230s/iter; left time: 165.3812s
	iters: 800, epoch: 4 | loss: 0.6704906
	speed: 0.0226s/iter; left time: 160.1887s
	iters: 900, epoch: 4 | loss: 0.5279551
	speed: 0.0221s/iter; left time: 154.8978s
	iters: 1000, epoch: 4 | loss: 0.7653732
	speed: 0.0218s/iter; left time: 150.4869s
	iters: 1100, epoch: 4 | loss: 0.7059597
	speed: 0.0216s/iter; left time: 147.0801s
Epoch: 4 cost time: 24.48348355293274
Epoch: 4, Steps: 1128 | Train Loss: 0.6500587 Vali Loss: 0.7193251 Test Loss: 0.3600459
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5536063
	speed: 0.0249s/iter; left time: 166.3204s
	iters: 200, epoch: 5 | loss: 0.5400575
	speed: 0.0239s/iter; left time: 157.1096s
	iters: 300, epoch: 5 | loss: 0.6036518
	speed: 0.0236s/iter; left time: 152.8674s
	iters: 400, epoch: 5 | loss: 0.5377207
	speed: 0.0235s/iter; left time: 149.8577s
	iters: 500, epoch: 5 | loss: 0.6007886
	speed: 0.0225s/iter; left time: 141.2092s
	iters: 600, epoch: 5 | loss: 0.6584069
	speed: 0.0217s/iter; left time: 134.1072s
	iters: 700, epoch: 5 | loss: 0.5728055
	speed: 0.0209s/iter; left time: 127.1072s
	iters: 800, epoch: 5 | loss: 0.6643103
	speed: 0.0202s/iter; left time: 120.3174s
	iters: 900, epoch: 5 | loss: 0.8061140
	speed: 0.0197s/iter; left time: 115.5331s
	iters: 1000, epoch: 5 | loss: 0.5492691
	speed: 0.0194s/iter; left time: 112.1178s
	iters: 1100, epoch: 5 | loss: 0.6779659
	speed: 0.0194s/iter; left time: 110.1041s
Epoch: 5 cost time: 22.043144702911377
Epoch: 5, Steps: 1128 | Train Loss: 0.6437152 Vali Loss: 0.7148892 Test Loss: 0.3596132
Validation loss decreased (0.717003 --> 0.714889).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6832300
	speed: 0.0248s/iter; left time: 137.4892s
	iters: 200, epoch: 6 | loss: 0.4675931
	speed: 0.0239s/iter; left time: 129.7953s
	iters: 300, epoch: 6 | loss: 0.6102434
	speed: 0.0235s/iter; left time: 125.7488s
	iters: 400, epoch: 6 | loss: 0.5240591
	speed: 0.0234s/iter; left time: 122.5288s
	iters: 500, epoch: 6 | loss: 0.5900481
	speed: 0.0233s/iter; left time: 119.6954s
	iters: 600, epoch: 6 | loss: 0.6756721
	speed: 0.0232s/iter; left time: 117.0653s
	iters: 700, epoch: 6 | loss: 0.4619402
	speed: 0.0231s/iter; left time: 113.9543s
	iters: 800, epoch: 6 | loss: 0.5789979
	speed: 0.0227s/iter; left time: 109.6747s
	iters: 900, epoch: 6 | loss: 0.6677002
	speed: 0.0224s/iter; left time: 106.0627s
	iters: 1000, epoch: 6 | loss: 0.7137322
	speed: 0.0219s/iter; left time: 101.4480s
	iters: 1100, epoch: 6 | loss: 0.6386720
	speed: 0.0214s/iter; left time: 97.2250s
Epoch: 6 cost time: 24.10144066810608
Epoch: 6, Steps: 1128 | Train Loss: 0.6403225 Vali Loss: 0.7145411 Test Loss: 0.3601204
Validation loss decreased (0.714889 --> 0.714541).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5682735
	speed: 0.0155s/iter; left time: 68.3429s
	iters: 200, epoch: 7 | loss: 0.6231965
	speed: 0.0148s/iter; left time: 63.7541s
	iters: 300, epoch: 7 | loss: 0.6194487
	speed: 0.0142s/iter; left time: 60.0227s
	iters: 400, epoch: 7 | loss: 0.8914524
	speed: 0.0141s/iter; left time: 58.1654s
	iters: 500, epoch: 7 | loss: 0.6171328
	speed: 0.0160s/iter; left time: 64.2735s
	iters: 600, epoch: 7 | loss: 0.5883825
	speed: 0.0172s/iter; left time: 67.2636s
	iters: 700, epoch: 7 | loss: 0.8100625
	speed: 0.0181s/iter; left time: 68.9332s
	iters: 800, epoch: 7 | loss: 0.6676131
	speed: 0.0187s/iter; left time: 69.5206s
	iters: 900, epoch: 7 | loss: 0.6925843
	speed: 0.0192s/iter; left time: 69.4363s
	iters: 1000, epoch: 7 | loss: 0.5407562
	speed: 0.0196s/iter; left time: 68.8971s
	iters: 1100, epoch: 7 | loss: 0.6093324
	speed: 0.0199s/iter; left time: 68.0281s
Epoch: 7 cost time: 22.682030200958252
Epoch: 7, Steps: 1128 | Train Loss: 0.6382911 Vali Loss: 0.7173899 Test Loss: 0.3609614
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.6211646
	speed: 0.0250s/iter; left time: 82.0205s
	iters: 200, epoch: 8 | loss: 0.6261719
	speed: 0.0227s/iter; left time: 72.3388s
	iters: 300, epoch: 8 | loss: 0.5574982
	speed: 0.0205s/iter; left time: 63.2425s
	iters: 400, epoch: 8 | loss: 0.6416507
	speed: 0.0196s/iter; left time: 58.3898s
	iters: 500, epoch: 8 | loss: 0.5079627
	speed: 0.0190s/iter; left time: 54.7531s
	iters: 600, epoch: 8 | loss: 0.5543931
	speed: 0.0195s/iter; left time: 54.1907s
	iters: 700, epoch: 8 | loss: 0.6527929
	speed: 0.0198s/iter; left time: 53.1120s
	iters: 800, epoch: 8 | loss: 0.5825826
	speed: 0.0195s/iter; left time: 50.5136s
	iters: 900, epoch: 8 | loss: 0.5791306
	speed: 0.0193s/iter; left time: 48.0519s
	iters: 1000, epoch: 8 | loss: 0.5718560
	speed: 0.0193s/iter; left time: 45.9284s
	iters: 1100, epoch: 8 | loss: 0.7788762
	speed: 0.0192s/iter; left time: 43.8554s
Epoch: 8 cost time: 21.681084394454956
Epoch: 8, Steps: 1128 | Train Loss: 0.6375626 Vali Loss: 0.7156415 Test Loss: 0.3607497
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.5507001
	speed: 0.0252s/iter; left time: 54.2686s
	iters: 200, epoch: 9 | loss: 0.5487884
	speed: 0.0241s/iter; left time: 49.5651s
	iters: 300, epoch: 9 | loss: 0.5679759
	speed: 0.0219s/iter; left time: 42.8465s
	iters: 400, epoch: 9 | loss: 0.7217416
	speed: 0.0205s/iter; left time: 38.1406s
	iters: 500, epoch: 9 | loss: 0.5551186
	speed: 0.0198s/iter; left time: 34.8064s
	iters: 600, epoch: 9 | loss: 0.6661098
	speed: 0.0196s/iter; left time: 32.5088s
	iters: 700, epoch: 9 | loss: 0.6606776
	speed: 0.0201s/iter; left time: 31.3154s
	iters: 800, epoch: 9 | loss: 0.6344804
	speed: 0.0205s/iter; left time: 29.8272s
	iters: 900, epoch: 9 | loss: 0.6141943
	speed: 0.0208s/iter; left time: 28.1654s
	iters: 1000, epoch: 9 | loss: 0.7996049
	speed: 0.0210s/iter; left time: 26.3817s
	iters: 1100, epoch: 9 | loss: 0.6020818
	speed: 0.0212s/iter; left time: 24.4980s
Epoch: 9 cost time: 24.050941944122314
Epoch: 9, Steps: 1128 | Train Loss: 0.6372654 Vali Loss: 0.7176200 Test Loss: 0.3609732
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.4990618
	speed: 0.0250s/iter; left time: 25.7336s
	iters: 200, epoch: 10 | loss: 0.5966945
	speed: 0.0240s/iter; left time: 22.3000s
	iters: 300, epoch: 10 | loss: 0.5845365
	speed: 0.0228s/iter; left time: 18.9263s
	iters: 400, epoch: 10 | loss: 0.6758586
	speed: 0.0211s/iter; left time: 15.3964s
	iters: 500, epoch: 10 | loss: 0.7089719
	speed: 0.0203s/iter; left time: 12.7520s
	iters: 600, epoch: 10 | loss: 0.6473621
	speed: 0.0196s/iter; left time: 10.3885s
	iters: 700, epoch: 10 | loss: 0.5783535
	speed: 0.0200s/iter; left time: 8.5843s
	iters: 800, epoch: 10 | loss: 0.7182112
	speed: 0.0204s/iter; left time: 6.7165s
	iters: 900, epoch: 10 | loss: 0.5339778
	speed: 0.0207s/iter; left time: 4.7418s
	iters: 1000, epoch: 10 | loss: 0.5634411
	speed: 0.0209s/iter; left time: 2.7013s
	iters: 1100, epoch: 10 | loss: 0.4715151
	speed: 0.0211s/iter; left time: 0.6129s
Epoch: 10 cost time: 24.029419422149658
Epoch: 10, Steps: 1128 | Train Loss: 0.6367910 Vali Loss: 0.7165217 Test Loss: 0.3609215
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.36012041568756104, mae:0.3519914746284485
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.7431859
	speed: 0.0247s/iter; left time: 276.3988s
	iters: 200, epoch: 1 | loss: 0.5916294
	speed: 0.0206s/iter; left time: 228.3808s
	iters: 300, epoch: 1 | loss: 0.6816372
	speed: 0.0191s/iter; left time: 209.5866s
	iters: 400, epoch: 1 | loss: 0.6695530
	speed: 0.0185s/iter; left time: 200.9937s
	iters: 500, epoch: 1 | loss: 0.6840238
	speed: 0.0188s/iter; left time: 202.9384s
	iters: 600, epoch: 1 | loss: 0.6835989
	speed: 0.0195s/iter; left time: 208.5949s
	iters: 700, epoch: 1 | loss: 0.6806584
	speed: 0.0200s/iter; left time: 211.9229s
	iters: 800, epoch: 1 | loss: 1.0091399
	speed: 0.0204s/iter; left time: 213.8334s
	iters: 900, epoch: 1 | loss: 0.6124986
	speed: 0.0206s/iter; left time: 213.9494s
	iters: 1000, epoch: 1 | loss: 0.8472793
	speed: 0.0204s/iter; left time: 209.5621s
	iters: 1100, epoch: 1 | loss: 0.6479405
	speed: 0.0201s/iter; left time: 205.0458s
Epoch: 1 cost time: 22.78814697265625
Epoch: 1, Steps: 1128 | Train Loss: 0.7233004 Vali Loss: 0.7519302 Test Loss: 0.3660921
Validation loss decreased (inf --> 0.751930).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6628945
	speed: 0.0247s/iter; left time: 248.6681s
	iters: 200, epoch: 2 | loss: 0.6686473
	speed: 0.0208s/iter; left time: 206.9793s
	iters: 300, epoch: 2 | loss: 0.6271420
	speed: 0.0194s/iter; left time: 191.2915s
	iters: 400, epoch: 2 | loss: 0.5936801
	speed: 0.0187s/iter; left time: 182.8172s
	iters: 500, epoch: 2 | loss: 0.6881885
	speed: 0.0193s/iter; left time: 186.6999s
	iters: 600, epoch: 2 | loss: 0.6811007
	speed: 0.0200s/iter; left time: 190.5942s
	iters: 700, epoch: 2 | loss: 0.7223731
	speed: 0.0204s/iter; left time: 192.6724s
	iters: 800, epoch: 2 | loss: 0.6327580
	speed: 0.0207s/iter; left time: 193.7760s
	iters: 900, epoch: 2 | loss: 0.5893425
	speed: 0.0210s/iter; left time: 194.0768s
	iters: 1000, epoch: 2 | loss: 0.6927007
	speed: 0.0212s/iter; left time: 193.8512s
	iters: 1100, epoch: 2 | loss: 0.7504187
	speed: 0.0214s/iter; left time: 193.2933s
Epoch: 2 cost time: 24.25110912322998
Epoch: 2, Steps: 1128 | Train Loss: 0.6845659 Vali Loss: 0.7271299 Test Loss: 0.3619980
Validation loss decreased (0.751930 --> 0.727130).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6040773
	speed: 0.0252s/iter; left time: 225.0211s
	iters: 200, epoch: 3 | loss: 0.7262458
	speed: 0.0217s/iter; left time: 191.6648s
	iters: 300, epoch: 3 | loss: 0.7537878
	speed: 0.0198s/iter; left time: 172.7190s
	iters: 400, epoch: 3 | loss: 0.7326378
	speed: 0.0190s/iter; left time: 164.2115s
	iters: 500, epoch: 3 | loss: 0.6128390
	speed: 0.0189s/iter; left time: 161.4123s
	iters: 600, epoch: 3 | loss: 0.5854667
	speed: 0.0196s/iter; left time: 165.2007s
	iters: 700, epoch: 3 | loss: 0.5546178
	speed: 0.0201s/iter; left time: 167.2000s
	iters: 800, epoch: 3 | loss: 0.5132348
	speed: 0.0205s/iter; left time: 168.2464s
	iters: 900, epoch: 3 | loss: 0.9032423
	speed: 0.0207s/iter; left time: 168.5140s
	iters: 1000, epoch: 3 | loss: 0.5846967
	speed: 0.0210s/iter; left time: 168.2576s
	iters: 1100, epoch: 3 | loss: 0.7470554
	speed: 0.0212s/iter; left time: 167.6657s
Epoch: 3 cost time: 24.003889083862305
Epoch: 3, Steps: 1128 | Train Loss: 0.6647042 Vali Loss: 0.7322828 Test Loss: 0.3620480
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6803588
	speed: 0.0254s/iter; left time: 197.8220s
	iters: 200, epoch: 4 | loss: 0.6936767
	speed: 0.0231s/iter; left time: 178.1297s
	iters: 300, epoch: 4 | loss: 0.5428411
	speed: 0.0207s/iter; left time: 157.5953s
	iters: 400, epoch: 4 | loss: 0.6889298
	speed: 0.0198s/iter; left time: 148.1442s
	iters: 500, epoch: 4 | loss: 0.6370445
	speed: 0.0190s/iter; left time: 140.6592s
	iters: 600, epoch: 4 | loss: 0.6379691
	speed: 0.0196s/iter; left time: 142.6732s
	iters: 700, epoch: 4 | loss: 0.7128201
	speed: 0.0201s/iter; left time: 144.3051s
	iters: 800, epoch: 4 | loss: 0.6483427
	speed: 0.0204s/iter; left time: 145.0970s
	iters: 900, epoch: 4 | loss: 0.8741990
	speed: 0.0207s/iter; left time: 145.0476s
	iters: 1000, epoch: 4 | loss: 0.6290210
	speed: 0.0210s/iter; left time: 144.5761s
	iters: 1100, epoch: 4 | loss: 0.6589198
	speed: 0.0211s/iter; left time: 143.7464s
Epoch: 4 cost time: 24.028870344161987
Epoch: 4, Steps: 1128 | Train Loss: 0.6539031 Vali Loss: 0.7210321 Test Loss: 0.3598673
Validation loss decreased (0.727130 --> 0.721032).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.9354107
	speed: 0.0209s/iter; left time: 139.5749s
	iters: 200, epoch: 5 | loss: 0.7067016
	speed: 0.0172s/iter; left time: 113.2216s
	iters: 300, epoch: 5 | loss: 0.4894781
	speed: 0.0152s/iter; left time: 98.2720s
	iters: 400, epoch: 5 | loss: 0.6846589
	speed: 0.0146s/iter; left time: 93.1478s
	iters: 500, epoch: 5 | loss: 0.7118058
	speed: 0.0136s/iter; left time: 85.4673s
	iters: 600, epoch: 5 | loss: 0.5381070
	speed: 0.0129s/iter; left time: 79.4266s
	iters: 700, epoch: 5 | loss: 0.5530946
	speed: 0.0136s/iter; left time: 82.6479s
	iters: 800, epoch: 5 | loss: 0.4957058
	speed: 0.0143s/iter; left time: 85.1344s
	iters: 900, epoch: 5 | loss: 0.7203258
	speed: 0.0152s/iter; left time: 89.4059s
	iters: 1000, epoch: 5 | loss: 0.5822206
	speed: 0.0160s/iter; left time: 92.3252s
	iters: 1100, epoch: 5 | loss: 0.7892660
	speed: 0.0166s/iter; left time: 94.3512s
Epoch: 5 cost time: 19.076337099075317
Epoch: 5, Steps: 1128 | Train Loss: 0.6477912 Vali Loss: 0.7237212 Test Loss: 0.3602168
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.7023908
	speed: 0.0251s/iter; left time: 139.1717s
	iters: 200, epoch: 6 | loss: 0.7080799
	speed: 0.0241s/iter; left time: 130.8571s
	iters: 300, epoch: 6 | loss: 0.5602458
	speed: 0.0236s/iter; left time: 125.9033s
	iters: 400, epoch: 6 | loss: 0.5892416
	speed: 0.0227s/iter; left time: 118.8193s
	iters: 500, epoch: 6 | loss: 0.7380213
	speed: 0.0221s/iter; left time: 113.4092s
	iters: 600, epoch: 6 | loss: 0.5770714
	speed: 0.0211s/iter; left time: 106.3297s
	iters: 700, epoch: 6 | loss: 0.7176446
	speed: 0.0208s/iter; left time: 102.7593s
	iters: 800, epoch: 6 | loss: 0.5961549
	speed: 0.0207s/iter; left time: 99.9717s
	iters: 900, epoch: 6 | loss: 0.5672399
	speed: 0.0209s/iter; left time: 99.0342s
	iters: 1000, epoch: 6 | loss: 0.5324113
	speed: 0.0211s/iter; left time: 97.9708s
	iters: 1100, epoch: 6 | loss: 0.7040281
	speed: 0.0213s/iter; left time: 96.6529s
Epoch: 6 cost time: 24.175150871276855
Epoch: 6, Steps: 1128 | Train Loss: 0.6447508 Vali Loss: 0.7222134 Test Loss: 0.3607199
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5649882
	speed: 0.0251s/iter; left time: 110.8339s
	iters: 200, epoch: 7 | loss: 0.5818172
	speed: 0.0241s/iter; left time: 103.7478s
	iters: 300, epoch: 7 | loss: 0.5402380
	speed: 0.0237s/iter; left time: 99.8485s
	iters: 400, epoch: 7 | loss: 0.5770945
	speed: 0.0230s/iter; left time: 94.5182s
	iters: 500, epoch: 7 | loss: 0.6674105
	speed: 0.0224s/iter; left time: 89.7811s
	iters: 600, epoch: 7 | loss: 0.7729732
	speed: 0.0214s/iter; left time: 83.6900s
	iters: 700, epoch: 7 | loss: 0.5559574
	speed: 0.0206s/iter; left time: 78.5465s
	iters: 800, epoch: 7 | loss: 0.5954422
	speed: 0.0202s/iter; left time: 74.9730s
	iters: 900, epoch: 7 | loss: 0.5335265
	speed: 0.0199s/iter; left time: 71.7511s
	iters: 1000, epoch: 7 | loss: 0.5204449
	speed: 0.0202s/iter; left time: 70.8609s
	iters: 1100, epoch: 7 | loss: 0.6228639
	speed: 0.0204s/iter; left time: 69.7860s
Epoch: 7 cost time: 23.254255533218384
Epoch: 7, Steps: 1128 | Train Loss: 0.6430432 Vali Loss: 0.7199057 Test Loss: 0.3605935
Validation loss decreased (0.721032 --> 0.719906).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.7269417
	speed: 0.0254s/iter; left time: 83.3153s
	iters: 200, epoch: 8 | loss: 0.7281751
	speed: 0.0242s/iter; left time: 77.0656s
	iters: 300, epoch: 8 | loss: 0.6350885
	speed: 0.0238s/iter; left time: 73.3956s
	iters: 400, epoch: 8 | loss: 0.9591534
	speed: 0.0236s/iter; left time: 70.4173s
	iters: 500, epoch: 8 | loss: 0.8604341
	speed: 0.0235s/iter; left time: 67.7334s
	iters: 600, epoch: 8 | loss: 0.7150945
	speed: 0.0229s/iter; left time: 63.8964s
	iters: 700, epoch: 8 | loss: 0.6814726
	speed: 0.0212s/iter; left time: 56.8981s
	iters: 800, epoch: 8 | loss: 0.6355628
	speed: 0.0199s/iter; left time: 51.4332s
	iters: 900, epoch: 8 | loss: 0.6070267
	speed: 0.0190s/iter; left time: 47.1839s
	iters: 1000, epoch: 8 | loss: 0.6010742
	speed: 0.0184s/iter; left time: 43.9888s
	iters: 1100, epoch: 8 | loss: 0.6712725
	speed: 0.0183s/iter; left time: 41.7514s
Epoch: 8 cost time: 20.596151113510132
Epoch: 8, Steps: 1128 | Train Loss: 0.6424537 Vali Loss: 0.7210576 Test Loss: 0.3605282
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.6073525
	speed: 0.0251s/iter; left time: 54.2000s
	iters: 200, epoch: 9 | loss: 0.6181709
	speed: 0.0242s/iter; left time: 49.7012s
	iters: 300, epoch: 9 | loss: 0.5885593
	speed: 0.0239s/iter; left time: 46.6868s
	iters: 400, epoch: 9 | loss: 0.5743391
	speed: 0.0237s/iter; left time: 43.9786s
	iters: 500, epoch: 9 | loss: 0.6450111
	speed: 0.0236s/iter; left time: 41.4129s
	iters: 600, epoch: 9 | loss: 0.5499731
	speed: 0.0235s/iter; left time: 38.9400s
	iters: 700, epoch: 9 | loss: 0.5607523
	speed: 0.0229s/iter; left time: 35.6570s
	iters: 800, epoch: 9 | loss: 0.5430974
	speed: 0.0221s/iter; left time: 32.2267s
	iters: 900, epoch: 9 | loss: 0.5266239
	speed: 0.0215s/iter; left time: 29.1995s
	iters: 1000, epoch: 9 | loss: 0.5152080
	speed: 0.0211s/iter; left time: 26.5201s
	iters: 1100, epoch: 9 | loss: 0.5711253
	speed: 0.0213s/iter; left time: 24.6270s
Epoch: 9 cost time: 24.187720775604248
Epoch: 9, Steps: 1128 | Train Loss: 0.6415732 Vali Loss: 0.7203050 Test Loss: 0.3605395
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.5821100
	speed: 0.0250s/iter; left time: 25.6748s
	iters: 200, epoch: 10 | loss: 0.5035961
	speed: 0.0240s/iter; left time: 22.2780s
	iters: 300, epoch: 10 | loss: 0.8969001
	speed: 0.0237s/iter; left time: 19.6219s
	iters: 400, epoch: 10 | loss: 0.5295933
	speed: 0.0235s/iter; left time: 17.1328s
	iters: 500, epoch: 10 | loss: 0.6653297
	speed: 0.0234s/iter; left time: 14.7204s
	iters: 600, epoch: 10 | loss: 0.5456954
	speed: 0.0233s/iter; left time: 12.3486s
	iters: 700, epoch: 10 | loss: 0.8031753
	speed: 0.0232s/iter; left time: 9.9435s
	iters: 800, epoch: 10 | loss: 0.6741840
	speed: 0.0224s/iter; left time: 7.3719s
	iters: 900, epoch: 10 | loss: 0.6503416
	speed: 0.0217s/iter; left time: 4.9760s
	iters: 1000, epoch: 10 | loss: 0.5445569
	speed: 0.0212s/iter; left time: 2.7383s
	iters: 1100, epoch: 10 | loss: 0.5064737
	speed: 0.0212s/iter; left time: 0.6136s
Epoch: 10 cost time: 24.023921489715576
Epoch: 10, Steps: 1128 | Train Loss: 0.6416928 Vali Loss: 0.7199044 Test Loss: 0.3605633
Validation loss decreased (0.719906 --> 0.719904).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.3605632781982422, mae:0.3514787256717682
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.8674209
	speed: 0.0254s/iter; left time: 284.0600s
	iters: 200, epoch: 1 | loss: 1.1628718
	speed: 0.0242s/iter; left time: 268.0394s
	iters: 300, epoch: 1 | loss: 0.7089751
	speed: 0.0238s/iter; left time: 261.1710s
	iters: 400, epoch: 1 | loss: 0.6028106
	speed: 0.0236s/iter; left time: 256.7047s
	iters: 500, epoch: 1 | loss: 0.6999358
	speed: 0.0235s/iter; left time: 252.8836s
	iters: 600, epoch: 1 | loss: 0.7858983
	speed: 0.0224s/iter; left time: 239.7379s
	iters: 700, epoch: 1 | loss: 0.7982682
	speed: 0.0215s/iter; left time: 227.5867s
	iters: 800, epoch: 1 | loss: 0.9128005
	speed: 0.0209s/iter; left time: 219.0847s
	iters: 900, epoch: 1 | loss: 0.7513133
	speed: 0.0205s/iter; left time: 213.2659s
	iters: 1000, epoch: 1 | loss: 0.6168992
	speed: 0.0203s/iter; left time: 208.9610s
	iters: 1100, epoch: 1 | loss: 0.6475993
	speed: 0.0201s/iter; left time: 204.5722s
Epoch: 1 cost time: 22.72158432006836
Epoch: 1, Steps: 1128 | Train Loss: 0.7220055 Vali Loss: 0.7361189 Test Loss: 0.3623383
Validation loss decreased (inf --> 0.736119).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7251511
	speed: 0.0249s/iter; left time: 250.5582s
	iters: 200, epoch: 2 | loss: 0.7277706
	speed: 0.0239s/iter; left time: 238.3670s
	iters: 300, epoch: 2 | loss: 0.7329175
	speed: 0.0236s/iter; left time: 232.7723s
	iters: 400, epoch: 2 | loss: 0.7604588
	speed: 0.0235s/iter; left time: 228.9157s
	iters: 500, epoch: 2 | loss: 0.8817345
	speed: 0.0234s/iter; left time: 225.5337s
	iters: 600, epoch: 2 | loss: 0.6435627
	speed: 0.0224s/iter; left time: 214.1508s
	iters: 700, epoch: 2 | loss: 0.6239281
	speed: 0.0215s/iter; left time: 203.4349s
	iters: 800, epoch: 2 | loss: 0.4863221
	speed: 0.0209s/iter; left time: 195.6790s
	iters: 900, epoch: 2 | loss: 0.7220216
	speed: 0.0207s/iter; left time: 191.3297s
	iters: 1000, epoch: 2 | loss: 0.7485323
	speed: 0.0209s/iter; left time: 191.3591s
	iters: 1100, epoch: 2 | loss: 0.5829102
	speed: 0.0211s/iter; left time: 191.0006s
Epoch: 2 cost time: 23.971948623657227
Epoch: 2, Steps: 1128 | Train Loss: 0.6813898 Vali Loss: 0.7226427 Test Loss: 0.3574584
Validation loss decreased (0.736119 --> 0.722643).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7621449
	speed: 0.0254s/iter; left time: 227.0894s
	iters: 200, epoch: 3 | loss: 0.7920268
	speed: 0.0242s/iter; left time: 213.7104s
	iters: 300, epoch: 3 | loss: 0.6434870
	speed: 0.0238s/iter; left time: 207.6488s
	iters: 400, epoch: 3 | loss: 0.5191456
	speed: 0.0236s/iter; left time: 203.5035s
	iters: 500, epoch: 3 | loss: 0.6921846
	speed: 0.0235s/iter; left time: 200.1131s
	iters: 600, epoch: 3 | loss: 0.6408343
	speed: 0.0229s/iter; left time: 192.6743s
	iters: 700, epoch: 3 | loss: 0.6471770
	speed: 0.0219s/iter; left time: 182.4550s
	iters: 800, epoch: 3 | loss: 0.6023971
	speed: 0.0213s/iter; left time: 175.0176s
	iters: 900, epoch: 3 | loss: 0.5504352
	speed: 0.0207s/iter; left time: 168.4172s
	iters: 1000, epoch: 3 | loss: 0.7095873
	speed: 0.0209s/iter; left time: 167.7811s
	iters: 1100, epoch: 3 | loss: 1.0467391
	speed: 0.0211s/iter; left time: 167.1720s
Epoch: 3 cost time: 23.930948495864868
Epoch: 3, Steps: 1128 | Train Loss: 0.6604881 Vali Loss: 0.7203532 Test Loss: 0.3574546
Validation loss decreased (0.722643 --> 0.720353).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8140869
	speed: 0.0252s/iter; left time: 196.8723s
	iters: 200, epoch: 4 | loss: 0.7048098
	speed: 0.0242s/iter; left time: 186.0043s
	iters: 300, epoch: 4 | loss: 0.6650787
	speed: 0.0239s/iter; left time: 181.2787s
	iters: 400, epoch: 4 | loss: 0.8293020
	speed: 0.0237s/iter; left time: 177.7164s
	iters: 500, epoch: 4 | loss: 0.5239453
	speed: 0.0236s/iter; left time: 174.5336s
	iters: 600, epoch: 4 | loss: 0.6442817
	speed: 0.0235s/iter; left time: 171.7078s
	iters: 700, epoch: 4 | loss: 0.6972522
	speed: 0.0227s/iter; left time: 163.2696s
	iters: 800, epoch: 4 | loss: 0.6226931
	speed: 0.0219s/iter; left time: 155.1261s
	iters: 900, epoch: 4 | loss: 0.5469828
	speed: 0.0213s/iter; left time: 148.9571s
	iters: 1000, epoch: 4 | loss: 0.7608990
	speed: 0.0210s/iter; left time: 144.8463s
	iters: 1100, epoch: 4 | loss: 0.6256452
	speed: 0.0209s/iter; left time: 142.2020s
Epoch: 4 cost time: 23.643094539642334
Epoch: 4, Steps: 1128 | Train Loss: 0.6497379 Vali Loss: 0.7165249 Test Loss: 0.3572273
Validation loss decreased (0.720353 --> 0.716525).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5931034
	speed: 0.0213s/iter; left time: 141.7565s
	iters: 200, epoch: 5 | loss: 0.7482773
	speed: 0.0205s/iter; left time: 134.9883s
	iters: 300, epoch: 5 | loss: 0.5917672
	speed: 0.0214s/iter; left time: 138.1803s
	iters: 400, epoch: 5 | loss: 0.7236395
	speed: 0.0218s/iter; left time: 138.6922s
	iters: 500, epoch: 5 | loss: 0.6572669
	speed: 0.0220s/iter; left time: 138.0321s
	iters: 600, epoch: 5 | loss: 0.6030031
	speed: 0.0220s/iter; left time: 135.6155s
	iters: 700, epoch: 5 | loss: 0.5383131
	speed: 0.0217s/iter; left time: 131.6746s
	iters: 800, epoch: 5 | loss: 0.5596779
	speed: 0.0214s/iter; left time: 127.9459s
	iters: 900, epoch: 5 | loss: 0.5506265
	speed: 0.0209s/iter; left time: 122.8704s
	iters: 1000, epoch: 5 | loss: 0.6664919
	speed: 0.0208s/iter; left time: 120.1421s
	iters: 1100, epoch: 5 | loss: 0.6046796
	speed: 0.0207s/iter; left time: 117.3498s
Epoch: 5 cost time: 23.50409722328186
Epoch: 5, Steps: 1128 | Train Loss: 0.6433033 Vali Loss: 0.7168536 Test Loss: 0.3584817
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5478584
	speed: 0.0253s/iter; left time: 140.2488s
	iters: 200, epoch: 6 | loss: 0.7469806
	speed: 0.0241s/iter; left time: 131.3849s
	iters: 300, epoch: 6 | loss: 0.5184085
	speed: 0.0238s/iter; left time: 126.8878s
	iters: 400, epoch: 6 | loss: 0.6892576
	speed: 0.0236s/iter; left time: 123.5600s
	iters: 500, epoch: 6 | loss: 0.5595485
	speed: 0.0235s/iter; left time: 120.5951s
	iters: 600, epoch: 6 | loss: 0.6540546
	speed: 0.0234s/iter; left time: 117.7305s
	iters: 700, epoch: 6 | loss: 0.7235023
	speed: 0.0229s/iter; left time: 112.9785s
	iters: 800, epoch: 6 | loss: 0.6260366
	speed: 0.0225s/iter; left time: 109.0166s
	iters: 900, epoch: 6 | loss: 0.6429224
	speed: 0.0218s/iter; left time: 103.3787s
	iters: 1000, epoch: 6 | loss: 0.6077373
	speed: 0.0216s/iter; left time: 100.1345s
	iters: 1100, epoch: 6 | loss: 0.7985869
	speed: 0.0214s/iter; left time: 97.3194s
Epoch: 6 cost time: 24.17004418373108
Epoch: 6, Steps: 1128 | Train Loss: 0.6397903 Vali Loss: 0.7190275 Test Loss: 0.3586465
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5612409
	speed: 0.0253s/iter; left time: 111.4920s
	iters: 200, epoch: 7 | loss: 0.5340447
	speed: 0.0241s/iter; left time: 104.0384s
	iters: 300, epoch: 7 | loss: 0.6340799
	speed: 0.0238s/iter; left time: 100.0973s
	iters: 400, epoch: 7 | loss: 0.6718807
	speed: 0.0236s/iter; left time: 96.9208s
	iters: 500, epoch: 7 | loss: 0.7217955
	speed: 0.0234s/iter; left time: 94.1007s
	iters: 600, epoch: 7 | loss: 0.6212749
	speed: 0.0234s/iter; left time: 91.5024s
	iters: 700, epoch: 7 | loss: 0.6981350
	speed: 0.0230s/iter; left time: 87.6094s
	iters: 800, epoch: 7 | loss: 0.8510866
	speed: 0.0226s/iter; left time: 83.8806s
	iters: 900, epoch: 7 | loss: 0.5727193
	speed: 0.0220s/iter; left time: 79.6093s
	iters: 1000, epoch: 7 | loss: 0.5625216
	speed: 0.0215s/iter; left time: 75.3539s
	iters: 1100, epoch: 7 | loss: 0.4898290
	speed: 0.0211s/iter; left time: 71.9264s
Epoch: 7 cost time: 23.71716833114624
Epoch: 7, Steps: 1128 | Train Loss: 0.6383370 Vali Loss: 0.7180459 Test Loss: 0.3584135
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.6604617
	speed: 0.0242s/iter; left time: 79.6242s
	iters: 200, epoch: 8 | loss: 0.7919722
	speed: 0.0211s/iter; left time: 67.0757s
	iters: 300, epoch: 8 | loss: 0.5793242
	speed: 0.0199s/iter; left time: 61.3586s
	iters: 400, epoch: 8 | loss: 0.5228547
	speed: 0.0194s/iter; left time: 57.7739s
	iters: 500, epoch: 8 | loss: 0.5981027
	speed: 0.0190s/iter; left time: 54.9149s
	iters: 600, epoch: 8 | loss: 0.5868026
	speed: 0.0188s/iter; left time: 52.3080s
	iters: 700, epoch: 8 | loss: 0.5222976
	speed: 0.0193s/iter; left time: 51.7921s
	iters: 800, epoch: 8 | loss: 0.7434959
	speed: 0.0198s/iter; left time: 51.0684s
	iters: 900, epoch: 8 | loss: 0.5655399
	speed: 0.0197s/iter; left time: 48.9693s
	iters: 1000, epoch: 8 | loss: 0.5190781
	speed: 0.0193s/iter; left time: 46.1165s
	iters: 1100, epoch: 8 | loss: 0.5522807
	speed: 0.0191s/iter; left time: 43.6394s
Epoch: 8 cost time: 21.62048363685608
Epoch: 8, Steps: 1128 | Train Loss: 0.6376023 Vali Loss: 0.7196084 Test Loss: 0.3584389
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.7435873
	speed: 0.0251s/iter; left time: 54.1042s
	iters: 200, epoch: 9 | loss: 0.6454791
	speed: 0.0240s/iter; left time: 49.4596s
	iters: 300, epoch: 9 | loss: 0.6352366
	speed: 0.0237s/iter; left time: 46.4079s
	iters: 400, epoch: 9 | loss: 0.6445770
	speed: 0.0235s/iter; left time: 43.7113s
	iters: 500, epoch: 9 | loss: 0.5701504
	speed: 0.0234s/iter; left time: 41.1705s
	iters: 600, epoch: 9 | loss: 0.5884727
	speed: 0.0234s/iter; left time: 38.7237s
	iters: 700, epoch: 9 | loss: 0.6101110
	speed: 0.0233s/iter; left time: 36.3066s
	iters: 800, epoch: 9 | loss: 0.6602427
	speed: 0.0233s/iter; left time: 33.9183s
	iters: 900, epoch: 9 | loss: 0.5842792
	speed: 0.0231s/iter; left time: 31.4034s
	iters: 1000, epoch: 9 | loss: 0.6058613
	speed: 0.0224s/iter; left time: 28.1915s
	iters: 1100, epoch: 9 | loss: 0.7701595
	speed: 0.0219s/iter; left time: 25.3697s
Epoch: 9 cost time: 24.67216920852661
Epoch: 9, Steps: 1128 | Train Loss: 0.6368952 Vali Loss: 0.7208063 Test Loss: 0.3585022
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.3572273850440979, mae:0.34884822368621826
