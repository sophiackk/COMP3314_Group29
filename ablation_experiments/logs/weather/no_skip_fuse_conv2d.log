nohup: ignoring input
Seed: 42
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_96       Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip True
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.4808677
	speed: 0.0770s/iter; left time: 875.6474s
	iters: 200, epoch: 1 | loss: 0.4004802
	speed: 0.0426s/iter; left time: 479.7888s
	iters: 300, epoch: 1 | loss: 0.4179203
	speed: 0.0311s/iter; left time: 347.3400s
	iters: 400, epoch: 1 | loss: 0.3070052
	speed: 0.0253s/iter; left time: 280.5823s
	iters: 500, epoch: 1 | loss: 0.4744933
	speed: 0.0215s/iter; left time: 236.3146s
	iters: 600, epoch: 1 | loss: 0.4081607
	speed: 0.0191s/iter; left time: 208.1246s
	iters: 700, epoch: 1 | loss: 0.4038537
	speed: 0.0173s/iter; left time: 186.4180s
	iters: 800, epoch: 1 | loss: 0.3193832
	speed: 0.0159s/iter; left time: 170.1862s
	iters: 900, epoch: 1 | loss: 0.5567208
	speed: 0.0149s/iter; left time: 157.6660s
	iters: 1000, epoch: 1 | loss: 0.4429156
	speed: 0.0141s/iter; left time: 147.4378s
	iters: 1100, epoch: 1 | loss: 0.3938821
	speed: 0.0134s/iter; left time: 138.7541s
Epoch: 1 cost time: 15.037824392318726
Epoch: 1, Steps: 1147 | Train Loss: 0.5143733 Vali Loss: 0.4546627 Test Loss: 0.1901541
Validation loss decreased (inf --> 0.454663).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5017322
	speed: 0.0075s/iter; left time: 76.6126s
	iters: 200, epoch: 2 | loss: 0.2926594
	speed: 0.0068s/iter; left time: 68.5425s
	iters: 300, epoch: 2 | loss: 0.4465620
	speed: 0.0065s/iter; left time: 65.2825s
	iters: 400, epoch: 2 | loss: 0.3060470
	speed: 0.0064s/iter; left time: 63.3335s
	iters: 500, epoch: 2 | loss: 0.3458996
	speed: 0.0063s/iter; left time: 62.0797s
	iters: 600, epoch: 2 | loss: 0.5906266
	speed: 0.0063s/iter; left time: 60.8728s
	iters: 700, epoch: 2 | loss: 0.4230473
	speed: 0.0062s/iter; left time: 59.8749s
	iters: 800, epoch: 2 | loss: 1.0931404
	speed: 0.0062s/iter; left time: 58.9722s
	iters: 900, epoch: 2 | loss: 0.3351751
	speed: 0.0062s/iter; left time: 58.1145s
	iters: 1000, epoch: 2 | loss: 1.2216133
	speed: 0.0062s/iter; left time: 57.3882s
	iters: 1100, epoch: 2 | loss: 0.2704858
	speed: 0.0061s/iter; left time: 56.6955s
Epoch: 2 cost time: 7.1059465408325195
Epoch: 2, Steps: 1147 | Train Loss: 0.4583414 Vali Loss: 0.4413245 Test Loss: 0.1818490
Validation loss decreased (0.454663 --> 0.441325).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2899137
	speed: 0.0078s/iter; left time: 70.4885s
	iters: 200, epoch: 3 | loss: 0.3914581
	speed: 0.0073s/iter; left time: 65.2730s
	iters: 300, epoch: 3 | loss: 0.4361562
	speed: 0.0075s/iter; left time: 66.3236s
	iters: 400, epoch: 3 | loss: 0.3117311
	speed: 0.0074s/iter; left time: 65.0096s
	iters: 500, epoch: 3 | loss: 0.4194883
	speed: 0.0071s/iter; left time: 61.8207s
	iters: 600, epoch: 3 | loss: 0.2893737
	speed: 0.0069s/iter; left time: 59.5297s
	iters: 700, epoch: 3 | loss: 0.3499577
	speed: 0.0068s/iter; left time: 57.6349s
	iters: 800, epoch: 3 | loss: 0.3727731
	speed: 0.0067s/iter; left time: 56.0691s
	iters: 900, epoch: 3 | loss: 0.2918918
	speed: 0.0066s/iter; left time: 54.7125s
	iters: 1000, epoch: 3 | loss: 0.4753501
	speed: 0.0066s/iter; left time: 53.7290s
	iters: 1100, epoch: 3 | loss: 0.3187953
	speed: 0.0065s/iter; left time: 52.8601s
Epoch: 3 cost time: 7.558533191680908
Epoch: 3, Steps: 1147 | Train Loss: 0.4334666 Vali Loss: 0.4242024 Test Loss: 0.1807423
Validation loss decreased (0.441325 --> 0.424202).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2238663
	speed: 0.0091s/iter; left time: 72.1914s
	iters: 200, epoch: 4 | loss: 0.3255339
	speed: 0.0081s/iter; left time: 63.3904s
	iters: 300, epoch: 4 | loss: 0.3716295
	speed: 0.0078s/iter; left time: 59.9641s
	iters: 400, epoch: 4 | loss: 0.3670091
	speed: 0.0073s/iter; left time: 55.9569s
	iters: 500, epoch: 4 | loss: 0.3013611
	speed: 0.0071s/iter; left time: 53.2153s
	iters: 600, epoch: 4 | loss: 0.3495525
	speed: 0.0069s/iter; left time: 51.1058s
	iters: 700, epoch: 4 | loss: 0.3963357
	speed: 0.0068s/iter; left time: 49.4850s
	iters: 800, epoch: 4 | loss: 0.2622323
	speed: 0.0067s/iter; left time: 48.1515s
	iters: 900, epoch: 4 | loss: 0.3122671
	speed: 0.0066s/iter; left time: 46.9051s
	iters: 1000, epoch: 4 | loss: 0.3826384
	speed: 0.0065s/iter; left time: 45.7992s
	iters: 1100, epoch: 4 | loss: 0.3240117
	speed: 0.0065s/iter; left time: 44.8029s
Epoch: 4 cost time: 7.440923690795898
Epoch: 4, Steps: 1147 | Train Loss: 0.4223028 Vali Loss: 0.4227056 Test Loss: 0.1774651
Validation loss decreased (0.424202 --> 0.422706).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2545463
	speed: 0.0073s/iter; left time: 49.8161s
	iters: 200, epoch: 5 | loss: 0.3062863
	speed: 0.0067s/iter; left time: 44.5252s
	iters: 300, epoch: 5 | loss: 0.3093340
	speed: 0.0064s/iter; left time: 42.3615s
	iters: 400, epoch: 5 | loss: 0.5218107
	speed: 0.0063s/iter; left time: 40.9561s
	iters: 500, epoch: 5 | loss: 1.2373084
	speed: 0.0062s/iter; left time: 39.8834s
	iters: 600, epoch: 5 | loss: 0.2160475
	speed: 0.0062s/iter; left time: 38.9736s
	iters: 700, epoch: 5 | loss: 0.4308899
	speed: 0.0062s/iter; left time: 38.1461s
	iters: 800, epoch: 5 | loss: 1.2334951
	speed: 0.0061s/iter; left time: 37.3942s
	iters: 900, epoch: 5 | loss: 0.3821522
	speed: 0.0061s/iter; left time: 36.6700s
	iters: 1000, epoch: 5 | loss: 0.3170203
	speed: 0.0061s/iter; left time: 36.0047s
	iters: 1100, epoch: 5 | loss: 0.3110622
	speed: 0.0061s/iter; left time: 35.3103s
Epoch: 5 cost time: 7.0632407665252686
Epoch: 5, Steps: 1147 | Train Loss: 0.4154342 Vali Loss: 0.4206896 Test Loss: 0.1777749
Validation loss decreased (0.422706 --> 0.420690).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3608432
	speed: 0.0084s/iter; left time: 47.5335s
	iters: 200, epoch: 6 | loss: 0.3160885
	speed: 0.0078s/iter; left time: 42.9597s
	iters: 300, epoch: 6 | loss: 0.2699074
	speed: 0.0075s/iter; left time: 40.9460s
	iters: 400, epoch: 6 | loss: 0.2410409
	speed: 0.0074s/iter; left time: 39.5785s
	iters: 500, epoch: 6 | loss: 0.2455567
	speed: 0.0072s/iter; left time: 37.4895s
	iters: 600, epoch: 6 | loss: 0.4837133
	speed: 0.0070s/iter; left time: 35.7633s
	iters: 700, epoch: 6 | loss: 0.3277351
	speed: 0.0069s/iter; left time: 34.8397s
	iters: 800, epoch: 6 | loss: 0.3256082
	speed: 0.0069s/iter; left time: 34.2679s
	iters: 900, epoch: 6 | loss: 0.2478869
	speed: 0.0070s/iter; left time: 33.6621s
	iters: 1000, epoch: 6 | loss: 0.3173262
	speed: 0.0070s/iter; left time: 33.0437s
	iters: 1100, epoch: 6 | loss: 0.9717742
	speed: 0.0070s/iter; left time: 32.3948s
Epoch: 6 cost time: 8.126179456710815
Epoch: 6, Steps: 1147 | Train Loss: 0.4119766 Vali Loss: 0.4207826 Test Loss: 0.1769131
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3467021
	speed: 0.0071s/iter; left time: 31.9618s
	iters: 200, epoch: 7 | loss: 1.3431332
	speed: 0.0065s/iter; left time: 28.6662s
	iters: 300, epoch: 7 | loss: 0.3021750
	speed: 0.0063s/iter; left time: 27.1654s
	iters: 400, epoch: 7 | loss: 0.2979670
	speed: 0.0063s/iter; left time: 26.2239s
	iters: 500, epoch: 7 | loss: 0.2687067
	speed: 0.0062s/iter; left time: 25.3485s
	iters: 600, epoch: 7 | loss: 0.4276055
	speed: 0.0062s/iter; left time: 24.5713s
	iters: 700, epoch: 7 | loss: 1.2447902
	speed: 0.0061s/iter; left time: 23.8476s
	iters: 800, epoch: 7 | loss: 0.2899626
	speed: 0.0061s/iter; left time: 23.1486s
	iters: 900, epoch: 7 | loss: 0.2293158
	speed: 0.0061s/iter; left time: 22.4815s
	iters: 1000, epoch: 7 | loss: 0.3457089
	speed: 0.0061s/iter; left time: 21.8205s
	iters: 1100, epoch: 7 | loss: 0.3276779
	speed: 0.0061s/iter; left time: 21.1673s
Epoch: 7 cost time: 6.9926018714904785
Epoch: 7, Steps: 1147 | Train Loss: 0.4103469 Vali Loss: 0.4209468 Test Loss: 0.1762271
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2996087
	speed: 0.0072s/iter; left time: 24.1631s
	iters: 200, epoch: 8 | loss: 0.3845389
	speed: 0.0066s/iter; left time: 21.4310s
	iters: 300, epoch: 8 | loss: 0.2678420
	speed: 0.0064s/iter; left time: 20.1200s
	iters: 400, epoch: 8 | loss: 0.3137262
	speed: 0.0063s/iter; left time: 19.1564s
	iters: 500, epoch: 8 | loss: 0.2211231
	speed: 0.0063s/iter; left time: 18.4300s
	iters: 600, epoch: 8 | loss: 0.2527633
	speed: 0.0062s/iter; left time: 17.6664s
	iters: 700, epoch: 8 | loss: 1.4398805
	speed: 0.0062s/iter; left time: 16.9340s
	iters: 800, epoch: 8 | loss: 0.4188015
	speed: 0.0062s/iter; left time: 16.2526s
	iters: 900, epoch: 8 | loss: 0.3295463
	speed: 0.0061s/iter; left time: 15.5945s
	iters: 1000, epoch: 8 | loss: 0.3076158
	speed: 0.0061s/iter; left time: 14.9398s
	iters: 1100, epoch: 8 | loss: 0.2628012
	speed: 0.0061s/iter; left time: 14.2978s
Epoch: 8 cost time: 7.044830083847046
Epoch: 8, Steps: 1147 | Train Loss: 0.4092610 Vali Loss: 0.4201469 Test Loss: 0.1760195
Validation loss decreased (0.420690 --> 0.420147).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2867892
	speed: 0.0074s/iter; left time: 16.1994s
	iters: 200, epoch: 9 | loss: 0.2201095
	speed: 0.0067s/iter; left time: 13.9367s
	iters: 300, epoch: 9 | loss: 0.2279025
	speed: 0.0064s/iter; left time: 12.7980s
	iters: 400, epoch: 9 | loss: 0.2520766
	speed: 0.0063s/iter; left time: 11.9289s
	iters: 500, epoch: 9 | loss: 0.2220345
	speed: 0.0062s/iter; left time: 11.1756s
	iters: 600, epoch: 9 | loss: 0.3084508
	speed: 0.0062s/iter; left time: 10.4688s
	iters: 700, epoch: 9 | loss: 0.4108570
	speed: 0.0061s/iter; left time: 9.7960s
	iters: 800, epoch: 9 | loss: 0.3398733
	speed: 0.0061s/iter; left time: 9.1546s
	iters: 900, epoch: 9 | loss: 0.3385089
	speed: 0.0061s/iter; left time: 8.5223s
	iters: 1000, epoch: 9 | loss: 0.3778584
	speed: 0.0061s/iter; left time: 7.9271s
	iters: 1100, epoch: 9 | loss: 0.2360925
	speed: 0.0061s/iter; left time: 7.3058s
Epoch: 9 cost time: 7.077629089355469
Epoch: 9, Steps: 1147 | Train Loss: 0.4090768 Vali Loss: 0.4208742 Test Loss: 0.1763359
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 1.3368318
	speed: 0.0073s/iter; left time: 7.6563s
	iters: 200, epoch: 10 | loss: 0.3041065
	speed: 0.0066s/iter; left time: 6.3031s
	iters: 300, epoch: 10 | loss: 0.2390079
	speed: 0.0066s/iter; left time: 5.6031s
	iters: 400, epoch: 10 | loss: 0.4189461
	speed: 0.0069s/iter; left time: 5.1881s
	iters: 500, epoch: 10 | loss: 0.2538123
	speed: 0.0072s/iter; left time: 4.6609s
	iters: 600, epoch: 10 | loss: 0.1834585
	speed: 0.0075s/iter; left time: 4.1057s
	iters: 700, epoch: 10 | loss: 0.1922709
	speed: 0.0079s/iter; left time: 3.5433s
	iters: 800, epoch: 10 | loss: 1.0457388
	speed: 0.0082s/iter; left time: 2.8453s
	iters: 900, epoch: 10 | loss: 0.4579034
	speed: 0.0084s/iter; left time: 2.0823s
	iters: 1000, epoch: 10 | loss: 0.2842349
	speed: 0.0084s/iter; left time: 1.2434s
	iters: 1100, epoch: 10 | loss: 0.3599284
	speed: 0.0084s/iter; left time: 0.4043s
Epoch: 10 cost time: 9.713892459869385
Epoch: 10, Steps: 1147 | Train Loss: 0.4086596 Vali Loss: 0.4206058 Test Loss: 0.1761748
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.17601953446865082, mae:0.22115114331245422
Use GPU: cuda:0
no_skip True
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.4103456
	speed: 0.0082s/iter; left time: 93.4923s
	iters: 200, epoch: 1 | loss: 0.4497083
	speed: 0.0076s/iter; left time: 85.6158s
	iters: 300, epoch: 1 | loss: 0.4263996
	speed: 0.0071s/iter; left time: 78.7884s
	iters: 400, epoch: 1 | loss: 0.4342989
	speed: 0.0068s/iter; left time: 75.1335s
	iters: 500, epoch: 1 | loss: 0.4763514
	speed: 0.0066s/iter; left time: 72.6232s
	iters: 600, epoch: 1 | loss: 0.3735622
	speed: 0.0065s/iter; left time: 70.8904s
	iters: 700, epoch: 1 | loss: 0.3242814
	speed: 0.0065s/iter; left time: 69.5961s
	iters: 800, epoch: 1 | loss: 0.4188742
	speed: 0.0064s/iter; left time: 68.7187s
	iters: 900, epoch: 1 | loss: 0.6546486
	speed: 0.0064s/iter; left time: 67.6416s
	iters: 1000, epoch: 1 | loss: 0.4354781
	speed: 0.0064s/iter; left time: 66.6418s
	iters: 1100, epoch: 1 | loss: 0.3207733
	speed: 0.0063s/iter; left time: 65.6507s
Epoch: 1 cost time: 7.3033318519592285
Epoch: 1, Steps: 1147 | Train Loss: 0.5250637 Vali Loss: 0.4675436 Test Loss: 0.1888740
Validation loss decreased (inf --> 0.467544).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3865284
	speed: 0.0099s/iter; left time: 100.9384s
	iters: 200, epoch: 2 | loss: 0.3290805
	speed: 0.0085s/iter; left time: 85.7800s
	iters: 300, epoch: 2 | loss: 0.3881741
	speed: 0.0080s/iter; left time: 80.4186s
	iters: 400, epoch: 2 | loss: 1.2049210
	speed: 0.0077s/iter; left time: 76.0381s
	iters: 500, epoch: 2 | loss: 0.3106369
	speed: 0.0073s/iter; left time: 72.1331s
	iters: 600, epoch: 2 | loss: 0.4013283
	speed: 0.0071s/iter; left time: 69.3346s
	iters: 700, epoch: 2 | loss: 0.3769181
	speed: 0.0070s/iter; left time: 67.0188s
	iters: 800, epoch: 2 | loss: 0.4886058
	speed: 0.0068s/iter; left time: 65.1409s
	iters: 900, epoch: 2 | loss: 0.2250056
	speed: 0.0067s/iter; left time: 63.5390s
	iters: 1000, epoch: 2 | loss: 0.2773175
	speed: 0.0067s/iter; left time: 62.1267s
	iters: 1100, epoch: 2 | loss: 0.3772265
	speed: 0.0066s/iter; left time: 60.8516s
Epoch: 2 cost time: 7.5996129512786865
Epoch: 2, Steps: 1147 | Train Loss: 0.4597529 Vali Loss: 0.4464340 Test Loss: 0.1849363
Validation loss decreased (0.467544 --> 0.446434).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4001397
	speed: 0.0079s/iter; left time: 72.0050s
	iters: 200, epoch: 3 | loss: 0.2816410
	speed: 0.0070s/iter; left time: 62.8283s
	iters: 300, epoch: 3 | loss: 0.3822611
	speed: 0.0067s/iter; left time: 59.3330s
	iters: 400, epoch: 3 | loss: 0.2702391
	speed: 0.0065s/iter; left time: 57.1071s
	iters: 500, epoch: 3 | loss: 0.3280914
	speed: 0.0064s/iter; left time: 55.5030s
	iters: 600, epoch: 3 | loss: 0.3160923
	speed: 0.0063s/iter; left time: 54.2642s
	iters: 700, epoch: 3 | loss: 0.5184085
	speed: 0.0063s/iter; left time: 53.2357s
	iters: 800, epoch: 3 | loss: 0.3364386
	speed: 0.0062s/iter; left time: 52.3111s
	iters: 900, epoch: 3 | loss: 0.2855691
	speed: 0.0062s/iter; left time: 51.4392s
	iters: 1000, epoch: 3 | loss: 0.3091756
	speed: 0.0062s/iter; left time: 50.6296s
	iters: 1100, epoch: 3 | loss: 0.2959177
	speed: 0.0062s/iter; left time: 49.8737s
Epoch: 3 cost time: 7.124762535095215
Epoch: 3, Steps: 1147 | Train Loss: 0.4367610 Vali Loss: 0.4426055 Test Loss: 0.1815904
Validation loss decreased (0.446434 --> 0.442605).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 1.2423984
	speed: 0.0094s/iter; left time: 74.7468s
	iters: 200, epoch: 4 | loss: 0.3839929
	speed: 0.0084s/iter; left time: 65.8445s
	iters: 300, epoch: 4 | loss: 0.4016656
	speed: 0.0081s/iter; left time: 62.5842s
	iters: 400, epoch: 4 | loss: 0.2885969
	speed: 0.0076s/iter; left time: 57.7404s
	iters: 500, epoch: 4 | loss: 0.3443469
	speed: 0.0073s/iter; left time: 54.7051s
	iters: 600, epoch: 4 | loss: 0.2444320
	speed: 0.0071s/iter; left time: 52.4732s
	iters: 700, epoch: 4 | loss: 0.2608851
	speed: 0.0071s/iter; left time: 51.7906s
	iters: 800, epoch: 4 | loss: 0.3459290
	speed: 0.0070s/iter; left time: 50.8552s
	iters: 900, epoch: 4 | loss: 0.3219327
	speed: 0.0069s/iter; left time: 49.4456s
	iters: 1000, epoch: 4 | loss: 0.4595708
	speed: 0.0069s/iter; left time: 48.1722s
	iters: 1100, epoch: 4 | loss: 1.3328849
	speed: 0.0068s/iter; left time: 47.0200s
Epoch: 4 cost time: 7.811654090881348
Epoch: 4, Steps: 1147 | Train Loss: 0.4244114 Vali Loss: 0.4372546 Test Loss: 0.1782476
Validation loss decreased (0.442605 --> 0.437255).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2602485
	speed: 0.0074s/iter; left time: 50.5291s
	iters: 200, epoch: 5 | loss: 0.3105795
	speed: 0.0070s/iter; left time: 46.8899s
	iters: 300, epoch: 5 | loss: 1.2471726
	speed: 0.0071s/iter; left time: 46.4700s
	iters: 400, epoch: 5 | loss: 0.3302571
	speed: 0.0068s/iter; left time: 44.2042s
	iters: 500, epoch: 5 | loss: 0.3660081
	speed: 0.0067s/iter; left time: 42.4565s
	iters: 600, epoch: 5 | loss: 0.3275090
	speed: 0.0066s/iter; left time: 41.2040s
	iters: 700, epoch: 5 | loss: 0.2262185
	speed: 0.0065s/iter; left time: 40.1251s
	iters: 800, epoch: 5 | loss: 0.3348391
	speed: 0.0065s/iter; left time: 39.2637s
	iters: 900, epoch: 5 | loss: 0.2758866
	speed: 0.0064s/iter; left time: 38.5507s
	iters: 1000, epoch: 5 | loss: 0.5047879
	speed: 0.0065s/iter; left time: 38.1793s
	iters: 1100, epoch: 5 | loss: 0.3154783
	speed: 0.0065s/iter; left time: 37.8322s
Epoch: 5 cost time: 7.619382381439209
Epoch: 5, Steps: 1147 | Train Loss: 0.4178414 Vali Loss: 0.4359001 Test Loss: 0.1778426
Validation loss decreased (0.437255 --> 0.435900).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2499905
	speed: 0.0087s/iter; left time: 48.7830s
	iters: 200, epoch: 6 | loss: 0.3151520
	speed: 0.0076s/iter; left time: 41.8119s
	iters: 300, epoch: 6 | loss: 0.4074763
	speed: 0.0072s/iter; left time: 38.9989s
	iters: 400, epoch: 6 | loss: 0.4223961
	speed: 0.0070s/iter; left time: 37.2146s
	iters: 500, epoch: 6 | loss: 0.3300230
	speed: 0.0068s/iter; left time: 35.5372s
	iters: 600, epoch: 6 | loss: 0.3376580
	speed: 0.0067s/iter; left time: 34.2308s
	iters: 700, epoch: 6 | loss: 0.3539497
	speed: 0.0066s/iter; left time: 33.0856s
	iters: 800, epoch: 6 | loss: 0.2896297
	speed: 0.0065s/iter; left time: 32.0667s
	iters: 900, epoch: 6 | loss: 0.3777699
	speed: 0.0064s/iter; left time: 31.1213s
	iters: 1000, epoch: 6 | loss: 0.3385442
	speed: 0.0064s/iter; left time: 30.2710s
	iters: 1100, epoch: 6 | loss: 0.2294210
	speed: 0.0064s/iter; left time: 29.4565s
Epoch: 6 cost time: 7.328018426895142
Epoch: 6, Steps: 1147 | Train Loss: 0.4140816 Vali Loss: 0.4378153 Test Loss: 0.1790457
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 1.3611076
	speed: 0.0101s/iter; left time: 45.1535s
	iters: 200, epoch: 7 | loss: 0.3138798
	speed: 0.0092s/iter; left time: 40.2693s
	iters: 300, epoch: 7 | loss: 0.3690073
	speed: 0.0089s/iter; left time: 38.1268s
	iters: 400, epoch: 7 | loss: 0.4195630
	speed: 0.0083s/iter; left time: 34.8580s
	iters: 500, epoch: 7 | loss: 0.4882320
	speed: 0.0080s/iter; left time: 32.5139s
	iters: 600, epoch: 7 | loss: 0.2148349
	speed: 0.0079s/iter; left time: 31.4660s
	iters: 700, epoch: 7 | loss: 0.3197442
	speed: 0.0080s/iter; left time: 31.0669s
	iters: 800, epoch: 7 | loss: 0.2826643
	speed: 0.0080s/iter; left time: 30.3843s
	iters: 900, epoch: 7 | loss: 0.3528461
	speed: 0.0080s/iter; left time: 29.6679s
	iters: 1000, epoch: 7 | loss: 0.4007498
	speed: 0.0080s/iter; left time: 28.6248s
	iters: 1100, epoch: 7 | loss: 0.3185619
	speed: 0.0078s/iter; left time: 27.3566s
Epoch: 7 cost time: 8.986379384994507
Epoch: 7, Steps: 1147 | Train Loss: 0.4122346 Vali Loss: 0.4345655 Test Loss: 0.1771030
Validation loss decreased (0.435900 --> 0.434565).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3139421
	speed: 0.0092s/iter; left time: 30.8678s
	iters: 200, epoch: 8 | loss: 0.2679156
	speed: 0.0082s/iter; left time: 26.4625s
	iters: 300, epoch: 8 | loss: 0.2774776
	speed: 0.0077s/iter; left time: 24.2937s
	iters: 400, epoch: 8 | loss: 0.3288127
	speed: 0.0073s/iter; left time: 22.1888s
	iters: 500, epoch: 8 | loss: 1.0649940
	speed: 0.0070s/iter; left time: 20.7293s
	iters: 600, epoch: 8 | loss: 0.3735350
	speed: 0.0069s/iter; left time: 19.5440s
	iters: 700, epoch: 8 | loss: 1.2657467
	speed: 0.0068s/iter; left time: 18.5310s
	iters: 800, epoch: 8 | loss: 0.3229849
	speed: 0.0067s/iter; left time: 17.6134s
	iters: 900, epoch: 8 | loss: 0.2746918
	speed: 0.0066s/iter; left time: 16.7765s
	iters: 1000, epoch: 8 | loss: 0.2734276
	speed: 0.0065s/iter; left time: 15.9780s
	iters: 1100, epoch: 8 | loss: 0.3327884
	speed: 0.0065s/iter; left time: 15.2137s
Epoch: 8 cost time: 7.486318588256836
Epoch: 8, Steps: 1147 | Train Loss: 0.4109249 Vali Loss: 0.4341340 Test Loss: 0.1770356
Validation loss decreased (0.434565 --> 0.434134).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3397830
	speed: 0.0092s/iter; left time: 20.1929s
	iters: 200, epoch: 9 | loss: 0.2964662
	speed: 0.0082s/iter; left time: 17.2756s
	iters: 300, epoch: 9 | loss: 0.2682991
	speed: 0.0082s/iter; left time: 16.3753s
	iters: 400, epoch: 9 | loss: 0.3831695
	speed: 0.0079s/iter; left time: 14.9335s
	iters: 500, epoch: 9 | loss: 0.5378467
	speed: 0.0079s/iter; left time: 14.1325s
	iters: 600, epoch: 9 | loss: 0.3137388
	speed: 0.0077s/iter; left time: 13.0091s
	iters: 700, epoch: 9 | loss: 0.4164155
	speed: 0.0075s/iter; left time: 12.0402s
	iters: 800, epoch: 9 | loss: 0.3400437
	speed: 0.0074s/iter; left time: 11.0990s
	iters: 900, epoch: 9 | loss: 0.2750248
	speed: 0.0077s/iter; left time: 10.7103s
	iters: 1000, epoch: 9 | loss: 1.2920167
	speed: 0.0089s/iter; left time: 11.4814s
	iters: 1100, epoch: 9 | loss: 0.2909930
	speed: 0.0098s/iter; left time: 11.6913s
Epoch: 9 cost time: 11.621789693832397
Epoch: 9, Steps: 1147 | Train Loss: 0.4106375 Vali Loss: 0.4355644 Test Loss: 0.1774385
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3804886
	speed: 0.0156s/iter; left time: 16.3295s
	iters: 200, epoch: 10 | loss: 0.3825815
	speed: 0.0137s/iter; left time: 13.0258s
	iters: 300, epoch: 10 | loss: 0.2954409
	speed: 0.0138s/iter; left time: 11.7404s
	iters: 400, epoch: 10 | loss: 0.2518636
	speed: 0.0150s/iter; left time: 11.2246s
	iters: 500, epoch: 10 | loss: 0.3730284
	speed: 0.0144s/iter; left time: 9.3292s
	iters: 600, epoch: 10 | loss: 0.2073298
	speed: 0.0138s/iter; left time: 7.5413s
	iters: 700, epoch: 10 | loss: 0.3362015
	speed: 0.0142s/iter; left time: 6.3399s
	iters: 800, epoch: 10 | loss: 0.3233370
	speed: 0.0147s/iter; left time: 5.1090s
	iters: 900, epoch: 10 | loss: 0.3448027
	speed: 0.0145s/iter; left time: 3.5940s
	iters: 1000, epoch: 10 | loss: 0.3058676
	speed: 0.0143s/iter; left time: 2.1227s
	iters: 1100, epoch: 10 | loss: 0.2796416
	speed: 0.0143s/iter; left time: 0.6861s
Epoch: 10 cost time: 16.546432971954346
Epoch: 10, Steps: 1147 | Train Loss: 0.4104257 Vali Loss: 0.4347070 Test Loss: 0.1770803
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.17703558504581451, mae:0.22197885811328888
Use GPU: cuda:0
no_skip True
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.5256230
	speed: 0.0158s/iter; left time: 179.7143s
	iters: 200, epoch: 1 | loss: 0.5427825
	speed: 0.0138s/iter; left time: 155.2469s
	iters: 300, epoch: 1 | loss: 0.4733976
	speed: 0.0144s/iter; left time: 161.1991s
	iters: 400, epoch: 1 | loss: 0.2953726
	speed: 0.0146s/iter; left time: 161.6650s
	iters: 500, epoch: 1 | loss: 0.3700976
	speed: 0.0140s/iter; left time: 153.8695s
	iters: 600, epoch: 1 | loss: 0.8015819
	speed: 0.0136s/iter; left time: 147.6812s
	iters: 700, epoch: 1 | loss: 1.4480959
	speed: 0.0133s/iter; left time: 143.7835s
	iters: 800, epoch: 1 | loss: 0.6802674
	speed: 0.0135s/iter; left time: 143.8964s
	iters: 900, epoch: 1 | loss: 0.3885509
	speed: 0.0135s/iter; left time: 142.1941s
	iters: 1000, epoch: 1 | loss: 0.3789315
	speed: 0.0135s/iter; left time: 141.4144s
	iters: 1100, epoch: 1 | loss: 1.2939540
	speed: 0.0134s/iter; left time: 139.1469s
Epoch: 1 cost time: 15.489540100097656
Epoch: 1, Steps: 1147 | Train Loss: 0.5151262 Vali Loss: 0.4547195 Test Loss: 0.1888030
Validation loss decreased (inf --> 0.454719).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3236937
	speed: 0.0168s/iter; left time: 172.2393s
	iters: 200, epoch: 2 | loss: 1.2536832
	speed: 0.0143s/iter; left time: 145.2078s
	iters: 300, epoch: 2 | loss: 0.3175425
	speed: 0.0144s/iter; left time: 144.1748s
	iters: 400, epoch: 2 | loss: 0.4287813
	speed: 0.0137s/iter; left time: 135.9602s
	iters: 500, epoch: 2 | loss: 0.3763846
	speed: 0.0134s/iter; left time: 131.2228s
	iters: 600, epoch: 2 | loss: 1.3108251
	speed: 0.0134s/iter; left time: 130.7875s
	iters: 700, epoch: 2 | loss: 0.3730763
	speed: 0.0136s/iter; left time: 131.0805s
	iters: 800, epoch: 2 | loss: 0.3252756
	speed: 0.0136s/iter; left time: 129.1185s
	iters: 900, epoch: 2 | loss: 0.4233886
	speed: 0.0134s/iter; left time: 125.8158s
	iters: 1000, epoch: 2 | loss: 1.2438825
	speed: 0.0134s/iter; left time: 124.8712s
	iters: 1100, epoch: 2 | loss: 0.6247043
	speed: 0.0137s/iter; left time: 126.6809s
Epoch: 2 cost time: 16.026245832443237
Epoch: 2, Steps: 1147 | Train Loss: 0.4552869 Vali Loss: 0.4390801 Test Loss: 0.1853796
Validation loss decreased (0.454719 --> 0.439080).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3047100
	speed: 0.0161s/iter; left time: 146.2035s
	iters: 200, epoch: 3 | loss: 0.3663982
	speed: 0.0148s/iter; left time: 132.4757s
	iters: 300, epoch: 3 | loss: 0.3547002
	speed: 0.0149s/iter; left time: 132.5787s
	iters: 400, epoch: 3 | loss: 1.3288299
	speed: 0.0147s/iter; left time: 128.7607s
	iters: 500, epoch: 3 | loss: 1.2558415
	speed: 0.0144s/iter; left time: 125.2453s
	iters: 600, epoch: 3 | loss: 0.8529761
	speed: 0.0146s/iter; left time: 124.9032s
	iters: 700, epoch: 3 | loss: 0.2877245
	speed: 0.0151s/iter; left time: 127.7627s
	iters: 800, epoch: 3 | loss: 0.5022647
	speed: 0.0148s/iter; left time: 123.7732s
	iters: 900, epoch: 3 | loss: 0.3264019
	speed: 0.0143s/iter; left time: 118.6069s
	iters: 1000, epoch: 3 | loss: 0.3133939
	speed: 0.0142s/iter; left time: 116.3216s
	iters: 1100, epoch: 3 | loss: 0.3793749
	speed: 0.0144s/iter; left time: 115.9508s
Epoch: 3 cost time: 16.622376918792725
Epoch: 3, Steps: 1147 | Train Loss: 0.4351244 Vali Loss: 0.4301958 Test Loss: 0.1800462
Validation loss decreased (0.439080 --> 0.430196).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3429684
	speed: 0.0202s/iter; left time: 160.4573s
	iters: 200, epoch: 4 | loss: 0.3532895
	speed: 0.0166s/iter; left time: 129.6581s
	iters: 300, epoch: 4 | loss: 0.2771206
	speed: 0.0168s/iter; left time: 129.8835s
	iters: 400, epoch: 4 | loss: 0.2589937
	speed: 0.0157s/iter; left time: 120.0194s
	iters: 500, epoch: 4 | loss: 1.4737235
	speed: 0.0158s/iter; left time: 118.8174s
	iters: 600, epoch: 4 | loss: 0.4461461
	speed: 0.0154s/iter; left time: 114.6548s
	iters: 700, epoch: 4 | loss: 0.2911693
	speed: 0.0155s/iter; left time: 113.6597s
	iters: 800, epoch: 4 | loss: 0.3243829
	speed: 0.0156s/iter; left time: 112.8038s
	iters: 900, epoch: 4 | loss: 0.2915303
	speed: 0.0152s/iter; left time: 108.4728s
	iters: 1000, epoch: 4 | loss: 0.2878431
	speed: 0.0150s/iter; left time: 105.2044s
	iters: 1100, epoch: 4 | loss: 0.3396372
	speed: 0.0148s/iter; left time: 102.5480s
Epoch: 4 cost time: 17.10262703895569
Epoch: 4, Steps: 1147 | Train Loss: 0.4222544 Vali Loss: 0.4264860 Test Loss: 0.1788411
Validation loss decreased (0.430196 --> 0.426486).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2737342
	speed: 0.0167s/iter; left time: 113.0018s
	iters: 200, epoch: 5 | loss: 1.0524004
	speed: 0.0158s/iter; left time: 105.4202s
	iters: 300, epoch: 5 | loss: 0.3006311
	speed: 0.0155s/iter; left time: 102.1560s
	iters: 400, epoch: 5 | loss: 0.3233093
	speed: 0.0153s/iter; left time: 99.3795s
	iters: 500, epoch: 5 | loss: 0.3543948
	speed: 0.0156s/iter; left time: 99.5558s
	iters: 600, epoch: 5 | loss: 0.3546764
	speed: 0.0156s/iter; left time: 97.8350s
	iters: 700, epoch: 5 | loss: 0.2437958
	speed: 0.0152s/iter; left time: 93.9680s
	iters: 800, epoch: 5 | loss: 0.3182673
	speed: 0.0154s/iter; left time: 93.5205s
	iters: 900, epoch: 5 | loss: 0.2695993
	speed: 0.0156s/iter; left time: 93.3229s
	iters: 1000, epoch: 5 | loss: 0.1949078
	speed: 0.0154s/iter; left time: 90.3443s
	iters: 1100, epoch: 5 | loss: 0.2358623
	speed: 0.0151s/iter; left time: 87.5128s
Epoch: 5 cost time: 17.256765127182007
Epoch: 5, Steps: 1147 | Train Loss: 0.4163741 Vali Loss: 0.4286644 Test Loss: 0.1788183
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2677615
	speed: 0.0178s/iter; left time: 100.2575s
	iters: 200, epoch: 6 | loss: 0.2771870
	speed: 0.0175s/iter; left time: 96.9396s
	iters: 300, epoch: 6 | loss: 0.3439906
	speed: 0.0161s/iter; left time: 87.3528s
	iters: 400, epoch: 6 | loss: 0.4499910
	speed: 0.0148s/iter; left time: 78.9938s
	iters: 500, epoch: 6 | loss: 0.2849883
	speed: 0.0146s/iter; left time: 76.4154s
	iters: 600, epoch: 6 | loss: 0.4164348
	speed: 0.0145s/iter; left time: 74.4002s
	iters: 700, epoch: 6 | loss: 0.3534446
	speed: 0.0138s/iter; left time: 69.5650s
	iters: 800, epoch: 6 | loss: 0.2880726
	speed: 0.0133s/iter; left time: 65.7969s
	iters: 900, epoch: 6 | loss: 0.3539298
	speed: 0.0130s/iter; left time: 62.9410s
	iters: 1000, epoch: 6 | loss: 1.0907511
	speed: 0.0127s/iter; left time: 59.9945s
	iters: 1100, epoch: 6 | loss: 0.3174312
	speed: 0.0128s/iter; left time: 59.2636s
Epoch: 6 cost time: 14.66704511642456
Epoch: 6, Steps: 1147 | Train Loss: 0.4125465 Vali Loss: 0.4307886 Test Loss: 0.1795515
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3047340
	speed: 0.0118s/iter; left time: 53.1277s
	iters: 200, epoch: 7 | loss: 0.4528518
	speed: 0.0107s/iter; left time: 46.8358s
	iters: 300, epoch: 7 | loss: 0.2703917
	speed: 0.0098s/iter; left time: 42.1656s
	iters: 400, epoch: 7 | loss: 0.3329574
	speed: 0.0120s/iter; left time: 50.3713s
	iters: 500, epoch: 7 | loss: 0.2722841
	speed: 0.0117s/iter; left time: 47.8627s
	iters: 600, epoch: 7 | loss: 0.3391611
	speed: 0.0124s/iter; left time: 49.5006s
	iters: 700, epoch: 7 | loss: 0.2640351
	speed: 0.0126s/iter; left time: 48.9297s
	iters: 800, epoch: 7 | loss: 0.3514604
	speed: 0.0126s/iter; left time: 47.6518s
	iters: 900, epoch: 7 | loss: 0.5048050
	speed: 0.0123s/iter; left time: 45.4099s
	iters: 1000, epoch: 7 | loss: 0.2734780
	speed: 0.0123s/iter; left time: 44.2653s
	iters: 1100, epoch: 7 | loss: 0.4342878
	speed: 0.0125s/iter; left time: 43.4684s
Epoch: 7 cost time: 14.633256912231445
Epoch: 7, Steps: 1147 | Train Loss: 0.4108284 Vali Loss: 0.4281937 Test Loss: 0.1778972
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 1.2558900
	speed: 0.0177s/iter; left time: 59.0010s
	iters: 200, epoch: 8 | loss: 0.3207762
	speed: 0.0161s/iter; left time: 52.1917s
	iters: 300, epoch: 8 | loss: 0.3994883
	speed: 0.0154s/iter; left time: 48.4049s
	iters: 400, epoch: 8 | loss: 0.4111762
	speed: 0.0157s/iter; left time: 47.7809s
	iters: 500, epoch: 8 | loss: 0.3872304
	speed: 0.0150s/iter; left time: 44.2288s
	iters: 600, epoch: 8 | loss: 0.3325504
	speed: 0.0147s/iter; left time: 41.8929s
	iters: 700, epoch: 8 | loss: 1.2800958
	speed: 0.0149s/iter; left time: 40.8550s
	iters: 800, epoch: 8 | loss: 0.4244947
	speed: 0.0149s/iter; left time: 39.4867s
	iters: 900, epoch: 8 | loss: 0.2601859
	speed: 0.0148s/iter; left time: 37.4977s
	iters: 1000, epoch: 8 | loss: 0.3576250
	speed: 0.0143s/iter; left time: 34.9253s
	iters: 1100, epoch: 8 | loss: 0.3075206
	speed: 0.0142s/iter; left time: 33.3051s
Epoch: 8 cost time: 16.566230297088623
Epoch: 8, Steps: 1147 | Train Loss: 0.4101876 Vali Loss: 0.4294867 Test Loss: 0.1781570
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2544135
	speed: 0.0204s/iter; left time: 44.8783s
	iters: 200, epoch: 9 | loss: 0.2488778
	speed: 0.0170s/iter; left time: 35.5790s
	iters: 300, epoch: 9 | loss: 0.2694953
	speed: 0.0154s/iter; left time: 30.7506s
	iters: 400, epoch: 9 | loss: 0.2255509
	speed: 0.0149s/iter; left time: 28.1617s
	iters: 500, epoch: 9 | loss: 0.2905461
	speed: 0.0148s/iter; left time: 26.5755s
	iters: 600, epoch: 9 | loss: 0.3427207
	speed: 0.0154s/iter; left time: 26.0793s
	iters: 700, epoch: 9 | loss: 0.4323788
	speed: 0.0154s/iter; left time: 24.5356s
	iters: 800, epoch: 9 | loss: 0.2538007
	speed: 0.0158s/iter; left time: 23.6357s
	iters: 900, epoch: 9 | loss: 0.3158503
	speed: 0.0158s/iter; left time: 22.0020s
	iters: 1000, epoch: 9 | loss: 0.3165948
	speed: 0.0155s/iter; left time: 20.0720s
	iters: 1100, epoch: 9 | loss: 0.3290354
	speed: 0.0151s/iter; left time: 18.0853s
Epoch: 9 cost time: 17.307831287384033
Epoch: 9, Steps: 1147 | Train Loss: 0.4095755 Vali Loss: 0.4285747 Test Loss: 0.1778212
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.17884109914302826, mae:0.22349774837493896
Seed: 42
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_192      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip True
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.5519040
	speed: 0.0348s/iter; left time: 394.9917s
	iters: 200, epoch: 1 | loss: 0.7676870
	speed: 0.0258s/iter; left time: 290.2992s
	iters: 300, epoch: 1 | loss: 0.4090869
	speed: 0.0219s/iter; left time: 243.8042s
	iters: 400, epoch: 1 | loss: 0.6605029
	speed: 0.0201s/iter; left time: 222.4349s
	iters: 500, epoch: 1 | loss: 0.4059639
	speed: 0.0193s/iter; left time: 210.9099s
	iters: 600, epoch: 1 | loss: 0.9578300
	speed: 0.0186s/iter; left time: 201.9468s
	iters: 700, epoch: 1 | loss: 0.4256218
	speed: 0.0180s/iter; left time: 193.4986s
	iters: 800, epoch: 1 | loss: 0.4508786
	speed: 0.0179s/iter; left time: 190.8943s
	iters: 900, epoch: 1 | loss: 0.8780766
	speed: 0.0176s/iter; left time: 185.5251s
	iters: 1000, epoch: 1 | loss: 0.3648688
	speed: 0.0174s/iter; left time: 182.0693s
	iters: 1100, epoch: 1 | loss: 0.4879463
	speed: 0.0169s/iter; left time: 174.6999s
Epoch: 1 cost time: 19.27182149887085
Epoch: 1, Steps: 1144 | Train Loss: 0.5767665 Vali Loss: 0.5349675 Test Loss: 0.2374719
Validation loss decreased (inf --> 0.534967).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3946577
	speed: 0.0219s/iter; left time: 223.1056s
	iters: 200, epoch: 2 | loss: 0.9516445
	speed: 0.0173s/iter; left time: 174.4178s
	iters: 300, epoch: 2 | loss: 0.8962702
	speed: 0.0164s/iter; left time: 164.4403s
	iters: 400, epoch: 2 | loss: 0.4525343
	speed: 0.0173s/iter; left time: 171.0709s
	iters: 500, epoch: 2 | loss: 0.9527105
	speed: 0.0163s/iter; left time: 159.8926s
	iters: 600, epoch: 2 | loss: 0.5779586
	speed: 0.0160s/iter; left time: 155.3301s
	iters: 700, epoch: 2 | loss: 0.4738667
	speed: 0.0153s/iter; left time: 146.5922s
	iters: 800, epoch: 2 | loss: 0.5005122
	speed: 0.0154s/iter; left time: 146.2893s
	iters: 900, epoch: 2 | loss: 0.4442782
	speed: 0.0154s/iter; left time: 144.8207s
	iters: 1000, epoch: 2 | loss: 0.3239561
	speed: 0.0150s/iter; left time: 139.6834s
	iters: 1100, epoch: 2 | loss: 0.3962543
	speed: 0.0146s/iter; left time: 134.6200s
Epoch: 2 cost time: 16.817269563674927
Epoch: 2, Steps: 1144 | Train Loss: 0.5214526 Vali Loss: 0.5305814 Test Loss: 0.2342562
Validation loss decreased (0.534967 --> 0.530581).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 1.3957618
	speed: 0.0168s/iter; left time: 151.7161s
	iters: 200, epoch: 3 | loss: 0.3773825
	speed: 0.0141s/iter; left time: 125.9008s
	iters: 300, epoch: 3 | loss: 0.4660865
	speed: 0.0127s/iter; left time: 112.7688s
	iters: 400, epoch: 3 | loss: 0.3031708
	speed: 0.0126s/iter; left time: 110.5417s
	iters: 500, epoch: 3 | loss: 0.3858630
	speed: 0.0134s/iter; left time: 116.1593s
	iters: 600, epoch: 3 | loss: 0.3326890
	speed: 0.0132s/iter; left time: 113.2309s
	iters: 700, epoch: 3 | loss: 0.5321474
	speed: 0.0134s/iter; left time: 112.9208s
	iters: 800, epoch: 3 | loss: 0.3677758
	speed: 0.0142s/iter; left time: 118.3517s
	iters: 900, epoch: 3 | loss: 0.5281112
	speed: 0.0145s/iter; left time: 119.6044s
	iters: 1000, epoch: 3 | loss: 0.4647968
	speed: 0.0142s/iter; left time: 116.0456s
	iters: 1100, epoch: 3 | loss: 0.4210963
	speed: 0.0143s/iter; left time: 114.8635s
Epoch: 3 cost time: 16.372955083847046
Epoch: 3, Steps: 1144 | Train Loss: 0.5066242 Vali Loss: 0.4984194 Test Loss: 0.2263346
Validation loss decreased (0.530581 --> 0.498419).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3573176
	speed: 0.0151s/iter; left time: 119.0847s
	iters: 200, epoch: 4 | loss: 0.4435662
	speed: 0.0147s/iter; left time: 115.0539s
	iters: 300, epoch: 4 | loss: 0.3609901
	speed: 0.0143s/iter; left time: 110.3829s
	iters: 400, epoch: 4 | loss: 0.5543745
	speed: 0.0146s/iter; left time: 111.4241s
	iters: 500, epoch: 4 | loss: 0.3295905
	speed: 0.0149s/iter; left time: 111.5920s
	iters: 600, epoch: 4 | loss: 0.3074630
	speed: 0.0149s/iter; left time: 110.5772s
	iters: 700, epoch: 4 | loss: 0.3483739
	speed: 0.0145s/iter; left time: 106.2265s
	iters: 800, epoch: 4 | loss: 0.4039338
	speed: 0.0143s/iter; left time: 103.0868s
	iters: 900, epoch: 4 | loss: 0.4309818
	speed: 0.0149s/iter; left time: 105.6461s
	iters: 1000, epoch: 4 | loss: 0.4430422
	speed: 0.0147s/iter; left time: 103.1093s
	iters: 1100, epoch: 4 | loss: 0.8957180
	speed: 0.0148s/iter; left time: 102.3257s
Epoch: 4 cost time: 17.063334226608276
Epoch: 4, Steps: 1144 | Train Loss: 0.4943315 Vali Loss: 0.4995555 Test Loss: 0.2259490
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3703384
	speed: 0.0197s/iter; left time: 133.4014s
	iters: 200, epoch: 5 | loss: 0.3760375
	speed: 0.0175s/iter; left time: 116.9615s
	iters: 300, epoch: 5 | loss: 0.3488642
	speed: 0.0164s/iter; left time: 107.4830s
	iters: 400, epoch: 5 | loss: 0.8384394
	speed: 0.0156s/iter; left time: 100.7314s
	iters: 500, epoch: 5 | loss: 0.3833174
	speed: 0.0149s/iter; left time: 94.6552s
	iters: 600, epoch: 5 | loss: 0.3943231
	speed: 0.0146s/iter; left time: 91.5748s
	iters: 700, epoch: 5 | loss: 0.3441300
	speed: 0.0147s/iter; left time: 90.5599s
	iters: 800, epoch: 5 | loss: 0.4447131
	speed: 0.0147s/iter; left time: 89.0333s
	iters: 900, epoch: 5 | loss: 0.4439603
	speed: 0.0145s/iter; left time: 86.5578s
	iters: 1000, epoch: 5 | loss: 0.8386865
	speed: 0.0145s/iter; left time: 85.3301s
	iters: 1100, epoch: 5 | loss: 0.9559160
	speed: 0.0142s/iter; left time: 81.8534s
Epoch: 5 cost time: 16.097349166870117
Epoch: 5, Steps: 1144 | Train Loss: 0.4889963 Vali Loss: 0.4969645 Test Loss: 0.2248861
Validation loss decreased (0.498419 --> 0.496965).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3419386
	speed: 0.0172s/iter; left time: 96.5734s
	iters: 200, epoch: 6 | loss: 0.8736500
	speed: 0.0156s/iter; left time: 86.0751s
	iters: 300, epoch: 6 | loss: 0.4514770
	speed: 0.0155s/iter; left time: 84.1593s
	iters: 400, epoch: 6 | loss: 0.4492471
	speed: 0.0153s/iter; left time: 81.5492s
	iters: 500, epoch: 6 | loss: 0.3987721
	speed: 0.0149s/iter; left time: 77.7411s
	iters: 600, epoch: 6 | loss: 0.4209090
	speed: 0.0155s/iter; left time: 79.3271s
	iters: 700, epoch: 6 | loss: 0.3864000
	speed: 0.0154s/iter; left time: 77.2578s
	iters: 800, epoch: 6 | loss: 0.9925627
	speed: 0.0153s/iter; left time: 75.2330s
	iters: 900, epoch: 6 | loss: 0.3922654
	speed: 0.0151s/iter; left time: 72.6026s
	iters: 1000, epoch: 6 | loss: 0.3976084
	speed: 0.0149s/iter; left time: 70.1121s
	iters: 1100, epoch: 6 | loss: 0.6322801
	speed: 0.0147s/iter; left time: 67.7044s
Epoch: 6 cost time: 16.720635414123535
Epoch: 6, Steps: 1144 | Train Loss: 0.4856331 Vali Loss: 0.4962699 Test Loss: 0.2247864
Validation loss decreased (0.496965 --> 0.496270).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2636916
	speed: 0.0224s/iter; left time: 100.5007s
	iters: 200, epoch: 7 | loss: 0.3506836
	speed: 0.0190s/iter; left time: 83.1747s
	iters: 300, epoch: 7 | loss: 0.3723114
	speed: 0.0168s/iter; left time: 71.6496s
	iters: 400, epoch: 7 | loss: 0.3723618
	speed: 0.0175s/iter; left time: 73.0472s
	iters: 500, epoch: 7 | loss: 0.4791659
	speed: 0.0175s/iter; left time: 71.2490s
	iters: 600, epoch: 7 | loss: 0.3104753
	speed: 0.0170s/iter; left time: 67.5843s
	iters: 700, epoch: 7 | loss: 0.5597776
	speed: 0.0170s/iter; left time: 66.0045s
	iters: 800, epoch: 7 | loss: 0.3965873
	speed: 0.0168s/iter; left time: 63.2853s
	iters: 900, epoch: 7 | loss: 0.5066921
	speed: 0.0164s/iter; left time: 60.4509s
	iters: 1000, epoch: 7 | loss: 0.3864652
	speed: 0.0161s/iter; left time: 57.6312s
	iters: 1100, epoch: 7 | loss: 0.3733187
	speed: 0.0156s/iter; left time: 54.3713s
Epoch: 7 cost time: 17.799403429031372
Epoch: 7, Steps: 1144 | Train Loss: 0.4842403 Vali Loss: 0.4962255 Test Loss: 0.2243276
Validation loss decreased (0.496270 --> 0.496226).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4029580
	speed: 0.0176s/iter; left time: 58.8148s
	iters: 200, epoch: 8 | loss: 0.5459746
	speed: 0.0171s/iter; left time: 55.2503s
	iters: 300, epoch: 8 | loss: 1.3319145
	speed: 0.0158s/iter; left time: 49.6436s
	iters: 400, epoch: 8 | loss: 0.4272187
	speed: 0.0150s/iter; left time: 45.5371s
	iters: 500, epoch: 8 | loss: 1.2824396
	speed: 0.0156s/iter; left time: 45.8510s
	iters: 600, epoch: 8 | loss: 0.8087265
	speed: 0.0154s/iter; left time: 43.7634s
	iters: 700, epoch: 8 | loss: 0.3859949
	speed: 0.0150s/iter; left time: 41.1108s
	iters: 800, epoch: 8 | loss: 0.3172108
	speed: 0.0150s/iter; left time: 39.4678s
	iters: 900, epoch: 8 | loss: 0.4691299
	speed: 0.0150s/iter; left time: 38.1202s
	iters: 1000, epoch: 8 | loss: 0.3889080
	speed: 0.0150s/iter; left time: 36.5377s
	iters: 1100, epoch: 8 | loss: 0.7869191
	speed: 0.0147s/iter; left time: 34.3910s
Epoch: 8 cost time: 16.927653074264526
Epoch: 8, Steps: 1144 | Train Loss: 0.4831143 Vali Loss: 0.4955899 Test Loss: 0.2241644
Validation loss decreased (0.496226 --> 0.495590).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4369446
	speed: 0.0282s/iter; left time: 61.7445s
	iters: 200, epoch: 9 | loss: 0.3903872
	speed: 0.0213s/iter; left time: 44.5751s
	iters: 300, epoch: 9 | loss: 0.3595809
	speed: 0.0187s/iter; left time: 37.1237s
	iters: 400, epoch: 9 | loss: 0.3819699
	speed: 0.0180s/iter; left time: 33.9103s
	iters: 500, epoch: 9 | loss: 0.3410697
	speed: 0.0173s/iter; left time: 31.0063s
	iters: 600, epoch: 9 | loss: 0.4952721
	speed: 0.0167s/iter; left time: 28.1906s
	iters: 700, epoch: 9 | loss: 0.4166988
	speed: 0.0160s/iter; left time: 25.4452s
	iters: 800, epoch: 9 | loss: 0.8025402
	speed: 0.0158s/iter; left time: 23.4595s
	iters: 900, epoch: 9 | loss: 0.9949294
	speed: 0.0157s/iter; left time: 21.8674s
	iters: 1000, epoch: 9 | loss: 0.4690369
	speed: 0.0155s/iter; left time: 20.0342s
	iters: 1100, epoch: 9 | loss: 0.4407996
	speed: 0.0152s/iter; left time: 18.0806s
Epoch: 9 cost time: 17.404048681259155
Epoch: 9, Steps: 1144 | Train Loss: 0.4827612 Vali Loss: 0.4957913 Test Loss: 0.2241921
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.4627629
	speed: 0.0165s/iter; left time: 17.1979s
	iters: 200, epoch: 10 | loss: 0.4835376
	speed: 0.0144s/iter; left time: 13.6334s
	iters: 300, epoch: 10 | loss: 0.4261713
	speed: 0.0167s/iter; left time: 14.0895s
	iters: 400, epoch: 10 | loss: 0.3740139
	speed: 0.0158s/iter; left time: 11.7649s
	iters: 500, epoch: 10 | loss: 0.9288170
	speed: 0.0153s/iter; left time: 9.8612s
	iters: 600, epoch: 10 | loss: 0.4851263
	speed: 0.0156s/iter; left time: 8.5016s
	iters: 700, epoch: 10 | loss: 0.4809859
	speed: 0.0153s/iter; left time: 6.8173s
	iters: 800, epoch: 10 | loss: 0.3918823
	speed: 0.0150s/iter; left time: 5.1813s
	iters: 900, epoch: 10 | loss: 0.3073039
	speed: 0.0151s/iter; left time: 3.7113s
	iters: 1000, epoch: 10 | loss: 0.8179288
	speed: 0.0153s/iter; left time: 2.2193s
	iters: 1100, epoch: 10 | loss: 0.3398068
	speed: 0.0152s/iter; left time: 0.6824s
Epoch: 10 cost time: 17.592975616455078
Epoch: 10, Steps: 1144 | Train Loss: 0.4823301 Vali Loss: 0.4959108 Test Loss: 0.2241503
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.2241644263267517, mae:0.262378454208374
Use GPU: cuda:0
no_skip True
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.5680551
	speed: 0.0211s/iter; left time: 239.5444s
	iters: 200, epoch: 1 | loss: 0.3750353
	speed: 0.0182s/iter; left time: 204.6580s
	iters: 300, epoch: 1 | loss: 0.7650253
	speed: 0.0194s/iter; left time: 215.6366s
	iters: 400, epoch: 1 | loss: 0.9078199
	speed: 0.0184s/iter; left time: 203.5206s
	iters: 500, epoch: 1 | loss: 0.4839973
	speed: 0.0172s/iter; left time: 188.2602s
	iters: 600, epoch: 1 | loss: 0.5260692
	speed: 0.0169s/iter; left time: 183.4903s
	iters: 700, epoch: 1 | loss: 0.5766707
	speed: 0.0167s/iter; left time: 178.8482s
	iters: 800, epoch: 1 | loss: 0.3770619
	speed: 0.0166s/iter; left time: 176.8221s
	iters: 900, epoch: 1 | loss: 0.4210441
	speed: 0.0164s/iter; left time: 172.9680s
	iters: 1000, epoch: 1 | loss: 0.4515478
	speed: 0.0161s/iter; left time: 168.5604s
	iters: 1100, epoch: 1 | loss: 0.4375127
	speed: 0.0160s/iter; left time: 165.4678s
Epoch: 1 cost time: 18.186612367630005
Epoch: 1, Steps: 1144 | Train Loss: 0.5852156 Vali Loss: 0.5517731 Test Loss: 0.2415590
Validation loss decreased (inf --> 0.551773).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5575368
	speed: 0.0184s/iter; left time: 187.3102s
	iters: 200, epoch: 2 | loss: 0.9674933
	speed: 0.0166s/iter; left time: 167.9820s
	iters: 300, epoch: 2 | loss: 0.4455876
	speed: 0.0155s/iter; left time: 155.3849s
	iters: 400, epoch: 2 | loss: 0.4424249
	speed: 0.0145s/iter; left time: 143.8471s
	iters: 500, epoch: 2 | loss: 0.4299041
	speed: 0.0151s/iter; left time: 148.3157s
	iters: 600, epoch: 2 | loss: 0.8768916
	speed: 0.0160s/iter; left time: 155.4414s
	iters: 700, epoch: 2 | loss: 0.4528120
	speed: 0.0159s/iter; left time: 152.9080s
	iters: 800, epoch: 2 | loss: 0.6127504
	speed: 0.0159s/iter; left time: 150.9869s
	iters: 900, epoch: 2 | loss: 0.4510808
	speed: 0.0158s/iter; left time: 148.2148s
	iters: 1000, epoch: 2 | loss: 0.3959339
	speed: 0.0156s/iter; left time: 144.6218s
	iters: 1100, epoch: 2 | loss: 0.4610839
	speed: 0.0156s/iter; left time: 143.2614s
Epoch: 2 cost time: 17.776188611984253
Epoch: 2, Steps: 1144 | Train Loss: 0.5256393 Vali Loss: 0.5359836 Test Loss: 0.2391928
Validation loss decreased (0.551773 --> 0.535984).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4750659
	speed: 0.0178s/iter; left time: 160.9664s
	iters: 200, epoch: 3 | loss: 0.3419449
	speed: 0.0151s/iter; left time: 134.8141s
	iters: 300, epoch: 3 | loss: 0.3424101
	speed: 0.0138s/iter; left time: 122.4353s
	iters: 400, epoch: 3 | loss: 0.4870495
	speed: 0.0131s/iter; left time: 114.4050s
	iters: 500, epoch: 3 | loss: 0.9107442
	speed: 0.0127s/iter; left time: 110.1410s
	iters: 600, epoch: 3 | loss: 0.3431880
	speed: 0.0126s/iter; left time: 107.8628s
	iters: 700, epoch: 3 | loss: 0.4307514
	speed: 0.0126s/iter; left time: 106.1292s
	iters: 800, epoch: 3 | loss: 0.3606926
	speed: 0.0126s/iter; left time: 105.3538s
	iters: 900, epoch: 3 | loss: 0.8579111
	speed: 0.0129s/iter; left time: 106.4695s
	iters: 1000, epoch: 3 | loss: 0.4980241
	speed: 0.0131s/iter; left time: 106.8072s
	iters: 1100, epoch: 3 | loss: 0.3669966
	speed: 0.0130s/iter; left time: 104.8614s
Epoch: 3 cost time: 14.80996322631836
Epoch: 3, Steps: 1144 | Train Loss: 0.5077179 Vali Loss: 0.5089575 Test Loss: 0.2318793
Validation loss decreased (0.535984 --> 0.508958).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4807751
	speed: 0.0210s/iter; left time: 165.9823s
	iters: 200, epoch: 4 | loss: 0.4327177
	speed: 0.0160s/iter; left time: 124.8400s
	iters: 300, epoch: 4 | loss: 0.4324805
	speed: 0.0163s/iter; left time: 125.3274s
	iters: 400, epoch: 4 | loss: 0.3931460
	speed: 0.0161s/iter; left time: 122.4482s
	iters: 500, epoch: 4 | loss: 0.5013356
	speed: 0.0156s/iter; left time: 117.0193s
	iters: 600, epoch: 4 | loss: 0.3944997
	speed: 0.0155s/iter; left time: 114.7245s
	iters: 700, epoch: 4 | loss: 0.4284064
	speed: 0.0157s/iter; left time: 115.0254s
	iters: 800, epoch: 4 | loss: 0.3748339
	speed: 0.0155s/iter; left time: 111.4342s
	iters: 900, epoch: 4 | loss: 0.4822501
	speed: 0.0155s/iter; left time: 110.0149s
	iters: 1000, epoch: 4 | loss: 0.5280712
	speed: 0.0154s/iter; left time: 108.0689s
	iters: 1100, epoch: 4 | loss: 0.4165325
	speed: 0.0153s/iter; left time: 105.7670s
Epoch: 4 cost time: 17.682591438293457
Epoch: 4, Steps: 1144 | Train Loss: 0.4961280 Vali Loss: 0.5037395 Test Loss: 0.2301362
Validation loss decreased (0.508958 --> 0.503740).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4195223
	speed: 0.0178s/iter; left time: 120.7301s
	iters: 200, epoch: 5 | loss: 0.4530385
	speed: 0.0171s/iter; left time: 113.8564s
	iters: 300, epoch: 5 | loss: 0.3343230
	speed: 0.0155s/iter; left time: 102.0429s
	iters: 400, epoch: 5 | loss: 0.3879959
	speed: 0.0147s/iter; left time: 95.0779s
	iters: 500, epoch: 5 | loss: 0.3747335
	speed: 0.0147s/iter; left time: 93.8760s
	iters: 600, epoch: 5 | loss: 0.5453418
	speed: 0.0146s/iter; left time: 91.6163s
	iters: 700, epoch: 5 | loss: 0.8663270
	speed: 0.0145s/iter; left time: 89.6279s
	iters: 800, epoch: 5 | loss: 0.2980803
	speed: 0.0146s/iter; left time: 88.2917s
	iters: 900, epoch: 5 | loss: 0.4423260
	speed: 0.0146s/iter; left time: 87.0806s
	iters: 1000, epoch: 5 | loss: 0.4525779
	speed: 0.0145s/iter; left time: 85.0625s
	iters: 1100, epoch: 5 | loss: 0.3920739
	speed: 0.0143s/iter; left time: 82.5878s
Epoch: 5 cost time: 16.282705307006836
Epoch: 5, Steps: 1144 | Train Loss: 0.4897668 Vali Loss: 0.5042201 Test Loss: 0.2298692
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4234390
	speed: 0.0230s/iter; left time: 129.3898s
	iters: 200, epoch: 6 | loss: 0.3617396
	speed: 0.0187s/iter; left time: 103.0521s
	iters: 300, epoch: 6 | loss: 0.4037183
	speed: 0.0171s/iter; left time: 92.7437s
	iters: 400, epoch: 6 | loss: 0.3053703
	speed: 0.0163s/iter; left time: 86.7062s
	iters: 500, epoch: 6 | loss: 0.5062609
	speed: 0.0163s/iter; left time: 85.1012s
	iters: 600, epoch: 6 | loss: 0.8016387
	speed: 0.0160s/iter; left time: 82.1311s
	iters: 700, epoch: 6 | loss: 0.4752667
	speed: 0.0160s/iter; left time: 80.1317s
	iters: 800, epoch: 6 | loss: 0.5061792
	speed: 0.0156s/iter; left time: 76.8832s
	iters: 900, epoch: 6 | loss: 0.4186896
	speed: 0.0155s/iter; left time: 74.6477s
	iters: 1000, epoch: 6 | loss: 0.9470837
	speed: 0.0155s/iter; left time: 72.9517s
	iters: 1100, epoch: 6 | loss: 0.9439493
	speed: 0.0153s/iter; left time: 70.8867s
Epoch: 6 cost time: 17.53679847717285
Epoch: 6, Steps: 1144 | Train Loss: 0.4860049 Vali Loss: 0.5021378 Test Loss: 0.2290153
Validation loss decreased (0.503740 --> 0.502138).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4761528
	speed: 0.0198s/iter; left time: 88.5148s
	iters: 200, epoch: 7 | loss: 0.3557685
	speed: 0.0160s/iter; left time: 69.8544s
	iters: 300, epoch: 7 | loss: 0.3664019
	speed: 0.0151s/iter; left time: 64.4624s
	iters: 400, epoch: 7 | loss: 0.3959481
	speed: 0.0146s/iter; left time: 60.9022s
	iters: 500, epoch: 7 | loss: 0.3838696
	speed: 0.0141s/iter; left time: 57.2980s
	iters: 600, epoch: 7 | loss: 0.4403210
	speed: 0.0137s/iter; left time: 54.5044s
	iters: 700, epoch: 7 | loss: 0.5186574
	speed: 0.0138s/iter; left time: 53.3330s
	iters: 800, epoch: 7 | loss: 0.3827344
	speed: 0.0145s/iter; left time: 54.8460s
	iters: 900, epoch: 7 | loss: 0.5263262
	speed: 0.0144s/iter; left time: 53.0910s
	iters: 1000, epoch: 7 | loss: 0.3962412
	speed: 0.0145s/iter; left time: 51.7480s
	iters: 1100, epoch: 7 | loss: 0.4735366
	speed: 0.0144s/iter; left time: 50.1333s
Epoch: 7 cost time: 16.647345781326294
Epoch: 7, Steps: 1144 | Train Loss: 0.4842668 Vali Loss: 0.5029740 Test Loss: 0.2289830
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3780670
	speed: 0.0174s/iter; left time: 58.1267s
	iters: 200, epoch: 8 | loss: 0.4872510
	speed: 0.0155s/iter; left time: 50.0370s
	iters: 300, epoch: 8 | loss: 0.4097556
	speed: 0.0163s/iter; left time: 50.9341s
	iters: 400, epoch: 8 | loss: 0.2901061
	speed: 0.0161s/iter; left time: 48.9807s
	iters: 500, epoch: 8 | loss: 0.3583769
	speed: 0.0165s/iter; left time: 48.3336s
	iters: 600, epoch: 8 | loss: 0.9112288
	speed: 0.0167s/iter; left time: 47.2650s
	iters: 700, epoch: 8 | loss: 0.4321940
	speed: 0.0163s/iter; left time: 44.4131s
	iters: 800, epoch: 8 | loss: 0.3874055
	speed: 0.0160s/iter; left time: 42.2349s
	iters: 900, epoch: 8 | loss: 0.3331891
	speed: 0.0160s/iter; left time: 40.5615s
	iters: 1000, epoch: 8 | loss: 0.9410438
	speed: 0.0160s/iter; left time: 38.8852s
	iters: 1100, epoch: 8 | loss: 0.3225627
	speed: 0.0157s/iter; left time: 36.6985s
Epoch: 8 cost time: 18.065682649612427
Epoch: 8, Steps: 1144 | Train Loss: 0.4830885 Vali Loss: 0.5028125 Test Loss: 0.2286784
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3814467
	speed: 0.0184s/iter; left time: 40.3581s
	iters: 200, epoch: 9 | loss: 0.4463598
	speed: 0.0163s/iter; left time: 34.0598s
	iters: 300, epoch: 9 | loss: 0.8018950
	speed: 0.0161s/iter; left time: 32.0861s
	iters: 400, epoch: 9 | loss: 0.3894763
	speed: 0.0152s/iter; left time: 28.7136s
	iters: 500, epoch: 9 | loss: 0.4004215
	speed: 0.0150s/iter; left time: 26.8451s
	iters: 600, epoch: 9 | loss: 0.3531978
	speed: 0.0149s/iter; left time: 25.2390s
	iters: 700, epoch: 9 | loss: 0.5475721
	speed: 0.0146s/iter; left time: 23.1953s
	iters: 800, epoch: 9 | loss: 0.4658524
	speed: 0.0142s/iter; left time: 21.1537s
	iters: 900, epoch: 9 | loss: 0.3953561
	speed: 0.0141s/iter; left time: 19.5568s
	iters: 1000, epoch: 9 | loss: 0.3247391
	speed: 0.0147s/iter; left time: 18.8883s
	iters: 1100, epoch: 9 | loss: 0.3593053
	speed: 0.0144s/iter; left time: 17.1624s
Epoch: 9 cost time: 16.500611066818237
Epoch: 9, Steps: 1144 | Train Loss: 0.4826890 Vali Loss: 0.5021939 Test Loss: 0.2287859
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.7759199
	speed: 0.0187s/iter; left time: 19.5621s
	iters: 200, epoch: 10 | loss: 0.3619983
	speed: 0.0163s/iter; left time: 15.3851s
	iters: 300, epoch: 10 | loss: 0.3956164
	speed: 0.0148s/iter; left time: 12.5161s
	iters: 400, epoch: 10 | loss: 0.8091415
	speed: 0.0140s/iter; left time: 10.4415s
	iters: 500, epoch: 10 | loss: 0.3589742
	speed: 0.0134s/iter; left time: 8.6608s
	iters: 600, epoch: 10 | loss: 0.2872558
	speed: 0.0128s/iter; left time: 6.9641s
	iters: 700, epoch: 10 | loss: 0.8347175
	speed: 0.0124s/iter; left time: 5.5054s
	iters: 800, epoch: 10 | loss: 0.7955171
	speed: 0.0122s/iter; left time: 4.1979s
	iters: 900, epoch: 10 | loss: 0.4627547
	speed: 0.0128s/iter; left time: 3.1366s
	iters: 1000, epoch: 10 | loss: 0.3560454
	speed: 0.0128s/iter; left time: 1.8573s
	iters: 1100, epoch: 10 | loss: 0.3965527
	speed: 0.0128s/iter; left time: 0.5754s
Epoch: 10 cost time: 14.735583305358887
Epoch: 10, Steps: 1144 | Train Loss: 0.4822988 Vali Loss: 0.5023406 Test Loss: 0.2286671
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.22901535034179688, mae:0.2650003731250763
Use GPU: cuda:0
no_skip True
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.7865109
	speed: 0.0164s/iter; left time: 185.5699s
	iters: 200, epoch: 1 | loss: 0.6001859
	speed: 0.0152s/iter; left time: 170.5620s
	iters: 300, epoch: 1 | loss: 0.5306174
	speed: 0.0142s/iter; left time: 158.4161s
	iters: 400, epoch: 1 | loss: 0.6225706
	speed: 0.0143s/iter; left time: 158.1011s
	iters: 500, epoch: 1 | loss: 0.4028081
	speed: 0.0142s/iter; left time: 154.9205s
	iters: 600, epoch: 1 | loss: 0.5390134
	speed: 0.0139s/iter; left time: 150.6983s
	iters: 700, epoch: 1 | loss: 0.5264817
	speed: 0.0135s/iter; left time: 145.1225s
	iters: 800, epoch: 1 | loss: 0.4906872
	speed: 0.0136s/iter; left time: 145.1006s
	iters: 900, epoch: 1 | loss: 0.5438416
	speed: 0.0138s/iter; left time: 145.6578s
	iters: 1000, epoch: 1 | loss: 0.5277156
	speed: 0.0139s/iter; left time: 144.7339s
	iters: 1100, epoch: 1 | loss: 0.8169039
	speed: 0.0137s/iter; left time: 141.2884s
Epoch: 1 cost time: 15.709747314453125
Epoch: 1, Steps: 1144 | Train Loss: 0.5828795 Vali Loss: 0.5513715 Test Loss: 0.2382706
Validation loss decreased (inf --> 0.551372).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4378118
	speed: 0.0207s/iter; left time: 211.3450s
	iters: 200, epoch: 2 | loss: 0.9482036
	speed: 0.0170s/iter; left time: 171.5163s
	iters: 300, epoch: 2 | loss: 0.3951710
	speed: 0.0153s/iter; left time: 152.7016s
	iters: 400, epoch: 2 | loss: 0.5437843
	speed: 0.0149s/iter; left time: 147.6818s
	iters: 500, epoch: 2 | loss: 0.5070911
	speed: 0.0151s/iter; left time: 147.4669s
	iters: 600, epoch: 2 | loss: 0.5040224
	speed: 0.0148s/iter; left time: 143.3479s
	iters: 700, epoch: 2 | loss: 1.0199569
	speed: 0.0141s/iter; left time: 135.0158s
	iters: 800, epoch: 2 | loss: 0.5067725
	speed: 0.0143s/iter; left time: 136.2770s
	iters: 900, epoch: 2 | loss: 0.4780596
	speed: 0.0151s/iter; left time: 141.6207s
	iters: 1000, epoch: 2 | loss: 0.3739865
	speed: 0.0148s/iter; left time: 137.2556s
	iters: 1100, epoch: 2 | loss: 0.3571506
	speed: 0.0146s/iter; left time: 134.4869s
Epoch: 2 cost time: 16.74949359893799
Epoch: 2, Steps: 1144 | Train Loss: 0.5252933 Vali Loss: 0.5202934 Test Loss: 0.2335352
Validation loss decreased (0.551372 --> 0.520293).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3830396
	speed: 0.0160s/iter; left time: 144.8196s
	iters: 200, epoch: 3 | loss: 0.3349310
	speed: 0.0163s/iter; left time: 145.6385s
	iters: 300, epoch: 3 | loss: 0.3849632
	speed: 0.0152s/iter; left time: 134.5191s
	iters: 400, epoch: 3 | loss: 0.4267785
	speed: 0.0142s/iter; left time: 124.4527s
	iters: 500, epoch: 3 | loss: 0.8613484
	speed: 0.0143s/iter; left time: 123.7079s
	iters: 600, epoch: 3 | loss: 0.3448240
	speed: 0.0145s/iter; left time: 123.6713s
	iters: 700, epoch: 3 | loss: 0.3847727
	speed: 0.0143s/iter; left time: 120.7861s
	iters: 800, epoch: 3 | loss: 0.4611717
	speed: 0.0140s/iter; left time: 116.9647s
	iters: 900, epoch: 3 | loss: 0.5572273
	speed: 0.0142s/iter; left time: 116.7820s
	iters: 1000, epoch: 3 | loss: 0.4905936
	speed: 0.0143s/iter; left time: 116.6112s
	iters: 1100, epoch: 3 | loss: 1.0343620
	speed: 0.0143s/iter; left time: 115.4977s
Epoch: 3 cost time: 16.413694143295288
Epoch: 3, Steps: 1144 | Train Loss: 0.5051136 Vali Loss: 0.5017694 Test Loss: 0.2285382
Validation loss decreased (0.520293 --> 0.501769).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3780259
	speed: 0.0161s/iter; left time: 127.6706s
	iters: 200, epoch: 4 | loss: 0.4227125
	speed: 0.0179s/iter; left time: 139.7845s
	iters: 300, epoch: 4 | loss: 0.3973222
	speed: 0.0162s/iter; left time: 125.1675s
	iters: 400, epoch: 4 | loss: 0.9532676
	speed: 0.0148s/iter; left time: 112.5035s
	iters: 500, epoch: 4 | loss: 0.4621109
	speed: 0.0141s/iter; left time: 106.1462s
	iters: 600, epoch: 4 | loss: 0.5728352
	speed: 0.0142s/iter; left time: 105.3404s
	iters: 700, epoch: 4 | loss: 0.4151153
	speed: 0.0141s/iter; left time: 103.3940s
	iters: 800, epoch: 4 | loss: 0.4808411
	speed: 0.0142s/iter; left time: 102.1819s
	iters: 900, epoch: 4 | loss: 0.5407272
	speed: 0.0140s/iter; left time: 99.7739s
	iters: 1000, epoch: 4 | loss: 0.3777688
	speed: 0.0144s/iter; left time: 100.6995s
	iters: 1100, epoch: 4 | loss: 0.8917007
	speed: 0.0142s/iter; left time: 97.9474s
Epoch: 4 cost time: 16.380057334899902
Epoch: 4, Steps: 1144 | Train Loss: 0.4945894 Vali Loss: 0.5045893 Test Loss: 0.2284358
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.9643033
	speed: 0.0164s/iter; left time: 110.6527s
	iters: 200, epoch: 5 | loss: 0.4322062
	speed: 0.0150s/iter; left time: 100.0585s
	iters: 300, epoch: 5 | loss: 0.4107349
	speed: 0.0149s/iter; left time: 97.9495s
	iters: 400, epoch: 5 | loss: 0.4402891
	speed: 0.0143s/iter; left time: 92.5090s
	iters: 500, epoch: 5 | loss: 0.4034631
	speed: 0.0141s/iter; left time: 89.4551s
	iters: 600, epoch: 5 | loss: 0.4027390
	speed: 0.0141s/iter; left time: 88.5837s
	iters: 700, epoch: 5 | loss: 0.9297308
	speed: 0.0138s/iter; left time: 84.9539s
	iters: 800, epoch: 5 | loss: 0.4370235
	speed: 0.0137s/iter; left time: 83.3035s
	iters: 900, epoch: 5 | loss: 0.4730476
	speed: 0.0138s/iter; left time: 82.3584s
	iters: 1000, epoch: 5 | loss: 0.3720307
	speed: 0.0138s/iter; left time: 80.8616s
	iters: 1100, epoch: 5 | loss: 0.3568023
	speed: 0.0138s/iter; left time: 79.6530s
Epoch: 5 cost time: 15.912474632263184
Epoch: 5, Steps: 1144 | Train Loss: 0.4880831 Vali Loss: 0.5014517 Test Loss: 0.2269626
Validation loss decreased (0.501769 --> 0.501452).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2885117
	speed: 0.0170s/iter; left time: 95.8312s
	iters: 200, epoch: 6 | loss: 0.4245077
	speed: 0.0153s/iter; left time: 84.3254s
	iters: 300, epoch: 6 | loss: 0.3941967
	speed: 0.0148s/iter; left time: 80.2109s
	iters: 400, epoch: 6 | loss: 0.3515190
	speed: 0.0137s/iter; left time: 72.8594s
	iters: 500, epoch: 6 | loss: 0.4828039
	speed: 0.0134s/iter; left time: 70.2182s
	iters: 600, epoch: 6 | loss: 0.4604072
	speed: 0.0145s/iter; left time: 74.0131s
	iters: 700, epoch: 6 | loss: 0.4251466
	speed: 0.0145s/iter; left time: 73.0353s
	iters: 800, epoch: 6 | loss: 0.8112823
	speed: 0.0145s/iter; left time: 71.2820s
	iters: 900, epoch: 6 | loss: 0.4483350
	speed: 0.0146s/iter; left time: 70.2973s
	iters: 1000, epoch: 6 | loss: 0.4539507
	speed: 0.0147s/iter; left time: 69.2960s
	iters: 1100, epoch: 6 | loss: 0.3547688
	speed: 0.0145s/iter; left time: 66.9563s
Epoch: 6 cost time: 16.729583263397217
Epoch: 6, Steps: 1144 | Train Loss: 0.4842969 Vali Loss: 0.5007935 Test Loss: 0.2261080
Validation loss decreased (0.501452 --> 0.500794).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4480661
	speed: 0.0159s/iter; left time: 70.9794s
	iters: 200, epoch: 7 | loss: 0.8704042
	speed: 0.0153s/iter; left time: 66.9114s
	iters: 300, epoch: 7 | loss: 0.3450494
	speed: 0.0149s/iter; left time: 63.8888s
	iters: 400, epoch: 7 | loss: 0.5290046
	speed: 0.0142s/iter; left time: 59.1701s
	iters: 500, epoch: 7 | loss: 0.9274536
	speed: 0.0135s/iter; left time: 54.9032s
	iters: 600, epoch: 7 | loss: 0.3505970
	speed: 0.0135s/iter; left time: 53.8382s
	iters: 700, epoch: 7 | loss: 0.4313991
	speed: 0.0137s/iter; left time: 53.2086s
	iters: 800, epoch: 7 | loss: 0.2788970
	speed: 0.0139s/iter; left time: 52.3327s
	iters: 900, epoch: 7 | loss: 0.4344161
	speed: 0.0135s/iter; left time: 49.6158s
	iters: 1000, epoch: 7 | loss: 0.4273595
	speed: 0.0135s/iter; left time: 48.3115s
	iters: 1100, epoch: 7 | loss: 0.3493665
	speed: 0.0138s/iter; left time: 47.8136s
Epoch: 7 cost time: 16.077423810958862
Epoch: 7, Steps: 1144 | Train Loss: 0.4824982 Vali Loss: 0.5013580 Test Loss: 0.2263386
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.5105242
	speed: 0.0158s/iter; left time: 52.5635s
	iters: 200, epoch: 8 | loss: 0.4149402
	speed: 0.0126s/iter; left time: 40.8928s
	iters: 300, epoch: 8 | loss: 0.4223661
	speed: 0.0140s/iter; left time: 43.8551s
	iters: 400, epoch: 8 | loss: 0.3430437
	speed: 0.0144s/iter; left time: 43.6407s
	iters: 500, epoch: 8 | loss: 0.3866593
	speed: 0.0133s/iter; left time: 38.9267s
	iters: 600, epoch: 8 | loss: 0.3040267
	speed: 0.0127s/iter; left time: 35.9891s
	iters: 700, epoch: 8 | loss: 0.3844998
	speed: 0.0127s/iter; left time: 34.6657s
	iters: 800, epoch: 8 | loss: 0.4891422
	speed: 0.0128s/iter; left time: 33.6003s
	iters: 900, epoch: 8 | loss: 0.3630770
	speed: 0.0126s/iter; left time: 31.8518s
	iters: 1000, epoch: 8 | loss: 1.0105529
	speed: 0.0124s/iter; left time: 30.1696s
	iters: 1100, epoch: 8 | loss: 0.4686831
	speed: 0.0126s/iter; left time: 29.4393s
Epoch: 8 cost time: 14.687713146209717
Epoch: 8, Steps: 1144 | Train Loss: 0.4813856 Vali Loss: 0.5013244 Test Loss: 0.2261186
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4492991
	speed: 0.0162s/iter; left time: 35.4560s
	iters: 200, epoch: 9 | loss: 0.4642544
	speed: 0.0150s/iter; left time: 31.4111s
	iters: 300, epoch: 9 | loss: 0.3110322
	speed: 0.0146s/iter; left time: 28.9861s
	iters: 400, epoch: 9 | loss: 0.5036244
	speed: 0.0143s/iter; left time: 27.0585s
	iters: 500, epoch: 9 | loss: 0.4148915
	speed: 0.0141s/iter; left time: 25.2640s
	iters: 600, epoch: 9 | loss: 0.3850309
	speed: 0.0139s/iter; left time: 23.4752s
	iters: 700, epoch: 9 | loss: 0.9236315
	speed: 0.0141s/iter; left time: 22.3425s
	iters: 800, epoch: 9 | loss: 0.8527154
	speed: 0.0139s/iter; left time: 20.6966s
	iters: 900, epoch: 9 | loss: 0.3689012
	speed: 0.0135s/iter; left time: 18.7280s
	iters: 1000, epoch: 9 | loss: 0.4068291
	speed: 0.0135s/iter; left time: 17.3517s
	iters: 1100, epoch: 9 | loss: 0.4051318
	speed: 0.0138s/iter; left time: 16.3516s
Epoch: 9 cost time: 15.875346422195435
Epoch: 9, Steps: 1144 | Train Loss: 0.4807748 Vali Loss: 0.5012640 Test Loss: 0.2259103
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.7795027
	speed: 0.0160s/iter; left time: 16.7196s
	iters: 200, epoch: 10 | loss: 0.4890058
	speed: 0.0162s/iter; left time: 15.2728s
	iters: 300, epoch: 10 | loss: 0.3348373
	speed: 0.0155s/iter; left time: 13.0861s
	iters: 400, epoch: 10 | loss: 0.3975900
	speed: 0.0152s/iter; left time: 11.3032s
	iters: 500, epoch: 10 | loss: 0.5279554
	speed: 0.0160s/iter; left time: 10.3183s
	iters: 600, epoch: 10 | loss: 0.4512223
	speed: 0.0154s/iter; left time: 8.3980s
	iters: 700, epoch: 10 | loss: 0.4277910
	speed: 0.0150s/iter; left time: 6.6699s
	iters: 800, epoch: 10 | loss: 0.4155831
	speed: 0.0148s/iter; left time: 5.1147s
	iters: 900, epoch: 10 | loss: 0.3776870
	speed: 0.0148s/iter; left time: 3.6177s
	iters: 1000, epoch: 10 | loss: 0.3789196
	speed: 0.0146s/iter; left time: 2.1131s
	iters: 1100, epoch: 10 | loss: 0.5168185
	speed: 0.0149s/iter; left time: 0.6698s
Epoch: 10 cost time: 17.015976905822754
Epoch: 10, Steps: 1144 | Train Loss: 0.4803807 Vali Loss: 0.5025611 Test Loss: 0.2261611
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.22610805928707123, mae:0.2633528411388397
Seed: 42
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_336      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip True
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.5647508
	speed: 0.0326s/iter; left time: 368.3149s
	iters: 200, epoch: 1 | loss: 0.8557712
	speed: 0.0237s/iter; left time: 265.7832s
	iters: 300, epoch: 1 | loss: 0.6191818
	speed: 0.0203s/iter; left time: 225.4394s
	iters: 400, epoch: 1 | loss: 0.5872185
	speed: 0.0183s/iter; left time: 201.4579s
	iters: 500, epoch: 1 | loss: 0.4492713
	speed: 0.0170s/iter; left time: 185.3767s
	iters: 600, epoch: 1 | loss: 0.5360532
	speed: 0.0167s/iter; left time: 180.7708s
	iters: 700, epoch: 1 | loss: 0.5276105
	speed: 0.0163s/iter; left time: 174.1317s
	iters: 800, epoch: 1 | loss: 0.5068611
	speed: 0.0159s/iter; left time: 168.6219s
	iters: 900, epoch: 1 | loss: 0.4671284
	speed: 0.0156s/iter; left time: 163.9708s
	iters: 1000, epoch: 1 | loss: 0.7763866
	speed: 0.0154s/iter; left time: 160.1238s
	iters: 1100, epoch: 1 | loss: 0.7681837
	speed: 0.0153s/iter; left time: 157.4586s
Epoch: 1 cost time: 17.38034200668335
Epoch: 1, Steps: 1140 | Train Loss: 0.6420377 Vali Loss: 0.6154140 Test Loss: 0.2893773
Validation loss decreased (inf --> 0.615414).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7014428
	speed: 0.0196s/iter; left time: 199.5427s
	iters: 200, epoch: 2 | loss: 0.5382338
	speed: 0.0169s/iter; left time: 169.8584s
	iters: 300, epoch: 2 | loss: 0.5536781
	speed: 0.0160s/iter; left time: 158.8944s
	iters: 400, epoch: 2 | loss: 0.5248331
	speed: 0.0158s/iter; left time: 155.6240s
	iters: 500, epoch: 2 | loss: 0.7655371
	speed: 0.0155s/iter; left time: 151.4896s
	iters: 600, epoch: 2 | loss: 0.5396814
	speed: 0.0149s/iter; left time: 144.0930s
	iters: 700, epoch: 2 | loss: 0.4889328
	speed: 0.0146s/iter; left time: 139.7325s
	iters: 800, epoch: 2 | loss: 0.4404960
	speed: 0.0146s/iter; left time: 138.2407s
	iters: 900, epoch: 2 | loss: 0.5904922
	speed: 0.0144s/iter; left time: 134.9837s
	iters: 1000, epoch: 2 | loss: 0.4945181
	speed: 0.0143s/iter; left time: 132.1209s
	iters: 1100, epoch: 2 | loss: 0.4149666
	speed: 0.0141s/iter; left time: 129.1103s
Epoch: 2 cost time: 16.12683415412903
Epoch: 2, Steps: 1140 | Train Loss: 0.5884492 Vali Loss: 0.5907722 Test Loss: 0.2827398
Validation loss decreased (0.615414 --> 0.590772).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4446213
	speed: 0.0153s/iter; left time: 137.6486s
	iters: 200, epoch: 3 | loss: 0.7547154
	speed: 0.0136s/iter; left time: 121.5054s
	iters: 300, epoch: 3 | loss: 0.5700396
	speed: 0.0140s/iter; left time: 123.4221s
	iters: 400, epoch: 3 | loss: 0.6090463
	speed: 0.0142s/iter; left time: 123.7154s
	iters: 500, epoch: 3 | loss: 0.5701690
	speed: 0.0138s/iter; left time: 119.0130s
	iters: 600, epoch: 3 | loss: 0.8480924
	speed: 0.0138s/iter; left time: 117.2041s
	iters: 700, epoch: 3 | loss: 0.3791813
	speed: 0.0141s/iter; left time: 119.1559s
	iters: 800, epoch: 3 | loss: 0.5394911
	speed: 0.0140s/iter; left time: 116.4622s
	iters: 900, epoch: 3 | loss: 0.7630008
	speed: 0.0142s/iter; left time: 116.5664s
	iters: 1000, epoch: 3 | loss: 0.5178874
	speed: 0.0141s/iter; left time: 114.7426s
	iters: 1100, epoch: 3 | loss: 0.5010105
	speed: 0.0143s/iter; left time: 114.9304s
Epoch: 3 cost time: 16.812632083892822
Epoch: 3, Steps: 1140 | Train Loss: 0.5691314 Vali Loss: 0.5787984 Test Loss: 0.2803195
Validation loss decreased (0.590772 --> 0.578798).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8211983
	speed: 0.0186s/iter; left time: 146.8944s
	iters: 200, epoch: 4 | loss: 0.4763200
	speed: 0.0167s/iter; left time: 129.8779s
	iters: 300, epoch: 4 | loss: 0.3651978
	speed: 0.0147s/iter; left time: 113.2222s
	iters: 400, epoch: 4 | loss: 0.4609203
	speed: 0.0145s/iter; left time: 110.1135s
	iters: 500, epoch: 4 | loss: 0.4479684
	speed: 0.0145s/iter; left time: 108.4589s
	iters: 600, epoch: 4 | loss: 1.0528657
	speed: 0.0142s/iter; left time: 105.1304s
	iters: 700, epoch: 4 | loss: 0.4057127
	speed: 0.0139s/iter; left time: 101.2502s
	iters: 800, epoch: 4 | loss: 0.4465908
	speed: 0.0143s/iter; left time: 103.0056s
	iters: 900, epoch: 4 | loss: 0.3832072
	speed: 0.0146s/iter; left time: 103.5461s
	iters: 1000, epoch: 4 | loss: 0.6007158
	speed: 0.0145s/iter; left time: 101.5668s
	iters: 1100, epoch: 4 | loss: 0.5213180
	speed: 0.0145s/iter; left time: 100.0001s
Epoch: 4 cost time: 16.610565423965454
Epoch: 4, Steps: 1140 | Train Loss: 0.5583978 Vali Loss: 0.5797228 Test Loss: 0.2802471
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.7843996
	speed: 0.0176s/iter; left time: 118.6428s
	iters: 200, epoch: 5 | loss: 0.5025747
	speed: 0.0151s/iter; left time: 100.3244s
	iters: 300, epoch: 5 | loss: 0.7282631
	speed: 0.0142s/iter; left time: 92.8253s
	iters: 400, epoch: 5 | loss: 0.4019203
	speed: 0.0155s/iter; left time: 100.0184s
	iters: 500, epoch: 5 | loss: 0.4709751
	speed: 0.0153s/iter; left time: 97.1052s
	iters: 600, epoch: 5 | loss: 0.7856613
	speed: 0.0149s/iter; left time: 93.1994s
	iters: 700, epoch: 5 | loss: 0.6228667
	speed: 0.0146s/iter; left time: 89.6129s
	iters: 800, epoch: 5 | loss: 0.4091622
	speed: 0.0143s/iter; left time: 86.1857s
	iters: 900, epoch: 5 | loss: 0.4591179
	speed: 0.0141s/iter; left time: 83.8723s
	iters: 1000, epoch: 5 | loss: 0.3959745
	speed: 0.0139s/iter; left time: 80.9748s
	iters: 1100, epoch: 5 | loss: 0.4303193
	speed: 0.0137s/iter; left time: 78.5264s
Epoch: 5 cost time: 15.666281461715698
Epoch: 5, Steps: 1140 | Train Loss: 0.5517993 Vali Loss: 0.5810850 Test Loss: 0.2800324
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4430936
	speed: 0.0120s/iter; left time: 66.9504s
	iters: 200, epoch: 6 | loss: 0.4301763
	speed: 0.0107s/iter; left time: 58.5884s
	iters: 300, epoch: 6 | loss: 0.4026995
	speed: 0.0106s/iter; left time: 57.3042s
	iters: 400, epoch: 6 | loss: 0.4814511
	speed: 0.0123s/iter; left time: 65.1059s
	iters: 500, epoch: 6 | loss: 0.4721805
	speed: 0.0129s/iter; left time: 66.8440s
	iters: 600, epoch: 6 | loss: 0.5114792
	speed: 0.0130s/iter; left time: 66.3725s
	iters: 700, epoch: 6 | loss: 0.3805811
	speed: 0.0136s/iter; left time: 68.0792s
	iters: 800, epoch: 6 | loss: 0.7457364
	speed: 0.0139s/iter; left time: 68.0214s
	iters: 900, epoch: 6 | loss: 0.4119097
	speed: 0.0141s/iter; left time: 67.4656s
	iters: 1000, epoch: 6 | loss: 0.5264871
	speed: 0.0138s/iter; left time: 64.9673s
	iters: 1100, epoch: 6 | loss: 0.4252829
	speed: 0.0141s/iter; left time: 64.6919s
Epoch: 6 cost time: 16.190353631973267
Epoch: 6, Steps: 1140 | Train Loss: 0.5480438 Vali Loss: 0.5797019 Test Loss: 0.2797379
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4676665
	speed: 0.0197s/iter; left time: 88.1043s
	iters: 200, epoch: 7 | loss: 0.4183199
	speed: 0.0171s/iter; left time: 74.4483s
	iters: 300, epoch: 7 | loss: 0.4947835
	speed: 0.0161s/iter; left time: 68.7663s
	iters: 400, epoch: 7 | loss: 0.7452060
	speed: 0.0152s/iter; left time: 63.1070s
	iters: 500, epoch: 7 | loss: 0.3797756
	speed: 0.0153s/iter; left time: 62.3054s
	iters: 600, epoch: 7 | loss: 0.6680525
	speed: 0.0151s/iter; left time: 59.8285s
	iters: 700, epoch: 7 | loss: 0.7324821
	speed: 0.0150s/iter; left time: 58.0419s
	iters: 800, epoch: 7 | loss: 0.4461505
	speed: 0.0151s/iter; left time: 56.8813s
	iters: 900, epoch: 7 | loss: 0.4856223
	speed: 0.0152s/iter; left time: 55.6633s
	iters: 1000, epoch: 7 | loss: 0.7115533
	speed: 0.0149s/iter; left time: 53.1564s
	iters: 1100, epoch: 7 | loss: 0.4982045
	speed: 0.0152s/iter; left time: 52.4941s
Epoch: 7 cost time: 17.326717615127563
Epoch: 7, Steps: 1140 | Train Loss: 0.5462830 Vali Loss: 0.5802584 Test Loss: 0.2797896
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4193734
	speed: 0.0159s/iter; left time: 52.7572s
	iters: 200, epoch: 8 | loss: 1.0199873
	speed: 0.0155s/iter; left time: 49.8585s
	iters: 300, epoch: 8 | loss: 0.4468441
	speed: 0.0151s/iter; left time: 47.2489s
	iters: 400, epoch: 8 | loss: 0.4583431
	speed: 0.0144s/iter; left time: 43.4197s
	iters: 500, epoch: 8 | loss: 0.3957323
	speed: 0.0150s/iter; left time: 43.8310s
	iters: 600, epoch: 8 | loss: 0.6728933
	speed: 0.0150s/iter; left time: 42.3567s
	iters: 700, epoch: 8 | loss: 0.6612473
	speed: 0.0149s/iter; left time: 40.5594s
	iters: 800, epoch: 8 | loss: 0.7761902
	speed: 0.0149s/iter; left time: 38.9576s
	iters: 900, epoch: 8 | loss: 0.4748373
	speed: 0.0150s/iter; left time: 37.8896s
	iters: 1000, epoch: 8 | loss: 0.4903863
	speed: 0.0147s/iter; left time: 35.6731s
	iters: 1100, epoch: 8 | loss: 0.4321455
	speed: 0.0149s/iter; left time: 34.5117s
Epoch: 8 cost time: 16.92766833305359
Epoch: 8, Steps: 1140 | Train Loss: 0.5452640 Vali Loss: 0.5832679 Test Loss: 0.2796732
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.2803195118904114, mae:0.30244016647338867
Use GPU: cuda:0
no_skip True
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.7316893
	speed: 0.0194s/iter; left time: 219.0747s
	iters: 200, epoch: 1 | loss: 0.6031305
	speed: 0.0174s/iter; left time: 194.8083s
	iters: 300, epoch: 1 | loss: 1.0190288
	speed: 0.0164s/iter; left time: 181.8706s
	iters: 400, epoch: 1 | loss: 0.7502051
	speed: 0.0156s/iter; left time: 171.4743s
	iters: 500, epoch: 1 | loss: 0.4971235
	speed: 0.0153s/iter; left time: 167.2506s
	iters: 600, epoch: 1 | loss: 0.5479010
	speed: 0.0153s/iter; left time: 164.8243s
	iters: 700, epoch: 1 | loss: 0.5937997
	speed: 0.0155s/iter; left time: 165.4302s
	iters: 800, epoch: 1 | loss: 0.9917343
	speed: 0.0151s/iter; left time: 160.2005s
	iters: 900, epoch: 1 | loss: 0.7400224
	speed: 0.0150s/iter; left time: 157.0799s
	iters: 1000, epoch: 1 | loss: 0.5399635
	speed: 0.0149s/iter; left time: 155.2456s
	iters: 1100, epoch: 1 | loss: 0.4933228
	speed: 0.0149s/iter; left time: 153.3050s
Epoch: 1 cost time: 16.994778394699097
Epoch: 1, Steps: 1140 | Train Loss: 0.6460690 Vali Loss: 0.6256081 Test Loss: 0.2895954
Validation loss decreased (inf --> 0.625608).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4467803
	speed: 0.0166s/iter; left time: 168.9738s
	iters: 200, epoch: 2 | loss: 0.7861376
	speed: 0.0155s/iter; left time: 156.2652s
	iters: 300, epoch: 2 | loss: 0.9967194
	speed: 0.0158s/iter; left time: 157.2895s
	iters: 400, epoch: 2 | loss: 0.7745223
	speed: 0.0160s/iter; left time: 158.0328s
	iters: 500, epoch: 2 | loss: 0.7367415
	speed: 0.0152s/iter; left time: 148.6119s
	iters: 600, epoch: 2 | loss: 1.0543051
	speed: 0.0153s/iter; left time: 147.6824s
	iters: 700, epoch: 2 | loss: 0.4958073
	speed: 0.0154s/iter; left time: 147.4425s
	iters: 800, epoch: 2 | loss: 0.6509707
	speed: 0.0152s/iter; left time: 143.4796s
	iters: 900, epoch: 2 | loss: 0.5164273
	speed: 0.0149s/iter; left time: 139.0638s
	iters: 1000, epoch: 2 | loss: 0.4337365
	speed: 0.0144s/iter; left time: 133.4663s
	iters: 1100, epoch: 2 | loss: 0.4528603
	speed: 0.0146s/iter; left time: 133.6391s
Epoch: 2 cost time: 16.991259813308716
Epoch: 2, Steps: 1140 | Train Loss: 0.5896998 Vali Loss: 0.5958053 Test Loss: 0.2848220
Validation loss decreased (0.625608 --> 0.595805).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4893494
	speed: 0.0177s/iter; left time: 159.8078s
	iters: 200, epoch: 3 | loss: 0.5684102
	speed: 0.0163s/iter; left time: 145.3804s
	iters: 300, epoch: 3 | loss: 1.0509548
	speed: 0.0153s/iter; left time: 134.8136s
	iters: 400, epoch: 3 | loss: 0.4937110
	speed: 0.0149s/iter; left time: 129.6866s
	iters: 500, epoch: 3 | loss: 0.6684967
	speed: 0.0148s/iter; left time: 127.5249s
	iters: 600, epoch: 3 | loss: 0.4135967
	speed: 0.0150s/iter; left time: 127.7301s
	iters: 700, epoch: 3 | loss: 0.8068572
	speed: 0.0149s/iter; left time: 125.6637s
	iters: 800, epoch: 3 | loss: 0.8114617
	speed: 0.0148s/iter; left time: 123.0271s
	iters: 900, epoch: 3 | loss: 0.4866139
	speed: 0.0152s/iter; left time: 125.2991s
	iters: 1000, epoch: 3 | loss: 0.4977519
	speed: 0.0150s/iter; left time: 122.1469s
	iters: 1100, epoch: 3 | loss: 0.4080221
	speed: 0.0151s/iter; left time: 120.8426s
Epoch: 3 cost time: 17.25595474243164
Epoch: 3, Steps: 1140 | Train Loss: 0.5686714 Vali Loss: 0.5838254 Test Loss: 0.2830359
Validation loss decreased (0.595805 --> 0.583825).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4248241
	speed: 0.0197s/iter; left time: 155.1470s
	iters: 200, epoch: 4 | loss: 0.5886853
	speed: 0.0182s/iter; left time: 141.7903s
	iters: 300, epoch: 4 | loss: 0.6410440
	speed: 0.0166s/iter; left time: 127.2140s
	iters: 400, epoch: 4 | loss: 0.4298979
	speed: 0.0160s/iter; left time: 121.5224s
	iters: 500, epoch: 4 | loss: 0.5048816
	speed: 0.0157s/iter; left time: 117.5717s
	iters: 600, epoch: 4 | loss: 0.7376561
	speed: 0.0156s/iter; left time: 115.1703s
	iters: 700, epoch: 4 | loss: 0.4191377
	speed: 0.0153s/iter; left time: 111.6014s
	iters: 800, epoch: 4 | loss: 0.4999398
	speed: 0.0149s/iter; left time: 107.1724s
	iters: 900, epoch: 4 | loss: 0.4249157
	speed: 0.0147s/iter; left time: 104.2173s
	iters: 1000, epoch: 4 | loss: 0.8394634
	speed: 0.0146s/iter; left time: 101.5813s
	iters: 1100, epoch: 4 | loss: 0.9331135
	speed: 0.0142s/iter; left time: 97.5225s
Epoch: 4 cost time: 16.109924793243408
Epoch: 4, Steps: 1140 | Train Loss: 0.5555512 Vali Loss: 0.5828124 Test Loss: 0.2841386
Validation loss decreased (0.583825 --> 0.582812).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5496835
	speed: 0.0143s/iter; left time: 96.2876s
	iters: 200, epoch: 5 | loss: 0.4788862
	speed: 0.0126s/iter; left time: 83.5476s
	iters: 300, epoch: 5 | loss: 0.5797113
	speed: 0.0128s/iter; left time: 83.5118s
	iters: 400, epoch: 5 | loss: 0.4209654
	speed: 0.0123s/iter; left time: 79.4039s
	iters: 500, epoch: 5 | loss: 0.4481025
	speed: 0.0119s/iter; left time: 75.5084s
	iters: 600, epoch: 5 | loss: 0.9666725
	speed: 0.0120s/iter; left time: 74.9900s
	iters: 700, epoch: 5 | loss: 0.4149893
	speed: 0.0117s/iter; left time: 71.7075s
	iters: 800, epoch: 5 | loss: 0.3884243
	speed: 0.0121s/iter; left time: 73.1015s
	iters: 900, epoch: 5 | loss: 0.4285446
	speed: 0.0119s/iter; left time: 70.8018s
	iters: 1000, epoch: 5 | loss: 0.4440725
	speed: 0.0119s/iter; left time: 69.5596s
	iters: 1100, epoch: 5 | loss: 0.7700059
	speed: 0.0119s/iter; left time: 68.5471s
Epoch: 5 cost time: 13.656192779541016
Epoch: 5, Steps: 1140 | Train Loss: 0.5478222 Vali Loss: 0.5814267 Test Loss: 0.2841897
Validation loss decreased (0.582812 --> 0.581427).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4877444
	speed: 0.0155s/iter; left time: 86.9195s
	iters: 200, epoch: 6 | loss: 0.4966830
	speed: 0.0146s/iter; left time: 80.4443s
	iters: 300, epoch: 6 | loss: 0.5142915
	speed: 0.0148s/iter; left time: 79.8656s
	iters: 400, epoch: 6 | loss: 0.5072781
	speed: 0.0145s/iter; left time: 76.9351s
	iters: 500, epoch: 6 | loss: 0.4189410
	speed: 0.0143s/iter; left time: 74.3619s
	iters: 600, epoch: 6 | loss: 0.5273331
	speed: 0.0145s/iter; left time: 74.0949s
	iters: 700, epoch: 6 | loss: 0.4710927
	speed: 0.0145s/iter; left time: 72.5053s
	iters: 800, epoch: 6 | loss: 0.4164563
	speed: 0.0147s/iter; left time: 72.1501s
	iters: 900, epoch: 6 | loss: 0.4732556
	speed: 0.0146s/iter; left time: 70.0050s
	iters: 1000, epoch: 6 | loss: 0.6655670
	speed: 0.0146s/iter; left time: 68.4896s
	iters: 1100, epoch: 6 | loss: 0.6176034
	speed: 0.0149s/iter; left time: 68.4286s
Epoch: 6 cost time: 17.06597924232483
Epoch: 6, Steps: 1140 | Train Loss: 0.5434715 Vali Loss: 0.5836247 Test Loss: 0.2847367
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.7002391
	speed: 0.0140s/iter; left time: 62.3783s
	iters: 200, epoch: 7 | loss: 0.7325132
	speed: 0.0151s/iter; left time: 65.9208s
	iters: 300, epoch: 7 | loss: 0.4749403
	speed: 0.0154s/iter; left time: 65.8104s
	iters: 400, epoch: 7 | loss: 0.3776555
	speed: 0.0156s/iter; left time: 64.8131s
	iters: 500, epoch: 7 | loss: 0.4773557
	speed: 0.0156s/iter; left time: 63.3500s
	iters: 600, epoch: 7 | loss: 0.4593178
	speed: 0.0153s/iter; left time: 60.4528s
	iters: 700, epoch: 7 | loss: 0.4811822
	speed: 0.0153s/iter; left time: 59.1424s
	iters: 800, epoch: 7 | loss: 0.8502012
	speed: 0.0154s/iter; left time: 58.0093s
	iters: 900, epoch: 7 | loss: 0.4291788
	speed: 0.0157s/iter; left time: 57.5755s
	iters: 1000, epoch: 7 | loss: 0.5671242
	speed: 0.0154s/iter; left time: 54.8324s
	iters: 1100, epoch: 7 | loss: 0.4736308
	speed: 0.0154s/iter; left time: 53.1928s
Epoch: 7 cost time: 17.61443305015564
Epoch: 7, Steps: 1140 | Train Loss: 0.5411293 Vali Loss: 0.5824628 Test Loss: 0.2840628
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4871375
	speed: 0.0161s/iter; left time: 53.5549s
	iters: 200, epoch: 8 | loss: 0.5083310
	speed: 0.0152s/iter; left time: 49.0214s
	iters: 300, epoch: 8 | loss: 0.8107859
	speed: 0.0157s/iter; left time: 48.8578s
	iters: 400, epoch: 8 | loss: 0.6192115
	speed: 0.0150s/iter; left time: 45.2373s
	iters: 500, epoch: 8 | loss: 0.5498825
	speed: 0.0153s/iter; left time: 44.5562s
	iters: 600, epoch: 8 | loss: 0.4138313
	speed: 0.0154s/iter; left time: 43.3731s
	iters: 700, epoch: 8 | loss: 0.4016331
	speed: 0.0150s/iter; left time: 40.9231s
	iters: 800, epoch: 8 | loss: 0.7310730
	speed: 0.0149s/iter; left time: 38.9957s
	iters: 900, epoch: 8 | loss: 0.7473195
	speed: 0.0148s/iter; left time: 37.2012s
	iters: 1000, epoch: 8 | loss: 0.4719113
	speed: 0.0148s/iter; left time: 35.7981s
	iters: 1100, epoch: 8 | loss: 0.4542021
	speed: 0.0147s/iter; left time: 34.0389s
Epoch: 8 cost time: 16.770347118377686
Epoch: 8, Steps: 1140 | Train Loss: 0.5406460 Vali Loss: 0.5835860 Test Loss: 0.2841917
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.7367670
	speed: 0.0183s/iter; left time: 39.9372s
	iters: 200, epoch: 9 | loss: 1.0085829
	speed: 0.0176s/iter; left time: 36.5421s
	iters: 300, epoch: 9 | loss: 0.7777885
	speed: 0.0158s/iter; left time: 31.3712s
	iters: 400, epoch: 9 | loss: 1.0426683
	speed: 0.0153s/iter; left time: 28.7363s
	iters: 500, epoch: 9 | loss: 0.4651836
	speed: 0.0150s/iter; left time: 26.7616s
	iters: 600, epoch: 9 | loss: 0.7103619
	speed: 0.0151s/iter; left time: 25.3178s
	iters: 700, epoch: 9 | loss: 0.6747870
	speed: 0.0150s/iter; left time: 23.7529s
	iters: 800, epoch: 9 | loss: 0.7520707
	speed: 0.0145s/iter; left time: 21.4880s
	iters: 900, epoch: 9 | loss: 0.4558241
	speed: 0.0142s/iter; left time: 19.6126s
	iters: 1000, epoch: 9 | loss: 0.4741960
	speed: 0.0143s/iter; left time: 18.2962s
	iters: 1100, epoch: 9 | loss: 0.4560897
	speed: 0.0143s/iter; left time: 16.9058s
Epoch: 9 cost time: 16.379744291305542
Epoch: 9, Steps: 1140 | Train Loss: 0.5394487 Vali Loss: 0.5836616 Test Loss: 0.2841690
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.4616348
	speed: 0.0189s/iter; left time: 19.6729s
	iters: 200, epoch: 10 | loss: 0.5246793
	speed: 0.0163s/iter; left time: 15.2932s
	iters: 300, epoch: 10 | loss: 0.4916074
	speed: 0.0147s/iter; left time: 12.3922s
	iters: 400, epoch: 10 | loss: 0.4508518
	speed: 0.0148s/iter; left time: 11.0021s
	iters: 500, epoch: 10 | loss: 0.4390536
	speed: 0.0150s/iter; left time: 9.6208s
	iters: 600, epoch: 10 | loss: 0.4808734
	speed: 0.0151s/iter; left time: 8.1628s
	iters: 700, epoch: 10 | loss: 0.4844125
	speed: 0.0146s/iter; left time: 6.4207s
	iters: 800, epoch: 10 | loss: 0.4364837
	speed: 0.0144s/iter; left time: 4.9132s
	iters: 900, epoch: 10 | loss: 0.6640265
	speed: 0.0146s/iter; left time: 3.5212s
	iters: 1000, epoch: 10 | loss: 0.4935865
	speed: 0.0147s/iter; left time: 2.0718s
	iters: 1100, epoch: 10 | loss: 0.6971036
	speed: 0.0147s/iter; left time: 0.6018s
Epoch: 10 cost time: 16.7920925617218
Epoch: 10, Steps: 1140 | Train Loss: 0.5392059 Vali Loss: 0.5828447 Test Loss: 0.2843094
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.2841896414756775, mae:0.3040381073951721
Use GPU: cuda:0
no_skip True
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.5796403
	speed: 0.0182s/iter; left time: 205.7748s
	iters: 200, epoch: 1 | loss: 0.6431648
	speed: 0.0156s/iter; left time: 174.7897s
	iters: 300, epoch: 1 | loss: 0.5518615
	speed: 0.0138s/iter; left time: 153.1062s
	iters: 400, epoch: 1 | loss: 0.5462444
	speed: 0.0135s/iter; left time: 148.8407s
	iters: 500, epoch: 1 | loss: 0.5517022
	speed: 0.0132s/iter; left time: 143.7693s
	iters: 600, epoch: 1 | loss: 0.8023345
	speed: 0.0126s/iter; left time: 135.9363s
	iters: 700, epoch: 1 | loss: 0.5115446
	speed: 0.0126s/iter; left time: 134.8533s
	iters: 800, epoch: 1 | loss: 0.7683639
	speed: 0.0128s/iter; left time: 135.6158s
	iters: 900, epoch: 1 | loss: 0.7179341
	speed: 0.0128s/iter; left time: 134.3326s
	iters: 1000, epoch: 1 | loss: 0.5848265
	speed: 0.0129s/iter; left time: 133.8916s
	iters: 1100, epoch: 1 | loss: 0.4334748
	speed: 0.0132s/iter; left time: 136.0529s
Epoch: 1 cost time: 15.302811622619629
Epoch: 1, Steps: 1140 | Train Loss: 0.6457682 Vali Loss: 0.6531537 Test Loss: 0.2931281
Validation loss decreased (inf --> 0.653154).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4669118
	speed: 0.0191s/iter; left time: 193.9592s
	iters: 200, epoch: 2 | loss: 0.4518567
	speed: 0.0177s/iter; left time: 177.6888s
	iters: 300, epoch: 2 | loss: 0.5322759
	speed: 0.0156s/iter; left time: 155.3860s
	iters: 400, epoch: 2 | loss: 0.4525647
	speed: 0.0152s/iter; left time: 149.5510s
	iters: 500, epoch: 2 | loss: 0.5841277
	speed: 0.0153s/iter; left time: 149.2342s
	iters: 600, epoch: 2 | loss: 0.6048391
	speed: 0.0150s/iter; left time: 144.9268s
	iters: 700, epoch: 2 | loss: 0.4643164
	speed: 0.0147s/iter; left time: 140.9593s
	iters: 800, epoch: 2 | loss: 0.4309275
	speed: 0.0146s/iter; left time: 137.7639s
	iters: 900, epoch: 2 | loss: 0.8238816
	speed: 0.0144s/iter; left time: 134.6891s
	iters: 1000, epoch: 2 | loss: 0.5966529
	speed: 0.0142s/iter; left time: 131.5270s
	iters: 1100, epoch: 2 | loss: 0.7722267
	speed: 0.0143s/iter; left time: 130.9774s
Epoch: 2 cost time: 16.639505624771118
Epoch: 2, Steps: 1140 | Train Loss: 0.5889875 Vali Loss: 0.6057256 Test Loss: 0.2865156
Validation loss decreased (0.653154 --> 0.605726).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7491028
	speed: 0.0220s/iter; left time: 198.0158s
	iters: 200, epoch: 3 | loss: 0.4303322
	speed: 0.0184s/iter; left time: 164.3902s
	iters: 300, epoch: 3 | loss: 0.5023276
	speed: 0.0173s/iter; left time: 153.0137s
	iters: 400, epoch: 3 | loss: 0.4260512
	speed: 0.0165s/iter; left time: 143.7869s
	iters: 500, epoch: 3 | loss: 0.4990205
	speed: 0.0163s/iter; left time: 140.4863s
	iters: 600, epoch: 3 | loss: 0.4862824
	speed: 0.0159s/iter; left time: 135.1515s
	iters: 700, epoch: 3 | loss: 0.8104452
	speed: 0.0157s/iter; left time: 132.3141s
	iters: 800, epoch: 3 | loss: 0.5555548
	speed: 0.0155s/iter; left time: 129.1681s
	iters: 900, epoch: 3 | loss: 0.7870202
	speed: 0.0152s/iter; left time: 125.1349s
	iters: 1000, epoch: 3 | loss: 0.6704031
	speed: 0.0148s/iter; left time: 119.8386s
	iters: 1100, epoch: 3 | loss: 0.4594652
	speed: 0.0147s/iter; left time: 117.6487s
Epoch: 3 cost time: 16.85780644416809
Epoch: 3, Steps: 1140 | Train Loss: 0.5701497 Vali Loss: 0.5908917 Test Loss: 0.2825971
Validation loss decreased (0.605726 --> 0.590892).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4317336
	speed: 0.0185s/iter; left time: 146.1155s
	iters: 200, epoch: 4 | loss: 0.9007937
	speed: 0.0167s/iter; left time: 129.8873s
	iters: 300, epoch: 4 | loss: 0.5735257
	speed: 0.0159s/iter; left time: 121.9800s
	iters: 400, epoch: 4 | loss: 0.7608187
	speed: 0.0156s/iter; left time: 117.9673s
	iters: 500, epoch: 4 | loss: 0.4076183
	speed: 0.0157s/iter; left time: 117.2984s
	iters: 600, epoch: 4 | loss: 0.5316505
	speed: 0.0155s/iter; left time: 114.2192s
	iters: 700, epoch: 4 | loss: 0.4898661
	speed: 0.0150s/iter; left time: 109.4389s
	iters: 800, epoch: 4 | loss: 0.4952079
	speed: 0.0147s/iter; left time: 105.4596s
	iters: 900, epoch: 4 | loss: 0.6874982
	speed: 0.0146s/iter; left time: 103.4664s
	iters: 1000, epoch: 4 | loss: 0.7772097
	speed: 0.0146s/iter; left time: 101.9836s
	iters: 1100, epoch: 4 | loss: 0.4666956
	speed: 0.0145s/iter; left time: 99.8071s
Epoch: 4 cost time: 16.45706033706665
Epoch: 4, Steps: 1140 | Train Loss: 0.5587757 Vali Loss: 0.5918629 Test Loss: 0.2830828
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4634273
	speed: 0.0154s/iter; left time: 103.7871s
	iters: 200, epoch: 5 | loss: 0.4446858
	speed: 0.0149s/iter; left time: 99.1855s
	iters: 300, epoch: 5 | loss: 0.4032915
	speed: 0.0148s/iter; left time: 96.4878s
	iters: 400, epoch: 5 | loss: 0.4603631
	speed: 0.0144s/iter; left time: 92.9295s
	iters: 500, epoch: 5 | loss: 0.4779650
	speed: 0.0137s/iter; left time: 87.0727s
	iters: 600, epoch: 5 | loss: 0.4656167
	speed: 0.0139s/iter; left time: 86.9573s
	iters: 700, epoch: 5 | loss: 0.7330296
	speed: 0.0150s/iter; left time: 91.8563s
	iters: 800, epoch: 5 | loss: 0.9987405
	speed: 0.0147s/iter; left time: 88.7890s
	iters: 900, epoch: 5 | loss: 0.9696425
	speed: 0.0145s/iter; left time: 86.0016s
	iters: 1000, epoch: 5 | loss: 0.6199052
	speed: 0.0144s/iter; left time: 84.2575s
	iters: 1100, epoch: 5 | loss: 0.4266121
	speed: 0.0145s/iter; left time: 83.2206s
Epoch: 5 cost time: 16.669687032699585
Epoch: 5, Steps: 1140 | Train Loss: 0.5519018 Vali Loss: 0.5876930 Test Loss: 0.2820258
Validation loss decreased (0.590892 --> 0.587693).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4059963
	speed: 0.0182s/iter; left time: 101.7903s
	iters: 200, epoch: 6 | loss: 0.3947044
	speed: 0.0182s/iter; left time: 99.9381s
	iters: 300, epoch: 6 | loss: 0.7667435
	speed: 0.0167s/iter; left time: 90.3375s
	iters: 400, epoch: 6 | loss: 0.4421070
	speed: 0.0158s/iter; left time: 83.6321s
	iters: 500, epoch: 6 | loss: 0.4297896
	speed: 0.0152s/iter; left time: 79.2681s
	iters: 600, epoch: 6 | loss: 0.7416154
	speed: 0.0146s/iter; left time: 74.3424s
	iters: 700, epoch: 6 | loss: 0.3739188
	speed: 0.0144s/iter; left time: 72.0120s
	iters: 800, epoch: 6 | loss: 0.4903014
	speed: 0.0143s/iter; left time: 69.9830s
	iters: 900, epoch: 6 | loss: 0.4428631
	speed: 0.0142s/iter; left time: 68.0828s
	iters: 1000, epoch: 6 | loss: 0.5394539
	speed: 0.0139s/iter; left time: 65.5692s
	iters: 1100, epoch: 6 | loss: 0.5510771
	speed: 0.0139s/iter; left time: 63.9000s
Epoch: 6 cost time: 15.896222114562988
Epoch: 6, Steps: 1140 | Train Loss: 0.5483040 Vali Loss: 0.5900185 Test Loss: 0.2821809
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5007707
	speed: 0.0164s/iter; left time: 73.3442s
	iters: 200, epoch: 7 | loss: 0.5648673
	speed: 0.0149s/iter; left time: 64.8455s
	iters: 300, epoch: 7 | loss: 0.4882799
	speed: 0.0154s/iter; left time: 65.7870s
	iters: 400, epoch: 7 | loss: 0.4928478
	speed: 0.0156s/iter; left time: 64.9508s
	iters: 500, epoch: 7 | loss: 0.5872617
	speed: 0.0149s/iter; left time: 60.6789s
	iters: 600, epoch: 7 | loss: 0.5181245
	speed: 0.0146s/iter; left time: 57.6718s
	iters: 700, epoch: 7 | loss: 0.8881395
	speed: 0.0153s/iter; left time: 58.9390s
	iters: 800, epoch: 7 | loss: 0.4840190
	speed: 0.0153s/iter; left time: 57.5766s
	iters: 900, epoch: 7 | loss: 0.6942082
	speed: 0.0152s/iter; left time: 55.5768s
	iters: 1000, epoch: 7 | loss: 0.7000451
	speed: 0.0152s/iter; left time: 54.0598s
	iters: 1100, epoch: 7 | loss: 0.5090623
	speed: 0.0150s/iter; left time: 51.9002s
Epoch: 7 cost time: 17.13909125328064
Epoch: 7, Steps: 1140 | Train Loss: 0.5459262 Vali Loss: 0.5880363 Test Loss: 0.2818540
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4310687
	speed: 0.0179s/iter; left time: 59.2862s
	iters: 200, epoch: 8 | loss: 0.7517342
	speed: 0.0167s/iter; left time: 53.6349s
	iters: 300, epoch: 8 | loss: 0.7128404
	speed: 0.0181s/iter; left time: 56.6033s
	iters: 400, epoch: 8 | loss: 0.4249297
	speed: 0.0179s/iter; left time: 54.1135s
	iters: 500, epoch: 8 | loss: 0.4348198
	speed: 0.0169s/iter; left time: 49.3107s
	iters: 600, epoch: 8 | loss: 0.5290321
	speed: 0.0166s/iter; left time: 46.8377s
	iters: 700, epoch: 8 | loss: 0.4487127
	speed: 0.0164s/iter; left time: 44.5550s
	iters: 800, epoch: 8 | loss: 0.4593807
	speed: 0.0160s/iter; left time: 41.9429s
	iters: 900, epoch: 8 | loss: 0.3946245
	speed: 0.0158s/iter; left time: 39.7927s
	iters: 1000, epoch: 8 | loss: 0.4418593
	speed: 0.0155s/iter; left time: 37.5283s
	iters: 1100, epoch: 8 | loss: 0.4707378
	speed: 0.0154s/iter; left time: 35.8334s
Epoch: 8 cost time: 17.677719593048096
Epoch: 8, Steps: 1140 | Train Loss: 0.5447877 Vali Loss: 0.5875131 Test Loss: 0.2818441
Validation loss decreased (0.587693 --> 0.587513).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4546331
	speed: 0.0171s/iter; left time: 37.3689s
	iters: 200, epoch: 9 | loss: 0.4398631
	speed: 0.0154s/iter; left time: 32.1205s
	iters: 300, epoch: 9 | loss: 0.4714710
	speed: 0.0149s/iter; left time: 29.4504s
	iters: 400, epoch: 9 | loss: 0.4304355
	speed: 0.0141s/iter; left time: 26.4579s
	iters: 500, epoch: 9 | loss: 0.9010931
	speed: 0.0138s/iter; left time: 24.5263s
	iters: 600, epoch: 9 | loss: 0.4158864
	speed: 0.0139s/iter; left time: 23.3506s
	iters: 700, epoch: 9 | loss: 0.6267486
	speed: 0.0139s/iter; left time: 22.0479s
	iters: 800, epoch: 9 | loss: 0.7136416
	speed: 0.0139s/iter; left time: 20.6499s
	iters: 900, epoch: 9 | loss: 0.4887096
	speed: 0.0137s/iter; left time: 18.9501s
	iters: 1000, epoch: 9 | loss: 0.5165758
	speed: 0.0137s/iter; left time: 17.5774s
	iters: 1100, epoch: 9 | loss: 0.4242366
	speed: 0.0135s/iter; left time: 15.9103s
Epoch: 9 cost time: 15.511780738830566
Epoch: 9, Steps: 1140 | Train Loss: 0.5442265 Vali Loss: 0.5893760 Test Loss: 0.2820310
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.4887279
	speed: 0.0167s/iter; left time: 17.3868s
	iters: 200, epoch: 10 | loss: 0.3815223
	speed: 0.0152s/iter; left time: 14.3429s
	iters: 300, epoch: 10 | loss: 0.4647119
	speed: 0.0149s/iter; left time: 12.5722s
	iters: 400, epoch: 10 | loss: 0.9831623
	speed: 0.0150s/iter; left time: 11.1437s
	iters: 500, epoch: 10 | loss: 0.4410174
	speed: 0.0147s/iter; left time: 9.4212s
	iters: 600, epoch: 10 | loss: 0.5097704
	speed: 0.0146s/iter; left time: 7.9153s
	iters: 700, epoch: 10 | loss: 0.8534264
	speed: 0.0143s/iter; left time: 6.3023s
	iters: 800, epoch: 10 | loss: 0.4173487
	speed: 0.0140s/iter; left time: 4.7576s
	iters: 900, epoch: 10 | loss: 0.4834995
	speed: 0.0140s/iter; left time: 3.3654s
	iters: 1000, epoch: 10 | loss: 0.4952685
	speed: 0.0142s/iter; left time: 2.0072s
	iters: 1100, epoch: 10 | loss: 0.4819620
	speed: 0.0141s/iter; left time: 0.5798s
Epoch: 10 cost time: 16.185505628585815
Epoch: 10, Steps: 1140 | Train Loss: 0.5438438 Vali Loss: 0.5902669 Test Loss: 0.2820829
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.28184401988983154, mae:0.30285319685935974
Seed: 42
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_720      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip True
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.6919863
	speed: 0.0280s/iter; left time: 312.8941s
	iters: 200, epoch: 1 | loss: 0.9790114
	speed: 0.0218s/iter; left time: 241.9718s
	iters: 300, epoch: 1 | loss: 0.6301855
	speed: 0.0194s/iter; left time: 213.2073s
	iters: 400, epoch: 1 | loss: 0.7484559
	speed: 0.0184s/iter; left time: 200.0671s
	iters: 500, epoch: 1 | loss: 0.6417855
	speed: 0.0179s/iter; left time: 193.2675s
	iters: 600, epoch: 1 | loss: 0.6418636
	speed: 0.0172s/iter; left time: 183.9651s
	iters: 700, epoch: 1 | loss: 0.5248260
	speed: 0.0168s/iter; left time: 178.0508s
	iters: 800, epoch: 1 | loss: 0.8074242
	speed: 0.0165s/iter; left time: 172.4186s
	iters: 900, epoch: 1 | loss: 0.6675841
	speed: 0.0161s/iter; left time: 166.9740s
	iters: 1000, epoch: 1 | loss: 0.5947405
	speed: 0.0158s/iter; left time: 162.2460s
	iters: 1100, epoch: 1 | loss: 0.7166784
	speed: 0.0156s/iter; left time: 158.4175s
Epoch: 1 cost time: 17.55920958518982
Epoch: 1, Steps: 1128 | Train Loss: 0.7163126 Vali Loss: 0.7273288 Test Loss: 0.3594082
Validation loss decreased (inf --> 0.727329).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6987112
	speed: 0.0178s/iter; left time: 178.8847s
	iters: 200, epoch: 2 | loss: 0.7230459
	speed: 0.0159s/iter; left time: 158.5843s
	iters: 300, epoch: 2 | loss: 0.7249095
	speed: 0.0152s/iter; left time: 149.5390s
	iters: 400, epoch: 2 | loss: 0.6632684
	speed: 0.0144s/iter; left time: 140.8125s
	iters: 500, epoch: 2 | loss: 0.6022952
	speed: 0.0141s/iter; left time: 135.8603s
	iters: 600, epoch: 2 | loss: 0.5733464
	speed: 0.0144s/iter; left time: 137.9059s
	iters: 700, epoch: 2 | loss: 0.8735409
	speed: 0.0144s/iter; left time: 136.0717s
	iters: 800, epoch: 2 | loss: 0.7695712
	speed: 0.0147s/iter; left time: 137.2796s
	iters: 900, epoch: 2 | loss: 0.5494068
	speed: 0.0144s/iter; left time: 132.8209s
	iters: 1000, epoch: 2 | loss: 0.6480910
	speed: 0.0144s/iter; left time: 131.4241s
	iters: 1100, epoch: 2 | loss: 0.5171309
	speed: 0.0143s/iter; left time: 129.3923s
Epoch: 2 cost time: 16.222444534301758
Epoch: 2, Steps: 1128 | Train Loss: 0.6702597 Vali Loss: 0.7242923 Test Loss: 0.3566097
Validation loss decreased (0.727329 --> 0.724292).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6387827
	speed: 0.0171s/iter; left time: 152.1993s
	iters: 200, epoch: 3 | loss: 0.6715708
	speed: 0.0151s/iter; left time: 132.9214s
	iters: 300, epoch: 3 | loss: 0.6519364
	speed: 0.0152s/iter; left time: 132.2464s
	iters: 400, epoch: 3 | loss: 0.5825132
	speed: 0.0148s/iter; left time: 127.9015s
	iters: 500, epoch: 3 | loss: 0.5392572
	speed: 0.0145s/iter; left time: 123.7900s
	iters: 600, epoch: 3 | loss: 0.5690063
	speed: 0.0144s/iter; left time: 121.5771s
	iters: 700, epoch: 3 | loss: 0.5600197
	speed: 0.0148s/iter; left time: 123.4531s
	iters: 800, epoch: 3 | loss: 0.4898551
	speed: 0.0146s/iter; left time: 119.6854s
	iters: 900, epoch: 3 | loss: 0.6849146
	speed: 0.0143s/iter; left time: 116.0755s
	iters: 1000, epoch: 3 | loss: 0.5776731
	speed: 0.0141s/iter; left time: 113.4406s
	iters: 1100, epoch: 3 | loss: 0.5363148
	speed: 0.0143s/iter; left time: 113.1327s
Epoch: 3 cost time: 16.23190665245056
Epoch: 3, Steps: 1128 | Train Loss: 0.6526215 Vali Loss: 0.7133456 Test Loss: 0.3549250
Validation loss decreased (0.724292 --> 0.713346).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6821681
	speed: 0.0208s/iter; left time: 162.1051s
	iters: 200, epoch: 4 | loss: 0.5694199
	speed: 0.0171s/iter; left time: 131.5433s
	iters: 300, epoch: 4 | loss: 0.7689320
	speed: 0.0179s/iter; left time: 135.6110s
	iters: 400, epoch: 4 | loss: 0.5380443
	speed: 0.0167s/iter; left time: 125.0072s
	iters: 500, epoch: 4 | loss: 0.5780385
	speed: 0.0160s/iter; left time: 118.2385s
	iters: 600, epoch: 4 | loss: 0.7508950
	speed: 0.0159s/iter; left time: 115.6631s
	iters: 700, epoch: 4 | loss: 0.4912615
	speed: 0.0160s/iter; left time: 114.9294s
	iters: 800, epoch: 4 | loss: 0.5976452
	speed: 0.0158s/iter; left time: 111.9769s
	iters: 900, epoch: 4 | loss: 0.7043469
	speed: 0.0154s/iter; left time: 107.8091s
	iters: 1000, epoch: 4 | loss: 0.7394691
	speed: 0.0154s/iter; left time: 106.0485s
	iters: 1100, epoch: 4 | loss: 0.6627815
	speed: 0.0153s/iter; left time: 103.9869s
Epoch: 4 cost time: 17.35213327407837
Epoch: 4, Steps: 1128 | Train Loss: 0.6429186 Vali Loss: 0.7141934 Test Loss: 0.3557895
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5967128
	speed: 0.0171s/iter; left time: 114.0041s
	iters: 200, epoch: 5 | loss: 0.4921658
	speed: 0.0153s/iter; left time: 100.1896s
	iters: 300, epoch: 5 | loss: 0.6464732
	speed: 0.0151s/iter; left time: 97.9530s
	iters: 400, epoch: 5 | loss: 0.5219986
	speed: 0.0151s/iter; left time: 96.0847s
	iters: 500, epoch: 5 | loss: 0.6621469
	speed: 0.0149s/iter; left time: 93.1828s
	iters: 600, epoch: 5 | loss: 0.5636542
	speed: 0.0147s/iter; left time: 90.8050s
	iters: 700, epoch: 5 | loss: 0.6692212
	speed: 0.0147s/iter; left time: 89.2864s
	iters: 800, epoch: 5 | loss: 0.8265665
	speed: 0.0146s/iter; left time: 87.3615s
	iters: 900, epoch: 5 | loss: 0.5717070
	speed: 0.0149s/iter; left time: 87.7206s
	iters: 1000, epoch: 5 | loss: 0.9183722
	speed: 0.0158s/iter; left time: 90.9162s
	iters: 1100, epoch: 5 | loss: 0.7033312
	speed: 0.0154s/iter; left time: 87.4860s
Epoch: 5 cost time: 17.342458248138428
Epoch: 5, Steps: 1128 | Train Loss: 0.6373802 Vali Loss: 0.7169874 Test Loss: 0.3574575
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 1.0122391
	speed: 0.0216s/iter; left time: 119.6457s
	iters: 200, epoch: 6 | loss: 0.7513073
	speed: 0.0168s/iter; left time: 91.3209s
	iters: 300, epoch: 6 | loss: 0.6281808
	speed: 0.0151s/iter; left time: 80.4579s
	iters: 400, epoch: 6 | loss: 0.4835854
	speed: 0.0143s/iter; left time: 75.0186s
	iters: 500, epoch: 6 | loss: 0.6724162
	speed: 0.0137s/iter; left time: 70.3958s
	iters: 600, epoch: 6 | loss: 0.7152081
	speed: 0.0135s/iter; left time: 67.8206s
	iters: 700, epoch: 6 | loss: 0.6207392
	speed: 0.0134s/iter; left time: 66.1131s
	iters: 800, epoch: 6 | loss: 0.6325456
	speed: 0.0133s/iter; left time: 64.2655s
	iters: 900, epoch: 6 | loss: 0.4695699
	speed: 0.0134s/iter; left time: 63.4506s
	iters: 1000, epoch: 6 | loss: 0.5362644
	speed: 0.0133s/iter; left time: 61.9307s
	iters: 1100, epoch: 6 | loss: 0.6267486
	speed: 0.0139s/iter; left time: 63.0363s
Epoch: 6 cost time: 15.668846607208252
Epoch: 6, Steps: 1128 | Train Loss: 0.6335683 Vali Loss: 0.7205114 Test Loss: 0.3577646
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8878944
	speed: 0.0175s/iter; left time: 77.4475s
	iters: 200, epoch: 7 | loss: 0.6524370
	speed: 0.0155s/iter; left time: 66.7803s
	iters: 300, epoch: 7 | loss: 0.4533815
	speed: 0.0160s/iter; left time: 67.3378s
	iters: 400, epoch: 7 | loss: 0.5669076
	speed: 0.0155s/iter; left time: 63.7401s
	iters: 500, epoch: 7 | loss: 0.6870498
	speed: 0.0152s/iter; left time: 61.1844s
	iters: 600, epoch: 7 | loss: 0.7126420
	speed: 0.0154s/iter; left time: 60.0658s
	iters: 700, epoch: 7 | loss: 0.6842396
	speed: 0.0151s/iter; left time: 57.5001s
	iters: 800, epoch: 7 | loss: 0.6973625
	speed: 0.0148s/iter; left time: 55.0191s
	iters: 900, epoch: 7 | loss: 0.5971503
	speed: 0.0147s/iter; left time: 53.0205s
	iters: 1000, epoch: 7 | loss: 0.5321383
	speed: 0.0146s/iter; left time: 51.4263s
	iters: 1100, epoch: 7 | loss: 0.5341181
	speed: 0.0146s/iter; left time: 49.9772s
Epoch: 7 cost time: 16.574644088745117
Epoch: 7, Steps: 1128 | Train Loss: 0.6316984 Vali Loss: 0.7207137 Test Loss: 0.3579264
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.5635006
	speed: 0.0227s/iter; left time: 74.4876s
	iters: 200, epoch: 8 | loss: 0.5547711
	speed: 0.0194s/iter; left time: 61.6422s
	iters: 300, epoch: 8 | loss: 0.6394914
	speed: 0.0179s/iter; left time: 55.1474s
	iters: 400, epoch: 8 | loss: 0.9896504
	speed: 0.0170s/iter; left time: 50.6302s
	iters: 500, epoch: 8 | loss: 1.0326293
	speed: 0.0163s/iter; left time: 47.1586s
	iters: 600, epoch: 8 | loss: 0.5831218
	speed: 0.0161s/iter; left time: 44.9538s
	iters: 700, epoch: 8 | loss: 0.7835201
	speed: 0.0159s/iter; left time: 42.7206s
	iters: 800, epoch: 8 | loss: 0.9351584
	speed: 0.0157s/iter; left time: 40.6065s
	iters: 900, epoch: 8 | loss: 0.4863032
	speed: 0.0157s/iter; left time: 39.1312s
	iters: 1000, epoch: 8 | loss: 0.6547183
	speed: 0.0156s/iter; left time: 37.1527s
	iters: 1100, epoch: 8 | loss: 0.6313154
	speed: 0.0154s/iter; left time: 35.1609s
Epoch: 8 cost time: 17.474469661712646
Epoch: 8, Steps: 1128 | Train Loss: 0.6305414 Vali Loss: 0.7231390 Test Loss: 0.3582834
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.3549250662326813, mae:0.35100609064102173
Use GPU: cuda:0
no_skip True
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.6906232
	speed: 0.0187s/iter; left time: 209.5119s
	iters: 200, epoch: 1 | loss: 0.9752952
	speed: 0.0177s/iter; left time: 195.6796s
	iters: 300, epoch: 1 | loss: 0.6971144
	speed: 0.0166s/iter; left time: 182.2755s
	iters: 400, epoch: 1 | loss: 0.5751040
	speed: 0.0158s/iter; left time: 171.5655s
	iters: 500, epoch: 1 | loss: 0.7811542
	speed: 0.0152s/iter; left time: 164.0483s
	iters: 600, epoch: 1 | loss: 0.5639319
	speed: 0.0148s/iter; left time: 158.0274s
	iters: 700, epoch: 1 | loss: 0.8536223
	speed: 0.0150s/iter; left time: 158.9965s
	iters: 800, epoch: 1 | loss: 0.6168283
	speed: 0.0148s/iter; left time: 154.8836s
	iters: 900, epoch: 1 | loss: 0.6556708
	speed: 0.0147s/iter; left time: 152.2294s
	iters: 1000, epoch: 1 | loss: 0.8895416
	speed: 0.0144s/iter; left time: 148.5430s
	iters: 1100, epoch: 1 | loss: 0.5228593
	speed: 0.0142s/iter; left time: 144.2102s
Epoch: 1 cost time: 16.057023286819458
Epoch: 1, Steps: 1128 | Train Loss: 0.7228695 Vali Loss: 0.7339022 Test Loss: 0.3614387
Validation loss decreased (inf --> 0.733902).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9050139
	speed: 0.0175s/iter; left time: 175.4598s
	iters: 200, epoch: 2 | loss: 0.7046739
	speed: 0.0149s/iter; left time: 148.6739s
	iters: 300, epoch: 2 | loss: 0.7245052
	speed: 0.0151s/iter; left time: 148.7482s
	iters: 400, epoch: 2 | loss: 0.6250175
	speed: 0.0152s/iter; left time: 148.7071s
	iters: 500, epoch: 2 | loss: 0.5049893
	speed: 0.0149s/iter; left time: 143.3484s
	iters: 600, epoch: 2 | loss: 0.5668566
	speed: 0.0151s/iter; left time: 143.8860s
	iters: 700, epoch: 2 | loss: 0.5741991
	speed: 0.0154s/iter; left time: 145.1309s
	iters: 800, epoch: 2 | loss: 0.5509269
	speed: 0.0151s/iter; left time: 141.1407s
	iters: 900, epoch: 2 | loss: 0.6738602
	speed: 0.0149s/iter; left time: 138.1587s
	iters: 1000, epoch: 2 | loss: 0.6216594
	speed: 0.0151s/iter; left time: 138.6081s
	iters: 1100, epoch: 2 | loss: 0.6918529
	speed: 0.0151s/iter; left time: 136.4255s
Epoch: 2 cost time: 17.030388593673706
Epoch: 2, Steps: 1128 | Train Loss: 0.6688473 Vali Loss: 0.7150905 Test Loss: 0.3583771
Validation loss decreased (0.733902 --> 0.715090).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5717638
	speed: 0.0166s/iter; left time: 148.4075s
	iters: 200, epoch: 3 | loss: 0.7389146
	speed: 0.0161s/iter; left time: 142.1022s
	iters: 300, epoch: 3 | loss: 0.6175224
	speed: 0.0164s/iter; left time: 142.6649s
	iters: 400, epoch: 3 | loss: 0.6586304
	speed: 0.0156s/iter; left time: 134.9191s
	iters: 500, epoch: 3 | loss: 0.8115479
	speed: 0.0153s/iter; left time: 130.3717s
	iters: 600, epoch: 3 | loss: 0.8062750
	speed: 0.0154s/iter; left time: 129.4242s
	iters: 700, epoch: 3 | loss: 0.5469887
	speed: 0.0153s/iter; left time: 127.3688s
	iters: 800, epoch: 3 | loss: 0.7536448
	speed: 0.0151s/iter; left time: 123.8945s
	iters: 900, epoch: 3 | loss: 0.7745412
	speed: 0.0147s/iter; left time: 119.6182s
	iters: 1000, epoch: 3 | loss: 0.6522185
	speed: 0.0147s/iter; left time: 118.3337s
	iters: 1100, epoch: 3 | loss: 0.5871254
	speed: 0.0148s/iter; left time: 117.2710s
Epoch: 3 cost time: 16.684502124786377
Epoch: 3, Steps: 1128 | Train Loss: 0.6502645 Vali Loss: 0.7099392 Test Loss: 0.3579002
Validation loss decreased (0.715090 --> 0.709939).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6853196
	speed: 0.0209s/iter; left time: 162.9033s
	iters: 200, epoch: 4 | loss: 0.7672240
	speed: 0.0175s/iter; left time: 134.8448s
	iters: 300, epoch: 4 | loss: 0.5225578
	speed: 0.0167s/iter; left time: 126.5190s
	iters: 400, epoch: 4 | loss: 0.5470466
	speed: 0.0164s/iter; left time: 122.9936s
	iters: 500, epoch: 4 | loss: 0.6227989
	speed: 0.0161s/iter; left time: 118.8760s
	iters: 600, epoch: 4 | loss: 0.5320480
	speed: 0.0159s/iter; left time: 116.1782s
	iters: 700, epoch: 4 | loss: 0.6293534
	speed: 0.0159s/iter; left time: 114.4624s
	iters: 800, epoch: 4 | loss: 0.5420117
	speed: 0.0159s/iter; left time: 113.1144s
	iters: 900, epoch: 4 | loss: 0.6090757
	speed: 0.0159s/iter; left time: 110.9805s
	iters: 1000, epoch: 4 | loss: 0.6347360
	speed: 0.0158s/iter; left time: 108.9999s
	iters: 1100, epoch: 4 | loss: 0.5497314
	speed: 0.0157s/iter; left time: 106.7080s
Epoch: 4 cost time: 17.767221450805664
Epoch: 4, Steps: 1128 | Train Loss: 0.6391778 Vali Loss: 0.7118039 Test Loss: 0.3580557
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5327374
	speed: 0.0179s/iter; left time: 119.5598s
	iters: 200, epoch: 5 | loss: 0.6978091
	speed: 0.0152s/iter; left time: 99.6733s
	iters: 300, epoch: 5 | loss: 0.8539187
	speed: 0.0152s/iter; left time: 98.0557s
	iters: 400, epoch: 5 | loss: 0.5067731
	speed: 0.0156s/iter; left time: 99.6232s
	iters: 500, epoch: 5 | loss: 0.6330924
	speed: 0.0151s/iter; left time: 94.5134s
	iters: 600, epoch: 5 | loss: 0.4950125
	speed: 0.0149s/iter; left time: 92.0328s
	iters: 700, epoch: 5 | loss: 0.5195692
	speed: 0.0149s/iter; left time: 90.5242s
	iters: 800, epoch: 5 | loss: 0.4842971
	speed: 0.0145s/iter; left time: 86.4058s
	iters: 900, epoch: 5 | loss: 0.5954826
	speed: 0.0142s/iter; left time: 83.5506s
	iters: 1000, epoch: 5 | loss: 0.7093511
	speed: 0.0143s/iter; left time: 82.5342s
	iters: 1100, epoch: 5 | loss: 0.5089859
	speed: 0.0143s/iter; left time: 81.0005s
Epoch: 5 cost time: 16.22832179069519
Epoch: 5, Steps: 1128 | Train Loss: 0.6316621 Vali Loss: 0.7148644 Test Loss: 0.3594659
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6446173
	speed: 0.0182s/iter; left time: 100.8787s
	iters: 200, epoch: 6 | loss: 0.5383818
	speed: 0.0162s/iter; left time: 88.3928s
	iters: 300, epoch: 6 | loss: 0.6048761
	speed: 0.0162s/iter; left time: 86.7416s
	iters: 400, epoch: 6 | loss: 1.1120695
	speed: 0.0155s/iter; left time: 81.3553s
	iters: 500, epoch: 6 | loss: 0.5641217
	speed: 0.0154s/iter; left time: 79.3306s
	iters: 600, epoch: 6 | loss: 0.8115503
	speed: 0.0153s/iter; left time: 76.9033s
	iters: 700, epoch: 6 | loss: 0.5550959
	speed: 0.0152s/iter; left time: 74.9735s
	iters: 800, epoch: 6 | loss: 0.5233914
	speed: 0.0151s/iter; left time: 73.1739s
	iters: 900, epoch: 6 | loss: 0.5780130
	speed: 0.0149s/iter; left time: 70.8047s
	iters: 1000, epoch: 6 | loss: 0.7116936
	speed: 0.0150s/iter; left time: 69.6003s
	iters: 1100, epoch: 6 | loss: 0.6036101
	speed: 0.0151s/iter; left time: 68.7348s
Epoch: 6 cost time: 17.080874919891357
Epoch: 6, Steps: 1128 | Train Loss: 0.6276240 Vali Loss: 0.7167290 Test Loss: 0.3598788
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5057400
	speed: 0.0176s/iter; left time: 77.8002s
	iters: 200, epoch: 7 | loss: 0.4788168
	speed: 0.0154s/iter; left time: 66.4971s
	iters: 300, epoch: 7 | loss: 0.8854800
	speed: 0.0146s/iter; left time: 61.4959s
	iters: 400, epoch: 7 | loss: 0.6560997
	speed: 0.0142s/iter; left time: 58.3289s
	iters: 500, epoch: 7 | loss: 0.6205194
	speed: 0.0148s/iter; left time: 59.2336s
	iters: 600, epoch: 7 | loss: 0.6452121
	speed: 0.0147s/iter; left time: 57.6519s
	iters: 700, epoch: 7 | loss: 0.5562140
	speed: 0.0153s/iter; left time: 58.5160s
	iters: 800, epoch: 7 | loss: 0.5238300
	speed: 0.0157s/iter; left time: 58.3630s
	iters: 900, epoch: 7 | loss: 0.5386819
	speed: 0.0158s/iter; left time: 57.0910s
	iters: 1000, epoch: 7 | loss: 0.6562442
	speed: 0.0168s/iter; left time: 58.9767s
	iters: 1100, epoch: 7 | loss: 0.5602586
	speed: 0.0165s/iter; left time: 56.1608s
Epoch: 7 cost time: 18.528908014297485
Epoch: 7, Steps: 1128 | Train Loss: 0.6256035 Vali Loss: 0.7190415 Test Loss: 0.3606158
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.6999071
	speed: 0.0193s/iter; left time: 63.2740s
	iters: 200, epoch: 8 | loss: 0.5805874
	speed: 0.0173s/iter; left time: 55.0763s
	iters: 300, epoch: 8 | loss: 0.8314848
	speed: 0.0160s/iter; left time: 49.4324s
	iters: 400, epoch: 8 | loss: 0.4827938
	speed: 0.0161s/iter; left time: 48.0082s
	iters: 500, epoch: 8 | loss: 0.7277405
	speed: 0.0159s/iter; left time: 45.9258s
	iters: 600, epoch: 8 | loss: 0.6287741
	speed: 0.0151s/iter; left time: 42.0475s
	iters: 700, epoch: 8 | loss: 0.5341017
	speed: 0.0147s/iter; left time: 39.3681s
	iters: 800, epoch: 8 | loss: 0.7809666
	speed: 0.0149s/iter; left time: 38.5552s
	iters: 900, epoch: 8 | loss: 0.6413090
	speed: 0.0149s/iter; left time: 37.0683s
	iters: 1000, epoch: 8 | loss: 0.4767575
	speed: 0.0146s/iter; left time: 34.8186s
	iters: 1100, epoch: 8 | loss: 0.7241709
	speed: 0.0146s/iter; left time: 33.3608s
Epoch: 8 cost time: 16.48483943939209
Epoch: 8, Steps: 1128 | Train Loss: 0.6251660 Vali Loss: 0.7208522 Test Loss: 0.3603787
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.35790014266967773, mae:0.3510010242462158
Use GPU: cuda:0
no_skip True
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.7461314
	speed: 0.0187s/iter; left time: 209.1751s
	iters: 200, epoch: 1 | loss: 1.0398359
	speed: 0.0170s/iter; left time: 188.0418s
	iters: 300, epoch: 1 | loss: 0.6324164
	speed: 0.0156s/iter; left time: 171.2434s
	iters: 400, epoch: 1 | loss: 0.6617578
	speed: 0.0155s/iter; left time: 169.0802s
	iters: 500, epoch: 1 | loss: 0.6509199
	speed: 0.0155s/iter; left time: 167.0225s
	iters: 600, epoch: 1 | loss: 0.7593099
	speed: 0.0158s/iter; left time: 169.1300s
	iters: 700, epoch: 1 | loss: 0.5640333
	speed: 0.0158s/iter; left time: 167.3240s
	iters: 800, epoch: 1 | loss: 0.6140527
	speed: 0.0157s/iter; left time: 164.4457s
	iters: 900, epoch: 1 | loss: 0.7496741
	speed: 0.0156s/iter; left time: 162.2487s
	iters: 1000, epoch: 1 | loss: 0.4947876
	speed: 0.0154s/iter; left time: 157.8398s
	iters: 1100, epoch: 1 | loss: 0.7575077
	speed: 0.0151s/iter; left time: 154.2126s
Epoch: 1 cost time: 17.19618034362793
Epoch: 1, Steps: 1128 | Train Loss: 0.7241453 Vali Loss: 0.7456000 Test Loss: 0.3617666
Validation loss decreased (inf --> 0.745600).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6130620
	speed: 0.0156s/iter; left time: 157.1388s
	iters: 200, epoch: 2 | loss: 0.6538234
	speed: 0.0157s/iter; left time: 156.2626s
	iters: 300, epoch: 2 | loss: 0.7286800
	speed: 0.0153s/iter; left time: 150.6862s
	iters: 400, epoch: 2 | loss: 0.8469731
	speed: 0.0148s/iter; left time: 144.1518s
	iters: 500, epoch: 2 | loss: 0.5951150
	speed: 0.0146s/iter; left time: 141.1469s
	iters: 600, epoch: 2 | loss: 0.5750515
	speed: 0.0144s/iter; left time: 137.4318s
	iters: 700, epoch: 2 | loss: 0.6475233
	speed: 0.0150s/iter; left time: 141.5882s
	iters: 800, epoch: 2 | loss: 0.8095575
	speed: 0.0147s/iter; left time: 137.7247s
	iters: 900, epoch: 2 | loss: 0.5167994
	speed: 0.0147s/iter; left time: 136.2210s
	iters: 1000, epoch: 2 | loss: 0.8793634
	speed: 0.0149s/iter; left time: 135.9663s
	iters: 1100, epoch: 2 | loss: 0.7247496
	speed: 0.0151s/iter; left time: 137.0338s
Epoch: 2 cost time: 17.18846607208252
Epoch: 2, Steps: 1128 | Train Loss: 0.6766150 Vali Loss: 0.7201639 Test Loss: 0.3583988
Validation loss decreased (0.745600 --> 0.720164).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6684100
	speed: 0.0207s/iter; left time: 184.5507s
	iters: 200, epoch: 3 | loss: 0.5933037
	speed: 0.0176s/iter; left time: 155.0360s
	iters: 300, epoch: 3 | loss: 0.4854109
	speed: 0.0171s/iter; left time: 148.8184s
	iters: 400, epoch: 3 | loss: 0.6287751
	speed: 0.0164s/iter; left time: 141.3555s
	iters: 500, epoch: 3 | loss: 0.4994575
	speed: 0.0163s/iter; left time: 138.8666s
	iters: 600, epoch: 3 | loss: 0.5597737
	speed: 0.0162s/iter; left time: 136.5637s
	iters: 700, epoch: 3 | loss: 0.5823609
	speed: 0.0162s/iter; left time: 134.9012s
	iters: 800, epoch: 3 | loss: 0.5723132
	speed: 0.0161s/iter; left time: 132.6797s
	iters: 900, epoch: 3 | loss: 0.5358933
	speed: 0.0162s/iter; left time: 131.4491s
	iters: 1000, epoch: 3 | loss: 0.5078635
	speed: 0.0159s/iter; left time: 127.4177s
	iters: 1100, epoch: 3 | loss: 0.5478158
	speed: 0.0156s/iter; left time: 123.5257s
Epoch: 3 cost time: 17.591658353805542
Epoch: 3, Steps: 1128 | Train Loss: 0.6549736 Vali Loss: 0.7196862 Test Loss: 0.3581474
Validation loss decreased (0.720164 --> 0.719686).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.7453704
	speed: 0.0178s/iter; left time: 138.4567s
	iters: 200, epoch: 4 | loss: 0.8827967
	speed: 0.0159s/iter; left time: 122.7552s
	iters: 300, epoch: 4 | loss: 0.6906494
	speed: 0.0150s/iter; left time: 113.7806s
	iters: 400, epoch: 4 | loss: 0.5931660
	speed: 0.0146s/iter; left time: 109.3497s
	iters: 500, epoch: 4 | loss: 0.5587689
	speed: 0.0140s/iter; left time: 103.3619s
	iters: 600, epoch: 4 | loss: 0.5443971
	speed: 0.0135s/iter; left time: 98.7114s
	iters: 700, epoch: 4 | loss: 0.5665715
	speed: 0.0139s/iter; left time: 99.9729s
	iters: 800, epoch: 4 | loss: 0.7581919
	speed: 0.0141s/iter; left time: 99.7630s
	iters: 900, epoch: 4 | loss: 0.5842456
	speed: 0.0144s/iter; left time: 100.8523s
	iters: 1000, epoch: 4 | loss: 0.6521451
	speed: 0.0145s/iter; left time: 100.1376s
	iters: 1100, epoch: 4 | loss: 0.5144455
	speed: 0.0144s/iter; left time: 97.7747s
Epoch: 4 cost time: 16.24316096305847
Epoch: 4, Steps: 1128 | Train Loss: 0.6432333 Vali Loss: 0.7188216 Test Loss: 0.3586232
Validation loss decreased (0.719686 --> 0.718822).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5486034
	speed: 0.0196s/iter; left time: 130.4415s
	iters: 200, epoch: 5 | loss: 0.7715635
	speed: 0.0170s/iter; left time: 111.7874s
	iters: 300, epoch: 5 | loss: 0.6715013
	speed: 0.0162s/iter; left time: 104.5133s
	iters: 400, epoch: 5 | loss: 0.6528770
	speed: 0.0157s/iter; left time: 100.1659s
	iters: 500, epoch: 5 | loss: 0.6282868
	speed: 0.0152s/iter; left time: 95.5607s
	iters: 600, epoch: 5 | loss: 0.6602179
	speed: 0.0151s/iter; left time: 92.9298s
	iters: 700, epoch: 5 | loss: 0.4907141
	speed: 0.0148s/iter; left time: 89.7375s
	iters: 800, epoch: 5 | loss: 0.6266208
	speed: 0.0146s/iter; left time: 87.3518s
	iters: 900, epoch: 5 | loss: 0.6763961
	speed: 0.0145s/iter; left time: 85.3923s
	iters: 1000, epoch: 5 | loss: 0.5000181
	speed: 0.0145s/iter; left time: 83.6617s
	iters: 1100, epoch: 5 | loss: 0.7650535
	speed: 0.0145s/iter; left time: 82.3420s
Epoch: 5 cost time: 16.43996810913086
Epoch: 5, Steps: 1128 | Train Loss: 0.6371280 Vali Loss: 0.7215819 Test Loss: 0.3579173
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6613225
	speed: 0.0151s/iter; left time: 83.4692s
	iters: 200, epoch: 6 | loss: 0.6754258
	speed: 0.0142s/iter; left time: 77.1709s
	iters: 300, epoch: 6 | loss: 0.4858873
	speed: 0.0167s/iter; left time: 88.9838s
	iters: 400, epoch: 6 | loss: 0.6498606
	speed: 0.0158s/iter; left time: 82.8087s
	iters: 500, epoch: 6 | loss: 0.7671672
	speed: 0.0156s/iter; left time: 80.0075s
	iters: 600, epoch: 6 | loss: 0.6357589
	speed: 0.0153s/iter; left time: 77.1760s
	iters: 700, epoch: 6 | loss: 0.5587669
	speed: 0.0152s/iter; left time: 74.8690s
	iters: 800, epoch: 6 | loss: 0.5607430
	speed: 0.0150s/iter; left time: 72.5259s
	iters: 900, epoch: 6 | loss: 0.4979014
	speed: 0.0148s/iter; left time: 70.2588s
	iters: 1000, epoch: 6 | loss: 0.6075227
	speed: 0.0146s/iter; left time: 67.9149s
	iters: 1100, epoch: 6 | loss: 0.5026171
	speed: 0.0145s/iter; left time: 65.6425s
Epoch: 6 cost time: 16.364816904067993
Epoch: 6, Steps: 1128 | Train Loss: 0.6332210 Vali Loss: 0.7230770 Test Loss: 0.3596593
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.6972327
	speed: 0.0201s/iter; left time: 88.6706s
	iters: 200, epoch: 7 | loss: 0.6434610
	speed: 0.0158s/iter; left time: 68.1514s
	iters: 300, epoch: 7 | loss: 0.4459883
	speed: 0.0154s/iter; left time: 64.6752s
	iters: 400, epoch: 7 | loss: 0.7266790
	speed: 0.0147s/iter; left time: 60.4237s
	iters: 500, epoch: 7 | loss: 0.6073392
	speed: 0.0148s/iter; left time: 59.3734s
	iters: 600, epoch: 7 | loss: 0.5799190
	speed: 0.0145s/iter; left time: 56.8941s
	iters: 700, epoch: 7 | loss: 0.9113750
	speed: 0.0145s/iter; left time: 55.2139s
	iters: 800, epoch: 7 | loss: 0.9088696
	speed: 0.0149s/iter; left time: 55.4635s
	iters: 900, epoch: 7 | loss: 0.7430866
	speed: 0.0148s/iter; left time: 53.4396s
	iters: 1000, epoch: 7 | loss: 0.5970523
	speed: 0.0153s/iter; left time: 53.6523s
	iters: 1100, epoch: 7 | loss: 0.5177429
	speed: 0.0153s/iter; left time: 52.2653s
Epoch: 7 cost time: 17.410847663879395
Epoch: 7, Steps: 1128 | Train Loss: 0.6312787 Vali Loss: 0.7234828 Test Loss: 0.3593599
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.5727856
	speed: 0.0184s/iter; left time: 60.4792s
	iters: 200, epoch: 8 | loss: 0.6972989
	speed: 0.0166s/iter; left time: 52.7529s
	iters: 300, epoch: 8 | loss: 0.5792775
	speed: 0.0156s/iter; left time: 48.0221s
	iters: 400, epoch: 8 | loss: 0.7740489
	speed: 0.0150s/iter; left time: 44.7213s
	iters: 500, epoch: 8 | loss: 0.4903848
	speed: 0.0149s/iter; left time: 42.9647s
	iters: 600, epoch: 8 | loss: 0.7569574
	speed: 0.0146s/iter; left time: 40.5826s
	iters: 700, epoch: 8 | loss: 0.7828149
	speed: 0.0145s/iter; left time: 38.9777s
	iters: 800, epoch: 8 | loss: 0.6614438
	speed: 0.0147s/iter; left time: 38.0434s
	iters: 900, epoch: 8 | loss: 0.4921342
	speed: 0.0148s/iter; left time: 36.7656s
	iters: 1000, epoch: 8 | loss: 0.6955937
	speed: 0.0150s/iter; left time: 35.7686s
	iters: 1100, epoch: 8 | loss: 0.5386575
	speed: 0.0151s/iter; left time: 34.4040s
Epoch: 8 cost time: 17.041883945465088
Epoch: 8, Steps: 1128 | Train Loss: 0.6301700 Vali Loss: 0.7237788 Test Loss: 0.3595852
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.6722340
	speed: 0.0163s/iter; left time: 35.2566s
	iters: 200, epoch: 9 | loss: 0.5197077
	speed: 0.0144s/iter; left time: 29.6595s
	iters: 300, epoch: 9 | loss: 0.5577430
	speed: 0.0143s/iter; left time: 27.8873s
	iters: 400, epoch: 9 | loss: 0.6243693
	speed: 0.0140s/iter; left time: 25.9249s
	iters: 500, epoch: 9 | loss: 0.6950727
	speed: 0.0139s/iter; left time: 24.3809s
	iters: 600, epoch: 9 | loss: 0.5529674
	speed: 0.0143s/iter; left time: 23.6988s
	iters: 700, epoch: 9 | loss: 0.5387725
	speed: 0.0141s/iter; left time: 22.0134s
	iters: 800, epoch: 9 | loss: 0.5080512
	speed: 0.0138s/iter; left time: 20.1416s
	iters: 900, epoch: 9 | loss: 0.5214034
	speed: 0.0138s/iter; left time: 18.6963s
	iters: 1000, epoch: 9 | loss: 0.6940430
	speed: 0.0139s/iter; left time: 17.5325s
	iters: 1100, epoch: 9 | loss: 0.4712469
	speed: 0.0141s/iter; left time: 16.2606s
Epoch: 9 cost time: 15.936710119247437
Epoch: 9, Steps: 1128 | Train Loss: 0.6297653 Vali Loss: 0.7241728 Test Loss: 0.3595472
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.3586232364177704, mae:0.3529137074947357
Seed: 123
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_96       Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip True
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.7432099
	speed: 0.0291s/iter; left time: 330.3341s
	iters: 200, epoch: 1 | loss: 0.3683637
	speed: 0.0206s/iter; left time: 232.5514s
	iters: 300, epoch: 1 | loss: 1.4282191
	speed: 0.0187s/iter; left time: 209.1026s
	iters: 400, epoch: 1 | loss: 0.4116784
	speed: 0.0173s/iter; left time: 191.3732s
	iters: 500, epoch: 1 | loss: 0.4593402
	speed: 0.0172s/iter; left time: 189.1981s
	iters: 600, epoch: 1 | loss: 0.6107603
	speed: 0.0167s/iter; left time: 181.0887s
	iters: 700, epoch: 1 | loss: 0.5114053
	speed: 0.0166s/iter; left time: 178.3697s
	iters: 800, epoch: 1 | loss: 0.3324407
	speed: 0.0160s/iter; left time: 170.3029s
	iters: 900, epoch: 1 | loss: 0.4415317
	speed: 0.0157s/iter; left time: 165.6564s
	iters: 1000, epoch: 1 | loss: 0.4912966
	speed: 0.0155s/iter; left time: 162.3541s
	iters: 1100, epoch: 1 | loss: 0.3457433
	speed: 0.0154s/iter; left time: 159.6419s
Epoch: 1 cost time: 17.674686431884766
Epoch: 1, Steps: 1147 | Train Loss: 0.5316695 Vali Loss: 0.4643248 Test Loss: 0.1911802
Validation loss decreased (inf --> 0.464325).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2919739
	speed: 0.0175s/iter; left time: 179.3305s
	iters: 200, epoch: 2 | loss: 0.3524864
	speed: 0.0154s/iter; left time: 156.2965s
	iters: 300, epoch: 2 | loss: 0.4291010
	speed: 0.0153s/iter; left time: 152.9094s
	iters: 400, epoch: 2 | loss: 0.4257179
	speed: 0.0148s/iter; left time: 146.6553s
	iters: 500, epoch: 2 | loss: 0.4684890
	speed: 0.0145s/iter; left time: 142.8004s
	iters: 600, epoch: 2 | loss: 0.3408072
	speed: 0.0144s/iter; left time: 139.9168s
	iters: 700, epoch: 2 | loss: 0.4250419
	speed: 0.0141s/iter; left time: 135.2739s
	iters: 800, epoch: 2 | loss: 0.3081949
	speed: 0.0138s/iter; left time: 131.2184s
	iters: 900, epoch: 2 | loss: 0.5591533
	speed: 0.0138s/iter; left time: 129.9633s
	iters: 1000, epoch: 2 | loss: 0.3745601
	speed: 0.0138s/iter; left time: 128.7237s
	iters: 1100, epoch: 2 | loss: 0.4477460
	speed: 0.0137s/iter; left time: 126.4872s
Epoch: 2 cost time: 15.68795371055603
Epoch: 2, Steps: 1147 | Train Loss: 0.4613053 Vali Loss: 0.4411895 Test Loss: 0.1823698
Validation loss decreased (0.464325 --> 0.441189).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3515732
	speed: 0.0193s/iter; left time: 174.9523s
	iters: 200, epoch: 3 | loss: 0.3134729
	speed: 0.0162s/iter; left time: 145.3596s
	iters: 300, epoch: 3 | loss: 0.3793719
	speed: 0.0151s/iter; left time: 134.2279s
	iters: 400, epoch: 3 | loss: 0.4415182
	speed: 0.0146s/iter; left time: 128.1008s
	iters: 500, epoch: 3 | loss: 0.3825710
	speed: 0.0143s/iter; left time: 124.4900s
	iters: 600, epoch: 3 | loss: 0.2976780
	speed: 0.0138s/iter; left time: 118.7131s
	iters: 700, epoch: 3 | loss: 0.2982414
	speed: 0.0133s/iter; left time: 112.8724s
	iters: 800, epoch: 3 | loss: 0.2536838
	speed: 0.0133s/iter; left time: 111.0214s
	iters: 900, epoch: 3 | loss: 0.2931961
	speed: 0.0133s/iter; left time: 109.8903s
	iters: 1000, epoch: 3 | loss: 0.5541905
	speed: 0.0130s/iter; left time: 106.3185s
	iters: 1100, epoch: 3 | loss: 0.4655268
	speed: 0.0128s/iter; left time: 103.4536s
Epoch: 3 cost time: 14.807478189468384
Epoch: 3, Steps: 1147 | Train Loss: 0.4366629 Vali Loss: 0.4370930 Test Loss: 0.1811443
Validation loss decreased (0.441189 --> 0.437093).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3456097
	speed: 0.0171s/iter; left time: 135.8218s
	iters: 200, epoch: 4 | loss: 0.2888563
	speed: 0.0150s/iter; left time: 117.1540s
	iters: 300, epoch: 4 | loss: 0.2587842
	speed: 0.0142s/iter; left time: 110.0658s
	iters: 400, epoch: 4 | loss: 0.4293590
	speed: 0.0146s/iter; left time: 111.3616s
	iters: 500, epoch: 4 | loss: 1.3471602
	speed: 0.0149s/iter; left time: 111.8868s
	iters: 600, epoch: 4 | loss: 0.3477370
	speed: 0.0148s/iter; left time: 109.6986s
	iters: 700, epoch: 4 | loss: 0.2678117
	speed: 0.0146s/iter; left time: 107.0154s
	iters: 800, epoch: 4 | loss: 0.2909130
	speed: 0.0152s/iter; left time: 110.0335s
	iters: 900, epoch: 4 | loss: 0.3580233
	speed: 0.0149s/iter; left time: 105.9943s
	iters: 1000, epoch: 4 | loss: 0.2650431
	speed: 0.0144s/iter; left time: 101.1377s
	iters: 1100, epoch: 4 | loss: 0.2924485
	speed: 0.0142s/iter; left time: 98.6296s
Epoch: 4 cost time: 16.453661680221558
Epoch: 4, Steps: 1147 | Train Loss: 0.4254139 Vali Loss: 0.4250654 Test Loss: 0.1782421
Validation loss decreased (0.437093 --> 0.425065).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3683316
	speed: 0.0217s/iter; left time: 147.3165s
	iters: 200, epoch: 5 | loss: 0.3322000
	speed: 0.0162s/iter; left time: 108.2121s
	iters: 300, epoch: 5 | loss: 0.4008850
	speed: 0.0149s/iter; left time: 98.0941s
	iters: 400, epoch: 5 | loss: 0.2675160
	speed: 0.0148s/iter; left time: 95.6454s
	iters: 500, epoch: 5 | loss: 0.3351814
	speed: 0.0146s/iter; left time: 93.4516s
	iters: 600, epoch: 5 | loss: 0.3546140
	speed: 0.0143s/iter; left time: 89.7932s
	iters: 700, epoch: 5 | loss: 0.3792635
	speed: 0.0141s/iter; left time: 87.3337s
	iters: 800, epoch: 5 | loss: 0.2726210
	speed: 0.0137s/iter; left time: 83.0570s
	iters: 900, epoch: 5 | loss: 0.3485314
	speed: 0.0136s/iter; left time: 81.3057s
	iters: 1000, epoch: 5 | loss: 0.2591358
	speed: 0.0137s/iter; left time: 80.3958s
	iters: 1100, epoch: 5 | loss: 0.2605992
	speed: 0.0132s/iter; left time: 76.4325s
Epoch: 5 cost time: 15.07586669921875
Epoch: 5, Steps: 1147 | Train Loss: 0.4185895 Vali Loss: 0.4314936 Test Loss: 0.1803532
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2923141
	speed: 0.0222s/iter; left time: 124.9873s
	iters: 200, epoch: 6 | loss: 0.3343075
	speed: 0.0193s/iter; left time: 107.0898s
	iters: 300, epoch: 6 | loss: 0.2771180
	speed: 0.0172s/iter; left time: 93.4489s
	iters: 400, epoch: 6 | loss: 0.3934695
	speed: 0.0157s/iter; left time: 83.9588s
	iters: 500, epoch: 6 | loss: 0.2451100
	speed: 0.0153s/iter; left time: 80.0322s
	iters: 600, epoch: 6 | loss: 0.4309427
	speed: 0.0149s/iter; left time: 76.7342s
	iters: 700, epoch: 6 | loss: 0.2368094
	speed: 0.0147s/iter; left time: 73.8813s
	iters: 800, epoch: 6 | loss: 0.3988312
	speed: 0.0144s/iter; left time: 71.1700s
	iters: 900, epoch: 6 | loss: 0.5163987
	speed: 0.0143s/iter; left time: 69.2209s
	iters: 1000, epoch: 6 | loss: 0.3126843
	speed: 0.0141s/iter; left time: 66.7147s
	iters: 1100, epoch: 6 | loss: 0.4181219
	speed: 0.0139s/iter; left time: 64.4540s
Epoch: 6 cost time: 16.12174367904663
Epoch: 6, Steps: 1147 | Train Loss: 0.4146926 Vali Loss: 0.4307220 Test Loss: 0.1783873
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3966624
	speed: 0.0187s/iter; left time: 83.9253s
	iters: 200, epoch: 7 | loss: 0.3118292
	speed: 0.0164s/iter; left time: 72.0421s
	iters: 300, epoch: 7 | loss: 0.2657704
	speed: 0.0146s/iter; left time: 62.6814s
	iters: 400, epoch: 7 | loss: 0.4419491
	speed: 0.0136s/iter; left time: 56.9658s
	iters: 500, epoch: 7 | loss: 0.3685348
	speed: 0.0138s/iter; left time: 56.2875s
	iters: 600, epoch: 7 | loss: 0.3917973
	speed: 0.0139s/iter; left time: 55.5117s
	iters: 700, epoch: 7 | loss: 0.4275962
	speed: 0.0137s/iter; left time: 53.3463s
	iters: 800, epoch: 7 | loss: 0.5340199
	speed: 0.0135s/iter; left time: 51.0016s
	iters: 900, epoch: 7 | loss: 0.3212775
	speed: 0.0137s/iter; left time: 50.5569s
	iters: 1000, epoch: 7 | loss: 0.3249315
	speed: 0.0137s/iter; left time: 49.2426s
	iters: 1100, epoch: 7 | loss: 0.3448099
	speed: 0.0138s/iter; left time: 47.9738s
Epoch: 7 cost time: 15.734037160873413
Epoch: 7, Steps: 1147 | Train Loss: 0.4127563 Vali Loss: 0.4289523 Test Loss: 0.1791162
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 1.1503934
	speed: 0.0175s/iter; left time: 58.3837s
	iters: 200, epoch: 8 | loss: 0.2667060
	speed: 0.0160s/iter; left time: 51.8673s
	iters: 300, epoch: 8 | loss: 0.3985392
	speed: 0.0149s/iter; left time: 46.8661s
	iters: 400, epoch: 8 | loss: 0.3956439
	speed: 0.0141s/iter; left time: 42.7492s
	iters: 500, epoch: 8 | loss: 0.4418117
	speed: 0.0140s/iter; left time: 41.2195s
	iters: 600, epoch: 8 | loss: 0.2327885
	speed: 0.0143s/iter; left time: 40.6086s
	iters: 700, epoch: 8 | loss: 1.4622550
	speed: 0.0140s/iter; left time: 38.4239s
	iters: 800, epoch: 8 | loss: 0.5902638
	speed: 0.0140s/iter; left time: 36.9410s
	iters: 900, epoch: 8 | loss: 0.2851967
	speed: 0.0139s/iter; left time: 35.3634s
	iters: 1000, epoch: 8 | loss: 0.4805664
	speed: 0.0139s/iter; left time: 33.8224s
	iters: 1100, epoch: 8 | loss: 0.2868449
	speed: 0.0138s/iter; left time: 32.3773s
Epoch: 8 cost time: 15.930872201919556
Epoch: 8, Steps: 1147 | Train Loss: 0.4116837 Vali Loss: 0.4293179 Test Loss: 0.1788775
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4049660
	speed: 0.0199s/iter; left time: 43.7620s
	iters: 200, epoch: 9 | loss: 0.3022870
	speed: 0.0176s/iter; left time: 36.8199s
	iters: 300, epoch: 9 | loss: 0.2732816
	speed: 0.0152s/iter; left time: 30.3390s
	iters: 400, epoch: 9 | loss: 0.3017124
	speed: 0.0146s/iter; left time: 27.7425s
	iters: 500, epoch: 9 | loss: 0.2884776
	speed: 0.0157s/iter; left time: 28.1383s
	iters: 600, epoch: 9 | loss: 1.3293320
	speed: 0.0152s/iter; left time: 25.6888s
	iters: 700, epoch: 9 | loss: 0.3460553
	speed: 0.0147s/iter; left time: 23.4556s
	iters: 800, epoch: 9 | loss: 1.2186899
	speed: 0.0148s/iter; left time: 22.0531s
	iters: 900, epoch: 9 | loss: 0.3286156
	speed: 0.0148s/iter; left time: 20.6503s
	iters: 1000, epoch: 9 | loss: 0.1883598
	speed: 0.0145s/iter; left time: 18.7464s
	iters: 1100, epoch: 9 | loss: 0.4917729
	speed: 0.0142s/iter; left time: 17.0062s
Epoch: 9 cost time: 16.573771238327026
Epoch: 9, Steps: 1147 | Train Loss: 0.4111233 Vali Loss: 0.4287809 Test Loss: 0.1785017
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.17824216187000275, mae:0.22282685339450836
Use GPU: cuda:0
no_skip True
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.4534825
	speed: 0.0258s/iter; left time: 293.6916s
	iters: 200, epoch: 1 | loss: 0.6257299
	speed: 0.0194s/iter; left time: 218.4100s
	iters: 300, epoch: 1 | loss: 0.3723392
	speed: 0.0168s/iter; left time: 187.7332s
	iters: 400, epoch: 1 | loss: 0.4620618
	speed: 0.0166s/iter; left time: 183.2719s
	iters: 500, epoch: 1 | loss: 0.3281014
	speed: 0.0162s/iter; left time: 178.1505s
	iters: 600, epoch: 1 | loss: 1.3438326
	speed: 0.0155s/iter; left time: 168.7581s
	iters: 700, epoch: 1 | loss: 0.3591459
	speed: 0.0152s/iter; left time: 163.2938s
	iters: 800, epoch: 1 | loss: 0.2896850
	speed: 0.0150s/iter; left time: 159.8431s
	iters: 900, epoch: 1 | loss: 0.6115139
	speed: 0.0150s/iter; left time: 158.6305s
	iters: 1000, epoch: 1 | loss: 0.5125284
	speed: 0.0147s/iter; left time: 153.6759s
	iters: 1100, epoch: 1 | loss: 0.3391490
	speed: 0.0144s/iter; left time: 149.1277s
Epoch: 1 cost time: 16.400813817977905
Epoch: 1, Steps: 1147 | Train Loss: 0.5280943 Vali Loss: 0.4794111 Test Loss: 0.1878750
Validation loss decreased (inf --> 0.479411).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5349529
	speed: 0.0189s/iter; left time: 192.9016s
	iters: 200, epoch: 2 | loss: 0.3711140
	speed: 0.0153s/iter; left time: 155.1076s
	iters: 300, epoch: 2 | loss: 0.2458432
	speed: 0.0154s/iter; left time: 154.8570s
	iters: 400, epoch: 2 | loss: 0.2891730
	speed: 0.0151s/iter; left time: 149.4524s
	iters: 500, epoch: 2 | loss: 0.4148680
	speed: 0.0155s/iter; left time: 151.8528s
	iters: 600, epoch: 2 | loss: 0.2786228
	speed: 0.0150s/iter; left time: 146.0121s
	iters: 700, epoch: 2 | loss: 0.2614285
	speed: 0.0158s/iter; left time: 151.7262s
	iters: 800, epoch: 2 | loss: 0.4040856
	speed: 0.0158s/iter; left time: 150.2676s
	iters: 900, epoch: 2 | loss: 0.2553498
	speed: 0.0155s/iter; left time: 146.4102s
	iters: 1000, epoch: 2 | loss: 0.6425744
	speed: 0.0154s/iter; left time: 143.9342s
	iters: 1100, epoch: 2 | loss: 0.6243804
	speed: 0.0156s/iter; left time: 144.2103s
Epoch: 2 cost time: 17.89453649520874
Epoch: 2, Steps: 1147 | Train Loss: 0.4639084 Vali Loss: 0.4607609 Test Loss: 0.1853657
Validation loss decreased (0.479411 --> 0.460761).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3307249
	speed: 0.0206s/iter; left time: 186.6115s
	iters: 200, epoch: 3 | loss: 0.2625001
	speed: 0.0167s/iter; left time: 149.5230s
	iters: 300, epoch: 3 | loss: 0.2869600
	speed: 0.0153s/iter; left time: 135.4459s
	iters: 400, epoch: 3 | loss: 0.3084656
	speed: 0.0146s/iter; left time: 128.1694s
	iters: 500, epoch: 3 | loss: 1.2514944
	speed: 0.0145s/iter; left time: 126.1379s
	iters: 600, epoch: 3 | loss: 0.2916456
	speed: 0.0143s/iter; left time: 122.5873s
	iters: 700, epoch: 3 | loss: 0.3853669
	speed: 0.0142s/iter; left time: 120.1504s
	iters: 800, epoch: 3 | loss: 0.3075427
	speed: 0.0144s/iter; left time: 120.4885s
	iters: 900, epoch: 3 | loss: 0.4500230
	speed: 0.0143s/iter; left time: 118.6353s
	iters: 1000, epoch: 3 | loss: 0.3801343
	speed: 0.0140s/iter; left time: 114.6765s
	iters: 1100, epoch: 3 | loss: 0.2508503
	speed: 0.0145s/iter; left time: 116.8446s
Epoch: 3 cost time: 17.095163822174072
Epoch: 3, Steps: 1147 | Train Loss: 0.4417768 Vali Loss: 0.4394211 Test Loss: 0.1778761
Validation loss decreased (0.460761 --> 0.439421).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3159749
	speed: 0.0184s/iter; left time: 145.6014s
	iters: 200, epoch: 4 | loss: 0.4563060
	speed: 0.0170s/iter; left time: 133.3203s
	iters: 300, epoch: 4 | loss: 0.4187504
	speed: 0.0155s/iter; left time: 119.5521s
	iters: 400, epoch: 4 | loss: 0.4222658
	speed: 0.0145s/iter; left time: 110.4119s
	iters: 500, epoch: 4 | loss: 1.5444821
	speed: 0.0151s/iter; left time: 113.4253s
	iters: 600, epoch: 4 | loss: 0.3135215
	speed: 0.0160s/iter; left time: 119.1710s
	iters: 700, epoch: 4 | loss: 1.2413602
	speed: 0.0152s/iter; left time: 111.6144s
	iters: 800, epoch: 4 | loss: 0.2957420
	speed: 0.0150s/iter; left time: 108.1449s
	iters: 900, epoch: 4 | loss: 0.2720319
	speed: 0.0150s/iter; left time: 106.8809s
	iters: 1000, epoch: 4 | loss: 0.3143990
	speed: 0.0148s/iter; left time: 103.9729s
	iters: 1100, epoch: 4 | loss: 0.3496407
	speed: 0.0146s/iter; left time: 100.9123s
Epoch: 4 cost time: 16.623503923416138
Epoch: 4, Steps: 1147 | Train Loss: 0.4277709 Vali Loss: 0.4365586 Test Loss: 0.1780814
Validation loss decreased (0.439421 --> 0.436559).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3162366
	speed: 0.0175s/iter; left time: 118.8646s
	iters: 200, epoch: 5 | loss: 0.2944418
	speed: 0.0154s/iter; left time: 103.2020s
	iters: 300, epoch: 5 | loss: 0.2871280
	speed: 0.0140s/iter; left time: 92.3220s
	iters: 400, epoch: 5 | loss: 0.3998214
	speed: 0.0139s/iter; left time: 89.8054s
	iters: 500, epoch: 5 | loss: 0.3002895
	speed: 0.0132s/iter; left time: 84.1844s
	iters: 600, epoch: 5 | loss: 0.2999118
	speed: 0.0133s/iter; left time: 83.6677s
	iters: 700, epoch: 5 | loss: 0.2443640
	speed: 0.0143s/iter; left time: 88.2483s
	iters: 800, epoch: 5 | loss: 0.3450750
	speed: 0.0138s/iter; left time: 84.1101s
	iters: 900, epoch: 5 | loss: 0.3512192
	speed: 0.0137s/iter; left time: 81.8001s
	iters: 1000, epoch: 5 | loss: 0.4303879
	speed: 0.0144s/iter; left time: 84.8179s
	iters: 1100, epoch: 5 | loss: 0.3532992
	speed: 0.0142s/iter; left time: 82.4071s
Epoch: 5 cost time: 16.392398595809937
Epoch: 5, Steps: 1147 | Train Loss: 0.4215979 Vali Loss: 0.4409691 Test Loss: 0.1786408
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4510073
	speed: 0.0167s/iter; left time: 94.2709s
	iters: 200, epoch: 6 | loss: 0.2680302
	speed: 0.0162s/iter; left time: 89.4925s
	iters: 300, epoch: 6 | loss: 0.2608323
	speed: 0.0150s/iter; left time: 81.4281s
	iters: 400, epoch: 6 | loss: 0.4870775
	speed: 0.0141s/iter; left time: 75.3134s
	iters: 500, epoch: 6 | loss: 0.4617116
	speed: 0.0140s/iter; left time: 73.4166s
	iters: 600, epoch: 6 | loss: 0.2896609
	speed: 0.0140s/iter; left time: 71.7929s
	iters: 700, epoch: 6 | loss: 0.2543381
	speed: 0.0140s/iter; left time: 70.7229s
	iters: 800, epoch: 6 | loss: 0.6682618
	speed: 0.0139s/iter; left time: 68.8464s
	iters: 900, epoch: 6 | loss: 0.3358362
	speed: 0.0138s/iter; left time: 66.9616s
	iters: 1000, epoch: 6 | loss: 0.2751614
	speed: 0.0137s/iter; left time: 65.0043s
	iters: 1100, epoch: 6 | loss: 1.2331914
	speed: 0.0137s/iter; left time: 63.7394s
Epoch: 6 cost time: 15.852102518081665
Epoch: 6, Steps: 1147 | Train Loss: 0.4175264 Vali Loss: 0.4410815 Test Loss: 0.1794060
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3138433
	speed: 0.0188s/iter; left time: 84.1709s
	iters: 200, epoch: 7 | loss: 0.2838325
	speed: 0.0167s/iter; left time: 73.3383s
	iters: 300, epoch: 7 | loss: 0.2869681
	speed: 0.0153s/iter; left time: 65.7438s
	iters: 400, epoch: 7 | loss: 0.3171876
	speed: 0.0145s/iter; left time: 60.5444s
	iters: 500, epoch: 7 | loss: 0.2623374
	speed: 0.0148s/iter; left time: 60.4050s
	iters: 600, epoch: 7 | loss: 0.3632534
	speed: 0.0147s/iter; left time: 58.6567s
	iters: 700, epoch: 7 | loss: 0.2742049
	speed: 0.0144s/iter; left time: 55.9052s
	iters: 800, epoch: 7 | loss: 0.9391617
	speed: 0.0144s/iter; left time: 54.3907s
	iters: 900, epoch: 7 | loss: 0.3193785
	speed: 0.0146s/iter; left time: 53.7522s
	iters: 1000, epoch: 7 | loss: 0.3806020
	speed: 0.0147s/iter; left time: 52.6462s
	iters: 1100, epoch: 7 | loss: 0.4701866
	speed: 0.0145s/iter; left time: 50.6555s
Epoch: 7 cost time: 16.6998074054718
Epoch: 7, Steps: 1147 | Train Loss: 0.4156152 Vali Loss: 0.4367422 Test Loss: 0.1783234
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2479117
	speed: 0.0148s/iter; left time: 49.4507s
	iters: 200, epoch: 8 | loss: 1.2344493
	speed: 0.0128s/iter; left time: 41.5463s
	iters: 300, epoch: 8 | loss: 1.2411406
	speed: 0.0128s/iter; left time: 40.0809s
	iters: 400, epoch: 8 | loss: 1.2169609
	speed: 0.0126s/iter; left time: 38.3023s
	iters: 500, epoch: 8 | loss: 0.2639045
	speed: 0.0124s/iter; left time: 36.3710s
	iters: 600, epoch: 8 | loss: 0.4489608
	speed: 0.0124s/iter; left time: 35.1259s
	iters: 700, epoch: 8 | loss: 0.2853574
	speed: 0.0127s/iter; left time: 34.7932s
	iters: 800, epoch: 8 | loss: 0.5553176
	speed: 0.0125s/iter; left time: 33.1262s
	iters: 900, epoch: 8 | loss: 0.3005072
	speed: 0.0126s/iter; left time: 32.0467s
	iters: 1000, epoch: 8 | loss: 0.4540842
	speed: 0.0129s/iter; left time: 31.3949s
	iters: 1100, epoch: 8 | loss: 0.4238843
	speed: 0.0131s/iter; left time: 30.6649s
Epoch: 8 cost time: 15.118124008178711
Epoch: 8, Steps: 1147 | Train Loss: 0.4146925 Vali Loss: 0.4368215 Test Loss: 0.1777233
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3024328
	speed: 0.0218s/iter; left time: 47.9438s
	iters: 200, epoch: 9 | loss: 0.4535674
	speed: 0.0190s/iter; left time: 39.8606s
	iters: 300, epoch: 9 | loss: 1.2840228
	speed: 0.0161s/iter; left time: 32.1610s
	iters: 400, epoch: 9 | loss: 0.3198170
	speed: 0.0160s/iter; left time: 30.4033s
	iters: 500, epoch: 9 | loss: 0.3628196
	speed: 0.0159s/iter; left time: 28.5706s
	iters: 600, epoch: 9 | loss: 0.4535385
	speed: 0.0150s/iter; left time: 25.4438s
	iters: 700, epoch: 9 | loss: 0.3242751
	speed: 0.0147s/iter; left time: 23.4426s
	iters: 800, epoch: 9 | loss: 0.2175441
	speed: 0.0143s/iter; left time: 21.4020s
	iters: 900, epoch: 9 | loss: 0.3015168
	speed: 0.0146s/iter; left time: 20.3880s
	iters: 1000, epoch: 9 | loss: 0.3183670
	speed: 0.0146s/iter; left time: 18.8694s
	iters: 1100, epoch: 9 | loss: 0.3315338
	speed: 0.0145s/iter; left time: 17.3524s
Epoch: 9 cost time: 16.56744360923767
Epoch: 9, Steps: 1147 | Train Loss: 0.4141063 Vali Loss: 0.4367195 Test Loss: 0.1778051
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.1780814230442047, mae:0.22326336801052094
Use GPU: cuda:0
no_skip True
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.4151097
	speed: 0.0168s/iter; left time: 191.1455s
	iters: 200, epoch: 1 | loss: 0.4863286
	speed: 0.0136s/iter; left time: 153.2236s
	iters: 300, epoch: 1 | loss: 0.5673209
	speed: 0.0140s/iter; left time: 155.8770s
	iters: 400, epoch: 1 | loss: 0.3794514
	speed: 0.0145s/iter; left time: 161.0362s
	iters: 500, epoch: 1 | loss: 0.7025819
	speed: 0.0145s/iter; left time: 159.3492s
	iters: 600, epoch: 1 | loss: 0.3159103
	speed: 0.0141s/iter; left time: 153.4062s
	iters: 700, epoch: 1 | loss: 0.5882688
	speed: 0.0143s/iter; left time: 154.3003s
	iters: 800, epoch: 1 | loss: 0.3275191
	speed: 0.0144s/iter; left time: 154.0609s
	iters: 900, epoch: 1 | loss: 0.5859767
	speed: 0.0141s/iter; left time: 149.2058s
	iters: 1000, epoch: 1 | loss: 0.6104320
	speed: 0.0138s/iter; left time: 144.3049s
	iters: 1100, epoch: 1 | loss: 0.5445121
	speed: 0.0138s/iter; left time: 142.8730s
Epoch: 1 cost time: 15.910788774490356
Epoch: 1, Steps: 1147 | Train Loss: 0.5326927 Vali Loss: 0.4749605 Test Loss: 0.1921230
Validation loss decreased (inf --> 0.474960).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3428453
	speed: 0.0173s/iter; left time: 176.7059s
	iters: 200, epoch: 2 | loss: 0.3007389
	speed: 0.0149s/iter; left time: 150.8463s
	iters: 300, epoch: 2 | loss: 0.2809166
	speed: 0.0140s/iter; left time: 140.2544s
	iters: 400, epoch: 2 | loss: 0.3477428
	speed: 0.0136s/iter; left time: 135.2546s
	iters: 500, epoch: 2 | loss: 0.4404025
	speed: 0.0136s/iter; left time: 133.4173s
	iters: 600, epoch: 2 | loss: 0.3510768
	speed: 0.0135s/iter; left time: 131.5248s
	iters: 700, epoch: 2 | loss: 0.6644362
	speed: 0.0135s/iter; left time: 129.5904s
	iters: 800, epoch: 2 | loss: 0.6251249
	speed: 0.0141s/iter; left time: 134.7506s
	iters: 900, epoch: 2 | loss: 0.2576540
	speed: 0.0140s/iter; left time: 132.0205s
	iters: 1000, epoch: 2 | loss: 0.2801358
	speed: 0.0140s/iter; left time: 130.4710s
	iters: 1100, epoch: 2 | loss: 0.2906674
	speed: 0.0139s/iter; left time: 127.8566s
Epoch: 2 cost time: 16.02460551261902
Epoch: 2, Steps: 1147 | Train Loss: 0.4628689 Vali Loss: 0.4935931 Test Loss: 0.1918137
EarlyStopping counter: 1 out of 5
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4681051
	speed: 0.0201s/iter; left time: 182.8855s
	iters: 200, epoch: 3 | loss: 0.3941751
	speed: 0.0168s/iter; left time: 150.8062s
	iters: 300, epoch: 3 | loss: 0.4044981
	speed: 0.0153s/iter; left time: 136.1064s
	iters: 400, epoch: 3 | loss: 0.3813279
	speed: 0.0142s/iter; left time: 124.4030s
	iters: 500, epoch: 3 | loss: 0.2107108
	speed: 0.0140s/iter; left time: 121.5077s
	iters: 600, epoch: 3 | loss: 0.3281916
	speed: 0.0143s/iter; left time: 122.3368s
	iters: 700, epoch: 3 | loss: 0.2318131
	speed: 0.0140s/iter; left time: 118.8068s
	iters: 800, epoch: 3 | loss: 1.2213556
	speed: 0.0138s/iter; left time: 116.0023s
	iters: 900, epoch: 3 | loss: 0.4855433
	speed: 0.0141s/iter; left time: 117.0740s
	iters: 1000, epoch: 3 | loss: 0.3391056
	speed: 0.0145s/iter; left time: 118.2069s
	iters: 1100, epoch: 3 | loss: 0.3105868
	speed: 0.0141s/iter; left time: 114.0793s
Epoch: 3 cost time: 16.229263305664062
Epoch: 3, Steps: 1147 | Train Loss: 0.4409789 Vali Loss: 0.4390191 Test Loss: 0.1804104
Validation loss decreased (0.474960 --> 0.439019).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3580137
	speed: 0.0185s/iter; left time: 146.5455s
	iters: 200, epoch: 4 | loss: 0.3049877
	speed: 0.0156s/iter; left time: 121.9220s
	iters: 300, epoch: 4 | loss: 0.3899416
	speed: 0.0151s/iter; left time: 116.7920s
	iters: 400, epoch: 4 | loss: 0.3815375
	speed: 0.0148s/iter; left time: 113.2875s
	iters: 500, epoch: 4 | loss: 0.3354318
	speed: 0.0147s/iter; left time: 110.3212s
	iters: 600, epoch: 4 | loss: 0.2452765
	speed: 0.0144s/iter; left time: 106.8286s
	iters: 700, epoch: 4 | loss: 0.4085436
	speed: 0.0144s/iter; left time: 105.8857s
	iters: 800, epoch: 4 | loss: 0.2858738
	speed: 0.0145s/iter; left time: 104.8173s
	iters: 900, epoch: 4 | loss: 0.3172556
	speed: 0.0145s/iter; left time: 103.6744s
	iters: 1000, epoch: 4 | loss: 0.3461830
	speed: 0.0141s/iter; left time: 99.2123s
	iters: 1100, epoch: 4 | loss: 0.3592371
	speed: 0.0137s/iter; left time: 95.0993s
Epoch: 4 cost time: 15.911947011947632
Epoch: 4, Steps: 1147 | Train Loss: 0.4259179 Vali Loss: 0.4343409 Test Loss: 0.1783865
Validation loss decreased (0.439019 --> 0.434341).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2674924
	speed: 0.0149s/iter; left time: 100.8614s
	iters: 200, epoch: 5 | loss: 0.3584855
	speed: 0.0120s/iter; left time: 80.2637s
	iters: 300, epoch: 5 | loss: 1.2201215
	speed: 0.0127s/iter; left time: 83.4704s
	iters: 400, epoch: 5 | loss: 0.2717340
	speed: 0.0125s/iter; left time: 81.2501s
	iters: 500, epoch: 5 | loss: 0.2170494
	speed: 0.0129s/iter; left time: 82.3230s
	iters: 600, epoch: 5 | loss: 0.2703237
	speed: 0.0128s/iter; left time: 80.3634s
	iters: 700, epoch: 5 | loss: 0.3288906
	speed: 0.0136s/iter; left time: 84.2704s
	iters: 800, epoch: 5 | loss: 0.2720272
	speed: 0.0137s/iter; left time: 83.5117s
	iters: 900, epoch: 5 | loss: 0.2810355
	speed: 0.0136s/iter; left time: 81.1415s
	iters: 1000, epoch: 5 | loss: 0.2669834
	speed: 0.0136s/iter; left time: 80.1112s
	iters: 1100, epoch: 5 | loss: 0.2960335
	speed: 0.0137s/iter; left time: 78.9535s
Epoch: 5 cost time: 15.682740926742554
Epoch: 5, Steps: 1147 | Train Loss: 0.4194237 Vali Loss: 0.4309465 Test Loss: 0.1778338
Validation loss decreased (0.434341 --> 0.430946).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2593814
	speed: 0.0262s/iter; left time: 147.8159s
	iters: 200, epoch: 6 | loss: 0.2658947
	speed: 0.0229s/iter; left time: 127.0187s
	iters: 300, epoch: 6 | loss: 0.4555253
	speed: 0.0205s/iter; left time: 111.6533s
	iters: 400, epoch: 6 | loss: 0.3565022
	speed: 0.0194s/iter; left time: 103.4162s
	iters: 500, epoch: 6 | loss: 0.3239038
	speed: 0.0184s/iter; left time: 96.3897s
	iters: 600, epoch: 6 | loss: 0.3451419
	speed: 0.0174s/iter; left time: 89.3381s
	iters: 700, epoch: 6 | loss: 0.6005260
	speed: 0.0166s/iter; left time: 83.5960s
	iters: 800, epoch: 6 | loss: 0.3660742
	speed: 0.0167s/iter; left time: 82.4895s
	iters: 900, epoch: 6 | loss: 0.4192858
	speed: 0.0164s/iter; left time: 79.2272s
	iters: 1000, epoch: 6 | loss: 0.3752217
	speed: 0.0160s/iter; left time: 75.6183s
	iters: 1100, epoch: 6 | loss: 0.3700479
	speed: 0.0157s/iter; left time: 72.5673s
Epoch: 6 cost time: 18.265029191970825
Epoch: 6, Steps: 1147 | Train Loss: 0.4156887 Vali Loss: 0.4343906 Test Loss: 0.1781263
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2140512
	speed: 0.0163s/iter; left time: 73.2032s
	iters: 200, epoch: 7 | loss: 0.2900887
	speed: 0.0156s/iter; left time: 68.2930s
	iters: 300, epoch: 7 | loss: 0.3083286
	speed: 0.0151s/iter; left time: 64.7984s
	iters: 400, epoch: 7 | loss: 0.2676282
	speed: 0.0144s/iter; left time: 60.4917s
	iters: 500, epoch: 7 | loss: 0.3733785
	speed: 0.0144s/iter; left time: 59.0408s
	iters: 600, epoch: 7 | loss: 0.2546077
	speed: 0.0146s/iter; left time: 58.3447s
	iters: 700, epoch: 7 | loss: 0.3268714
	speed: 0.0146s/iter; left time: 56.7261s
	iters: 800, epoch: 7 | loss: 0.3586191
	speed: 0.0143s/iter; left time: 54.1015s
	iters: 900, epoch: 7 | loss: 0.4315265
	speed: 0.0139s/iter; left time: 51.2921s
	iters: 1000, epoch: 7 | loss: 0.4635364
	speed: 0.0140s/iter; left time: 50.1343s
	iters: 1100, epoch: 7 | loss: 0.3351879
	speed: 0.0141s/iter; left time: 49.1114s
Epoch: 7 cost time: 16.281644582748413
Epoch: 7, Steps: 1147 | Train Loss: 0.4136641 Vali Loss: 0.4328681 Test Loss: 0.1767103
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2542955
	speed: 0.0163s/iter; left time: 54.3989s
	iters: 200, epoch: 8 | loss: 0.3053378
	speed: 0.0148s/iter; left time: 48.0002s
	iters: 300, epoch: 8 | loss: 0.3040133
	speed: 0.0148s/iter; left time: 46.5906s
	iters: 400, epoch: 8 | loss: 0.3168783
	speed: 0.0143s/iter; left time: 43.5864s
	iters: 500, epoch: 8 | loss: 0.3565809
	speed: 0.0135s/iter; left time: 39.7687s
	iters: 600, epoch: 8 | loss: 1.2902389
	speed: 0.0133s/iter; left time: 37.7740s
	iters: 700, epoch: 8 | loss: 0.3063386
	speed: 0.0137s/iter; left time: 37.5125s
	iters: 800, epoch: 8 | loss: 1.0203060
	speed: 0.0137s/iter; left time: 36.0957s
	iters: 900, epoch: 8 | loss: 0.3301858
	speed: 0.0135s/iter; left time: 34.3705s
	iters: 1000, epoch: 8 | loss: 0.3397379
	speed: 0.0134s/iter; left time: 32.8245s
	iters: 1100, epoch: 8 | loss: 0.2691618
	speed: 0.0134s/iter; left time: 31.3342s
Epoch: 8 cost time: 15.447781562805176
Epoch: 8, Steps: 1147 | Train Loss: 0.4125559 Vali Loss: 0.4332843 Test Loss: 0.1770254
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2594591
	speed: 0.0210s/iter; left time: 46.0391s
	iters: 200, epoch: 9 | loss: 0.2593178
	speed: 0.0188s/iter; left time: 39.4012s
	iters: 300, epoch: 9 | loss: 0.3063417
	speed: 0.0163s/iter; left time: 32.5757s
	iters: 400, epoch: 9 | loss: 0.3258533
	speed: 0.0168s/iter; left time: 31.7709s
	iters: 500, epoch: 9 | loss: 0.4454320
	speed: 0.0163s/iter; left time: 29.2797s
	iters: 600, epoch: 9 | loss: 0.3064701
	speed: 0.0153s/iter; left time: 25.9996s
	iters: 700, epoch: 9 | loss: 0.3512772
	speed: 0.0146s/iter; left time: 23.2967s
	iters: 800, epoch: 9 | loss: 0.4088330
	speed: 0.0146s/iter; left time: 21.8478s
	iters: 900, epoch: 9 | loss: 0.4016165
	speed: 0.0146s/iter; left time: 20.4038s
	iters: 1000, epoch: 9 | loss: 0.3397315
	speed: 0.0143s/iter; left time: 18.5676s
	iters: 1100, epoch: 9 | loss: 0.3506313
	speed: 0.0147s/iter; left time: 17.5106s
Epoch: 9 cost time: 16.986291885375977
Epoch: 9, Steps: 1147 | Train Loss: 0.4122361 Vali Loss: 0.4339491 Test Loss: 0.1768235
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2604407
	speed: 0.0171s/iter; left time: 17.9402s
	iters: 200, epoch: 10 | loss: 0.3734296
	speed: 0.0143s/iter; left time: 13.5749s
	iters: 300, epoch: 10 | loss: 0.2548978
	speed: 0.0141s/iter; left time: 11.9613s
	iters: 400, epoch: 10 | loss: 0.2922185
	speed: 0.0143s/iter; left time: 10.6861s
	iters: 500, epoch: 10 | loss: 0.3376992
	speed: 0.0140s/iter; left time: 9.0464s
	iters: 600, epoch: 10 | loss: 0.3225240
	speed: 0.0133s/iter; left time: 7.3015s
	iters: 700, epoch: 10 | loss: 0.3638511
	speed: 0.0133s/iter; left time: 5.9390s
	iters: 800, epoch: 10 | loss: 0.3152945
	speed: 0.0134s/iter; left time: 4.6519s
	iters: 900, epoch: 10 | loss: 0.3539650
	speed: 0.0133s/iter; left time: 3.2860s
	iters: 1000, epoch: 10 | loss: 0.3172317
	speed: 0.0130s/iter; left time: 1.9228s
	iters: 1100, epoch: 10 | loss: 0.2336899
	speed: 0.0132s/iter; left time: 0.6312s
Epoch: 10 cost time: 15.49714970588684
Epoch: 10, Steps: 1147 | Train Loss: 0.4117476 Vali Loss: 0.4340452 Test Loss: 0.1770018
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.17783382534980774, mae:0.222421333193779
Seed: 123
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_192      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip True
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.5421908
	speed: 0.0270s/iter; left time: 306.2266s
	iters: 200, epoch: 1 | loss: 0.7777787
	speed: 0.0213s/iter; left time: 239.6317s
	iters: 300, epoch: 1 | loss: 0.9752288
	speed: 0.0191s/iter; left time: 212.4971s
	iters: 400, epoch: 1 | loss: 0.4529969
	speed: 0.0176s/iter; left time: 194.8234s
	iters: 500, epoch: 1 | loss: 0.5034766
	speed: 0.0170s/iter; left time: 185.5351s
	iters: 600, epoch: 1 | loss: 0.5001717
	speed: 0.0163s/iter; left time: 176.9532s
	iters: 700, epoch: 1 | loss: 0.5820894
	speed: 0.0163s/iter; left time: 175.0496s
	iters: 800, epoch: 1 | loss: 0.4222817
	speed: 0.0156s/iter; left time: 166.2586s
	iters: 900, epoch: 1 | loss: 0.5878686
	speed: 0.0151s/iter; left time: 158.8244s
	iters: 1000, epoch: 1 | loss: 0.9802281
	speed: 0.0151s/iter; left time: 157.7988s
	iters: 1100, epoch: 1 | loss: 0.8342283
	speed: 0.0150s/iter; left time: 155.1074s
Epoch: 1 cost time: 17.130297422409058
Epoch: 1, Steps: 1144 | Train Loss: 0.6028940 Vali Loss: 0.5405324 Test Loss: 0.2393167
Validation loss decreased (inf --> 0.540532).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3948753
	speed: 0.0162s/iter; left time: 165.3704s
	iters: 200, epoch: 2 | loss: 0.4485131
	speed: 0.0148s/iter; left time: 149.6778s
	iters: 300, epoch: 2 | loss: 0.4816602
	speed: 0.0147s/iter; left time: 146.8537s
	iters: 400, epoch: 2 | loss: 0.9586186
	speed: 0.0145s/iter; left time: 143.2449s
	iters: 500, epoch: 2 | loss: 0.4480544
	speed: 0.0146s/iter; left time: 143.0308s
	iters: 600, epoch: 2 | loss: 0.5183508
	speed: 0.0144s/iter; left time: 140.0760s
	iters: 700, epoch: 2 | loss: 0.3731618
	speed: 0.0143s/iter; left time: 137.5858s
	iters: 800, epoch: 2 | loss: 0.4224554
	speed: 0.0141s/iter; left time: 134.2657s
	iters: 900, epoch: 2 | loss: 0.3472523
	speed: 0.0139s/iter; left time: 131.0376s
	iters: 1000, epoch: 2 | loss: 0.3754271
	speed: 0.0139s/iter; left time: 128.9455s
	iters: 1100, epoch: 2 | loss: 0.3670774
	speed: 0.0137s/iter; left time: 125.9159s
Epoch: 2 cost time: 15.604321241378784
Epoch: 2, Steps: 1144 | Train Loss: 0.5317876 Vali Loss: 0.5211778 Test Loss: 0.2329973
Validation loss decreased (0.540532 --> 0.521178).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7717577
	speed: 0.0165s/iter; left time: 149.5535s
	iters: 200, epoch: 3 | loss: 0.9025395
	speed: 0.0138s/iter; left time: 123.5949s
	iters: 300, epoch: 3 | loss: 0.4440079
	speed: 0.0140s/iter; left time: 123.9045s
	iters: 400, epoch: 3 | loss: 0.3318493
	speed: 0.0135s/iter; left time: 118.0108s
	iters: 500, epoch: 3 | loss: 0.3732731
	speed: 0.0133s/iter; left time: 115.0553s
	iters: 600, epoch: 3 | loss: 0.5367583
	speed: 0.0134s/iter; left time: 114.4941s
	iters: 700, epoch: 3 | loss: 0.8561385
	speed: 0.0135s/iter; left time: 114.3924s
	iters: 800, epoch: 3 | loss: 0.6196479
	speed: 0.0135s/iter; left time: 112.8717s
	iters: 900, epoch: 3 | loss: 0.4145608
	speed: 0.0136s/iter; left time: 112.3669s
	iters: 1000, epoch: 3 | loss: 0.9387163
	speed: 0.0137s/iter; left time: 111.5253s
	iters: 1100, epoch: 3 | loss: 0.3325101
	speed: 0.0136s/iter; left time: 109.8507s
Epoch: 3 cost time: 15.656596183776855
Epoch: 3, Steps: 1144 | Train Loss: 0.5090035 Vali Loss: 0.5064895 Test Loss: 0.2285693
Validation loss decreased (0.521178 --> 0.506490).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4173741
	speed: 0.0182s/iter; left time: 143.8995s
	iters: 200, epoch: 4 | loss: 0.3737179
	speed: 0.0157s/iter; left time: 122.3707s
	iters: 300, epoch: 4 | loss: 0.9186240
	speed: 0.0156s/iter; left time: 120.3522s
	iters: 400, epoch: 4 | loss: 0.4017353
	speed: 0.0155s/iter; left time: 117.7284s
	iters: 500, epoch: 4 | loss: 0.4536016
	speed: 0.0150s/iter; left time: 112.2888s
	iters: 600, epoch: 4 | loss: 0.9570724
	speed: 0.0148s/iter; left time: 109.4256s
	iters: 700, epoch: 4 | loss: 0.3528551
	speed: 0.0150s/iter; left time: 109.3399s
	iters: 800, epoch: 4 | loss: 0.8405497
	speed: 0.0148s/iter; left time: 106.9180s
	iters: 900, epoch: 4 | loss: 0.3347687
	speed: 0.0148s/iter; left time: 104.9181s
	iters: 1000, epoch: 4 | loss: 0.4069143
	speed: 0.0149s/iter; left time: 104.1078s
	iters: 1100, epoch: 4 | loss: 0.3261248
	speed: 0.0148s/iter; left time: 102.2402s
Epoch: 4 cost time: 16.91760492324829
Epoch: 4, Steps: 1144 | Train Loss: 0.4977241 Vali Loss: 0.5027576 Test Loss: 0.2265080
Validation loss decreased (0.506490 --> 0.502758).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5095065
	speed: 0.0159s/iter; left time: 107.4783s
	iters: 200, epoch: 5 | loss: 0.5058438
	speed: 0.0146s/iter; left time: 97.1843s
	iters: 300, epoch: 5 | loss: 0.4534713
	speed: 0.0146s/iter; left time: 95.9762s
	iters: 400, epoch: 5 | loss: 0.4604448
	speed: 0.0141s/iter; left time: 91.4744s
	iters: 500, epoch: 5 | loss: 0.4105276
	speed: 0.0141s/iter; left time: 89.7248s
	iters: 600, epoch: 5 | loss: 0.4390267
	speed: 0.0144s/iter; left time: 90.4849s
	iters: 700, epoch: 5 | loss: 0.3915335
	speed: 0.0156s/iter; left time: 95.9786s
	iters: 800, epoch: 5 | loss: 0.4302132
	speed: 0.0152s/iter; left time: 91.9183s
	iters: 900, epoch: 5 | loss: 0.4059264
	speed: 0.0151s/iter; left time: 89.8283s
	iters: 1000, epoch: 5 | loss: 0.4063539
	speed: 0.0150s/iter; left time: 87.8285s
	iters: 1100, epoch: 5 | loss: 0.4374051
	speed: 0.0151s/iter; left time: 87.1130s
Epoch: 5 cost time: 17.23990249633789
Epoch: 5, Steps: 1144 | Train Loss: 0.4914591 Vali Loss: 0.4982529 Test Loss: 0.2255411
Validation loss decreased (0.502758 --> 0.498253).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5777473
	speed: 0.0186s/iter; left time: 104.6026s
	iters: 200, epoch: 6 | loss: 0.4998525
	speed: 0.0156s/iter; left time: 85.9845s
	iters: 300, epoch: 6 | loss: 0.9098733
	speed: 0.0156s/iter; left time: 84.7661s
	iters: 400, epoch: 6 | loss: 0.3925550
	speed: 0.0157s/iter; left time: 83.3864s
	iters: 500, epoch: 6 | loss: 0.3696623
	speed: 0.0150s/iter; left time: 78.1325s
	iters: 600, epoch: 6 | loss: 0.8541371
	speed: 0.0143s/iter; left time: 73.4576s
	iters: 700, epoch: 6 | loss: 0.8716623
	speed: 0.0143s/iter; left time: 71.8670s
	iters: 800, epoch: 6 | loss: 0.5684226
	speed: 0.0144s/iter; left time: 71.0263s
	iters: 900, epoch: 6 | loss: 0.4144471
	speed: 0.0142s/iter; left time: 68.6981s
	iters: 1000, epoch: 6 | loss: 0.8132985
	speed: 0.0141s/iter; left time: 66.6564s
	iters: 1100, epoch: 6 | loss: 0.3752386
	speed: 0.0140s/iter; left time: 64.6064s
Epoch: 6 cost time: 16.217632055282593
Epoch: 6, Steps: 1144 | Train Loss: 0.4882011 Vali Loss: 0.4982897 Test Loss: 0.2252841
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3829091
	speed: 0.0183s/iter; left time: 81.9754s
	iters: 200, epoch: 7 | loss: 0.4820683
	speed: 0.0159s/iter; left time: 69.6936s
	iters: 300, epoch: 7 | loss: 0.8779563
	speed: 0.0154s/iter; left time: 65.7471s
	iters: 400, epoch: 7 | loss: 1.0092300
	speed: 0.0147s/iter; left time: 61.5231s
	iters: 500, epoch: 7 | loss: 0.4105986
	speed: 0.0142s/iter; left time: 57.8128s
	iters: 600, epoch: 7 | loss: 0.5114833
	speed: 0.0135s/iter; left time: 53.7643s
	iters: 700, epoch: 7 | loss: 0.8179146
	speed: 0.0134s/iter; left time: 51.7742s
	iters: 800, epoch: 7 | loss: 0.4789037
	speed: 0.0134s/iter; left time: 50.4783s
	iters: 900, epoch: 7 | loss: 0.4179561
	speed: 0.0131s/iter; left time: 48.0258s
	iters: 1000, epoch: 7 | loss: 1.3395154
	speed: 0.0128s/iter; left time: 45.8113s
	iters: 1100, epoch: 7 | loss: 0.3473794
	speed: 0.0131s/iter; left time: 45.4545s
Epoch: 7 cost time: 15.137305974960327
Epoch: 7, Steps: 1144 | Train Loss: 0.4861497 Vali Loss: 0.4981214 Test Loss: 0.2255812
Validation loss decreased (0.498253 --> 0.498121).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3025510
	speed: 0.0152s/iter; left time: 50.6351s
	iters: 200, epoch: 8 | loss: 0.3834604
	speed: 0.0142s/iter; left time: 45.8115s
	iters: 300, epoch: 8 | loss: 0.3064400
	speed: 0.0146s/iter; left time: 45.8744s
	iters: 400, epoch: 8 | loss: 0.4108354
	speed: 0.0136s/iter; left time: 41.3729s
	iters: 500, epoch: 8 | loss: 0.4955180
	speed: 0.0134s/iter; left time: 39.2497s
	iters: 600, epoch: 8 | loss: 0.4971285
	speed: 0.0134s/iter; left time: 37.9025s
	iters: 700, epoch: 8 | loss: 0.3903736
	speed: 0.0133s/iter; left time: 36.4312s
	iters: 800, epoch: 8 | loss: 0.3426528
	speed: 0.0133s/iter; left time: 35.0168s
	iters: 900, epoch: 8 | loss: 0.3159847
	speed: 0.0136s/iter; left time: 34.4504s
	iters: 1000, epoch: 8 | loss: 1.2669611
	speed: 0.0135s/iter; left time: 32.7986s
	iters: 1100, epoch: 8 | loss: 0.4508134
	speed: 0.0135s/iter; left time: 31.5193s
Epoch: 8 cost time: 15.63387131690979
Epoch: 8, Steps: 1144 | Train Loss: 0.4851419 Vali Loss: 0.4969747 Test Loss: 0.2252178
Validation loss decreased (0.498121 --> 0.496975).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.9395890
	speed: 0.0196s/iter; left time: 42.9908s
	iters: 200, epoch: 9 | loss: 0.4608008
	speed: 0.0169s/iter; left time: 35.2667s
	iters: 300, epoch: 9 | loss: 0.4325533
	speed: 0.0165s/iter; left time: 32.9059s
	iters: 400, epoch: 9 | loss: 0.3331330
	speed: 0.0162s/iter; left time: 30.6237s
	iters: 500, epoch: 9 | loss: 0.4926917
	speed: 0.0155s/iter; left time: 27.7760s
	iters: 600, epoch: 9 | loss: 0.4303622
	speed: 0.0158s/iter; left time: 26.6744s
	iters: 700, epoch: 9 | loss: 0.4613869
	speed: 0.0158s/iter; left time: 25.0932s
	iters: 800, epoch: 9 | loss: 0.3535363
	speed: 0.0156s/iter; left time: 23.1630s
	iters: 900, epoch: 9 | loss: 0.4178716
	speed: 0.0156s/iter; left time: 21.6524s
	iters: 1000, epoch: 9 | loss: 0.2994161
	speed: 0.0154s/iter; left time: 19.8831s
	iters: 1100, epoch: 9 | loss: 0.3698524
	speed: 0.0152s/iter; left time: 18.0360s
Epoch: 9 cost time: 17.32809352874756
Epoch: 9, Steps: 1144 | Train Loss: 0.4846703 Vali Loss: 0.4967363 Test Loss: 0.2252613
Validation loss decreased (0.496975 --> 0.496736).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3534523
	speed: 0.0172s/iter; left time: 17.9855s
	iters: 200, epoch: 10 | loss: 1.0353824
	speed: 0.0156s/iter; left time: 14.7366s
	iters: 300, epoch: 10 | loss: 0.3848749
	speed: 0.0143s/iter; left time: 12.0729s
	iters: 400, epoch: 10 | loss: 0.3966307
	speed: 0.0141s/iter; left time: 10.5095s
	iters: 500, epoch: 10 | loss: 0.4664597
	speed: 0.0142s/iter; left time: 9.1469s
	iters: 600, epoch: 10 | loss: 0.4525832
	speed: 0.0137s/iter; left time: 7.4722s
	iters: 700, epoch: 10 | loss: 1.0753250
	speed: 0.0135s/iter; left time: 5.9986s
	iters: 800, epoch: 10 | loss: 0.3266824
	speed: 0.0134s/iter; left time: 4.6343s
	iters: 900, epoch: 10 | loss: 0.3597089
	speed: 0.0138s/iter; left time: 3.3802s
	iters: 1000, epoch: 10 | loss: 0.7492642
	speed: 0.0139s/iter; left time: 2.0099s
	iters: 1100, epoch: 10 | loss: 0.4524054
	speed: 0.0138s/iter; left time: 0.6222s
Epoch: 10 cost time: 15.829517602920532
Epoch: 10, Steps: 1144 | Train Loss: 0.4843890 Vali Loss: 0.4966235 Test Loss: 0.2252058
Validation loss decreased (0.496736 --> 0.496623).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.22520580887794495, mae:0.2621036469936371
Use GPU: cuda:0
no_skip True
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.4227128
	speed: 0.0155s/iter; left time: 175.9956s
	iters: 200, epoch: 1 | loss: 0.8048691
	speed: 0.0141s/iter; left time: 158.0778s
	iters: 300, epoch: 1 | loss: 0.9555590
	speed: 0.0143s/iter; left time: 159.0677s
	iters: 400, epoch: 1 | loss: 0.6443211
	speed: 0.0143s/iter; left time: 157.7363s
	iters: 500, epoch: 1 | loss: 0.9823794
	speed: 0.0140s/iter; left time: 153.5935s
	iters: 600, epoch: 1 | loss: 0.4225980
	speed: 0.0136s/iter; left time: 147.9232s
	iters: 700, epoch: 1 | loss: 0.4285915
	speed: 0.0145s/iter; left time: 156.2744s
	iters: 800, epoch: 1 | loss: 0.4562642
	speed: 0.0145s/iter; left time: 154.5819s
	iters: 900, epoch: 1 | loss: 0.5053933
	speed: 0.0144s/iter; left time: 152.0153s
	iters: 1000, epoch: 1 | loss: 0.4943115
	speed: 0.0145s/iter; left time: 151.0322s
	iters: 1100, epoch: 1 | loss: 0.4740255
	speed: 0.0144s/iter; left time: 149.3592s
Epoch: 1 cost time: 16.673914909362793
Epoch: 1, Steps: 1144 | Train Loss: 0.5810429 Vali Loss: 0.5435042 Test Loss: 0.2383858
Validation loss decreased (inf --> 0.543504).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4118074
	speed: 0.0168s/iter; left time: 171.0679s
	iters: 200, epoch: 2 | loss: 0.4773017
	speed: 0.0146s/iter; left time: 147.4061s
	iters: 300, epoch: 2 | loss: 0.4221511
	speed: 0.0137s/iter; left time: 137.3342s
	iters: 400, epoch: 2 | loss: 0.4422074
	speed: 0.0133s/iter; left time: 131.2214s
	iters: 500, epoch: 2 | loss: 0.3716631
	speed: 0.0133s/iter; left time: 130.0070s
	iters: 600, epoch: 2 | loss: 0.4347871
	speed: 0.0131s/iter; left time: 126.9375s
	iters: 700, epoch: 2 | loss: 0.5785509
	speed: 0.0127s/iter; left time: 122.1704s
	iters: 800, epoch: 2 | loss: 1.0011206
	speed: 0.0125s/iter; left time: 119.0810s
	iters: 900, epoch: 2 | loss: 0.4896435
	speed: 0.0124s/iter; left time: 116.2959s
	iters: 1000, epoch: 2 | loss: 0.9601145
	speed: 0.0123s/iter; left time: 114.3338s
	iters: 1100, epoch: 2 | loss: 0.4203229
	speed: 0.0129s/iter; left time: 118.2819s
Epoch: 2 cost time: 14.772223711013794
Epoch: 2, Steps: 1144 | Train Loss: 0.5320690 Vali Loss: 0.5225447 Test Loss: 0.2334965
Validation loss decreased (0.543504 --> 0.522545).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4358822
	speed: 0.0172s/iter; left time: 155.9376s
	iters: 200, epoch: 3 | loss: 0.4673070
	speed: 0.0174s/iter; left time: 156.0396s
	iters: 300, epoch: 3 | loss: 0.4328778
	speed: 0.0161s/iter; left time: 142.1991s
	iters: 400, epoch: 3 | loss: 0.3869254
	speed: 0.0151s/iter; left time: 132.4997s
	iters: 500, epoch: 3 | loss: 0.4024847
	speed: 0.0150s/iter; left time: 129.6474s
	iters: 600, epoch: 3 | loss: 0.4160748
	speed: 0.0151s/iter; left time: 129.1809s
	iters: 700, epoch: 3 | loss: 0.4018601
	speed: 0.0151s/iter; left time: 127.3355s
	iters: 800, epoch: 3 | loss: 0.8874549
	speed: 0.0149s/iter; left time: 124.1307s
	iters: 900, epoch: 3 | loss: 0.4088949
	speed: 0.0149s/iter; left time: 123.0607s
	iters: 1000, epoch: 3 | loss: 0.3652914
	speed: 0.0149s/iter; left time: 121.5561s
	iters: 1100, epoch: 3 | loss: 0.4503351
	speed: 0.0148s/iter; left time: 119.5383s
Epoch: 3 cost time: 17.000410795211792
Epoch: 3, Steps: 1144 | Train Loss: 0.5132068 Vali Loss: 0.5102925 Test Loss: 0.2290307
Validation loss decreased (0.522545 --> 0.510293).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5066403
	speed: 0.0167s/iter; left time: 132.4731s
	iters: 200, epoch: 4 | loss: 0.5870548
	speed: 0.0138s/iter; left time: 108.0227s
	iters: 300, epoch: 4 | loss: 0.4279930
	speed: 0.0131s/iter; left time: 101.3093s
	iters: 400, epoch: 4 | loss: 1.0317233
	speed: 0.0138s/iter; left time: 105.1507s
	iters: 500, epoch: 4 | loss: 0.4790792
	speed: 0.0139s/iter; left time: 104.1818s
	iters: 600, epoch: 4 | loss: 0.3294995
	speed: 0.0136s/iter; left time: 100.7127s
	iters: 700, epoch: 4 | loss: 0.3690453
	speed: 0.0136s/iter; left time: 99.6777s
	iters: 800, epoch: 4 | loss: 0.5261370
	speed: 0.0141s/iter; left time: 101.5310s
	iters: 900, epoch: 4 | loss: 0.5835388
	speed: 0.0141s/iter; left time: 100.0923s
	iters: 1000, epoch: 4 | loss: 0.4511926
	speed: 0.0139s/iter; left time: 97.5364s
	iters: 1100, epoch: 4 | loss: 0.3625189
	speed: 0.0138s/iter; left time: 95.1156s
Epoch: 4 cost time: 15.957087278366089
Epoch: 4, Steps: 1144 | Train Loss: 0.5028442 Vali Loss: 0.5073819 Test Loss: 0.2291613
Validation loss decreased (0.510293 --> 0.507382).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.9226347
	speed: 0.0179s/iter; left time: 121.0969s
	iters: 200, epoch: 5 | loss: 0.4513296
	speed: 0.0140s/iter; left time: 93.2297s
	iters: 300, epoch: 5 | loss: 0.4239955
	speed: 0.0138s/iter; left time: 90.6198s
	iters: 400, epoch: 5 | loss: 0.3806132
	speed: 0.0142s/iter; left time: 91.8075s
	iters: 500, epoch: 5 | loss: 0.6465688
	speed: 0.0152s/iter; left time: 97.0183s
	iters: 600, epoch: 5 | loss: 0.3774898
	speed: 0.0149s/iter; left time: 93.6385s
	iters: 700, epoch: 5 | loss: 0.3526508
	speed: 0.0148s/iter; left time: 91.1477s
	iters: 800, epoch: 5 | loss: 0.3459688
	speed: 0.0147s/iter; left time: 89.2666s
	iters: 900, epoch: 5 | loss: 0.5158920
	speed: 0.0148s/iter; left time: 88.2634s
	iters: 1000, epoch: 5 | loss: 0.5275121
	speed: 0.0145s/iter; left time: 85.3100s
	iters: 1100, epoch: 5 | loss: 0.5312241
	speed: 0.0143s/iter; left time: 82.5443s
Epoch: 5 cost time: 16.435641288757324
Epoch: 5, Steps: 1144 | Train Loss: 0.4978314 Vali Loss: 0.5077760 Test Loss: 0.2299340
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4172517
	speed: 0.0177s/iter; left time: 99.5847s
	iters: 200, epoch: 6 | loss: 1.0239820
	speed: 0.0146s/iter; left time: 80.7832s
	iters: 300, epoch: 6 | loss: 0.3422598
	speed: 0.0135s/iter; left time: 73.0230s
	iters: 400, epoch: 6 | loss: 0.4790168
	speed: 0.0148s/iter; left time: 78.8093s
	iters: 500, epoch: 6 | loss: 0.3743281
	speed: 0.0150s/iter; left time: 78.3278s
	iters: 600, epoch: 6 | loss: 0.3701818
	speed: 0.0141s/iter; left time: 72.3964s
	iters: 700, epoch: 6 | loss: 0.4498333
	speed: 0.0135s/iter; left time: 67.6474s
	iters: 800, epoch: 6 | loss: 0.3938777
	speed: 0.0136s/iter; left time: 67.1107s
	iters: 900, epoch: 6 | loss: 0.3682452
	speed: 0.0138s/iter; left time: 66.7206s
	iters: 1000, epoch: 6 | loss: 0.3630324
	speed: 0.0137s/iter; left time: 64.6045s
	iters: 1100, epoch: 6 | loss: 0.3432208
	speed: 0.0135s/iter; left time: 62.4788s
Epoch: 6 cost time: 15.484025955200195
Epoch: 6, Steps: 1144 | Train Loss: 0.4948566 Vali Loss: 0.5050317 Test Loss: 0.2287534
Validation loss decreased (0.507382 --> 0.505032).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5115085
	speed: 0.0177s/iter; left time: 79.2138s
	iters: 200, epoch: 7 | loss: 0.3163787
	speed: 0.0163s/iter; left time: 71.2318s
	iters: 300, epoch: 7 | loss: 0.5342538
	speed: 0.0150s/iter; left time: 63.9961s
	iters: 400, epoch: 7 | loss: 0.4028789
	speed: 0.0146s/iter; left time: 61.0188s
	iters: 500, epoch: 7 | loss: 0.3084638
	speed: 0.0148s/iter; left time: 60.3141s
	iters: 600, epoch: 7 | loss: 0.5297437
	speed: 0.0153s/iter; left time: 60.9114s
	iters: 700, epoch: 7 | loss: 0.5562660
	speed: 0.0149s/iter; left time: 57.6735s
	iters: 800, epoch: 7 | loss: 0.3925635
	speed: 0.0150s/iter; left time: 56.5678s
	iters: 900, epoch: 7 | loss: 0.4935158
	speed: 0.0149s/iter; left time: 54.8688s
	iters: 1000, epoch: 7 | loss: 0.4777004
	speed: 0.0146s/iter; left time: 52.3975s
	iters: 1100, epoch: 7 | loss: 0.2964675
	speed: 0.0142s/iter; left time: 49.3432s
Epoch: 7 cost time: 16.27712893486023
Epoch: 7, Steps: 1144 | Train Loss: 0.4934440 Vali Loss: 0.5029305 Test Loss: 0.2282357
Validation loss decreased (0.505032 --> 0.502931).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3805777
	speed: 0.0259s/iter; left time: 86.2888s
	iters: 200, epoch: 8 | loss: 0.3865938
	speed: 0.0203s/iter; left time: 65.4701s
	iters: 300, epoch: 8 | loss: 0.4249564
	speed: 0.0187s/iter; left time: 58.6645s
	iters: 400, epoch: 8 | loss: 0.4043068
	speed: 0.0174s/iter; left time: 52.7361s
	iters: 500, epoch: 8 | loss: 0.9074088
	speed: 0.0171s/iter; left time: 50.0926s
	iters: 600, epoch: 8 | loss: 1.3601023
	speed: 0.0165s/iter; left time: 46.7462s
	iters: 700, epoch: 8 | loss: 0.4891959
	speed: 0.0158s/iter; left time: 43.1371s
	iters: 800, epoch: 8 | loss: 0.5112167
	speed: 0.0158s/iter; left time: 41.5758s
	iters: 900, epoch: 8 | loss: 0.7090911
	speed: 0.0157s/iter; left time: 39.6625s
	iters: 1000, epoch: 8 | loss: 0.4468224
	speed: 0.0155s/iter; left time: 37.6646s
	iters: 1100, epoch: 8 | loss: 0.8534518
	speed: 0.0154s/iter; left time: 35.8447s
Epoch: 8 cost time: 17.627618312835693
Epoch: 8, Steps: 1144 | Train Loss: 0.4926937 Vali Loss: 0.5024652 Test Loss: 0.2281158
Validation loss decreased (0.502931 --> 0.502465).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4710225
	speed: 0.0241s/iter; left time: 52.6736s
	iters: 200, epoch: 9 | loss: 0.4284591
	speed: 0.0210s/iter; left time: 43.9560s
	iters: 300, epoch: 9 | loss: 0.9818475
	speed: 0.0187s/iter; left time: 37.1896s
	iters: 400, epoch: 9 | loss: 0.5592695
	speed: 0.0166s/iter; left time: 31.2769s
	iters: 500, epoch: 9 | loss: 0.3858011
	speed: 0.0163s/iter; left time: 29.0945s
	iters: 600, epoch: 9 | loss: 0.4416366
	speed: 0.0167s/iter; left time: 28.2435s
	iters: 700, epoch: 9 | loss: 0.4909104
	speed: 0.0160s/iter; left time: 25.4163s
	iters: 800, epoch: 9 | loss: 0.4857223
	speed: 0.0157s/iter; left time: 23.4090s
	iters: 900, epoch: 9 | loss: 0.8237678
	speed: 0.0157s/iter; left time: 21.8484s
	iters: 1000, epoch: 9 | loss: 0.4066607
	speed: 0.0155s/iter; left time: 20.0395s
	iters: 1100, epoch: 9 | loss: 0.3682742
	speed: 0.0152s/iter; left time: 18.1041s
Epoch: 9 cost time: 17.435450315475464
Epoch: 9, Steps: 1144 | Train Loss: 0.4924006 Vali Loss: 0.5027704 Test Loss: 0.2281419
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.4279028
	speed: 0.0179s/iter; left time: 18.6976s
	iters: 200, epoch: 10 | loss: 0.3576092
	speed: 0.0148s/iter; left time: 14.0068s
	iters: 300, epoch: 10 | loss: 0.3540415
	speed: 0.0148s/iter; left time: 12.5379s
	iters: 400, epoch: 10 | loss: 0.3678948
	speed: 0.0143s/iter; left time: 10.6450s
	iters: 500, epoch: 10 | loss: 0.4671132
	speed: 0.0140s/iter; left time: 9.0034s
	iters: 600, epoch: 10 | loss: 0.3056685
	speed: 0.0133s/iter; left time: 7.2688s
	iters: 700, epoch: 10 | loss: 0.8466180
	speed: 0.0138s/iter; left time: 6.1471s
	iters: 800, epoch: 10 | loss: 0.4113218
	speed: 0.0138s/iter; left time: 4.7542s
	iters: 900, epoch: 10 | loss: 0.4902904
	speed: 0.0137s/iter; left time: 3.3479s
	iters: 1000, epoch: 10 | loss: 0.4216937
	speed: 0.0135s/iter; left time: 1.9637s
	iters: 1100, epoch: 10 | loss: 0.3965966
	speed: 0.0134s/iter; left time: 0.6017s
Epoch: 10 cost time: 15.287766695022583
Epoch: 10, Steps: 1144 | Train Loss: 0.4919774 Vali Loss: 0.5023453 Test Loss: 0.2279972
Validation loss decreased (0.502465 --> 0.502345).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.22799725830554962, mae:0.26417815685272217
Use GPU: cuda:0
no_skip True
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.7689401
	speed: 0.0260s/iter; left time: 294.7684s
	iters: 200, epoch: 1 | loss: 1.0552671
	speed: 0.0191s/iter; left time: 215.2156s
	iters: 300, epoch: 1 | loss: 0.6413026
	speed: 0.0162s/iter; left time: 180.8009s
	iters: 400, epoch: 1 | loss: 0.4447532
	speed: 0.0161s/iter; left time: 177.6219s
	iters: 500, epoch: 1 | loss: 0.4488717
	speed: 0.0159s/iter; left time: 174.2254s
	iters: 600, epoch: 1 | loss: 0.5494037
	speed: 0.0156s/iter; left time: 169.3299s
	iters: 700, epoch: 1 | loss: 0.4674678
	speed: 0.0152s/iter; left time: 163.0851s
	iters: 800, epoch: 1 | loss: 0.4165490
	speed: 0.0151s/iter; left time: 160.4753s
	iters: 900, epoch: 1 | loss: 0.3631809
	speed: 0.0150s/iter; left time: 158.6015s
	iters: 1000, epoch: 1 | loss: 1.0924908
	speed: 0.0146s/iter; left time: 152.6098s
	iters: 1100, epoch: 1 | loss: 0.3794618
	speed: 0.0146s/iter; left time: 150.9891s
Epoch: 1 cost time: 16.908747911453247
Epoch: 1, Steps: 1144 | Train Loss: 0.5936791 Vali Loss: 0.5495290 Test Loss: 0.2396058
Validation loss decreased (inf --> 0.549529).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5826080
	speed: 0.0172s/iter; left time: 174.9555s
	iters: 200, epoch: 2 | loss: 0.3939462
	speed: 0.0151s/iter; left time: 152.8759s
	iters: 300, epoch: 2 | loss: 0.3718744
	speed: 0.0153s/iter; left time: 152.8089s
	iters: 400, epoch: 2 | loss: 0.3962972
	speed: 0.0148s/iter; left time: 146.8222s
	iters: 500, epoch: 2 | loss: 0.4773328
	speed: 0.0147s/iter; left time: 144.1792s
	iters: 600, epoch: 2 | loss: 0.4204122
	speed: 0.0146s/iter; left time: 141.3996s
	iters: 700, epoch: 2 | loss: 0.9834394
	speed: 0.0145s/iter; left time: 139.1060s
	iters: 800, epoch: 2 | loss: 0.4178465
	speed: 0.0144s/iter; left time: 136.6459s
	iters: 900, epoch: 2 | loss: 0.4327234
	speed: 0.0143s/iter; left time: 134.2140s
	iters: 1000, epoch: 2 | loss: 0.4629995
	speed: 0.0141s/iter; left time: 131.4208s
	iters: 1100, epoch: 2 | loss: 0.5266858
	speed: 0.0143s/iter; left time: 131.1428s
Epoch: 2 cost time: 16.426084280014038
Epoch: 2, Steps: 1144 | Train Loss: 0.5275085 Vali Loss: 0.5230148 Test Loss: 0.2319885
Validation loss decreased (0.549529 --> 0.523015).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.8237730
	speed: 0.0167s/iter; left time: 151.5968s
	iters: 200, epoch: 3 | loss: 0.3133707
	speed: 0.0149s/iter; left time: 133.6811s
	iters: 300, epoch: 3 | loss: 0.8243163
	speed: 0.0142s/iter; left time: 126.0674s
	iters: 400, epoch: 3 | loss: 0.4257719
	speed: 0.0147s/iter; left time: 129.0135s
	iters: 500, epoch: 3 | loss: 0.5611845
	speed: 0.0150s/iter; left time: 129.7343s
	iters: 600, epoch: 3 | loss: 0.5492969
	speed: 0.0149s/iter; left time: 127.0521s
	iters: 700, epoch: 3 | loss: 0.9851769
	speed: 0.0148s/iter; left time: 124.9620s
	iters: 800, epoch: 3 | loss: 0.4234166
	speed: 0.0147s/iter; left time: 122.9287s
	iters: 900, epoch: 3 | loss: 0.4875632
	speed: 0.0145s/iter; left time: 119.5636s
	iters: 1000, epoch: 3 | loss: 0.4273685
	speed: 0.0142s/iter; left time: 115.9734s
	iters: 1100, epoch: 3 | loss: 0.3675700
	speed: 0.0141s/iter; left time: 113.2006s
Epoch: 3 cost time: 16.23509168624878
Epoch: 3, Steps: 1144 | Train Loss: 0.5064896 Vali Loss: 0.5132448 Test Loss: 0.2313796
Validation loss decreased (0.523015 --> 0.513245).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4578967
	speed: 0.0152s/iter; left time: 119.8296s
	iters: 200, epoch: 4 | loss: 0.4330504
	speed: 0.0151s/iter; left time: 118.0222s
	iters: 300, epoch: 4 | loss: 0.3471318
	speed: 0.0156s/iter; left time: 120.4728s
	iters: 400, epoch: 4 | loss: 0.3869449
	speed: 0.0155s/iter; left time: 118.1056s
	iters: 500, epoch: 4 | loss: 0.3164775
	speed: 0.0154s/iter; left time: 115.4394s
	iters: 600, epoch: 4 | loss: 0.5102325
	speed: 0.0156s/iter; left time: 115.8394s
	iters: 700, epoch: 4 | loss: 0.4220794
	speed: 0.0152s/iter; left time: 110.9942s
	iters: 800, epoch: 4 | loss: 0.3770945
	speed: 0.0151s/iter; left time: 108.9676s
	iters: 900, epoch: 4 | loss: 0.4321090
	speed: 0.0150s/iter; left time: 106.3948s
	iters: 1000, epoch: 4 | loss: 0.4645718
	speed: 0.0147s/iter; left time: 102.9145s
	iters: 1100, epoch: 4 | loss: 0.3960999
	speed: 0.0145s/iter; left time: 100.3139s
Epoch: 4 cost time: 16.617470502853394
Epoch: 4, Steps: 1144 | Train Loss: 0.4977977 Vali Loss: 0.5029823 Test Loss: 0.2272432
Validation loss decreased (0.513245 --> 0.502982).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.8200344
	speed: 0.0267s/iter; left time: 180.7871s
	iters: 200, epoch: 5 | loss: 0.3905283
	speed: 0.0194s/iter; left time: 129.1841s
	iters: 300, epoch: 5 | loss: 0.5077944
	speed: 0.0180s/iter; left time: 118.1590s
	iters: 400, epoch: 5 | loss: 0.4876943
	speed: 0.0174s/iter; left time: 112.1810s
	iters: 500, epoch: 5 | loss: 0.8421912
	speed: 0.0168s/iter; left time: 106.8333s
	iters: 600, epoch: 5 | loss: 0.5246332
	speed: 0.0163s/iter; left time: 102.2930s
	iters: 700, epoch: 5 | loss: 0.3137981
	speed: 0.0159s/iter; left time: 98.2739s
	iters: 800, epoch: 5 | loss: 0.4212999
	speed: 0.0161s/iter; left time: 97.6982s
	iters: 900, epoch: 5 | loss: 0.4948435
	speed: 0.0158s/iter; left time: 94.2592s
	iters: 1000, epoch: 5 | loss: 0.5195872
	speed: 0.0158s/iter; left time: 92.4349s
	iters: 1100, epoch: 5 | loss: 0.4181668
	speed: 0.0157s/iter; left time: 90.3305s
Epoch: 5 cost time: 18.040562629699707
Epoch: 5, Steps: 1144 | Train Loss: 0.4915584 Vali Loss: 0.4989435 Test Loss: 0.2250971
Validation loss decreased (0.502982 --> 0.498944).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4762444
	speed: 0.0214s/iter; left time: 120.0980s
	iters: 200, epoch: 6 | loss: 0.4397587
	speed: 0.0179s/iter; left time: 98.7112s
	iters: 300, epoch: 6 | loss: 0.3297455
	speed: 0.0162s/iter; left time: 87.9459s
	iters: 400, epoch: 6 | loss: 0.3375716
	speed: 0.0155s/iter; left time: 82.3204s
	iters: 500, epoch: 6 | loss: 0.8534299
	speed: 0.0152s/iter; left time: 79.1148s
	iters: 600, epoch: 6 | loss: 0.7169428
	speed: 0.0152s/iter; left time: 77.8481s
	iters: 700, epoch: 6 | loss: 0.4262797
	speed: 0.0148s/iter; left time: 74.2323s
	iters: 800, epoch: 6 | loss: 1.3799849
	speed: 0.0145s/iter; left time: 71.3334s
	iters: 900, epoch: 6 | loss: 0.3524219
	speed: 0.0143s/iter; left time: 68.9927s
	iters: 1000, epoch: 6 | loss: 0.4160263
	speed: 0.0146s/iter; left time: 69.0243s
	iters: 1100, epoch: 6 | loss: 0.2862098
	speed: 0.0144s/iter; left time: 66.4371s
Epoch: 6 cost time: 16.45883321762085
Epoch: 6, Steps: 1144 | Train Loss: 0.4886114 Vali Loss: 0.4984854 Test Loss: 0.2248952
Validation loss decreased (0.498944 --> 0.498485).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8520951
	speed: 0.0182s/iter; left time: 81.4842s
	iters: 200, epoch: 7 | loss: 0.5761006
	speed: 0.0162s/iter; left time: 70.7221s
	iters: 300, epoch: 7 | loss: 0.3626466
	speed: 0.0151s/iter; left time: 64.5708s
	iters: 400, epoch: 7 | loss: 0.4584963
	speed: 0.0143s/iter; left time: 59.7604s
	iters: 500, epoch: 7 | loss: 1.0240029
	speed: 0.0141s/iter; left time: 57.3258s
	iters: 600, epoch: 7 | loss: 0.3875835
	speed: 0.0146s/iter; left time: 58.1107s
	iters: 700, epoch: 7 | loss: 0.3181897
	speed: 0.0149s/iter; left time: 57.8723s
	iters: 800, epoch: 7 | loss: 0.5337467
	speed: 0.0151s/iter; left time: 56.8991s
	iters: 900, epoch: 7 | loss: 0.3787366
	speed: 0.0149s/iter; left time: 54.6952s
	iters: 1000, epoch: 7 | loss: 0.2696862
	speed: 0.0147s/iter; left time: 52.7549s
	iters: 1100, epoch: 7 | loss: 0.4199832
	speed: 0.0147s/iter; left time: 51.0751s
Epoch: 7 cost time: 16.91101622581482
Epoch: 7, Steps: 1144 | Train Loss: 0.4866140 Vali Loss: 0.4978735 Test Loss: 0.2248398
Validation loss decreased (0.498485 --> 0.497874).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.8571104
	speed: 0.0166s/iter; left time: 55.3637s
	iters: 200, epoch: 8 | loss: 0.8246943
	speed: 0.0145s/iter; left time: 46.7542s
	iters: 300, epoch: 8 | loss: 0.9307956
	speed: 0.0148s/iter; left time: 46.3487s
	iters: 400, epoch: 8 | loss: 0.9318256
	speed: 0.0149s/iter; left time: 45.2913s
	iters: 500, epoch: 8 | loss: 0.4892319
	speed: 0.0147s/iter; left time: 43.2498s
	iters: 600, epoch: 8 | loss: 0.4154006
	speed: 0.0148s/iter; left time: 42.0472s
	iters: 700, epoch: 8 | loss: 1.2588691
	speed: 0.0151s/iter; left time: 41.3595s
	iters: 800, epoch: 8 | loss: 0.4247714
	speed: 0.0149s/iter; left time: 39.1232s
	iters: 900, epoch: 8 | loss: 0.5860384
	speed: 0.0144s/iter; left time: 36.5127s
	iters: 1000, epoch: 8 | loss: 0.3632956
	speed: 0.0140s/iter; left time: 34.0457s
	iters: 1100, epoch: 8 | loss: 0.4552142
	speed: 0.0144s/iter; left time: 33.6159s
Epoch: 8 cost time: 16.530633687973022
Epoch: 8, Steps: 1144 | Train Loss: 0.4857270 Vali Loss: 0.4973835 Test Loss: 0.2246925
Validation loss decreased (0.497874 --> 0.497384).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3914914
	speed: 0.0178s/iter; left time: 38.8803s
	iters: 200, epoch: 9 | loss: 0.3839608
	speed: 0.0152s/iter; left time: 31.6956s
	iters: 300, epoch: 9 | loss: 0.4545819
	speed: 0.0136s/iter; left time: 27.1490s
	iters: 400, epoch: 9 | loss: 0.5263581
	speed: 0.0135s/iter; left time: 25.4816s
	iters: 500, epoch: 9 | loss: 0.5002859
	speed: 0.0138s/iter; left time: 24.7503s
	iters: 600, epoch: 9 | loss: 1.2401071
	speed: 0.0136s/iter; left time: 22.8944s
	iters: 700, epoch: 9 | loss: 0.3412810
	speed: 0.0132s/iter; left time: 20.9734s
	iters: 800, epoch: 9 | loss: 0.3498730
	speed: 0.0135s/iter; left time: 20.0839s
	iters: 900, epoch: 9 | loss: 0.4483828
	speed: 0.0136s/iter; left time: 18.8699s
	iters: 1000, epoch: 9 | loss: 0.3951634
	speed: 0.0137s/iter; left time: 17.6233s
	iters: 1100, epoch: 9 | loss: 0.3703361
	speed: 0.0136s/iter; left time: 16.1173s
Epoch: 9 cost time: 15.472986936569214
Epoch: 9, Steps: 1144 | Train Loss: 0.4855185 Vali Loss: 0.4976381 Test Loss: 0.2248566
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3874063
	speed: 0.0179s/iter; left time: 18.7213s
	iters: 200, epoch: 10 | loss: 0.3058619
	speed: 0.0166s/iter; left time: 15.6841s
	iters: 300, epoch: 10 | loss: 0.3959590
	speed: 0.0157s/iter; left time: 13.2326s
	iters: 400, epoch: 10 | loss: 0.5339996
	speed: 0.0147s/iter; left time: 10.9233s
	iters: 500, epoch: 10 | loss: 0.3804910
	speed: 0.0142s/iter; left time: 9.1577s
	iters: 600, epoch: 10 | loss: 0.7673650
	speed: 0.0143s/iter; left time: 7.7989s
	iters: 700, epoch: 10 | loss: 0.7632579
	speed: 0.0144s/iter; left time: 6.4174s
	iters: 800, epoch: 10 | loss: 0.4729304
	speed: 0.0144s/iter; left time: 4.9673s
	iters: 900, epoch: 10 | loss: 0.4189634
	speed: 0.0141s/iter; left time: 3.4577s
	iters: 1000, epoch: 10 | loss: 0.5881352
	speed: 0.0140s/iter; left time: 2.0252s
	iters: 1100, epoch: 10 | loss: 0.9841074
	speed: 0.0141s/iter; left time: 0.6326s
Epoch: 10 cost time: 16.380972623825073
Epoch: 10, Steps: 1144 | Train Loss: 0.4851105 Vali Loss: 0.4969887 Test Loss: 0.2246701
Validation loss decreased (0.497384 --> 0.496989).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.2246701568365097, mae:0.2611897885799408
Seed: 123
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_336      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip True
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 1.0114959
	speed: 0.0282s/iter; left time: 319.0106s
	iters: 200, epoch: 1 | loss: 0.7034563
	speed: 0.0208s/iter; left time: 233.0400s
	iters: 300, epoch: 1 | loss: 1.1404905
	speed: 0.0184s/iter; left time: 204.1488s
	iters: 400, epoch: 1 | loss: 0.8856507
	speed: 0.0176s/iter; left time: 193.5471s
	iters: 500, epoch: 1 | loss: 0.5525650
	speed: 0.0173s/iter; left time: 188.1923s
	iters: 600, epoch: 1 | loss: 0.5044191
	speed: 0.0169s/iter; left time: 183.0702s
	iters: 700, epoch: 1 | loss: 0.5913204
	speed: 0.0163s/iter; left time: 174.1572s
	iters: 800, epoch: 1 | loss: 0.6320766
	speed: 0.0158s/iter; left time: 167.6605s
	iters: 900, epoch: 1 | loss: 0.5154217
	speed: 0.0160s/iter; left time: 167.6869s
	iters: 1000, epoch: 1 | loss: 0.7551087
	speed: 0.0158s/iter; left time: 164.0225s
	iters: 1100, epoch: 1 | loss: 0.7892989
	speed: 0.0155s/iter; left time: 159.8715s
Epoch: 1 cost time: 17.69986343383789
Epoch: 1, Steps: 1140 | Train Loss: 0.6605323 Vali Loss: 0.6159930 Test Loss: 0.2923009
Validation loss decreased (inf --> 0.615993).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5686430
	speed: 0.0154s/iter; left time: 156.8827s
	iters: 200, epoch: 2 | loss: 0.7544232
	speed: 0.0139s/iter; left time: 140.2122s
	iters: 300, epoch: 2 | loss: 0.4997878
	speed: 0.0136s/iter; left time: 135.2610s
	iters: 400, epoch: 2 | loss: 0.7052509
	speed: 0.0140s/iter; left time: 137.7012s
	iters: 500, epoch: 2 | loss: 0.7854232
	speed: 0.0140s/iter; left time: 136.5643s
	iters: 600, epoch: 2 | loss: 0.4730789
	speed: 0.0136s/iter; left time: 131.8217s
	iters: 700, epoch: 2 | loss: 0.4951510
	speed: 0.0136s/iter; left time: 129.9241s
	iters: 800, epoch: 2 | loss: 0.5879657
	speed: 0.0139s/iter; left time: 131.6715s
	iters: 900, epoch: 2 | loss: 0.4591582
	speed: 0.0139s/iter; left time: 130.0377s
	iters: 1000, epoch: 2 | loss: 0.4541690
	speed: 0.0137s/iter; left time: 126.8304s
	iters: 1100, epoch: 2 | loss: 0.4314260
	speed: 0.0136s/iter; left time: 125.0164s
Epoch: 2 cost time: 15.670958995819092
Epoch: 2, Steps: 1140 | Train Loss: 0.5906347 Vali Loss: 0.5884808 Test Loss: 0.2831683
Validation loss decreased (0.615993 --> 0.588481).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5667486
	speed: 0.0194s/iter; left time: 174.9625s
	iters: 200, epoch: 3 | loss: 0.4557485
	speed: 0.0161s/iter; left time: 143.3781s
	iters: 300, epoch: 3 | loss: 0.4988033
	speed: 0.0148s/iter; left time: 130.6091s
	iters: 400, epoch: 3 | loss: 0.5769608
	speed: 0.0163s/iter; left time: 142.5375s
	iters: 500, epoch: 3 | loss: 0.4878133
	speed: 0.0156s/iter; left time: 134.5900s
	iters: 600, epoch: 3 | loss: 0.7557096
	speed: 0.0151s/iter; left time: 128.8129s
	iters: 700, epoch: 3 | loss: 0.5126520
	speed: 0.0145s/iter; left time: 122.2173s
	iters: 800, epoch: 3 | loss: 0.4821300
	speed: 0.0149s/iter; left time: 123.6822s
	iters: 900, epoch: 3 | loss: 0.8152699
	speed: 0.0151s/iter; left time: 123.9624s
	iters: 1000, epoch: 3 | loss: 0.5090512
	speed: 0.0147s/iter; left time: 119.0086s
	iters: 1100, epoch: 3 | loss: 0.5280538
	speed: 0.0143s/iter; left time: 114.6905s
Epoch: 3 cost time: 16.377450942993164
Epoch: 3, Steps: 1140 | Train Loss: 0.5705114 Vali Loss: 0.6260303 Test Loss: 0.2921472
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4876150
	speed: 0.0173s/iter; left time: 136.4770s
	iters: 200, epoch: 4 | loss: 0.7762371
	speed: 0.0151s/iter; left time: 117.7396s
	iters: 300, epoch: 4 | loss: 0.4138358
	speed: 0.0146s/iter; left time: 112.1328s
	iters: 400, epoch: 4 | loss: 0.4982970
	speed: 0.0146s/iter; left time: 110.6078s
	iters: 500, epoch: 4 | loss: 0.5010650
	speed: 0.0144s/iter; left time: 107.7288s
	iters: 600, epoch: 4 | loss: 0.8574366
	speed: 0.0144s/iter; left time: 105.9303s
	iters: 700, epoch: 4 | loss: 0.4049715
	speed: 0.0143s/iter; left time: 104.2136s
	iters: 800, epoch: 4 | loss: 0.4531820
	speed: 0.0143s/iter; left time: 102.6318s
	iters: 900, epoch: 4 | loss: 0.3946096
	speed: 0.0142s/iter; left time: 100.4861s
	iters: 1000, epoch: 4 | loss: 0.5513687
	speed: 0.0141s/iter; left time: 98.2462s
	iters: 1100, epoch: 4 | loss: 0.6387138
	speed: 0.0143s/iter; left time: 98.7318s
Epoch: 4 cost time: 16.767616748809814
Epoch: 4, Steps: 1140 | Train Loss: 0.5614891 Vali Loss: 0.5868571 Test Loss: 0.2796639
Validation loss decreased (0.588481 --> 0.586857).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5314864
	speed: 0.0154s/iter; left time: 104.0052s
	iters: 200, epoch: 5 | loss: 0.5255848
	speed: 0.0154s/iter; left time: 102.5638s
	iters: 300, epoch: 5 | loss: 0.5232154
	speed: 0.0156s/iter; left time: 101.7600s
	iters: 400, epoch: 5 | loss: 0.5122194
	speed: 0.0150s/iter; left time: 96.4793s
	iters: 500, epoch: 5 | loss: 0.6245847
	speed: 0.0150s/iter; left time: 95.3272s
	iters: 600, epoch: 5 | loss: 0.4987429
	speed: 0.0147s/iter; left time: 91.5133s
	iters: 700, epoch: 5 | loss: 1.0578015
	speed: 0.0144s/iter; left time: 88.3370s
	iters: 800, epoch: 5 | loss: 0.7330677
	speed: 0.0142s/iter; left time: 85.5231s
	iters: 900, epoch: 5 | loss: 0.5266725
	speed: 0.0141s/iter; left time: 83.9515s
	iters: 1000, epoch: 5 | loss: 0.7200091
	speed: 0.0139s/iter; left time: 81.2899s
	iters: 1100, epoch: 5 | loss: 0.4262807
	speed: 0.0140s/iter; left time: 80.5471s
Epoch: 5 cost time: 15.953033685684204
Epoch: 5, Steps: 1140 | Train Loss: 0.5531721 Vali Loss: 0.5827615 Test Loss: 0.2789969
Validation loss decreased (0.586857 --> 0.582761).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3737401
	speed: 0.0229s/iter; left time: 128.2291s
	iters: 200, epoch: 6 | loss: 0.5436397
	speed: 0.0172s/iter; left time: 94.5642s
	iters: 300, epoch: 6 | loss: 0.4457523
	speed: 0.0159s/iter; left time: 85.6120s
	iters: 400, epoch: 6 | loss: 0.7861813
	speed: 0.0152s/iter; left time: 80.6437s
	iters: 500, epoch: 6 | loss: 0.5236093
	speed: 0.0155s/iter; left time: 80.6161s
	iters: 600, epoch: 6 | loss: 0.4425338
	speed: 0.0153s/iter; left time: 77.9731s
	iters: 700, epoch: 6 | loss: 0.4720724
	speed: 0.0150s/iter; left time: 75.2074s
	iters: 800, epoch: 6 | loss: 0.4289798
	speed: 0.0149s/iter; left time: 73.0123s
	iters: 900, epoch: 6 | loss: 0.6923784
	speed: 0.0148s/iter; left time: 70.9963s
	iters: 1000, epoch: 6 | loss: 0.4588663
	speed: 0.0148s/iter; left time: 69.5584s
	iters: 1100, epoch: 6 | loss: 0.3808202
	speed: 0.0148s/iter; left time: 67.9433s
Epoch: 6 cost time: 16.943729639053345
Epoch: 6, Steps: 1140 | Train Loss: 0.5493482 Vali Loss: 0.5847653 Test Loss: 0.2787524
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.6884305
	speed: 0.0181s/iter; left time: 80.6945s
	iters: 200, epoch: 7 | loss: 0.4392147
	speed: 0.0160s/iter; left time: 69.7156s
	iters: 300, epoch: 7 | loss: 0.3879852
	speed: 0.0165s/iter; left time: 70.1666s
	iters: 400, epoch: 7 | loss: 0.7211804
	speed: 0.0157s/iter; left time: 65.4695s
	iters: 500, epoch: 7 | loss: 0.5087491
	speed: 0.0152s/iter; left time: 61.6913s
	iters: 600, epoch: 7 | loss: 0.7144053
	speed: 0.0151s/iter; left time: 59.9550s
	iters: 700, epoch: 7 | loss: 0.5915882
	speed: 0.0150s/iter; left time: 57.9953s
	iters: 800, epoch: 7 | loss: 0.4786804
	speed: 0.0148s/iter; left time: 55.7735s
	iters: 900, epoch: 7 | loss: 0.4198341
	speed: 0.0147s/iter; left time: 53.6663s
	iters: 1000, epoch: 7 | loss: 0.5801430
	speed: 0.0146s/iter; left time: 51.8682s
	iters: 1100, epoch: 7 | loss: 0.4898331
	speed: 0.0143s/iter; left time: 49.3290s
Epoch: 7 cost time: 16.24453616142273
Epoch: 7, Steps: 1140 | Train Loss: 0.5472521 Vali Loss: 0.5840095 Test Loss: 0.2788730
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.7914634
	speed: 0.0159s/iter; left time: 52.6509s
	iters: 200, epoch: 8 | loss: 0.5853997
	speed: 0.0149s/iter; left time: 47.8933s
	iters: 300, epoch: 8 | loss: 0.7997459
	speed: 0.0145s/iter; left time: 45.3684s
	iters: 400, epoch: 8 | loss: 0.4757748
	speed: 0.0154s/iter; left time: 46.6332s
	iters: 500, epoch: 8 | loss: 0.5059374
	speed: 0.0153s/iter; left time: 44.7670s
	iters: 600, epoch: 8 | loss: 0.4861766
	speed: 0.0152s/iter; left time: 42.8979s
	iters: 700, epoch: 8 | loss: 0.4976477
	speed: 0.0153s/iter; left time: 41.4966s
	iters: 800, epoch: 8 | loss: 0.4071085
	speed: 0.0147s/iter; left time: 38.5808s
	iters: 900, epoch: 8 | loss: 0.4306995
	speed: 0.0146s/iter; left time: 36.8378s
	iters: 1000, epoch: 8 | loss: 0.4101533
	speed: 0.0147s/iter; left time: 35.6386s
	iters: 1100, epoch: 8 | loss: 0.4377277
	speed: 0.0147s/iter; left time: 34.0573s
Epoch: 8 cost time: 16.784929752349854
Epoch: 8, Steps: 1140 | Train Loss: 0.5465241 Vali Loss: 0.5847842 Test Loss: 0.2793176
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4975511
	speed: 0.0185s/iter; left time: 40.3271s
	iters: 200, epoch: 9 | loss: 0.5185981
	speed: 0.0164s/iter; left time: 34.1898s
	iters: 300, epoch: 9 | loss: 0.6276746
	speed: 0.0166s/iter; left time: 32.9127s
	iters: 400, epoch: 9 | loss: 0.5629971
	speed: 0.0158s/iter; left time: 29.6582s
	iters: 500, epoch: 9 | loss: 0.4644856
	speed: 0.0150s/iter; left time: 26.6616s
	iters: 600, epoch: 9 | loss: 0.8647965
	speed: 0.0148s/iter; left time: 24.9515s
	iters: 700, epoch: 9 | loss: 0.6911245
	speed: 0.0148s/iter; left time: 23.4125s
	iters: 800, epoch: 9 | loss: 0.7054693
	speed: 0.0146s/iter; left time: 21.5669s
	iters: 900, epoch: 9 | loss: 0.4099592
	speed: 0.0144s/iter; left time: 19.8469s
	iters: 1000, epoch: 9 | loss: 0.6837142
	speed: 0.0143s/iter; left time: 18.2775s
	iters: 1100, epoch: 9 | loss: 0.3822831
	speed: 0.0143s/iter; left time: 16.8987s
Epoch: 9 cost time: 16.470816135406494
Epoch: 9, Steps: 1140 | Train Loss: 0.5458825 Vali Loss: 0.5848821 Test Loss: 0.2794827
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.5166037
	speed: 0.0176s/iter; left time: 18.3600s
	iters: 200, epoch: 10 | loss: 0.5655346
	speed: 0.0160s/iter; left time: 15.0308s
	iters: 300, epoch: 10 | loss: 0.4547427
	speed: 0.0153s/iter; left time: 12.8363s
	iters: 400, epoch: 10 | loss: 0.5040491
	speed: 0.0149s/iter; left time: 11.0446s
	iters: 500, epoch: 10 | loss: 0.4664896
	speed: 0.0151s/iter; left time: 9.6893s
	iters: 600, epoch: 10 | loss: 0.4945368
	speed: 0.0149s/iter; left time: 8.0453s
	iters: 700, epoch: 10 | loss: 0.4096054
	speed: 0.0146s/iter; left time: 6.4408s
	iters: 800, epoch: 10 | loss: 0.4136617
	speed: 0.0147s/iter; left time: 5.0154s
	iters: 900, epoch: 10 | loss: 0.6553500
	speed: 0.0146s/iter; left time: 3.5068s
	iters: 1000, epoch: 10 | loss: 0.5545897
	speed: 0.0144s/iter; left time: 2.0275s
	iters: 1100, epoch: 10 | loss: 0.5364719
	speed: 0.0144s/iter; left time: 0.5910s
Epoch: 10 cost time: 16.487679481506348
Epoch: 10, Steps: 1140 | Train Loss: 0.5452618 Vali Loss: 0.5839151 Test Loss: 0.2793972
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.27899691462516785, mae:0.3013020157814026
Use GPU: cuda:0
no_skip True
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.6185020
	speed: 0.0162s/iter; left time: 183.4549s
	iters: 200, epoch: 1 | loss: 0.9533070
	speed: 0.0132s/iter; left time: 147.7575s
	iters: 300, epoch: 1 | loss: 0.8722434
	speed: 0.0125s/iter; left time: 138.6337s
	iters: 400, epoch: 1 | loss: 0.6380100
	speed: 0.0123s/iter; left time: 135.6091s
	iters: 500, epoch: 1 | loss: 0.5461313
	speed: 0.0123s/iter; left time: 133.7538s
	iters: 600, epoch: 1 | loss: 0.4851659
	speed: 0.0119s/iter; left time: 128.0878s
	iters: 700, epoch: 1 | loss: 0.5441548
	speed: 0.0119s/iter; left time: 127.3236s
	iters: 800, epoch: 1 | loss: 0.5724486
	speed: 0.0119s/iter; left time: 126.6788s
	iters: 900, epoch: 1 | loss: 0.5241880
	speed: 0.0123s/iter; left time: 129.3835s
	iters: 1000, epoch: 1 | loss: 0.4622336
	speed: 0.0125s/iter; left time: 129.6687s
	iters: 1100, epoch: 1 | loss: 0.5014696
	speed: 0.0124s/iter; left time: 127.2340s
Epoch: 1 cost time: 14.351884603500366
Epoch: 1, Steps: 1140 | Train Loss: 0.6604219 Vali Loss: 0.6157493 Test Loss: 0.2877339
Validation loss decreased (inf --> 0.615749).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4726352
	speed: 0.0259s/iter; left time: 262.7072s
	iters: 200, epoch: 2 | loss: 0.4883942
	speed: 0.0196s/iter; left time: 196.7163s
	iters: 300, epoch: 2 | loss: 0.4455070
	speed: 0.0172s/iter; left time: 171.1374s
	iters: 400, epoch: 2 | loss: 0.5621368
	speed: 0.0166s/iter; left time: 163.7455s
	iters: 500, epoch: 2 | loss: 0.5290452
	speed: 0.0164s/iter; left time: 159.9578s
	iters: 600, epoch: 2 | loss: 0.4345844
	speed: 0.0160s/iter; left time: 154.9213s
	iters: 700, epoch: 2 | loss: 0.5300832
	speed: 0.0157s/iter; left time: 150.3171s
	iters: 800, epoch: 2 | loss: 0.5961491
	speed: 0.0156s/iter; left time: 147.1831s
	iters: 900, epoch: 2 | loss: 0.5533304
	speed: 0.0162s/iter; left time: 151.3240s
	iters: 1000, epoch: 2 | loss: 0.4981550
	speed: 0.0161s/iter; left time: 148.7746s
	iters: 1100, epoch: 2 | loss: 0.9914385
	speed: 0.0159s/iter; left time: 145.5878s
Epoch: 2 cost time: 18.172189235687256
Epoch: 2, Steps: 1140 | Train Loss: 0.5914637 Vali Loss: 0.5927354 Test Loss: 0.2829807
Validation loss decreased (0.615749 --> 0.592735).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6855976
	speed: 0.0186s/iter; left time: 167.4823s
	iters: 200, epoch: 3 | loss: 0.5010396
	speed: 0.0158s/iter; left time: 140.9794s
	iters: 300, epoch: 3 | loss: 0.4407087
	speed: 0.0147s/iter; left time: 129.8736s
	iters: 400, epoch: 3 | loss: 0.5347459
	speed: 0.0145s/iter; left time: 126.3591s
	iters: 500, epoch: 3 | loss: 0.4487838
	speed: 0.0148s/iter; left time: 127.6896s
	iters: 600, epoch: 3 | loss: 0.4944076
	speed: 0.0148s/iter; left time: 125.8204s
	iters: 700, epoch: 3 | loss: 0.8258450
	speed: 0.0146s/iter; left time: 122.6318s
	iters: 800, epoch: 3 | loss: 0.5356497
	speed: 0.0142s/iter; left time: 118.2202s
	iters: 900, epoch: 3 | loss: 0.5274785
	speed: 0.0143s/iter; left time: 117.4995s
	iters: 1000, epoch: 3 | loss: 0.4999577
	speed: 0.0144s/iter; left time: 116.6298s
	iters: 1100, epoch: 3 | loss: 0.7240418
	speed: 0.0142s/iter; left time: 114.0717s
Epoch: 3 cost time: 16.2498197555542
Epoch: 3, Steps: 1140 | Train Loss: 0.5723390 Vali Loss: 0.5866568 Test Loss: 0.2803594
Validation loss decreased (0.592735 --> 0.586657).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.7415465
	speed: 0.0224s/iter; left time: 176.8249s
	iters: 200, epoch: 4 | loss: 0.4910254
	speed: 0.0181s/iter; left time: 140.8521s
	iters: 300, epoch: 4 | loss: 0.4927635
	speed: 0.0164s/iter; left time: 126.0153s
	iters: 400, epoch: 4 | loss: 0.4953705
	speed: 0.0156s/iter; left time: 118.1108s
	iters: 500, epoch: 4 | loss: 0.4256896
	speed: 0.0156s/iter; left time: 116.4629s
	iters: 600, epoch: 4 | loss: 0.4884262
	speed: 0.0154s/iter; left time: 113.9324s
	iters: 700, epoch: 4 | loss: 0.6850114
	speed: 0.0149s/iter; left time: 108.8423s
	iters: 800, epoch: 4 | loss: 0.5260118
	speed: 0.0148s/iter; left time: 106.0766s
	iters: 900, epoch: 4 | loss: 0.6738156
	speed: 0.0149s/iter; left time: 105.5312s
	iters: 1000, epoch: 4 | loss: 0.4607950
	speed: 0.0149s/iter; left time: 103.9709s
	iters: 1100, epoch: 4 | loss: 0.5043150
	speed: 0.0146s/iter; left time: 100.6252s
Epoch: 4 cost time: 16.66657257080078
Epoch: 4, Steps: 1140 | Train Loss: 0.5622019 Vali Loss: 0.5802829 Test Loss: 0.2793034
Validation loss decreased (0.586657 --> 0.580283).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5942102
	speed: 0.0191s/iter; left time: 128.4990s
	iters: 200, epoch: 5 | loss: 0.4660381
	speed: 0.0162s/iter; left time: 107.8879s
	iters: 300, epoch: 5 | loss: 0.5378539
	speed: 0.0153s/iter; left time: 100.3334s
	iters: 400, epoch: 5 | loss: 0.4649784
	speed: 0.0146s/iter; left time: 94.3507s
	iters: 500, epoch: 5 | loss: 0.7662409
	speed: 0.0145s/iter; left time: 91.8370s
	iters: 600, epoch: 5 | loss: 0.5576155
	speed: 0.0144s/iter; left time: 89.8801s
	iters: 700, epoch: 5 | loss: 0.4852208
	speed: 0.0150s/iter; left time: 92.1359s
	iters: 800, epoch: 5 | loss: 0.5041680
	speed: 0.0148s/iter; left time: 89.1572s
	iters: 900, epoch: 5 | loss: 0.8776650
	speed: 0.0145s/iter; left time: 86.2561s
	iters: 1000, epoch: 5 | loss: 0.4925123
	speed: 0.0143s/iter; left time: 83.4979s
	iters: 1100, epoch: 5 | loss: 0.7142391
	speed: 0.0141s/iter; left time: 81.0457s
Epoch: 5 cost time: 16.21360468864441
Epoch: 5, Steps: 1140 | Train Loss: 0.5553416 Vali Loss: 0.5742917 Test Loss: 0.2786147
Validation loss decreased (0.580283 --> 0.574292).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8131134
	speed: 0.0177s/iter; left time: 98.9508s
	iters: 200, epoch: 6 | loss: 0.5130237
	speed: 0.0172s/iter; left time: 94.8466s
	iters: 300, epoch: 6 | loss: 0.7410231
	speed: 0.0166s/iter; left time: 89.4148s
	iters: 400, epoch: 6 | loss: 0.5068871
	speed: 0.0177s/iter; left time: 93.7312s
	iters: 500, epoch: 6 | loss: 0.4837572
	speed: 0.0165s/iter; left time: 85.7097s
	iters: 600, epoch: 6 | loss: 0.4341824
	speed: 0.0157s/iter; left time: 80.2917s
	iters: 700, epoch: 6 | loss: 0.4435823
	speed: 0.0162s/iter; left time: 80.8848s
	iters: 800, epoch: 6 | loss: 0.5512757
	speed: 0.0161s/iter; left time: 78.7534s
	iters: 900, epoch: 6 | loss: 0.4729724
	speed: 0.0158s/iter; left time: 76.0302s
	iters: 1000, epoch: 6 | loss: 0.4855775
	speed: 0.0157s/iter; left time: 73.9523s
	iters: 1100, epoch: 6 | loss: 0.7857836
	speed: 0.0156s/iter; left time: 71.8438s
Epoch: 6 cost time: 17.89881730079651
Epoch: 6, Steps: 1140 | Train Loss: 0.5514479 Vali Loss: 0.5756496 Test Loss: 0.2787295
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4395083
	speed: 0.0195s/iter; left time: 86.7768s
	iters: 200, epoch: 7 | loss: 0.4886577
	speed: 0.0163s/iter; left time: 71.0675s
	iters: 300, epoch: 7 | loss: 0.5652565
	speed: 0.0155s/iter; left time: 66.1780s
	iters: 400, epoch: 7 | loss: 0.4386774
	speed: 0.0153s/iter; left time: 63.6076s
	iters: 500, epoch: 7 | loss: 0.6801627
	speed: 0.0152s/iter; left time: 61.8434s
	iters: 600, epoch: 7 | loss: 0.4517920
	speed: 0.0148s/iter; left time: 58.8065s
	iters: 700, epoch: 7 | loss: 0.7739309
	speed: 0.0146s/iter; left time: 56.4577s
	iters: 800, epoch: 7 | loss: 0.4287564
	speed: 0.0148s/iter; left time: 55.4848s
	iters: 900, epoch: 7 | loss: 0.4919619
	speed: 0.0144s/iter; left time: 52.7409s
	iters: 1000, epoch: 7 | loss: 0.4797776
	speed: 0.0142s/iter; left time: 50.4941s
	iters: 1100, epoch: 7 | loss: 0.4871922
	speed: 0.0142s/iter; left time: 49.1071s
Epoch: 7 cost time: 16.223949670791626
Epoch: 7, Steps: 1140 | Train Loss: 0.5494264 Vali Loss: 0.5770585 Test Loss: 0.2788927
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4301732
	speed: 0.0257s/iter; left time: 85.5118s
	iters: 200, epoch: 8 | loss: 0.5412260
	speed: 0.0197s/iter; left time: 63.3780s
	iters: 300, epoch: 8 | loss: 0.4529831
	speed: 0.0180s/iter; left time: 56.2654s
	iters: 400, epoch: 8 | loss: 0.4734595
	speed: 0.0172s/iter; left time: 51.9464s
	iters: 500, epoch: 8 | loss: 0.5340250
	speed: 0.0166s/iter; left time: 48.5912s
	iters: 600, epoch: 8 | loss: 0.5374786
	speed: 0.0157s/iter; left time: 44.2171s
	iters: 700, epoch: 8 | loss: 0.5694063
	speed: 0.0154s/iter; left time: 42.0241s
	iters: 800, epoch: 8 | loss: 0.4071161
	speed: 0.0153s/iter; left time: 40.2106s
	iters: 900, epoch: 8 | loss: 0.5111376
	speed: 0.0152s/iter; left time: 38.4242s
	iters: 1000, epoch: 8 | loss: 0.4021789
	speed: 0.0151s/iter; left time: 36.4946s
	iters: 1100, epoch: 8 | loss: 0.4100973
	speed: 0.0149s/iter; left time: 34.6143s
Epoch: 8 cost time: 17.03855299949646
Epoch: 8, Steps: 1140 | Train Loss: 0.5483805 Vali Loss: 0.5773580 Test Loss: 0.2792863
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.7840410
	speed: 0.0135s/iter; left time: 29.3480s
	iters: 200, epoch: 9 | loss: 0.7112069
	speed: 0.0148s/iter; left time: 30.7938s
	iters: 300, epoch: 9 | loss: 0.7456707
	speed: 0.0146s/iter; left time: 28.8423s
	iters: 400, epoch: 9 | loss: 0.5744853
	speed: 0.0143s/iter; left time: 26.9730s
	iters: 500, epoch: 9 | loss: 0.4345917
	speed: 0.0143s/iter; left time: 25.4364s
	iters: 600, epoch: 9 | loss: 0.9908914
	speed: 0.0142s/iter; left time: 23.8489s
	iters: 700, epoch: 9 | loss: 0.3796564
	speed: 0.0142s/iter; left time: 22.5014s
	iters: 800, epoch: 9 | loss: 0.3673007
	speed: 0.0143s/iter; left time: 21.1512s
	iters: 900, epoch: 9 | loss: 0.6780730
	speed: 0.0148s/iter; left time: 20.4033s
	iters: 1000, epoch: 9 | loss: 0.6429644
	speed: 0.0147s/iter; left time: 18.8547s
	iters: 1100, epoch: 9 | loss: 0.5260326
	speed: 0.0147s/iter; left time: 17.3181s
Epoch: 9 cost time: 16.931478023529053
Epoch: 9, Steps: 1140 | Train Loss: 0.5479520 Vali Loss: 0.5777260 Test Loss: 0.2791535
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.4901637
	speed: 0.0183s/iter; left time: 19.0693s
	iters: 200, epoch: 10 | loss: 0.8409876
	speed: 0.0185s/iter; left time: 17.4384s
	iters: 300, epoch: 10 | loss: 0.4268973
	speed: 0.0163s/iter; left time: 13.7067s
	iters: 400, epoch: 10 | loss: 0.4113100
	speed: 0.0159s/iter; left time: 11.7763s
	iters: 500, epoch: 10 | loss: 0.7019179
	speed: 0.0158s/iter; left time: 10.1277s
	iters: 600, epoch: 10 | loss: 0.7479134
	speed: 0.0158s/iter; left time: 8.5588s
	iters: 700, epoch: 10 | loss: 0.5193352
	speed: 0.0154s/iter; left time: 6.8000s
	iters: 800, epoch: 10 | loss: 0.4460113
	speed: 0.0154s/iter; left time: 5.2637s
	iters: 900, epoch: 10 | loss: 0.4402585
	speed: 0.0154s/iter; left time: 3.7211s
	iters: 1000, epoch: 10 | loss: 0.4761662
	speed: 0.0153s/iter; left time: 2.1530s
	iters: 1100, epoch: 10 | loss: 0.4370597
	speed: 0.0153s/iter; left time: 0.6291s
Epoch: 10 cost time: 17.61404037475586
Epoch: 10, Steps: 1140 | Train Loss: 0.5483452 Vali Loss: 0.5757449 Test Loss: 0.2790520
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.27861472964286804, mae:0.3009893596172333
Use GPU: cuda:0
no_skip True
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.8491975
	speed: 0.0158s/iter; left time: 179.0068s
	iters: 200, epoch: 1 | loss: 0.6237678
	speed: 0.0151s/iter; left time: 169.0988s
	iters: 300, epoch: 1 | loss: 0.5889981
	speed: 0.0139s/iter; left time: 154.0301s
	iters: 400, epoch: 1 | loss: 0.5282557
	speed: 0.0147s/iter; left time: 161.5453s
	iters: 500, epoch: 1 | loss: 0.7820034
	speed: 0.0152s/iter; left time: 165.2612s
	iters: 600, epoch: 1 | loss: 0.6068184
	speed: 0.0147s/iter; left time: 158.7632s
	iters: 700, epoch: 1 | loss: 0.6261759
	speed: 0.0141s/iter; left time: 151.0478s
	iters: 800, epoch: 1 | loss: 0.8650472
	speed: 0.0141s/iter; left time: 149.9454s
	iters: 900, epoch: 1 | loss: 0.5239297
	speed: 0.0145s/iter; left time: 152.3283s
	iters: 1000, epoch: 1 | loss: 0.5406310
	speed: 0.0143s/iter; left time: 149.1283s
	iters: 1100, epoch: 1 | loss: 1.1558175
	speed: 0.0145s/iter; left time: 148.9707s
Epoch: 1 cost time: 16.867523670196533
Epoch: 1, Steps: 1140 | Train Loss: 0.6494776 Vali Loss: 0.6293446 Test Loss: 0.2879232
Validation loss decreased (inf --> 0.629345).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4540649
	speed: 0.0160s/iter; left time: 162.7682s
	iters: 200, epoch: 2 | loss: 0.7139243
	speed: 0.0150s/iter; left time: 151.2825s
	iters: 300, epoch: 2 | loss: 0.5029163
	speed: 0.0153s/iter; left time: 152.6985s
	iters: 400, epoch: 2 | loss: 0.4391888
	speed: 0.0149s/iter; left time: 147.0395s
	iters: 500, epoch: 2 | loss: 0.4594896
	speed: 0.0144s/iter; left time: 140.8629s
	iters: 600, epoch: 2 | loss: 0.4514977
	speed: 0.0145s/iter; left time: 139.9036s
	iters: 700, epoch: 2 | loss: 0.4600075
	speed: 0.0145s/iter; left time: 138.7124s
	iters: 800, epoch: 2 | loss: 0.5254997
	speed: 0.0149s/iter; left time: 140.9066s
	iters: 900, epoch: 2 | loss: 0.7317666
	speed: 0.0145s/iter; left time: 135.5938s
	iters: 1000, epoch: 2 | loss: 0.4654668
	speed: 0.0145s/iter; left time: 134.1034s
	iters: 1100, epoch: 2 | loss: 0.6076505
	speed: 0.0145s/iter; left time: 132.7777s
Epoch: 2 cost time: 16.82482647895813
Epoch: 2, Steps: 1140 | Train Loss: 0.5899361 Vali Loss: 0.6030599 Test Loss: 0.2845749
Validation loss decreased (0.629345 --> 0.603060).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4969716
	speed: 0.0189s/iter; left time: 170.9134s
	iters: 200, epoch: 3 | loss: 0.6544080
	speed: 0.0157s/iter; left time: 139.9575s
	iters: 300, epoch: 3 | loss: 0.4024685
	speed: 0.0145s/iter; left time: 128.1330s
	iters: 400, epoch: 3 | loss: 0.4338453
	speed: 0.0142s/iter; left time: 123.9105s
	iters: 500, epoch: 3 | loss: 0.6328505
	speed: 0.0141s/iter; left time: 121.2803s
	iters: 600, epoch: 3 | loss: 0.6526556
	speed: 0.0137s/iter; left time: 116.5210s
	iters: 700, epoch: 3 | loss: 0.4374585
	speed: 0.0136s/iter; left time: 114.7822s
	iters: 800, epoch: 3 | loss: 0.7040542
	speed: 0.0138s/iter; left time: 114.6012s
	iters: 900, epoch: 3 | loss: 0.4720484
	speed: 0.0139s/iter; left time: 114.4180s
	iters: 1000, epoch: 3 | loss: 0.5628867
	speed: 0.0138s/iter; left time: 111.6980s
	iters: 1100, epoch: 3 | loss: 0.5174198
	speed: 0.0139s/iter; left time: 111.8512s
Epoch: 3 cost time: 16.056134939193726
Epoch: 3, Steps: 1140 | Train Loss: 0.5712461 Vali Loss: 0.5875784 Test Loss: 0.2812764
Validation loss decreased (0.603060 --> 0.587578).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.9022633
	speed: 0.0165s/iter; left time: 130.1958s
	iters: 200, epoch: 4 | loss: 0.7362025
	speed: 0.0142s/iter; left time: 110.5846s
	iters: 300, epoch: 4 | loss: 0.5610076
	speed: 0.0138s/iter; left time: 105.9433s
	iters: 400, epoch: 4 | loss: 0.4684347
	speed: 0.0145s/iter; left time: 110.2453s
	iters: 500, epoch: 4 | loss: 0.3956129
	speed: 0.0143s/iter; left time: 106.6631s
	iters: 600, epoch: 4 | loss: 0.6187284
	speed: 0.0140s/iter; left time: 103.0870s
	iters: 700, epoch: 4 | loss: 0.7607287
	speed: 0.0136s/iter; left time: 99.3752s
	iters: 800, epoch: 4 | loss: 0.5807872
	speed: 0.0135s/iter; left time: 96.7047s
	iters: 900, epoch: 4 | loss: 0.4276113
	speed: 0.0134s/iter; left time: 94.6936s
	iters: 1000, epoch: 4 | loss: 0.4724379
	speed: 0.0135s/iter; left time: 94.1483s
	iters: 1100, epoch: 4 | loss: 0.5275802
	speed: 0.0135s/iter; left time: 93.1975s
Epoch: 4 cost time: 15.506128549575806
Epoch: 4, Steps: 1140 | Train Loss: 0.5601022 Vali Loss: 0.5842987 Test Loss: 0.2811646
Validation loss decreased (0.587578 --> 0.584299).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.8025281
	speed: 0.0217s/iter; left time: 145.9681s
	iters: 200, epoch: 5 | loss: 0.4876716
	speed: 0.0176s/iter; left time: 117.0364s
	iters: 300, epoch: 5 | loss: 0.3676100
	speed: 0.0163s/iter; left time: 106.4847s
	iters: 400, epoch: 5 | loss: 0.4294683
	speed: 0.0164s/iter; left time: 105.9140s
	iters: 500, epoch: 5 | loss: 0.4043694
	speed: 0.0159s/iter; left time: 100.7132s
	iters: 600, epoch: 5 | loss: 0.7798956
	speed: 0.0157s/iter; left time: 97.7604s
	iters: 700, epoch: 5 | loss: 0.5513810
	speed: 0.0151s/iter; left time: 92.8542s
	iters: 800, epoch: 5 | loss: 0.4985921
	speed: 0.0150s/iter; left time: 90.8315s
	iters: 900, epoch: 5 | loss: 0.7136626
	speed: 0.0151s/iter; left time: 89.7892s
	iters: 1000, epoch: 5 | loss: 0.5393895
	speed: 0.0148s/iter; left time: 86.7334s
	iters: 1100, epoch: 5 | loss: 0.5237000
	speed: 0.0146s/iter; left time: 83.5388s
Epoch: 5 cost time: 16.674518585205078
Epoch: 5, Steps: 1140 | Train Loss: 0.5532619 Vali Loss: 0.5813334 Test Loss: 0.2801907
Validation loss decreased (0.584299 --> 0.581333).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4395754
	speed: 0.0184s/iter; left time: 103.1206s
	iters: 200, epoch: 6 | loss: 0.3569829
	speed: 0.0155s/iter; left time: 85.3800s
	iters: 300, epoch: 6 | loss: 0.4322127
	speed: 0.0153s/iter; left time: 82.6789s
	iters: 400, epoch: 6 | loss: 0.5165727
	speed: 0.0152s/iter; left time: 80.6813s
	iters: 500, epoch: 6 | loss: 0.3895981
	speed: 0.0149s/iter; left time: 77.4699s
	iters: 600, epoch: 6 | loss: 0.7073021
	speed: 0.0161s/iter; left time: 82.0222s
	iters: 700, epoch: 6 | loss: 0.5385637
	speed: 0.0155s/iter; left time: 77.5883s
	iters: 800, epoch: 6 | loss: 0.4297038
	speed: 0.0152s/iter; left time: 74.3545s
	iters: 900, epoch: 6 | loss: 0.4093209
	speed: 0.0150s/iter; left time: 71.7940s
	iters: 1000, epoch: 6 | loss: 0.7225667
	speed: 0.0149s/iter; left time: 69.8729s
	iters: 1100, epoch: 6 | loss: 0.3908279
	speed: 0.0148s/iter; left time: 68.2709s
Epoch: 6 cost time: 16.84050440788269
Epoch: 6, Steps: 1140 | Train Loss: 0.5491756 Vali Loss: 0.5822802 Test Loss: 0.2807103
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4988948
	speed: 0.0179s/iter; left time: 79.6358s
	iters: 200, epoch: 7 | loss: 0.3972617
	speed: 0.0180s/iter; left time: 78.2807s
	iters: 300, epoch: 7 | loss: 0.4668854
	speed: 0.0167s/iter; left time: 71.0127s
	iters: 400, epoch: 7 | loss: 0.4563353
	speed: 0.0159s/iter; left time: 66.3547s
	iters: 500, epoch: 7 | loss: 0.6464190
	speed: 0.0155s/iter; left time: 62.9075s
	iters: 600, epoch: 7 | loss: 0.9883401
	speed: 0.0153s/iter; left time: 60.5070s
	iters: 700, epoch: 7 | loss: 0.4478021
	speed: 0.0148s/iter; left time: 57.3123s
	iters: 800, epoch: 7 | loss: 0.7606997
	speed: 0.0147s/iter; left time: 55.4241s
	iters: 900, epoch: 7 | loss: 0.4725316
	speed: 0.0145s/iter; left time: 52.9321s
	iters: 1000, epoch: 7 | loss: 0.3735628
	speed: 0.0142s/iter; left time: 50.6194s
	iters: 1100, epoch: 7 | loss: 0.5189532
	speed: 0.0140s/iter; left time: 48.3186s
Epoch: 7 cost time: 16.007211923599243
Epoch: 7, Steps: 1140 | Train Loss: 0.5475601 Vali Loss: 0.5836177 Test Loss: 0.2811112
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4619951
	speed: 0.0168s/iter; left time: 55.7187s
	iters: 200, epoch: 8 | loss: 0.4341215
	speed: 0.0159s/iter; left time: 51.3054s
	iters: 300, epoch: 8 | loss: 0.5323277
	speed: 0.0159s/iter; left time: 49.7324s
	iters: 400, epoch: 8 | loss: 0.9244774
	speed: 0.0154s/iter; left time: 46.3910s
	iters: 500, epoch: 8 | loss: 0.4416834
	speed: 0.0152s/iter; left time: 44.3088s
	iters: 600, epoch: 8 | loss: 0.4527008
	speed: 0.0151s/iter; left time: 42.6924s
	iters: 700, epoch: 8 | loss: 0.4668849
	speed: 0.0160s/iter; left time: 43.4305s
	iters: 800, epoch: 8 | loss: 0.8178753
	speed: 0.0156s/iter; left time: 40.8196s
	iters: 900, epoch: 8 | loss: 0.6328001
	speed: 0.0151s/iter; left time: 38.1122s
	iters: 1000, epoch: 8 | loss: 0.7501528
	speed: 0.0150s/iter; left time: 36.2150s
	iters: 1100, epoch: 8 | loss: 0.4524864
	speed: 0.0149s/iter; left time: 34.6533s
Epoch: 8 cost time: 17.14490270614624
Epoch: 8, Steps: 1140 | Train Loss: 0.5462917 Vali Loss: 0.5833502 Test Loss: 0.2807281
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.7402123
	speed: 0.0173s/iter; left time: 37.7855s
	iters: 200, epoch: 9 | loss: 0.4532453
	speed: 0.0154s/iter; left time: 32.0237s
	iters: 300, epoch: 9 | loss: 0.4259975
	speed: 0.0151s/iter; left time: 29.8852s
	iters: 400, epoch: 9 | loss: 0.3330615
	speed: 0.0144s/iter; left time: 27.1420s
	iters: 500, epoch: 9 | loss: 0.4564624
	speed: 0.0158s/iter; left time: 28.0907s
	iters: 600, epoch: 9 | loss: 0.4213094
	speed: 0.0154s/iter; left time: 25.8781s
	iters: 700, epoch: 9 | loss: 0.4386604
	speed: 0.0151s/iter; left time: 23.7984s
	iters: 800, epoch: 9 | loss: 0.5432749
	speed: 0.0153s/iter; left time: 22.7137s
	iters: 900, epoch: 9 | loss: 0.6684449
	speed: 0.0150s/iter; left time: 20.7231s
	iters: 1000, epoch: 9 | loss: 0.4414045
	speed: 0.0148s/iter; left time: 18.9973s
	iters: 1100, epoch: 9 | loss: 0.5116797
	speed: 0.0148s/iter; left time: 17.5130s
Epoch: 9 cost time: 16.866239070892334
Epoch: 9, Steps: 1140 | Train Loss: 0.5456954 Vali Loss: 0.5820674 Test Loss: 0.2809026
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.4681415
	speed: 0.0143s/iter; left time: 14.8574s
	iters: 200, epoch: 10 | loss: 0.6591362
	speed: 0.0131s/iter; left time: 12.3451s
	iters: 300, epoch: 10 | loss: 0.4563289
	speed: 0.0119s/iter; left time: 10.0247s
	iters: 400, epoch: 10 | loss: 0.4414602
	speed: 0.0118s/iter; left time: 8.7149s
	iters: 500, epoch: 10 | loss: 0.4918083
	speed: 0.0122s/iter; left time: 7.7965s
	iters: 600, epoch: 10 | loss: 0.5093875
	speed: 0.0122s/iter; left time: 6.5943s
	iters: 700, epoch: 10 | loss: 0.4888460
	speed: 0.0127s/iter; left time: 5.5943s
	iters: 800, epoch: 10 | loss: 0.4662445
	speed: 0.0128s/iter; left time: 4.3616s
	iters: 900, epoch: 10 | loss: 0.7768463
	speed: 0.0129s/iter; left time: 3.1182s
	iters: 1000, epoch: 10 | loss: 0.5499802
	speed: 0.0133s/iter; left time: 1.8805s
	iters: 1100, epoch: 10 | loss: 0.4717914
	speed: 0.0133s/iter; left time: 0.5442s
Epoch: 10 cost time: 15.445957660675049
Epoch: 10, Steps: 1140 | Train Loss: 0.5457540 Vali Loss: 0.5826825 Test Loss: 0.2812559
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.28019076585769653, mae:0.3023097515106201
Seed: 123
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_720      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip True
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.8482661
	speed: 0.0292s/iter; left time: 326.7493s
	iters: 200, epoch: 1 | loss: 0.9475121
	speed: 0.0222s/iter; left time: 245.8222s
	iters: 300, epoch: 1 | loss: 0.6350864
	speed: 0.0198s/iter; left time: 217.5342s
	iters: 400, epoch: 1 | loss: 0.7427793
	speed: 0.0185s/iter; left time: 200.8002s
	iters: 500, epoch: 1 | loss: 0.6158206
	speed: 0.0175s/iter; left time: 188.9567s
	iters: 600, epoch: 1 | loss: 0.6488889
	speed: 0.0168s/iter; left time: 179.6118s
	iters: 700, epoch: 1 | loss: 0.7300476
	speed: 0.0163s/iter; left time: 172.9055s
	iters: 800, epoch: 1 | loss: 0.5956336
	speed: 0.0162s/iter; left time: 169.6212s
	iters: 900, epoch: 1 | loss: 0.8631013
	speed: 0.0163s/iter; left time: 169.7122s
	iters: 1000, epoch: 1 | loss: 0.6538938
	speed: 0.0160s/iter; left time: 164.2164s
	iters: 1100, epoch: 1 | loss: 0.8820459
	speed: 0.0157s/iter; left time: 159.8068s
Epoch: 1 cost time: 17.721299648284912
Epoch: 1, Steps: 1128 | Train Loss: 0.7369179 Vali Loss: 0.7334041 Test Loss: 0.3599103
Validation loss decreased (inf --> 0.733404).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6801095
	speed: 0.0188s/iter; left time: 189.3158s
	iters: 200, epoch: 2 | loss: 0.6923258
	speed: 0.0170s/iter; left time: 169.6309s
	iters: 300, epoch: 2 | loss: 0.6736018
	speed: 0.0156s/iter; left time: 154.0900s
	iters: 400, epoch: 2 | loss: 0.5654275
	speed: 0.0150s/iter; left time: 146.0044s
	iters: 500, epoch: 2 | loss: 0.5652434
	speed: 0.0152s/iter; left time: 146.5048s
	iters: 600, epoch: 2 | loss: 0.6325052
	speed: 0.0151s/iter; left time: 143.9408s
	iters: 700, epoch: 2 | loss: 0.7233901
	speed: 0.0152s/iter; left time: 144.0950s
	iters: 800, epoch: 2 | loss: 0.6106135
	speed: 0.0149s/iter; left time: 139.5023s
	iters: 900, epoch: 2 | loss: 0.7046093
	speed: 0.0149s/iter; left time: 137.7608s
	iters: 1000, epoch: 2 | loss: 0.7090979
	speed: 0.0149s/iter; left time: 136.5361s
	iters: 1100, epoch: 2 | loss: 0.6863771
	speed: 0.0147s/iter; left time: 133.4684s
Epoch: 2 cost time: 16.71294355392456
Epoch: 2, Steps: 1128 | Train Loss: 0.6721051 Vali Loss: 0.7101651 Test Loss: 0.3566774
Validation loss decreased (0.733404 --> 0.710165).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6828019
	speed: 0.0168s/iter; left time: 150.2691s
	iters: 200, epoch: 3 | loss: 0.9059587
	speed: 0.0173s/iter; left time: 152.8246s
	iters: 300, epoch: 3 | loss: 0.8161594
	speed: 0.0164s/iter; left time: 142.7867s
	iters: 400, epoch: 3 | loss: 0.8113716
	speed: 0.0157s/iter; left time: 135.6363s
	iters: 500, epoch: 3 | loss: 0.5222913
	speed: 0.0147s/iter; left time: 125.0157s
	iters: 600, epoch: 3 | loss: 0.5326406
	speed: 0.0149s/iter; left time: 125.7590s
	iters: 700, epoch: 3 | loss: 0.7724847
	speed: 0.0149s/iter; left time: 124.0917s
	iters: 800, epoch: 3 | loss: 0.5808826
	speed: 0.0146s/iter; left time: 120.1216s
	iters: 900, epoch: 3 | loss: 0.5491474
	speed: 0.0146s/iter; left time: 118.2815s
	iters: 1000, epoch: 3 | loss: 0.4946891
	speed: 0.0148s/iter; left time: 118.4704s
	iters: 1100, epoch: 3 | loss: 0.7462806
	speed: 0.0147s/iter; left time: 116.7044s
Epoch: 3 cost time: 16.613168954849243
Epoch: 3, Steps: 1128 | Train Loss: 0.6540885 Vali Loss: 0.7117475 Test Loss: 0.3564115
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.9014594
	speed: 0.0194s/iter; left time: 151.6295s
	iters: 200, epoch: 4 | loss: 0.6082664
	speed: 0.0179s/iter; left time: 137.5130s
	iters: 300, epoch: 4 | loss: 0.6522145
	speed: 0.0171s/iter; left time: 130.2623s
	iters: 400, epoch: 4 | loss: 0.5735874
	speed: 0.0161s/iter; left time: 120.7308s
	iters: 500, epoch: 4 | loss: 0.8862485
	speed: 0.0162s/iter; left time: 120.0669s
	iters: 600, epoch: 4 | loss: 0.5998164
	speed: 0.0159s/iter; left time: 116.2728s
	iters: 700, epoch: 4 | loss: 0.6115065
	speed: 0.0159s/iter; left time: 114.1912s
	iters: 800, epoch: 4 | loss: 0.5101835
	speed: 0.0156s/iter; left time: 110.7852s
	iters: 900, epoch: 4 | loss: 0.5218883
	speed: 0.0151s/iter; left time: 105.4019s
	iters: 1000, epoch: 4 | loss: 0.7102098
	speed: 0.0148s/iter; left time: 102.3238s
	iters: 1100, epoch: 4 | loss: 0.5832842
	speed: 0.0148s/iter; left time: 100.5728s
Epoch: 4 cost time: 16.716084957122803
Epoch: 4, Steps: 1128 | Train Loss: 0.6431995 Vali Loss: 0.7074876 Test Loss: 0.3558817
Validation loss decreased (0.710165 --> 0.707488).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6438151
	speed: 0.0190s/iter; left time: 126.7349s
	iters: 200, epoch: 5 | loss: 0.5693383
	speed: 0.0184s/iter; left time: 120.9018s
	iters: 300, epoch: 5 | loss: 0.7393852
	speed: 0.0172s/iter; left time: 111.0477s
	iters: 400, epoch: 5 | loss: 0.6339939
	speed: 0.0163s/iter; left time: 103.5594s
	iters: 500, epoch: 5 | loss: 0.5632074
	speed: 0.0160s/iter; left time: 100.1280s
	iters: 600, epoch: 5 | loss: 0.5543130
	speed: 0.0156s/iter; left time: 96.3514s
	iters: 700, epoch: 5 | loss: 0.5686711
	speed: 0.0150s/iter; left time: 90.8464s
	iters: 800, epoch: 5 | loss: 0.6099816
	speed: 0.0147s/iter; left time: 87.8766s
	iters: 900, epoch: 5 | loss: 0.7412178
	speed: 0.0152s/iter; left time: 89.1826s
	iters: 1000, epoch: 5 | loss: 0.5900313
	speed: 0.0151s/iter; left time: 86.8254s
	iters: 1100, epoch: 5 | loss: 0.6849495
	speed: 0.0148s/iter; left time: 84.0047s
Epoch: 5 cost time: 16.912297010421753
Epoch: 5, Steps: 1128 | Train Loss: 0.6365126 Vali Loss: 0.7119396 Test Loss: 0.3562370
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5382422
	speed: 0.0188s/iter; left time: 104.1336s
	iters: 200, epoch: 6 | loss: 0.5615891
	speed: 0.0164s/iter; left time: 89.2844s
	iters: 300, epoch: 6 | loss: 0.6507878
	speed: 0.0153s/iter; left time: 81.6424s
	iters: 400, epoch: 6 | loss: 0.6974387
	speed: 0.0153s/iter; left time: 80.2079s
	iters: 500, epoch: 6 | loss: 0.6807133
	speed: 0.0153s/iter; left time: 78.5835s
	iters: 600, epoch: 6 | loss: 0.5272005
	speed: 0.0151s/iter; left time: 75.9338s
	iters: 700, epoch: 6 | loss: 0.5471532
	speed: 0.0148s/iter; left time: 73.2653s
	iters: 800, epoch: 6 | loss: 0.7772625
	speed: 0.0147s/iter; left time: 70.9520s
	iters: 900, epoch: 6 | loss: 0.4858536
	speed: 0.0149s/iter; left time: 70.6178s
	iters: 1000, epoch: 6 | loss: 0.5267425
	speed: 0.0149s/iter; left time: 69.0647s
	iters: 1100, epoch: 6 | loss: 0.8355271
	speed: 0.0147s/iter; left time: 66.6683s
Epoch: 6 cost time: 16.503795862197876
Epoch: 6, Steps: 1128 | Train Loss: 0.6323700 Vali Loss: 0.7129635 Test Loss: 0.3563649
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5056868
	speed: 0.0169s/iter; left time: 74.4984s
	iters: 200, epoch: 7 | loss: 0.7879964
	speed: 0.0144s/iter; left time: 62.0473s
	iters: 300, epoch: 7 | loss: 0.7148823
	speed: 0.0140s/iter; left time: 58.9248s
	iters: 400, epoch: 7 | loss: 0.4733339
	speed: 0.0148s/iter; left time: 60.7546s
	iters: 500, epoch: 7 | loss: 0.7891229
	speed: 0.0150s/iter; left time: 60.1270s
	iters: 600, epoch: 7 | loss: 0.5165709
	speed: 0.0147s/iter; left time: 57.6242s
	iters: 700, epoch: 7 | loss: 0.7000538
	speed: 0.0153s/iter; left time: 58.1511s
	iters: 800, epoch: 7 | loss: 0.7359405
	speed: 0.0153s/iter; left time: 56.9562s
	iters: 900, epoch: 7 | loss: 0.5249998
	speed: 0.0150s/iter; left time: 54.0867s
	iters: 1000, epoch: 7 | loss: 0.7873795
	speed: 0.0149s/iter; left time: 52.4654s
	iters: 1100, epoch: 7 | loss: 0.4954311
	speed: 0.0153s/iter; left time: 52.3110s
Epoch: 7 cost time: 17.349061489105225
Epoch: 7, Steps: 1128 | Train Loss: 0.6302684 Vali Loss: 0.7141415 Test Loss: 0.3561620
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.8738366
	speed: 0.0166s/iter; left time: 54.5885s
	iters: 200, epoch: 8 | loss: 0.6458088
	speed: 0.0150s/iter; left time: 47.8920s
	iters: 300, epoch: 8 | loss: 0.6033775
	speed: 0.0151s/iter; left time: 46.5816s
	iters: 400, epoch: 8 | loss: 0.5805656
	speed: 0.0149s/iter; left time: 44.3727s
	iters: 500, epoch: 8 | loss: 0.5067564
	speed: 0.0145s/iter; left time: 41.7178s
	iters: 600, epoch: 8 | loss: 0.5446079
	speed: 0.0144s/iter; left time: 40.0510s
	iters: 700, epoch: 8 | loss: 0.6915579
	speed: 0.0146s/iter; left time: 39.3103s
	iters: 800, epoch: 8 | loss: 0.8429206
	speed: 0.0147s/iter; left time: 38.0908s
	iters: 900, epoch: 8 | loss: 0.5888696
	speed: 0.0144s/iter; left time: 35.8687s
	iters: 1000, epoch: 8 | loss: 0.5534651
	speed: 0.0143s/iter; left time: 34.1931s
	iters: 1100, epoch: 8 | loss: 0.5267869
	speed: 0.0145s/iter; left time: 33.2230s
Epoch: 8 cost time: 16.51590394973755
Epoch: 8, Steps: 1128 | Train Loss: 0.6293414 Vali Loss: 0.7157047 Test Loss: 0.3568593
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.5759261
	speed: 0.0176s/iter; left time: 37.9354s
	iters: 200, epoch: 9 | loss: 0.5992653
	speed: 0.0180s/iter; left time: 36.9841s
	iters: 300, epoch: 9 | loss: 0.7615044
	speed: 0.0164s/iter; left time: 32.0228s
	iters: 400, epoch: 9 | loss: 0.6787198
	speed: 0.0154s/iter; left time: 28.5768s
	iters: 500, epoch: 9 | loss: 0.5913798
	speed: 0.0152s/iter; left time: 26.7766s
	iters: 600, epoch: 9 | loss: 0.6120944
	speed: 0.0163s/iter; left time: 27.0089s
	iters: 700, epoch: 9 | loss: 0.5612408
	speed: 0.0160s/iter; left time: 24.8686s
	iters: 800, epoch: 9 | loss: 0.7808907
	speed: 0.0159s/iter; left time: 23.1159s
	iters: 900, epoch: 9 | loss: 0.8940142
	speed: 0.0157s/iter; left time: 21.3296s
	iters: 1000, epoch: 9 | loss: 0.5378240
	speed: 0.0154s/iter; left time: 19.3449s
	iters: 1100, epoch: 9 | loss: 0.6401595
	speed: 0.0151s/iter; left time: 17.4850s
Epoch: 9 cost time: 17.152366876602173
Epoch: 9, Steps: 1128 | Train Loss: 0.6287557 Vali Loss: 0.7153684 Test Loss: 0.3566443
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.35588160157203674, mae:0.3507719039916992
Use GPU: cuda:0
no_skip True
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.8552616
	speed: 0.0200s/iter; left time: 224.0125s
	iters: 200, epoch: 1 | loss: 0.8730491
	speed: 0.0173s/iter; left time: 192.2512s
	iters: 300, epoch: 1 | loss: 0.6239988
	speed: 0.0169s/iter; left time: 185.5190s
	iters: 400, epoch: 1 | loss: 0.6558076
	speed: 0.0161s/iter; left time: 175.6870s
	iters: 500, epoch: 1 | loss: 0.7227101
	speed: 0.0156s/iter; left time: 168.1435s
	iters: 600, epoch: 1 | loss: 0.5730120
	speed: 0.0153s/iter; left time: 163.3662s
	iters: 700, epoch: 1 | loss: 0.6205596
	speed: 0.0154s/iter; left time: 163.2608s
	iters: 800, epoch: 1 | loss: 0.6463089
	speed: 0.0153s/iter; left time: 160.5720s
	iters: 900, epoch: 1 | loss: 0.8311114
	speed: 0.0151s/iter; left time: 157.2622s
	iters: 1000, epoch: 1 | loss: 0.6930543
	speed: 0.0150s/iter; left time: 154.5388s
	iters: 1100, epoch: 1 | loss: 0.5962331
	speed: 0.0150s/iter; left time: 152.2189s
Epoch: 1 cost time: 16.863596439361572
Epoch: 1, Steps: 1128 | Train Loss: 0.7178115 Vali Loss: 0.7417058 Test Loss: 0.3637176
Validation loss decreased (inf --> 0.741706).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6649888
	speed: 0.0190s/iter; left time: 191.0824s
	iters: 200, epoch: 2 | loss: 0.6956766
	speed: 0.0167s/iter; left time: 165.7594s
	iters: 300, epoch: 2 | loss: 0.6357141
	speed: 0.0158s/iter; left time: 155.3295s
	iters: 400, epoch: 2 | loss: 0.8256357
	speed: 0.0153s/iter; left time: 149.5188s
	iters: 500, epoch: 2 | loss: 0.5774974
	speed: 0.0152s/iter; left time: 146.6658s
	iters: 600, epoch: 2 | loss: 0.5128580
	speed: 0.0148s/iter; left time: 141.3816s
	iters: 700, epoch: 2 | loss: 0.6833485
	speed: 0.0150s/iter; left time: 141.6431s
	iters: 800, epoch: 2 | loss: 0.5466415
	speed: 0.0155s/iter; left time: 144.6065s
	iters: 900, epoch: 2 | loss: 0.6188557
	speed: 0.0152s/iter; left time: 140.3840s
	iters: 1000, epoch: 2 | loss: 0.7043591
	speed: 0.0153s/iter; left time: 139.7536s
	iters: 1100, epoch: 2 | loss: 0.5443216
	speed: 0.0153s/iter; left time: 138.3169s
Epoch: 2 cost time: 17.36253261566162
Epoch: 2, Steps: 1128 | Train Loss: 0.6716855 Vali Loss: 0.7143158 Test Loss: 0.3556716
Validation loss decreased (0.741706 --> 0.714316).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6240447
	speed: 0.0168s/iter; left time: 149.5137s
	iters: 200, epoch: 3 | loss: 0.7083545
	speed: 0.0150s/iter; left time: 132.1222s
	iters: 300, epoch: 3 | loss: 0.5494121
	speed: 0.0145s/iter; left time: 126.9251s
	iters: 400, epoch: 3 | loss: 0.5229462
	speed: 0.0138s/iter; left time: 119.4108s
	iters: 500, epoch: 3 | loss: 0.5627697
	speed: 0.0135s/iter; left time: 114.6666s
	iters: 600, epoch: 3 | loss: 0.6982905
	speed: 0.0133s/iter; left time: 112.1278s
	iters: 700, epoch: 3 | loss: 0.6388994
	speed: 0.0135s/iter; left time: 112.1967s
	iters: 800, epoch: 3 | loss: 0.6469715
	speed: 0.0134s/iter; left time: 110.4848s
	iters: 900, epoch: 3 | loss: 0.6373392
	speed: 0.0133s/iter; left time: 108.0871s
	iters: 1000, epoch: 3 | loss: 0.7645935
	speed: 0.0133s/iter; left time: 106.3666s
	iters: 1100, epoch: 3 | loss: 0.6436259
	speed: 0.0134s/iter; left time: 105.8640s
Epoch: 3 cost time: 15.346823930740356
Epoch: 3, Steps: 1128 | Train Loss: 0.6540098 Vali Loss: 0.7141613 Test Loss: 0.3553045
Validation loss decreased (0.714316 --> 0.714161).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5009491
	speed: 0.0184s/iter; left time: 143.2903s
	iters: 200, epoch: 4 | loss: 0.5597219
	speed: 0.0167s/iter; left time: 128.7657s
	iters: 300, epoch: 4 | loss: 0.7919925
	speed: 0.0163s/iter; left time: 124.0501s
	iters: 400, epoch: 4 | loss: 0.5758293
	speed: 0.0164s/iter; left time: 122.9245s
	iters: 500, epoch: 4 | loss: 0.6280128
	speed: 0.0157s/iter; left time: 115.8900s
	iters: 600, epoch: 4 | loss: 0.5105354
	speed: 0.0158s/iter; left time: 114.9655s
	iters: 700, epoch: 4 | loss: 0.6846101
	speed: 0.0157s/iter; left time: 113.0324s
	iters: 800, epoch: 4 | loss: 0.7657266
	speed: 0.0154s/iter; left time: 109.1188s
	iters: 900, epoch: 4 | loss: 0.5639666
	speed: 0.0152s/iter; left time: 106.6287s
	iters: 1000, epoch: 4 | loss: 0.6747504
	speed: 0.0151s/iter; left time: 104.4013s
	iters: 1100, epoch: 4 | loss: 0.5885961
	speed: 0.0151s/iter; left time: 102.9005s
Epoch: 4 cost time: 17.19893455505371
Epoch: 4, Steps: 1128 | Train Loss: 0.6440547 Vali Loss: 0.7141358 Test Loss: 0.3566056
Validation loss decreased (0.714161 --> 0.714136).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6930375
	speed: 0.0180s/iter; left time: 120.0513s
	iters: 200, epoch: 5 | loss: 0.7343842
	speed: 0.0156s/iter; left time: 102.5815s
	iters: 300, epoch: 5 | loss: 0.5733994
	speed: 0.0154s/iter; left time: 99.4312s
	iters: 400, epoch: 5 | loss: 0.9194202
	speed: 0.0159s/iter; left time: 101.3127s
	iters: 500, epoch: 5 | loss: 0.6730564
	speed: 0.0151s/iter; left time: 94.5586s
	iters: 600, epoch: 5 | loss: 0.4939187
	speed: 0.0154s/iter; left time: 94.8019s
	iters: 700, epoch: 5 | loss: 0.5441477
	speed: 0.0153s/iter; left time: 92.9757s
	iters: 800, epoch: 5 | loss: 0.4837413
	speed: 0.0154s/iter; left time: 91.6616s
	iters: 900, epoch: 5 | loss: 0.6880433
	speed: 0.0152s/iter; left time: 89.1291s
	iters: 1000, epoch: 5 | loss: 0.6131887
	speed: 0.0150s/iter; left time: 86.5249s
	iters: 1100, epoch: 5 | loss: 0.5507200
	speed: 0.0151s/iter; left time: 85.4586s
Epoch: 5 cost time: 17.105639219284058
Epoch: 5, Steps: 1128 | Train Loss: 0.6370880 Vali Loss: 0.7209325 Test Loss: 0.3568903
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.7354392
	speed: 0.0186s/iter; left time: 103.0460s
	iters: 200, epoch: 6 | loss: 0.8476759
	speed: 0.0168s/iter; left time: 91.1672s
	iters: 300, epoch: 6 | loss: 0.4932764
	speed: 0.0155s/iter; left time: 82.7537s
	iters: 400, epoch: 6 | loss: 0.5809349
	speed: 0.0146s/iter; left time: 76.2814s
	iters: 500, epoch: 6 | loss: 0.5596921
	speed: 0.0152s/iter; left time: 77.9595s
	iters: 600, epoch: 6 | loss: 0.6490051
	speed: 0.0150s/iter; left time: 75.4610s
	iters: 700, epoch: 6 | loss: 0.6542985
	speed: 0.0151s/iter; left time: 74.4287s
	iters: 800, epoch: 6 | loss: 0.7385201
	speed: 0.0147s/iter; left time: 71.2251s
	iters: 900, epoch: 6 | loss: 0.7776942
	speed: 0.0146s/iter; left time: 69.2152s
	iters: 1000, epoch: 6 | loss: 0.7055493
	speed: 0.0147s/iter; left time: 68.1951s
	iters: 1100, epoch: 6 | loss: 0.5890650
	speed: 0.0147s/iter; left time: 66.6502s
Epoch: 6 cost time: 16.6140718460083
Epoch: 6, Steps: 1128 | Train Loss: 0.6332610 Vali Loss: 0.7237950 Test Loss: 0.3565781
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.7739362
	speed: 0.0195s/iter; left time: 86.2500s
	iters: 200, epoch: 7 | loss: 0.6984641
	speed: 0.0172s/iter; left time: 74.1699s
	iters: 300, epoch: 7 | loss: 0.6053762
	speed: 0.0154s/iter; left time: 64.6949s
	iters: 400, epoch: 7 | loss: 0.7983196
	speed: 0.0146s/iter; left time: 60.1549s
	iters: 500, epoch: 7 | loss: 0.8495122
	speed: 0.0154s/iter; left time: 61.7307s
	iters: 600, epoch: 7 | loss: 0.8315395
	speed: 0.0152s/iter; left time: 59.4446s
	iters: 700, epoch: 7 | loss: 0.8415673
	speed: 0.0150s/iter; left time: 57.1378s
	iters: 800, epoch: 7 | loss: 0.8726347
	speed: 0.0154s/iter; left time: 57.2602s
	iters: 900, epoch: 7 | loss: 0.7298838
	speed: 0.0152s/iter; left time: 55.0198s
	iters: 1000, epoch: 7 | loss: 0.6862929
	speed: 0.0151s/iter; left time: 53.0448s
	iters: 1100, epoch: 7 | loss: 0.6819404
	speed: 0.0153s/iter; left time: 52.3705s
Epoch: 7 cost time: 17.45719838142395
Epoch: 7, Steps: 1128 | Train Loss: 0.6312384 Vali Loss: 0.7253469 Test Loss: 0.3570822
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.5879660
	speed: 0.0176s/iter; left time: 57.6930s
	iters: 200, epoch: 8 | loss: 0.6829965
	speed: 0.0161s/iter; left time: 51.2648s
	iters: 300, epoch: 8 | loss: 0.7051794
	speed: 0.0159s/iter; left time: 49.0883s
	iters: 400, epoch: 8 | loss: 0.7687277
	speed: 0.0160s/iter; left time: 47.8119s
	iters: 500, epoch: 8 | loss: 0.6028851
	speed: 0.0155s/iter; left time: 44.6568s
	iters: 600, epoch: 8 | loss: 0.5747312
	speed: 0.0151s/iter; left time: 42.1331s
	iters: 700, epoch: 8 | loss: 0.5827383
	speed: 0.0156s/iter; left time: 41.7902s
	iters: 800, epoch: 8 | loss: 0.4613998
	speed: 0.0153s/iter; left time: 39.5136s
	iters: 900, epoch: 8 | loss: 0.5912480
	speed: 0.0151s/iter; left time: 37.4794s
	iters: 1000, epoch: 8 | loss: 0.7271137
	speed: 0.0150s/iter; left time: 35.6688s
	iters: 1100, epoch: 8 | loss: 0.6233318
	speed: 0.0152s/iter; left time: 34.6274s
Epoch: 8 cost time: 17.1067955493927
Epoch: 8, Steps: 1128 | Train Loss: 0.6300358 Vali Loss: 0.7265934 Test Loss: 0.3574131
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.5722834
	speed: 0.0152s/iter; left time: 32.7513s
	iters: 200, epoch: 9 | loss: 0.6734551
	speed: 0.0152s/iter; left time: 31.3361s
	iters: 300, epoch: 9 | loss: 0.5425208
	speed: 0.0157s/iter; left time: 30.6825s
	iters: 400, epoch: 9 | loss: 0.4998347
	speed: 0.0155s/iter; left time: 28.8035s
	iters: 500, epoch: 9 | loss: 0.5544825
	speed: 0.0155s/iter; left time: 27.1515s
	iters: 600, epoch: 9 | loss: 0.6301400
	speed: 0.0155s/iter; left time: 25.7461s
	iters: 700, epoch: 9 | loss: 0.5537698
	speed: 0.0149s/iter; left time: 23.1528s
	iters: 800, epoch: 9 | loss: 0.5676243
	speed: 0.0144s/iter; left time: 21.0536s
	iters: 900, epoch: 9 | loss: 0.4903993
	speed: 0.0143s/iter; left time: 19.3562s
	iters: 1000, epoch: 9 | loss: 0.7279898
	speed: 0.0143s/iter; left time: 17.9978s
	iters: 1100, epoch: 9 | loss: 0.5100725
	speed: 0.0142s/iter; left time: 16.4422s
Epoch: 9 cost time: 16.034225940704346
Epoch: 9, Steps: 1128 | Train Loss: 0.6300705 Vali Loss: 0.7252889 Test Loss: 0.3571846
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.356605589389801, mae:0.35105013847351074
Use GPU: cuda:0
no_skip True
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.9838388
	speed: 0.0176s/iter; left time: 197.1635s
	iters: 200, epoch: 1 | loss: 0.8095962
	speed: 0.0155s/iter; left time: 171.7608s
	iters: 300, epoch: 1 | loss: 0.6485084
	speed: 0.0150s/iter; left time: 165.1261s
	iters: 400, epoch: 1 | loss: 0.6444099
	speed: 0.0145s/iter; left time: 157.8663s
	iters: 500, epoch: 1 | loss: 0.6066561
	speed: 0.0142s/iter; left time: 152.7201s
	iters: 600, epoch: 1 | loss: 0.7678263
	speed: 0.0140s/iter; left time: 149.5129s
	iters: 700, epoch: 1 | loss: 0.6982213
	speed: 0.0144s/iter; left time: 152.5142s
	iters: 800, epoch: 1 | loss: 0.7289157
	speed: 0.0146s/iter; left time: 152.6876s
	iters: 900, epoch: 1 | loss: 0.6045533
	speed: 0.0143s/iter; left time: 148.7511s
	iters: 1000, epoch: 1 | loss: 0.9469278
	speed: 0.0146s/iter; left time: 150.1496s
	iters: 1100, epoch: 1 | loss: 0.6379122
	speed: 0.0147s/iter; left time: 149.9601s
Epoch: 1 cost time: 16.731499433517456
Epoch: 1, Steps: 1128 | Train Loss: 0.7228614 Vali Loss: 0.7419172 Test Loss: 0.3617393
Validation loss decreased (inf --> 0.741917).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5194489
	speed: 0.0160s/iter; left time: 160.7587s
	iters: 200, epoch: 2 | loss: 0.5988930
	speed: 0.0148s/iter; left time: 147.1561s
	iters: 300, epoch: 2 | loss: 0.6921927
	speed: 0.0146s/iter; left time: 144.1141s
	iters: 400, epoch: 2 | loss: 0.9315527
	speed: 0.0147s/iter; left time: 143.5288s
	iters: 500, epoch: 2 | loss: 0.9987441
	speed: 0.0144s/iter; left time: 138.6183s
	iters: 600, epoch: 2 | loss: 0.6679718
	speed: 0.0142s/iter; left time: 135.9639s
	iters: 700, epoch: 2 | loss: 0.6949999
	speed: 0.0145s/iter; left time: 136.7985s
	iters: 800, epoch: 2 | loss: 0.6007592
	speed: 0.0148s/iter; left time: 138.5240s
	iters: 900, epoch: 2 | loss: 0.5790597
	speed: 0.0147s/iter; left time: 135.9768s
	iters: 1000, epoch: 2 | loss: 0.8351572
	speed: 0.0147s/iter; left time: 134.9467s
	iters: 1100, epoch: 2 | loss: 0.5673509
	speed: 0.0149s/iter; left time: 135.1513s
Epoch: 2 cost time: 17.069648265838623
Epoch: 2, Steps: 1128 | Train Loss: 0.6722213 Vali Loss: 0.7225924 Test Loss: 0.3592069
Validation loss decreased (0.741917 --> 0.722592).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7117100
	speed: 0.0175s/iter; left time: 156.1881s
	iters: 200, epoch: 3 | loss: 0.5388111
	speed: 0.0157s/iter; left time: 138.3774s
	iters: 300, epoch: 3 | loss: 0.5559927
	speed: 0.0149s/iter; left time: 130.3176s
	iters: 400, epoch: 3 | loss: 0.6859942
	speed: 0.0146s/iter; left time: 126.2370s
	iters: 500, epoch: 3 | loss: 0.5933929
	speed: 0.0145s/iter; left time: 123.7753s
	iters: 600, epoch: 3 | loss: 0.5710067
	speed: 0.0147s/iter; left time: 123.8195s
	iters: 700, epoch: 3 | loss: 0.4916138
	speed: 0.0145s/iter; left time: 120.3804s
	iters: 800, epoch: 3 | loss: 0.7749116
	speed: 0.0141s/iter; left time: 116.3513s
	iters: 900, epoch: 3 | loss: 0.6164663
	speed: 0.0143s/iter; left time: 116.4251s
	iters: 1000, epoch: 3 | loss: 0.6308858
	speed: 0.0145s/iter; left time: 116.3930s
	iters: 1100, epoch: 3 | loss: 0.7622715
	speed: 0.0144s/iter; left time: 113.8922s
Epoch: 3 cost time: 16.1846821308136
Epoch: 3, Steps: 1128 | Train Loss: 0.6565864 Vali Loss: 0.7179186 Test Loss: 0.3581135
Validation loss decreased (0.722592 --> 0.717919).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5108160
	speed: 0.0221s/iter; left time: 172.5300s
	iters: 200, epoch: 4 | loss: 0.8283736
	speed: 0.0184s/iter; left time: 141.3030s
	iters: 300, epoch: 4 | loss: 0.5849804
	speed: 0.0162s/iter; left time: 122.7315s
	iters: 400, epoch: 4 | loss: 0.6173010
	speed: 0.0164s/iter; left time: 122.7354s
	iters: 500, epoch: 4 | loss: 0.6764973
	speed: 0.0163s/iter; left time: 120.3986s
	iters: 600, epoch: 4 | loss: 0.7904987
	speed: 0.0160s/iter; left time: 116.8921s
	iters: 700, epoch: 4 | loss: 0.5800155
	speed: 0.0155s/iter; left time: 111.8313s
	iters: 800, epoch: 4 | loss: 0.5774376
	speed: 0.0152s/iter; left time: 108.1387s
	iters: 900, epoch: 4 | loss: 0.6122267
	speed: 0.0150s/iter; left time: 105.0944s
	iters: 1000, epoch: 4 | loss: 0.5463113
	speed: 0.0147s/iter; left time: 101.7115s
	iters: 1100, epoch: 4 | loss: 0.6529779
	speed: 0.0145s/iter; left time: 98.4149s
Epoch: 4 cost time: 16.393391370773315
Epoch: 4, Steps: 1128 | Train Loss: 0.6453032 Vali Loss: 0.7147402 Test Loss: 0.3589728
Validation loss decreased (0.717919 --> 0.714740).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4547898
	speed: 0.0181s/iter; left time: 120.7056s
	iters: 200, epoch: 5 | loss: 0.6611024
	speed: 0.0158s/iter; left time: 103.9605s
	iters: 300, epoch: 5 | loss: 0.5405176
	speed: 0.0152s/iter; left time: 98.2719s
	iters: 400, epoch: 5 | loss: 0.5398225
	speed: 0.0146s/iter; left time: 92.8281s
	iters: 500, epoch: 5 | loss: 0.6190391
	speed: 0.0146s/iter; left time: 91.4141s
	iters: 600, epoch: 5 | loss: 0.5513339
	speed: 0.0147s/iter; left time: 90.6673s
	iters: 700, epoch: 5 | loss: 0.6616443
	speed: 0.0151s/iter; left time: 91.5187s
	iters: 800, epoch: 5 | loss: 0.5413665
	speed: 0.0149s/iter; left time: 89.1641s
	iters: 900, epoch: 5 | loss: 0.5901861
	speed: 0.0148s/iter; left time: 86.7937s
	iters: 1000, epoch: 5 | loss: 0.7397316
	speed: 0.0146s/iter; left time: 84.4362s
	iters: 1100, epoch: 5 | loss: 0.6004239
	speed: 0.0147s/iter; left time: 83.3535s
Epoch: 5 cost time: 16.555320978164673
Epoch: 5, Steps: 1128 | Train Loss: 0.6389693 Vali Loss: 0.7168490 Test Loss: 0.3582570
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.7860012
	speed: 0.0175s/iter; left time: 97.2212s
	iters: 200, epoch: 6 | loss: 0.6741065
	speed: 0.0164s/iter; left time: 89.3271s
	iters: 300, epoch: 6 | loss: 0.7470560
	speed: 0.0163s/iter; left time: 86.9569s
	iters: 400, epoch: 6 | loss: 0.7752668
	speed: 0.0159s/iter; left time: 83.3563s
	iters: 500, epoch: 6 | loss: 0.5206731
	speed: 0.0157s/iter; left time: 80.4572s
	iters: 600, epoch: 6 | loss: 0.5470548
	speed: 0.0153s/iter; left time: 77.2511s
	iters: 700, epoch: 6 | loss: 0.5476406
	speed: 0.0149s/iter; left time: 73.4226s
	iters: 800, epoch: 6 | loss: 0.7281266
	speed: 0.0149s/iter; left time: 71.9716s
	iters: 900, epoch: 6 | loss: 0.5939178
	speed: 0.0146s/iter; left time: 69.2198s
	iters: 1000, epoch: 6 | loss: 0.6530204
	speed: 0.0143s/iter; left time: 66.4548s
	iters: 1100, epoch: 6 | loss: 0.5472381
	speed: 0.0145s/iter; left time: 66.0520s
Epoch: 6 cost time: 16.517032861709595
Epoch: 6, Steps: 1128 | Train Loss: 0.6349911 Vali Loss: 0.7164634 Test Loss: 0.3586193
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5451009
	speed: 0.0202s/iter; left time: 89.1486s
	iters: 200, epoch: 7 | loss: 0.5091553
	speed: 0.0177s/iter; left time: 76.4413s
	iters: 300, epoch: 7 | loss: 0.8215706
	speed: 0.0168s/iter; left time: 70.8159s
	iters: 400, epoch: 7 | loss: 0.6258776
	speed: 0.0161s/iter; left time: 66.1251s
	iters: 500, epoch: 7 | loss: 0.6267377
	speed: 0.0153s/iter; left time: 61.3865s
	iters: 600, epoch: 7 | loss: 0.4754307
	speed: 0.0150s/iter; left time: 58.7452s
	iters: 700, epoch: 7 | loss: 0.6038888
	speed: 0.0151s/iter; left time: 57.4984s
	iters: 800, epoch: 7 | loss: 0.5538492
	speed: 0.0149s/iter; left time: 55.3826s
	iters: 900, epoch: 7 | loss: 0.8777549
	speed: 0.0147s/iter; left time: 53.1604s
	iters: 1000, epoch: 7 | loss: 0.6184077
	speed: 0.0146s/iter; left time: 51.3063s
	iters: 1100, epoch: 7 | loss: 0.6360341
	speed: 0.0150s/iter; left time: 51.2351s
Epoch: 7 cost time: 16.929100036621094
Epoch: 7, Steps: 1128 | Train Loss: 0.6333190 Vali Loss: 0.7199661 Test Loss: 0.3589496
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.5257557
	speed: 0.0183s/iter; left time: 60.1110s
	iters: 200, epoch: 8 | loss: 0.6581719
	speed: 0.0184s/iter; left time: 58.6406s
	iters: 300, epoch: 8 | loss: 0.5556810
	speed: 0.0173s/iter; left time: 53.3138s
	iters: 400, epoch: 8 | loss: 0.5198532
	speed: 0.0172s/iter; left time: 51.4211s
	iters: 500, epoch: 8 | loss: 0.5810088
	speed: 0.0167s/iter; left time: 48.2827s
	iters: 600, epoch: 8 | loss: 0.7867809
	speed: 0.0165s/iter; left time: 45.9563s
	iters: 700, epoch: 8 | loss: 0.6407830
	speed: 0.0164s/iter; left time: 44.1421s
	iters: 800, epoch: 8 | loss: 0.6423203
	speed: 0.0160s/iter; left time: 41.2596s
	iters: 900, epoch: 8 | loss: 0.6661871
	speed: 0.0156s/iter; left time: 38.8103s
	iters: 1000, epoch: 8 | loss: 0.6291793
	speed: 0.0155s/iter; left time: 36.8534s
	iters: 1100, epoch: 8 | loss: 0.5945521
	speed: 0.0154s/iter; left time: 35.2136s
Epoch: 8 cost time: 17.409179210662842
Epoch: 8, Steps: 1128 | Train Loss: 0.6319733 Vali Loss: 0.7171414 Test Loss: 0.3590819
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.6545709
	speed: 0.0168s/iter; left time: 36.2443s
	iters: 200, epoch: 9 | loss: 0.5783651
	speed: 0.0160s/iter; left time: 33.0075s
	iters: 300, epoch: 9 | loss: 0.6365126
	speed: 0.0154s/iter; left time: 30.1123s
	iters: 400, epoch: 9 | loss: 0.4507659
	speed: 0.0152s/iter; left time: 28.1432s
	iters: 500, epoch: 9 | loss: 0.6543046
	speed: 0.0154s/iter; left time: 27.0943s
	iters: 600, epoch: 9 | loss: 0.6218150
	speed: 0.0155s/iter; left time: 25.6495s
	iters: 700, epoch: 9 | loss: 0.6729224
	speed: 0.0152s/iter; left time: 23.7172s
	iters: 800, epoch: 9 | loss: 0.5218813
	speed: 0.0150s/iter; left time: 21.8319s
	iters: 900, epoch: 9 | loss: 0.5340679
	speed: 0.0148s/iter; left time: 20.0636s
	iters: 1000, epoch: 9 | loss: 0.6737989
	speed: 0.0148s/iter; left time: 18.5718s
	iters: 1100, epoch: 9 | loss: 0.6950229
	speed: 0.0148s/iter; left time: 17.1257s
Epoch: 9 cost time: 16.849377393722534
Epoch: 9, Steps: 1128 | Train Loss: 0.6313512 Vali Loss: 0.7174660 Test Loss: 0.3589746
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.35897281765937805, mae:0.3523842692375183
Seed: 456
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_96       Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip True
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.4624774
	speed: 0.0279s/iter; left time: 317.2969s
	iters: 200, epoch: 1 | loss: 0.4857439
	speed: 0.0216s/iter; left time: 243.2487s
	iters: 300, epoch: 1 | loss: 0.4452879
	speed: 0.0198s/iter; left time: 221.1995s
	iters: 400, epoch: 1 | loss: 0.5053895
	speed: 0.0183s/iter; left time: 202.7038s
	iters: 500, epoch: 1 | loss: 0.4444481
	speed: 0.0177s/iter; left time: 194.3019s
	iters: 600, epoch: 1 | loss: 1.3148688
	speed: 0.0170s/iter; left time: 184.6921s
	iters: 700, epoch: 1 | loss: 0.4089019
	speed: 0.0160s/iter; left time: 172.7941s
	iters: 800, epoch: 1 | loss: 0.3948534
	speed: 0.0156s/iter; left time: 166.5351s
	iters: 900, epoch: 1 | loss: 0.3603236
	speed: 0.0153s/iter; left time: 161.3547s
	iters: 1000, epoch: 1 | loss: 0.3444696
	speed: 0.0149s/iter; left time: 156.0229s
	iters: 1100, epoch: 1 | loss: 0.3977884
	speed: 0.0145s/iter; left time: 150.1766s
Epoch: 1 cost time: 16.64801549911499
Epoch: 1, Steps: 1147 | Train Loss: 0.5343281 Vali Loss: 0.4727104 Test Loss: 0.1939223
Validation loss decreased (inf --> 0.472710).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6434085
	speed: 0.0183s/iter; left time: 186.9776s
	iters: 200, epoch: 2 | loss: 1.0145690
	speed: 0.0161s/iter; left time: 162.7700s
	iters: 300, epoch: 2 | loss: 0.4369773
	speed: 0.0147s/iter; left time: 147.3943s
	iters: 400, epoch: 2 | loss: 0.5133278
	speed: 0.0143s/iter; left time: 141.6673s
	iters: 500, epoch: 2 | loss: 0.4203407
	speed: 0.0144s/iter; left time: 141.5474s
	iters: 600, epoch: 2 | loss: 0.6020156
	speed: 0.0145s/iter; left time: 141.0504s
	iters: 700, epoch: 2 | loss: 0.3763862
	speed: 0.0142s/iter; left time: 137.1053s
	iters: 800, epoch: 2 | loss: 0.2882910
	speed: 0.0137s/iter; left time: 130.8122s
	iters: 900, epoch: 2 | loss: 0.2902407
	speed: 0.0140s/iter; left time: 131.6373s
	iters: 1000, epoch: 2 | loss: 0.2446853
	speed: 0.0145s/iter; left time: 135.1660s
	iters: 1100, epoch: 2 | loss: 0.3987552
	speed: 0.0143s/iter; left time: 132.3490s
Epoch: 2 cost time: 16.53126859664917
Epoch: 2, Steps: 1147 | Train Loss: 0.4663524 Vali Loss: 0.4533547 Test Loss: 0.1891559
Validation loss decreased (0.472710 --> 0.453355).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4328841
	speed: 0.0182s/iter; left time: 165.0338s
	iters: 200, epoch: 3 | loss: 0.4034088
	speed: 0.0150s/iter; left time: 134.8016s
	iters: 300, epoch: 3 | loss: 0.4554291
	speed: 0.0140s/iter; left time: 124.6804s
	iters: 400, epoch: 3 | loss: 0.5070496
	speed: 0.0139s/iter; left time: 122.0459s
	iters: 500, epoch: 3 | loss: 0.2605264
	speed: 0.0140s/iter; left time: 121.6402s
	iters: 600, epoch: 3 | loss: 1.2122180
	speed: 0.0134s/iter; left time: 115.1141s
	iters: 700, epoch: 3 | loss: 0.4752048
	speed: 0.0129s/iter; left time: 109.6089s
	iters: 800, epoch: 3 | loss: 0.2772603
	speed: 0.0127s/iter; left time: 106.4825s
	iters: 900, epoch: 3 | loss: 0.3191097
	speed: 0.0126s/iter; left time: 104.4495s
	iters: 1000, epoch: 3 | loss: 0.4129448
	speed: 0.0128s/iter; left time: 105.0017s
	iters: 1100, epoch: 3 | loss: 0.2760213
	speed: 0.0128s/iter; left time: 103.6649s
Epoch: 3 cost time: 14.794027090072632
Epoch: 3, Steps: 1147 | Train Loss: 0.4393337 Vali Loss: 0.4428769 Test Loss: 0.1850429
Validation loss decreased (0.453355 --> 0.442877).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3098996
	speed: 0.0158s/iter; left time: 125.5874s
	iters: 200, epoch: 4 | loss: 0.2433467
	speed: 0.0149s/iter; left time: 116.4248s
	iters: 300, epoch: 4 | loss: 0.3052808
	speed: 0.0143s/iter; left time: 110.8915s
	iters: 400, epoch: 4 | loss: 0.2703587
	speed: 0.0138s/iter; left time: 105.3762s
	iters: 500, epoch: 4 | loss: 0.3372611
	speed: 0.0140s/iter; left time: 105.3438s
	iters: 600, epoch: 4 | loss: 0.4412648
	speed: 0.0141s/iter; left time: 104.6118s
	iters: 700, epoch: 4 | loss: 0.2562131
	speed: 0.0138s/iter; left time: 101.1950s
	iters: 800, epoch: 4 | loss: 0.3007854
	speed: 0.0138s/iter; left time: 99.9507s
	iters: 900, epoch: 4 | loss: 0.3713009
	speed: 0.0139s/iter; left time: 99.2585s
	iters: 1000, epoch: 4 | loss: 0.3310863
	speed: 0.0137s/iter; left time: 96.5984s
	iters: 1100, epoch: 4 | loss: 1.2457768
	speed: 0.0134s/iter; left time: 93.1595s
Epoch: 4 cost time: 15.74147081375122
Epoch: 4, Steps: 1147 | Train Loss: 0.4272174 Vali Loss: 0.4356740 Test Loss: 0.1815480
Validation loss decreased (0.442877 --> 0.435674).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3589025
	speed: 0.0181s/iter; left time: 122.5270s
	iters: 200, epoch: 5 | loss: 0.3738607
	speed: 0.0184s/iter; left time: 123.0075s
	iters: 300, epoch: 5 | loss: 0.3436631
	speed: 0.0171s/iter; left time: 112.2920s
	iters: 400, epoch: 5 | loss: 0.3975357
	speed: 0.0160s/iter; left time: 103.4068s
	iters: 500, epoch: 5 | loss: 0.4796991
	speed: 0.0157s/iter; left time: 100.0220s
	iters: 600, epoch: 5 | loss: 0.5265515
	speed: 0.0156s/iter; left time: 97.7346s
	iters: 700, epoch: 5 | loss: 0.4215779
	speed: 0.0154s/iter; left time: 95.0336s
	iters: 800, epoch: 5 | loss: 0.3511840
	speed: 0.0151s/iter; left time: 91.7455s
	iters: 900, epoch: 5 | loss: 0.2130615
	speed: 0.0151s/iter; left time: 90.1239s
	iters: 1000, epoch: 5 | loss: 0.3656230
	speed: 0.0149s/iter; left time: 87.7692s
	iters: 1100, epoch: 5 | loss: 0.9533707
	speed: 0.0147s/iter; left time: 85.0417s
Epoch: 5 cost time: 17.01352024078369
Epoch: 5, Steps: 1147 | Train Loss: 0.4210265 Vali Loss: 0.4330305 Test Loss: 0.1793635
Validation loss decreased (0.435674 --> 0.433031).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3519138
	speed: 0.0182s/iter; left time: 102.3234s
	iters: 200, epoch: 6 | loss: 0.4947867
	speed: 0.0150s/iter; left time: 83.3167s
	iters: 300, epoch: 6 | loss: 0.2700604
	speed: 0.0144s/iter; left time: 78.0920s
	iters: 400, epoch: 6 | loss: 0.4855621
	speed: 0.0142s/iter; left time: 75.9883s
	iters: 500, epoch: 6 | loss: 0.8935069
	speed: 0.0139s/iter; left time: 72.6778s
	iters: 600, epoch: 6 | loss: 0.4107968
	speed: 0.0133s/iter; left time: 68.3730s
	iters: 700, epoch: 6 | loss: 0.2504696
	speed: 0.0137s/iter; left time: 69.1609s
	iters: 800, epoch: 6 | loss: 0.2917596
	speed: 0.0138s/iter; left time: 68.2721s
	iters: 900, epoch: 6 | loss: 0.3261777
	speed: 0.0136s/iter; left time: 65.7945s
	iters: 1000, epoch: 6 | loss: 0.3782266
	speed: 0.0133s/iter; left time: 63.0796s
	iters: 1100, epoch: 6 | loss: 1.3349919
	speed: 0.0133s/iter; left time: 61.6645s
Epoch: 6 cost time: 15.444568157196045
Epoch: 6, Steps: 1147 | Train Loss: 0.4168645 Vali Loss: 0.4346125 Test Loss: 0.1796388
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3236828
	speed: 0.0194s/iter; left time: 87.0706s
	iters: 200, epoch: 7 | loss: 1.2246814
	speed: 0.0156s/iter; left time: 68.5682s
	iters: 300, epoch: 7 | loss: 0.2775837
	speed: 0.0149s/iter; left time: 63.9347s
	iters: 400, epoch: 7 | loss: 0.4474744
	speed: 0.0151s/iter; left time: 63.2378s
	iters: 500, epoch: 7 | loss: 0.3677772
	speed: 0.0149s/iter; left time: 61.0886s
	iters: 600, epoch: 7 | loss: 0.3758370
	speed: 0.0143s/iter; left time: 56.9582s
	iters: 700, epoch: 7 | loss: 0.2591538
	speed: 0.0142s/iter; left time: 55.1148s
	iters: 800, epoch: 7 | loss: 0.2657163
	speed: 0.0141s/iter; left time: 53.3132s
	iters: 900, epoch: 7 | loss: 1.1530985
	speed: 0.0139s/iter; left time: 51.4257s
	iters: 1000, epoch: 7 | loss: 0.4515296
	speed: 0.0137s/iter; left time: 49.3290s
	iters: 1100, epoch: 7 | loss: 0.3272012
	speed: 0.0140s/iter; left time: 48.7885s
Epoch: 7 cost time: 16.261829137802124
Epoch: 7, Steps: 1147 | Train Loss: 0.4148599 Vali Loss: 0.4320904 Test Loss: 0.1789914
Validation loss decreased (0.433031 --> 0.432090).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3228165
	speed: 0.0152s/iter; left time: 50.7303s
	iters: 200, epoch: 8 | loss: 0.2402358
	speed: 0.0153s/iter; left time: 49.7450s
	iters: 300, epoch: 8 | loss: 0.3193367
	speed: 0.0150s/iter; left time: 47.2052s
	iters: 400, epoch: 8 | loss: 1.3516744
	speed: 0.0147s/iter; left time: 44.6960s
	iters: 500, epoch: 8 | loss: 0.4354694
	speed: 0.0142s/iter; left time: 41.6956s
	iters: 600, epoch: 8 | loss: 0.3095413
	speed: 0.0139s/iter; left time: 39.3806s
	iters: 700, epoch: 8 | loss: 0.3321171
	speed: 0.0139s/iter; left time: 38.1118s
	iters: 800, epoch: 8 | loss: 0.3570247
	speed: 0.0142s/iter; left time: 37.4733s
	iters: 900, epoch: 8 | loss: 0.2852791
	speed: 0.0145s/iter; left time: 36.7585s
	iters: 1000, epoch: 8 | loss: 0.2829695
	speed: 0.0145s/iter; left time: 35.4778s
	iters: 1100, epoch: 8 | loss: 0.3004776
	speed: 0.0145s/iter; left time: 34.0294s
Epoch: 8 cost time: 16.739015340805054
Epoch: 8, Steps: 1147 | Train Loss: 0.4137849 Vali Loss: 0.4345668 Test Loss: 0.1791038
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2609667
	speed: 0.0182s/iter; left time: 39.8859s
	iters: 200, epoch: 9 | loss: 0.5045512
	speed: 0.0164s/iter; left time: 34.4592s
	iters: 300, epoch: 9 | loss: 0.2542979
	speed: 0.0158s/iter; left time: 31.4303s
	iters: 400, epoch: 9 | loss: 0.3257968
	speed: 0.0154s/iter; left time: 29.2199s
	iters: 500, epoch: 9 | loss: 0.2698898
	speed: 0.0153s/iter; left time: 27.5152s
	iters: 600, epoch: 9 | loss: 0.3689426
	speed: 0.0148s/iter; left time: 25.0208s
	iters: 700, epoch: 9 | loss: 0.3084496
	speed: 0.0145s/iter; left time: 23.2042s
	iters: 800, epoch: 9 | loss: 0.2797559
	speed: 0.0145s/iter; left time: 21.7418s
	iters: 900, epoch: 9 | loss: 0.4541846
	speed: 0.0145s/iter; left time: 20.2541s
	iters: 1000, epoch: 9 | loss: 0.2773171
	speed: 0.0142s/iter; left time: 18.3960s
	iters: 1100, epoch: 9 | loss: 0.2942903
	speed: 0.0141s/iter; left time: 16.8707s
Epoch: 9 cost time: 16.27902579307556
Epoch: 9, Steps: 1147 | Train Loss: 0.4134031 Vali Loss: 0.4347925 Test Loss: 0.1787210
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2735738
	speed: 0.0247s/iter; left time: 25.9049s
	iters: 200, epoch: 10 | loss: 1.2413559
	speed: 0.0176s/iter; left time: 16.6694s
	iters: 300, epoch: 10 | loss: 0.2606413
	speed: 0.0157s/iter; left time: 13.3096s
	iters: 400, epoch: 10 | loss: 0.2746823
	speed: 0.0146s/iter; left time: 10.9235s
	iters: 500, epoch: 10 | loss: 0.3523581
	speed: 0.0141s/iter; left time: 9.1387s
	iters: 600, epoch: 10 | loss: 0.3625176
	speed: 0.0139s/iter; left time: 7.6424s
	iters: 700, epoch: 10 | loss: 0.3241778
	speed: 0.0141s/iter; left time: 6.3151s
	iters: 800, epoch: 10 | loss: 0.2681364
	speed: 0.0142s/iter; left time: 4.9515s
	iters: 900, epoch: 10 | loss: 0.2052007
	speed: 0.0144s/iter; left time: 3.5792s
	iters: 1000, epoch: 10 | loss: 0.2641113
	speed: 0.0141s/iter; left time: 2.0910s
	iters: 1100, epoch: 10 | loss: 0.3518025
	speed: 0.0138s/iter; left time: 0.6632s
Epoch: 10 cost time: 15.875957012176514
Epoch: 10, Steps: 1147 | Train Loss: 0.4130456 Vali Loss: 0.4342608 Test Loss: 0.1788560
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.17899131774902344, mae:0.2225412130355835
Use GPU: cuda:0
no_skip True
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.5386311
	speed: 0.0175s/iter; left time: 198.9381s
	iters: 200, epoch: 1 | loss: 0.4429543
	speed: 0.0145s/iter; left time: 163.4683s
	iters: 300, epoch: 1 | loss: 0.5692219
	speed: 0.0131s/iter; left time: 146.7339s
	iters: 400, epoch: 1 | loss: 0.4329402
	speed: 0.0136s/iter; left time: 150.3843s
	iters: 500, epoch: 1 | loss: 0.4010870
	speed: 0.0140s/iter; left time: 153.5107s
	iters: 600, epoch: 1 | loss: 0.3925782
	speed: 0.0134s/iter; left time: 146.1520s
	iters: 700, epoch: 1 | loss: 0.6027716
	speed: 0.0136s/iter; left time: 146.8390s
	iters: 800, epoch: 1 | loss: 0.3694045
	speed: 0.0137s/iter; left time: 146.0309s
	iters: 900, epoch: 1 | loss: 0.5333676
	speed: 0.0136s/iter; left time: 143.7574s
	iters: 1000, epoch: 1 | loss: 0.3095652
	speed: 0.0135s/iter; left time: 141.7046s
	iters: 1100, epoch: 1 | loss: 0.3196532
	speed: 0.0134s/iter; left time: 139.3551s
Epoch: 1 cost time: 15.561235427856445
Epoch: 1, Steps: 1147 | Train Loss: 0.5222349 Vali Loss: 0.4704864 Test Loss: 0.1895592
Validation loss decreased (inf --> 0.470486).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3165058
	speed: 0.0159s/iter; left time: 162.8024s
	iters: 200, epoch: 2 | loss: 0.3737026
	speed: 0.0143s/iter; left time: 144.8804s
	iters: 300, epoch: 2 | loss: 0.3480168
	speed: 0.0139s/iter; left time: 139.5543s
	iters: 400, epoch: 2 | loss: 0.3145290
	speed: 0.0136s/iter; left time: 134.6208s
	iters: 500, epoch: 2 | loss: 0.2396015
	speed: 0.0134s/iter; left time: 131.5384s
	iters: 600, epoch: 2 | loss: 0.3134353
	speed: 0.0134s/iter; left time: 130.3933s
	iters: 700, epoch: 2 | loss: 0.4514823
	speed: 0.0137s/iter; left time: 132.1812s
	iters: 800, epoch: 2 | loss: 1.2588047
	speed: 0.0136s/iter; left time: 129.7280s
	iters: 900, epoch: 2 | loss: 0.3915820
	speed: 0.0133s/iter; left time: 124.9512s
	iters: 1000, epoch: 2 | loss: 0.3295596
	speed: 0.0132s/iter; left time: 123.1887s
	iters: 1100, epoch: 2 | loss: 0.3255459
	speed: 0.0134s/iter; left time: 123.9533s
Epoch: 2 cost time: 15.642499208450317
Epoch: 2, Steps: 1147 | Train Loss: 0.4680200 Vali Loss: 0.4591122 Test Loss: 0.1865184
Validation loss decreased (0.470486 --> 0.459112).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 1.4024531
	speed: 0.0149s/iter; left time: 135.2232s
	iters: 200, epoch: 3 | loss: 0.3143356
	speed: 0.0160s/iter; left time: 143.3327s
	iters: 300, epoch: 3 | loss: 0.4393417
	speed: 0.0155s/iter; left time: 137.2202s
	iters: 400, epoch: 3 | loss: 1.4308480
	speed: 0.0153s/iter; left time: 134.3258s
	iters: 500, epoch: 3 | loss: 0.2845580
	speed: 0.0152s/iter; left time: 132.1585s
	iters: 600, epoch: 3 | loss: 0.4465210
	speed: 0.0151s/iter; left time: 129.6230s
	iters: 700, epoch: 3 | loss: 0.3178219
	speed: 0.0149s/iter; left time: 126.3089s
	iters: 800, epoch: 3 | loss: 0.4795872
	speed: 0.0145s/iter; left time: 121.8405s
	iters: 900, epoch: 3 | loss: 0.2848415
	speed: 0.0148s/iter; left time: 122.2135s
	iters: 1000, epoch: 3 | loss: 0.3192664
	speed: 0.0150s/iter; left time: 122.8894s
	iters: 1100, epoch: 3 | loss: 0.3241821
	speed: 0.0148s/iter; left time: 119.2440s
Epoch: 3 cost time: 16.924091815948486
Epoch: 3, Steps: 1147 | Train Loss: 0.4450619 Vali Loss: 0.4416751 Test Loss: 0.1817648
Validation loss decreased (0.459112 --> 0.441675).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3188670
	speed: 0.0193s/iter; left time: 152.8246s
	iters: 200, epoch: 4 | loss: 0.3657997
	speed: 0.0166s/iter; left time: 129.9389s
	iters: 300, epoch: 4 | loss: 0.3721595
	speed: 0.0170s/iter; left time: 131.4181s
	iters: 400, epoch: 4 | loss: 0.3690197
	speed: 0.0161s/iter; left time: 123.1721s
	iters: 500, epoch: 4 | loss: 1.2029294
	speed: 0.0158s/iter; left time: 119.2247s
	iters: 600, epoch: 4 | loss: 0.2908405
	speed: 0.0162s/iter; left time: 120.6556s
	iters: 700, epoch: 4 | loss: 0.3726325
	speed: 0.0156s/iter; left time: 113.9933s
	iters: 800, epoch: 4 | loss: 0.2769133
	speed: 0.0152s/iter; left time: 110.0962s
	iters: 900, epoch: 4 | loss: 0.3970512
	speed: 0.0151s/iter; left time: 107.8349s
	iters: 1000, epoch: 4 | loss: 0.2994851
	speed: 0.0151s/iter; left time: 106.4017s
	iters: 1100, epoch: 4 | loss: 0.3879798
	speed: 0.0149s/iter; left time: 103.0111s
Epoch: 4 cost time: 17.09179711341858
Epoch: 4, Steps: 1147 | Train Loss: 0.4329626 Vali Loss: 0.4423844 Test Loss: 0.1829038
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2745317
	speed: 0.0196s/iter; left time: 133.1000s
	iters: 200, epoch: 5 | loss: 0.2653995
	speed: 0.0164s/iter; left time: 109.2679s
	iters: 300, epoch: 5 | loss: 0.3083332
	speed: 0.0152s/iter; left time: 100.3569s
	iters: 400, epoch: 5 | loss: 0.3198390
	speed: 0.0154s/iter; left time: 99.8793s
	iters: 500, epoch: 5 | loss: 0.3382598
	speed: 0.0150s/iter; left time: 96.0536s
	iters: 600, epoch: 5 | loss: 0.5000053
	speed: 0.0145s/iter; left time: 90.9032s
	iters: 700, epoch: 5 | loss: 0.2824169
	speed: 0.0151s/iter; left time: 93.6054s
	iters: 800, epoch: 5 | loss: 0.2919101
	speed: 0.0153s/iter; left time: 93.1831s
	iters: 900, epoch: 5 | loss: 0.3676725
	speed: 0.0149s/iter; left time: 89.2216s
	iters: 1000, epoch: 5 | loss: 0.4226334
	speed: 0.0147s/iter; left time: 86.5530s
	iters: 1100, epoch: 5 | loss: 0.3722186
	speed: 0.0145s/iter; left time: 83.9787s
Epoch: 5 cost time: 16.578815460205078
Epoch: 5, Steps: 1147 | Train Loss: 0.4262596 Vali Loss: 0.4354924 Test Loss: 0.1795277
Validation loss decreased (0.441675 --> 0.435492).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6750844
	speed: 0.0134s/iter; left time: 75.6833s
	iters: 200, epoch: 6 | loss: 0.4645957
	speed: 0.0118s/iter; left time: 65.1177s
	iters: 300, epoch: 6 | loss: 1.2650625
	speed: 0.0109s/iter; left time: 59.3202s
	iters: 400, epoch: 6 | loss: 0.5819601
	speed: 0.0105s/iter; left time: 56.2224s
	iters: 500, epoch: 6 | loss: 0.2704478
	speed: 0.0101s/iter; left time: 52.7466s
	iters: 600, epoch: 6 | loss: 0.3493677
	speed: 0.0099s/iter; left time: 51.0729s
	iters: 700, epoch: 6 | loss: 0.4499610
	speed: 0.0098s/iter; left time: 49.1017s
	iters: 800, epoch: 6 | loss: 0.2907596
	speed: 0.0102s/iter; left time: 50.1832s
	iters: 900, epoch: 6 | loss: 0.3253650
	speed: 0.0113s/iter; left time: 54.8608s
	iters: 1000, epoch: 6 | loss: 0.2964229
	speed: 0.0118s/iter; left time: 55.6701s
	iters: 1100, epoch: 6 | loss: 0.4542126
	speed: 0.0120s/iter; left time: 55.6746s
Epoch: 6 cost time: 13.958063840866089
Epoch: 6, Steps: 1147 | Train Loss: 0.4227651 Vali Loss: 0.4358320 Test Loss: 0.1787828
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3014547
	speed: 0.0164s/iter; left time: 73.6758s
	iters: 200, epoch: 7 | loss: 0.2547440
	speed: 0.0154s/iter; left time: 67.5672s
	iters: 300, epoch: 7 | loss: 0.2402777
	speed: 0.0153s/iter; left time: 65.5293s
	iters: 400, epoch: 7 | loss: 0.3826382
	speed: 0.0147s/iter; left time: 61.6301s
	iters: 500, epoch: 7 | loss: 1.1970346
	speed: 0.0141s/iter; left time: 57.8527s
	iters: 600, epoch: 7 | loss: 0.3639160
	speed: 0.0140s/iter; left time: 55.8134s
	iters: 700, epoch: 7 | loss: 0.2324460
	speed: 0.0140s/iter; left time: 54.4881s
	iters: 800, epoch: 7 | loss: 0.3484803
	speed: 0.0141s/iter; left time: 53.2441s
	iters: 900, epoch: 7 | loss: 0.3032781
	speed: 0.0137s/iter; left time: 50.6888s
	iters: 1000, epoch: 7 | loss: 0.2650149
	speed: 0.0136s/iter; left time: 48.8890s
	iters: 1100, epoch: 7 | loss: 0.4072317
	speed: 0.0137s/iter; left time: 47.7380s
Epoch: 7 cost time: 15.880635499954224
Epoch: 7, Steps: 1147 | Train Loss: 0.4205924 Vali Loss: 0.4345053 Test Loss: 0.1793738
Validation loss decreased (0.435492 --> 0.434505).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3241789
	speed: 0.0141s/iter; left time: 47.0007s
	iters: 200, epoch: 8 | loss: 1.3790661
	speed: 0.0130s/iter; left time: 42.0514s
	iters: 300, epoch: 8 | loss: 0.5417572
	speed: 0.0135s/iter; left time: 42.4117s
	iters: 400, epoch: 8 | loss: 0.3172148
	speed: 0.0133s/iter; left time: 40.3239s
	iters: 500, epoch: 8 | loss: 0.2200661
	speed: 0.0127s/iter; left time: 37.2840s
	iters: 600, epoch: 8 | loss: 0.2315308
	speed: 0.0123s/iter; left time: 34.8329s
	iters: 700, epoch: 8 | loss: 0.2160043
	speed: 0.0128s/iter; left time: 35.0703s
	iters: 800, epoch: 8 | loss: 0.3899534
	speed: 0.0128s/iter; left time: 33.9036s
	iters: 900, epoch: 8 | loss: 0.2462514
	speed: 0.0129s/iter; left time: 32.6687s
	iters: 1000, epoch: 8 | loss: 0.2755225
	speed: 0.0129s/iter; left time: 31.5033s
	iters: 1100, epoch: 8 | loss: 0.3143741
	speed: 0.0132s/iter; left time: 30.9560s
Epoch: 8 cost time: 15.215453863143921
Epoch: 8, Steps: 1147 | Train Loss: 0.4195430 Vali Loss: 0.4347931 Test Loss: 0.1788692
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3402396
	speed: 0.0189s/iter; left time: 41.4971s
	iters: 200, epoch: 9 | loss: 0.3292288
	speed: 0.0190s/iter; left time: 39.8831s
	iters: 300, epoch: 9 | loss: 1.3799589
	speed: 0.0179s/iter; left time: 35.6597s
	iters: 400, epoch: 9 | loss: 0.3803501
	speed: 0.0162s/iter; left time: 30.7504s
	iters: 500, epoch: 9 | loss: 0.3074208
	speed: 0.0156s/iter; left time: 27.9457s
	iters: 600, epoch: 9 | loss: 0.3005208
	speed: 0.0154s/iter; left time: 26.1260s
	iters: 700, epoch: 9 | loss: 0.3202687
	speed: 0.0151s/iter; left time: 24.0291s
	iters: 800, epoch: 9 | loss: 0.6211868
	speed: 0.0147s/iter; left time: 21.9762s
	iters: 900, epoch: 9 | loss: 0.4141223
	speed: 0.0144s/iter; left time: 20.1115s
	iters: 1000, epoch: 9 | loss: 0.2423396
	speed: 0.0142s/iter; left time: 18.3711s
	iters: 1100, epoch: 9 | loss: 0.3079306
	speed: 0.0145s/iter; left time: 17.3126s
Epoch: 9 cost time: 16.708173036575317
Epoch: 9, Steps: 1147 | Train Loss: 0.4193129 Vali Loss: 0.4346490 Test Loss: 0.1788802
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 1.1916475
	speed: 0.0176s/iter; left time: 18.4238s
	iters: 200, epoch: 10 | loss: 0.2827856
	speed: 0.0157s/iter; left time: 14.8545s
	iters: 300, epoch: 10 | loss: 0.2967825
	speed: 0.0165s/iter; left time: 14.0260s
	iters: 400, epoch: 10 | loss: 0.2650490
	speed: 0.0159s/iter; left time: 11.9007s
	iters: 500, epoch: 10 | loss: 1.1714190
	speed: 0.0152s/iter; left time: 9.8744s
	iters: 600, epoch: 10 | loss: 0.3690009
	speed: 0.0154s/iter; left time: 8.4290s
	iters: 700, epoch: 10 | loss: 0.3621456
	speed: 0.0154s/iter; left time: 6.8778s
	iters: 800, epoch: 10 | loss: 0.3051309
	speed: 0.0149s/iter; left time: 5.2007s
	iters: 900, epoch: 10 | loss: 0.3116466
	speed: 0.0145s/iter; left time: 3.6083s
	iters: 1000, epoch: 10 | loss: 0.2729900
	speed: 0.0145s/iter; left time: 2.1463s
	iters: 1100, epoch: 10 | loss: 0.5841103
	speed: 0.0146s/iter; left time: 0.7003s
Epoch: 10 cost time: 16.844138383865356
Epoch: 10, Steps: 1147 | Train Loss: 0.4187448 Vali Loss: 0.4350801 Test Loss: 0.1789701
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.17937374114990234, mae:0.22406083345413208
Use GPU: cuda:0
no_skip True
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.4586477
	speed: 0.0175s/iter; left time: 199.2960s
	iters: 200, epoch: 1 | loss: 0.5474495
	speed: 0.0152s/iter; left time: 171.5338s
	iters: 300, epoch: 1 | loss: 0.3390018
	speed: 0.0143s/iter; left time: 159.7254s
	iters: 400, epoch: 1 | loss: 0.5342013
	speed: 0.0140s/iter; left time: 155.4233s
	iters: 500, epoch: 1 | loss: 0.4994159
	speed: 0.0138s/iter; left time: 150.9271s
	iters: 600, epoch: 1 | loss: 0.2977363
	speed: 0.0136s/iter; left time: 147.5836s
	iters: 700, epoch: 1 | loss: 0.4788156
	speed: 0.0137s/iter; left time: 147.5596s
	iters: 800, epoch: 1 | loss: 0.4235579
	speed: 0.0135s/iter; left time: 144.4497s
	iters: 900, epoch: 1 | loss: 0.3862794
	speed: 0.0132s/iter; left time: 139.8117s
	iters: 1000, epoch: 1 | loss: 0.3463953
	speed: 0.0129s/iter; left time: 134.6021s
	iters: 1100, epoch: 1 | loss: 0.3251252
	speed: 0.0129s/iter; left time: 133.2764s
Epoch: 1 cost time: 15.332466840744019
Epoch: 1, Steps: 1147 | Train Loss: 0.5274067 Vali Loss: 0.4589446 Test Loss: 0.1907078
Validation loss decreased (inf --> 0.458945).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4034926
	speed: 0.0152s/iter; left time: 155.8996s
	iters: 200, epoch: 2 | loss: 0.3941601
	speed: 0.0143s/iter; left time: 144.9871s
	iters: 300, epoch: 2 | loss: 0.4702219
	speed: 0.0144s/iter; left time: 144.2735s
	iters: 400, epoch: 2 | loss: 0.3794885
	speed: 0.0147s/iter; left time: 145.4072s
	iters: 500, epoch: 2 | loss: 0.2399672
	speed: 0.0145s/iter; left time: 142.2582s
	iters: 600, epoch: 2 | loss: 0.5666737
	speed: 0.0137s/iter; left time: 133.5034s
	iters: 700, epoch: 2 | loss: 0.4693655
	speed: 0.0138s/iter; left time: 132.4489s
	iters: 800, epoch: 2 | loss: 0.3428546
	speed: 0.0140s/iter; left time: 133.2147s
	iters: 900, epoch: 2 | loss: 0.5625030
	speed: 0.0139s/iter; left time: 131.2467s
	iters: 1000, epoch: 2 | loss: 0.3009157
	speed: 0.0139s/iter; left time: 129.2570s
	iters: 1100, epoch: 2 | loss: 1.4001142
	speed: 0.0136s/iter; left time: 125.6171s
Epoch: 2 cost time: 15.657803297042847
Epoch: 2, Steps: 1147 | Train Loss: 0.4609043 Vali Loss: 0.4377852 Test Loss: 0.1808303
Validation loss decreased (0.458945 --> 0.437785).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4394937
	speed: 0.0167s/iter; left time: 151.8634s
	iters: 200, epoch: 3 | loss: 0.2886066
	speed: 0.0140s/iter; left time: 125.7230s
	iters: 300, epoch: 3 | loss: 0.3193139
	speed: 0.0144s/iter; left time: 128.0828s
	iters: 400, epoch: 3 | loss: 0.5548475
	speed: 0.0144s/iter; left time: 126.7323s
	iters: 500, epoch: 3 | loss: 0.3210379
	speed: 0.0152s/iter; left time: 131.5863s
	iters: 600, epoch: 3 | loss: 0.3115980
	speed: 0.0148s/iter; left time: 126.8413s
	iters: 700, epoch: 3 | loss: 0.3170879
	speed: 0.0145s/iter; left time: 122.7339s
	iters: 800, epoch: 3 | loss: 0.4518076
	speed: 0.0145s/iter; left time: 121.7525s
	iters: 900, epoch: 3 | loss: 0.4366260
	speed: 0.0144s/iter; left time: 118.9520s
	iters: 1000, epoch: 3 | loss: 0.3135565
	speed: 0.0144s/iter; left time: 117.5744s
	iters: 1100, epoch: 3 | loss: 0.3794386
	speed: 0.0141s/iter; left time: 114.0011s
Epoch: 3 cost time: 16.114693880081177
Epoch: 3, Steps: 1147 | Train Loss: 0.4358499 Vali Loss: 0.4266759 Test Loss: 0.1814539
Validation loss decreased (0.437785 --> 0.426676).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5475132
	speed: 0.0181s/iter; left time: 143.5744s
	iters: 200, epoch: 4 | loss: 0.2968210
	speed: 0.0149s/iter; left time: 116.5058s
	iters: 300, epoch: 4 | loss: 1.4543608
	speed: 0.0171s/iter; left time: 132.4969s
	iters: 400, epoch: 4 | loss: 0.3519697
	speed: 0.0174s/iter; left time: 132.4629s
	iters: 500, epoch: 4 | loss: 1.2529796
	speed: 0.0163s/iter; left time: 122.5307s
	iters: 600, epoch: 4 | loss: 0.3999771
	speed: 0.0159s/iter; left time: 118.3281s
	iters: 700, epoch: 4 | loss: 0.3223670
	speed: 0.0159s/iter; left time: 116.3191s
	iters: 800, epoch: 4 | loss: 0.2902804
	speed: 0.0157s/iter; left time: 113.3253s
	iters: 900, epoch: 4 | loss: 0.2817847
	speed: 0.0151s/iter; left time: 107.7739s
	iters: 1000, epoch: 4 | loss: 0.2039176
	speed: 0.0149s/iter; left time: 104.7840s
	iters: 1100, epoch: 4 | loss: 0.2625946
	speed: 0.0148s/iter; left time: 102.8951s
Epoch: 4 cost time: 17.160653829574585
Epoch: 4, Steps: 1147 | Train Loss: 0.4250543 Vali Loss: 0.4192862 Test Loss: 0.1785317
Validation loss decreased (0.426676 --> 0.419286).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3443275
	speed: 0.0200s/iter; left time: 135.7463s
	iters: 200, epoch: 5 | loss: 0.3628224
	speed: 0.0167s/iter; left time: 111.4921s
	iters: 300, epoch: 5 | loss: 0.2380596
	speed: 0.0153s/iter; left time: 100.6276s
	iters: 400, epoch: 5 | loss: 0.2753235
	speed: 0.0151s/iter; left time: 98.1593s
	iters: 500, epoch: 5 | loss: 0.3198587
	speed: 0.0152s/iter; left time: 96.9656s
	iters: 600, epoch: 5 | loss: 1.0097288
	speed: 0.0147s/iter; left time: 92.2655s
	iters: 700, epoch: 5 | loss: 0.4782842
	speed: 0.0144s/iter; left time: 88.7938s
	iters: 800, epoch: 5 | loss: 0.5190740
	speed: 0.0143s/iter; left time: 87.0645s
	iters: 900, epoch: 5 | loss: 0.3263763
	speed: 0.0141s/iter; left time: 84.4508s
	iters: 1000, epoch: 5 | loss: 0.2710193
	speed: 0.0139s/iter; left time: 82.0244s
	iters: 1100, epoch: 5 | loss: 0.2982938
	speed: 0.0139s/iter; left time: 80.5395s
Epoch: 5 cost time: 16.056114435195923
Epoch: 5, Steps: 1147 | Train Loss: 0.4189377 Vali Loss: 0.4230711 Test Loss: 0.1790487
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3109699
	speed: 0.0211s/iter; left time: 118.7737s
	iters: 200, epoch: 6 | loss: 0.3510362
	speed: 0.0164s/iter; left time: 91.0369s
	iters: 300, epoch: 6 | loss: 0.2061976
	speed: 0.0161s/iter; left time: 87.2920s
	iters: 400, epoch: 6 | loss: 0.4648650
	speed: 0.0156s/iter; left time: 83.0784s
	iters: 500, epoch: 6 | loss: 0.7091184
	speed: 0.0147s/iter; left time: 77.1616s
	iters: 600, epoch: 6 | loss: 0.6200461
	speed: 0.0146s/iter; left time: 74.8438s
	iters: 700, epoch: 6 | loss: 0.2627064
	speed: 0.0144s/iter; left time: 72.4269s
	iters: 800, epoch: 6 | loss: 0.3601761
	speed: 0.0143s/iter; left time: 70.3454s
	iters: 900, epoch: 6 | loss: 0.3804321
	speed: 0.0140s/iter; left time: 67.9086s
	iters: 1000, epoch: 6 | loss: 0.3968816
	speed: 0.0140s/iter; left time: 66.2304s
	iters: 1100, epoch: 6 | loss: 0.3456497
	speed: 0.0139s/iter; left time: 64.5594s
Epoch: 6 cost time: 16.153388261795044
Epoch: 6, Steps: 1147 | Train Loss: 0.4148528 Vali Loss: 0.4208489 Test Loss: 0.1785115
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3100828
	speed: 0.0180s/iter; left time: 80.9790s
	iters: 200, epoch: 7 | loss: 0.3320241
	speed: 0.0159s/iter; left time: 69.7222s
	iters: 300, epoch: 7 | loss: 0.2864307
	speed: 0.0152s/iter; left time: 65.3927s
	iters: 400, epoch: 7 | loss: 0.4104146
	speed: 0.0150s/iter; left time: 62.7200s
	iters: 500, epoch: 7 | loss: 0.3461963
	speed: 0.0150s/iter; left time: 61.5185s
	iters: 600, epoch: 7 | loss: 0.2551537
	speed: 0.0150s/iter; left time: 59.7055s
	iters: 700, epoch: 7 | loss: 0.3026337
	speed: 0.0148s/iter; left time: 57.7059s
	iters: 800, epoch: 7 | loss: 0.3324406
	speed: 0.0146s/iter; left time: 55.2760s
	iters: 900, epoch: 7 | loss: 0.2611140
	speed: 0.0145s/iter; left time: 53.3099s
	iters: 1000, epoch: 7 | loss: 0.2992248
	speed: 0.0142s/iter; left time: 50.8411s
	iters: 1100, epoch: 7 | loss: 0.3985387
	speed: 0.0139s/iter; left time: 48.5715s
Epoch: 7 cost time: 16.059289932250977
Epoch: 7, Steps: 1147 | Train Loss: 0.4135207 Vali Loss: 0.4206567 Test Loss: 0.1780339
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 1.1583788
	speed: 0.0194s/iter; left time: 64.7075s
	iters: 200, epoch: 8 | loss: 0.3440828
	speed: 0.0169s/iter; left time: 54.7729s
	iters: 300, epoch: 8 | loss: 0.2305887
	speed: 0.0158s/iter; left time: 49.7546s
	iters: 400, epoch: 8 | loss: 0.2467119
	speed: 0.0150s/iter; left time: 45.5203s
	iters: 500, epoch: 8 | loss: 0.2382228
	speed: 0.0140s/iter; left time: 41.0563s
	iters: 600, epoch: 8 | loss: 0.4687347
	speed: 0.0141s/iter; left time: 40.1289s
	iters: 700, epoch: 8 | loss: 0.2107529
	speed: 0.0139s/iter; left time: 38.0733s
	iters: 800, epoch: 8 | loss: 0.3989688
	speed: 0.0137s/iter; left time: 36.1050s
	iters: 900, epoch: 8 | loss: 0.9883086
	speed: 0.0134s/iter; left time: 34.1427s
	iters: 1000, epoch: 8 | loss: 0.3513014
	speed: 0.0135s/iter; left time: 33.0386s
	iters: 1100, epoch: 8 | loss: 0.2798537
	speed: 0.0135s/iter; left time: 31.6925s
Epoch: 8 cost time: 15.721178770065308
Epoch: 8, Steps: 1147 | Train Loss: 0.4123458 Vali Loss: 0.4208690 Test Loss: 0.1781335
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2982547
	speed: 0.0169s/iter; left time: 37.1736s
	iters: 200, epoch: 9 | loss: 0.2688873
	speed: 0.0154s/iter; left time: 32.3431s
	iters: 300, epoch: 9 | loss: 0.2781555
	speed: 0.0151s/iter; left time: 30.1200s
	iters: 400, epoch: 9 | loss: 0.3402082
	speed: 0.0149s/iter; left time: 28.2266s
	iters: 500, epoch: 9 | loss: 0.3138632
	speed: 0.0146s/iter; left time: 26.2934s
	iters: 600, epoch: 9 | loss: 0.2978263
	speed: 0.0149s/iter; left time: 25.2642s
	iters: 700, epoch: 9 | loss: 0.2700686
	speed: 0.0147s/iter; left time: 23.4506s
	iters: 800, epoch: 9 | loss: 1.0453318
	speed: 0.0145s/iter; left time: 21.7446s
	iters: 900, epoch: 9 | loss: 0.3495748
	speed: 0.0149s/iter; left time: 20.8029s
	iters: 1000, epoch: 9 | loss: 0.4254387
	speed: 0.0149s/iter; left time: 19.2964s
	iters: 1100, epoch: 9 | loss: 0.3421004
	speed: 0.0145s/iter; left time: 17.3496s
Epoch: 9 cost time: 16.757812976837158
Epoch: 9, Steps: 1147 | Train Loss: 0.4117366 Vali Loss: 0.4207402 Test Loss: 0.1777823
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.17853163182735443, mae:0.22240227460861206
Seed: 456
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_192      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip True
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.5598300
	speed: 0.0313s/iter; left time: 354.6719s
	iters: 200, epoch: 1 | loss: 0.4318956
	speed: 0.0232s/iter; left time: 260.7369s
	iters: 300, epoch: 1 | loss: 0.5473776
	speed: 0.0197s/iter; left time: 218.9643s
	iters: 400, epoch: 1 | loss: 0.6181669
	speed: 0.0176s/iter; left time: 194.8244s
	iters: 500, epoch: 1 | loss: 0.4612436
	speed: 0.0169s/iter; left time: 185.0892s
	iters: 600, epoch: 1 | loss: 0.4811499
	speed: 0.0160s/iter; left time: 173.6282s
	iters: 700, epoch: 1 | loss: 0.5398811
	speed: 0.0156s/iter; left time: 167.3696s
	iters: 800, epoch: 1 | loss: 0.4437341
	speed: 0.0151s/iter; left time: 160.3734s
	iters: 900, epoch: 1 | loss: 0.9216923
	speed: 0.0150s/iter; left time: 158.1507s
	iters: 1000, epoch: 1 | loss: 0.5397480
	speed: 0.0149s/iter; left time: 155.3403s
	iters: 1100, epoch: 1 | loss: 0.4648900
	speed: 0.0148s/iter; left time: 152.6963s
Epoch: 1 cost time: 16.795267820358276
Epoch: 1, Steps: 1144 | Train Loss: 0.5958871 Vali Loss: 0.5556654 Test Loss: 0.2397901
Validation loss decreased (inf --> 0.555665).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4859661
	speed: 0.0194s/iter; left time: 197.9910s
	iters: 200, epoch: 2 | loss: 0.4985967
	speed: 0.0171s/iter; left time: 172.2608s
	iters: 300, epoch: 2 | loss: 0.4195430
	speed: 0.0170s/iter; left time: 169.9159s
	iters: 400, epoch: 2 | loss: 0.4647811
	speed: 0.0154s/iter; left time: 152.1052s
	iters: 500, epoch: 2 | loss: 0.8976084
	speed: 0.0147s/iter; left time: 144.4044s
	iters: 600, epoch: 2 | loss: 0.4389752
	speed: 0.0147s/iter; left time: 142.3432s
	iters: 700, epoch: 2 | loss: 0.4263257
	speed: 0.0151s/iter; left time: 144.5723s
	iters: 800, epoch: 2 | loss: 0.4683455
	speed: 0.0145s/iter; left time: 138.0571s
	iters: 900, epoch: 2 | loss: 0.4705301
	speed: 0.0144s/iter; left time: 135.0468s
	iters: 1000, epoch: 2 | loss: 0.4514379
	speed: 0.0144s/iter; left time: 133.8820s
	iters: 1100, epoch: 2 | loss: 0.4627270
	speed: 0.0146s/iter; left time: 134.1619s
Epoch: 2 cost time: 16.590949058532715
Epoch: 2, Steps: 1144 | Train Loss: 0.5282054 Vali Loss: 0.5243862 Test Loss: 0.2325701
Validation loss decreased (0.555665 --> 0.524386).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.8897513
	speed: 0.0189s/iter; left time: 171.3807s
	iters: 200, epoch: 3 | loss: 0.3909788
	speed: 0.0154s/iter; left time: 138.1638s
	iters: 300, epoch: 3 | loss: 0.3888601
	speed: 0.0135s/iter; left time: 119.5153s
	iters: 400, epoch: 3 | loss: 0.4665807
	speed: 0.0134s/iter; left time: 117.4072s
	iters: 500, epoch: 3 | loss: 0.3508510
	speed: 0.0132s/iter; left time: 114.1989s
	iters: 600, epoch: 3 | loss: 0.4489175
	speed: 0.0129s/iter; left time: 110.1878s
	iters: 700, epoch: 3 | loss: 0.3780634
	speed: 0.0130s/iter; left time: 109.9316s
	iters: 800, epoch: 3 | loss: 0.5448037
	speed: 0.0129s/iter; left time: 107.4639s
	iters: 900, epoch: 3 | loss: 0.5070418
	speed: 0.0129s/iter; left time: 106.4866s
	iters: 1000, epoch: 3 | loss: 0.3671663
	speed: 0.0132s/iter; left time: 107.2995s
	iters: 1100, epoch: 3 | loss: 0.3660738
	speed: 0.0131s/iter; left time: 105.3768s
Epoch: 3 cost time: 15.02505898475647
Epoch: 3, Steps: 1144 | Train Loss: 0.5056691 Vali Loss: 0.5101795 Test Loss: 0.2268293
Validation loss decreased (0.524386 --> 0.510180).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5146267
	speed: 0.0197s/iter; left time: 155.6192s
	iters: 200, epoch: 4 | loss: 0.4121584
	speed: 0.0171s/iter; left time: 133.4544s
	iters: 300, epoch: 4 | loss: 0.4924203
	speed: 0.0157s/iter; left time: 121.0244s
	iters: 400, epoch: 4 | loss: 0.5956519
	speed: 0.0156s/iter; left time: 118.9716s
	iters: 500, epoch: 4 | loss: 0.3970994
	speed: 0.0155s/iter; left time: 116.7296s
	iters: 600, epoch: 4 | loss: 0.5219576
	speed: 0.0151s/iter; left time: 112.1974s
	iters: 700, epoch: 4 | loss: 0.3810237
	speed: 0.0148s/iter; left time: 107.8528s
	iters: 800, epoch: 4 | loss: 0.4972469
	speed: 0.0148s/iter; left time: 106.6868s
	iters: 900, epoch: 4 | loss: 0.6953083
	speed: 0.0147s/iter; left time: 104.6197s
	iters: 1000, epoch: 4 | loss: 0.3908265
	speed: 0.0146s/iter; left time: 102.1329s
	iters: 1100, epoch: 4 | loss: 0.4305892
	speed: 0.0144s/iter; left time: 99.5501s
Epoch: 4 cost time: 16.491289615631104
Epoch: 4, Steps: 1144 | Train Loss: 0.4944796 Vali Loss: 0.5010746 Test Loss: 0.2254285
Validation loss decreased (0.510180 --> 0.501075).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3403202
	speed: 0.0169s/iter; left time: 114.0877s
	iters: 200, epoch: 5 | loss: 0.5786130
	speed: 0.0152s/iter; left time: 101.0283s
	iters: 300, epoch: 5 | loss: 0.4350537
	speed: 0.0148s/iter; left time: 96.9387s
	iters: 400, epoch: 5 | loss: 0.7727441
	speed: 0.0143s/iter; left time: 92.6938s
	iters: 500, epoch: 5 | loss: 0.2743719
	speed: 0.0144s/iter; left time: 91.5058s
	iters: 600, epoch: 5 | loss: 0.4097748
	speed: 0.0140s/iter; left time: 87.8690s
	iters: 700, epoch: 5 | loss: 0.4419010
	speed: 0.0140s/iter; left time: 86.1805s
	iters: 800, epoch: 5 | loss: 0.3702594
	speed: 0.0138s/iter; left time: 83.8086s
	iters: 900, epoch: 5 | loss: 0.9611647
	speed: 0.0138s/iter; left time: 82.1171s
	iters: 1000, epoch: 5 | loss: 0.3593954
	speed: 0.0137s/iter; left time: 80.4995s
	iters: 1100, epoch: 5 | loss: 0.8248352
	speed: 0.0138s/iter; left time: 79.4612s
Epoch: 5 cost time: 15.837377548217773
Epoch: 5, Steps: 1144 | Train Loss: 0.4876864 Vali Loss: 0.5011278 Test Loss: 0.2250929
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4139883
	speed: 0.0177s/iter; left time: 99.5318s
	iters: 200, epoch: 6 | loss: 0.2836062
	speed: 0.0173s/iter; left time: 95.4172s
	iters: 300, epoch: 6 | loss: 0.5816461
	speed: 0.0160s/iter; left time: 86.6451s
	iters: 400, epoch: 6 | loss: 0.4494717
	speed: 0.0154s/iter; left time: 81.8720s
	iters: 500, epoch: 6 | loss: 0.3799616
	speed: 0.0154s/iter; left time: 80.2066s
	iters: 600, epoch: 6 | loss: 0.8393096
	speed: 0.0155s/iter; left time: 79.1258s
	iters: 700, epoch: 6 | loss: 0.3996731
	speed: 0.0147s/iter; left time: 73.7329s
	iters: 800, epoch: 6 | loss: 0.4520799
	speed: 0.0146s/iter; left time: 72.0356s
	iters: 900, epoch: 6 | loss: 0.4388178
	speed: 0.0148s/iter; left time: 71.1300s
	iters: 1000, epoch: 6 | loss: 0.3703253
	speed: 0.0146s/iter; left time: 68.9880s
	iters: 1100, epoch: 6 | loss: 0.4012176
	speed: 0.0145s/iter; left time: 67.1897s
Epoch: 6 cost time: 16.732231855392456
Epoch: 6, Steps: 1144 | Train Loss: 0.4839183 Vali Loss: 0.5020274 Test Loss: 0.2249848
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3854230
	speed: 0.0174s/iter; left time: 77.9028s
	iters: 200, epoch: 7 | loss: 0.4305634
	speed: 0.0133s/iter; left time: 58.1160s
	iters: 300, epoch: 7 | loss: 0.5183398
	speed: 0.0131s/iter; left time: 55.8890s
	iters: 400, epoch: 7 | loss: 0.8715208
	speed: 0.0137s/iter; left time: 57.2390s
	iters: 500, epoch: 7 | loss: 0.2807010
	speed: 0.0138s/iter; left time: 56.3248s
	iters: 600, epoch: 7 | loss: 0.4961067
	speed: 0.0136s/iter; left time: 54.1862s
	iters: 700, epoch: 7 | loss: 0.4475582
	speed: 0.0135s/iter; left time: 52.3116s
	iters: 800, epoch: 7 | loss: 0.3693049
	speed: 0.0134s/iter; left time: 50.6273s
	iters: 900, epoch: 7 | loss: 0.3139757
	speed: 0.0135s/iter; left time: 49.6592s
	iters: 1000, epoch: 7 | loss: 0.3861683
	speed: 0.0132s/iter; left time: 47.3780s
	iters: 1100, epoch: 7 | loss: 0.3755810
	speed: 0.0132s/iter; left time: 45.8595s
Epoch: 7 cost time: 15.20797872543335
Epoch: 7, Steps: 1144 | Train Loss: 0.4818814 Vali Loss: 0.4999532 Test Loss: 0.2245016
Validation loss decreased (0.501075 --> 0.499953).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.8910018
	speed: 0.0152s/iter; left time: 50.7907s
	iters: 200, epoch: 8 | loss: 0.3656148
	speed: 0.0135s/iter; left time: 43.5565s
	iters: 300, epoch: 8 | loss: 0.4247072
	speed: 0.0135s/iter; left time: 42.1805s
	iters: 400, epoch: 8 | loss: 0.5133530
	speed: 0.0128s/iter; left time: 38.7792s
	iters: 500, epoch: 8 | loss: 0.4255675
	speed: 0.0125s/iter; left time: 36.6366s
	iters: 600, epoch: 8 | loss: 0.4020066
	speed: 0.0122s/iter; left time: 34.6531s
	iters: 700, epoch: 8 | loss: 0.3329296
	speed: 0.0123s/iter; left time: 33.5902s
	iters: 800, epoch: 8 | loss: 0.4049152
	speed: 0.0121s/iter; left time: 31.9624s
	iters: 900, epoch: 8 | loss: 0.8123240
	speed: 0.0122s/iter; left time: 30.9753s
	iters: 1000, epoch: 8 | loss: 0.8406892
	speed: 0.0120s/iter; left time: 29.2808s
	iters: 1100, epoch: 8 | loss: 0.2894529
	speed: 0.0122s/iter; left time: 28.4303s
Epoch: 8 cost time: 14.004886627197266
Epoch: 8, Steps: 1144 | Train Loss: 0.4807656 Vali Loss: 0.5005322 Test Loss: 0.2244818
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4505362
	speed: 0.0190s/iter; left time: 41.5730s
	iters: 200, epoch: 9 | loss: 0.4632700
	speed: 0.0167s/iter; left time: 34.7909s
	iters: 300, epoch: 9 | loss: 0.5061016
	speed: 0.0162s/iter; left time: 32.2033s
	iters: 400, epoch: 9 | loss: 0.3779565
	speed: 0.0160s/iter; left time: 30.2249s
	iters: 500, epoch: 9 | loss: 0.4305279
	speed: 0.0153s/iter; left time: 27.3554s
	iters: 600, epoch: 9 | loss: 0.3497385
	speed: 0.0148s/iter; left time: 24.9330s
	iters: 700, epoch: 9 | loss: 0.4557703
	speed: 0.0148s/iter; left time: 23.4557s
	iters: 800, epoch: 9 | loss: 0.4585223
	speed: 0.0147s/iter; left time: 21.8713s
	iters: 900, epoch: 9 | loss: 0.3966742
	speed: 0.0143s/iter; left time: 19.8285s
	iters: 1000, epoch: 9 | loss: 0.3723291
	speed: 0.0140s/iter; left time: 18.0010s
	iters: 1100, epoch: 9 | loss: 0.5627927
	speed: 0.0141s/iter; left time: 16.7336s
Epoch: 9 cost time: 16.26046586036682
Epoch: 9, Steps: 1144 | Train Loss: 0.4800615 Vali Loss: 0.5002958 Test Loss: 0.2244422
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3351977
	speed: 0.0202s/iter; left time: 21.0740s
	iters: 200, epoch: 10 | loss: 0.4697205
	speed: 0.0157s/iter; left time: 14.8003s
	iters: 300, epoch: 10 | loss: 0.3507117
	speed: 0.0148s/iter; left time: 12.5407s
	iters: 400, epoch: 10 | loss: 0.3031605
	speed: 0.0159s/iter; left time: 11.8643s
	iters: 500, epoch: 10 | loss: 0.4967410
	speed: 0.0153s/iter; left time: 9.8809s
	iters: 600, epoch: 10 | loss: 0.7992129
	speed: 0.0152s/iter; left time: 8.2966s
	iters: 700, epoch: 10 | loss: 0.3862178
	speed: 0.0147s/iter; left time: 6.5289s
	iters: 800, epoch: 10 | loss: 0.4372183
	speed: 0.0143s/iter; left time: 4.9193s
	iters: 900, epoch: 10 | loss: 0.3332323
	speed: 0.0141s/iter; left time: 3.4508s
	iters: 1000, epoch: 10 | loss: 0.3569562
	speed: 0.0141s/iter; left time: 2.0464s
	iters: 1100, epoch: 10 | loss: 0.3711974
	speed: 0.0141s/iter; left time: 0.6348s
Epoch: 10 cost time: 16.237969398498535
Epoch: 10, Steps: 1144 | Train Loss: 0.4801159 Vali Loss: 0.5009504 Test Loss: 0.2244771
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.22450166940689087, mae:0.26138973236083984
Use GPU: cuda:0
no_skip True
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 1.5460811
	speed: 0.0199s/iter; left time: 225.9973s
	iters: 200, epoch: 1 | loss: 0.4216074
	speed: 0.0182s/iter; left time: 205.0895s
	iters: 300, epoch: 1 | loss: 0.4350226
	speed: 0.0162s/iter; left time: 180.1985s
	iters: 400, epoch: 1 | loss: 0.5334724
	speed: 0.0167s/iter; left time: 184.4893s
	iters: 500, epoch: 1 | loss: 1.2243353
	speed: 0.0167s/iter; left time: 182.7413s
	iters: 600, epoch: 1 | loss: 0.5695462
	speed: 0.0166s/iter; left time: 180.4790s
	iters: 700, epoch: 1 | loss: 0.4018761
	speed: 0.0163s/iter; left time: 175.6048s
	iters: 800, epoch: 1 | loss: 0.4228220
	speed: 0.0162s/iter; left time: 172.6943s
	iters: 900, epoch: 1 | loss: 0.6032473
	speed: 0.0156s/iter; left time: 164.7546s
	iters: 1000, epoch: 1 | loss: 0.4356909
	speed: 0.0154s/iter; left time: 161.0617s
	iters: 1100, epoch: 1 | loss: 0.3875438
	speed: 0.0151s/iter; left time: 156.3472s
Epoch: 1 cost time: 17.25363564491272
Epoch: 1, Steps: 1144 | Train Loss: 0.5829383 Vali Loss: 0.5459717 Test Loss: 0.2366738
Validation loss decreased (inf --> 0.545972).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4554676
	speed: 0.0185s/iter; left time: 188.4948s
	iters: 200, epoch: 2 | loss: 0.5222710
	speed: 0.0156s/iter; left time: 157.5832s
	iters: 300, epoch: 2 | loss: 0.4000690
	speed: 0.0144s/iter; left time: 144.2347s
	iters: 400, epoch: 2 | loss: 0.4526226
	speed: 0.0143s/iter; left time: 141.1614s
	iters: 500, epoch: 2 | loss: 0.9115264
	speed: 0.0142s/iter; left time: 138.7504s
	iters: 600, epoch: 2 | loss: 0.4733431
	speed: 0.0140s/iter; left time: 136.0145s
	iters: 700, epoch: 2 | loss: 0.8457949
	speed: 0.0138s/iter; left time: 131.9592s
	iters: 800, epoch: 2 | loss: 0.3889257
	speed: 0.0137s/iter; left time: 130.1727s
	iters: 900, epoch: 2 | loss: 0.4391635
	speed: 0.0139s/iter; left time: 130.1678s
	iters: 1000, epoch: 2 | loss: 0.3852314
	speed: 0.0139s/iter; left time: 129.2312s
	iters: 1100, epoch: 2 | loss: 0.5495567
	speed: 0.0138s/iter; left time: 126.6802s
Epoch: 2 cost time: 15.803860902786255
Epoch: 2, Steps: 1144 | Train Loss: 0.5219050 Vali Loss: 0.5183823 Test Loss: 0.2330438
Validation loss decreased (0.545972 --> 0.518382).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3184264
	speed: 0.0195s/iter; left time: 176.4375s
	iters: 200, epoch: 3 | loss: 0.5260052
	speed: 0.0169s/iter; left time: 150.9429s
	iters: 300, epoch: 3 | loss: 0.3356412
	speed: 0.0162s/iter; left time: 143.7367s
	iters: 400, epoch: 3 | loss: 0.5442933
	speed: 0.0151s/iter; left time: 132.0715s
	iters: 500, epoch: 3 | loss: 0.7764342
	speed: 0.0147s/iter; left time: 127.1393s
	iters: 600, epoch: 3 | loss: 1.0062330
	speed: 0.0145s/iter; left time: 123.7051s
	iters: 700, epoch: 3 | loss: 0.8205127
	speed: 0.0146s/iter; left time: 123.2812s
	iters: 800, epoch: 3 | loss: 0.3718051
	speed: 0.0143s/iter; left time: 119.2239s
	iters: 900, epoch: 3 | loss: 0.3414387
	speed: 0.0142s/iter; left time: 117.1560s
	iters: 1000, epoch: 3 | loss: 0.3888910
	speed: 0.0140s/iter; left time: 114.2187s
	iters: 1100, epoch: 3 | loss: 0.3617005
	speed: 0.0139s/iter; left time: 111.8150s
Epoch: 3 cost time: 16.217174291610718
Epoch: 3, Steps: 1144 | Train Loss: 0.5072607 Vali Loss: 0.5060456 Test Loss: 0.2279533
Validation loss decreased (0.518382 --> 0.506046).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5609308
	speed: 0.0110s/iter; left time: 86.8338s
	iters: 200, epoch: 4 | loss: 0.3949783
	speed: 0.0103s/iter; left time: 80.1715s
	iters: 300, epoch: 4 | loss: 0.4145752
	speed: 0.0095s/iter; left time: 72.9222s
	iters: 400, epoch: 4 | loss: 0.4577507
	speed: 0.0089s/iter; left time: 67.4319s
	iters: 500, epoch: 4 | loss: 0.8943763
	speed: 0.0085s/iter; left time: 64.0876s
	iters: 600, epoch: 4 | loss: 0.4139020
	speed: 0.0086s/iter; left time: 63.6582s
	iters: 700, epoch: 4 | loss: 0.3768216
	speed: 0.0083s/iter; left time: 60.9895s
	iters: 800, epoch: 4 | loss: 0.4750373
	speed: 0.0081s/iter; left time: 58.7525s
	iters: 900, epoch: 4 | loss: 0.4712634
	speed: 0.0081s/iter; left time: 57.4259s
	iters: 1000, epoch: 4 | loss: 0.8574851
	speed: 0.0093s/iter; left time: 65.0753s
	iters: 1100, epoch: 4 | loss: 0.4876634
	speed: 0.0096s/iter; left time: 66.4166s
Epoch: 4 cost time: 11.234350442886353
Epoch: 4, Steps: 1144 | Train Loss: 0.4942480 Vali Loss: 0.5046477 Test Loss: 0.2271808
Validation loss decreased (0.506046 --> 0.504648).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.8655971
	speed: 0.0200s/iter; left time: 135.5921s
	iters: 200, epoch: 5 | loss: 0.4418885
	speed: 0.0169s/iter; left time: 112.6830s
	iters: 300, epoch: 5 | loss: 0.8148708
	speed: 0.0197s/iter; left time: 129.6105s
	iters: 400, epoch: 5 | loss: 0.4113401
	speed: 0.0176s/iter; left time: 113.5794s
	iters: 500, epoch: 5 | loss: 0.4173003
	speed: 0.0170s/iter; left time: 108.2152s
	iters: 600, epoch: 5 | loss: 0.7875009
	speed: 0.0167s/iter; left time: 104.8782s
	iters: 700, epoch: 5 | loss: 0.4087737
	speed: 0.0163s/iter; left time: 100.6990s
	iters: 800, epoch: 5 | loss: 0.3996719
	speed: 0.0157s/iter; left time: 95.4551s
	iters: 900, epoch: 5 | loss: 0.4292271
	speed: 0.0158s/iter; left time: 94.0287s
	iters: 1000, epoch: 5 | loss: 0.3889722
	speed: 0.0156s/iter; left time: 91.6493s
	iters: 1100, epoch: 5 | loss: 0.9500101
	speed: 0.0153s/iter; left time: 88.4824s
Epoch: 5 cost time: 17.444254636764526
Epoch: 5, Steps: 1144 | Train Loss: 0.4881500 Vali Loss: 0.5029050 Test Loss: 0.2259175
Validation loss decreased (0.504648 --> 0.502905).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4048531
	speed: 0.0184s/iter; left time: 103.6034s
	iters: 200, epoch: 6 | loss: 0.3470713
	speed: 0.0175s/iter; left time: 96.3916s
	iters: 300, epoch: 6 | loss: 0.4278193
	speed: 0.0156s/iter; left time: 84.3017s
	iters: 400, epoch: 6 | loss: 0.3375121
	speed: 0.0148s/iter; left time: 79.0056s
	iters: 500, epoch: 6 | loss: 0.3661468
	speed: 0.0154s/iter; left time: 80.5528s
	iters: 600, epoch: 6 | loss: 0.3914307
	speed: 0.0152s/iter; left time: 77.6538s
	iters: 700, epoch: 6 | loss: 1.2506962
	speed: 0.0151s/iter; left time: 75.8797s
	iters: 800, epoch: 6 | loss: 0.3053422
	speed: 0.0153s/iter; left time: 75.3447s
	iters: 900, epoch: 6 | loss: 0.3388173
	speed: 0.0152s/iter; left time: 73.4242s
	iters: 1000, epoch: 6 | loss: 0.3278408
	speed: 0.0150s/iter; left time: 70.7237s
	iters: 1100, epoch: 6 | loss: 0.3300628
	speed: 0.0148s/iter; left time: 68.4914s
Epoch: 6 cost time: 16.96946668624878
Epoch: 6, Steps: 1144 | Train Loss: 0.4848912 Vali Loss: 0.5026664 Test Loss: 0.2256254
Validation loss decreased (0.502905 --> 0.502666).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4359663
	speed: 0.0172s/iter; left time: 76.8448s
	iters: 200, epoch: 7 | loss: 0.3152710
	speed: 0.0168s/iter; left time: 73.3821s
	iters: 300, epoch: 7 | loss: 0.4563498
	speed: 0.0156s/iter; left time: 66.5300s
	iters: 400, epoch: 7 | loss: 0.4092723
	speed: 0.0153s/iter; left time: 63.7101s
	iters: 500, epoch: 7 | loss: 0.4520414
	speed: 0.0147s/iter; left time: 60.0407s
	iters: 600, epoch: 7 | loss: 0.3996148
	speed: 0.0146s/iter; left time: 58.0094s
	iters: 700, epoch: 7 | loss: 0.3969489
	speed: 0.0144s/iter; left time: 55.8657s
	iters: 800, epoch: 7 | loss: 0.4205874
	speed: 0.0145s/iter; left time: 54.7155s
	iters: 900, epoch: 7 | loss: 0.3705696
	speed: 0.0143s/iter; left time: 52.4520s
	iters: 1000, epoch: 7 | loss: 0.4146942
	speed: 0.0141s/iter; left time: 50.5651s
	iters: 1100, epoch: 7 | loss: 0.3842499
	speed: 0.0141s/iter; left time: 49.0511s
Epoch: 7 cost time: 16.402727603912354
Epoch: 7, Steps: 1144 | Train Loss: 0.4831701 Vali Loss: 0.5029399 Test Loss: 0.2258083
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3563244
	speed: 0.0159s/iter; left time: 52.8741s
	iters: 200, epoch: 8 | loss: 0.2870854
	speed: 0.0151s/iter; left time: 48.9716s
	iters: 300, epoch: 8 | loss: 0.3271779
	speed: 0.0172s/iter; left time: 53.8874s
	iters: 400, epoch: 8 | loss: 0.4130846
	speed: 0.0164s/iter; left time: 49.7413s
	iters: 500, epoch: 8 | loss: 0.3916064
	speed: 0.0161s/iter; left time: 47.1594s
	iters: 600, epoch: 8 | loss: 0.2872157
	speed: 0.0160s/iter; left time: 45.3877s
	iters: 700, epoch: 8 | loss: 0.4482280
	speed: 0.0157s/iter; left time: 43.0025s
	iters: 800, epoch: 8 | loss: 0.3905887
	speed: 0.0158s/iter; left time: 41.5318s
	iters: 900, epoch: 8 | loss: 0.3418069
	speed: 0.0155s/iter; left time: 39.3126s
	iters: 1000, epoch: 8 | loss: 1.1674870
	speed: 0.0153s/iter; left time: 37.2333s
	iters: 1100, epoch: 8 | loss: 0.3835636
	speed: 0.0151s/iter; left time: 35.2646s
Epoch: 8 cost time: 17.283145904541016
Epoch: 8, Steps: 1144 | Train Loss: 0.4820013 Vali Loss: 0.5026780 Test Loss: 0.2255822
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3745622
	speed: 0.0179s/iter; left time: 39.2508s
	iters: 200, epoch: 9 | loss: 0.3403282
	speed: 0.0146s/iter; left time: 30.3973s
	iters: 300, epoch: 9 | loss: 0.3700762
	speed: 0.0139s/iter; left time: 27.6270s
	iters: 400, epoch: 9 | loss: 0.4660756
	speed: 0.0138s/iter; left time: 26.1441s
	iters: 500, epoch: 9 | loss: 0.7911869
	speed: 0.0134s/iter; left time: 23.8971s
	iters: 600, epoch: 9 | loss: 0.3938690
	speed: 0.0136s/iter; left time: 22.9589s
	iters: 700, epoch: 9 | loss: 0.3107518
	speed: 0.0138s/iter; left time: 21.8741s
	iters: 800, epoch: 9 | loss: 0.3024726
	speed: 0.0143s/iter; left time: 21.2740s
	iters: 900, epoch: 9 | loss: 0.4853849
	speed: 0.0142s/iter; left time: 19.6555s
	iters: 1000, epoch: 9 | loss: 0.8683820
	speed: 0.0141s/iter; left time: 18.1298s
	iters: 1100, epoch: 9 | loss: 0.3923149
	speed: 0.0143s/iter; left time: 17.0399s
Epoch: 9 cost time: 16.496384143829346
Epoch: 9, Steps: 1144 | Train Loss: 0.4816946 Vali Loss: 0.5021214 Test Loss: 0.2256827
Validation loss decreased (0.502666 --> 0.502121).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.8845292
	speed: 0.0184s/iter; left time: 19.1816s
	iters: 200, epoch: 10 | loss: 0.4379211
	speed: 0.0151s/iter; left time: 14.2518s
	iters: 300, epoch: 10 | loss: 0.5023790
	speed: 0.0131s/iter; left time: 11.0287s
	iters: 400, epoch: 10 | loss: 0.3565670
	speed: 0.0133s/iter; left time: 9.9280s
	iters: 500, epoch: 10 | loss: 0.5001125
	speed: 0.0142s/iter; left time: 9.1811s
	iters: 600, epoch: 10 | loss: 0.4018322
	speed: 0.0147s/iter; left time: 8.0315s
	iters: 700, epoch: 10 | loss: 0.4554213
	speed: 0.0150s/iter; left time: 6.6673s
	iters: 800, epoch: 10 | loss: 0.8283332
	speed: 0.0151s/iter; left time: 5.2023s
	iters: 900, epoch: 10 | loss: 0.4478386
	speed: 0.0150s/iter; left time: 3.6811s
	iters: 1000, epoch: 10 | loss: 0.3162712
	speed: 0.0149s/iter; left time: 2.1551s
	iters: 1100, epoch: 10 | loss: 0.3993924
	speed: 0.0153s/iter; left time: 0.6864s
Epoch: 10 cost time: 17.790305137634277
Epoch: 10, Steps: 1144 | Train Loss: 0.4815459 Vali Loss: 0.5028632 Test Loss: 0.2256779
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.22568264603614807, mae:0.2631586492061615
Use GPU: cuda:0
no_skip True
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.6206830
	speed: 0.0165s/iter; left time: 187.5973s
	iters: 200, epoch: 1 | loss: 0.4918149
	speed: 0.0147s/iter; left time: 165.4236s
	iters: 300, epoch: 1 | loss: 0.6719165
	speed: 0.0150s/iter; left time: 167.0018s
	iters: 400, epoch: 1 | loss: 0.4690309
	speed: 0.0148s/iter; left time: 163.7658s
	iters: 500, epoch: 1 | loss: 0.4770382
	speed: 0.0152s/iter; left time: 166.1586s
	iters: 600, epoch: 1 | loss: 0.4253823
	speed: 0.0152s/iter; left time: 164.3225s
	iters: 700, epoch: 1 | loss: 0.5894863
	speed: 0.0149s/iter; left time: 160.0997s
	iters: 800, epoch: 1 | loss: 0.9288120
	speed: 0.0150s/iter; left time: 159.3263s
	iters: 900, epoch: 1 | loss: 0.3744167
	speed: 0.0150s/iter; left time: 158.4387s
	iters: 1000, epoch: 1 | loss: 0.6374890
	speed: 0.0153s/iter; left time: 159.7882s
	iters: 1100, epoch: 1 | loss: 0.5167314
	speed: 0.0152s/iter; left time: 157.0279s
Epoch: 1 cost time: 17.38280940055847
Epoch: 1, Steps: 1144 | Train Loss: 0.5921896 Vali Loss: 0.5745315 Test Loss: 0.2446742
Validation loss decreased (inf --> 0.574531).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5287728
	speed: 0.0177s/iter; left time: 180.1394s
	iters: 200, epoch: 2 | loss: 0.4291270
	speed: 0.0164s/iter; left time: 165.8793s
	iters: 300, epoch: 2 | loss: 0.5147033
	speed: 0.0152s/iter; left time: 151.5798s
	iters: 400, epoch: 2 | loss: 0.4049271
	speed: 0.0144s/iter; left time: 142.7226s
	iters: 500, epoch: 2 | loss: 0.4552556
	speed: 0.0150s/iter; left time: 147.1692s
	iters: 600, epoch: 2 | loss: 0.8464897
	speed: 0.0152s/iter; left time: 147.3118s
	iters: 700, epoch: 2 | loss: 0.4411176
	speed: 0.0148s/iter; left time: 141.9059s
	iters: 800, epoch: 2 | loss: 0.4080273
	speed: 0.0146s/iter; left time: 138.7496s
	iters: 900, epoch: 2 | loss: 0.5260563
	speed: 0.0147s/iter; left time: 138.3053s
	iters: 1000, epoch: 2 | loss: 0.4886982
	speed: 0.0149s/iter; left time: 138.7297s
	iters: 1100, epoch: 2 | loss: 0.8045248
	speed: 0.0148s/iter; left time: 135.9722s
Epoch: 2 cost time: 17.033557415008545
Epoch: 2, Steps: 1144 | Train Loss: 0.5259207 Vali Loss: 0.5262216 Test Loss: 0.2341690
Validation loss decreased (0.574531 --> 0.526222).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4220355
	speed: 0.0207s/iter; left time: 187.3088s
	iters: 200, epoch: 3 | loss: 0.3707041
	speed: 0.0184s/iter; left time: 165.0125s
	iters: 300, epoch: 3 | loss: 0.8250796
	speed: 0.0161s/iter; left time: 142.1421s
	iters: 400, epoch: 3 | loss: 0.4634224
	speed: 0.0156s/iter; left time: 136.7853s
	iters: 500, epoch: 3 | loss: 0.3656953
	speed: 0.0157s/iter; left time: 135.7858s
	iters: 600, epoch: 3 | loss: 0.8190446
	speed: 0.0152s/iter; left time: 129.6721s
	iters: 700, epoch: 3 | loss: 0.4286992
	speed: 0.0148s/iter; left time: 125.0631s
	iters: 800, epoch: 3 | loss: 0.4223230
	speed: 0.0146s/iter; left time: 122.3120s
	iters: 900, epoch: 3 | loss: 0.4620301
	speed: 0.0149s/iter; left time: 122.7137s
	iters: 1000, epoch: 3 | loss: 0.3728908
	speed: 0.0148s/iter; left time: 120.8569s
	iters: 1100, epoch: 3 | loss: 0.3930942
	speed: 0.0145s/iter; left time: 116.4057s
Epoch: 3 cost time: 16.552554607391357
Epoch: 3, Steps: 1144 | Train Loss: 0.5047760 Vali Loss: 0.5084068 Test Loss: 0.2305276
Validation loss decreased (0.526222 --> 0.508407).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.9231857
	speed: 0.0178s/iter; left time: 141.1186s
	iters: 200, epoch: 4 | loss: 0.4457134
	speed: 0.0149s/iter; left time: 116.5054s
	iters: 300, epoch: 4 | loss: 0.3782578
	speed: 0.0135s/iter; left time: 104.1592s
	iters: 400, epoch: 4 | loss: 0.3288648
	speed: 0.0137s/iter; left time: 104.3599s
	iters: 500, epoch: 4 | loss: 0.3972936
	speed: 0.0140s/iter; left time: 104.9884s
	iters: 600, epoch: 4 | loss: 0.3989829
	speed: 0.0135s/iter; left time: 99.7426s
	iters: 700, epoch: 4 | loss: 0.3892514
	speed: 0.0135s/iter; left time: 98.4680s
	iters: 800, epoch: 4 | loss: 0.3782448
	speed: 0.0138s/iter; left time: 99.5030s
	iters: 900, epoch: 4 | loss: 0.5035682
	speed: 0.0137s/iter; left time: 97.2452s
	iters: 1000, epoch: 4 | loss: 0.3778006
	speed: 0.0139s/iter; left time: 97.2245s
	iters: 1100, epoch: 4 | loss: 0.3247564
	speed: 0.0144s/iter; left time: 99.4278s
Epoch: 4 cost time: 16.63344645500183
Epoch: 4, Steps: 1144 | Train Loss: 0.4935611 Vali Loss: 0.5034759 Test Loss: 0.2289903
Validation loss decreased (0.508407 --> 0.503476).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3917601
	speed: 0.0190s/iter; left time: 128.6814s
	iters: 200, epoch: 5 | loss: 0.5716962
	speed: 0.0156s/iter; left time: 103.7305s
	iters: 300, epoch: 5 | loss: 0.8127400
	speed: 0.0147s/iter; left time: 96.3392s
	iters: 400, epoch: 5 | loss: 0.3387134
	speed: 0.0135s/iter; left time: 87.5951s
	iters: 500, epoch: 5 | loss: 0.3221579
	speed: 0.0138s/iter; left time: 87.9863s
	iters: 600, epoch: 5 | loss: 0.3252905
	speed: 0.0134s/iter; left time: 84.0368s
	iters: 700, epoch: 5 | loss: 0.4059776
	speed: 0.0134s/iter; left time: 82.7231s
	iters: 800, epoch: 5 | loss: 0.5318917
	speed: 0.0136s/iter; left time: 82.3559s
	iters: 900, epoch: 5 | loss: 0.3535779
	speed: 0.0136s/iter; left time: 81.2242s
	iters: 1000, epoch: 5 | loss: 0.3877375
	speed: 0.0139s/iter; left time: 81.4539s
	iters: 1100, epoch: 5 | loss: 0.3014815
	speed: 0.0139s/iter; left time: 79.9254s
Epoch: 5 cost time: 15.830394744873047
Epoch: 5, Steps: 1144 | Train Loss: 0.4871596 Vali Loss: 0.5036742 Test Loss: 0.2288773
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3777692
	speed: 0.0148s/iter; left time: 83.3823s
	iters: 200, epoch: 6 | loss: 0.4069036
	speed: 0.0144s/iter; left time: 79.2957s
	iters: 300, epoch: 6 | loss: 0.3859269
	speed: 0.0143s/iter; left time: 77.6329s
	iters: 400, epoch: 6 | loss: 0.4152217
	speed: 0.0143s/iter; left time: 75.8932s
	iters: 500, epoch: 6 | loss: 0.4151044
	speed: 0.0145s/iter; left time: 75.8927s
	iters: 600, epoch: 6 | loss: 0.3663098
	speed: 0.0143s/iter; left time: 73.1852s
	iters: 700, epoch: 6 | loss: 0.4095322
	speed: 0.0142s/iter; left time: 71.4335s
	iters: 800, epoch: 6 | loss: 0.4539246
	speed: 0.0142s/iter; left time: 70.0061s
	iters: 900, epoch: 6 | loss: 0.3401624
	speed: 0.0139s/iter; left time: 67.1757s
	iters: 1000, epoch: 6 | loss: 0.4070044
	speed: 0.0138s/iter; left time: 65.1772s
	iters: 1100, epoch: 6 | loss: 0.4003516
	speed: 0.0140s/iter; left time: 64.6932s
Epoch: 6 cost time: 16.109061241149902
Epoch: 6, Steps: 1144 | Train Loss: 0.4834181 Vali Loss: 0.5043827 Test Loss: 0.2283747
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3820986
	speed: 0.0165s/iter; left time: 73.6508s
	iters: 200, epoch: 7 | loss: 0.9346077
	speed: 0.0138s/iter; left time: 60.2138s
	iters: 300, epoch: 7 | loss: 0.4282872
	speed: 0.0152s/iter; left time: 65.1007s
	iters: 400, epoch: 7 | loss: 0.5127392
	speed: 0.0147s/iter; left time: 61.2792s
	iters: 500, epoch: 7 | loss: 0.5551487
	speed: 0.0143s/iter; left time: 58.4053s
	iters: 600, epoch: 7 | loss: 0.4910989
	speed: 0.0140s/iter; left time: 55.7205s
	iters: 700, epoch: 7 | loss: 0.5345505
	speed: 0.0138s/iter; left time: 53.4527s
	iters: 800, epoch: 7 | loss: 0.4373743
	speed: 0.0138s/iter; left time: 52.3039s
	iters: 900, epoch: 7 | loss: 0.3272817
	speed: 0.0141s/iter; left time: 51.7293s
	iters: 1000, epoch: 7 | loss: 0.3752025
	speed: 0.0140s/iter; left time: 50.0387s
	iters: 1100, epoch: 7 | loss: 0.3539346
	speed: 0.0138s/iter; left time: 47.8375s
Epoch: 7 cost time: 16.081698417663574
Epoch: 7, Steps: 1144 | Train Loss: 0.4813046 Vali Loss: 0.5041162 Test Loss: 0.2287725
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4947275
	speed: 0.0211s/iter; left time: 70.2554s
	iters: 200, epoch: 8 | loss: 0.3528411
	speed: 0.0171s/iter; left time: 55.2219s
	iters: 300, epoch: 8 | loss: 0.3227343
	speed: 0.0160s/iter; left time: 49.9815s
	iters: 400, epoch: 8 | loss: 0.4252514
	speed: 0.0157s/iter; left time: 47.6332s
	iters: 500, epoch: 8 | loss: 0.2919703
	speed: 0.0153s/iter; left time: 44.8716s
	iters: 600, epoch: 8 | loss: 0.8733308
	speed: 0.0147s/iter; left time: 41.6962s
	iters: 700, epoch: 8 | loss: 0.3597136
	speed: 0.0146s/iter; left time: 39.7714s
	iters: 800, epoch: 8 | loss: 0.3997193
	speed: 0.0153s/iter; left time: 40.2593s
	iters: 900, epoch: 8 | loss: 0.4059938
	speed: 0.0149s/iter; left time: 37.8520s
	iters: 1000, epoch: 8 | loss: 0.4308818
	speed: 0.0147s/iter; left time: 35.7275s
	iters: 1100, epoch: 8 | loss: 0.4638926
	speed: 0.0145s/iter; left time: 33.8396s
Epoch: 8 cost time: 16.719753742218018
Epoch: 8, Steps: 1144 | Train Loss: 0.4803533 Vali Loss: 0.5052095 Test Loss: 0.2288146
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3553443
	speed: 0.0236s/iter; left time: 51.6387s
	iters: 200, epoch: 9 | loss: 0.4531006
	speed: 0.0182s/iter; left time: 38.0880s
	iters: 300, epoch: 9 | loss: 0.4411244
	speed: 0.0157s/iter; left time: 31.1296s
	iters: 400, epoch: 9 | loss: 0.4605153
	speed: 0.0156s/iter; left time: 29.4224s
	iters: 500, epoch: 9 | loss: 0.3781594
	speed: 0.0154s/iter; left time: 27.5371s
	iters: 600, epoch: 9 | loss: 0.4140885
	speed: 0.0146s/iter; left time: 24.5820s
	iters: 700, epoch: 9 | loss: 0.3802193
	speed: 0.0140s/iter; left time: 22.3246s
	iters: 800, epoch: 9 | loss: 0.3501169
	speed: 0.0137s/iter; left time: 20.4707s
	iters: 900, epoch: 9 | loss: 0.4114538
	speed: 0.0135s/iter; left time: 18.7424s
	iters: 1000, epoch: 9 | loss: 0.4023736
	speed: 0.0134s/iter; left time: 17.2429s
	iters: 1100, epoch: 9 | loss: 0.3699690
	speed: 0.0132s/iter; left time: 15.6711s
Epoch: 9 cost time: 15.282627820968628
Epoch: 9, Steps: 1144 | Train Loss: 0.4799908 Vali Loss: 0.5052639 Test Loss: 0.2292229
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.2289903461933136, mae:0.26505234837532043
Seed: 456
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_336      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip True
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.6616678
	speed: 0.0277s/iter; left time: 313.2872s
	iters: 200, epoch: 1 | loss: 0.6896520
	speed: 0.0199s/iter; left time: 222.9773s
	iters: 300, epoch: 1 | loss: 0.5785374
	speed: 0.0182s/iter; left time: 201.5600s
	iters: 400, epoch: 1 | loss: 0.8578248
	speed: 0.0175s/iter; left time: 192.9787s
	iters: 500, epoch: 1 | loss: 0.7151282
	speed: 0.0177s/iter; left time: 192.9783s
	iters: 600, epoch: 1 | loss: 0.4975444
	speed: 0.0171s/iter; left time: 185.1204s
	iters: 700, epoch: 1 | loss: 0.5395522
	speed: 0.0167s/iter; left time: 178.7696s
	iters: 800, epoch: 1 | loss: 0.5910209
	speed: 0.0162s/iter; left time: 171.8692s
	iters: 900, epoch: 1 | loss: 0.6735911
	speed: 0.0160s/iter; left time: 167.8317s
	iters: 1000, epoch: 1 | loss: 0.5722476
	speed: 0.0159s/iter; left time: 165.2242s
	iters: 1100, epoch: 1 | loss: 0.5882503
	speed: 0.0155s/iter; left time: 159.9380s
Epoch: 1 cost time: 17.7045476436615
Epoch: 1, Steps: 1140 | Train Loss: 0.6557059 Vali Loss: 0.6609257 Test Loss: 0.2989767
Validation loss decreased (inf --> 0.660926).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4871198
	speed: 0.0162s/iter; left time: 164.9403s
	iters: 200, epoch: 2 | loss: 0.8985723
	speed: 0.0148s/iter; left time: 148.4777s
	iters: 300, epoch: 2 | loss: 0.4798579
	speed: 0.0138s/iter; left time: 137.7707s
	iters: 400, epoch: 2 | loss: 0.5453349
	speed: 0.0142s/iter; left time: 139.6310s
	iters: 500, epoch: 2 | loss: 0.4837644
	speed: 0.0141s/iter; left time: 137.8332s
	iters: 600, epoch: 2 | loss: 0.4866087
	speed: 0.0145s/iter; left time: 140.3576s
	iters: 700, epoch: 2 | loss: 0.7890078
	speed: 0.0144s/iter; left time: 137.6184s
	iters: 800, epoch: 2 | loss: 0.6085277
	speed: 0.0142s/iter; left time: 134.6924s
	iters: 900, epoch: 2 | loss: 0.4602358
	speed: 0.0139s/iter; left time: 130.5769s
	iters: 1000, epoch: 2 | loss: 0.5279897
	speed: 0.0140s/iter; left time: 129.6332s
	iters: 1100, epoch: 2 | loss: 0.5479331
	speed: 0.0140s/iter; left time: 128.4007s
Epoch: 2 cost time: 16.011011123657227
Epoch: 2, Steps: 1140 | Train Loss: 0.5943395 Vali Loss: 0.6018870 Test Loss: 0.2848389
Validation loss decreased (0.660926 --> 0.601887).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7691160
	speed: 0.0183s/iter; left time: 164.7170s
	iters: 200, epoch: 3 | loss: 0.4065504
	speed: 0.0172s/iter; left time: 153.4566s
	iters: 300, epoch: 3 | loss: 0.5501828
	speed: 0.0163s/iter; left time: 144.1425s
	iters: 400, epoch: 3 | loss: 0.5772638
	speed: 0.0160s/iter; left time: 139.1263s
	iters: 500, epoch: 3 | loss: 0.6555899
	speed: 0.0150s/iter; left time: 128.9859s
	iters: 600, epoch: 3 | loss: 0.4228139
	speed: 0.0145s/iter; left time: 123.9207s
	iters: 700, epoch: 3 | loss: 0.8476867
	speed: 0.0149s/iter; left time: 125.2167s
	iters: 800, epoch: 3 | loss: 0.7361093
	speed: 0.0152s/iter; left time: 126.7249s
	iters: 900, epoch: 3 | loss: 0.5862463
	speed: 0.0149s/iter; left time: 122.7531s
	iters: 1000, epoch: 3 | loss: 0.8077075
	speed: 0.0147s/iter; left time: 119.6593s
	iters: 1100, epoch: 3 | loss: 0.4216779
	speed: 0.0151s/iter; left time: 121.5153s
Epoch: 3 cost time: 17.408843994140625
Epoch: 3, Steps: 1140 | Train Loss: 0.5729435 Vali Loss: 0.5942551 Test Loss: 0.2841351
Validation loss decreased (0.601887 --> 0.594255).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5218778
	speed: 0.0168s/iter; left time: 132.2443s
	iters: 200, epoch: 4 | loss: 0.7581615
	speed: 0.0157s/iter; left time: 122.5175s
	iters: 300, epoch: 4 | loss: 0.4299666
	speed: 0.0156s/iter; left time: 119.7829s
	iters: 400, epoch: 4 | loss: 0.5302604
	speed: 0.0151s/iter; left time: 114.2790s
	iters: 500, epoch: 4 | loss: 0.5148897
	speed: 0.0144s/iter; left time: 107.4037s
	iters: 600, epoch: 4 | loss: 0.4690261
	speed: 0.0139s/iter; left time: 102.4176s
	iters: 700, epoch: 4 | loss: 0.4634118
	speed: 0.0139s/iter; left time: 101.1237s
	iters: 800, epoch: 4 | loss: 0.4893793
	speed: 0.0140s/iter; left time: 100.3743s
	iters: 900, epoch: 4 | loss: 0.7303613
	speed: 0.0142s/iter; left time: 100.3409s
	iters: 1000, epoch: 4 | loss: 0.4552736
	speed: 0.0140s/iter; left time: 97.6533s
	iters: 1100, epoch: 4 | loss: 0.5042665
	speed: 0.0139s/iter; left time: 95.7932s
Epoch: 4 cost time: 16.02774930000305
Epoch: 4, Steps: 1140 | Train Loss: 0.5625811 Vali Loss: 0.5893440 Test Loss: 0.2826813
Validation loss decreased (0.594255 --> 0.589344).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.9449888
	speed: 0.0151s/iter; left time: 101.5770s
	iters: 200, epoch: 5 | loss: 0.4820540
	speed: 0.0157s/iter; left time: 104.0080s
	iters: 300, epoch: 5 | loss: 0.5062396
	speed: 0.0153s/iter; left time: 100.2508s
	iters: 400, epoch: 5 | loss: 0.5353287
	speed: 0.0149s/iter; left time: 95.7245s
	iters: 500, epoch: 5 | loss: 0.4001553
	speed: 0.0147s/iter; left time: 92.9551s
	iters: 600, epoch: 5 | loss: 0.8041201
	speed: 0.0144s/iter; left time: 90.0420s
	iters: 700, epoch: 5 | loss: 0.6438780
	speed: 0.0141s/iter; left time: 86.3939s
	iters: 800, epoch: 5 | loss: 0.4414496
	speed: 0.0139s/iter; left time: 83.9834s
	iters: 900, epoch: 5 | loss: 0.4374318
	speed: 0.0140s/iter; left time: 83.3095s
	iters: 1000, epoch: 5 | loss: 0.5487207
	speed: 0.0142s/iter; left time: 82.7382s
	iters: 1100, epoch: 5 | loss: 0.5239872
	speed: 0.0141s/iter; left time: 81.2123s
Epoch: 5 cost time: 16.174835443496704
Epoch: 5, Steps: 1140 | Train Loss: 0.5545279 Vali Loss: 0.5886496 Test Loss: 0.2827129
Validation loss decreased (0.589344 --> 0.588650).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4725272
	speed: 0.0174s/iter; left time: 97.5515s
	iters: 200, epoch: 6 | loss: 0.5042536
	speed: 0.0146s/iter; left time: 80.3356s
	iters: 300, epoch: 6 | loss: 0.7379717
	speed: 0.0146s/iter; left time: 78.7893s
	iters: 400, epoch: 6 | loss: 0.6913513
	speed: 0.0138s/iter; left time: 73.0145s
	iters: 500, epoch: 6 | loss: 0.7275169
	speed: 0.0132s/iter; left time: 68.8387s
	iters: 600, epoch: 6 | loss: 0.8657640
	speed: 0.0129s/iter; left time: 66.0261s
	iters: 700, epoch: 6 | loss: 0.6988584
	speed: 0.0124s/iter; left time: 62.0520s
	iters: 800, epoch: 6 | loss: 0.4733624
	speed: 0.0122s/iter; left time: 59.9199s
	iters: 900, epoch: 6 | loss: 0.4115708
	speed: 0.0126s/iter; left time: 60.5862s
	iters: 1000, epoch: 6 | loss: 0.4353759
	speed: 0.0125s/iter; left time: 58.6208s
	iters: 1100, epoch: 6 | loss: 0.5830255
	speed: 0.0129s/iter; left time: 59.3240s
Epoch: 6 cost time: 15.0819833278656
Epoch: 6, Steps: 1140 | Train Loss: 0.5506686 Vali Loss: 0.5889552 Test Loss: 0.2827564
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4299589
	speed: 0.0213s/iter; left time: 95.0974s
	iters: 200, epoch: 7 | loss: 0.3489909
	speed: 0.0162s/iter; left time: 70.5040s
	iters: 300, epoch: 7 | loss: 0.4844396
	speed: 0.0141s/iter; left time: 60.1497s
	iters: 400, epoch: 7 | loss: 0.5429549
	speed: 0.0140s/iter; left time: 58.3337s
	iters: 500, epoch: 7 | loss: 0.5323709
	speed: 0.0145s/iter; left time: 59.0088s
	iters: 600, epoch: 7 | loss: 0.8723047
	speed: 0.0142s/iter; left time: 56.0764s
	iters: 700, epoch: 7 | loss: 0.4769940
	speed: 0.0139s/iter; left time: 53.5001s
	iters: 800, epoch: 7 | loss: 0.4928771
	speed: 0.0144s/iter; left time: 54.0672s
	iters: 900, epoch: 7 | loss: 0.4505725
	speed: 0.0144s/iter; left time: 52.8938s
	iters: 1000, epoch: 7 | loss: 0.4370708
	speed: 0.0145s/iter; left time: 51.5588s
	iters: 1100, epoch: 7 | loss: 0.4647789
	speed: 0.0147s/iter; left time: 50.7477s
Epoch: 7 cost time: 16.794678449630737
Epoch: 7, Steps: 1140 | Train Loss: 0.5484777 Vali Loss: 0.5895658 Test Loss: 0.2831185
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.7674492
	speed: 0.0171s/iter; left time: 56.8088s
	iters: 200, epoch: 8 | loss: 0.7336816
	speed: 0.0146s/iter; left time: 46.9598s
	iters: 300, epoch: 8 | loss: 0.5662893
	speed: 0.0137s/iter; left time: 42.7225s
	iters: 400, epoch: 8 | loss: 0.4857866
	speed: 0.0142s/iter; left time: 42.7754s
	iters: 500, epoch: 8 | loss: 0.6603656
	speed: 0.0144s/iter; left time: 42.0731s
	iters: 600, epoch: 8 | loss: 0.6829153
	speed: 0.0141s/iter; left time: 39.9148s
	iters: 700, epoch: 8 | loss: 0.4186105
	speed: 0.0141s/iter; left time: 38.3676s
	iters: 800, epoch: 8 | loss: 0.4228031
	speed: 0.0142s/iter; left time: 37.1866s
	iters: 900, epoch: 8 | loss: 0.5089525
	speed: 0.0141s/iter; left time: 35.4842s
	iters: 1000, epoch: 8 | loss: 0.4263386
	speed: 0.0139s/iter; left time: 33.6401s
	iters: 1100, epoch: 8 | loss: 0.4228179
	speed: 0.0137s/iter; left time: 31.8542s
Epoch: 8 cost time: 15.733842611312866
Epoch: 8, Steps: 1140 | Train Loss: 0.5474944 Vali Loss: 0.5867463 Test Loss: 0.2835108
Validation loss decreased (0.588650 --> 0.586746).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3758629
	speed: 0.0222s/iter; left time: 48.4794s
	iters: 200, epoch: 9 | loss: 0.7636116
	speed: 0.0170s/iter; left time: 35.4735s
	iters: 300, epoch: 9 | loss: 0.5311248
	speed: 0.0170s/iter; left time: 33.6707s
	iters: 400, epoch: 9 | loss: 0.4307972
	speed: 0.0163s/iter; left time: 30.7475s
	iters: 500, epoch: 9 | loss: 0.5378588
	speed: 0.0158s/iter; left time: 28.0717s
	iters: 600, epoch: 9 | loss: 0.5192451
	speed: 0.0151s/iter; left time: 25.3436s
	iters: 700, epoch: 9 | loss: 0.6780238
	speed: 0.0149s/iter; left time: 23.5448s
	iters: 800, epoch: 9 | loss: 0.4743817
	speed: 0.0147s/iter; left time: 21.8033s
	iters: 900, epoch: 9 | loss: 0.4058338
	speed: 0.0144s/iter; left time: 19.8513s
	iters: 1000, epoch: 9 | loss: 0.5696652
	speed: 0.0142s/iter; left time: 18.1797s
	iters: 1100, epoch: 9 | loss: 0.4253730
	speed: 0.0142s/iter; left time: 16.8146s
Epoch: 9 cost time: 16.35845136642456
Epoch: 9, Steps: 1140 | Train Loss: 0.5469313 Vali Loss: 0.5884049 Test Loss: 0.2831583
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.5157154
	speed: 0.0160s/iter; left time: 16.6661s
	iters: 200, epoch: 10 | loss: 0.3950412
	speed: 0.0139s/iter; left time: 13.0801s
	iters: 300, epoch: 10 | loss: 0.4218194
	speed: 0.0130s/iter; left time: 10.9636s
	iters: 400, epoch: 10 | loss: 0.4621780
	speed: 0.0130s/iter; left time: 9.6310s
	iters: 500, epoch: 10 | loss: 0.4746818
	speed: 0.0134s/iter; left time: 8.5874s
	iters: 600, epoch: 10 | loss: 0.9959226
	speed: 0.0134s/iter; left time: 7.2570s
	iters: 700, epoch: 10 | loss: 0.4102894
	speed: 0.0131s/iter; left time: 5.7755s
	iters: 800, epoch: 10 | loss: 0.4404203
	speed: 0.0130s/iter; left time: 4.4382s
	iters: 900, epoch: 10 | loss: 0.5084369
	speed: 0.0132s/iter; left time: 3.1753s
	iters: 1000, epoch: 10 | loss: 0.4030922
	speed: 0.0134s/iter; left time: 1.8851s
	iters: 1100, epoch: 10 | loss: 0.7414587
	speed: 0.0132s/iter; left time: 0.5411s
Epoch: 10 cost time: 15.045118808746338
Epoch: 10, Steps: 1140 | Train Loss: 0.5474762 Vali Loss: 0.5905481 Test Loss: 0.2831093
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.2835107445716858, mae:0.30353647470474243
Use GPU: cuda:0
no_skip True
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 1.1565123
	speed: 0.0215s/iter; left time: 243.5334s
	iters: 200, epoch: 1 | loss: 0.6833742
	speed: 0.0168s/iter; left time: 188.5395s
	iters: 300, epoch: 1 | loss: 0.5458088
	speed: 0.0159s/iter; left time: 176.1579s
	iters: 400, epoch: 1 | loss: 0.5828518
	speed: 0.0154s/iter; left time: 169.7673s
	iters: 500, epoch: 1 | loss: 0.6855650
	speed: 0.0159s/iter; left time: 173.8391s
	iters: 600, epoch: 1 | loss: 0.6844538
	speed: 0.0167s/iter; left time: 180.1516s
	iters: 700, epoch: 1 | loss: 0.4639353
	speed: 0.0162s/iter; left time: 173.4246s
	iters: 800, epoch: 1 | loss: 0.5285136
	speed: 0.0159s/iter; left time: 168.3282s
	iters: 900, epoch: 1 | loss: 0.5918031
	speed: 0.0157s/iter; left time: 164.7416s
	iters: 1000, epoch: 1 | loss: 0.5152344
	speed: 0.0153s/iter; left time: 158.7903s
	iters: 1100, epoch: 1 | loss: 0.8209424
	speed: 0.0149s/iter; left time: 153.7668s
Epoch: 1 cost time: 16.98813796043396
Epoch: 1, Steps: 1140 | Train Loss: 0.6380522 Vali Loss: 0.6245638 Test Loss: 0.2922118
Validation loss decreased (inf --> 0.624564).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8115022
	speed: 0.0277s/iter; left time: 281.0177s
	iters: 200, epoch: 2 | loss: 0.5419918
	speed: 0.0206s/iter; left time: 207.6920s
	iters: 300, epoch: 2 | loss: 0.7008542
	speed: 0.0179s/iter; left time: 177.8426s
	iters: 400, epoch: 2 | loss: 0.7176772
	speed: 0.0172s/iter; left time: 169.7352s
	iters: 500, epoch: 2 | loss: 0.5523402
	speed: 0.0164s/iter; left time: 159.9244s
	iters: 600, epoch: 2 | loss: 0.6834795
	speed: 0.0160s/iter; left time: 154.8604s
	iters: 700, epoch: 2 | loss: 0.5018100
	speed: 0.0157s/iter; left time: 149.6470s
	iters: 800, epoch: 2 | loss: 1.0209115
	speed: 0.0156s/iter; left time: 147.3559s
	iters: 900, epoch: 2 | loss: 0.5117044
	speed: 0.0153s/iter; left time: 143.0123s
	iters: 1000, epoch: 2 | loss: 1.0529923
	speed: 0.0150s/iter; left time: 138.5763s
	iters: 1100, epoch: 2 | loss: 0.4554378
	speed: 0.0149s/iter; left time: 136.4313s
Epoch: 2 cost time: 17.092825174331665
Epoch: 2, Steps: 1140 | Train Loss: 0.5901381 Vali Loss: 0.5981194 Test Loss: 0.2840066
Validation loss decreased (0.624564 --> 0.598119).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7514604
	speed: 0.0199s/iter; left time: 179.6029s
	iters: 200, epoch: 3 | loss: 0.4265356
	speed: 0.0178s/iter; left time: 158.3541s
	iters: 300, epoch: 3 | loss: 0.4698547
	speed: 0.0170s/iter; left time: 150.3087s
	iters: 400, epoch: 3 | loss: 0.4636857
	speed: 0.0163s/iter; left time: 142.0644s
	iters: 500, epoch: 3 | loss: 0.4574050
	speed: 0.0158s/iter; left time: 136.4932s
	iters: 600, epoch: 3 | loss: 0.7382078
	speed: 0.0153s/iter; left time: 129.9926s
	iters: 700, epoch: 3 | loss: 0.5696549
	speed: 0.0151s/iter; left time: 126.9661s
	iters: 800, epoch: 3 | loss: 0.4071938
	speed: 0.0152s/iter; left time: 126.2354s
	iters: 900, epoch: 3 | loss: 0.4172741
	speed: 0.0149s/iter; left time: 122.5426s
	iters: 1000, epoch: 3 | loss: 0.4910261
	speed: 0.0146s/iter; left time: 118.4994s
	iters: 1100, epoch: 3 | loss: 0.5260086
	speed: 0.0146s/iter; left time: 116.9070s
Epoch: 3 cost time: 16.869107723236084
Epoch: 3, Steps: 1140 | Train Loss: 0.5718413 Vali Loss: 0.5877563 Test Loss: 0.2824160
Validation loss decreased (0.598119 --> 0.587756).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.7989048
	speed: 0.0156s/iter; left time: 122.9984s
	iters: 200, epoch: 4 | loss: 0.4750196
	speed: 0.0150s/iter; left time: 116.5323s
	iters: 300, epoch: 4 | loss: 0.5413481
	speed: 0.0154s/iter; left time: 118.0225s
	iters: 400, epoch: 4 | loss: 0.5815984
	speed: 0.0152s/iter; left time: 115.1801s
	iters: 500, epoch: 4 | loss: 0.5357249
	speed: 0.0150s/iter; left time: 112.2542s
	iters: 600, epoch: 4 | loss: 0.4466746
	speed: 0.0154s/iter; left time: 113.3689s
	iters: 700, epoch: 4 | loss: 0.5038439
	speed: 0.0158s/iter; left time: 115.3499s
	iters: 800, epoch: 4 | loss: 0.8168871
	speed: 0.0153s/iter; left time: 109.7903s
	iters: 900, epoch: 4 | loss: 0.4504716
	speed: 0.0160s/iter; left time: 113.5549s
	iters: 1000, epoch: 4 | loss: 0.6894188
	speed: 0.0160s/iter; left time: 111.7254s
	iters: 1100, epoch: 4 | loss: 0.4410821
	speed: 0.0154s/iter; left time: 106.1466s
Epoch: 4 cost time: 17.43982744216919
Epoch: 4, Steps: 1140 | Train Loss: 0.5611140 Vali Loss: 0.5829192 Test Loss: 0.2807133
Validation loss decreased (0.587756 --> 0.582919).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.7083367
	speed: 0.0186s/iter; left time: 125.5424s
	iters: 200, epoch: 5 | loss: 0.4543582
	speed: 0.0152s/iter; left time: 101.1191s
	iters: 300, epoch: 5 | loss: 0.6601236
	speed: 0.0146s/iter; left time: 95.3541s
	iters: 400, epoch: 5 | loss: 0.3687865
	speed: 0.0140s/iter; left time: 89.9983s
	iters: 500, epoch: 5 | loss: 0.4055476
	speed: 0.0141s/iter; left time: 89.4221s
	iters: 600, epoch: 5 | loss: 0.5390469
	speed: 0.0141s/iter; left time: 87.9887s
	iters: 700, epoch: 5 | loss: 0.4181418
	speed: 0.0138s/iter; left time: 84.7829s
	iters: 800, epoch: 5 | loss: 0.4290938
	speed: 0.0136s/iter; left time: 82.4396s
	iters: 900, epoch: 5 | loss: 0.4195742
	speed: 0.0141s/iter; left time: 83.5583s
	iters: 1000, epoch: 5 | loss: 0.4731290
	speed: 0.0141s/iter; left time: 82.1018s
	iters: 1100, epoch: 5 | loss: 0.4942675
	speed: 0.0141s/iter; left time: 80.9270s
Epoch: 5 cost time: 16.087817668914795
Epoch: 5, Steps: 1140 | Train Loss: 0.5546699 Vali Loss: 0.5849835 Test Loss: 0.2810489
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6817113
	speed: 0.0168s/iter; left time: 94.2168s
	iters: 200, epoch: 6 | loss: 0.3853178
	speed: 0.0157s/iter; left time: 86.3747s
	iters: 300, epoch: 6 | loss: 0.4632933
	speed: 0.0154s/iter; left time: 83.1277s
	iters: 400, epoch: 6 | loss: 0.8448898
	speed: 0.0150s/iter; left time: 79.3519s
	iters: 500, epoch: 6 | loss: 0.4487409
	speed: 0.0146s/iter; left time: 76.1009s
	iters: 600, epoch: 6 | loss: 0.4958445
	speed: 0.0145s/iter; left time: 73.9601s
	iters: 700, epoch: 6 | loss: 0.8376938
	speed: 0.0150s/iter; left time: 74.7914s
	iters: 800, epoch: 6 | loss: 0.5232635
	speed: 0.0146s/iter; left time: 71.7670s
	iters: 900, epoch: 6 | loss: 0.3961221
	speed: 0.0144s/iter; left time: 69.0472s
	iters: 1000, epoch: 6 | loss: 0.4321908
	speed: 0.0141s/iter; left time: 66.2773s
	iters: 1100, epoch: 6 | loss: 0.3798742
	speed: 0.0139s/iter; left time: 64.1231s
Epoch: 6 cost time: 15.896682262420654
Epoch: 6, Steps: 1140 | Train Loss: 0.5507808 Vali Loss: 0.5857157 Test Loss: 0.2817453
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3870133
	speed: 0.0142s/iter; left time: 63.5575s
	iters: 200, epoch: 7 | loss: 0.6791779
	speed: 0.0128s/iter; left time: 55.6440s
	iters: 300, epoch: 7 | loss: 0.4617339
	speed: 0.0137s/iter; left time: 58.4778s
	iters: 400, epoch: 7 | loss: 0.4616181
	speed: 0.0138s/iter; left time: 57.3124s
	iters: 500, epoch: 7 | loss: 0.5552407
	speed: 0.0134s/iter; left time: 54.2331s
	iters: 600, epoch: 7 | loss: 0.4636383
	speed: 0.0137s/iter; left time: 54.2980s
	iters: 700, epoch: 7 | loss: 0.5130271
	speed: 0.0138s/iter; left time: 53.1916s
	iters: 800, epoch: 7 | loss: 0.4864422
	speed: 0.0133s/iter; left time: 49.9705s
	iters: 900, epoch: 7 | loss: 0.4090297
	speed: 0.0134s/iter; left time: 49.1694s
	iters: 1000, epoch: 7 | loss: 0.7961746
	speed: 0.0136s/iter; left time: 48.4569s
	iters: 1100, epoch: 7 | loss: 0.5197735
	speed: 0.0133s/iter; left time: 46.1344s
Epoch: 7 cost time: 15.18658709526062
Epoch: 7, Steps: 1140 | Train Loss: 0.5489915 Vali Loss: 0.5876757 Test Loss: 0.2816371
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4901532
	speed: 0.0147s/iter; left time: 48.6761s
	iters: 200, epoch: 8 | loss: 0.4788646
	speed: 0.0141s/iter; left time: 45.3146s
	iters: 300, epoch: 8 | loss: 0.4187844
	speed: 0.0125s/iter; left time: 39.1065s
	iters: 400, epoch: 8 | loss: 0.4525632
	speed: 0.0121s/iter; left time: 36.6936s
	iters: 500, epoch: 8 | loss: 0.5105438
	speed: 0.0122s/iter; left time: 35.5720s
	iters: 600, epoch: 8 | loss: 0.4945380
	speed: 0.0118s/iter; left time: 33.1645s
	iters: 700, epoch: 8 | loss: 0.4638633
	speed: 0.0121s/iter; left time: 33.0146s
	iters: 800, epoch: 8 | loss: 0.3971191
	speed: 0.0122s/iter; left time: 31.9244s
	iters: 900, epoch: 8 | loss: 0.3689955
	speed: 0.0123s/iter; left time: 31.0629s
	iters: 1000, epoch: 8 | loss: 0.4948731
	speed: 0.0124s/iter; left time: 30.0959s
	iters: 1100, epoch: 8 | loss: 0.4906798
	speed: 0.0123s/iter; left time: 28.5946s
Epoch: 8 cost time: 14.155539274215698
Epoch: 8, Steps: 1140 | Train Loss: 0.5479616 Vali Loss: 0.5887749 Test Loss: 0.2821902
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3434253
	speed: 0.0181s/iter; left time: 39.3767s
	iters: 200, epoch: 9 | loss: 0.7619496
	speed: 0.0142s/iter; left time: 29.6054s
	iters: 300, epoch: 9 | loss: 0.4464250
	speed: 0.0127s/iter; left time: 25.1269s
	iters: 400, epoch: 9 | loss: 0.5029238
	speed: 0.0126s/iter; left time: 23.7023s
	iters: 500, epoch: 9 | loss: 0.6970016
	speed: 0.0131s/iter; left time: 23.3534s
	iters: 600, epoch: 9 | loss: 0.3958271
	speed: 0.0128s/iter; left time: 21.5890s
	iters: 700, epoch: 9 | loss: 0.6253372
	speed: 0.0128s/iter; left time: 20.2182s
	iters: 800, epoch: 9 | loss: 0.4588885
	speed: 0.0130s/iter; left time: 19.3227s
	iters: 900, epoch: 9 | loss: 0.4012081
	speed: 0.0130s/iter; left time: 18.0116s
	iters: 1000, epoch: 9 | loss: 0.4077229
	speed: 0.0127s/iter; left time: 16.3210s
	iters: 1100, epoch: 9 | loss: 0.9922501
	speed: 0.0128s/iter; left time: 15.0608s
Epoch: 9 cost time: 14.678807020187378
Epoch: 9, Steps: 1140 | Train Loss: 0.5474178 Vali Loss: 0.5880660 Test Loss: 0.2820956
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.2807133197784424, mae:0.30147048830986023
Use GPU: cuda:0
no_skip True
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.8387222
	speed: 0.0130s/iter; left time: 147.1746s
	iters: 200, epoch: 1 | loss: 1.0893569
	speed: 0.0130s/iter; left time: 145.1522s
	iters: 300, epoch: 1 | loss: 0.5537181
	speed: 0.0126s/iter; left time: 140.1913s
	iters: 400, epoch: 1 | loss: 0.6917832
	speed: 0.0122s/iter; left time: 134.0970s
	iters: 500, epoch: 1 | loss: 0.8955992
	speed: 0.0123s/iter; left time: 133.8060s
	iters: 600, epoch: 1 | loss: 1.1164259
	speed: 0.0121s/iter; left time: 131.0603s
	iters: 700, epoch: 1 | loss: 0.5204533
	speed: 0.0120s/iter; left time: 128.6999s
	iters: 800, epoch: 1 | loss: 0.8631140
	speed: 0.0120s/iter; left time: 127.1839s
	iters: 900, epoch: 1 | loss: 0.5465934
	speed: 0.0118s/iter; left time: 123.7542s
	iters: 1000, epoch: 1 | loss: 0.4393617
	speed: 0.0118s/iter; left time: 122.3489s
	iters: 1100, epoch: 1 | loss: 0.5276861
	speed: 0.0116s/iter; left time: 119.7347s
Epoch: 1 cost time: 13.274749040603638
Epoch: 1, Steps: 1140 | Train Loss: 0.6509142 Vali Loss: 0.6250035 Test Loss: 0.2911465
Validation loss decreased (inf --> 0.625004).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4609879
	speed: 0.0123s/iter; left time: 124.8914s
	iters: 200, epoch: 2 | loss: 0.4938644
	speed: 0.0113s/iter; left time: 113.7683s
	iters: 300, epoch: 2 | loss: 0.5179368
	speed: 0.0109s/iter; left time: 108.9704s
	iters: 400, epoch: 2 | loss: 0.5266685
	speed: 0.0110s/iter; left time: 108.0250s
	iters: 500, epoch: 2 | loss: 1.0925410
	speed: 0.0108s/iter; left time: 105.5596s
	iters: 600, epoch: 2 | loss: 0.8714242
	speed: 0.0108s/iter; left time: 104.7258s
	iters: 700, epoch: 2 | loss: 0.7539882
	speed: 0.0107s/iter; left time: 102.5719s
	iters: 800, epoch: 2 | loss: 0.4938092
	speed: 0.0104s/iter; left time: 98.4446s
	iters: 900, epoch: 2 | loss: 0.5149665
	speed: 0.0104s/iter; left time: 97.6735s
	iters: 1000, epoch: 2 | loss: 0.4735380
	speed: 0.0106s/iter; left time: 98.3660s
	iters: 1100, epoch: 2 | loss: 0.4290092
	speed: 0.0106s/iter; left time: 96.7252s
Epoch: 2 cost time: 12.046555042266846
Epoch: 2, Steps: 1140 | Train Loss: 0.5954395 Vali Loss: 0.5958478 Test Loss: 0.2841274
Validation loss decreased (0.625004 --> 0.595848).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4992274
	speed: 0.0120s/iter; left time: 108.1787s
	iters: 200, epoch: 3 | loss: 0.4600787
	speed: 0.0118s/iter; left time: 105.7113s
	iters: 300, epoch: 3 | loss: 0.7789990
	speed: 0.0114s/iter; left time: 100.6518s
	iters: 400, epoch: 3 | loss: 0.4563344
	speed: 0.0108s/iter; left time: 94.6225s
	iters: 500, epoch: 3 | loss: 0.4573219
	speed: 0.0107s/iter; left time: 92.2757s
	iters: 600, epoch: 3 | loss: 0.5060489
	speed: 0.0109s/iter; left time: 93.1377s
	iters: 700, epoch: 3 | loss: 0.5178064
	speed: 0.0108s/iter; left time: 91.2586s
	iters: 800, epoch: 3 | loss: 0.4494477
	speed: 0.0107s/iter; left time: 88.7503s
	iters: 900, epoch: 3 | loss: 0.4628998
	speed: 0.0107s/iter; left time: 87.6594s
	iters: 1000, epoch: 3 | loss: 0.5342134
	speed: 0.0107s/iter; left time: 87.1582s
	iters: 1100, epoch: 3 | loss: 0.5873219
	speed: 0.0106s/iter; left time: 85.4162s
Epoch: 3 cost time: 12.156968832015991
Epoch: 3, Steps: 1140 | Train Loss: 0.5737364 Vali Loss: 0.5896716 Test Loss: 0.2810166
Validation loss decreased (0.595848 --> 0.589672).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6208479
	speed: 0.0117s/iter; left time: 92.5241s
	iters: 200, epoch: 4 | loss: 0.5173919
	speed: 0.0107s/iter; left time: 83.6395s
	iters: 300, epoch: 4 | loss: 0.4960931
	speed: 0.0109s/iter; left time: 83.8639s
	iters: 400, epoch: 4 | loss: 0.6523309
	speed: 0.0102s/iter; left time: 77.0297s
	iters: 500, epoch: 4 | loss: 0.5395256
	speed: 0.0100s/iter; left time: 74.6679s
	iters: 600, epoch: 4 | loss: 0.4291425
	speed: 0.0099s/iter; left time: 72.7558s
	iters: 700, epoch: 4 | loss: 0.8269545
	speed: 0.0098s/iter; left time: 71.2460s
	iters: 800, epoch: 4 | loss: 0.5636646
	speed: 0.0099s/iter; left time: 71.3379s
	iters: 900, epoch: 4 | loss: 0.4420362
	speed: 0.0102s/iter; left time: 72.0740s
	iters: 1000, epoch: 4 | loss: 0.4294254
	speed: 0.0102s/iter; left time: 71.3391s
	iters: 1100, epoch: 4 | loss: 0.5339597
	speed: 0.0101s/iter; left time: 69.5218s
Epoch: 4 cost time: 11.572560787200928
Epoch: 4, Steps: 1140 | Train Loss: 0.5645947 Vali Loss: 0.5893849 Test Loss: 0.2815587
Validation loss decreased (0.589672 --> 0.589385).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4629379
	speed: 0.0148s/iter; left time: 99.5513s
	iters: 200, epoch: 5 | loss: 0.4979993
	speed: 0.0132s/iter; left time: 87.8880s
	iters: 300, epoch: 5 | loss: 0.4792087
	speed: 0.0119s/iter; left time: 77.5981s
	iters: 400, epoch: 5 | loss: 0.4126953
	speed: 0.0115s/iter; left time: 74.2549s
	iters: 500, epoch: 5 | loss: 0.4682650
	speed: 0.0117s/iter; left time: 73.8906s
	iters: 600, epoch: 5 | loss: 0.5137040
	speed: 0.0113s/iter; left time: 70.4366s
	iters: 700, epoch: 5 | loss: 0.8011800
	speed: 0.0111s/iter; left time: 67.8583s
	iters: 800, epoch: 5 | loss: 0.6689609
	speed: 0.0111s/iter; left time: 66.9479s
	iters: 900, epoch: 5 | loss: 0.4791188
	speed: 0.0110s/iter; left time: 65.6184s
	iters: 1000, epoch: 5 | loss: 0.5299833
	speed: 0.0110s/iter; left time: 63.9765s
	iters: 1100, epoch: 5 | loss: 0.6882174
	speed: 0.0109s/iter; left time: 62.5236s
Epoch: 5 cost time: 12.5249502658844
Epoch: 5, Steps: 1140 | Train Loss: 0.5594866 Vali Loss: 0.5849446 Test Loss: 0.2803082
Validation loss decreased (0.589385 --> 0.584945).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5032199
	speed: 0.0142s/iter; left time: 79.6153s
	iters: 200, epoch: 6 | loss: 0.7050790
	speed: 0.0125s/iter; left time: 69.0282s
	iters: 300, epoch: 6 | loss: 0.4592030
	speed: 0.0114s/iter; left time: 61.3454s
	iters: 400, epoch: 6 | loss: 0.6544227
	speed: 0.0115s/iter; left time: 60.8420s
	iters: 500, epoch: 6 | loss: 0.6135077
	speed: 0.0116s/iter; left time: 60.5102s
	iters: 600, epoch: 6 | loss: 0.4302557
	speed: 0.0113s/iter; left time: 57.4082s
	iters: 700, epoch: 6 | loss: 0.4619474
	speed: 0.0110s/iter; left time: 54.9143s
	iters: 800, epoch: 6 | loss: 0.5611475
	speed: 0.0108s/iter; left time: 52.9978s
	iters: 900, epoch: 6 | loss: 0.3931787
	speed: 0.0106s/iter; left time: 50.8440s
	iters: 1000, epoch: 6 | loss: 0.5754328
	speed: 0.0103s/iter; left time: 48.5930s
	iters: 1100, epoch: 6 | loss: 0.4615234
	speed: 0.0104s/iter; left time: 47.6279s
Epoch: 6 cost time: 11.848959684371948
Epoch: 6, Steps: 1140 | Train Loss: 0.5555783 Vali Loss: 0.5869265 Test Loss: 0.2811969
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4519847
	speed: 0.0114s/iter; left time: 50.6537s
	iters: 200, epoch: 7 | loss: 0.4122719
	speed: 0.0108s/iter; left time: 46.9401s
	iters: 300, epoch: 7 | loss: 0.7908736
	speed: 0.0113s/iter; left time: 48.0085s
	iters: 400, epoch: 7 | loss: 0.5301439
	speed: 0.0111s/iter; left time: 46.1477s
	iters: 500, epoch: 7 | loss: 0.4858355
	speed: 0.0108s/iter; left time: 43.7033s
	iters: 600, epoch: 7 | loss: 0.5009108
	speed: 0.0109s/iter; left time: 43.2689s
	iters: 700, epoch: 7 | loss: 0.4899287
	speed: 0.0110s/iter; left time: 42.3481s
	iters: 800, epoch: 7 | loss: 0.4137284
	speed: 0.0108s/iter; left time: 40.5176s
	iters: 900, epoch: 7 | loss: 1.0740935
	speed: 0.0108s/iter; left time: 39.3714s
	iters: 1000, epoch: 7 | loss: 0.4610546
	speed: 0.0109s/iter; left time: 38.7625s
	iters: 1100, epoch: 7 | loss: 0.6926973
	speed: 0.0108s/iter; left time: 37.4142s
Epoch: 7 cost time: 12.339866638183594
Epoch: 7, Steps: 1140 | Train Loss: 0.5535320 Vali Loss: 0.5867348 Test Loss: 0.2811890
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.6978458
	speed: 0.0129s/iter; left time: 42.7034s
	iters: 200, epoch: 8 | loss: 0.4221796
	speed: 0.0113s/iter; left time: 36.2660s
	iters: 300, epoch: 8 | loss: 0.4618831
	speed: 0.0112s/iter; left time: 34.9915s
	iters: 400, epoch: 8 | loss: 0.4710658
	speed: 0.0114s/iter; left time: 34.3535s
	iters: 500, epoch: 8 | loss: 0.5719374
	speed: 0.0111s/iter; left time: 32.4756s
	iters: 600, epoch: 8 | loss: 0.8619870
	speed: 0.0108s/iter; left time: 30.5305s
	iters: 700, epoch: 8 | loss: 0.7255854
	speed: 0.0109s/iter; left time: 29.6915s
	iters: 800, epoch: 8 | loss: 0.4355408
	speed: 0.0110s/iter; left time: 28.7340s
	iters: 900, epoch: 8 | loss: 0.4290876
	speed: 0.0108s/iter; left time: 27.3512s
	iters: 1000, epoch: 8 | loss: 0.5001591
	speed: 0.0108s/iter; left time: 26.1628s
	iters: 1100, epoch: 8 | loss: 0.8053840
	speed: 0.0110s/iter; left time: 25.4340s
Epoch: 8 cost time: 12.550024032592773
Epoch: 8, Steps: 1140 | Train Loss: 0.5525377 Vali Loss: 0.5865310 Test Loss: 0.2812463
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.5269864
	speed: 0.0120s/iter; left time: 26.0768s
	iters: 200, epoch: 9 | loss: 0.7760429
	speed: 0.0119s/iter; left time: 24.7020s
	iters: 300, epoch: 9 | loss: 0.5416950
	speed: 0.0118s/iter; left time: 23.4218s
	iters: 400, epoch: 9 | loss: 0.6639373
	speed: 0.0112s/iter; left time: 21.0728s
	iters: 500, epoch: 9 | loss: 0.4196582
	speed: 0.0113s/iter; left time: 20.1044s
	iters: 600, epoch: 9 | loss: 1.0098413
	speed: 0.0115s/iter; left time: 19.2567s
	iters: 700, epoch: 9 | loss: 0.5080338
	speed: 0.0112s/iter; left time: 17.7457s
	iters: 800, epoch: 9 | loss: 0.5094531
	speed: 0.0111s/iter; left time: 16.5130s
	iters: 900, epoch: 9 | loss: 0.4621801
	speed: 0.0113s/iter; left time: 15.5831s
	iters: 1000, epoch: 9 | loss: 0.5615530
	speed: 0.0114s/iter; left time: 14.6055s
	iters: 1100, epoch: 9 | loss: 0.4864088
	speed: 0.0112s/iter; left time: 13.2250s
Epoch: 9 cost time: 12.717041969299316
Epoch: 9, Steps: 1140 | Train Loss: 0.5519307 Vali Loss: 0.5887374 Test Loss: 0.2812461
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.8584276
	speed: 0.0131s/iter; left time: 13.5972s
	iters: 200, epoch: 10 | loss: 0.7554350
	speed: 0.0109s/iter; left time: 10.2585s
	iters: 300, epoch: 10 | loss: 0.4409894
	speed: 0.0100s/iter; left time: 8.3932s
	iters: 400, epoch: 10 | loss: 0.4471274
	speed: 0.0098s/iter; left time: 7.2682s
	iters: 500, epoch: 10 | loss: 0.4993336
	speed: 0.0096s/iter; left time: 6.1627s
	iters: 600, epoch: 10 | loss: 0.4194465
	speed: 0.0097s/iter; left time: 5.2372s
	iters: 700, epoch: 10 | loss: 0.7299185
	speed: 0.0100s/iter; left time: 4.3921s
	iters: 800, epoch: 10 | loss: 0.6194401
	speed: 0.0100s/iter; left time: 3.4190s
	iters: 900, epoch: 10 | loss: 0.3885001
	speed: 0.0100s/iter; left time: 2.4175s
	iters: 1000, epoch: 10 | loss: 0.3505289
	speed: 0.0102s/iter; left time: 1.4325s
	iters: 1100, epoch: 10 | loss: 0.5133827
	speed: 0.0103s/iter; left time: 0.4213s
Epoch: 10 cost time: 11.75096869468689
Epoch: 10, Steps: 1140 | Train Loss: 0.5518299 Vali Loss: 0.5866669 Test Loss: 0.2811584
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.28030821681022644, mae:0.3020380735397339
Seed: 456
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_720      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip True
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.7312770
	speed: 0.0220s/iter; left time: 246.4468s
	iters: 200, epoch: 1 | loss: 0.6799858
	speed: 0.0157s/iter; left time: 174.0741s
	iters: 300, epoch: 1 | loss: 0.6624672
	speed: 0.0144s/iter; left time: 158.4167s
	iters: 400, epoch: 1 | loss: 0.6003125
	speed: 0.0138s/iter; left time: 149.6890s
	iters: 500, epoch: 1 | loss: 0.8501604
	speed: 0.0131s/iter; left time: 141.1703s
	iters: 600, epoch: 1 | loss: 0.6208185
	speed: 0.0129s/iter; left time: 138.2483s
	iters: 700, epoch: 1 | loss: 0.9382731
	speed: 0.0127s/iter; left time: 134.6881s
	iters: 800, epoch: 1 | loss: 0.8426070
	speed: 0.0125s/iter; left time: 130.8193s
	iters: 900, epoch: 1 | loss: 0.7251257
	speed: 0.0124s/iter; left time: 128.6186s
	iters: 1000, epoch: 1 | loss: 0.7249746
	speed: 0.0123s/iter; left time: 126.1892s
	iters: 1100, epoch: 1 | loss: 0.5885282
	speed: 0.0122s/iter; left time: 124.0910s
Epoch: 1 cost time: 13.80267858505249
Epoch: 1, Steps: 1128 | Train Loss: 0.7343851 Vali Loss: 0.7409989 Test Loss: 0.3622430
Validation loss decreased (inf --> 0.740999).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8042070
	speed: 0.0120s/iter; left time: 120.7279s
	iters: 200, epoch: 2 | loss: 0.6092365
	speed: 0.0117s/iter; left time: 116.8157s
	iters: 300, epoch: 2 | loss: 0.8807676
	speed: 0.0117s/iter; left time: 114.8255s
	iters: 400, epoch: 2 | loss: 0.6501619
	speed: 0.0112s/iter; left time: 109.1326s
	iters: 500, epoch: 2 | loss: 0.4753461
	speed: 0.0112s/iter; left time: 108.2344s
	iters: 600, epoch: 2 | loss: 0.5798552
	speed: 0.0113s/iter; left time: 108.2856s
	iters: 700, epoch: 2 | loss: 0.6165611
	speed: 0.0111s/iter; left time: 105.2511s
	iters: 800, epoch: 2 | loss: 0.5964363
	speed: 0.0111s/iter; left time: 103.8450s
	iters: 900, epoch: 2 | loss: 0.7203404
	speed: 0.0113s/iter; left time: 104.1289s
	iters: 1000, epoch: 2 | loss: 0.5746835
	speed: 0.0112s/iter; left time: 102.4176s
	iters: 1100, epoch: 2 | loss: 0.4905989
	speed: 0.0111s/iter; left time: 100.4757s
Epoch: 2 cost time: 12.606871366500854
Epoch: 2, Steps: 1128 | Train Loss: 0.6758018 Vali Loss: 0.7242609 Test Loss: 0.3582622
Validation loss decreased (0.740999 --> 0.724261).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.8791828
	speed: 0.0137s/iter; left time: 122.2266s
	iters: 200, epoch: 3 | loss: 0.6691108
	speed: 0.0119s/iter; left time: 105.1835s
	iters: 300, epoch: 3 | loss: 0.5404634
	speed: 0.0121s/iter; left time: 105.4604s
	iters: 400, epoch: 3 | loss: 0.6405305
	speed: 0.0119s/iter; left time: 102.7899s
	iters: 500, epoch: 3 | loss: 0.6173587
	speed: 0.0114s/iter; left time: 97.1269s
	iters: 600, epoch: 3 | loss: 0.7184176
	speed: 0.0116s/iter; left time: 97.3322s
	iters: 700, epoch: 3 | loss: 0.7031992
	speed: 0.0116s/iter; left time: 96.6448s
	iters: 800, epoch: 3 | loss: 0.6320516
	speed: 0.0114s/iter; left time: 93.7385s
	iters: 900, epoch: 3 | loss: 0.5346054
	speed: 0.0114s/iter; left time: 92.8636s
	iters: 1000, epoch: 3 | loss: 0.5697716
	speed: 0.0114s/iter; left time: 91.2313s
	iters: 1100, epoch: 3 | loss: 0.7577302
	speed: 0.0112s/iter; left time: 88.6410s
Epoch: 3 cost time: 12.591599464416504
Epoch: 3, Steps: 1128 | Train Loss: 0.6585553 Vali Loss: 0.7198620 Test Loss: 0.3573394
Validation loss decreased (0.724261 --> 0.719862).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4981708
	speed: 0.0132s/iter; left time: 102.6485s
	iters: 200, epoch: 4 | loss: 0.6076027
	speed: 0.0118s/iter; left time: 91.1088s
	iters: 300, epoch: 4 | loss: 0.5476630
	speed: 0.0117s/iter; left time: 88.6178s
	iters: 400, epoch: 4 | loss: 0.9115268
	speed: 0.0115s/iter; left time: 86.0654s
	iters: 500, epoch: 4 | loss: 0.7418967
	speed: 0.0113s/iter; left time: 83.6006s
	iters: 600, epoch: 4 | loss: 0.5586854
	speed: 0.0115s/iter; left time: 83.8675s
	iters: 700, epoch: 4 | loss: 0.7436060
	speed: 0.0113s/iter; left time: 81.6404s
	iters: 800, epoch: 4 | loss: 0.6847959
	speed: 0.0112s/iter; left time: 79.5947s
	iters: 900, epoch: 4 | loss: 0.6422402
	speed: 0.0113s/iter; left time: 79.4004s
	iters: 1000, epoch: 4 | loss: 0.5963390
	speed: 0.0113s/iter; left time: 77.9964s
	iters: 1100, epoch: 4 | loss: 0.6417990
	speed: 0.0112s/iter; left time: 76.1126s
Epoch: 4 cost time: 12.71802544593811
Epoch: 4, Steps: 1128 | Train Loss: 0.6477922 Vali Loss: 0.7167413 Test Loss: 0.3595993
Validation loss decreased (0.719862 --> 0.716741).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6390905
	speed: 0.0141s/iter; left time: 93.8917s
	iters: 200, epoch: 5 | loss: 0.7053292
	speed: 0.0116s/iter; left time: 76.3662s
	iters: 300, epoch: 5 | loss: 0.7000045
	speed: 0.0110s/iter; left time: 71.2317s
	iters: 400, epoch: 5 | loss: 0.7509988
	speed: 0.0106s/iter; left time: 67.6870s
	iters: 500, epoch: 5 | loss: 0.6437209
	speed: 0.0101s/iter; left time: 63.4246s
	iters: 600, epoch: 5 | loss: 0.7760103
	speed: 0.0101s/iter; left time: 62.4051s
	iters: 700, epoch: 5 | loss: 0.6130058
	speed: 0.0101s/iter; left time: 61.3240s
	iters: 800, epoch: 5 | loss: 0.5936981
	speed: 0.0101s/iter; left time: 60.3576s
	iters: 900, epoch: 5 | loss: 0.6130471
	speed: 0.0101s/iter; left time: 59.0214s
	iters: 1000, epoch: 5 | loss: 0.6219294
	speed: 0.0100s/iter; left time: 57.7314s
	iters: 1100, epoch: 5 | loss: 0.4251555
	speed: 0.0099s/iter; left time: 55.8643s
Epoch: 5 cost time: 11.11329436302185
Epoch: 5, Steps: 1128 | Train Loss: 0.6412395 Vali Loss: 0.7169820 Test Loss: 0.3583933
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6951519
	speed: 0.0082s/iter; left time: 45.4638s
	iters: 200, epoch: 6 | loss: 0.6878789
	speed: 0.0074s/iter; left time: 40.4037s
	iters: 300, epoch: 6 | loss: 0.6201112
	speed: 0.0071s/iter; left time: 38.1016s
	iters: 400, epoch: 6 | loss: 0.5260415
	speed: 0.0073s/iter; left time: 38.2890s
	iters: 500, epoch: 6 | loss: 0.5456110
	speed: 0.0072s/iter; left time: 36.8044s
	iters: 600, epoch: 6 | loss: 0.5390702
	speed: 0.0071s/iter; left time: 35.8103s
	iters: 700, epoch: 6 | loss: 0.5513284
	speed: 0.0070s/iter; left time: 34.7229s
	iters: 800, epoch: 6 | loss: 0.7967665
	speed: 0.0070s/iter; left time: 33.7638s
	iters: 900, epoch: 6 | loss: 0.6507930
	speed: 0.0071s/iter; left time: 33.6085s
	iters: 1000, epoch: 6 | loss: 0.6328467
	speed: 0.0073s/iter; left time: 33.6840s
	iters: 1100, epoch: 6 | loss: 0.7447623
	speed: 0.0076s/iter; left time: 34.3669s
Epoch: 6 cost time: 8.623666763305664
Epoch: 6, Steps: 1128 | Train Loss: 0.6371451 Vali Loss: 0.7182929 Test Loss: 0.3588828
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8712752
	speed: 0.0108s/iter; left time: 47.6313s
	iters: 200, epoch: 7 | loss: 0.6392491
	speed: 0.0096s/iter; left time: 41.3591s
	iters: 300, epoch: 7 | loss: 0.9477710
	speed: 0.0094s/iter; left time: 39.3946s
	iters: 400, epoch: 7 | loss: 0.7891097
	speed: 0.0094s/iter; left time: 38.4887s
	iters: 500, epoch: 7 | loss: 0.5668001
	speed: 0.0092s/iter; left time: 36.7458s
	iters: 600, epoch: 7 | loss: 0.6875136
	speed: 0.0091s/iter; left time: 35.5728s
	iters: 700, epoch: 7 | loss: 0.5433302
	speed: 0.0091s/iter; left time: 34.8464s
	iters: 800, epoch: 7 | loss: 0.5226834
	speed: 0.0090s/iter; left time: 33.4805s
	iters: 900, epoch: 7 | loss: 0.5888004
	speed: 0.0091s/iter; left time: 32.7169s
	iters: 1000, epoch: 7 | loss: 0.6175349
	speed: 0.0091s/iter; left time: 32.0506s
	iters: 1100, epoch: 7 | loss: 0.5349168
	speed: 0.0090s/iter; left time: 30.7534s
Epoch: 7 cost time: 10.192178726196289
Epoch: 7, Steps: 1128 | Train Loss: 0.6345816 Vali Loss: 0.7210461 Test Loss: 0.3589692
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.5272321
	speed: 0.0110s/iter; left time: 36.1667s
	iters: 200, epoch: 8 | loss: 0.5495510
	speed: 0.0102s/iter; left time: 32.6039s
	iters: 300, epoch: 8 | loss: 0.6760647
	speed: 0.0096s/iter; left time: 29.4740s
	iters: 400, epoch: 8 | loss: 0.5790585
	speed: 0.0097s/iter; left time: 28.9123s
	iters: 500, epoch: 8 | loss: 0.4999919
	speed: 0.0096s/iter; left time: 27.5727s
	iters: 600, epoch: 8 | loss: 0.6267890
	speed: 0.0093s/iter; left time: 25.8332s
	iters: 700, epoch: 8 | loss: 0.6822749
	speed: 0.0093s/iter; left time: 24.9397s
	iters: 800, epoch: 8 | loss: 0.5804712
	speed: 0.0092s/iter; left time: 23.9061s
	iters: 900, epoch: 8 | loss: 0.5683970
	speed: 0.0091s/iter; left time: 22.7111s
	iters: 1000, epoch: 8 | loss: 0.6217309
	speed: 0.0092s/iter; left time: 21.8472s
	iters: 1100, epoch: 8 | loss: 0.6905406
	speed: 0.0091s/iter; left time: 20.8750s
Epoch: 8 cost time: 10.297092199325562
Epoch: 8, Steps: 1128 | Train Loss: 0.6336783 Vali Loss: 0.7203314 Test Loss: 0.3590815
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.5270975
	speed: 0.0110s/iter; left time: 23.6408s
	iters: 200, epoch: 9 | loss: 0.5234218
	speed: 0.0100s/iter; left time: 20.5824s
	iters: 300, epoch: 9 | loss: 0.5563243
	speed: 0.0094s/iter; left time: 18.3597s
	iters: 400, epoch: 9 | loss: 0.7049779
	speed: 0.0092s/iter; left time: 17.0138s
	iters: 500, epoch: 9 | loss: 0.4750180
	speed: 0.0092s/iter; left time: 16.1644s
	iters: 600, epoch: 9 | loss: 0.6725724
	speed: 0.0090s/iter; left time: 14.9953s
	iters: 700, epoch: 9 | loss: 0.8230469
	speed: 0.0090s/iter; left time: 13.9474s
	iters: 800, epoch: 9 | loss: 0.5564757
	speed: 0.0090s/iter; left time: 13.1264s
	iters: 900, epoch: 9 | loss: 0.5233007
	speed: 0.0089s/iter; left time: 12.0897s
	iters: 1000, epoch: 9 | loss: 0.5602701
	speed: 0.0089s/iter; left time: 11.1927s
	iters: 1100, epoch: 9 | loss: 0.5792266
	speed: 0.0089s/iter; left time: 10.3512s
Epoch: 9 cost time: 10.152714967727661
Epoch: 9, Steps: 1128 | Train Loss: 0.6330335 Vali Loss: 0.7185808 Test Loss: 0.3592349
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.35959911346435547, mae:0.3533741533756256
Use GPU: cuda:0
no_skip True
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.7989184
	speed: 0.0108s/iter; left time: 120.7408s
	iters: 200, epoch: 1 | loss: 0.9707910
	speed: 0.0101s/iter; left time: 111.7694s
	iters: 300, epoch: 1 | loss: 0.9232489
	speed: 0.0094s/iter; left time: 103.3942s
	iters: 400, epoch: 1 | loss: 0.6006282
	speed: 0.0090s/iter; left time: 97.5007s
	iters: 500, epoch: 1 | loss: 0.6228836
	speed: 0.0085s/iter; left time: 91.3692s
	iters: 600, epoch: 1 | loss: 0.5909810
	speed: 0.0081s/iter; left time: 86.8724s
	iters: 700, epoch: 1 | loss: 0.6930944
	speed: 0.0079s/iter; left time: 83.5163s
	iters: 800, epoch: 1 | loss: 0.7098456
	speed: 0.0079s/iter; left time: 82.4236s
	iters: 900, epoch: 1 | loss: 0.9095451
	speed: 0.0077s/iter; left time: 79.9666s
	iters: 1000, epoch: 1 | loss: 0.7982972
	speed: 0.0076s/iter; left time: 77.9135s
	iters: 1100, epoch: 1 | loss: 0.5177551
	speed: 0.0075s/iter; left time: 76.1056s
Epoch: 1 cost time: 8.460156679153442
Epoch: 1, Steps: 1128 | Train Loss: 0.7233410 Vali Loss: 0.7526395 Test Loss: 0.3659932
Validation loss decreased (inf --> 0.752640).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6871644
	speed: 0.0090s/iter; left time: 90.0805s
	iters: 200, epoch: 2 | loss: 0.6030458
	speed: 0.0078s/iter; left time: 77.6578s
	iters: 300, epoch: 2 | loss: 0.7108998
	speed: 0.0074s/iter; left time: 72.5292s
	iters: 400, epoch: 2 | loss: 0.5967036
	speed: 0.0071s/iter; left time: 69.5947s
	iters: 500, epoch: 2 | loss: 0.7045918
	speed: 0.0070s/iter; left time: 67.5391s
	iters: 600, epoch: 2 | loss: 0.7395359
	speed: 0.0069s/iter; left time: 66.0053s
	iters: 700, epoch: 2 | loss: 0.7335718
	speed: 0.0069s/iter; left time: 64.7556s
	iters: 800, epoch: 2 | loss: 0.6977887
	speed: 0.0068s/iter; left time: 63.6495s
	iters: 900, epoch: 2 | loss: 0.6591031
	speed: 0.0068s/iter; left time: 62.6081s
	iters: 1000, epoch: 2 | loss: 0.8512082
	speed: 0.0067s/iter; left time: 61.6228s
	iters: 1100, epoch: 2 | loss: 0.5973553
	speed: 0.0067s/iter; left time: 60.7327s
Epoch: 2 cost time: 7.621281147003174
Epoch: 2, Steps: 1128 | Train Loss: 0.6750380 Vali Loss: 0.7312310 Test Loss: 0.3600301
Validation loss decreased (0.752640 --> 0.731231).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6096407
	speed: 0.0080s/iter; left time: 71.0897s
	iters: 200, epoch: 3 | loss: 0.6851256
	speed: 0.0072s/iter; left time: 63.5158s
	iters: 300, epoch: 3 | loss: 0.5987785
	speed: 0.0070s/iter; left time: 60.8480s
	iters: 400, epoch: 3 | loss: 0.5772856
	speed: 0.0070s/iter; left time: 60.4641s
	iters: 500, epoch: 3 | loss: 0.5462503
	speed: 0.0069s/iter; left time: 59.2428s
	iters: 600, epoch: 3 | loss: 0.6058521
	speed: 0.0069s/iter; left time: 57.8230s
	iters: 700, epoch: 3 | loss: 0.5725194
	speed: 0.0068s/iter; left time: 57.0115s
	iters: 800, epoch: 3 | loss: 0.5400681
	speed: 0.0069s/iter; left time: 56.5200s
	iters: 900, epoch: 3 | loss: 0.7681935
	speed: 0.0069s/iter; left time: 55.9438s
	iters: 1000, epoch: 3 | loss: 0.8237548
	speed: 0.0069s/iter; left time: 55.0385s
	iters: 1100, epoch: 3 | loss: 0.5234149
	speed: 0.0068s/iter; left time: 54.0353s
Epoch: 3 cost time: 7.746044397354126
Epoch: 3, Steps: 1128 | Train Loss: 0.6566312 Vali Loss: 0.7195237 Test Loss: 0.3584353
Validation loss decreased (0.731231 --> 0.719524).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5535798
	speed: 0.0111s/iter; left time: 86.5627s
	iters: 200, epoch: 4 | loss: 0.5667582
	speed: 0.0100s/iter; left time: 76.7937s
	iters: 300, epoch: 4 | loss: 0.8906040
	speed: 0.0094s/iter; left time: 71.1369s
	iters: 400, epoch: 4 | loss: 0.6026859
	speed: 0.0087s/iter; left time: 64.9653s
	iters: 500, epoch: 4 | loss: 0.6450565
	speed: 0.0082s/iter; left time: 60.8318s
	iters: 600, epoch: 4 | loss: 0.6717898
	speed: 0.0079s/iter; left time: 57.8869s
	iters: 700, epoch: 4 | loss: 0.6849220
	speed: 0.0077s/iter; left time: 55.5835s
	iters: 800, epoch: 4 | loss: 0.5973815
	speed: 0.0076s/iter; left time: 53.7114s
	iters: 900, epoch: 4 | loss: 0.5253149
	speed: 0.0074s/iter; left time: 52.1048s
	iters: 1000, epoch: 4 | loss: 0.6253299
	speed: 0.0074s/iter; left time: 50.6996s
	iters: 1100, epoch: 4 | loss: 0.4902021
	speed: 0.0073s/iter; left time: 49.4334s
Epoch: 4 cost time: 8.238754272460938
Epoch: 4, Steps: 1128 | Train Loss: 0.6454245 Vali Loss: 0.7175170 Test Loss: 0.3591660
Validation loss decreased (0.719524 --> 0.717517).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5158259
	speed: 0.0103s/iter; left time: 68.5620s
	iters: 200, epoch: 5 | loss: 0.6055132
	speed: 0.0098s/iter; left time: 64.1431s
	iters: 300, epoch: 5 | loss: 0.6559010
	speed: 0.0096s/iter; left time: 61.8498s
	iters: 400, epoch: 5 | loss: 0.5367313
	speed: 0.0095s/iter; left time: 60.6993s
	iters: 500, epoch: 5 | loss: 0.6931497
	speed: 0.0092s/iter; left time: 57.4626s
	iters: 600, epoch: 5 | loss: 0.5579489
	speed: 0.0088s/iter; left time: 54.1003s
	iters: 700, epoch: 5 | loss: 0.5352251
	speed: 0.0084s/iter; left time: 51.2492s
	iters: 800, epoch: 5 | loss: 0.5161996
	speed: 0.0082s/iter; left time: 48.9431s
	iters: 900, epoch: 5 | loss: 0.5332223
	speed: 0.0081s/iter; left time: 47.5398s
	iters: 1000, epoch: 5 | loss: 0.5785208
	speed: 0.0081s/iter; left time: 46.7693s
	iters: 1100, epoch: 5 | loss: 0.5208711
	speed: 0.0081s/iter; left time: 45.9014s
Epoch: 5 cost time: 9.16178584098816
Epoch: 5, Steps: 1128 | Train Loss: 0.6384346 Vali Loss: 0.7247832 Test Loss: 0.3611975
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5983954
	speed: 0.0100s/iter; left time: 55.3793s
	iters: 200, epoch: 6 | loss: 0.5726738
	speed: 0.0090s/iter; left time: 49.1120s
	iters: 300, epoch: 6 | loss: 0.8464641
	speed: 0.0087s/iter; left time: 46.3803s
	iters: 400, epoch: 6 | loss: 0.6777102
	speed: 0.0083s/iter; left time: 43.2994s
	iters: 500, epoch: 6 | loss: 0.7183716
	speed: 0.0079s/iter; left time: 40.6349s
	iters: 600, epoch: 6 | loss: 0.5548583
	speed: 0.0077s/iter; left time: 38.6330s
	iters: 700, epoch: 6 | loss: 0.5668896
	speed: 0.0075s/iter; left time: 37.0336s
	iters: 800, epoch: 6 | loss: 0.6857429
	speed: 0.0074s/iter; left time: 35.6759s
	iters: 900, epoch: 6 | loss: 0.6091762
	speed: 0.0073s/iter; left time: 34.4938s
	iters: 1000, epoch: 6 | loss: 0.7139466
	speed: 0.0073s/iter; left time: 33.8940s
	iters: 1100, epoch: 6 | loss: 0.5868948
	speed: 0.0074s/iter; left time: 33.4254s
Epoch: 6 cost time: 8.36968445777893
Epoch: 6, Steps: 1128 | Train Loss: 0.6343701 Vali Loss: 0.7219185 Test Loss: 0.3611573
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.7015395
	speed: 0.0100s/iter; left time: 43.9871s
	iters: 200, epoch: 7 | loss: 0.7474554
	speed: 0.0095s/iter; left time: 40.9465s
	iters: 300, epoch: 7 | loss: 0.7244886
	speed: 0.0091s/iter; left time: 38.2808s
	iters: 400, epoch: 7 | loss: 0.5989162
	speed: 0.0088s/iter; left time: 36.2743s
	iters: 500, epoch: 7 | loss: 0.5622844
	speed: 0.0086s/iter; left time: 34.3652s
	iters: 600, epoch: 7 | loss: 0.7914681
	speed: 0.0082s/iter; left time: 32.1583s
	iters: 700, epoch: 7 | loss: 0.8293670
	speed: 0.0080s/iter; left time: 30.3997s
	iters: 800, epoch: 7 | loss: 0.7577730
	speed: 0.0078s/iter; left time: 28.9618s
	iters: 900, epoch: 7 | loss: 0.8031304
	speed: 0.0077s/iter; left time: 27.6464s
	iters: 1000, epoch: 7 | loss: 0.5664943
	speed: 0.0075s/iter; left time: 26.4647s
	iters: 1100, epoch: 7 | loss: 0.7471604
	speed: 0.0074s/iter; left time: 25.3838s
Epoch: 7 cost time: 8.424930095672607
Epoch: 7, Steps: 1128 | Train Loss: 0.6320651 Vali Loss: 0.7227334 Test Loss: 0.3620982
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.7304432
	speed: 0.0084s/iter; left time: 27.6030s
	iters: 200, epoch: 8 | loss: 0.5221760
	speed: 0.0075s/iter; left time: 23.7515s
	iters: 300, epoch: 8 | loss: 0.6481934
	speed: 0.0072s/iter; left time: 22.0757s
	iters: 400, epoch: 8 | loss: 0.6595955
	speed: 0.0070s/iter; left time: 20.9160s
	iters: 500, epoch: 8 | loss: 0.5320242
	speed: 0.0069s/iter; left time: 19.9090s
	iters: 600, epoch: 8 | loss: 0.6139320
	speed: 0.0068s/iter; left time: 19.0259s
	iters: 700, epoch: 8 | loss: 0.4735735
	speed: 0.0068s/iter; left time: 18.2113s
	iters: 800, epoch: 8 | loss: 0.5778682
	speed: 0.0067s/iter; left time: 17.4154s
	iters: 900, epoch: 8 | loss: 0.5001326
	speed: 0.0067s/iter; left time: 16.7305s
	iters: 1000, epoch: 8 | loss: 0.6840940
	speed: 0.0067s/iter; left time: 15.9881s
	iters: 1100, epoch: 8 | loss: 0.6158087
	speed: 0.0067s/iter; left time: 15.2690s
Epoch: 8 cost time: 7.595198154449463
Epoch: 8, Steps: 1128 | Train Loss: 0.6307601 Vali Loss: 0.7209883 Test Loss: 0.3621013
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.5760877
	speed: 0.0102s/iter; left time: 21.9691s
	iters: 200, epoch: 9 | loss: 0.5498005
	speed: 0.0088s/iter; left time: 18.0191s
	iters: 300, epoch: 9 | loss: 0.5434756
	speed: 0.0080s/iter; left time: 15.6365s
	iters: 400, epoch: 9 | loss: 0.5684871
	speed: 0.0076s/iter; left time: 14.1187s
	iters: 500, epoch: 9 | loss: 0.7099872
	speed: 0.0074s/iter; left time: 12.9464s
	iters: 600, epoch: 9 | loss: 0.5510446
	speed: 0.0072s/iter; left time: 11.9579s
	iters: 700, epoch: 9 | loss: 0.7144039
	speed: 0.0071s/iter; left time: 11.0665s
	iters: 800, epoch: 9 | loss: 0.7741606
	speed: 0.0070s/iter; left time: 10.2380s
	iters: 900, epoch: 9 | loss: 0.7118574
	speed: 0.0070s/iter; left time: 9.4519s
	iters: 1000, epoch: 9 | loss: 0.5874356
	speed: 0.0069s/iter; left time: 8.6950s
	iters: 1100, epoch: 9 | loss: 0.8909700
	speed: 0.0069s/iter; left time: 7.9557s
Epoch: 9 cost time: 7.801501989364624
Epoch: 9, Steps: 1128 | Train Loss: 0.6304673 Vali Loss: 0.7216919 Test Loss: 0.3622761
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.35916587710380554, mae:0.3529016971588135
Use GPU: cuda:0
no_skip True
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.7133811
	speed: 0.0088s/iter; left time: 98.3054s
	iters: 200, epoch: 1 | loss: 1.0532527
	speed: 0.0076s/iter; left time: 84.4948s
	iters: 300, epoch: 1 | loss: 0.7526730
	speed: 0.0072s/iter; left time: 79.5264s
	iters: 400, epoch: 1 | loss: 0.6295310
	speed: 0.0071s/iter; left time: 76.7687s
	iters: 500, epoch: 1 | loss: 0.6121524
	speed: 0.0071s/iter; left time: 77.0605s
	iters: 600, epoch: 1 | loss: 0.6646622
	speed: 0.0073s/iter; left time: 78.0033s
	iters: 700, epoch: 1 | loss: 0.7236812
	speed: 0.0075s/iter; left time: 78.9025s
	iters: 800, epoch: 1 | loss: 0.6084834
	speed: 0.0076s/iter; left time: 79.6358s
	iters: 900, epoch: 1 | loss: 0.8871434
	speed: 0.0076s/iter; left time: 79.3254s
	iters: 1000, epoch: 1 | loss: 0.6485097
	speed: 0.0075s/iter; left time: 77.3929s
	iters: 1100, epoch: 1 | loss: 0.7967341
	speed: 0.0074s/iter; left time: 75.6911s
Epoch: 1 cost time: 8.415624141693115
Epoch: 1, Steps: 1128 | Train Loss: 0.7297561 Vali Loss: 0.7491925 Test Loss: 0.3636280
Validation loss decreased (inf --> 0.749193).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6083466
	speed: 0.0081s/iter; left time: 81.2167s
	iters: 200, epoch: 2 | loss: 0.8969246
	speed: 0.0073s/iter; left time: 72.4178s
	iters: 300, epoch: 2 | loss: 0.6467866
	speed: 0.0070s/iter; left time: 69.1727s
	iters: 400, epoch: 2 | loss: 0.5577672
	speed: 0.0069s/iter; left time: 67.1041s
	iters: 500, epoch: 2 | loss: 0.8042874
	speed: 0.0068s/iter; left time: 65.6739s
	iters: 600, epoch: 2 | loss: 0.5840693
	speed: 0.0068s/iter; left time: 64.5884s
	iters: 700, epoch: 2 | loss: 0.5123423
	speed: 0.0067s/iter; left time: 63.5742s
	iters: 800, epoch: 2 | loss: 0.8399219
	speed: 0.0069s/iter; left time: 64.1021s
	iters: 900, epoch: 2 | loss: 0.4941845
	speed: 0.0069s/iter; left time: 63.3977s
	iters: 1000, epoch: 2 | loss: 0.6953814
	speed: 0.0068s/iter; left time: 62.5109s
	iters: 1100, epoch: 2 | loss: 0.6123600
	speed: 0.0068s/iter; left time: 61.5624s
Epoch: 2 cost time: 7.724099397659302
Epoch: 2, Steps: 1128 | Train Loss: 0.6727236 Vali Loss: 0.7202498 Test Loss: 0.3570884
Validation loss decreased (0.749193 --> 0.720250).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5982958
	speed: 0.0082s/iter; left time: 73.0168s
	iters: 200, epoch: 3 | loss: 0.5218322
	speed: 0.0073s/iter; left time: 64.7801s
	iters: 300, epoch: 3 | loss: 0.7112737
	speed: 0.0071s/iter; left time: 61.6783s
	iters: 400, epoch: 3 | loss: 0.6122527
	speed: 0.0069s/iter; left time: 59.7933s
	iters: 500, epoch: 3 | loss: 0.8912595
	speed: 0.0068s/iter; left time: 58.3924s
	iters: 600, epoch: 3 | loss: 0.7619824
	speed: 0.0068s/iter; left time: 57.2586s
	iters: 700, epoch: 3 | loss: 0.7475924
	speed: 0.0068s/iter; left time: 56.2383s
	iters: 800, epoch: 3 | loss: 0.8038327
	speed: 0.0067s/iter; left time: 55.3372s
	iters: 900, epoch: 3 | loss: 0.5907452
	speed: 0.0067s/iter; left time: 54.5066s
	iters: 1000, epoch: 3 | loss: 0.7747394
	speed: 0.0067s/iter; left time: 53.6841s
	iters: 1100, epoch: 3 | loss: 0.6683847
	speed: 0.0067s/iter; left time: 52.8881s
Epoch: 3 cost time: 7.5750627517700195
Epoch: 3, Steps: 1128 | Train Loss: 0.6538375 Vali Loss: 0.7128459 Test Loss: 0.3559974
Validation loss decreased (0.720250 --> 0.712846).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6063337
	speed: 0.0084s/iter; left time: 65.1639s
	iters: 200, epoch: 4 | loss: 1.0509220
	speed: 0.0074s/iter; left time: 57.1645s
	iters: 300, epoch: 4 | loss: 0.6620294
	speed: 0.0076s/iter; left time: 57.5074s
	iters: 400, epoch: 4 | loss: 0.8078482
	speed: 0.0077s/iter; left time: 57.5220s
	iters: 500, epoch: 4 | loss: 0.5394125
	speed: 0.0077s/iter; left time: 57.1970s
	iters: 600, epoch: 4 | loss: 0.4808851
	speed: 0.0076s/iter; left time: 55.3017s
	iters: 700, epoch: 4 | loss: 0.7030502
	speed: 0.0074s/iter; left time: 53.4030s
	iters: 800, epoch: 4 | loss: 0.6481578
	speed: 0.0073s/iter; left time: 51.7904s
	iters: 900, epoch: 4 | loss: 0.6650338
	speed: 0.0072s/iter; left time: 50.3913s
	iters: 1000, epoch: 4 | loss: 0.5774517
	speed: 0.0071s/iter; left time: 49.1355s
	iters: 1100, epoch: 4 | loss: 0.8605888
	speed: 0.0071s/iter; left time: 48.0065s
Epoch: 4 cost time: 7.994495868682861
Epoch: 4, Steps: 1128 | Train Loss: 0.6417912 Vali Loss: 0.7135733 Test Loss: 0.3574734
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6756408
	speed: 0.0078s/iter; left time: 52.0236s
	iters: 200, epoch: 5 | loss: 0.7092013
	speed: 0.0072s/iter; left time: 46.9717s
	iters: 300, epoch: 5 | loss: 0.6946067
	speed: 0.0069s/iter; left time: 44.9399s
	iters: 400, epoch: 5 | loss: 0.6084097
	speed: 0.0068s/iter; left time: 43.5267s
	iters: 500, epoch: 5 | loss: 0.5603524
	speed: 0.0068s/iter; left time: 42.3877s
	iters: 600, epoch: 5 | loss: 0.7018718
	speed: 0.0067s/iter; left time: 41.4186s
	iters: 700, epoch: 5 | loss: 0.5682417
	speed: 0.0067s/iter; left time: 40.5602s
	iters: 800, epoch: 5 | loss: 0.5975240
	speed: 0.0067s/iter; left time: 39.7407s
	iters: 900, epoch: 5 | loss: 0.6091006
	speed: 0.0066s/iter; left time: 38.9572s
	iters: 1000, epoch: 5 | loss: 0.5588282
	speed: 0.0066s/iter; left time: 38.2050s
	iters: 1100, epoch: 5 | loss: 0.5749950
	speed: 0.0066s/iter; left time: 37.4661s
Epoch: 5 cost time: 7.496639728546143
Epoch: 5, Steps: 1128 | Train Loss: 0.6342861 Vali Loss: 0.7169271 Test Loss: 0.3595040
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6076123
	speed: 0.0079s/iter; left time: 43.8286s
	iters: 200, epoch: 6 | loss: 0.5260755
	speed: 0.0074s/iter; left time: 40.2183s
	iters: 300, epoch: 6 | loss: 0.6269643
	speed: 0.0071s/iter; left time: 38.1407s
	iters: 400, epoch: 6 | loss: 0.5948597
	speed: 0.0070s/iter; left time: 36.8038s
	iters: 500, epoch: 6 | loss: 0.7405541
	speed: 0.0069s/iter; left time: 35.5844s
	iters: 600, epoch: 6 | loss: 0.5863165
	speed: 0.0069s/iter; left time: 34.5426s
	iters: 700, epoch: 6 | loss: 0.5436645
	speed: 0.0068s/iter; left time: 33.6099s
	iters: 800, epoch: 6 | loss: 0.5331999
	speed: 0.0068s/iter; left time: 32.7580s
	iters: 900, epoch: 6 | loss: 0.5460855
	speed: 0.0067s/iter; left time: 31.9613s
	iters: 1000, epoch: 6 | loss: 0.5062678
	speed: 0.0067s/iter; left time: 31.1810s
	iters: 1100, epoch: 6 | loss: 0.5224758
	speed: 0.0067s/iter; left time: 30.4259s
Epoch: 6 cost time: 7.613955974578857
Epoch: 6, Steps: 1128 | Train Loss: 0.6304065 Vali Loss: 0.7160124 Test Loss: 0.3597179
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5018362
	speed: 0.0093s/iter; left time: 41.1915s
	iters: 200, epoch: 7 | loss: 0.6190798
	speed: 0.0087s/iter; left time: 37.4621s
	iters: 300, epoch: 7 | loss: 0.6032798
	speed: 0.0082s/iter; left time: 34.7269s
	iters: 400, epoch: 7 | loss: 0.8043642
	speed: 0.0078s/iter; left time: 32.0838s
	iters: 500, epoch: 7 | loss: 0.5671697
	speed: 0.0075s/iter; left time: 30.2389s
	iters: 600, epoch: 7 | loss: 0.6203822
	speed: 0.0074s/iter; left time: 28.7724s
	iters: 700, epoch: 7 | loss: 0.5891510
	speed: 0.0072s/iter; left time: 27.5697s
	iters: 800, epoch: 7 | loss: 0.6456956
	speed: 0.0071s/iter; left time: 26.4965s
	iters: 900, epoch: 7 | loss: 0.5032423
	speed: 0.0071s/iter; left time: 25.5316s
	iters: 1000, epoch: 7 | loss: 0.5010543
	speed: 0.0070s/iter; left time: 24.6295s
	iters: 1100, epoch: 7 | loss: 0.6292893
	speed: 0.0070s/iter; left time: 23.7683s
Epoch: 7 cost time: 7.906899690628052
Epoch: 7, Steps: 1128 | Train Loss: 0.6282637 Vali Loss: 0.7173463 Test Loss: 0.3601240
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.7203841
	speed: 0.0078s/iter; left time: 25.7836s
	iters: 200, epoch: 8 | loss: 0.5280722
	speed: 0.0072s/iter; left time: 22.8364s
	iters: 300, epoch: 8 | loss: 0.6162973
	speed: 0.0069s/iter; left time: 21.4116s
	iters: 400, epoch: 8 | loss: 0.6251586
	speed: 0.0068s/iter; left time: 20.3749s
	iters: 500, epoch: 8 | loss: 0.7059680
	speed: 0.0068s/iter; left time: 19.4916s
	iters: 600, epoch: 8 | loss: 0.5611893
	speed: 0.0067s/iter; left time: 18.7031s
	iters: 700, epoch: 8 | loss: 0.6920567
	speed: 0.0067s/iter; left time: 17.9417s
	iters: 800, epoch: 8 | loss: 0.4848204
	speed: 0.0067s/iter; left time: 17.2036s
	iters: 900, epoch: 8 | loss: 0.5649859
	speed: 0.0066s/iter; left time: 16.4902s
	iters: 1000, epoch: 8 | loss: 0.8344293
	speed: 0.0066s/iter; left time: 15.7913s
	iters: 1100, epoch: 8 | loss: 0.6578876
	speed: 0.0066s/iter; left time: 15.0950s
Epoch: 8 cost time: 7.493140459060669
Epoch: 8, Steps: 1128 | Train Loss: 0.6270813 Vali Loss: 0.7171658 Test Loss: 0.3602737
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCTrue_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.35599735379219055, mae:0.35088905692100525
