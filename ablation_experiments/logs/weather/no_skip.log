nohup: ignoring input
Seed: 42
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_96       Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip True
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.8769029
	speed: 0.0459s/iter; left time: 521.7923s
	iters: 200, epoch: 1 | loss: 0.3984021
	speed: 0.0352s/iter; left time: 396.6115s
	iters: 300, epoch: 1 | loss: 0.5829382
	speed: 0.0317s/iter; left time: 354.0830s
	iters: 400, epoch: 1 | loss: 0.3591505
	speed: 0.0299s/iter; left time: 331.0724s
	iters: 500, epoch: 1 | loss: 0.4121027
	speed: 0.0289s/iter; left time: 316.6493s
	iters: 600, epoch: 1 | loss: 0.3171036
	speed: 0.0281s/iter; left time: 305.1018s
	iters: 700, epoch: 1 | loss: 0.5068409
	speed: 0.0275s/iter; left time: 296.2034s
	iters: 800, epoch: 1 | loss: 0.4152549
	speed: 0.0271s/iter; left time: 288.6965s
	iters: 900, epoch: 1 | loss: 0.3398758
	speed: 0.0267s/iter; left time: 282.5047s
	iters: 1000, epoch: 1 | loss: 0.4089647
	speed: 0.0265s/iter; left time: 277.0588s
	iters: 1100, epoch: 1 | loss: 0.4036246
	speed: 0.0263s/iter; left time: 272.2907s
Epoch: 1 cost time: 30.252268075942993
Epoch: 1, Steps: 1147 | Train Loss: 0.5343759 Vali Loss: 0.4769519 Test Loss: 0.1927481
Validation loss decreased (inf --> 0.476952).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4545027
	speed: 0.0241s/iter; left time: 246.4873s
	iters: 200, epoch: 2 | loss: 0.3567479
	speed: 0.0231s/iter; left time: 233.5900s
	iters: 300, epoch: 2 | loss: 0.6907321
	speed: 0.0229s/iter; left time: 229.4238s
	iters: 400, epoch: 2 | loss: 0.3952792
	speed: 0.0228s/iter; left time: 225.9207s
	iters: 500, epoch: 2 | loss: 0.3834583
	speed: 0.0231s/iter; left time: 227.3529s
	iters: 600, epoch: 2 | loss: 0.4454237
	speed: 0.0234s/iter; left time: 227.3526s
	iters: 700, epoch: 2 | loss: 0.3468966
	speed: 0.0241s/iter; left time: 232.2366s
	iters: 800, epoch: 2 | loss: 1.1280607
	speed: 0.0253s/iter; left time: 241.3319s
	iters: 900, epoch: 2 | loss: 0.4299574
	speed: 0.0263s/iter; left time: 248.2657s
	iters: 1000, epoch: 2 | loss: 0.3104407
	speed: 0.0269s/iter; left time: 251.0035s
	iters: 1100, epoch: 2 | loss: 0.3513871
	speed: 0.0273s/iter; left time: 252.1300s
Epoch: 2 cost time: 31.351962089538574
Epoch: 2, Steps: 1147 | Train Loss: 0.4800025 Vali Loss: 0.4646485 Test Loss: 0.1873867
Validation loss decreased (0.476952 --> 0.464648).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 1.2230238
	speed: 0.0299s/iter; left time: 271.5468s
	iters: 200, epoch: 3 | loss: 0.4760048
	speed: 0.0260s/iter; left time: 233.2333s
	iters: 300, epoch: 3 | loss: 0.3136824
	speed: 0.0254s/iter; left time: 225.2367s
	iters: 400, epoch: 3 | loss: 0.3496273
	speed: 0.0268s/iter; left time: 234.9522s
	iters: 500, epoch: 3 | loss: 0.5571074
	speed: 0.0272s/iter; left time: 235.8223s
	iters: 600, epoch: 3 | loss: 0.3472876
	speed: 0.0267s/iter; left time: 229.3235s
	iters: 700, epoch: 3 | loss: 0.6683984
	speed: 0.0265s/iter; left time: 224.6819s
	iters: 800, epoch: 3 | loss: 0.4397838
	speed: 0.0262s/iter; left time: 219.8114s
	iters: 900, epoch: 3 | loss: 1.2311271
	speed: 0.0260s/iter; left time: 215.2045s
	iters: 1000, epoch: 3 | loss: 0.4341940
	speed: 0.0257s/iter; left time: 209.9533s
	iters: 1100, epoch: 3 | loss: 0.2603716
	speed: 0.0253s/iter; left time: 204.6528s
Epoch: 3 cost time: 29.195295333862305
Epoch: 3, Steps: 1147 | Train Loss: 0.4572717 Vali Loss: 0.4514628 Test Loss: 0.1870528
Validation loss decreased (0.464648 --> 0.451463).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3977334
	speed: 0.0299s/iter; left time: 236.8201s
	iters: 200, epoch: 4 | loss: 0.2738826
	speed: 0.0255s/iter; left time: 199.8291s
	iters: 300, epoch: 4 | loss: 0.4604508
	speed: 0.0225s/iter; left time: 173.8002s
	iters: 400, epoch: 4 | loss: 0.3499041
	speed: 0.0210s/iter; left time: 160.4826s
	iters: 500, epoch: 4 | loss: 0.3707447
	speed: 0.0210s/iter; left time: 158.4556s
	iters: 600, epoch: 4 | loss: 1.2660288
	speed: 0.0217s/iter; left time: 161.4711s
	iters: 700, epoch: 4 | loss: 1.0842952
	speed: 0.0221s/iter; left time: 162.3293s
	iters: 800, epoch: 4 | loss: 0.3759786
	speed: 0.0225s/iter; left time: 162.6902s
	iters: 900, epoch: 4 | loss: 0.2987807
	speed: 0.0228s/iter; left time: 162.2366s
	iters: 1000, epoch: 4 | loss: 1.2990825
	speed: 0.0229s/iter; left time: 160.9813s
	iters: 1100, epoch: 4 | loss: 0.3200895
	speed: 0.0235s/iter; left time: 162.6932s
Epoch: 4 cost time: 27.130887031555176
Epoch: 4, Steps: 1147 | Train Loss: 0.4447489 Vali Loss: 0.4393305 Test Loss: 0.1834149
Validation loss decreased (0.451463 --> 0.439330).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3048558
	speed: 0.0300s/iter; left time: 203.6333s
	iters: 200, epoch: 5 | loss: 1.3109708
	speed: 0.0331s/iter; left time: 221.5339s
	iters: 300, epoch: 5 | loss: 0.2755342
	speed: 0.0337s/iter; left time: 221.6670s
	iters: 400, epoch: 5 | loss: 0.4696866
	speed: 0.0341s/iter; left time: 221.1762s
	iters: 500, epoch: 5 | loss: 0.3506098
	speed: 0.0341s/iter; left time: 217.9385s
	iters: 600, epoch: 5 | loss: 0.3126419
	speed: 0.0328s/iter; left time: 205.9869s
	iters: 700, epoch: 5 | loss: 0.4253461
	speed: 0.0315s/iter; left time: 194.8921s
	iters: 800, epoch: 5 | loss: 0.3579161
	speed: 0.0306s/iter; left time: 186.0896s
	iters: 900, epoch: 5 | loss: 0.3810028
	speed: 0.0307s/iter; left time: 183.4361s
	iters: 1000, epoch: 5 | loss: 0.3312799
	speed: 0.0306s/iter; left time: 180.0057s
	iters: 1100, epoch: 5 | loss: 0.2997125
	speed: 0.0298s/iter; left time: 172.5123s
Epoch: 5 cost time: 34.2796573638916
Epoch: 5, Steps: 1147 | Train Loss: 0.4372658 Vali Loss: 0.4367773 Test Loss: 0.1838314
Validation loss decreased (0.439330 --> 0.436777).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2503289
	speed: 0.0404s/iter; left time: 227.9440s
	iters: 200, epoch: 6 | loss: 0.2313309
	speed: 0.0347s/iter; left time: 191.8392s
	iters: 300, epoch: 6 | loss: 0.2484283
	speed: 0.0313s/iter; left time: 169.9446s
	iters: 400, epoch: 6 | loss: 0.4651369
	speed: 0.0296s/iter; left time: 157.9492s
	iters: 500, epoch: 6 | loss: 0.3254654
	speed: 0.0285s/iter; left time: 149.2421s
	iters: 600, epoch: 6 | loss: 0.4857603
	speed: 0.0274s/iter; left time: 140.6381s
	iters: 700, epoch: 6 | loss: 0.3211353
	speed: 0.0266s/iter; left time: 134.1827s
	iters: 800, epoch: 6 | loss: 0.3214541
	speed: 0.0262s/iter; left time: 129.2054s
	iters: 900, epoch: 6 | loss: 0.4113679
	speed: 0.0258s/iter; left time: 124.7767s
	iters: 1000, epoch: 6 | loss: 0.2564123
	speed: 0.0255s/iter; left time: 120.8060s
	iters: 1100, epoch: 6 | loss: 0.3295395
	speed: 0.0258s/iter; left time: 119.5461s
Epoch: 6 cost time: 29.89772915840149
Epoch: 6, Steps: 1147 | Train Loss: 0.4338128 Vali Loss: 0.4326162 Test Loss: 0.1827076
Validation loss decreased (0.436777 --> 0.432616).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5489388
	speed: 0.0271s/iter; left time: 121.5272s
	iters: 200, epoch: 7 | loss: 0.3707371
	speed: 0.0225s/iter; left time: 98.8076s
	iters: 300, epoch: 7 | loss: 0.2412481
	speed: 0.0209s/iter; left time: 89.6427s
	iters: 400, epoch: 7 | loss: 0.2898575
	speed: 0.0207s/iter; left time: 86.6310s
	iters: 500, epoch: 7 | loss: 0.2217529
	speed: 0.0224s/iter; left time: 91.6045s
	iters: 600, epoch: 7 | loss: 0.2665422
	speed: 0.0225s/iter; left time: 89.6362s
	iters: 700, epoch: 7 | loss: 0.2676314
	speed: 0.0224s/iter; left time: 87.2086s
	iters: 800, epoch: 7 | loss: 0.5125775
	speed: 0.0223s/iter; left time: 84.5677s
	iters: 900, epoch: 7 | loss: 0.4468341
	speed: 0.0222s/iter; left time: 82.0586s
	iters: 1000, epoch: 7 | loss: 0.2908804
	speed: 0.0221s/iter; left time: 79.4284s
	iters: 1100, epoch: 7 | loss: 0.2592527
	speed: 0.0222s/iter; left time: 77.3130s
Epoch: 7 cost time: 25.753478288650513
Epoch: 7, Steps: 1147 | Train Loss: 0.4321708 Vali Loss: 0.4327919 Test Loss: 0.1827437
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4577208
	speed: 0.0334s/iter; left time: 111.7878s
	iters: 200, epoch: 8 | loss: 0.2813294
	speed: 0.0282s/iter; left time: 91.4678s
	iters: 300, epoch: 8 | loss: 0.4491585
	speed: 0.0263s/iter; left time: 82.4932s
	iters: 400, epoch: 8 | loss: 0.3008352
	speed: 0.0255s/iter; left time: 77.6985s
	iters: 500, epoch: 8 | loss: 0.6745016
	speed: 0.0254s/iter; left time: 74.6575s
	iters: 600, epoch: 8 | loss: 0.3501170
	speed: 0.0254s/iter; left time: 72.2098s
	iters: 700, epoch: 8 | loss: 0.4783599
	speed: 0.0251s/iter; left time: 68.8887s
	iters: 800, epoch: 8 | loss: 0.3938181
	speed: 0.0247s/iter; left time: 65.3117s
	iters: 900, epoch: 8 | loss: 0.2549895
	speed: 0.0257s/iter; left time: 65.3267s
	iters: 1000, epoch: 8 | loss: 0.3888493
	speed: 0.0265s/iter; left time: 64.7379s
	iters: 1100, epoch: 8 | loss: 0.3744195
	speed: 0.0261s/iter; left time: 61.2394s
Epoch: 8 cost time: 29.919228315353394
Epoch: 8, Steps: 1147 | Train Loss: 0.4304727 Vali Loss: 0.4320172 Test Loss: 0.1818747
Validation loss decreased (0.432616 --> 0.432017).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3515965
	speed: 0.0270s/iter; left time: 59.2724s
	iters: 200, epoch: 9 | loss: 0.3667930
	speed: 0.0244s/iter; left time: 51.0148s
	iters: 300, epoch: 9 | loss: 0.3431968
	speed: 0.0237s/iter; left time: 47.2848s
	iters: 400, epoch: 9 | loss: 0.4505359
	speed: 0.0234s/iter; left time: 44.2534s
	iters: 500, epoch: 9 | loss: 0.3679488
	speed: 0.0232s/iter; left time: 41.7191s
	iters: 600, epoch: 9 | loss: 0.2882535
	speed: 0.0231s/iter; left time: 39.2318s
	iters: 700, epoch: 9 | loss: 0.2184373
	speed: 0.0227s/iter; left time: 36.1999s
	iters: 800, epoch: 9 | loss: 0.2897676
	speed: 0.0223s/iter; left time: 33.4083s
	iters: 900, epoch: 9 | loss: 0.4056069
	speed: 0.0223s/iter; left time: 31.1662s
	iters: 1000, epoch: 9 | loss: 0.2561089
	speed: 0.0223s/iter; left time: 28.8851s
	iters: 1100, epoch: 9 | loss: 0.2461581
	speed: 0.0223s/iter; left time: 26.6404s
Epoch: 9 cost time: 26.01668095588684
Epoch: 9, Steps: 1147 | Train Loss: 0.4297519 Vali Loss: 0.4329204 Test Loss: 0.1821790
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3863962
	speed: 0.0189s/iter; left time: 19.7886s
	iters: 200, epoch: 10 | loss: 0.4506902
	speed: 0.0190s/iter; left time: 18.0262s
	iters: 300, epoch: 10 | loss: 0.4018895
	speed: 0.0192s/iter; left time: 16.2780s
	iters: 400, epoch: 10 | loss: 2.2336707
	speed: 0.0189s/iter; left time: 14.1348s
	iters: 500, epoch: 10 | loss: 0.2771852
	speed: 0.0187s/iter; left time: 12.1059s
	iters: 600, epoch: 10 | loss: 0.3949955
	speed: 0.0189s/iter; left time: 10.3310s
	iters: 700, epoch: 10 | loss: 0.4423548
	speed: 0.0192s/iter; left time: 8.6045s
	iters: 800, epoch: 10 | loss: 0.3496433
	speed: 0.0204s/iter; left time: 7.1009s
	iters: 900, epoch: 10 | loss: 0.3652313
	speed: 0.0219s/iter; left time: 5.4382s
	iters: 1000, epoch: 10 | loss: 0.3531419
	speed: 0.0230s/iter; left time: 3.4051s
	iters: 1100, epoch: 10 | loss: 0.2155678
	speed: 0.0229s/iter; left time: 1.0989s
Epoch: 10 cost time: 26.3439724445343
Epoch: 10, Steps: 1147 | Train Loss: 0.4294842 Vali Loss: 0.4332274 Test Loss: 0.1822430
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.18187472224235535, mae:0.22368691861629486
Use GPU: cuda:0
no_skip True
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.5386018
	speed: 0.0348s/iter; left time: 396.0472s
	iters: 200, epoch: 1 | loss: 0.4397692
	speed: 0.0284s/iter; left time: 320.2130s
	iters: 300, epoch: 1 | loss: 0.3651700
	speed: 0.0263s/iter; left time: 293.8960s
	iters: 400, epoch: 1 | loss: 0.4059298
	speed: 0.0253s/iter; left time: 279.7444s
	iters: 500, epoch: 1 | loss: 0.3399410
	speed: 0.0247s/iter; left time: 270.5960s
	iters: 600, epoch: 1 | loss: 0.4523796
	speed: 0.0243s/iter; left time: 263.9114s
	iters: 700, epoch: 1 | loss: 0.3985935
	speed: 0.0243s/iter; left time: 261.2254s
	iters: 800, epoch: 1 | loss: 0.4388331
	speed: 0.0241s/iter; left time: 257.2892s
	iters: 900, epoch: 1 | loss: 0.4369607
	speed: 0.0245s/iter; left time: 259.0778s
	iters: 1000, epoch: 1 | loss: 0.5186863
	speed: 0.0252s/iter; left time: 264.3340s
	iters: 1100, epoch: 1 | loss: 0.3720690
	speed: 0.0252s/iter; left time: 261.0770s
Epoch: 1 cost time: 28.95242476463318
Epoch: 1, Steps: 1147 | Train Loss: 0.5333249 Vali Loss: 0.4690380 Test Loss: 0.1909049
Validation loss decreased (inf --> 0.469038).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 1.1269227
	speed: 0.0254s/iter; left time: 259.6222s
	iters: 200, epoch: 2 | loss: 0.2984605
	speed: 0.0235s/iter; left time: 237.4434s
	iters: 300, epoch: 2 | loss: 0.5098969
	speed: 0.0228s/iter; left time: 228.1045s
	iters: 400, epoch: 2 | loss: 0.7124157
	speed: 0.0228s/iter; left time: 225.9785s
	iters: 500, epoch: 2 | loss: 0.2773561
	speed: 0.0227s/iter; left time: 222.9103s
	iters: 600, epoch: 2 | loss: 0.3396195
	speed: 0.0228s/iter; left time: 221.6068s
	iters: 700, epoch: 2 | loss: 2.0441852
	speed: 0.0228s/iter; left time: 219.6926s
	iters: 800, epoch: 2 | loss: 0.3821336
	speed: 0.0228s/iter; left time: 216.9468s
	iters: 900, epoch: 2 | loss: 0.2704956
	speed: 0.0229s/iter; left time: 215.4636s
	iters: 1000, epoch: 2 | loss: 0.3872450
	speed: 0.0228s/iter; left time: 212.2463s
	iters: 1100, epoch: 2 | loss: 0.4931619
	speed: 0.0226s/iter; left time: 208.7908s
Epoch: 2 cost time: 26.053913831710815
Epoch: 2, Steps: 1147 | Train Loss: 0.4812770 Vali Loss: 0.4779872 Test Loss: 0.1988550
EarlyStopping counter: 1 out of 5
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 1.4460052
	speed: 0.0289s/iter; left time: 262.7079s
	iters: 200, epoch: 3 | loss: 0.3906519
	speed: 0.0263s/iter; left time: 236.4163s
	iters: 300, epoch: 3 | loss: 0.3974695
	speed: 0.0287s/iter; left time: 254.8662s
	iters: 400, epoch: 3 | loss: 0.2765131
	speed: 0.0276s/iter; left time: 242.6363s
	iters: 500, epoch: 3 | loss: 0.3815066
	speed: 0.0265s/iter; left time: 230.2903s
	iters: 600, epoch: 3 | loss: 0.4085945
	speed: 0.0260s/iter; left time: 222.6819s
	iters: 700, epoch: 3 | loss: 0.3617285
	speed: 0.0254s/iter; left time: 215.4098s
	iters: 800, epoch: 3 | loss: 0.4072048
	speed: 0.0250s/iter; left time: 209.5348s
	iters: 900, epoch: 3 | loss: 0.3112204
	speed: 0.0247s/iter; left time: 204.5449s
	iters: 1000, epoch: 3 | loss: 0.2685199
	speed: 0.0245s/iter; left time: 200.7067s
	iters: 1100, epoch: 3 | loss: 0.4266738
	speed: 0.0247s/iter; left time: 199.4300s
Epoch: 3 cost time: 28.493680000305176
Epoch: 3, Steps: 1147 | Train Loss: 0.4589691 Vali Loss: 0.4342217 Test Loss: 0.1838342
Validation loss decreased (0.469038 --> 0.434222).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 1.2446016
	speed: 0.0299s/iter; left time: 237.4564s
	iters: 200, epoch: 4 | loss: 0.3745948
	speed: 0.0260s/iter; left time: 203.6275s
	iters: 300, epoch: 4 | loss: 0.3396802
	speed: 0.0247s/iter; left time: 190.7531s
	iters: 400, epoch: 4 | loss: 0.2917013
	speed: 0.0239s/iter; left time: 182.1966s
	iters: 500, epoch: 4 | loss: 0.3372562
	speed: 0.0240s/iter; left time: 180.6177s
	iters: 600, epoch: 4 | loss: 0.4208806
	speed: 0.0239s/iter; left time: 177.3133s
	iters: 700, epoch: 4 | loss: 0.2918798
	speed: 0.0236s/iter; left time: 173.2712s
	iters: 800, epoch: 4 | loss: 0.3035845
	speed: 0.0235s/iter; left time: 170.1484s
	iters: 900, epoch: 4 | loss: 0.3630036
	speed: 0.0235s/iter; left time: 167.8770s
	iters: 1000, epoch: 4 | loss: 0.3733217
	speed: 0.0239s/iter; left time: 167.8347s
	iters: 1100, epoch: 4 | loss: 0.3628339
	speed: 0.0242s/iter; left time: 167.8950s
Epoch: 4 cost time: 27.947054862976074
Epoch: 4, Steps: 1147 | Train Loss: 0.4463332 Vali Loss: 0.4333391 Test Loss: 0.1853241
Validation loss decreased (0.434222 --> 0.433339).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2996082
	speed: 0.0356s/iter; left time: 241.4557s
	iters: 200, epoch: 5 | loss: 0.4557367
	speed: 0.0286s/iter; left time: 191.3362s
	iters: 300, epoch: 5 | loss: 0.2445586
	speed: 0.0261s/iter; left time: 171.9530s
	iters: 400, epoch: 5 | loss: 0.3882826
	speed: 0.0256s/iter; left time: 165.8730s
	iters: 500, epoch: 5 | loss: 0.3165932
	speed: 0.0253s/iter; left time: 161.3260s
	iters: 600, epoch: 5 | loss: 0.4841149
	speed: 0.0246s/iter; left time: 154.7092s
	iters: 700, epoch: 5 | loss: 0.4966724
	speed: 0.0243s/iter; left time: 150.4498s
	iters: 800, epoch: 5 | loss: 1.2145534
	speed: 0.0239s/iter; left time: 145.1238s
	iters: 900, epoch: 5 | loss: 0.6490934
	speed: 0.0234s/iter; left time: 140.0093s
	iters: 1000, epoch: 5 | loss: 0.3672908
	speed: 0.0232s/iter; left time: 136.6530s
	iters: 1100, epoch: 5 | loss: 0.3357513
	speed: 0.0231s/iter; left time: 133.5955s
Epoch: 5 cost time: 26.563876390457153
Epoch: 5, Steps: 1147 | Train Loss: 0.4401206 Vali Loss: 0.4295939 Test Loss: 0.1843090
Validation loss decreased (0.433339 --> 0.429594).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6052247
	speed: 0.0310s/iter; left time: 174.6207s
	iters: 200, epoch: 6 | loss: 0.3346281
	speed: 0.0275s/iter; left time: 152.0174s
	iters: 300, epoch: 6 | loss: 0.3345223
	speed: 0.0258s/iter; left time: 140.3087s
	iters: 400, epoch: 6 | loss: 0.2546823
	speed: 0.0262s/iter; left time: 140.0432s
	iters: 500, epoch: 6 | loss: 0.4660249
	speed: 0.0266s/iter; left time: 139.2851s
	iters: 600, epoch: 6 | loss: 0.3322009
	speed: 0.0260s/iter; left time: 133.3022s
	iters: 700, epoch: 6 | loss: 0.2592148
	speed: 0.0252s/iter; left time: 127.0344s
	iters: 800, epoch: 6 | loss: 0.2245870
	speed: 0.0245s/iter; left time: 121.0176s
	iters: 900, epoch: 6 | loss: 0.3323384
	speed: 0.0239s/iter; left time: 115.7734s
	iters: 1000, epoch: 6 | loss: 0.6662493
	speed: 0.0238s/iter; left time: 112.9232s
	iters: 1100, epoch: 6 | loss: 0.2708956
	speed: 0.0237s/iter; left time: 110.0535s
Epoch: 6 cost time: 27.313218593597412
Epoch: 6, Steps: 1147 | Train Loss: 0.4361840 Vali Loss: 0.4301487 Test Loss: 0.1836935
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4097910
	speed: 0.0368s/iter; left time: 164.9809s
	iters: 200, epoch: 7 | loss: 0.3108531
	speed: 0.0296s/iter; left time: 129.9592s
	iters: 300, epoch: 7 | loss: 0.3948891
	speed: 0.0272s/iter; left time: 116.6515s
	iters: 400, epoch: 7 | loss: 0.4211975
	speed: 0.0257s/iter; left time: 107.4884s
	iters: 500, epoch: 7 | loss: 0.2554004
	speed: 0.0245s/iter; left time: 100.2414s
	iters: 600, epoch: 7 | loss: 1.2424158
	speed: 0.0239s/iter; left time: 95.2356s
	iters: 700, epoch: 7 | loss: 0.2614660
	speed: 0.0237s/iter; left time: 92.0643s
	iters: 800, epoch: 7 | loss: 0.3930455
	speed: 0.0235s/iter; left time: 89.0948s
	iters: 900, epoch: 7 | loss: 0.2428341
	speed: 0.0234s/iter; left time: 86.1593s
	iters: 1000, epoch: 7 | loss: 0.3867002
	speed: 0.0235s/iter; left time: 84.4755s
	iters: 1100, epoch: 7 | loss: 0.2292011
	speed: 0.0233s/iter; left time: 81.1553s
Epoch: 7 cost time: 26.481576442718506
Epoch: 7, Steps: 1147 | Train Loss: 0.4344049 Vali Loss: 0.4311604 Test Loss: 0.1842282
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2853611
	speed: 0.0415s/iter; left time: 138.6885s
	iters: 200, epoch: 8 | loss: 0.2365968
	speed: 0.0331s/iter; left time: 107.2349s
	iters: 300, epoch: 8 | loss: 0.5394906
	speed: 0.0297s/iter; left time: 93.1989s
	iters: 400, epoch: 8 | loss: 0.3228281
	speed: 0.0279s/iter; left time: 84.8811s
	iters: 500, epoch: 8 | loss: 0.3159493
	speed: 0.0270s/iter; left time: 79.4554s
	iters: 600, epoch: 8 | loss: 0.5933644
	speed: 0.0266s/iter; left time: 75.4834s
	iters: 700, epoch: 8 | loss: 0.3248047
	speed: 0.0262s/iter; left time: 71.9511s
	iters: 800, epoch: 8 | loss: 0.4231661
	speed: 0.0259s/iter; left time: 68.3713s
	iters: 900, epoch: 8 | loss: 0.3473693
	speed: 0.0253s/iter; left time: 64.2656s
	iters: 1000, epoch: 8 | loss: 1.2291960
	speed: 0.0249s/iter; left time: 60.7745s
	iters: 1100, epoch: 8 | loss: 0.4434894
	speed: 0.0243s/iter; left time: 56.9963s
Epoch: 8 cost time: 27.644776821136475
Epoch: 8, Steps: 1147 | Train Loss: 0.4333224 Vali Loss: 0.4308517 Test Loss: 0.1839249
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3404673
	speed: 0.0348s/iter; left time: 76.4875s
	iters: 200, epoch: 9 | loss: 0.3630902
	speed: 0.0289s/iter; left time: 60.4620s
	iters: 300, epoch: 9 | loss: 0.3723752
	speed: 0.0278s/iter; left time: 55.4611s
	iters: 400, epoch: 9 | loss: 0.4314917
	speed: 0.0255s/iter; left time: 48.2905s
	iters: 500, epoch: 9 | loss: 0.3605756
	speed: 0.0254s/iter; left time: 45.5753s
	iters: 600, epoch: 9 | loss: 0.2563723
	speed: 0.0246s/iter; left time: 41.6966s
	iters: 700, epoch: 9 | loss: 0.4177566
	speed: 0.0238s/iter; left time: 37.9112s
	iters: 800, epoch: 9 | loss: 0.3600713
	speed: 0.0227s/iter; left time: 33.8974s
	iters: 900, epoch: 9 | loss: 0.3382224
	speed: 0.0226s/iter; left time: 31.5245s
	iters: 1000, epoch: 9 | loss: 0.3118923
	speed: 0.0224s/iter; left time: 29.0517s
	iters: 1100, epoch: 9 | loss: 0.3296837
	speed: 0.0225s/iter; left time: 26.8303s
Epoch: 9 cost time: 25.742976188659668
Epoch: 9, Steps: 1147 | Train Loss: 0.4329026 Vali Loss: 0.4294097 Test Loss: 0.1831726
Validation loss decreased (0.429594 --> 0.429410).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3442760
	speed: 0.0374s/iter; left time: 39.1594s
	iters: 200, epoch: 10 | loss: 0.2552058
	speed: 0.0346s/iter; left time: 32.7611s
	iters: 300, epoch: 10 | loss: 0.9238210
	speed: 0.0319s/iter; left time: 27.0417s
	iters: 400, epoch: 10 | loss: 0.2788717
	speed: 0.0305s/iter; left time: 22.8019s
	iters: 500, epoch: 10 | loss: 0.2404757
	speed: 0.0289s/iter; left time: 18.7063s
	iters: 600, epoch: 10 | loss: 1.4466984
	speed: 0.0276s/iter; left time: 15.1039s
	iters: 700, epoch: 10 | loss: 0.4000014
	speed: 0.0262s/iter; left time: 11.7226s
	iters: 800, epoch: 10 | loss: 0.3210045
	speed: 0.0259s/iter; left time: 9.0228s
	iters: 900, epoch: 10 | loss: 0.4877383
	speed: 0.0253s/iter; left time: 6.2652s
	iters: 1000, epoch: 10 | loss: 1.2125516
	speed: 0.0249s/iter; left time: 3.6881s
	iters: 1100, epoch: 10 | loss: 0.5392422
	speed: 0.0246s/iter; left time: 1.1811s
Epoch: 10 cost time: 28.20873522758484
Epoch: 10, Steps: 1147 | Train Loss: 0.4325034 Vali Loss: 0.4308252 Test Loss: 0.1842062
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.18317261338233948, mae:0.2245020866394043
Use GPU: cuda:0
no_skip True
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 1.4067544
	speed: 0.0308s/iter; left time: 349.9809s
	iters: 200, epoch: 1 | loss: 0.4502827
	speed: 0.0259s/iter; left time: 292.0641s
	iters: 300, epoch: 1 | loss: 0.5231626
	speed: 0.0237s/iter; left time: 264.9418s
	iters: 400, epoch: 1 | loss: 0.3936684
	speed: 0.0222s/iter; left time: 245.5814s
	iters: 500, epoch: 1 | loss: 0.3565533
	speed: 0.0213s/iter; left time: 233.9571s
	iters: 600, epoch: 1 | loss: 0.5820495
	speed: 0.0225s/iter; left time: 244.7508s
	iters: 700, epoch: 1 | loss: 0.6357576
	speed: 0.0241s/iter; left time: 259.4188s
	iters: 800, epoch: 1 | loss: 0.3656339
	speed: 0.0245s/iter; left time: 261.3634s
	iters: 900, epoch: 1 | loss: 0.5110812
	speed: 0.0245s/iter; left time: 259.3259s
	iters: 1000, epoch: 1 | loss: 0.8633102
	speed: 0.0246s/iter; left time: 257.1240s
	iters: 1100, epoch: 1 | loss: 0.4336460
	speed: 0.0246s/iter; left time: 254.9453s
Epoch: 1 cost time: 28.314419269561768
Epoch: 1, Steps: 1147 | Train Loss: 0.5348515 Vali Loss: 0.4779894 Test Loss: 0.1917528
Validation loss decreased (inf --> 0.477989).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3044817
	speed: 0.0226s/iter; left time: 231.4846s
	iters: 200, epoch: 2 | loss: 0.3398016
	speed: 0.0174s/iter; left time: 176.5713s
	iters: 300, epoch: 2 | loss: 0.4016253
	speed: 0.0148s/iter; left time: 148.3443s
	iters: 400, epoch: 2 | loss: 1.7386214
	speed: 0.0151s/iter; left time: 149.3928s
	iters: 500, epoch: 2 | loss: 0.3928529
	speed: 0.0165s/iter; left time: 161.7764s
	iters: 600, epoch: 2 | loss: 0.4756996
	speed: 0.0196s/iter; left time: 190.3440s
	iters: 700, epoch: 2 | loss: 0.5116146
	speed: 0.0219s/iter; left time: 210.5066s
	iters: 800, epoch: 2 | loss: 1.1977935
	speed: 0.0229s/iter; left time: 218.0855s
	iters: 900, epoch: 2 | loss: 0.3534197
	speed: 0.0231s/iter; left time: 218.1390s
	iters: 1000, epoch: 2 | loss: 0.2865411
	speed: 0.0233s/iter; left time: 217.0772s
	iters: 1100, epoch: 2 | loss: 0.3587926
	speed: 0.0234s/iter; left time: 215.7960s
Epoch: 2 cost time: 26.990827083587646
Epoch: 2, Steps: 1147 | Train Loss: 0.4777864 Vali Loss: 0.4704817 Test Loss: 0.1933022
Validation loss decreased (0.477989 --> 0.470482).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3884649
	speed: 0.0252s/iter; left time: 229.0291s
	iters: 200, epoch: 3 | loss: 0.3393554
	speed: 0.0219s/iter; left time: 196.2646s
	iters: 300, epoch: 3 | loss: 0.3760479
	speed: 0.0220s/iter; left time: 195.3296s
	iters: 400, epoch: 3 | loss: 0.4096406
	speed: 0.0227s/iter; left time: 199.1272s
	iters: 500, epoch: 3 | loss: 0.3055725
	speed: 0.0223s/iter; left time: 193.1840s
	iters: 600, epoch: 3 | loss: 0.4452237
	speed: 0.0232s/iter; left time: 198.7495s
	iters: 700, epoch: 3 | loss: 0.6161507
	speed: 0.0238s/iter; left time: 201.8031s
	iters: 800, epoch: 3 | loss: 0.4561532
	speed: 0.0236s/iter; left time: 197.5312s
	iters: 900, epoch: 3 | loss: 0.4158664
	speed: 0.0236s/iter; left time: 194.9796s
	iters: 1000, epoch: 3 | loss: 0.3228455
	speed: 0.0237s/iter; left time: 194.0389s
	iters: 1100, epoch: 3 | loss: 0.2449856
	speed: 0.0239s/iter; left time: 193.1234s
Epoch: 3 cost time: 27.570918083190918
Epoch: 3, Steps: 1147 | Train Loss: 0.4545643 Vali Loss: 0.4385205 Test Loss: 0.1824510
Validation loss decreased (0.470482 --> 0.438520).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3334465
	speed: 0.0296s/iter; left time: 234.4990s
	iters: 200, epoch: 4 | loss: 1.2716460
	speed: 0.0246s/iter; left time: 192.7662s
	iters: 300, epoch: 4 | loss: 0.3961295
	speed: 0.0230s/iter; left time: 177.9743s
	iters: 400, epoch: 4 | loss: 0.3510757
	speed: 0.0220s/iter; left time: 167.9943s
	iters: 500, epoch: 4 | loss: 0.3867262
	speed: 0.0213s/iter; left time: 160.2578s
	iters: 600, epoch: 4 | loss: 1.3265321
	speed: 0.0210s/iter; left time: 156.1522s
	iters: 700, epoch: 4 | loss: 0.3243933
	speed: 0.0210s/iter; left time: 154.2907s
	iters: 800, epoch: 4 | loss: 0.3795807
	speed: 0.0211s/iter; left time: 152.2852s
	iters: 900, epoch: 4 | loss: 0.4021756
	speed: 0.0208s/iter; left time: 148.1340s
	iters: 1000, epoch: 4 | loss: 0.3040323
	speed: 0.0206s/iter; left time: 144.8231s
	iters: 1100, epoch: 4 | loss: 0.3473920
	speed: 0.0209s/iter; left time: 144.8147s
Epoch: 4 cost time: 24.266218185424805
Epoch: 4, Steps: 1147 | Train Loss: 0.4431602 Vali Loss: 0.4320838 Test Loss: 0.1827782
Validation loss decreased (0.438520 --> 0.432084).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3490552
	speed: 0.0312s/iter; left time: 211.7867s
	iters: 200, epoch: 5 | loss: 0.4303785
	speed: 0.0274s/iter; left time: 182.9303s
	iters: 300, epoch: 5 | loss: 0.3668368
	speed: 0.0245s/iter; left time: 161.0067s
	iters: 400, epoch: 5 | loss: 0.3674156
	speed: 0.0237s/iter; left time: 153.6479s
	iters: 500, epoch: 5 | loss: 0.2911495
	speed: 0.0229s/iter; left time: 146.1901s
	iters: 600, epoch: 5 | loss: 0.3186230
	speed: 0.0230s/iter; left time: 144.4922s
	iters: 700, epoch: 5 | loss: 1.2898115
	speed: 0.0236s/iter; left time: 145.6851s
	iters: 800, epoch: 5 | loss: 0.3502457
	speed: 0.0233s/iter; left time: 141.8446s
	iters: 900, epoch: 5 | loss: 0.2472815
	speed: 0.0235s/iter; left time: 140.5957s
	iters: 1000, epoch: 5 | loss: 0.3161695
	speed: 0.0236s/iter; left time: 138.9329s
	iters: 1100, epoch: 5 | loss: 0.3139198
	speed: 0.0237s/iter; left time: 137.1531s
Epoch: 5 cost time: 27.349853038787842
Epoch: 5, Steps: 1147 | Train Loss: 0.4354429 Vali Loss: 0.4283973 Test Loss: 0.1817057
Validation loss decreased (0.432084 --> 0.428397).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3172329
	speed: 0.0364s/iter; left time: 205.3379s
	iters: 200, epoch: 6 | loss: 0.2820031
	speed: 0.0327s/iter; left time: 180.7506s
	iters: 300, epoch: 6 | loss: 0.3044251
	speed: 0.0297s/iter; left time: 161.3687s
	iters: 400, epoch: 6 | loss: 0.2809208
	speed: 0.0281s/iter; left time: 149.7153s
	iters: 500, epoch: 6 | loss: 0.2935926
	speed: 0.0262s/iter; left time: 137.2799s
	iters: 600, epoch: 6 | loss: 0.3251477
	speed: 0.0250s/iter; left time: 128.1911s
	iters: 700, epoch: 6 | loss: 0.4415419
	speed: 0.0248s/iter; left time: 124.8070s
	iters: 800, epoch: 6 | loss: 0.3016228
	speed: 0.0245s/iter; left time: 120.9677s
	iters: 900, epoch: 6 | loss: 0.2817746
	speed: 0.0244s/iter; left time: 118.2309s
	iters: 1000, epoch: 6 | loss: 0.2646546
	speed: 0.0244s/iter; left time: 115.7612s
	iters: 1100, epoch: 6 | loss: 0.3169214
	speed: 0.0244s/iter; left time: 113.2371s
Epoch: 6 cost time: 28.140663862228394
Epoch: 6, Steps: 1147 | Train Loss: 0.4311088 Vali Loss: 0.4369686 Test Loss: 0.1832668
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3398964
	speed: 0.0258s/iter; left time: 115.6492s
	iters: 200, epoch: 7 | loss: 0.4128093
	speed: 0.0239s/iter; left time: 105.0820s
	iters: 300, epoch: 7 | loss: 0.2729837
	speed: 0.0233s/iter; left time: 99.9627s
	iters: 400, epoch: 7 | loss: 0.2506614
	speed: 0.0232s/iter; left time: 97.0640s
	iters: 500, epoch: 7 | loss: 0.3828653
	speed: 0.0230s/iter; left time: 93.9682s
	iters: 600, epoch: 7 | loss: 0.3029535
	speed: 0.0228s/iter; left time: 90.8224s
	iters: 700, epoch: 7 | loss: 0.3127548
	speed: 0.0226s/iter; left time: 87.7655s
	iters: 800, epoch: 7 | loss: 0.3879064
	speed: 0.0221s/iter; left time: 83.8391s
	iters: 900, epoch: 7 | loss: 0.2908681
	speed: 0.0219s/iter; left time: 80.9351s
	iters: 1000, epoch: 7 | loss: 1.2920470
	speed: 0.0220s/iter; left time: 78.8091s
	iters: 1100, epoch: 7 | loss: 0.4200337
	speed: 0.0220s/iter; left time: 76.6312s
Epoch: 7 cost time: 25.332457780838013
Epoch: 7, Steps: 1147 | Train Loss: 0.4289122 Vali Loss: 0.4346978 Test Loss: 0.1832732
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.5487653
	speed: 0.0238s/iter; left time: 79.5121s
	iters: 200, epoch: 8 | loss: 0.4143822
	speed: 0.0212s/iter; left time: 68.6549s
	iters: 300, epoch: 8 | loss: 0.2995658
	speed: 0.0201s/iter; left time: 63.2596s
	iters: 400, epoch: 8 | loss: 0.2833265
	speed: 0.0204s/iter; left time: 62.1567s
	iters: 500, epoch: 8 | loss: 0.5647334
	speed: 0.0220s/iter; left time: 64.8089s
	iters: 600, epoch: 8 | loss: 0.4883324
	speed: 0.0218s/iter; left time: 61.9905s
	iters: 700, epoch: 8 | loss: 0.3456923
	speed: 0.0222s/iter; left time: 60.8390s
	iters: 800, epoch: 8 | loss: 0.3004833
	speed: 0.0214s/iter; left time: 56.5238s
	iters: 900, epoch: 8 | loss: 0.2363708
	speed: 0.0213s/iter; left time: 54.0391s
	iters: 1000, epoch: 8 | loss: 0.2957566
	speed: 0.0211s/iter; left time: 51.5491s
	iters: 1100, epoch: 8 | loss: 0.3270252
	speed: 0.0209s/iter; left time: 49.0648s
Epoch: 8 cost time: 24.18468713760376
Epoch: 8, Steps: 1147 | Train Loss: 0.4277258 Vali Loss: 0.4323615 Test Loss: 0.1823016
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3252273
	speed: 0.0255s/iter; left time: 55.8637s
	iters: 200, epoch: 9 | loss: 0.4138887
	speed: 0.0245s/iter; left time: 51.4145s
	iters: 300, epoch: 9 | loss: 1.2893381
	speed: 0.0242s/iter; left time: 48.2820s
	iters: 400, epoch: 9 | loss: 0.3228694
	speed: 0.0241s/iter; left time: 45.5962s
	iters: 500, epoch: 9 | loss: 1.2627537
	speed: 0.0240s/iter; left time: 43.0058s
	iters: 600, epoch: 9 | loss: 0.2803486
	speed: 0.0239s/iter; left time: 40.5082s
	iters: 700, epoch: 9 | loss: 0.3999499
	speed: 0.0239s/iter; left time: 38.0422s
	iters: 800, epoch: 9 | loss: 1.3169022
	speed: 0.0238s/iter; left time: 35.5846s
	iters: 900, epoch: 9 | loss: 0.4641302
	speed: 0.0234s/iter; left time: 32.6112s
	iters: 1000, epoch: 9 | loss: 0.2644928
	speed: 0.0233s/iter; left time: 30.1509s
	iters: 1100, epoch: 9 | loss: 0.3796132
	speed: 0.0236s/iter; left time: 28.1940s
Epoch: 9 cost time: 27.273829460144043
Epoch: 9, Steps: 1147 | Train Loss: 0.4270424 Vali Loss: 0.4310455 Test Loss: 0.1822600
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3041926
	speed: 0.0225s/iter; left time: 23.5494s
	iters: 200, epoch: 10 | loss: 0.2667691
	speed: 0.0206s/iter; left time: 19.5228s
	iters: 300, epoch: 10 | loss: 0.4360956
	speed: 0.0198s/iter; left time: 16.7899s
	iters: 400, epoch: 10 | loss: 0.3755986
	speed: 0.0200s/iter; left time: 14.9239s
	iters: 500, epoch: 10 | loss: 0.4196656
	speed: 0.0207s/iter; left time: 13.3904s
	iters: 600, epoch: 10 | loss: 0.4323942
	speed: 0.0213s/iter; left time: 11.6813s
	iters: 700, epoch: 10 | loss: 0.3417224
	speed: 0.0218s/iter; left time: 9.7483s
	iters: 800, epoch: 10 | loss: 0.3908892
	speed: 0.0221s/iter; left time: 7.6978s
	iters: 900, epoch: 10 | loss: 1.0215358
	speed: 0.0223s/iter; left time: 5.5291s
	iters: 1000, epoch: 10 | loss: 0.2662784
	speed: 0.0230s/iter; left time: 3.4107s
	iters: 1100, epoch: 10 | loss: 0.3116908
	speed: 0.0242s/iter; left time: 1.1620s
Epoch: 10 cost time: 28.02441644668579
Epoch: 10, Steps: 1147 | Train Loss: 0.4271010 Vali Loss: 0.4321650 Test Loss: 0.1828108
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.18170574307441711, mae:0.2228160798549652
Seed: 42
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_192      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip True
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.4902397
	speed: 0.0446s/iter; left time: 506.3673s
	iters: 200, epoch: 1 | loss: 0.5129529
	speed: 0.0387s/iter; left time: 435.5340s
	iters: 300, epoch: 1 | loss: 0.4590000
	speed: 0.0354s/iter; left time: 394.7486s
	iters: 400, epoch: 1 | loss: 0.4507895
	speed: 0.0353s/iter; left time: 389.2308s
	iters: 500, epoch: 1 | loss: 0.5041514
	speed: 0.0345s/iter; left time: 376.9257s
	iters: 600, epoch: 1 | loss: 0.6025338
	speed: 0.0339s/iter; left time: 367.9871s
	iters: 700, epoch: 1 | loss: 0.6396382
	speed: 0.0322s/iter; left time: 346.2154s
	iters: 800, epoch: 1 | loss: 0.5915533
	speed: 0.0306s/iter; left time: 325.1898s
	iters: 900, epoch: 1 | loss: 0.6505101
	speed: 0.0296s/iter; left time: 311.6407s
	iters: 1000, epoch: 1 | loss: 0.7350392
	speed: 0.0289s/iter; left time: 301.3188s
	iters: 1100, epoch: 1 | loss: 0.4582476
	speed: 0.0283s/iter; left time: 292.4746s
Epoch: 1 cost time: 32.2025203704834
Epoch: 1, Steps: 1144 | Train Loss: 0.6047460 Vali Loss: 0.5563615 Test Loss: 0.2395893
Validation loss decreased (inf --> 0.556361).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9600077
	speed: 0.0254s/iter; left time: 259.3366s
	iters: 200, epoch: 2 | loss: 0.5426961
	speed: 0.0236s/iter; left time: 238.3929s
	iters: 300, epoch: 2 | loss: 0.4066209
	speed: 0.0231s/iter; left time: 231.2666s
	iters: 400, epoch: 2 | loss: 0.4518780
	speed: 0.0229s/iter; left time: 226.8582s
	iters: 500, epoch: 2 | loss: 0.5181378
	speed: 0.0232s/iter; left time: 226.9172s
	iters: 600, epoch: 2 | loss: 0.4075396
	speed: 0.0248s/iter; left time: 240.8501s
	iters: 700, epoch: 2 | loss: 0.4628758
	speed: 0.0258s/iter; left time: 247.6859s
	iters: 800, epoch: 2 | loss: 0.9523274
	speed: 0.0254s/iter; left time: 240.8414s
	iters: 900, epoch: 2 | loss: 0.5475575
	speed: 0.0257s/iter; left time: 241.3855s
	iters: 1000, epoch: 2 | loss: 0.4764743
	speed: 0.0251s/iter; left time: 233.5385s
	iters: 1100, epoch: 2 | loss: 0.4949415
	speed: 0.0249s/iter; left time: 228.5999s
Epoch: 2 cost time: 28.469804286956787
Epoch: 2, Steps: 1144 | Train Loss: 0.5506814 Vali Loss: 0.5304552 Test Loss: 0.2366110
Validation loss decreased (0.556361 --> 0.530455).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4353994
	speed: 0.0418s/iter; left time: 378.7355s
	iters: 200, epoch: 3 | loss: 0.4210856
	speed: 0.0361s/iter; left time: 323.2738s
	iters: 300, epoch: 3 | loss: 0.4184195
	speed: 0.0329s/iter; left time: 290.8514s
	iters: 400, epoch: 3 | loss: 0.2882938
	speed: 0.0303s/iter; left time: 265.3087s
	iters: 500, epoch: 3 | loss: 0.4197131
	speed: 0.0288s/iter; left time: 249.5162s
	iters: 600, epoch: 3 | loss: 0.5076672
	speed: 0.0269s/iter; left time: 230.3971s
	iters: 700, epoch: 3 | loss: 0.5283461
	speed: 0.0258s/iter; left time: 217.9822s
	iters: 800, epoch: 3 | loss: 0.4073365
	speed: 0.0248s/iter; left time: 207.3138s
	iters: 900, epoch: 3 | loss: 0.4026173
	speed: 0.0241s/iter; left time: 198.5778s
	iters: 1000, epoch: 3 | loss: 0.4653011
	speed: 0.0233s/iter; left time: 189.9565s
	iters: 1100, epoch: 3 | loss: 0.4285279
	speed: 0.0227s/iter; left time: 182.8999s
Epoch: 3 cost time: 25.86176061630249
Epoch: 3, Steps: 1144 | Train Loss: 0.5279983 Vali Loss: 0.5211983 Test Loss: 0.2315150
Validation loss decreased (0.530455 --> 0.521198).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4538846
	speed: 0.0455s/iter; left time: 359.6571s
	iters: 200, epoch: 4 | loss: 0.7012205
	speed: 0.0357s/iter; left time: 278.5134s
	iters: 300, epoch: 4 | loss: 0.5077705
	speed: 0.0306s/iter; left time: 235.8610s
	iters: 400, epoch: 4 | loss: 0.4403803
	speed: 0.0281s/iter; left time: 214.0111s
	iters: 500, epoch: 4 | loss: 0.4435699
	speed: 0.0271s/iter; left time: 203.2717s
	iters: 600, epoch: 4 | loss: 0.3610688
	speed: 0.0263s/iter; left time: 195.0008s
	iters: 700, epoch: 4 | loss: 0.4203313
	speed: 0.0258s/iter; left time: 188.8417s
	iters: 800, epoch: 4 | loss: 0.9213327
	speed: 0.0258s/iter; left time: 186.3123s
	iters: 900, epoch: 4 | loss: 0.3197831
	speed: 0.0260s/iter; left time: 184.9620s
	iters: 1000, epoch: 4 | loss: 0.4504579
	speed: 0.0262s/iter; left time: 183.8526s
	iters: 1100, epoch: 4 | loss: 0.4106866
	speed: 0.0256s/iter; left time: 177.0684s
Epoch: 4 cost time: 29.075020790100098
Epoch: 4, Steps: 1144 | Train Loss: 0.5175581 Vali Loss: 0.5247751 Test Loss: 0.2326170
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3431787
	speed: 0.0408s/iter; left time: 275.8331s
	iters: 200, epoch: 5 | loss: 0.5045388
	speed: 0.0383s/iter; left time: 255.4479s
	iters: 300, epoch: 5 | loss: 1.0284667
	speed: 0.0359s/iter; left time: 236.0060s
	iters: 400, epoch: 5 | loss: 0.6253364
	speed: 0.0326s/iter; left time: 210.8586s
	iters: 500, epoch: 5 | loss: 0.4854692
	speed: 0.0306s/iter; left time: 194.7908s
	iters: 600, epoch: 5 | loss: 0.4718141
	speed: 0.0289s/iter; left time: 181.1586s
	iters: 700, epoch: 5 | loss: 0.3882211
	speed: 0.0278s/iter; left time: 171.5164s
	iters: 800, epoch: 5 | loss: 0.3694638
	speed: 0.0272s/iter; left time: 164.7052s
	iters: 900, epoch: 5 | loss: 0.4638909
	speed: 0.0266s/iter; left time: 158.7445s
	iters: 1000, epoch: 5 | loss: 0.3836161
	speed: 0.0262s/iter; left time: 153.4183s
	iters: 1100, epoch: 5 | loss: 0.4847336
	speed: 0.0256s/iter; left time: 147.3450s
Epoch: 5 cost time: 29.174575328826904
Epoch: 5, Steps: 1144 | Train Loss: 0.5115070 Vali Loss: 0.5179247 Test Loss: 0.2306178
Validation loss decreased (0.521198 --> 0.517925).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5739061
	speed: 0.0441s/iter; left time: 248.1458s
	iters: 200, epoch: 6 | loss: 0.3456240
	speed: 0.0416s/iter; left time: 229.8287s
	iters: 300, epoch: 6 | loss: 0.5180249
	speed: 0.0404s/iter; left time: 218.9244s
	iters: 400, epoch: 6 | loss: 0.4133491
	speed: 0.0349s/iter; left time: 185.5165s
	iters: 500, epoch: 6 | loss: 0.3554518
	speed: 0.0313s/iter; left time: 163.3063s
	iters: 600, epoch: 6 | loss: 0.3192839
	speed: 0.0287s/iter; left time: 146.7743s
	iters: 700, epoch: 6 | loss: 0.3931747
	speed: 0.0266s/iter; left time: 133.5515s
	iters: 800, epoch: 6 | loss: 0.4784389
	speed: 0.0255s/iter; left time: 125.2480s
	iters: 900, epoch: 6 | loss: 0.4580480
	speed: 0.0245s/iter; left time: 117.9164s
	iters: 1000, epoch: 6 | loss: 0.4491332
	speed: 0.0237s/iter; left time: 111.8365s
	iters: 1100, epoch: 6 | loss: 0.5162005
	speed: 0.0229s/iter; left time: 105.8609s
Epoch: 6 cost time: 25.962040185928345
Epoch: 6, Steps: 1144 | Train Loss: 0.5077899 Vali Loss: 0.5100912 Test Loss: 0.2296996
Validation loss decreased (0.517925 --> 0.510091).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3263557
	speed: 0.0447s/iter; left time: 199.9548s
	iters: 200, epoch: 7 | loss: 0.5151042
	speed: 0.0432s/iter; left time: 188.9615s
	iters: 300, epoch: 7 | loss: 0.4797665
	speed: 0.0401s/iter; left time: 171.5089s
	iters: 400, epoch: 7 | loss: 0.4473621
	speed: 0.0379s/iter; left time: 158.4268s
	iters: 500, epoch: 7 | loss: 0.4256978
	speed: 0.0371s/iter; left time: 151.0800s
	iters: 600, epoch: 7 | loss: 0.4184520
	speed: 0.0366s/iter; left time: 145.6812s
	iters: 700, epoch: 7 | loss: 0.5166529
	speed: 0.0360s/iter; left time: 139.4600s
	iters: 800, epoch: 7 | loss: 0.4559467
	speed: 0.0355s/iter; left time: 134.1204s
	iters: 900, epoch: 7 | loss: 0.8767716
	speed: 0.0338s/iter; left time: 124.3756s
	iters: 1000, epoch: 7 | loss: 0.8525560
	speed: 0.0324s/iter; left time: 115.8785s
	iters: 1100, epoch: 7 | loss: 0.3539357
	speed: 0.0313s/iter; left time: 108.9373s
Epoch: 7 cost time: 35.54933547973633
Epoch: 7, Steps: 1144 | Train Loss: 0.5058610 Vali Loss: 0.5083671 Test Loss: 0.2297900
Validation loss decreased (0.510091 --> 0.508367).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3650157
	speed: 0.0314s/iter; left time: 104.5489s
	iters: 200, epoch: 8 | loss: 0.4489017
	speed: 0.0270s/iter; left time: 87.3661s
	iters: 300, epoch: 8 | loss: 0.4022287
	speed: 0.0256s/iter; left time: 80.2750s
	iters: 400, epoch: 8 | loss: 0.4878350
	speed: 0.0252s/iter; left time: 76.5800s
	iters: 500, epoch: 8 | loss: 0.9786725
	speed: 0.0251s/iter; left time: 73.6883s
	iters: 600, epoch: 8 | loss: 0.3866729
	speed: 0.0250s/iter; left time: 70.7956s
	iters: 700, epoch: 8 | loss: 0.4753289
	speed: 0.0245s/iter; left time: 66.9815s
	iters: 800, epoch: 8 | loss: 0.3891848
	speed: 0.0247s/iter; left time: 65.0884s
	iters: 900, epoch: 8 | loss: 0.5006270
	speed: 0.0253s/iter; left time: 64.0010s
	iters: 1000, epoch: 8 | loss: 0.4849290
	speed: 0.0249s/iter; left time: 60.5100s
	iters: 1100, epoch: 8 | loss: 0.4319777
	speed: 0.0246s/iter; left time: 57.3586s
Epoch: 8 cost time: 28.13494110107422
Epoch: 8, Steps: 1144 | Train Loss: 0.5052970 Vali Loss: 0.5077717 Test Loss: 0.2295893
Validation loss decreased (0.508367 --> 0.507772).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.8126231
	speed: 0.0278s/iter; left time: 60.8038s
	iters: 200, epoch: 9 | loss: 0.4216337
	speed: 0.0247s/iter; left time: 51.5410s
	iters: 300, epoch: 9 | loss: 0.3325302
	speed: 0.0245s/iter; left time: 48.7794s
	iters: 400, epoch: 9 | loss: 0.3772183
	speed: 0.0246s/iter; left time: 46.4003s
	iters: 500, epoch: 9 | loss: 0.2827214
	speed: 0.0246s/iter; left time: 44.0618s
	iters: 600, epoch: 9 | loss: 0.4442326
	speed: 0.0246s/iter; left time: 41.5584s
	iters: 700, epoch: 9 | loss: 0.4132381
	speed: 0.0241s/iter; left time: 38.2665s
	iters: 800, epoch: 9 | loss: 0.4008976
	speed: 0.0232s/iter; left time: 34.5857s
	iters: 900, epoch: 9 | loss: 0.4828403
	speed: 0.0225s/iter; left time: 31.2816s
	iters: 1000, epoch: 9 | loss: 0.9133366
	speed: 0.0216s/iter; left time: 27.8961s
	iters: 1100, epoch: 9 | loss: 0.3858777
	speed: 0.0210s/iter; left time: 24.9193s
Epoch: 9 cost time: 24.23019242286682
Epoch: 9, Steps: 1144 | Train Loss: 0.5045848 Vali Loss: 0.5058063 Test Loss: 0.2290044
Validation loss decreased (0.507772 --> 0.505806).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3944643
	speed: 0.0334s/iter; left time: 34.8695s
	iters: 200, epoch: 10 | loss: 0.5227994
	speed: 0.0296s/iter; left time: 27.9456s
	iters: 300, epoch: 10 | loss: 0.2951215
	speed: 0.0280s/iter; left time: 23.6644s
	iters: 400, epoch: 10 | loss: 0.4081757
	speed: 0.0273s/iter; left time: 20.3126s
	iters: 500, epoch: 10 | loss: 0.4570005
	speed: 0.0267s/iter; left time: 17.2233s
	iters: 600, epoch: 10 | loss: 0.3246765
	speed: 0.0263s/iter; left time: 14.3435s
	iters: 700, epoch: 10 | loss: 0.8549459
	speed: 0.0259s/iter; left time: 11.5097s
	iters: 800, epoch: 10 | loss: 0.4000165
	speed: 0.0255s/iter; left time: 8.8106s
	iters: 900, epoch: 10 | loss: 0.4261211
	speed: 0.0264s/iter; left time: 6.4602s
	iters: 1000, epoch: 10 | loss: 0.3214612
	speed: 0.0269s/iter; left time: 3.9025s
	iters: 1100, epoch: 10 | loss: 0.3434071
	speed: 0.0267s/iter; left time: 1.2025s
Epoch: 10 cost time: 30.583829879760742
Epoch: 10, Steps: 1144 | Train Loss: 0.5045089 Vali Loss: 0.5073851 Test Loss: 0.2294258
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.22900435328483582, mae:0.26317062973976135
Use GPU: cuda:0
no_skip True
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 1.4383936
	speed: 0.0260s/iter; left time: 295.1601s
	iters: 200, epoch: 1 | loss: 0.4379967
	speed: 0.0241s/iter; left time: 271.1555s
	iters: 300, epoch: 1 | loss: 0.5111588
	speed: 0.0233s/iter; left time: 259.2116s
	iters: 400, epoch: 1 | loss: 0.4417234
	speed: 0.0231s/iter; left time: 255.3706s
	iters: 500, epoch: 1 | loss: 0.5775719
	speed: 0.0233s/iter; left time: 255.2793s
	iters: 600, epoch: 1 | loss: 0.4720027
	speed: 0.0231s/iter; left time: 250.9550s
	iters: 700, epoch: 1 | loss: 0.9159302
	speed: 0.0232s/iter; left time: 248.7445s
	iters: 800, epoch: 1 | loss: 0.9706085
	speed: 0.0232s/iter; left time: 246.7412s
	iters: 900, epoch: 1 | loss: 0.4662073
	speed: 0.0232s/iter; left time: 244.4367s
	iters: 1000, epoch: 1 | loss: 0.4546469
	speed: 0.0236s/iter; left time: 246.6322s
	iters: 1100, epoch: 1 | loss: 0.6300822
	speed: 0.0240s/iter; left time: 248.0330s
Epoch: 1 cost time: 27.468052864074707
Epoch: 1, Steps: 1144 | Train Loss: 0.6043701 Vali Loss: 0.5651394 Test Loss: 0.2389363
Validation loss decreased (inf --> 0.565139).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4205866
	speed: 0.0289s/iter; left time: 295.0431s
	iters: 200, epoch: 2 | loss: 0.5800821
	speed: 0.0254s/iter; left time: 256.7495s
	iters: 300, epoch: 2 | loss: 0.8535023
	speed: 0.0244s/iter; left time: 244.1204s
	iters: 400, epoch: 2 | loss: 0.3627644
	speed: 0.0239s/iter; left time: 236.5916s
	iters: 500, epoch: 2 | loss: 0.4141343
	speed: 0.0237s/iter; left time: 231.7613s
	iters: 600, epoch: 2 | loss: 0.6210113
	speed: 0.0236s/iter; left time: 228.7263s
	iters: 700, epoch: 2 | loss: 0.5060776
	speed: 0.0240s/iter; left time: 229.9368s
	iters: 800, epoch: 2 | loss: 0.4476539
	speed: 0.0233s/iter; left time: 220.9440s
	iters: 900, epoch: 2 | loss: 0.5505811
	speed: 0.0226s/iter; left time: 212.2611s
	iters: 1000, epoch: 2 | loss: 0.4709305
	speed: 0.0220s/iter; left time: 204.9076s
	iters: 1100, epoch: 2 | loss: 0.4614474
	speed: 0.0216s/iter; left time: 198.6398s
Epoch: 2 cost time: 24.684263944625854
Epoch: 2, Steps: 1144 | Train Loss: 0.5500596 Vali Loss: 0.5343351 Test Loss: 0.2376952
Validation loss decreased (0.565139 --> 0.534335).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4119039
	speed: 0.0290s/iter; left time: 262.1152s
	iters: 200, epoch: 3 | loss: 0.4625179
	speed: 0.0266s/iter; left time: 237.8416s
	iters: 300, epoch: 3 | loss: 0.5584130
	speed: 0.0261s/iter; left time: 231.3851s
	iters: 400, epoch: 3 | loss: 0.4633490
	speed: 0.0273s/iter; left time: 238.5587s
	iters: 500, epoch: 3 | loss: 1.4278563
	speed: 0.0281s/iter; left time: 242.9194s
	iters: 600, epoch: 3 | loss: 0.4874010
	speed: 0.0273s/iter; left time: 233.6079s
	iters: 700, epoch: 3 | loss: 0.4797029
	speed: 0.0261s/iter; left time: 220.8486s
	iters: 800, epoch: 3 | loss: 0.3497904
	speed: 0.0257s/iter; left time: 214.4932s
	iters: 900, epoch: 3 | loss: 0.8584507
	speed: 0.0257s/iter; left time: 212.4289s
	iters: 1000, epoch: 3 | loss: 0.4350853
	speed: 0.0259s/iter; left time: 211.0242s
	iters: 1100, epoch: 3 | loss: 0.3681570
	speed: 0.0257s/iter; left time: 207.3574s
Epoch: 3 cost time: 29.538174152374268
Epoch: 3, Steps: 1144 | Train Loss: 0.5320854 Vali Loss: 0.5215861 Test Loss: 0.2352080
Validation loss decreased (0.534335 --> 0.521586).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4602919
	speed: 0.0430s/iter; left time: 340.1725s
	iters: 200, epoch: 4 | loss: 0.4484358
	speed: 0.0366s/iter; left time: 285.7249s
	iters: 300, epoch: 4 | loss: 0.3271446
	speed: 0.0361s/iter; left time: 277.9561s
	iters: 400, epoch: 4 | loss: 0.4412832
	speed: 0.0344s/iter; left time: 261.7296s
	iters: 500, epoch: 4 | loss: 0.4578818
	speed: 0.0313s/iter; left time: 235.0984s
	iters: 600, epoch: 4 | loss: 0.9192705
	speed: 0.0296s/iter; left time: 219.2631s
	iters: 700, epoch: 4 | loss: 0.4523063
	speed: 0.0285s/iter; left time: 208.3449s
	iters: 800, epoch: 4 | loss: 0.3713599
	speed: 0.0277s/iter; left time: 199.4315s
	iters: 900, epoch: 4 | loss: 0.5029911
	speed: 0.0281s/iter; left time: 199.5126s
	iters: 1000, epoch: 4 | loss: 0.8734272
	speed: 0.0285s/iter; left time: 199.9587s
	iters: 1100, epoch: 4 | loss: 0.4657824
	speed: 0.0281s/iter; left time: 194.1501s
Epoch: 4 cost time: 32.042882680892944
Epoch: 4, Steps: 1144 | Train Loss: 0.5205919 Vali Loss: 0.5182130 Test Loss: 0.2341912
Validation loss decreased (0.521586 --> 0.518213).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6144342
	speed: 0.0293s/iter; left time: 198.2226s
	iters: 200, epoch: 5 | loss: 0.4166553
	speed: 0.0269s/iter; left time: 179.0340s
	iters: 300, epoch: 5 | loss: 0.3992144
	speed: 0.0261s/iter; left time: 171.0615s
	iters: 400, epoch: 5 | loss: 0.4040416
	speed: 0.0273s/iter; left time: 176.8141s
	iters: 500, epoch: 5 | loss: 0.4528876
	speed: 0.0263s/iter; left time: 167.5555s
	iters: 600, epoch: 5 | loss: 0.3098828
	speed: 0.0254s/iter; left time: 159.0222s
	iters: 700, epoch: 5 | loss: 0.3679711
	speed: 0.0248s/iter; left time: 152.9040s
	iters: 800, epoch: 5 | loss: 0.4365617
	speed: 0.0250s/iter; left time: 151.4498s
	iters: 900, epoch: 5 | loss: 0.4001373
	speed: 0.0251s/iter; left time: 149.5692s
	iters: 1000, epoch: 5 | loss: 0.4257832
	speed: 0.0241s/iter; left time: 141.3455s
	iters: 1100, epoch: 5 | loss: 0.8664888
	speed: 0.0238s/iter; left time: 137.1691s
Epoch: 5 cost time: 27.618557453155518
Epoch: 5, Steps: 1144 | Train Loss: 0.5139319 Vali Loss: 0.5098379 Test Loss: 0.2312776
Validation loss decreased (0.518213 --> 0.509838).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8604357
	speed: 0.0351s/iter; left time: 197.0809s
	iters: 200, epoch: 6 | loss: 0.6920915
	speed: 0.0286s/iter; left time: 157.8621s
	iters: 300, epoch: 6 | loss: 0.3271683
	speed: 0.0267s/iter; left time: 144.9799s
	iters: 400, epoch: 6 | loss: 0.4754486
	speed: 0.0278s/iter; left time: 147.8430s
	iters: 500, epoch: 6 | loss: 0.4886985
	speed: 0.0283s/iter; left time: 147.9540s
	iters: 600, epoch: 6 | loss: 0.3334052
	speed: 0.0272s/iter; left time: 139.3959s
	iters: 700, epoch: 6 | loss: 0.4561923
	speed: 0.0265s/iter; left time: 133.1194s
	iters: 800, epoch: 6 | loss: 0.7999564
	speed: 0.0260s/iter; left time: 127.8120s
	iters: 900, epoch: 6 | loss: 1.1141458
	speed: 0.0256s/iter; left time: 123.1878s
	iters: 1000, epoch: 6 | loss: 0.3763014
	speed: 0.0252s/iter; left time: 118.8501s
	iters: 1100, epoch: 6 | loss: 0.4327306
	speed: 0.0255s/iter; left time: 117.9770s
Epoch: 6 cost time: 29.42674231529236
Epoch: 6, Steps: 1144 | Train Loss: 0.5101147 Vali Loss: 0.5052130 Test Loss: 0.2300111
Validation loss decreased (0.509838 --> 0.505213).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.7484588
	speed: 0.0257s/iter; left time: 115.0789s
	iters: 200, epoch: 7 | loss: 0.3555548
	speed: 0.0241s/iter; left time: 105.4975s
	iters: 300, epoch: 7 | loss: 0.4329058
	speed: 0.0225s/iter; left time: 96.3086s
	iters: 400, epoch: 7 | loss: 0.3553967
	speed: 0.0247s/iter; left time: 103.3372s
	iters: 500, epoch: 7 | loss: 0.5050828
	speed: 0.0244s/iter; left time: 99.3503s
	iters: 600, epoch: 7 | loss: 0.4752825
	speed: 0.0242s/iter; left time: 96.3122s
	iters: 700, epoch: 7 | loss: 0.4001952
	speed: 0.0258s/iter; left time: 99.8955s
	iters: 800, epoch: 7 | loss: 0.4732972
	speed: 0.0265s/iter; left time: 100.1121s
	iters: 900, epoch: 7 | loss: 0.7988649
	speed: 0.0257s/iter; left time: 94.3194s
	iters: 1000, epoch: 7 | loss: 0.5124027
	speed: 0.0250s/iter; left time: 89.3117s
	iters: 1100, epoch: 7 | loss: 0.4783186
	speed: 0.0244s/iter; left time: 84.9777s
Epoch: 7 cost time: 27.824007987976074
Epoch: 7, Steps: 1144 | Train Loss: 0.5084004 Vali Loss: 0.5051131 Test Loss: 0.2296817
Validation loss decreased (0.505213 --> 0.505113).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.8289852
	speed: 0.0267s/iter; left time: 88.8689s
	iters: 200, epoch: 8 | loss: 0.3713354
	speed: 0.0241s/iter; left time: 78.0544s
	iters: 300, epoch: 8 | loss: 0.5674018
	speed: 0.0234s/iter; left time: 73.1593s
	iters: 400, epoch: 8 | loss: 0.6795332
	speed: 0.0233s/iter; left time: 70.6343s
	iters: 500, epoch: 8 | loss: 0.9364729
	speed: 0.0234s/iter; left time: 68.7124s
	iters: 600, epoch: 8 | loss: 0.5573663
	speed: 0.0235s/iter; left time: 66.6300s
	iters: 700, epoch: 8 | loss: 0.4282153
	speed: 0.0236s/iter; left time: 64.4262s
	iters: 800, epoch: 8 | loss: 0.3520764
	speed: 0.0237s/iter; left time: 62.3259s
	iters: 900, epoch: 8 | loss: 0.9946980
	speed: 0.0233s/iter; left time: 58.9775s
	iters: 1000, epoch: 8 | loss: 0.3980027
	speed: 0.0227s/iter; left time: 55.2858s
	iters: 1100, epoch: 8 | loss: 0.4186752
	speed: 0.0222s/iter; left time: 51.7951s
Epoch: 8 cost time: 25.450303316116333
Epoch: 8, Steps: 1144 | Train Loss: 0.5070651 Vali Loss: 0.5036911 Test Loss: 0.2295947
Validation loss decreased (0.505113 --> 0.503691).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4372417
	speed: 0.0381s/iter; left time: 83.4801s
	iters: 200, epoch: 9 | loss: 0.6063023
	speed: 0.0300s/iter; left time: 62.6650s
	iters: 300, epoch: 9 | loss: 0.3191270
	speed: 0.0285s/iter; left time: 56.7223s
	iters: 400, epoch: 9 | loss: 0.9349405
	speed: 0.0290s/iter; left time: 54.8638s
	iters: 500, epoch: 9 | loss: 0.3671192
	speed: 0.0296s/iter; left time: 52.8804s
	iters: 600, epoch: 9 | loss: 0.4354274
	speed: 0.0286s/iter; left time: 48.3598s
	iters: 700, epoch: 9 | loss: 0.4926816
	speed: 0.0280s/iter; left time: 44.5437s
	iters: 800, epoch: 9 | loss: 1.0344547
	speed: 0.0275s/iter; left time: 40.9123s
	iters: 900, epoch: 9 | loss: 0.8435206
	speed: 0.0279s/iter; left time: 38.6848s
	iters: 1000, epoch: 9 | loss: 0.3718117
	speed: 0.0272s/iter; left time: 35.1029s
	iters: 1100, epoch: 9 | loss: 0.3726783
	speed: 0.0265s/iter; left time: 31.5179s
Epoch: 9 cost time: 30.257201671600342
Epoch: 9, Steps: 1144 | Train Loss: 0.5064952 Vali Loss: 0.5047903 Test Loss: 0.2300624
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 1.3860115
	speed: 0.0378s/iter; left time: 39.4766s
	iters: 200, epoch: 10 | loss: 0.4537573
	speed: 0.0312s/iter; left time: 29.4654s
	iters: 300, epoch: 10 | loss: 0.4677722
	speed: 0.0284s/iter; left time: 23.9628s
	iters: 400, epoch: 10 | loss: 0.3805282
	speed: 0.0269s/iter; left time: 20.0508s
	iters: 500, epoch: 10 | loss: 0.9250757
	speed: 0.0261s/iter; left time: 16.8424s
	iters: 600, epoch: 10 | loss: 0.3040397
	speed: 0.0255s/iter; left time: 13.9084s
	iters: 700, epoch: 10 | loss: 0.4410673
	speed: 0.0251s/iter; left time: 11.1622s
	iters: 800, epoch: 10 | loss: 0.4055644
	speed: 0.0246s/iter; left time: 8.5002s
	iters: 900, epoch: 10 | loss: 0.4313247
	speed: 0.0244s/iter; left time: 5.9731s
	iters: 1000, epoch: 10 | loss: 0.5139331
	speed: 0.0242s/iter; left time: 3.5074s
	iters: 1100, epoch: 10 | loss: 0.5540763
	speed: 0.0243s/iter; left time: 1.0918s
Epoch: 10 cost time: 27.694546699523926
Epoch: 10, Steps: 1144 | Train Loss: 0.5061275 Vali Loss: 0.5049009 Test Loss: 0.2298295
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.2295946478843689, mae:0.26253679394721985
Use GPU: cuda:0
no_skip True
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.4935422
	speed: 0.0417s/iter; left time: 472.5010s
	iters: 200, epoch: 1 | loss: 0.6344926
	speed: 0.0414s/iter; left time: 465.5996s
	iters: 300, epoch: 1 | loss: 1.5884541
	speed: 0.0380s/iter; left time: 423.2231s
	iters: 400, epoch: 1 | loss: 0.5752123
	speed: 0.0329s/iter; left time: 363.1834s
	iters: 500, epoch: 1 | loss: 0.5611739
	speed: 0.0299s/iter; left time: 326.8760s
	iters: 600, epoch: 1 | loss: 0.6007973
	speed: 0.0273s/iter; left time: 295.4480s
	iters: 700, epoch: 1 | loss: 0.4188997
	speed: 0.0251s/iter; left time: 269.7316s
	iters: 800, epoch: 1 | loss: 0.5071488
	speed: 0.0237s/iter; left time: 252.4841s
	iters: 900, epoch: 1 | loss: 0.4880185
	speed: 0.0233s/iter; left time: 245.4435s
	iters: 1000, epoch: 1 | loss: 0.4003598
	speed: 0.0229s/iter; left time: 239.1082s
	iters: 1100, epoch: 1 | loss: 0.5794947
	speed: 0.0228s/iter; left time: 236.0605s
Epoch: 1 cost time: 26.324645519256592
Epoch: 1, Steps: 1144 | Train Loss: 0.6192039 Vali Loss: 0.5791129 Test Loss: 0.2439175
Validation loss decreased (inf --> 0.579113).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8531768
	speed: 0.0412s/iter; left time: 420.6138s
	iters: 200, epoch: 2 | loss: 0.5016001
	speed: 0.0384s/iter; left time: 387.3401s
	iters: 300, epoch: 2 | loss: 0.5099868
	speed: 0.0334s/iter; left time: 333.7192s
	iters: 400, epoch: 2 | loss: 0.4194033
	speed: 0.0308s/iter; left time: 304.3427s
	iters: 500, epoch: 2 | loss: 0.8990990
	speed: 0.0298s/iter; left time: 291.6576s
	iters: 600, epoch: 2 | loss: 0.6262992
	speed: 0.0291s/iter; left time: 281.9178s
	iters: 700, epoch: 2 | loss: 0.4934359
	speed: 0.0279s/iter; left time: 267.5737s
	iters: 800, epoch: 2 | loss: 0.4387162
	speed: 0.0268s/iter; left time: 254.6035s
	iters: 900, epoch: 2 | loss: 0.5998740
	speed: 0.0262s/iter; left time: 246.2921s
	iters: 1000, epoch: 2 | loss: 1.0155995
	speed: 0.0259s/iter; left time: 240.8781s
	iters: 1100, epoch: 2 | loss: 0.5987898
	speed: 0.0258s/iter; left time: 236.9966s
Epoch: 2 cost time: 29.572598934173584
Epoch: 2, Steps: 1144 | Train Loss: 0.5564179 Vali Loss: 0.5442411 Test Loss: 0.2348618
Validation loss decreased (0.579113 --> 0.544241).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4371844
	speed: 0.0395s/iter; left time: 357.3271s
	iters: 200, epoch: 3 | loss: 0.5465164
	speed: 0.0381s/iter; left time: 341.1265s
	iters: 300, epoch: 3 | loss: 0.5422957
	speed: 0.0332s/iter; left time: 293.6609s
	iters: 400, epoch: 3 | loss: 0.5410955
	speed: 0.0301s/iter; left time: 263.8722s
	iters: 500, epoch: 3 | loss: 0.3420857
	speed: 0.0274s/iter; left time: 237.0555s
	iters: 600, epoch: 3 | loss: 0.4598093
	speed: 0.0255s/iter; left time: 218.1241s
	iters: 700, epoch: 3 | loss: 0.3862728
	speed: 0.0243s/iter; left time: 205.6700s
	iters: 800, epoch: 3 | loss: 0.8798234
	speed: 0.0239s/iter; left time: 199.8901s
	iters: 900, epoch: 3 | loss: 0.3826502
	speed: 0.0241s/iter; left time: 198.6204s
	iters: 1000, epoch: 3 | loss: 0.9531850
	speed: 0.0241s/iter; left time: 196.8356s
	iters: 1100, epoch: 3 | loss: 0.8388349
	speed: 0.0242s/iter; left time: 194.7036s
Epoch: 3 cost time: 27.800748825073242
Epoch: 3, Steps: 1144 | Train Loss: 0.5348859 Vali Loss: 0.5220292 Test Loss: 0.2316766
Validation loss decreased (0.544241 --> 0.522029).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6223032
	speed: 0.0350s/iter; left time: 276.5981s
	iters: 200, epoch: 4 | loss: 0.3697255
	speed: 0.0259s/iter; left time: 202.5510s
	iters: 300, epoch: 4 | loss: 0.4453154
	speed: 0.0227s/iter; left time: 174.9812s
	iters: 400, epoch: 4 | loss: 0.4118608
	speed: 0.0198s/iter; left time: 150.4814s
	iters: 500, epoch: 4 | loss: 0.3561434
	speed: 0.0180s/iter; left time: 135.3043s
	iters: 600, epoch: 4 | loss: 0.5106733
	speed: 0.0167s/iter; left time: 123.6223s
	iters: 700, epoch: 4 | loss: 0.3669851
	speed: 0.0171s/iter; left time: 124.9729s
	iters: 800, epoch: 4 | loss: 0.5823200
	speed: 0.0172s/iter; left time: 123.9078s
	iters: 900, epoch: 4 | loss: 0.4586219
	speed: 0.0180s/iter; left time: 127.6667s
	iters: 1000, epoch: 4 | loss: 0.4211884
	speed: 0.0189s/iter; left time: 132.7106s
	iters: 1100, epoch: 4 | loss: 0.4469004
	speed: 0.0190s/iter; left time: 131.1262s
Epoch: 4 cost time: 21.824870109558105
Epoch: 4, Steps: 1144 | Train Loss: 0.5228493 Vali Loss: 0.5234328 Test Loss: 0.2314385
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4880958
	speed: 0.0282s/iter; left time: 191.0779s
	iters: 200, epoch: 5 | loss: 0.9265203
	speed: 0.0266s/iter; left time: 177.4407s
	iters: 300, epoch: 5 | loss: 0.4551357
	speed: 0.0257s/iter; left time: 168.7112s
	iters: 400, epoch: 5 | loss: 0.4325514
	speed: 0.0239s/iter; left time: 154.7062s
	iters: 500, epoch: 5 | loss: 0.6073191
	speed: 0.0223s/iter; left time: 142.0234s
	iters: 600, epoch: 5 | loss: 0.3661709
	speed: 0.0216s/iter; left time: 135.5041s
	iters: 700, epoch: 5 | loss: 0.3418118
	speed: 0.0208s/iter; left time: 128.5318s
	iters: 800, epoch: 5 | loss: 0.4240212
	speed: 0.0207s/iter; left time: 125.3532s
	iters: 900, epoch: 5 | loss: 0.4671944
	speed: 0.0220s/iter; left time: 131.4541s
	iters: 1000, epoch: 5 | loss: 0.3366060
	speed: 0.0224s/iter; left time: 131.6632s
	iters: 1100, epoch: 5 | loss: 0.3594491
	speed: 0.0230s/iter; left time: 132.5392s
Epoch: 5 cost time: 26.372974634170532
Epoch: 5, Steps: 1144 | Train Loss: 0.5167181 Vali Loss: 0.5164023 Test Loss: 0.2292316
Validation loss decreased (0.522029 --> 0.516402).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8962467
	speed: 0.0427s/iter; left time: 240.1612s
	iters: 200, epoch: 6 | loss: 0.4114178
	speed: 0.0425s/iter; left time: 234.9146s
	iters: 300, epoch: 6 | loss: 0.9241114
	speed: 0.0361s/iter; left time: 195.9467s
	iters: 400, epoch: 6 | loss: 0.4744952
	speed: 0.0320s/iter; left time: 170.0824s
	iters: 500, epoch: 6 | loss: 0.4822150
	speed: 0.0294s/iter; left time: 153.4803s
	iters: 600, epoch: 6 | loss: 0.8930947
	speed: 0.0277s/iter; left time: 141.9005s
	iters: 700, epoch: 6 | loss: 0.3769763
	speed: 0.0274s/iter; left time: 137.6491s
	iters: 800, epoch: 6 | loss: 0.4286092
	speed: 0.0283s/iter; left time: 139.4623s
	iters: 900, epoch: 6 | loss: 1.1042926
	speed: 0.0288s/iter; left time: 139.0051s
	iters: 1000, epoch: 6 | loss: 0.4091204
	speed: 0.0288s/iter; left time: 136.1838s
	iters: 1100, epoch: 6 | loss: 0.3862935
	speed: 0.0282s/iter; left time: 130.5383s
Epoch: 6 cost time: 32.183056354522705
Epoch: 6, Steps: 1144 | Train Loss: 0.5136497 Vali Loss: 0.5166259 Test Loss: 0.2300682
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3896561
	speed: 0.0409s/iter; left time: 183.0223s
	iters: 200, epoch: 7 | loss: 0.4204624
	speed: 0.0307s/iter; left time: 134.3385s
	iters: 300, epoch: 7 | loss: 0.8233591
	speed: 0.0276s/iter; left time: 118.1947s
	iters: 400, epoch: 7 | loss: 0.2745512
	speed: 0.0257s/iter; left time: 107.4685s
	iters: 500, epoch: 7 | loss: 0.5712799
	speed: 0.0247s/iter; left time: 100.5852s
	iters: 600, epoch: 7 | loss: 0.5385020
	speed: 0.0246s/iter; left time: 97.6871s
	iters: 700, epoch: 7 | loss: 0.4038432
	speed: 0.0244s/iter; left time: 94.5323s
	iters: 800, epoch: 7 | loss: 0.4058234
	speed: 0.0239s/iter; left time: 90.2503s
	iters: 900, epoch: 7 | loss: 0.3360516
	speed: 0.0235s/iter; left time: 86.5622s
	iters: 1000, epoch: 7 | loss: 0.6798911
	speed: 0.0235s/iter; left time: 84.0415s
	iters: 1100, epoch: 7 | loss: 0.5327970
	speed: 0.0232s/iter; left time: 80.6941s
Epoch: 7 cost time: 26.544315099716187
Epoch: 7, Steps: 1144 | Train Loss: 0.5121676 Vali Loss: 0.5156943 Test Loss: 0.2297871
Validation loss decreased (0.516402 --> 0.515694).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4093114
	speed: 0.0376s/iter; left time: 125.1607s
	iters: 200, epoch: 8 | loss: 0.3800961
	speed: 0.0299s/iter; left time: 96.5395s
	iters: 300, epoch: 8 | loss: 0.9498650
	speed: 0.0273s/iter; left time: 85.5224s
	iters: 400, epoch: 8 | loss: 0.4810431
	speed: 0.0269s/iter; left time: 81.4788s
	iters: 500, epoch: 8 | loss: 0.4276348
	speed: 0.0280s/iter; left time: 82.0065s
	iters: 600, epoch: 8 | loss: 0.3500284
	speed: 0.0283s/iter; left time: 80.2425s
	iters: 700, epoch: 8 | loss: 0.4448015
	speed: 0.0289s/iter; left time: 79.0017s
	iters: 800, epoch: 8 | loss: 0.9697459
	speed: 0.0289s/iter; left time: 76.1200s
	iters: 900, epoch: 8 | loss: 0.3982602
	speed: 0.0283s/iter; left time: 71.8031s
	iters: 1000, epoch: 8 | loss: 0.9500841
	speed: 0.0279s/iter; left time: 67.9875s
	iters: 1100, epoch: 8 | loss: 0.8615749
	speed: 0.0276s/iter; left time: 64.3660s
Epoch: 8 cost time: 31.539363145828247
Epoch: 8, Steps: 1144 | Train Loss: 0.5112403 Vali Loss: 0.5131989 Test Loss: 0.2295630
Validation loss decreased (0.515694 --> 0.513199).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4889441
	speed: 0.0287s/iter; left time: 62.8945s
	iters: 200, epoch: 9 | loss: 0.3705809
	speed: 0.0250s/iter; left time: 52.2771s
	iters: 300, epoch: 9 | loss: 0.4585063
	speed: 0.0233s/iter; left time: 46.3522s
	iters: 400, epoch: 9 | loss: 0.4560039
	speed: 0.0224s/iter; left time: 42.3576s
	iters: 500, epoch: 9 | loss: 1.0454257
	speed: 0.0227s/iter; left time: 40.6700s
	iters: 600, epoch: 9 | loss: 0.4522383
	speed: 0.0229s/iter; left time: 38.7013s
	iters: 700, epoch: 9 | loss: 0.8466946
	speed: 0.0230s/iter; left time: 36.6232s
	iters: 800, epoch: 9 | loss: 0.3836464
	speed: 0.0231s/iter; left time: 34.3630s
	iters: 900, epoch: 9 | loss: 0.4114418
	speed: 0.0230s/iter; left time: 32.0126s
	iters: 1000, epoch: 9 | loss: 0.3927839
	speed: 0.0231s/iter; left time: 29.7161s
	iters: 1100, epoch: 9 | loss: 0.8536046
	speed: 0.0230s/iter; left time: 27.3233s
Epoch: 9 cost time: 26.398133516311646
Epoch: 9, Steps: 1144 | Train Loss: 0.5110089 Vali Loss: 0.5113680 Test Loss: 0.2289829
Validation loss decreased (0.513199 --> 0.511368).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.4614617
	speed: 0.0429s/iter; left time: 44.8733s
	iters: 200, epoch: 10 | loss: 0.4318800
	speed: 0.0334s/iter; left time: 31.5267s
	iters: 300, epoch: 10 | loss: 0.4534911
	speed: 0.0318s/iter; left time: 26.8356s
	iters: 400, epoch: 10 | loss: 0.2854310
	speed: 0.0287s/iter; left time: 21.4048s
	iters: 500, epoch: 10 | loss: 0.4460404
	speed: 0.0284s/iter; left time: 18.3060s
	iters: 600, epoch: 10 | loss: 0.4548681
	speed: 0.0264s/iter; left time: 14.3880s
	iters: 700, epoch: 10 | loss: 1.1693242
	speed: 0.0250s/iter; left time: 11.1113s
	iters: 800, epoch: 10 | loss: 0.9942840
	speed: 0.0232s/iter; left time: 7.9940s
	iters: 900, epoch: 10 | loss: 0.5637980
	speed: 0.0222s/iter; left time: 5.4394s
	iters: 1000, epoch: 10 | loss: 0.8413363
	speed: 0.0218s/iter; left time: 3.1647s
	iters: 1100, epoch: 10 | loss: 0.3309211
	speed: 0.0212s/iter; left time: 0.9540s
Epoch: 10 cost time: 24.389921188354492
Epoch: 10, Steps: 1144 | Train Loss: 0.5106288 Vali Loss: 0.5118010 Test Loss: 0.2291491
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.2289828509092331, mae:0.2625114619731903
Seed: 42
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_336      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip True
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.6161098
	speed: 0.0388s/iter; left time: 438.3753s
	iters: 200, epoch: 1 | loss: 0.6407111
	speed: 0.0306s/iter; left time: 342.8248s
	iters: 300, epoch: 1 | loss: 0.6075835
	speed: 0.0278s/iter; left time: 308.5425s
	iters: 400, epoch: 1 | loss: 0.4650640
	speed: 0.0262s/iter; left time: 288.4618s
	iters: 500, epoch: 1 | loss: 0.5150325
	speed: 0.0248s/iter; left time: 270.0501s
	iters: 600, epoch: 1 | loss: 0.5350881
	speed: 0.0244s/iter; left time: 263.2966s
	iters: 700, epoch: 1 | loss: 1.1433898
	speed: 0.0241s/iter; left time: 257.9799s
	iters: 800, epoch: 1 | loss: 0.8091800
	speed: 0.0239s/iter; left time: 253.4896s
	iters: 900, epoch: 1 | loss: 0.5056031
	speed: 0.0241s/iter; left time: 253.3115s
	iters: 1000, epoch: 1 | loss: 0.5161613
	speed: 0.0242s/iter; left time: 251.9882s
	iters: 1100, epoch: 1 | loss: 1.0899211
	speed: 0.0243s/iter; left time: 250.6743s
Epoch: 1 cost time: 28.16066598892212
Epoch: 1, Steps: 1140 | Train Loss: 0.6693125 Vali Loss: 0.6366249 Test Loss: 0.2913779
Validation loss decreased (inf --> 0.636625).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5931219
	speed: 0.0282s/iter; left time: 286.6340s
	iters: 200, epoch: 2 | loss: 0.6284329
	speed: 0.0285s/iter; left time: 286.9598s
	iters: 300, epoch: 2 | loss: 1.0040319
	speed: 0.0260s/iter; left time: 258.8152s
	iters: 400, epoch: 2 | loss: 0.4765599
	speed: 0.0251s/iter; left time: 247.7443s
	iters: 500, epoch: 2 | loss: 0.4932122
	speed: 0.0252s/iter; left time: 246.0623s
	iters: 600, epoch: 2 | loss: 0.5668757
	speed: 0.0252s/iter; left time: 243.6922s
	iters: 700, epoch: 2 | loss: 0.5503466
	speed: 0.0249s/iter; left time: 237.7249s
	iters: 800, epoch: 2 | loss: 0.5530049
	speed: 0.0245s/iter; left time: 231.9264s
	iters: 900, epoch: 2 | loss: 0.5115303
	speed: 0.0242s/iter; left time: 226.7596s
	iters: 1000, epoch: 2 | loss: 0.5200616
	speed: 0.0240s/iter; left time: 222.5106s
	iters: 1100, epoch: 2 | loss: 0.5328110
	speed: 0.0238s/iter; left time: 218.4771s
Epoch: 2 cost time: 27.24528431892395
Epoch: 2, Steps: 1140 | Train Loss: 0.6241147 Vali Loss: 0.6802873 Test Loss: 0.3004204
EarlyStopping counter: 1 out of 5
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4654504
	speed: 0.0241s/iter; left time: 217.0330s
	iters: 200, epoch: 3 | loss: 0.5096164
	speed: 0.0233s/iter; left time: 207.5653s
	iters: 300, epoch: 3 | loss: 0.5582837
	speed: 0.0230s/iter; left time: 203.1242s
	iters: 400, epoch: 3 | loss: 0.7724665
	speed: 0.0217s/iter; left time: 189.0737s
	iters: 500, epoch: 3 | loss: 0.4805045
	speed: 0.0209s/iter; left time: 180.3589s
	iters: 600, epoch: 3 | loss: 0.4075228
	speed: 0.0204s/iter; left time: 173.7294s
	iters: 700, epoch: 3 | loss: 0.5477549
	speed: 0.0199s/iter; left time: 167.9869s
	iters: 800, epoch: 3 | loss: 0.5798299
	speed: 0.0195s/iter; left time: 162.4988s
	iters: 900, epoch: 3 | loss: 0.4482681
	speed: 0.0197s/iter; left time: 161.7723s
	iters: 1000, epoch: 3 | loss: 0.7891044
	speed: 0.0200s/iter; left time: 162.2369s
	iters: 1100, epoch: 3 | loss: 0.6465132
	speed: 0.0204s/iter; left time: 163.4164s
Epoch: 3 cost time: 23.528220176696777
Epoch: 3, Steps: 1140 | Train Loss: 0.6092853 Vali Loss: 0.6148727 Test Loss: 0.2882112
Validation loss decreased (0.636625 --> 0.614873).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5059683
	speed: 0.0273s/iter; left time: 214.8828s
	iters: 200, epoch: 4 | loss: 0.4965805
	speed: 0.0243s/iter; left time: 189.3532s
	iters: 300, epoch: 4 | loss: 0.4664177
	speed: 0.0241s/iter; left time: 185.3541s
	iters: 400, epoch: 4 | loss: 0.5873219
	speed: 0.0242s/iter; left time: 183.0836s
	iters: 500, epoch: 4 | loss: 0.5022420
	speed: 0.0239s/iter; left time: 178.7193s
	iters: 600, epoch: 4 | loss: 0.4424200
	speed: 0.0237s/iter; left time: 174.9229s
	iters: 700, epoch: 4 | loss: 0.5687042
	speed: 0.0235s/iter; left time: 171.1529s
	iters: 800, epoch: 4 | loss: 0.7573991
	speed: 0.0233s/iter; left time: 167.4968s
	iters: 900, epoch: 4 | loss: 0.5913203
	speed: 0.0231s/iter; left time: 163.8695s
	iters: 1000, epoch: 4 | loss: 0.4951057
	speed: 0.0232s/iter; left time: 162.2169s
	iters: 1100, epoch: 4 | loss: 0.4806811
	speed: 0.0233s/iter; left time: 160.2645s
Epoch: 4 cost time: 26.690791130065918
Epoch: 4, Steps: 1140 | Train Loss: 0.5945063 Vali Loss: 0.6099740 Test Loss: 0.2861760
Validation loss decreased (0.614873 --> 0.609974).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4108199
	speed: 0.0269s/iter; left time: 181.2719s
	iters: 200, epoch: 5 | loss: 0.4159681
	speed: 0.0234s/iter; left time: 155.6274s
	iters: 300, epoch: 5 | loss: 0.4324196
	speed: 0.0223s/iter; left time: 145.8820s
	iters: 400, epoch: 5 | loss: 0.5146596
	speed: 0.0239s/iter; left time: 153.9643s
	iters: 500, epoch: 5 | loss: 0.5077285
	speed: 0.0253s/iter; left time: 160.2844s
	iters: 600, epoch: 5 | loss: 0.5165896
	speed: 0.0248s/iter; left time: 154.6735s
	iters: 700, epoch: 5 | loss: 0.4729106
	speed: 0.0254s/iter; left time: 155.8181s
	iters: 800, epoch: 5 | loss: 0.4824381
	speed: 0.0252s/iter; left time: 152.1715s
	iters: 900, epoch: 5 | loss: 0.4867500
	speed: 0.0248s/iter; left time: 147.6155s
	iters: 1000, epoch: 5 | loss: 1.0753698
	speed: 0.0246s/iter; left time: 143.9055s
	iters: 1100, epoch: 5 | loss: 0.4617760
	speed: 0.0245s/iter; left time: 140.3825s
Epoch: 5 cost time: 27.920652627944946
Epoch: 5, Steps: 1140 | Train Loss: 0.5889755 Vali Loss: 0.6077484 Test Loss: 0.2867788
Validation loss decreased (0.609974 --> 0.607748).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4763063
	speed: 0.0335s/iter; left time: 187.5851s
	iters: 200, epoch: 6 | loss: 0.7405235
	speed: 0.0266s/iter; left time: 146.2025s
	iters: 300, epoch: 6 | loss: 0.5860040
	speed: 0.0250s/iter; left time: 134.7988s
	iters: 400, epoch: 6 | loss: 0.4171664
	speed: 0.0243s/iter; left time: 128.9597s
	iters: 500, epoch: 6 | loss: 0.5155099
	speed: 0.0247s/iter; left time: 128.5808s
	iters: 600, epoch: 6 | loss: 0.4683345
	speed: 0.0245s/iter; left time: 125.2015s
	iters: 700, epoch: 6 | loss: 0.4034735
	speed: 0.0236s/iter; left time: 118.2612s
	iters: 800, epoch: 6 | loss: 0.7361066
	speed: 0.0229s/iter; left time: 112.2675s
	iters: 900, epoch: 6 | loss: 0.6961629
	speed: 0.0225s/iter; left time: 107.7993s
	iters: 1000, epoch: 6 | loss: 0.4898959
	speed: 0.0224s/iter; left time: 105.3727s
	iters: 1100, epoch: 6 | loss: 0.4744296
	speed: 0.0222s/iter; left time: 102.1669s
Epoch: 6 cost time: 25.302281618118286
Epoch: 6, Steps: 1140 | Train Loss: 0.5855247 Vali Loss: 0.6001031 Test Loss: 0.2845756
Validation loss decreased (0.607748 --> 0.600103).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.6716911
	speed: 0.0275s/iter; left time: 122.7919s
	iters: 200, epoch: 7 | loss: 0.4338796
	speed: 0.0248s/iter; left time: 107.9975s
	iters: 300, epoch: 7 | loss: 0.4399813
	speed: 0.0237s/iter; left time: 101.1967s
	iters: 400, epoch: 7 | loss: 0.4700480
	speed: 0.0234s/iter; left time: 97.1605s
	iters: 500, epoch: 7 | loss: 0.4323567
	speed: 0.0236s/iter; left time: 95.9974s
	iters: 600, epoch: 7 | loss: 0.4651588
	speed: 0.0238s/iter; left time: 94.3680s
	iters: 700, epoch: 7 | loss: 0.5086205
	speed: 0.0239s/iter; left time: 92.4065s
	iters: 800, epoch: 7 | loss: 0.4838165
	speed: 0.0240s/iter; left time: 90.4074s
	iters: 900, epoch: 7 | loss: 0.4483703
	speed: 0.0241s/iter; left time: 88.3079s
	iters: 1000, epoch: 7 | loss: 0.5087647
	speed: 0.0239s/iter; left time: 85.1401s
	iters: 1100, epoch: 7 | loss: 0.4811572
	speed: 0.0236s/iter; left time: 81.5076s
Epoch: 7 cost time: 26.802666664123535
Epoch: 7, Steps: 1140 | Train Loss: 0.5840472 Vali Loss: 0.5949497 Test Loss: 0.2835211
Validation loss decreased (0.600103 --> 0.594950).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.6897648
	speed: 0.0379s/iter; left time: 125.9112s
	iters: 200, epoch: 8 | loss: 0.5107053
	speed: 0.0361s/iter; left time: 116.2209s
	iters: 300, epoch: 8 | loss: 0.4143766
	speed: 0.0316s/iter; left time: 98.4861s
	iters: 400, epoch: 8 | loss: 0.7886842
	speed: 0.0291s/iter; left time: 87.8170s
	iters: 500, epoch: 8 | loss: 0.6315702
	speed: 0.0276s/iter; left time: 80.7635s
	iters: 600, epoch: 8 | loss: 0.6803684
	speed: 0.0267s/iter; left time: 75.4335s
	iters: 700, epoch: 8 | loss: 0.4440499
	speed: 0.0267s/iter; left time: 72.6278s
	iters: 800, epoch: 8 | loss: 0.5382295
	speed: 0.0276s/iter; left time: 72.3061s
	iters: 900, epoch: 8 | loss: 0.8328912
	speed: 0.0273s/iter; left time: 68.8127s
	iters: 1000, epoch: 8 | loss: 0.5809780
	speed: 0.0268s/iter; left time: 64.8183s
	iters: 1100, epoch: 8 | loss: 0.4492262
	speed: 0.0263s/iter; left time: 61.1479s
Epoch: 8 cost time: 30.060046434402466
Epoch: 8, Steps: 1140 | Train Loss: 0.5831510 Vali Loss: 0.5949616 Test Loss: 0.2835037
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4767573
	speed: 0.0270s/iter; left time: 58.8217s
	iters: 200, epoch: 9 | loss: 0.6923827
	speed: 0.0259s/iter; left time: 53.8884s
	iters: 300, epoch: 9 | loss: 0.7113268
	speed: 0.0255s/iter; left time: 50.5049s
	iters: 400, epoch: 9 | loss: 0.7292674
	speed: 0.0249s/iter; left time: 46.7959s
	iters: 500, epoch: 9 | loss: 0.7239228
	speed: 0.0236s/iter; left time: 41.9698s
	iters: 600, epoch: 9 | loss: 1.0617183
	speed: 0.0227s/iter; left time: 38.0839s
	iters: 700, epoch: 9 | loss: 0.4320467
	speed: 0.0219s/iter; left time: 34.6912s
	iters: 800, epoch: 9 | loss: 0.7491192
	speed: 0.0212s/iter; left time: 31.3547s
	iters: 900, epoch: 9 | loss: 0.7974743
	speed: 0.0222s/iter; left time: 30.6008s
	iters: 1000, epoch: 9 | loss: 0.8540270
	speed: 0.0226s/iter; left time: 29.0066s
	iters: 1100, epoch: 9 | loss: 0.7579061
	speed: 0.0223s/iter; left time: 26.3560s
Epoch: 9 cost time: 25.580644130706787
Epoch: 9, Steps: 1140 | Train Loss: 0.5827963 Vali Loss: 0.5969055 Test Loss: 0.2838101
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.4766725
	speed: 0.0377s/iter; left time: 39.2110s
	iters: 200, epoch: 10 | loss: 0.4825885
	speed: 0.0366s/iter; left time: 34.4271s
	iters: 300, epoch: 10 | loss: 0.5046770
	speed: 0.0341s/iter; left time: 28.6801s
	iters: 400, epoch: 10 | loss: 0.5359897
	speed: 0.0310s/iter; left time: 22.9874s
	iters: 500, epoch: 10 | loss: 0.5559391
	speed: 0.0291s/iter; left time: 18.6648s
	iters: 600, epoch: 10 | loss: 0.4725019
	speed: 0.0278s/iter; left time: 15.0402s
	iters: 700, epoch: 10 | loss: 0.4663800
	speed: 0.0271s/iter; left time: 11.9522s
	iters: 800, epoch: 10 | loss: 0.4745756
	speed: 0.0266s/iter; left time: 9.0671s
	iters: 900, epoch: 10 | loss: 0.3999721
	speed: 0.0261s/iter; left time: 6.2782s
	iters: 1000, epoch: 10 | loss: 0.5560380
	speed: 0.0258s/iter; left time: 3.6394s
	iters: 1100, epoch: 10 | loss: 0.4666498
	speed: 0.0255s/iter; left time: 1.0462s
Epoch: 10 cost time: 29.042368173599243
Epoch: 10, Steps: 1140 | Train Loss: 0.5822735 Vali Loss: 0.5998116 Test Loss: 0.2838795
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.28352126479148865, mae:0.30183252692222595
Use GPU: cuda:0
no_skip True
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 1.0622815
	speed: 0.0470s/iter; left time: 531.4909s
	iters: 200, epoch: 1 | loss: 0.8222315
	speed: 0.0365s/iter; left time: 408.5615s
	iters: 300, epoch: 1 | loss: 0.4869505
	speed: 0.0317s/iter; left time: 352.0093s
	iters: 400, epoch: 1 | loss: 0.7908812
	speed: 0.0295s/iter; left time: 324.4436s
	iters: 500, epoch: 1 | loss: 1.0396357
	speed: 0.0281s/iter; left time: 306.5152s
	iters: 600, epoch: 1 | loss: 0.5755495
	speed: 0.0271s/iter; left time: 292.8837s
	iters: 700, epoch: 1 | loss: 0.4697079
	speed: 0.0264s/iter; left time: 282.0080s
	iters: 800, epoch: 1 | loss: 0.4723594
	speed: 0.0259s/iter; left time: 274.2413s
	iters: 900, epoch: 1 | loss: 0.7474664
	speed: 0.0258s/iter; left time: 271.2054s
	iters: 1000, epoch: 1 | loss: 0.5769287
	speed: 0.0265s/iter; left time: 275.6016s
	iters: 1100, epoch: 1 | loss: 0.7248507
	speed: 0.0259s/iter; left time: 267.2076s
Epoch: 1 cost time: 29.534679889678955
Epoch: 1, Steps: 1140 | Train Loss: 0.6832707 Vali Loss: 0.6580283 Test Loss: 0.2966430
Validation loss decreased (inf --> 0.658028).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8840441
	speed: 0.0449s/iter; left time: 456.2892s
	iters: 200, epoch: 2 | loss: 0.5603024
	speed: 0.0396s/iter; left time: 398.7109s
	iters: 300, epoch: 2 | loss: 0.5095174
	speed: 0.0346s/iter; left time: 345.0919s
	iters: 400, epoch: 2 | loss: 0.5627964
	speed: 0.0302s/iter; left time: 297.4316s
	iters: 500, epoch: 2 | loss: 0.6649796
	speed: 0.0276s/iter; left time: 269.0890s
	iters: 600, epoch: 2 | loss: 0.6496624
	speed: 0.0255s/iter; left time: 246.6788s
	iters: 700, epoch: 2 | loss: 0.5267842
	speed: 0.0248s/iter; left time: 236.7557s
	iters: 800, epoch: 2 | loss: 0.6005808
	speed: 0.0241s/iter; left time: 227.8558s
	iters: 900, epoch: 2 | loss: 0.4738211
	speed: 0.0233s/iter; left time: 218.4504s
	iters: 1000, epoch: 2 | loss: 0.4813676
	speed: 0.0226s/iter; left time: 209.2098s
	iters: 1100, epoch: 2 | loss: 0.8785031
	speed: 0.0224s/iter; left time: 204.9017s
Epoch: 2 cost time: 25.30991291999817
Epoch: 2, Steps: 1140 | Train Loss: 0.6369520 Vali Loss: 0.6354007 Test Loss: 0.2923564
Validation loss decreased (0.658028 --> 0.635401).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.8125423
	speed: 0.0424s/iter; left time: 382.3496s
	iters: 200, epoch: 3 | loss: 0.5817316
	speed: 0.0385s/iter; left time: 343.0476s
	iters: 300, epoch: 3 | loss: 0.5505544
	speed: 0.0367s/iter; left time: 323.4086s
	iters: 400, epoch: 3 | loss: 0.6902412
	speed: 0.0342s/iter; left time: 297.9213s
	iters: 500, epoch: 3 | loss: 0.5359977
	speed: 0.0314s/iter; left time: 270.2931s
	iters: 600, epoch: 3 | loss: 0.5115037
	speed: 0.0299s/iter; left time: 254.4991s
	iters: 700, epoch: 3 | loss: 0.5148859
	speed: 0.0287s/iter; left time: 242.0964s
	iters: 800, epoch: 3 | loss: 0.5003231
	speed: 0.0279s/iter; left time: 232.4022s
	iters: 900, epoch: 3 | loss: 0.5494754
	speed: 0.0273s/iter; left time: 224.4057s
	iters: 1000, epoch: 3 | loss: 0.7712368
	speed: 0.0267s/iter; left time: 216.5031s
	iters: 1100, epoch: 3 | loss: 0.4680704
	speed: 0.0259s/iter; left time: 207.9849s
Epoch: 3 cost time: 29.89830994606018
Epoch: 3, Steps: 1140 | Train Loss: 0.6093304 Vali Loss: 0.6169928 Test Loss: 0.2870914
Validation loss decreased (0.635401 --> 0.616993).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6265150
	speed: 0.0272s/iter; left time: 214.0889s
	iters: 200, epoch: 4 | loss: 0.7519988
	speed: 0.0246s/iter; left time: 191.3174s
	iters: 300, epoch: 4 | loss: 0.4361644
	speed: 0.0236s/iter; left time: 181.5498s
	iters: 400, epoch: 4 | loss: 0.5563920
	speed: 0.0232s/iter; left time: 176.2224s
	iters: 500, epoch: 4 | loss: 0.8308850
	speed: 0.0230s/iter; left time: 171.9021s
	iters: 600, epoch: 4 | loss: 0.5803413
	speed: 0.0227s/iter; left time: 167.6878s
	iters: 700, epoch: 4 | loss: 0.5205509
	speed: 0.0230s/iter; left time: 167.2377s
	iters: 800, epoch: 4 | loss: 0.8100829
	speed: 0.0238s/iter; left time: 171.2389s
	iters: 900, epoch: 4 | loss: 0.5322521
	speed: 0.0247s/iter; left time: 174.9000s
	iters: 1000, epoch: 4 | loss: 0.4906936
	speed: 0.0254s/iter; left time: 177.2391s
	iters: 1100, epoch: 4 | loss: 0.7549531
	speed: 0.0256s/iter; left time: 176.4917s
Epoch: 4 cost time: 29.347697496414185
Epoch: 4, Steps: 1140 | Train Loss: 0.5994380 Vali Loss: 0.6135283 Test Loss: 0.2857974
Validation loss decreased (0.616993 --> 0.613528).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.7393593
	speed: 0.0355s/iter; left time: 239.4647s
	iters: 200, epoch: 5 | loss: 0.7644868
	speed: 0.0293s/iter; left time: 194.4342s
	iters: 300, epoch: 5 | loss: 0.4586281
	speed: 0.0268s/iter; left time: 175.4327s
	iters: 400, epoch: 5 | loss: 0.8570427
	speed: 0.0256s/iter; left time: 165.0181s
	iters: 500, epoch: 5 | loss: 0.5567675
	speed: 0.0238s/iter; left time: 151.1835s
	iters: 600, epoch: 5 | loss: 0.4713241
	speed: 0.0230s/iter; left time: 143.2807s
	iters: 700, epoch: 5 | loss: 0.5735294
	speed: 0.0222s/iter; left time: 136.2514s
	iters: 800, epoch: 5 | loss: 0.8843273
	speed: 0.0216s/iter; left time: 130.4425s
	iters: 900, epoch: 5 | loss: 0.5335302
	speed: 0.0211s/iter; left time: 125.1935s
	iters: 1000, epoch: 5 | loss: 0.5692672
	speed: 0.0206s/iter; left time: 120.4279s
	iters: 1100, epoch: 5 | loss: 0.6702993
	speed: 0.0209s/iter; left time: 120.0146s
Epoch: 5 cost time: 24.124727964401245
Epoch: 5, Steps: 1140 | Train Loss: 0.5934944 Vali Loss: 0.6074309 Test Loss: 0.2860507
Validation loss decreased (0.613528 --> 0.607431).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5726815
	speed: 0.0358s/iter; left time: 200.6481s
	iters: 200, epoch: 6 | loss: 0.4401769
	speed: 0.0313s/iter; left time: 172.0397s
	iters: 300, epoch: 6 | loss: 0.5411911
	speed: 0.0285s/iter; left time: 154.1793s
	iters: 400, epoch: 6 | loss: 0.5389438
	speed: 0.0273s/iter; left time: 144.6224s
	iters: 500, epoch: 6 | loss: 0.5061039
	speed: 0.0260s/iter; left time: 135.0946s
	iters: 600, epoch: 6 | loss: 0.4484980
	speed: 0.0250s/iter; left time: 127.6143s
	iters: 700, epoch: 6 | loss: 0.4137263
	speed: 0.0244s/iter; left time: 122.1319s
	iters: 800, epoch: 6 | loss: 0.7260830
	speed: 0.0242s/iter; left time: 118.4784s
	iters: 900, epoch: 6 | loss: 0.6494510
	speed: 0.0243s/iter; left time: 116.5921s
	iters: 1000, epoch: 6 | loss: 0.5651861
	speed: 0.0243s/iter; left time: 114.3892s
	iters: 1100, epoch: 6 | loss: 0.5547658
	speed: 0.0244s/iter; left time: 112.2328s
Epoch: 6 cost time: 27.978636503219604
Epoch: 6, Steps: 1140 | Train Loss: 0.5904917 Vali Loss: 0.6073762 Test Loss: 0.2853082
Validation loss decreased (0.607431 --> 0.607376).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5685153
	speed: 0.0347s/iter; left time: 154.6163s
	iters: 200, epoch: 7 | loss: 0.8478783
	speed: 0.0298s/iter; left time: 129.8328s
	iters: 300, epoch: 7 | loss: 0.8469303
	speed: 0.0280s/iter; left time: 119.3389s
	iters: 400, epoch: 7 | loss: 0.8073270
	speed: 0.0270s/iter; left time: 112.5259s
	iters: 500, epoch: 7 | loss: 0.7366105
	speed: 0.0267s/iter; left time: 108.3033s
	iters: 600, epoch: 7 | loss: 0.7982668
	speed: 0.0257s/iter; left time: 101.9267s
	iters: 700, epoch: 7 | loss: 0.4750107
	speed: 0.0247s/iter; left time: 95.5253s
	iters: 800, epoch: 7 | loss: 0.7847984
	speed: 0.0245s/iter; left time: 92.3049s
	iters: 900, epoch: 7 | loss: 0.5016886
	speed: 0.0258s/iter; left time: 94.3228s
	iters: 1000, epoch: 7 | loss: 0.4694363
	speed: 0.0266s/iter; left time: 94.8430s
	iters: 1100, epoch: 7 | loss: 0.8310645
	speed: 0.0271s/iter; left time: 93.9397s
Epoch: 7 cost time: 31.528729677200317
Epoch: 7, Steps: 1140 | Train Loss: 0.5888086 Vali Loss: 0.6068702 Test Loss: 0.2849515
Validation loss decreased (0.607376 --> 0.606870).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.5068555
	speed: 0.0335s/iter; left time: 111.2870s
	iters: 200, epoch: 8 | loss: 0.7103313
	speed: 0.0283s/iter; left time: 91.2460s
	iters: 300, epoch: 8 | loss: 0.7686578
	speed: 0.0261s/iter; left time: 81.4224s
	iters: 400, epoch: 8 | loss: 0.9115165
	speed: 0.0249s/iter; left time: 75.3139s
	iters: 500, epoch: 8 | loss: 0.8027875
	speed: 0.0233s/iter; left time: 68.1636s
	iters: 600, epoch: 8 | loss: 0.5556712
	speed: 0.0232s/iter; left time: 65.5763s
	iters: 700, epoch: 8 | loss: 0.5133137
	speed: 0.0233s/iter; left time: 63.2999s
	iters: 800, epoch: 8 | loss: 0.6091332
	speed: 0.0227s/iter; left time: 59.3795s
	iters: 900, epoch: 8 | loss: 0.5532302
	speed: 0.0221s/iter; left time: 55.8394s
	iters: 1000, epoch: 8 | loss: 0.4656587
	speed: 0.0217s/iter; left time: 52.5304s
	iters: 1100, epoch: 8 | loss: 0.5011348
	speed: 0.0212s/iter; left time: 49.2377s
Epoch: 8 cost time: 24.360434770584106
Epoch: 8, Steps: 1140 | Train Loss: 0.5890268 Vali Loss: 0.6068388 Test Loss: 0.2849928
Validation loss decreased (0.606870 --> 0.606839).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.7138206
	speed: 0.0373s/iter; left time: 81.4053s
	iters: 200, epoch: 9 | loss: 0.5085915
	speed: 0.0310s/iter; left time: 64.4387s
	iters: 300, epoch: 9 | loss: 0.8306316
	speed: 0.0272s/iter; left time: 53.9529s
	iters: 400, epoch: 9 | loss: 0.5831678
	speed: 0.0260s/iter; left time: 48.8475s
	iters: 500, epoch: 9 | loss: 0.5081684
	speed: 0.0258s/iter; left time: 46.0019s
	iters: 600, epoch: 9 | loss: 0.4426578
	speed: 0.0272s/iter; left time: 45.6831s
	iters: 700, epoch: 9 | loss: 0.8096592
	speed: 0.0286s/iter; left time: 45.1767s
	iters: 800, epoch: 9 | loss: 0.5912780
	speed: 0.0280s/iter; left time: 41.4983s
	iters: 900, epoch: 9 | loss: 0.7632251
	speed: 0.0276s/iter; left time: 38.1105s
	iters: 1000, epoch: 9 | loss: 0.4778540
	speed: 0.0281s/iter; left time: 35.9454s
	iters: 1100, epoch: 9 | loss: 0.6165193
	speed: 0.0282s/iter; left time: 33.2833s
Epoch: 9 cost time: 32.011638164520264
Epoch: 9, Steps: 1140 | Train Loss: 0.5878140 Vali Loss: 0.6079882 Test Loss: 0.2849506
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.5157411
	speed: 0.0285s/iter; left time: 29.6847s
	iters: 200, epoch: 10 | loss: 0.3914463
	speed: 0.0274s/iter; left time: 25.8178s
	iters: 300, epoch: 10 | loss: 0.5103608
	speed: 0.0272s/iter; left time: 22.8723s
	iters: 400, epoch: 10 | loss: 0.4589856
	speed: 0.0290s/iter; left time: 21.5026s
	iters: 500, epoch: 10 | loss: 0.5077617
	speed: 0.0283s/iter; left time: 18.1304s
	iters: 600, epoch: 10 | loss: 0.4979763
	speed: 0.0276s/iter; left time: 14.9275s
	iters: 700, epoch: 10 | loss: 0.7872018
	speed: 0.0268s/iter; left time: 11.8258s
	iters: 800, epoch: 10 | loss: 0.4697692
	speed: 0.0262s/iter; left time: 8.9273s
	iters: 900, epoch: 10 | loss: 0.8073931
	speed: 0.0259s/iter; left time: 6.2406s
	iters: 1000, epoch: 10 | loss: 0.4486611
	speed: 0.0255s/iter; left time: 3.5968s
	iters: 1100, epoch: 10 | loss: 0.5516897
	speed: 0.0252s/iter; left time: 1.0326s
Epoch: 10 cost time: 28.830907106399536
Epoch: 10, Steps: 1140 | Train Loss: 0.5875999 Vali Loss: 0.6058723 Test Loss: 0.2848668
Validation loss decreased (0.606839 --> 0.605872).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.28486689925193787, mae:0.30299174785614014
Use GPU: cuda:0
no_skip True
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.6016418
	speed: 0.0282s/iter; left time: 319.1391s
	iters: 200, epoch: 1 | loss: 0.6102638
	speed: 0.0251s/iter; left time: 280.6091s
	iters: 300, epoch: 1 | loss: 0.6130787
	speed: 0.0242s/iter; left time: 268.9263s
	iters: 400, epoch: 1 | loss: 0.4386729
	speed: 0.0234s/iter; left time: 257.8135s
	iters: 500, epoch: 1 | loss: 0.8198161
	speed: 0.0227s/iter; left time: 247.2782s
	iters: 600, epoch: 1 | loss: 0.4954266
	speed: 0.0222s/iter; left time: 239.5643s
	iters: 700, epoch: 1 | loss: 0.6676684
	speed: 0.0231s/iter; left time: 247.1082s
	iters: 800, epoch: 1 | loss: 0.5509298
	speed: 0.0235s/iter; left time: 249.2552s
	iters: 900, epoch: 1 | loss: 0.5750013
	speed: 0.0230s/iter; left time: 241.2394s
	iters: 1000, epoch: 1 | loss: 0.5317456
	speed: 0.0228s/iter; left time: 237.1186s
	iters: 1100, epoch: 1 | loss: 0.5833487
	speed: 0.0237s/iter; left time: 243.9753s
Epoch: 1 cost time: 27.688222885131836
Epoch: 1, Steps: 1140 | Train Loss: 0.6867790 Vali Loss: 0.6539171 Test Loss: 0.2975647
Validation loss decreased (inf --> 0.653917).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5384213
	speed: 0.0401s/iter; left time: 407.8861s
	iters: 200, epoch: 2 | loss: 0.7704248
	speed: 0.0325s/iter; left time: 326.8636s
	iters: 300, epoch: 2 | loss: 0.6407633
	speed: 0.0298s/iter; left time: 296.9983s
	iters: 400, epoch: 2 | loss: 0.6749172
	speed: 0.0284s/iter; left time: 279.8157s
	iters: 500, epoch: 2 | loss: 0.6491371
	speed: 0.0274s/iter; left time: 267.1142s
	iters: 600, epoch: 2 | loss: 0.6381983
	speed: 0.0262s/iter; left time: 253.3349s
	iters: 700, epoch: 2 | loss: 0.5669997
	speed: 0.0255s/iter; left time: 243.6112s
	iters: 800, epoch: 2 | loss: 0.5803866
	speed: 0.0249s/iter; left time: 235.5373s
	iters: 900, epoch: 2 | loss: 0.4965079
	speed: 0.0257s/iter; left time: 240.8184s
	iters: 1000, epoch: 2 | loss: 0.6338829
	speed: 0.0266s/iter; left time: 246.3066s
	iters: 1100, epoch: 2 | loss: 0.4985693
	speed: 0.0273s/iter; left time: 250.3006s
Epoch: 2 cost time: 31.70632767677307
Epoch: 2, Steps: 1140 | Train Loss: 0.6411149 Vali Loss: 0.6376472 Test Loss: 0.2930118
Validation loss decreased (0.653917 --> 0.637647).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5073273
	speed: 0.0248s/iter; left time: 223.8168s
	iters: 200, epoch: 3 | loss: 0.8268448
	speed: 0.0220s/iter; left time: 196.3016s
	iters: 300, epoch: 3 | loss: 0.5469960
	speed: 0.0218s/iter; left time: 192.0534s
	iters: 400, epoch: 3 | loss: 0.6924181
	speed: 0.0218s/iter; left time: 189.8426s
	iters: 500, epoch: 3 | loss: 0.5170205
	speed: 0.0229s/iter; left time: 197.6379s
	iters: 600, epoch: 3 | loss: 0.5650290
	speed: 0.0226s/iter; left time: 192.6347s
	iters: 700, epoch: 3 | loss: 0.6955562
	speed: 0.0221s/iter; left time: 186.4592s
	iters: 800, epoch: 3 | loss: 0.6309611
	speed: 0.0220s/iter; left time: 183.3031s
	iters: 900, epoch: 3 | loss: 0.6268378
	speed: 0.0220s/iter; left time: 180.4859s
	iters: 1000, epoch: 3 | loss: 0.9746447
	speed: 0.0220s/iter; left time: 179.0667s
	iters: 1100, epoch: 3 | loss: 0.6165509
	speed: 0.0222s/iter; left time: 178.3642s
Epoch: 3 cost time: 25.507670164108276
Epoch: 3, Steps: 1140 | Train Loss: 0.6178950 Vali Loss: 0.6637637 Test Loss: 0.2928849
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5710851
	speed: 0.0349s/iter; left time: 275.0757s
	iters: 200, epoch: 4 | loss: 0.8069677
	speed: 0.0314s/iter; left time: 244.2562s
	iters: 300, epoch: 4 | loss: 0.9298242
	speed: 0.0284s/iter; left time: 218.4819s
	iters: 400, epoch: 4 | loss: 0.5103923
	speed: 0.0264s/iter; left time: 200.0802s
	iters: 500, epoch: 4 | loss: 1.0830410
	speed: 0.0247s/iter; left time: 184.8891s
	iters: 600, epoch: 4 | loss: 0.5923692
	speed: 0.0230s/iter; left time: 170.0412s
	iters: 700, epoch: 4 | loss: 0.5788434
	speed: 0.0219s/iter; left time: 159.2717s
	iters: 800, epoch: 4 | loss: 0.6338821
	speed: 0.0215s/iter; left time: 154.4255s
	iters: 900, epoch: 4 | loss: 0.7997712
	speed: 0.0213s/iter; left time: 151.0002s
	iters: 1000, epoch: 4 | loss: 0.8575984
	speed: 0.0214s/iter; left time: 149.1111s
	iters: 1100, epoch: 4 | loss: 0.5030663
	speed: 0.0216s/iter; left time: 148.3799s
Epoch: 4 cost time: 24.846402645111084
Epoch: 4, Steps: 1140 | Train Loss: 0.6054573 Vali Loss: 0.6322917 Test Loss: 0.2879921
Validation loss decreased (0.637647 --> 0.632292).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5465356
	speed: 0.0292s/iter; left time: 196.5103s
	iters: 200, epoch: 5 | loss: 0.6416393
	speed: 0.0257s/iter; left time: 170.7217s
	iters: 300, epoch: 5 | loss: 0.7299240
	speed: 0.0246s/iter; left time: 160.6654s
	iters: 400, epoch: 5 | loss: 0.4699376
	speed: 0.0251s/iter; left time: 161.9266s
	iters: 500, epoch: 5 | loss: 0.5355437
	speed: 0.0266s/iter; left time: 168.3883s
	iters: 600, epoch: 5 | loss: 0.5695913
	speed: 0.0256s/iter; left time: 160.0672s
	iters: 700, epoch: 5 | loss: 0.4918988
	speed: 0.0247s/iter; left time: 151.7203s
	iters: 800, epoch: 5 | loss: 0.4852252
	speed: 0.0239s/iter; left time: 144.2828s
	iters: 900, epoch: 5 | loss: 0.4967964
	speed: 0.0238s/iter; left time: 141.1269s
	iters: 1000, epoch: 5 | loss: 0.4009444
	speed: 0.0239s/iter; left time: 139.8102s
	iters: 1100, epoch: 5 | loss: 0.6842203
	speed: 0.0248s/iter; left time: 142.4799s
Epoch: 5 cost time: 28.889044284820557
Epoch: 5, Steps: 1140 | Train Loss: 0.5987104 Vali Loss: 0.6271123 Test Loss: 0.2871196
Validation loss decreased (0.632292 --> 0.627112).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8115799
	speed: 0.0362s/iter; left time: 202.6018s
	iters: 200, epoch: 6 | loss: 0.4679838
	speed: 0.0331s/iter; left time: 182.0655s
	iters: 300, epoch: 6 | loss: 0.4440328
	speed: 0.0296s/iter; left time: 159.9193s
	iters: 400, epoch: 6 | loss: 0.4362909
	speed: 0.0275s/iter; left time: 145.8013s
	iters: 500, epoch: 6 | loss: 0.8036540
	speed: 0.0257s/iter; left time: 133.4244s
	iters: 600, epoch: 6 | loss: 0.5354449
	speed: 0.0248s/iter; left time: 126.3335s
	iters: 700, epoch: 6 | loss: 0.8601009
	speed: 0.0236s/iter; left time: 118.1217s
	iters: 800, epoch: 6 | loss: 0.8007476
	speed: 0.0231s/iter; left time: 113.3132s
	iters: 900, epoch: 6 | loss: 0.5638995
	speed: 0.0227s/iter; left time: 109.0911s
	iters: 1000, epoch: 6 | loss: 0.4708124
	speed: 0.0228s/iter; left time: 107.3821s
	iters: 1100, epoch: 6 | loss: 0.4841394
	speed: 0.0230s/iter; left time: 105.7199s
Epoch: 6 cost time: 26.401177406311035
Epoch: 6, Steps: 1140 | Train Loss: 0.5955928 Vali Loss: 0.6218266 Test Loss: 0.2864200
Validation loss decreased (0.627112 --> 0.621827).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 1.1354800
	speed: 0.0347s/iter; left time: 154.6804s
	iters: 200, epoch: 7 | loss: 0.5124284
	speed: 0.0265s/iter; left time: 115.4603s
	iters: 300, epoch: 7 | loss: 0.5447618
	speed: 0.0234s/iter; left time: 99.6532s
	iters: 400, epoch: 7 | loss: 0.5770316
	speed: 0.0218s/iter; left time: 90.6383s
	iters: 500, epoch: 7 | loss: 0.4862498
	speed: 0.0211s/iter; left time: 85.7155s
	iters: 600, epoch: 7 | loss: 0.8487880
	speed: 0.0209s/iter; left time: 82.6457s
	iters: 700, epoch: 7 | loss: 0.6063703
	speed: 0.0202s/iter; left time: 78.0981s
	iters: 800, epoch: 7 | loss: 0.4757745
	speed: 0.0199s/iter; left time: 74.9932s
	iters: 900, epoch: 7 | loss: 0.5127922
	speed: 0.0203s/iter; left time: 74.3236s
	iters: 1000, epoch: 7 | loss: 0.4622262
	speed: 0.0205s/iter; left time: 73.0831s
	iters: 1100, epoch: 7 | loss: 0.4357804
	speed: 0.0205s/iter; left time: 71.0923s
Epoch: 7 cost time: 23.574891328811646
Epoch: 7, Steps: 1140 | Train Loss: 0.5939446 Vali Loss: 0.6265925 Test Loss: 0.2867438
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.8465490
	speed: 0.0460s/iter; left time: 152.7799s
	iters: 200, epoch: 8 | loss: 0.6076578
	speed: 0.0431s/iter; left time: 138.8155s
	iters: 300, epoch: 8 | loss: 0.4575135
	speed: 0.0425s/iter; left time: 132.5401s
	iters: 400, epoch: 8 | loss: 0.5617866
	speed: 0.0411s/iter; left time: 124.1300s
	iters: 500, epoch: 8 | loss: 0.6489751
	speed: 0.0394s/iter; left time: 114.9947s
	iters: 600, epoch: 8 | loss: 0.5098364
	speed: 0.0373s/iter; left time: 105.2586s
	iters: 700, epoch: 8 | loss: 0.4546056
	speed: 0.0352s/iter; left time: 95.6641s
	iters: 800, epoch: 8 | loss: 0.4531463
	speed: 0.0332s/iter; left time: 86.9617s
	iters: 900, epoch: 8 | loss: 0.6325043
	speed: 0.0317s/iter; left time: 79.8183s
	iters: 1000, epoch: 8 | loss: 0.4646179
	speed: 0.0306s/iter; left time: 74.0367s
	iters: 1100, epoch: 8 | loss: 0.4310188
	speed: 0.0298s/iter; left time: 69.2592s
Epoch: 8 cost time: 33.932002544403076
Epoch: 8, Steps: 1140 | Train Loss: 0.5930539 Vali Loss: 0.6244797 Test Loss: 0.2868786
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 1.2185218
	speed: 0.0436s/iter; left time: 95.1988s
	iters: 200, epoch: 9 | loss: 0.4502741
	speed: 0.0393s/iter; left time: 81.7032s
	iters: 300, epoch: 9 | loss: 0.9192575
	speed: 0.0335s/iter; left time: 66.3296s
	iters: 400, epoch: 9 | loss: 0.7044547
	speed: 0.0307s/iter; left time: 57.6713s
	iters: 500, epoch: 9 | loss: 0.8420373
	speed: 0.0289s/iter; left time: 51.5410s
	iters: 600, epoch: 9 | loss: 0.8296876
	speed: 0.0268s/iter; left time: 45.1155s
	iters: 700, epoch: 9 | loss: 0.4732675
	speed: 0.0256s/iter; left time: 40.4112s
	iters: 800, epoch: 9 | loss: 0.7050474
	speed: 0.0248s/iter; left time: 36.7819s
	iters: 900, epoch: 9 | loss: 0.8157662
	speed: 0.0243s/iter; left time: 33.5813s
	iters: 1000, epoch: 9 | loss: 0.4374577
	speed: 0.0242s/iter; left time: 31.0600s
	iters: 1100, epoch: 9 | loss: 0.9792727
	speed: 0.0240s/iter; left time: 28.3630s
Epoch: 9 cost time: 27.34206986427307
Epoch: 9, Steps: 1140 | Train Loss: 0.5923657 Vali Loss: 0.6244455 Test Loss: 0.2867797
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.6081533
	speed: 0.0315s/iter; left time: 32.7571s
	iters: 200, epoch: 10 | loss: 0.8015278
	speed: 0.0251s/iter; left time: 23.6280s
	iters: 300, epoch: 10 | loss: 0.5596902
	speed: 0.0256s/iter; left time: 21.5280s
	iters: 400, epoch: 10 | loss: 0.5869204
	speed: 0.0242s/iter; left time: 17.9194s
	iters: 500, epoch: 10 | loss: 0.4308718
	speed: 0.0239s/iter; left time: 15.3152s
	iters: 600, epoch: 10 | loss: 0.5319003
	speed: 0.0230s/iter; left time: 12.4379s
	iters: 700, epoch: 10 | loss: 0.4686268
	speed: 0.0227s/iter; left time: 9.9934s
	iters: 800, epoch: 10 | loss: 0.5380005
	speed: 0.0237s/iter; left time: 8.0962s
	iters: 900, epoch: 10 | loss: 0.4790799
	speed: 0.0251s/iter; left time: 6.0530s
	iters: 1000, epoch: 10 | loss: 0.4329917
	speed: 0.0262s/iter; left time: 3.6899s
	iters: 1100, epoch: 10 | loss: 0.7387339
	speed: 0.0275s/iter; left time: 1.1274s
Epoch: 10 cost time: 32.04019641876221
Epoch: 10, Steps: 1140 | Train Loss: 0.5923765 Vali Loss: 0.6207345 Test Loss: 0.2863472
Validation loss decreased (0.621827 --> 0.620734).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.28634724020957947, mae:0.3037775456905365
Seed: 42
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_720      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip True
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.7371145
	speed: 0.0577s/iter; left time: 645.5612s
	iters: 200, epoch: 1 | loss: 0.7673560
	speed: 0.0481s/iter; left time: 532.7862s
	iters: 300, epoch: 1 | loss: 0.8713338
	speed: 0.0458s/iter; left time: 502.6956s
	iters: 400, epoch: 1 | loss: 0.9463366
	speed: 0.0447s/iter; left time: 486.3049s
	iters: 500, epoch: 1 | loss: 0.6560206
	speed: 0.0439s/iter; left time: 473.3469s
	iters: 600, epoch: 1 | loss: 0.6071659
	speed: 0.0416s/iter; left time: 443.9271s
	iters: 700, epoch: 1 | loss: 0.8126633
	speed: 0.0386s/iter; left time: 408.3204s
	iters: 800, epoch: 1 | loss: 0.6116224
	speed: 0.0361s/iter; left time: 378.5261s
	iters: 900, epoch: 1 | loss: 0.7097927
	speed: 0.0342s/iter; left time: 355.2466s
	iters: 1000, epoch: 1 | loss: 0.8752550
	speed: 0.0332s/iter; left time: 341.6289s
	iters: 1100, epoch: 1 | loss: 0.6520408
	speed: 0.0331s/iter; left time: 337.4991s
Epoch: 1 cost time: 37.1748263835907
Epoch: 1, Steps: 1128 | Train Loss: 0.7649847 Vali Loss: 0.7908363 Test Loss: 0.3724134
Validation loss decreased (inf --> 0.790836).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8492430
	speed: 0.0246s/iter; left time: 247.6870s
	iters: 200, epoch: 2 | loss: 0.8606660
	speed: 0.0225s/iter; left time: 224.0119s
	iters: 300, epoch: 2 | loss: 0.7476549
	speed: 0.0220s/iter; left time: 216.6538s
	iters: 400, epoch: 2 | loss: 0.8279741
	speed: 0.0215s/iter; left time: 210.1435s
	iters: 500, epoch: 2 | loss: 0.8292376
	speed: 0.0211s/iter; left time: 204.1352s
	iters: 600, epoch: 2 | loss: 0.7325175
	speed: 0.0216s/iter; left time: 205.9735s
	iters: 700, epoch: 2 | loss: 0.6561373
	speed: 0.0210s/iter; left time: 198.5248s
	iters: 800, epoch: 2 | loss: 0.5882887
	speed: 0.0204s/iter; left time: 191.2509s
	iters: 900, epoch: 2 | loss: 0.7557122
	speed: 0.0206s/iter; left time: 190.7341s
	iters: 1000, epoch: 2 | loss: 0.7410187
	speed: 0.0215s/iter; left time: 196.9745s
	iters: 1100, epoch: 2 | loss: 0.6476479
	speed: 0.0217s/iter; left time: 196.0747s
Epoch: 2 cost time: 24.604644536972046
Epoch: 2, Steps: 1128 | Train Loss: 0.7074270 Vali Loss: 0.7586803 Test Loss: 0.3673567
Validation loss decreased (0.790836 --> 0.758680).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7683869
	speed: 0.0440s/iter; left time: 392.7803s
	iters: 200, epoch: 3 | loss: 0.7364514
	speed: 0.0421s/iter; left time: 371.8824s
	iters: 300, epoch: 3 | loss: 0.6615510
	speed: 0.0404s/iter; left time: 352.7018s
	iters: 400, epoch: 3 | loss: 0.8186266
	speed: 0.0362s/iter; left time: 312.1502s
	iters: 500, epoch: 3 | loss: 0.6437054
	speed: 0.0332s/iter; left time: 283.3857s
	iters: 600, epoch: 3 | loss: 0.8584625
	speed: 0.0311s/iter; left time: 262.1510s
	iters: 700, epoch: 3 | loss: 0.5645411
	speed: 0.0295s/iter; left time: 245.7220s
	iters: 800, epoch: 3 | loss: 0.6404840
	speed: 0.0285s/iter; left time: 234.4393s
	iters: 900, epoch: 3 | loss: 0.6632483
	speed: 0.0279s/iter; left time: 226.7719s
	iters: 1000, epoch: 3 | loss: 0.6865242
	speed: 0.0272s/iter; left time: 218.6001s
	iters: 1100, epoch: 3 | loss: 0.7111592
	speed: 0.0266s/iter; left time: 211.0014s
Epoch: 3 cost time: 30.056896209716797
Epoch: 3, Steps: 1128 | Train Loss: 0.6915649 Vali Loss: 0.7332694 Test Loss: 0.3601859
Validation loss decreased (0.758680 --> 0.733269).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5669165
	speed: 0.0292s/iter; left time: 227.2962s
	iters: 200, epoch: 4 | loss: 0.5494997
	speed: 0.0268s/iter; left time: 206.2842s
	iters: 300, epoch: 4 | loss: 0.7401639
	speed: 0.0255s/iter; left time: 193.6074s
	iters: 400, epoch: 4 | loss: 0.9272949
	speed: 0.0248s/iter; left time: 185.5976s
	iters: 500, epoch: 4 | loss: 0.8238447
	speed: 0.0243s/iter; left time: 179.4755s
	iters: 600, epoch: 4 | loss: 0.6981152
	speed: 0.0239s/iter; left time: 174.2102s
	iters: 700, epoch: 4 | loss: 0.5768286
	speed: 0.0236s/iter; left time: 169.7506s
	iters: 800, epoch: 4 | loss: 0.7045931
	speed: 0.0231s/iter; left time: 163.9594s
	iters: 900, epoch: 4 | loss: 0.6088113
	speed: 0.0228s/iter; left time: 159.3747s
	iters: 1000, epoch: 4 | loss: 0.6798788
	speed: 0.0229s/iter; left time: 157.8287s
	iters: 1100, epoch: 4 | loss: 0.8566200
	speed: 0.0227s/iter; left time: 154.2918s
Epoch: 4 cost time: 25.584720134735107
Epoch: 4, Steps: 1128 | Train Loss: 0.6801446 Vali Loss: 0.7317082 Test Loss: 0.3608338
Validation loss decreased (0.733269 --> 0.731708).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.7450051
	speed: 0.0387s/iter; left time: 258.0049s
	iters: 200, epoch: 5 | loss: 0.6659675
	speed: 0.0374s/iter; left time: 245.5971s
	iters: 300, epoch: 5 | loss: 0.6298342
	speed: 0.0334s/iter; left time: 215.7690s
	iters: 400, epoch: 5 | loss: 0.5542262
	speed: 0.0300s/iter; left time: 191.3750s
	iters: 500, epoch: 5 | loss: 0.8710510
	speed: 0.0281s/iter; left time: 175.9126s
	iters: 600, epoch: 5 | loss: 0.5981274
	speed: 0.0267s/iter; left time: 164.6653s
	iters: 700, epoch: 5 | loss: 0.5263087
	speed: 0.0258s/iter; left time: 156.3955s
	iters: 800, epoch: 5 | loss: 0.6507756
	speed: 0.0245s/iter; left time: 146.1171s
	iters: 900, epoch: 5 | loss: 0.5975964
	speed: 0.0233s/iter; left time: 136.7708s
	iters: 1000, epoch: 5 | loss: 0.7166111
	speed: 0.0231s/iter; left time: 133.2065s
	iters: 1100, epoch: 5 | loss: 0.5881495
	speed: 0.0234s/iter; left time: 132.8293s
Epoch: 5 cost time: 26.462429761886597
Epoch: 5, Steps: 1128 | Train Loss: 0.6749007 Vali Loss: 0.7271568 Test Loss: 0.3605350
Validation loss decreased (0.731708 --> 0.727157).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6492891
	speed: 0.0358s/iter; left time: 198.5519s
	iters: 200, epoch: 6 | loss: 0.7697557
	speed: 0.0359s/iter; left time: 195.5126s
	iters: 300, epoch: 6 | loss: 0.6232523
	speed: 0.0368s/iter; left time: 196.5107s
	iters: 400, epoch: 6 | loss: 0.8337854
	speed: 0.0381s/iter; left time: 199.7164s
	iters: 500, epoch: 6 | loss: 0.6723187
	speed: 0.0384s/iter; left time: 197.6463s
	iters: 600, epoch: 6 | loss: 0.6937601
	speed: 0.0376s/iter; left time: 189.5667s
	iters: 700, epoch: 6 | loss: 0.6083915
	speed: 0.0354s/iter; left time: 174.8072s
	iters: 800, epoch: 6 | loss: 0.5244300
	speed: 0.0333s/iter; left time: 161.3013s
	iters: 900, epoch: 6 | loss: 0.6698574
	speed: 0.0321s/iter; left time: 152.2376s
	iters: 1000, epoch: 6 | loss: 0.5638007
	speed: 0.0316s/iter; left time: 146.8130s
	iters: 1100, epoch: 6 | loss: 0.6189141
	speed: 0.0308s/iter; left time: 140.0239s
Epoch: 6 cost time: 34.69406604766846
Epoch: 6, Steps: 1128 | Train Loss: 0.6720664 Vali Loss: 0.7282372 Test Loss: 0.3612654
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8927911
	speed: 0.0445s/iter; left time: 196.4768s
	iters: 200, epoch: 7 | loss: 0.5911350
	speed: 0.0432s/iter; left time: 186.4480s
	iters: 300, epoch: 7 | loss: 0.5789293
	speed: 0.0369s/iter; left time: 155.5063s
	iters: 400, epoch: 7 | loss: 0.6674801
	speed: 0.0338s/iter; left time: 138.9122s
	iters: 500, epoch: 7 | loss: 0.7468402
	speed: 0.0309s/iter; left time: 123.9076s
	iters: 600, epoch: 7 | loss: 0.6651938
	speed: 0.0291s/iter; left time: 113.7103s
	iters: 700, epoch: 7 | loss: 0.5962515
	speed: 0.0297s/iter; left time: 113.0764s
	iters: 800, epoch: 7 | loss: 0.7878149
	speed: 0.0298s/iter; left time: 110.5470s
	iters: 900, epoch: 7 | loss: 0.6255773
	speed: 0.0290s/iter; left time: 104.6948s
	iters: 1000, epoch: 7 | loss: 0.5440603
	speed: 0.0288s/iter; left time: 101.0630s
	iters: 1100, epoch: 7 | loss: 0.7655777
	speed: 0.0282s/iter; left time: 96.2418s
Epoch: 7 cost time: 31.77080798149109
Epoch: 7, Steps: 1128 | Train Loss: 0.6706320 Vali Loss: 0.7301275 Test Loss: 0.3612183
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.9049783
	speed: 0.0365s/iter; left time: 119.8298s
	iters: 200, epoch: 8 | loss: 0.6114851
	speed: 0.0270s/iter; left time: 85.9542s
	iters: 300, epoch: 8 | loss: 0.7951429
	speed: 0.0238s/iter; left time: 73.4130s
	iters: 400, epoch: 8 | loss: 0.7978680
	speed: 0.0233s/iter; left time: 69.6207s
	iters: 500, epoch: 8 | loss: 0.5944353
	speed: 0.0231s/iter; left time: 66.5286s
	iters: 600, epoch: 8 | loss: 0.5540350
	speed: 0.0228s/iter; left time: 63.4634s
	iters: 700, epoch: 8 | loss: 0.8828417
	speed: 0.0229s/iter; left time: 61.5570s
	iters: 800, epoch: 8 | loss: 0.6196433
	speed: 0.0230s/iter; left time: 59.3612s
	iters: 900, epoch: 8 | loss: 0.5103896
	speed: 0.0231s/iter; left time: 57.2993s
	iters: 1000, epoch: 8 | loss: 0.5865423
	speed: 0.0229s/iter; left time: 54.7061s
	iters: 1100, epoch: 8 | loss: 0.6562893
	speed: 0.0230s/iter; left time: 52.4794s
Epoch: 8 cost time: 26.022494077682495
Epoch: 8, Steps: 1128 | Train Loss: 0.6698656 Vali Loss: 0.7277343 Test Loss: 0.3607170
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.5286267
	speed: 0.0456s/iter; left time: 98.4109s
	iters: 200, epoch: 9 | loss: 0.6102191
	speed: 0.0421s/iter; left time: 86.5403s
	iters: 300, epoch: 9 | loss: 0.7210368
	speed: 0.0347s/iter; left time: 67.9749s
	iters: 400, epoch: 9 | loss: 0.6294863
	speed: 0.0316s/iter; left time: 58.6103s
	iters: 500, epoch: 9 | loss: 0.6039135
	speed: 0.0293s/iter; left time: 51.3929s
	iters: 600, epoch: 9 | loss: 0.6373207
	speed: 0.0277s/iter; left time: 45.9575s
	iters: 700, epoch: 9 | loss: 0.6285505
	speed: 0.0267s/iter; left time: 41.6317s
	iters: 800, epoch: 9 | loss: 0.7379313
	speed: 0.0262s/iter; left time: 38.2171s
	iters: 900, epoch: 9 | loss: 0.5558854
	speed: 0.0258s/iter; left time: 34.9899s
	iters: 1000, epoch: 9 | loss: 0.8289251
	speed: 0.0254s/iter; left time: 31.9571s
	iters: 1100, epoch: 9 | loss: 0.6825390
	speed: 0.0252s/iter; left time: 29.1255s
Epoch: 9 cost time: 28.44369673728943
Epoch: 9, Steps: 1128 | Train Loss: 0.6694845 Vali Loss: 0.7305781 Test Loss: 0.3609074
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.6607125
	speed: 0.0317s/iter; left time: 32.5798s
	iters: 200, epoch: 10 | loss: 0.6779620
	speed: 0.0333s/iter; left time: 30.9408s
	iters: 300, epoch: 10 | loss: 0.7263783
	speed: 0.0335s/iter; left time: 27.8105s
	iters: 400, epoch: 10 | loss: 0.8952081
	speed: 0.0309s/iter; left time: 22.5549s
	iters: 500, epoch: 10 | loss: 0.6169459
	speed: 0.0296s/iter; left time: 18.6216s
	iters: 600, epoch: 10 | loss: 0.6225612
	speed: 0.0283s/iter; left time: 14.9826s
	iters: 700, epoch: 10 | loss: 0.5185987
	speed: 0.0272s/iter; left time: 11.6564s
	iters: 800, epoch: 10 | loss: 0.6746504
	speed: 0.0264s/iter; left time: 8.6741s
	iters: 900, epoch: 10 | loss: 0.5338982
	speed: 0.0260s/iter; left time: 5.9469s
	iters: 1000, epoch: 10 | loss: 0.8272856
	speed: 0.0257s/iter; left time: 3.3166s
	iters: 1100, epoch: 10 | loss: 0.5722883
	speed: 0.0254s/iter; left time: 0.7370s
Epoch: 10 cost time: 28.555341243743896
Epoch: 10, Steps: 1128 | Train Loss: 0.6693848 Vali Loss: 0.7288572 Test Loss: 0.3607357
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.36053499579429626, mae:0.351431667804718
Use GPU: cuda:0
no_skip True
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 1.1166131
	speed: 0.0296s/iter; left time: 330.7018s
	iters: 200, epoch: 1 | loss: 0.8631768
	speed: 0.0255s/iter; left time: 282.5031s
	iters: 300, epoch: 1 | loss: 0.6900007
	speed: 0.0244s/iter; left time: 268.3901s
	iters: 400, epoch: 1 | loss: 0.9085915
	speed: 0.0238s/iter; left time: 258.9350s
	iters: 500, epoch: 1 | loss: 0.9340584
	speed: 0.0234s/iter; left time: 251.9264s
	iters: 600, epoch: 1 | loss: 0.8601472
	speed: 0.0235s/iter; left time: 251.5199s
	iters: 700, epoch: 1 | loss: 0.5585350
	speed: 0.0240s/iter; left time: 254.3950s
	iters: 800, epoch: 1 | loss: 0.7375732
	speed: 0.0244s/iter; left time: 255.2328s
	iters: 900, epoch: 1 | loss: 0.6351641
	speed: 0.0239s/iter; left time: 247.9640s
	iters: 1000, epoch: 1 | loss: 0.8158774
	speed: 0.0235s/iter; left time: 241.5131s
	iters: 1100, epoch: 1 | loss: 0.6524203
	speed: 0.0232s/iter; left time: 235.8974s
Epoch: 1 cost time: 26.17924928665161
Epoch: 1, Steps: 1128 | Train Loss: 0.7682003 Vali Loss: 0.7889616 Test Loss: 0.3718843
Validation loss decreased (inf --> 0.788962).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8260818
	speed: 0.0327s/iter; left time: 328.8294s
	iters: 200, epoch: 2 | loss: 0.6405493
	speed: 0.0330s/iter; left time: 328.6285s
	iters: 300, epoch: 2 | loss: 0.7464682
	speed: 0.0322s/iter; left time: 317.5728s
	iters: 400, epoch: 2 | loss: 0.6592662
	speed: 0.0298s/iter; left time: 290.8991s
	iters: 500, epoch: 2 | loss: 0.7434052
	speed: 0.0284s/iter; left time: 274.0338s
	iters: 600, epoch: 2 | loss: 0.6138396
	speed: 0.0274s/iter; left time: 261.6197s
	iters: 700, epoch: 2 | loss: 0.7027107
	speed: 0.0271s/iter; left time: 255.8259s
	iters: 800, epoch: 2 | loss: 0.6197163
	speed: 0.0263s/iter; left time: 246.3809s
	iters: 900, epoch: 2 | loss: 0.6237468
	speed: 0.0260s/iter; left time: 240.6288s
	iters: 1000, epoch: 2 | loss: 0.7432041
	speed: 0.0255s/iter; left time: 233.0959s
	iters: 1100, epoch: 2 | loss: 0.8866132
	speed: 0.0256s/iter; left time: 231.4345s
Epoch: 2 cost time: 29.138655185699463
Epoch: 2, Steps: 1128 | Train Loss: 0.7370264 Vali Loss: 0.7817509 Test Loss: 0.3697219
Validation loss decreased (0.788962 --> 0.781751).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7353739
	speed: 0.0448s/iter; left time: 399.8342s
	iters: 200, epoch: 3 | loss: 0.6444668
	speed: 0.0353s/iter; left time: 311.1086s
	iters: 300, epoch: 3 | loss: 0.5499815
	speed: 0.0309s/iter; left time: 269.8610s
	iters: 400, epoch: 3 | loss: 0.5957689
	speed: 0.0321s/iter; left time: 276.8139s
	iters: 500, epoch: 3 | loss: 0.6618477
	speed: 0.0299s/iter; left time: 254.8365s
	iters: 600, epoch: 3 | loss: 0.6563733
	speed: 0.0286s/iter; left time: 240.6222s
	iters: 700, epoch: 3 | loss: 0.7956755
	speed: 0.0277s/iter; left time: 230.2853s
	iters: 800, epoch: 3 | loss: 0.7898527
	speed: 0.0271s/iter; left time: 222.6607s
	iters: 900, epoch: 3 | loss: 0.7141280
	speed: 0.0275s/iter; left time: 223.6169s
	iters: 1000, epoch: 3 | loss: 0.8936444
	speed: 0.0274s/iter; left time: 219.5328s
	iters: 1100, epoch: 3 | loss: 0.6639212
	speed: 0.0269s/iter; left time: 213.3181s
Epoch: 3 cost time: 30.25191569328308
Epoch: 3, Steps: 1128 | Train Loss: 0.7149382 Vali Loss: 0.7592482 Test Loss: 0.3649445
Validation loss decreased (0.781751 --> 0.759248).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5945627
	speed: 0.0261s/iter; left time: 203.1582s
	iters: 200, epoch: 4 | loss: 0.6897682
	speed: 0.0249s/iter; left time: 191.8709s
	iters: 300, epoch: 4 | loss: 0.5907593
	speed: 0.0268s/iter; left time: 203.4713s
	iters: 400, epoch: 4 | loss: 0.6240947
	speed: 0.0268s/iter; left time: 200.7525s
	iters: 500, epoch: 4 | loss: 0.8064018
	speed: 0.0272s/iter; left time: 201.4274s
	iters: 600, epoch: 4 | loss: 0.8360552
	speed: 0.0265s/iter; left time: 193.3796s
	iters: 700, epoch: 4 | loss: 0.6561134
	speed: 0.0255s/iter; left time: 183.5950s
	iters: 800, epoch: 4 | loss: 0.5990198
	speed: 0.0251s/iter; left time: 178.4459s
	iters: 900, epoch: 4 | loss: 0.6713629
	speed: 0.0247s/iter; left time: 172.8938s
	iters: 1000, epoch: 4 | loss: 0.8769280
	speed: 0.0245s/iter; left time: 169.2347s
	iters: 1100, epoch: 4 | loss: 0.8096800
	speed: 0.0244s/iter; left time: 166.0026s
Epoch: 4 cost time: 27.927276611328125
Epoch: 4, Steps: 1128 | Train Loss: 0.7047983 Vali Loss: 0.7602141 Test Loss: 0.3645917
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6066549
	speed: 0.0287s/iter; left time: 191.1812s
	iters: 200, epoch: 5 | loss: 0.6078086
	speed: 0.0254s/iter; left time: 166.9945s
	iters: 300, epoch: 5 | loss: 0.6612481
	speed: 0.0244s/iter; left time: 157.5454s
	iters: 400, epoch: 5 | loss: 0.6242279
	speed: 0.0234s/iter; left time: 149.2144s
	iters: 500, epoch: 5 | loss: 0.7279151
	speed: 0.0233s/iter; left time: 145.8687s
	iters: 600, epoch: 5 | loss: 0.6237733
	speed: 0.0231s/iter; left time: 142.7806s
	iters: 700, epoch: 5 | loss: 0.7350668
	speed: 0.0231s/iter; left time: 140.0718s
	iters: 800, epoch: 5 | loss: 0.7097635
	speed: 0.0230s/iter; left time: 137.4798s
	iters: 900, epoch: 5 | loss: 0.7135674
	speed: 0.0228s/iter; left time: 133.5849s
	iters: 1000, epoch: 5 | loss: 0.6544584
	speed: 0.0233s/iter; left time: 134.1929s
	iters: 1100, epoch: 5 | loss: 0.9224322
	speed: 0.0241s/iter; left time: 136.5211s
Epoch: 5 cost time: 27.603820323944092
Epoch: 5, Steps: 1128 | Train Loss: 0.6979195 Vali Loss: 0.7590193 Test Loss: 0.3646860
Validation loss decreased (0.759248 --> 0.759019).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.7356326
	speed: 0.0364s/iter; left time: 201.6682s
	iters: 200, epoch: 6 | loss: 0.7836958
	speed: 0.0295s/iter; left time: 160.4830s
	iters: 300, epoch: 6 | loss: 0.7539811
	speed: 0.0273s/iter; left time: 145.9958s
	iters: 400, epoch: 6 | loss: 0.7804042
	speed: 0.0261s/iter; left time: 136.6515s
	iters: 500, epoch: 6 | loss: 0.5626405
	speed: 0.0258s/iter; left time: 132.6484s
	iters: 600, epoch: 6 | loss: 0.5431734
	speed: 0.0253s/iter; left time: 127.4016s
	iters: 700, epoch: 6 | loss: 0.5993172
	speed: 0.0245s/iter; left time: 120.8474s
	iters: 800, epoch: 6 | loss: 0.7165110
	speed: 0.0239s/iter; left time: 115.6096s
	iters: 900, epoch: 6 | loss: 0.6564045
	speed: 0.0233s/iter; left time: 110.3531s
	iters: 1000, epoch: 6 | loss: 0.6502100
	speed: 0.0228s/iter; left time: 105.9076s
	iters: 1100, epoch: 6 | loss: 0.9200172
	speed: 0.0225s/iter; left time: 101.9548s
Epoch: 6 cost time: 25.376685857772827
Epoch: 6, Steps: 1128 | Train Loss: 0.6948661 Vali Loss: 0.7524941 Test Loss: 0.3635881
Validation loss decreased (0.759019 --> 0.752494).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.7337353
	speed: 0.0251s/iter; left time: 110.9315s
	iters: 200, epoch: 7 | loss: 0.6192589
	speed: 0.0206s/iter; left time: 88.9617s
	iters: 300, epoch: 7 | loss: 0.8023444
	speed: 0.0193s/iter; left time: 81.4915s
	iters: 400, epoch: 7 | loss: 0.6246525
	speed: 0.0190s/iter; left time: 78.0983s
	iters: 500, epoch: 7 | loss: 0.7351797
	speed: 0.0180s/iter; left time: 72.2885s
	iters: 600, epoch: 7 | loss: 0.8370697
	speed: 0.0179s/iter; left time: 70.0494s
	iters: 700, epoch: 7 | loss: 0.5377739
	speed: 0.0179s/iter; left time: 68.3806s
	iters: 800, epoch: 7 | loss: 0.6468376
	speed: 0.0176s/iter; left time: 65.3364s
	iters: 900, epoch: 7 | loss: 0.7076749
	speed: 0.0174s/iter; left time: 62.9892s
	iters: 1000, epoch: 7 | loss: 0.6472713
	speed: 0.0174s/iter; left time: 61.2401s
	iters: 1100, epoch: 7 | loss: 0.7224005
	speed: 0.0172s/iter; left time: 58.6797s
Epoch: 7 cost time: 19.621492624282837
Epoch: 7, Steps: 1128 | Train Loss: 0.6929787 Vali Loss: 0.7535306 Test Loss: 0.3633816
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.6299558
	speed: 0.0345s/iter; left time: 113.2216s
	iters: 200, epoch: 8 | loss: 0.6265838
	speed: 0.0311s/iter; left time: 99.1102s
	iters: 300, epoch: 8 | loss: 0.8980914
	speed: 0.0289s/iter; left time: 89.2521s
	iters: 400, epoch: 8 | loss: 0.6643140
	speed: 0.0306s/iter; left time: 91.4092s
	iters: 500, epoch: 8 | loss: 0.6390062
	speed: 0.0321s/iter; left time: 92.6784s
	iters: 600, epoch: 8 | loss: 0.6501433
	speed: 0.0324s/iter; left time: 90.1892s
	iters: 700, epoch: 8 | loss: 0.6860684
	speed: 0.0310s/iter; left time: 83.1941s
	iters: 800, epoch: 8 | loss: 0.8589467
	speed: 0.0305s/iter; left time: 78.7526s
	iters: 900, epoch: 8 | loss: 0.5770286
	speed: 0.0308s/iter; left time: 76.5506s
	iters: 1000, epoch: 8 | loss: 0.5801603
	speed: 0.0307s/iter; left time: 73.2829s
	iters: 1100, epoch: 8 | loss: 0.5757155
	speed: 0.0302s/iter; left time: 68.9858s
Epoch: 8 cost time: 33.897300243377686
Epoch: 8, Steps: 1128 | Train Loss: 0.6920449 Vali Loss: 0.7497454 Test Loss: 0.3629799
Validation loss decreased (0.752494 --> 0.749745).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.7590253
	speed: 0.0246s/iter; left time: 52.9635s
	iters: 200, epoch: 9 | loss: 0.6885373
	speed: 0.0229s/iter; left time: 47.0460s
	iters: 300, epoch: 9 | loss: 0.7167857
	speed: 0.0220s/iter; left time: 43.0010s
	iters: 400, epoch: 9 | loss: 0.6142031
	speed: 0.0226s/iter; left time: 41.8931s
	iters: 500, epoch: 9 | loss: 0.5785297
	speed: 0.0232s/iter; left time: 40.7277s
	iters: 600, epoch: 9 | loss: 0.7601578
	speed: 0.0229s/iter; left time: 37.9076s
	iters: 700, epoch: 9 | loss: 0.6215712
	speed: 0.0227s/iter; left time: 35.3450s
	iters: 800, epoch: 9 | loss: 0.6350451
	speed: 0.0227s/iter; left time: 33.0667s
	iters: 900, epoch: 9 | loss: 0.5529198
	speed: 0.0229s/iter; left time: 31.1093s
	iters: 1000, epoch: 9 | loss: 0.6483210
	speed: 0.0228s/iter; left time: 28.7178s
	iters: 1100, epoch: 9 | loss: 0.6417526
	speed: 0.0227s/iter; left time: 26.2918s
Epoch: 9 cost time: 25.713252544403076
Epoch: 9, Steps: 1128 | Train Loss: 0.6914183 Vali Loss: 0.7481008 Test Loss: 0.3626516
Validation loss decreased (0.749745 --> 0.748101).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.7203817
	speed: 0.0304s/iter; left time: 31.2659s
	iters: 200, epoch: 10 | loss: 0.5499310
	speed: 0.0235s/iter; left time: 21.7944s
	iters: 300, epoch: 10 | loss: 0.7538977
	speed: 0.0225s/iter; left time: 18.6134s
	iters: 400, epoch: 10 | loss: 0.7062727
	speed: 0.0241s/iter; left time: 17.5370s
	iters: 500, epoch: 10 | loss: 0.8809142
	speed: 0.0239s/iter; left time: 15.0550s
	iters: 600, epoch: 10 | loss: 0.6275436
	speed: 0.0228s/iter; left time: 12.0872s
	iters: 700, epoch: 10 | loss: 1.2548224
	speed: 0.0223s/iter; left time: 9.5549s
	iters: 800, epoch: 10 | loss: 0.6846071
	speed: 0.0225s/iter; left time: 7.4154s
	iters: 900, epoch: 10 | loss: 0.8111368
	speed: 0.0225s/iter; left time: 5.1419s
	iters: 1000, epoch: 10 | loss: 0.5286241
	speed: 0.0225s/iter; left time: 2.9005s
	iters: 1100, epoch: 10 | loss: 0.7107613
	speed: 0.0226s/iter; left time: 0.6564s
Epoch: 10 cost time: 25.70535922050476
Epoch: 10, Steps: 1128 | Train Loss: 0.6913430 Vali Loss: 0.7515438 Test Loss: 0.3628721
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.36265140771865845, mae:0.3525845408439636
Use GPU: cuda:0
no_skip True
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.8797175
	speed: 0.0280s/iter; left time: 313.2807s
	iters: 200, epoch: 1 | loss: 0.6643909
	speed: 0.0264s/iter; left time: 292.4722s
	iters: 300, epoch: 1 | loss: 1.1096587
	speed: 0.0255s/iter; left time: 279.9283s
	iters: 400, epoch: 1 | loss: 0.6086494
	speed: 0.0245s/iter; left time: 266.4505s
	iters: 500, epoch: 1 | loss: 0.7734790
	speed: 0.0240s/iter; left time: 258.6586s
	iters: 600, epoch: 1 | loss: 0.7119755
	speed: 0.0235s/iter; left time: 251.0157s
	iters: 700, epoch: 1 | loss: 0.7550699
	speed: 0.0231s/iter; left time: 244.6368s
	iters: 800, epoch: 1 | loss: 1.0052965
	speed: 0.0238s/iter; left time: 249.9303s
	iters: 900, epoch: 1 | loss: 0.6107661
	speed: 0.0241s/iter; left time: 250.4560s
	iters: 1000, epoch: 1 | loss: 0.9686711
	speed: 0.0245s/iter; left time: 252.2798s
	iters: 1100, epoch: 1 | loss: 0.6990765
	speed: 0.0245s/iter; left time: 249.0774s
Epoch: 1 cost time: 27.712588787078857
Epoch: 1, Steps: 1128 | Train Loss: 0.7751358 Vali Loss: 0.8014320 Test Loss: 0.3738146
Validation loss decreased (inf --> 0.801432).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6838517
	speed: 0.0411s/iter; left time: 413.1357s
	iters: 200, epoch: 2 | loss: 0.6007155
	speed: 0.0362s/iter; left time: 360.1680s
	iters: 300, epoch: 2 | loss: 0.7842612
	speed: 0.0325s/iter; left time: 320.2090s
	iters: 400, epoch: 2 | loss: 0.6107951
	speed: 0.0300s/iter; left time: 292.1691s
	iters: 500, epoch: 2 | loss: 0.6504641
	speed: 0.0282s/iter; left time: 271.8678s
	iters: 600, epoch: 2 | loss: 0.6865196
	speed: 0.0272s/iter; left time: 259.6919s
	iters: 700, epoch: 2 | loss: 0.6382796
	speed: 0.0261s/iter; left time: 246.8742s
	iters: 800, epoch: 2 | loss: 0.7891528
	speed: 0.0252s/iter; left time: 236.1292s
	iters: 900, epoch: 2 | loss: 0.7873405
	speed: 0.0249s/iter; left time: 230.4470s
	iters: 1000, epoch: 2 | loss: 0.7044684
	speed: 0.0246s/iter; left time: 225.5785s
	iters: 1100, epoch: 2 | loss: 0.8013898
	speed: 0.0244s/iter; left time: 221.2034s
Epoch: 2 cost time: 27.549569606781006
Epoch: 2, Steps: 1128 | Train Loss: 0.7203263 Vali Loss: 0.7586191 Test Loss: 0.3664067
Validation loss decreased (0.801432 --> 0.758619).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6292354
	speed: 0.0234s/iter; left time: 209.2387s
	iters: 200, epoch: 3 | loss: 0.6163664
	speed: 0.0205s/iter; left time: 180.4756s
	iters: 300, epoch: 3 | loss: 0.5925433
	speed: 0.0209s/iter; left time: 182.3947s
	iters: 400, epoch: 3 | loss: 0.9620048
	speed: 0.0206s/iter; left time: 177.5016s
	iters: 500, epoch: 3 | loss: 0.6275700
	speed: 0.0207s/iter; left time: 176.7054s
	iters: 600, epoch: 3 | loss: 0.5850803
	speed: 0.0204s/iter; left time: 172.0170s
	iters: 700, epoch: 3 | loss: 0.6141665
	speed: 0.0217s/iter; left time: 180.3668s
	iters: 800, epoch: 3 | loss: 0.6088282
	speed: 0.0218s/iter; left time: 179.1496s
	iters: 900, epoch: 3 | loss: 0.7949048
	speed: 0.0217s/iter; left time: 176.3400s
	iters: 1000, epoch: 3 | loss: 0.6270596
	speed: 0.0219s/iter; left time: 175.5648s
	iters: 1100, epoch: 3 | loss: 0.7102935
	speed: 0.0219s/iter; left time: 173.3267s
Epoch: 3 cost time: 24.806180715560913
Epoch: 3, Steps: 1128 | Train Loss: 0.6965416 Vali Loss: 0.7420931 Test Loss: 0.3622901
Validation loss decreased (0.758619 --> 0.742093).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6901368
	speed: 0.0281s/iter; left time: 219.2599s
	iters: 200, epoch: 4 | loss: 0.6319997
	speed: 0.0252s/iter; left time: 194.2495s
	iters: 300, epoch: 4 | loss: 0.5234464
	speed: 0.0243s/iter; left time: 184.7360s
	iters: 400, epoch: 4 | loss: 0.7308154
	speed: 0.0241s/iter; left time: 180.4312s
	iters: 500, epoch: 4 | loss: 0.5261140
	speed: 0.0242s/iter; left time: 178.7781s
	iters: 600, epoch: 4 | loss: 0.6199224
	speed: 0.0242s/iter; left time: 176.7215s
	iters: 700, epoch: 4 | loss: 0.7086383
	speed: 0.0241s/iter; left time: 173.7945s
	iters: 800, epoch: 4 | loss: 0.7077074
	speed: 0.0239s/iter; left time: 169.5508s
	iters: 900, epoch: 4 | loss: 0.8849276
	speed: 0.0237s/iter; left time: 165.8060s
	iters: 1000, epoch: 4 | loss: 0.5835837
	speed: 0.0235s/iter; left time: 162.3146s
	iters: 1100, epoch: 4 | loss: 0.6716002
	speed: 0.0237s/iter; left time: 161.2950s
Epoch: 4 cost time: 26.8628933429718
Epoch: 4, Steps: 1128 | Train Loss: 0.6873664 Vali Loss: 0.7308444 Test Loss: 0.3600711
Validation loss decreased (0.742093 --> 0.730844).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.7345600
	speed: 0.0290s/iter; left time: 193.2480s
	iters: 200, epoch: 5 | loss: 0.6937209
	speed: 0.0258s/iter; left time: 169.6207s
	iters: 300, epoch: 5 | loss: 0.5102589
	speed: 0.0243s/iter; left time: 157.1439s
	iters: 400, epoch: 5 | loss: 0.6688322
	speed: 0.0255s/iter; left time: 162.7050s
	iters: 500, epoch: 5 | loss: 0.7780477
	speed: 0.0268s/iter; left time: 168.0084s
	iters: 600, epoch: 5 | loss: 0.6285220
	speed: 0.0263s/iter; left time: 162.3443s
	iters: 700, epoch: 5 | loss: 0.4910102
	speed: 0.0260s/iter; left time: 157.7967s
	iters: 800, epoch: 5 | loss: 0.6316220
	speed: 0.0256s/iter; left time: 152.8559s
	iters: 900, epoch: 5 | loss: 0.5949005
	speed: 0.0253s/iter; left time: 148.4112s
	iters: 1000, epoch: 5 | loss: 0.5886843
	speed: 0.0249s/iter; left time: 143.7945s
	iters: 1100, epoch: 5 | loss: 0.7077426
	speed: 0.0247s/iter; left time: 139.7491s
Epoch: 5 cost time: 27.851430654525757
Epoch: 5, Steps: 1128 | Train Loss: 0.6819147 Vali Loss: 0.7311631 Test Loss: 0.3607870
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6970652
	speed: 0.0361s/iter; left time: 199.8870s
	iters: 200, epoch: 6 | loss: 0.6171858
	speed: 0.0300s/iter; left time: 163.1325s
	iters: 300, epoch: 6 | loss: 0.9083381
	speed: 0.0260s/iter; left time: 138.7260s
	iters: 400, epoch: 6 | loss: 0.6621032
	speed: 0.0234s/iter; left time: 122.8297s
	iters: 500, epoch: 6 | loss: 0.5651009
	speed: 0.0221s/iter; left time: 113.6621s
	iters: 600, epoch: 6 | loss: 0.5653775
	speed: 0.0213s/iter; left time: 107.2794s
	iters: 700, epoch: 6 | loss: 0.7007004
	speed: 0.0206s/iter; left time: 101.6665s
	iters: 800, epoch: 6 | loss: 0.6746068
	speed: 0.0207s/iter; left time: 100.0888s
	iters: 900, epoch: 6 | loss: 0.9278632
	speed: 0.0210s/iter; left time: 99.6398s
	iters: 1000, epoch: 6 | loss: 0.9507367
	speed: 0.0213s/iter; left time: 98.8601s
	iters: 1100, epoch: 6 | loss: 0.8665218
	speed: 0.0215s/iter; left time: 97.8380s
Epoch: 6 cost time: 24.500717878341675
Epoch: 6, Steps: 1128 | Train Loss: 0.6787353 Vali Loss: 0.7273105 Test Loss: 0.3605965
Validation loss decreased (0.730844 --> 0.727310).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5958732
	speed: 0.0249s/iter; left time: 110.0124s
	iters: 200, epoch: 7 | loss: 0.7337482
	speed: 0.0234s/iter; left time: 100.9157s
	iters: 300, epoch: 7 | loss: 0.7564446
	speed: 0.0222s/iter; left time: 93.3350s
	iters: 400, epoch: 7 | loss: 0.7822021
	speed: 0.0219s/iter; left time: 90.0677s
	iters: 500, epoch: 7 | loss: 0.6647012
	speed: 0.0220s/iter; left time: 88.1887s
	iters: 600, epoch: 7 | loss: 0.6094187
	speed: 0.0220s/iter; left time: 86.1422s
	iters: 700, epoch: 7 | loss: 0.6025798
	speed: 0.0219s/iter; left time: 83.6219s
	iters: 800, epoch: 7 | loss: 0.6478472
	speed: 0.0220s/iter; left time: 81.7368s
	iters: 900, epoch: 7 | loss: 0.7738583
	speed: 0.0220s/iter; left time: 79.6033s
	iters: 1000, epoch: 7 | loss: 0.6313598
	speed: 0.0222s/iter; left time: 78.0231s
	iters: 1100, epoch: 7 | loss: 0.7766599
	speed: 0.0222s/iter; left time: 75.8712s
Epoch: 7 cost time: 25.206897735595703
Epoch: 7, Steps: 1128 | Train Loss: 0.6776293 Vali Loss: 0.7272693 Test Loss: 0.3607838
Validation loss decreased (0.727310 --> 0.727269).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.5642650
	speed: 0.0424s/iter; left time: 139.3578s
	iters: 200, epoch: 8 | loss: 0.5802620
	speed: 0.0374s/iter; left time: 119.0612s
	iters: 300, epoch: 8 | loss: 0.6830325
	speed: 0.0323s/iter; left time: 99.5272s
	iters: 400, epoch: 8 | loss: 0.6014745
	speed: 0.0299s/iter; left time: 89.1478s
	iters: 500, epoch: 8 | loss: 0.7364470
	speed: 0.0280s/iter; left time: 80.8812s
	iters: 600, epoch: 8 | loss: 0.5698895
	speed: 0.0266s/iter; left time: 74.0514s
	iters: 700, epoch: 8 | loss: 0.6825659
	speed: 0.0266s/iter; left time: 71.5363s
	iters: 800, epoch: 8 | loss: 0.7464263
	speed: 0.0263s/iter; left time: 67.9620s
	iters: 900, epoch: 8 | loss: 0.4978839
	speed: 0.0259s/iter; left time: 64.4254s
	iters: 1000, epoch: 8 | loss: 0.5313382
	speed: 0.0258s/iter; left time: 61.4194s
	iters: 1100, epoch: 8 | loss: 0.6485612
	speed: 0.0256s/iter; left time: 58.4119s
Epoch: 8 cost time: 28.874024868011475
Epoch: 8, Steps: 1128 | Train Loss: 0.6766500 Vali Loss: 0.7285463 Test Loss: 0.3606006
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.6401004
	speed: 0.0325s/iter; left time: 70.0669s
	iters: 200, epoch: 9 | loss: 0.7098910
	speed: 0.0285s/iter; left time: 58.5723s
	iters: 300, epoch: 9 | loss: 0.6051766
	speed: 0.0271s/iter; left time: 53.1074s
	iters: 400, epoch: 9 | loss: 0.6544411
	speed: 0.0265s/iter; left time: 49.1242s
	iters: 500, epoch: 9 | loss: 0.5597345
	speed: 0.0261s/iter; left time: 45.8395s
	iters: 600, epoch: 9 | loss: 0.6987551
	speed: 0.0252s/iter; left time: 41.7954s
	iters: 700, epoch: 9 | loss: 0.6107670
	speed: 0.0243s/iter; left time: 37.8363s
	iters: 800, epoch: 9 | loss: 0.5244868
	speed: 0.0236s/iter; left time: 34.4053s
	iters: 900, epoch: 9 | loss: 0.5688307
	speed: 0.0231s/iter; left time: 31.3436s
	iters: 1000, epoch: 9 | loss: 0.6240559
	speed: 0.0227s/iter; left time: 28.5393s
	iters: 1100, epoch: 9 | loss: 0.7132401
	speed: 0.0222s/iter; left time: 25.7133s
Epoch: 9 cost time: 25.03699827194214
Epoch: 9, Steps: 1128 | Train Loss: 0.6762511 Vali Loss: 0.7293968 Test Loss: 0.3608346
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.7687443
	speed: 0.0371s/iter; left time: 38.2178s
	iters: 200, epoch: 10 | loss: 0.7269849
	speed: 0.0310s/iter; left time: 28.8100s
	iters: 300, epoch: 10 | loss: 0.7979084
	speed: 0.0289s/iter; left time: 23.9722s
	iters: 400, epoch: 10 | loss: 0.6379638
	speed: 0.0279s/iter; left time: 20.3618s
	iters: 500, epoch: 10 | loss: 0.9636908
	speed: 0.0274s/iter; left time: 17.2068s
	iters: 600, epoch: 10 | loss: 0.7080905
	speed: 0.0270s/iter; left time: 14.2740s
	iters: 700, epoch: 10 | loss: 0.7884743
	speed: 0.0266s/iter; left time: 11.4021s
	iters: 800, epoch: 10 | loss: 0.6802419
	speed: 0.0261s/iter; left time: 8.6014s
	iters: 900, epoch: 10 | loss: 0.9501053
	speed: 0.0257s/iter; left time: 5.8823s
	iters: 1000, epoch: 10 | loss: 0.6309232
	speed: 0.0254s/iter; left time: 3.2758s
	iters: 1100, epoch: 10 | loss: 0.5568784
	speed: 0.0252s/iter; left time: 0.7317s
Epoch: 10 cost time: 28.52108144760132
Epoch: 10, Steps: 1128 | Train Loss: 0.6763428 Vali Loss: 0.7271404 Test Loss: 0.3608517
Validation loss decreased (0.727269 --> 0.727140).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.36085182428359985, mae:0.3515993058681488
Seed: 123
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_96       Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip True
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 1.0795139
	speed: 0.0372s/iter; left time: 423.4430s
	iters: 200, epoch: 1 | loss: 0.4232261
	speed: 0.0308s/iter; left time: 346.9495s
	iters: 300, epoch: 1 | loss: 0.6122697
	speed: 0.0281s/iter; left time: 314.0964s
	iters: 400, epoch: 1 | loss: 0.3594837
	speed: 0.0265s/iter; left time: 293.1250s
	iters: 500, epoch: 1 | loss: 0.7236156
	speed: 0.0257s/iter; left time: 281.5089s
	iters: 600, epoch: 1 | loss: 0.5498516
	speed: 0.0249s/iter; left time: 270.6948s
	iters: 700, epoch: 1 | loss: 0.4238197
	speed: 0.0240s/iter; left time: 258.9968s
	iters: 800, epoch: 1 | loss: 0.4127215
	speed: 0.0243s/iter; left time: 259.4431s
	iters: 900, epoch: 1 | loss: 0.3443922
	speed: 0.0244s/iter; left time: 257.4846s
	iters: 1000, epoch: 1 | loss: 0.3715180
	speed: 0.0244s/iter; left time: 255.2480s
	iters: 1100, epoch: 1 | loss: 1.3939160
	speed: 0.0244s/iter; left time: 252.7752s
Epoch: 1 cost time: 28.06692671775818
Epoch: 1, Steps: 1147 | Train Loss: 0.5401373 Vali Loss: 0.4897093 Test Loss: 0.1974103
Validation loss decreased (inf --> 0.489709).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4258399
	speed: 0.0205s/iter; left time: 209.2955s
	iters: 200, epoch: 2 | loss: 0.3893080
	speed: 0.0191s/iter; left time: 193.6697s
	iters: 300, epoch: 2 | loss: 1.2700380
	speed: 0.0187s/iter; left time: 187.6895s
	iters: 400, epoch: 2 | loss: 0.4637148
	speed: 0.0185s/iter; left time: 183.8974s
	iters: 500, epoch: 2 | loss: 0.3737185
	speed: 0.0183s/iter; left time: 179.8766s
	iters: 600, epoch: 2 | loss: 0.4218733
	speed: 0.0188s/iter; left time: 182.7863s
	iters: 700, epoch: 2 | loss: 0.3572442
	speed: 0.0191s/iter; left time: 183.9274s
	iters: 800, epoch: 2 | loss: 0.3304344
	speed: 0.0191s/iter; left time: 181.5813s
	iters: 900, epoch: 2 | loss: 0.5246123
	speed: 0.0190s/iter; left time: 179.0585s
	iters: 1000, epoch: 2 | loss: 0.5146037
	speed: 0.0193s/iter; left time: 180.0405s
	iters: 1100, epoch: 2 | loss: 1.3000230
	speed: 0.0198s/iter; left time: 182.5145s
Epoch: 2 cost time: 23.05166721343994
Epoch: 2, Steps: 1147 | Train Loss: 0.4841084 Vali Loss: 0.4842262 Test Loss: 0.2002897
Validation loss decreased (0.489709 --> 0.484226).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2909147
	speed: 0.0273s/iter; left time: 247.9980s
	iters: 200, epoch: 3 | loss: 0.3740163
	speed: 0.0269s/iter; left time: 241.6698s
	iters: 300, epoch: 3 | loss: 0.6375661
	speed: 0.0285s/iter; left time: 253.3122s
	iters: 400, epoch: 3 | loss: 0.2905508
	speed: 0.0275s/iter; left time: 241.2110s
	iters: 500, epoch: 3 | loss: 0.5037972
	speed: 0.0266s/iter; left time: 230.3913s
	iters: 600, epoch: 3 | loss: 0.2897058
	speed: 0.0259s/iter; left time: 222.0400s
	iters: 700, epoch: 3 | loss: 0.4279424
	speed: 0.0255s/iter; left time: 215.8287s
	iters: 800, epoch: 3 | loss: 0.5609324
	speed: 0.0247s/iter; left time: 206.5979s
	iters: 900, epoch: 3 | loss: 0.4920805
	speed: 0.0243s/iter; left time: 200.9297s
	iters: 1000, epoch: 3 | loss: 0.4621441
	speed: 0.0241s/iter; left time: 197.1097s
	iters: 1100, epoch: 3 | loss: 1.2058920
	speed: 0.0242s/iter; left time: 195.8028s
Epoch: 3 cost time: 27.951478958129883
Epoch: 3, Steps: 1147 | Train Loss: 0.4590340 Vali Loss: 0.4524551 Test Loss: 0.1834597
Validation loss decreased (0.484226 --> 0.452455).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3556075
	speed: 0.0282s/iter; left time: 223.5341s
	iters: 200, epoch: 4 | loss: 0.3625813
	speed: 0.0256s/iter; left time: 200.0973s
	iters: 300, epoch: 4 | loss: 0.3771391
	speed: 0.0246s/iter; left time: 190.3007s
	iters: 400, epoch: 4 | loss: 0.3794929
	speed: 0.0239s/iter; left time: 182.6974s
	iters: 500, epoch: 4 | loss: 1.3100827
	speed: 0.0233s/iter; left time: 175.7338s
	iters: 600, epoch: 4 | loss: 0.3531606
	speed: 0.0228s/iter; left time: 169.2383s
	iters: 700, epoch: 4 | loss: 0.4092864
	speed: 0.0225s/iter; left time: 164.7810s
	iters: 800, epoch: 4 | loss: 0.3074434
	speed: 0.0220s/iter; left time: 159.3921s
	iters: 900, epoch: 4 | loss: 0.3173396
	speed: 0.0218s/iter; left time: 155.5646s
	iters: 1000, epoch: 4 | loss: 0.3320202
	speed: 0.0216s/iter; left time: 152.0113s
	iters: 1100, epoch: 4 | loss: 0.3541889
	speed: 0.0215s/iter; left time: 149.1591s
Epoch: 4 cost time: 24.717294216156006
Epoch: 4, Steps: 1147 | Train Loss: 0.4458549 Vali Loss: 0.4314920 Test Loss: 0.1806930
Validation loss decreased (0.452455 --> 0.431492).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.7289122
	speed: 0.0397s/iter; left time: 269.0260s
	iters: 200, epoch: 5 | loss: 0.2768673
	speed: 0.0325s/iter; left time: 217.1792s
	iters: 300, epoch: 5 | loss: 0.3035317
	speed: 0.0283s/iter; left time: 186.3148s
	iters: 400, epoch: 5 | loss: 0.6257485
	speed: 0.0256s/iter; left time: 166.1598s
	iters: 500, epoch: 5 | loss: 0.2835234
	speed: 0.0238s/iter; left time: 151.7354s
	iters: 600, epoch: 5 | loss: 0.2274793
	speed: 0.0228s/iter; left time: 143.2348s
	iters: 700, epoch: 5 | loss: 0.3117883
	speed: 0.0221s/iter; left time: 136.6368s
	iters: 800, epoch: 5 | loss: 0.3044351
	speed: 0.0216s/iter; left time: 131.6328s
	iters: 900, epoch: 5 | loss: 0.4597523
	speed: 0.0208s/iter; left time: 124.6784s
	iters: 1000, epoch: 5 | loss: 0.4833730
	speed: 0.0200s/iter; left time: 117.8283s
	iters: 1100, epoch: 5 | loss: 0.3371518
	speed: 0.0192s/iter; left time: 111.1702s
Epoch: 5 cost time: 21.82659411430359
Epoch: 5, Steps: 1147 | Train Loss: 0.4385455 Vali Loss: 0.4297766 Test Loss: 0.1795012
Validation loss decreased (0.431492 --> 0.429777).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2809713
	speed: 0.0421s/iter; left time: 237.0595s
	iters: 200, epoch: 6 | loss: 0.3047572
	speed: 0.0416s/iter; left time: 230.0231s
	iters: 300, epoch: 6 | loss: 0.4696356
	speed: 0.0415s/iter; left time: 225.5426s
	iters: 400, epoch: 6 | loss: 0.4197294
	speed: 0.0406s/iter; left time: 216.5279s
	iters: 500, epoch: 6 | loss: 0.4173656
	speed: 0.0392s/iter; left time: 205.2872s
	iters: 600, epoch: 6 | loss: 0.2980037
	speed: 0.0383s/iter; left time: 196.9540s
	iters: 700, epoch: 6 | loss: 0.3393549
	speed: 0.0355s/iter; left time: 178.8082s
	iters: 800, epoch: 6 | loss: 0.2818830
	speed: 0.0336s/iter; left time: 165.7561s
	iters: 900, epoch: 6 | loss: 0.4513229
	speed: 0.0317s/iter; left time: 153.1911s
	iters: 1000, epoch: 6 | loss: 0.2640335
	speed: 0.0306s/iter; left time: 145.0070s
	iters: 1100, epoch: 6 | loss: 0.4176400
	speed: 0.0298s/iter; left time: 137.9504s
Epoch: 6 cost time: 33.850513219833374
Epoch: 6, Steps: 1147 | Train Loss: 0.4345075 Vali Loss: 0.4278724 Test Loss: 0.1791355
Validation loss decreased (0.429777 --> 0.427872).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4236871
	speed: 0.0423s/iter; left time: 189.7504s
	iters: 200, epoch: 7 | loss: 0.6691260
	speed: 0.0403s/iter; left time: 177.0595s
	iters: 300, epoch: 7 | loss: 0.2584819
	speed: 0.0392s/iter; left time: 168.3106s
	iters: 400, epoch: 7 | loss: 0.2813869
	speed: 0.0381s/iter; left time: 159.7987s
	iters: 500, epoch: 7 | loss: 0.3229057
	speed: 0.0344s/iter; left time: 140.4778s
	iters: 600, epoch: 7 | loss: 0.6053525
	speed: 0.0316s/iter; left time: 125.9272s
	iters: 700, epoch: 7 | loss: 0.2866032
	speed: 0.0295s/iter; left time: 114.5748s
	iters: 800, epoch: 7 | loss: 0.2841974
	speed: 0.0283s/iter; left time: 107.2672s
	iters: 900, epoch: 7 | loss: 0.3781417
	speed: 0.0275s/iter; left time: 101.5972s
	iters: 1000, epoch: 7 | loss: 0.5280757
	speed: 0.0273s/iter; left time: 97.8012s
	iters: 1100, epoch: 7 | loss: 0.4938929
	speed: 0.0271s/iter; left time: 94.3870s
Epoch: 7 cost time: 31.065318822860718
Epoch: 7, Steps: 1147 | Train Loss: 0.4327492 Vali Loss: 0.4262972 Test Loss: 0.1792412
Validation loss decreased (0.427872 --> 0.426297).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.5486927
	speed: 0.0425s/iter; left time: 141.9094s
	iters: 200, epoch: 8 | loss: 0.3996190
	speed: 0.0370s/iter; left time: 119.9884s
	iters: 300, epoch: 8 | loss: 0.3767167
	speed: 0.0329s/iter; left time: 103.3216s
	iters: 400, epoch: 8 | loss: 0.2985391
	speed: 0.0307s/iter; left time: 93.5149s
	iters: 500, epoch: 8 | loss: 0.6003801
	speed: 0.0280s/iter; left time: 82.4461s
	iters: 600, epoch: 8 | loss: 0.3861226
	speed: 0.0260s/iter; left time: 73.7526s
	iters: 700, epoch: 8 | loss: 0.3380342
	speed: 0.0239s/iter; left time: 65.4870s
	iters: 800, epoch: 8 | loss: 0.2746422
	speed: 0.0223s/iter; left time: 58.9434s
	iters: 900, epoch: 8 | loss: 0.2598404
	speed: 0.0211s/iter; left time: 53.5669s
	iters: 1000, epoch: 8 | loss: 0.4054987
	speed: 0.0201s/iter; left time: 49.1493s
	iters: 1100, epoch: 8 | loss: 0.3466554
	speed: 0.0196s/iter; left time: 45.8774s
Epoch: 8 cost time: 23.003958225250244
Epoch: 8, Steps: 1147 | Train Loss: 0.4314896 Vali Loss: 0.4280094 Test Loss: 0.1795751
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3513953
	speed: 0.0450s/iter; left time: 98.7240s
	iters: 200, epoch: 9 | loss: 0.3127404
	speed: 0.0441s/iter; left time: 92.3770s
	iters: 300, epoch: 9 | loss: 0.2787396
	speed: 0.0402s/iter; left time: 80.2411s
	iters: 400, epoch: 9 | loss: 0.3123244
	speed: 0.0350s/iter; left time: 66.2626s
	iters: 500, epoch: 9 | loss: 0.3169011
	speed: 0.0317s/iter; left time: 56.9085s
	iters: 600, epoch: 9 | loss: 0.5812723
	speed: 0.0294s/iter; left time: 49.8568s
	iters: 700, epoch: 9 | loss: 0.5298978
	speed: 0.0276s/iter; left time: 43.9853s
	iters: 800, epoch: 9 | loss: 0.3423130
	speed: 0.0264s/iter; left time: 39.4640s
	iters: 900, epoch: 9 | loss: 0.3416710
	speed: 0.0261s/iter; left time: 36.3741s
	iters: 1000, epoch: 9 | loss: 0.3332138
	speed: 0.0271s/iter; left time: 35.1210s
	iters: 1100, epoch: 9 | loss: 0.2771379
	speed: 0.0281s/iter; left time: 33.5698s
Epoch: 9 cost time: 32.81961107254028
Epoch: 9, Steps: 1147 | Train Loss: 0.4313238 Vali Loss: 0.4280353 Test Loss: 0.1791501
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.4720281
	speed: 0.0419s/iter; left time: 43.9626s
	iters: 200, epoch: 10 | loss: 0.2986670
	speed: 0.0391s/iter; left time: 37.0496s
	iters: 300, epoch: 10 | loss: 0.6415944
	speed: 0.0316s/iter; left time: 26.7956s
	iters: 400, epoch: 10 | loss: 0.3094968
	speed: 0.0280s/iter; left time: 20.9598s
	iters: 500, epoch: 10 | loss: 1.2429261
	speed: 0.0259s/iter; left time: 16.7619s
	iters: 600, epoch: 10 | loss: 0.3773777
	speed: 0.0245s/iter; left time: 13.4385s
	iters: 700, epoch: 10 | loss: 1.2482785
	speed: 0.0251s/iter; left time: 11.2589s
	iters: 800, epoch: 10 | loss: 0.5098159
	speed: 0.0265s/iter; left time: 9.2335s
	iters: 900, epoch: 10 | loss: 0.2317044
	speed: 0.0276s/iter; left time: 6.8457s
	iters: 1000, epoch: 10 | loss: 0.3291979
	speed: 0.0284s/iter; left time: 4.1992s
	iters: 1100, epoch: 10 | loss: 0.3063365
	speed: 0.0290s/iter; left time: 1.3937s
Epoch: 10 cost time: 33.74985599517822
Epoch: 10, Steps: 1147 | Train Loss: 0.4308912 Vali Loss: 0.4278802 Test Loss: 0.1791159
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.1792411208152771, mae:0.220569908618927
Use GPU: cuda:0
no_skip True
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 1.3730291
	speed: 0.0216s/iter; left time: 245.5467s
	iters: 200, epoch: 1 | loss: 0.4327741
	speed: 0.0186s/iter; left time: 210.1712s
	iters: 300, epoch: 1 | loss: 0.5207131
	speed: 0.0170s/iter; left time: 190.0007s
	iters: 400, epoch: 1 | loss: 0.4508682
	speed: 0.0177s/iter; left time: 195.9889s
	iters: 500, epoch: 1 | loss: 0.5897447
	speed: 0.0187s/iter; left time: 205.2775s
	iters: 600, epoch: 1 | loss: 0.4043437
	speed: 0.0193s/iter; left time: 209.7794s
	iters: 700, epoch: 1 | loss: 0.3713137
	speed: 0.0196s/iter; left time: 211.5874s
	iters: 800, epoch: 1 | loss: 0.4139848
	speed: 0.0200s/iter; left time: 213.2559s
	iters: 900, epoch: 1 | loss: 0.5168495
	speed: 0.0205s/iter; left time: 216.5847s
	iters: 1000, epoch: 1 | loss: 0.2980348
	speed: 0.0208s/iter; left time: 218.0555s
	iters: 1100, epoch: 1 | loss: 0.4915817
	speed: 0.0211s/iter; left time: 218.7469s
Epoch: 1 cost time: 24.69761037826538
Epoch: 1, Steps: 1147 | Train Loss: 0.5436360 Vali Loss: 0.5016828 Test Loss: 0.2008087
Validation loss decreased (inf --> 0.501683).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3647569
	speed: 0.0287s/iter; left time: 293.3450s
	iters: 200, epoch: 2 | loss: 0.3311357
	speed: 0.0263s/iter; left time: 266.1013s
	iters: 300, epoch: 2 | loss: 0.4286668
	speed: 0.0273s/iter; left time: 273.8901s
	iters: 400, epoch: 2 | loss: 0.3564450
	speed: 0.0284s/iter; left time: 282.2848s
	iters: 500, epoch: 2 | loss: 0.4647667
	speed: 0.0274s/iter; left time: 269.0917s
	iters: 600, epoch: 2 | loss: 0.4496470
	speed: 0.0265s/iter; left time: 257.7168s
	iters: 700, epoch: 2 | loss: 0.4177059
	speed: 0.0258s/iter; left time: 248.7259s
	iters: 800, epoch: 2 | loss: 0.3138456
	speed: 0.0254s/iter; left time: 242.0259s
	iters: 900, epoch: 2 | loss: 0.3223313
	speed: 0.0254s/iter; left time: 239.3151s
	iters: 1000, epoch: 2 | loss: 0.3829974
	speed: 0.0257s/iter; left time: 240.0829s
	iters: 1100, epoch: 2 | loss: 0.6068406
	speed: 0.0269s/iter; left time: 248.1191s
Epoch: 2 cost time: 31.533467054367065
Epoch: 2, Steps: 1147 | Train Loss: 0.4868640 Vali Loss: 0.4800473 Test Loss: 0.1955117
Validation loss decreased (0.501683 --> 0.480047).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3460084
	speed: 0.0326s/iter; left time: 295.9710s
	iters: 200, epoch: 3 | loss: 0.3086443
	speed: 0.0276s/iter; left time: 248.2010s
	iters: 300, epoch: 3 | loss: 0.3133129
	speed: 0.0257s/iter; left time: 228.0325s
	iters: 400, epoch: 3 | loss: 0.3105741
	speed: 0.0245s/iter; left time: 214.6493s
	iters: 500, epoch: 3 | loss: 1.2912824
	speed: 0.0243s/iter; left time: 210.6546s
	iters: 600, epoch: 3 | loss: 0.3537019
	speed: 0.0257s/iter; left time: 220.4953s
	iters: 700, epoch: 3 | loss: 0.3357227
	speed: 0.0260s/iter; left time: 220.2117s
	iters: 800, epoch: 3 | loss: 0.3344260
	speed: 0.0258s/iter; left time: 216.2392s
	iters: 900, epoch: 3 | loss: 0.2692134
	speed: 0.0257s/iter; left time: 212.8753s
	iters: 1000, epoch: 3 | loss: 0.3708829
	speed: 0.0256s/iter; left time: 209.3760s
	iters: 1100, epoch: 3 | loss: 0.2630371
	speed: 0.0255s/iter; left time: 206.0488s
Epoch: 3 cost time: 29.371933221817017
Epoch: 3, Steps: 1147 | Train Loss: 0.4627696 Vali Loss: 0.4598827 Test Loss: 0.1863676
Validation loss decreased (0.480047 --> 0.459883).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4436488
	speed: 0.0291s/iter; left time: 231.1420s
	iters: 200, epoch: 4 | loss: 0.5286074
	speed: 0.0299s/iter; left time: 234.1950s
	iters: 300, epoch: 4 | loss: 1.3520433
	speed: 0.0317s/iter; left time: 244.7049s
	iters: 400, epoch: 4 | loss: 0.4757465
	speed: 0.0293s/iter; left time: 223.4454s
	iters: 500, epoch: 4 | loss: 0.4808351
	speed: 0.0279s/iter; left time: 209.9846s
	iters: 600, epoch: 4 | loss: 0.2783756
	speed: 0.0276s/iter; left time: 205.2260s
	iters: 700, epoch: 4 | loss: 0.4552130
	speed: 0.0270s/iter; left time: 197.7864s
	iters: 800, epoch: 4 | loss: 0.3603134
	speed: 0.0267s/iter; left time: 192.8004s
	iters: 900, epoch: 4 | loss: 0.3437076
	speed: 0.0265s/iter; left time: 188.7864s
	iters: 1000, epoch: 4 | loss: 0.3402993
	speed: 0.0263s/iter; left time: 184.7490s
	iters: 1100, epoch: 4 | loss: 0.4340202
	speed: 0.0259s/iter; left time: 179.4736s
Epoch: 4 cost time: 29.66169500350952
Epoch: 4, Steps: 1147 | Train Loss: 0.4504914 Vali Loss: 0.4436801 Test Loss: 0.1839558
Validation loss decreased (0.459883 --> 0.443680).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4126908
	speed: 0.0256s/iter; left time: 173.7581s
	iters: 200, epoch: 5 | loss: 0.2690095
	speed: 0.0236s/iter; left time: 157.4488s
	iters: 300, epoch: 5 | loss: 0.4851878
	speed: 0.0230s/iter; left time: 151.6532s
	iters: 400, epoch: 5 | loss: 0.3276553
	speed: 0.0228s/iter; left time: 147.8908s
	iters: 500, epoch: 5 | loss: 0.2720955
	speed: 0.0223s/iter; left time: 142.6208s
	iters: 600, epoch: 5 | loss: 0.2821385
	speed: 0.0219s/iter; left time: 137.7821s
	iters: 700, epoch: 5 | loss: 0.3360589
	speed: 0.0220s/iter; left time: 136.2751s
	iters: 800, epoch: 5 | loss: 0.2462314
	speed: 0.0221s/iter; left time: 134.4089s
	iters: 900, epoch: 5 | loss: 0.4072867
	speed: 0.0223s/iter; left time: 133.3334s
	iters: 1000, epoch: 5 | loss: 1.2717671
	speed: 0.0224s/iter; left time: 131.9751s
	iters: 1100, epoch: 5 | loss: 0.6565479
	speed: 0.0226s/iter; left time: 130.4367s
Epoch: 5 cost time: 26.04095196723938
Epoch: 5, Steps: 1147 | Train Loss: 0.4432800 Vali Loss: 0.4392433 Test Loss: 0.1827442
Validation loss decreased (0.443680 --> 0.439243).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4899231
	speed: 0.0284s/iter; left time: 159.9391s
	iters: 200, epoch: 6 | loss: 0.3737365
	speed: 0.0239s/iter; left time: 132.4630s
	iters: 300, epoch: 6 | loss: 0.4242907
	speed: 0.0248s/iter; left time: 134.8277s
	iters: 400, epoch: 6 | loss: 0.7018048
	speed: 0.0258s/iter; left time: 137.8194s
	iters: 500, epoch: 6 | loss: 0.4770605
	speed: 0.0253s/iter; left time: 132.4438s
	iters: 600, epoch: 6 | loss: 0.3797407
	speed: 0.0264s/iter; left time: 135.6395s
	iters: 700, epoch: 6 | loss: 0.2693112
	speed: 0.0262s/iter; left time: 132.1940s
	iters: 800, epoch: 6 | loss: 0.5039021
	speed: 0.0272s/iter; left time: 134.4634s
	iters: 900, epoch: 6 | loss: 1.2450169
	speed: 0.0278s/iter; left time: 134.5462s
	iters: 1000, epoch: 6 | loss: 0.3287274
	speed: 0.0273s/iter; left time: 129.4222s
	iters: 1100, epoch: 6 | loss: 0.3312420
	speed: 0.0270s/iter; left time: 125.2286s
Epoch: 6 cost time: 31.359710693359375
Epoch: 6, Steps: 1147 | Train Loss: 0.4390995 Vali Loss: 0.4385003 Test Loss: 0.1827754
Validation loss decreased (0.439243 --> 0.438500).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2589670
	speed: 0.0226s/iter; left time: 101.5332s
	iters: 200, epoch: 7 | loss: 0.3062599
	speed: 0.0283s/iter; left time: 124.0097s
	iters: 300, epoch: 7 | loss: 0.3677396
	speed: 0.0318s/iter; left time: 136.2880s
	iters: 400, epoch: 7 | loss: 0.2693689
	speed: 0.0297s/iter; left time: 124.5939s
	iters: 500, epoch: 7 | loss: 1.2783686
	speed: 0.0281s/iter; left time: 114.9355s
	iters: 600, epoch: 7 | loss: 0.2687177
	speed: 0.0272s/iter; left time: 108.6219s
	iters: 700, epoch: 7 | loss: 0.3308060
	speed: 0.0265s/iter; left time: 103.0680s
	iters: 800, epoch: 7 | loss: 0.3129365
	speed: 0.0259s/iter; left time: 98.0878s
	iters: 900, epoch: 7 | loss: 0.2306127
	speed: 0.0255s/iter; left time: 94.1449s
	iters: 1000, epoch: 7 | loss: 0.2713582
	speed: 0.0252s/iter; left time: 90.5673s
	iters: 1100, epoch: 7 | loss: 0.4183195
	speed: 0.0248s/iter; left time: 86.5920s
Epoch: 7 cost time: 28.68006157875061
Epoch: 7, Steps: 1147 | Train Loss: 0.4369309 Vali Loss: 0.4369918 Test Loss: 0.1819815
Validation loss decreased (0.438500 --> 0.436992).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2686282
	speed: 0.0296s/iter; left time: 98.9870s
	iters: 200, epoch: 8 | loss: 0.3387049
	speed: 0.0252s/iter; left time: 81.8600s
	iters: 300, epoch: 8 | loss: 0.3734178
	speed: 0.0243s/iter; left time: 76.4926s
	iters: 400, epoch: 8 | loss: 0.3057607
	speed: 0.0237s/iter; left time: 71.9555s
	iters: 500, epoch: 8 | loss: 0.2475033
	speed: 0.0231s/iter; left time: 68.0971s
	iters: 600, epoch: 8 | loss: 0.2859450
	speed: 0.0229s/iter; left time: 65.2174s
	iters: 700, epoch: 8 | loss: 0.5931751
	speed: 0.0231s/iter; left time: 63.4432s
	iters: 800, epoch: 8 | loss: 0.3166662
	speed: 0.0230s/iter; left time: 60.7749s
	iters: 900, epoch: 8 | loss: 0.5600241
	speed: 0.0229s/iter; left time: 58.1820s
	iters: 1000, epoch: 8 | loss: 0.2935561
	speed: 0.0229s/iter; left time: 55.8031s
	iters: 1100, epoch: 8 | loss: 0.3226984
	speed: 0.0228s/iter; left time: 53.4399s
Epoch: 8 cost time: 26.333235025405884
Epoch: 8, Steps: 1147 | Train Loss: 0.4359843 Vali Loss: 0.4365675 Test Loss: 0.1818272
Validation loss decreased (0.436992 --> 0.436568).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2189522
	speed: 0.0247s/iter; left time: 54.3190s
	iters: 200, epoch: 9 | loss: 0.3505729
	speed: 0.0232s/iter; left time: 48.6575s
	iters: 300, epoch: 9 | loss: 0.3076200
	speed: 0.0229s/iter; left time: 45.6502s
	iters: 400, epoch: 9 | loss: 0.3867407
	speed: 0.0233s/iter; left time: 44.1127s
	iters: 500, epoch: 9 | loss: 0.3534255
	speed: 0.0236s/iter; left time: 42.4351s
	iters: 600, epoch: 9 | loss: 0.3074833
	speed: 0.0237s/iter; left time: 40.1451s
	iters: 700, epoch: 9 | loss: 0.4768653
	speed: 0.0251s/iter; left time: 39.9946s
	iters: 800, epoch: 9 | loss: 1.3193359
	speed: 0.0247s/iter; left time: 36.9458s
	iters: 900, epoch: 9 | loss: 0.2845247
	speed: 0.0247s/iter; left time: 34.4029s
	iters: 1000, epoch: 9 | loss: 0.3063844
	speed: 0.0246s/iter; left time: 31.8078s
	iters: 1100, epoch: 9 | loss: 0.3627572
	speed: 0.0244s/iter; left time: 29.1494s
Epoch: 9 cost time: 28.032652616500854
Epoch: 9, Steps: 1147 | Train Loss: 0.4354174 Vali Loss: 0.4351609 Test Loss: 0.1813407
Validation loss decreased (0.436568 --> 0.435161).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3856128
	speed: 0.0241s/iter; left time: 25.2121s
	iters: 200, epoch: 10 | loss: 0.3834427
	speed: 0.0244s/iter; left time: 23.1254s
	iters: 300, epoch: 10 | loss: 1.0977684
	speed: 0.0236s/iter; left time: 20.0522s
	iters: 400, epoch: 10 | loss: 0.2543325
	speed: 0.0235s/iter; left time: 17.5885s
	iters: 500, epoch: 10 | loss: 0.4304449
	speed: 0.0243s/iter; left time: 15.7307s
	iters: 600, epoch: 10 | loss: 0.2568921
	speed: 0.0244s/iter; left time: 13.3566s
	iters: 700, epoch: 10 | loss: 0.4797747
	speed: 0.0241s/iter; left time: 10.7863s
	iters: 800, epoch: 10 | loss: 0.2998513
	speed: 0.0241s/iter; left time: 8.3798s
	iters: 900, epoch: 10 | loss: 0.3354323
	speed: 0.0244s/iter; left time: 6.0523s
	iters: 1000, epoch: 10 | loss: 0.3724827
	speed: 0.0251s/iter; left time: 3.7196s
	iters: 1100, epoch: 10 | loss: 0.2766798
	speed: 0.0257s/iter; left time: 1.2339s
Epoch: 10 cost time: 29.782607793807983
Epoch: 10, Steps: 1147 | Train Loss: 0.4350196 Vali Loss: 0.4361260 Test Loss: 0.1815933
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.1813407689332962, mae:0.22336235642433167
Use GPU: cuda:0
no_skip True
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.5510156
	speed: 0.0389s/iter; left time: 442.4660s
	iters: 200, epoch: 1 | loss: 0.5156622
	speed: 0.0347s/iter; left time: 390.6123s
	iters: 300, epoch: 1 | loss: 0.4070274
	speed: 0.0304s/iter; left time: 339.0435s
	iters: 400, epoch: 1 | loss: 0.3198331
	speed: 0.0277s/iter; left time: 306.2676s
	iters: 500, epoch: 1 | loss: 0.5678951
	speed: 0.0261s/iter; left time: 285.8815s
	iters: 600, epoch: 1 | loss: 0.3921981
	speed: 0.0255s/iter; left time: 277.5420s
	iters: 700, epoch: 1 | loss: 0.4710232
	speed: 0.0251s/iter; left time: 270.8638s
	iters: 800, epoch: 1 | loss: 0.4751003
	speed: 0.0249s/iter; left time: 265.5325s
	iters: 900, epoch: 1 | loss: 0.4677216
	speed: 0.0248s/iter; left time: 262.5069s
	iters: 1000, epoch: 1 | loss: 0.3439016
	speed: 0.0248s/iter; left time: 259.9939s
	iters: 1100, epoch: 1 | loss: 0.3537102
	speed: 0.0248s/iter; left time: 257.2073s
Epoch: 1 cost time: 28.538200855255127
Epoch: 1, Steps: 1147 | Train Loss: 0.5496326 Vali Loss: 0.5021121 Test Loss: 0.1972149
Validation loss decreased (inf --> 0.502112).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6701834
	speed: 0.0357s/iter; left time: 365.3454s
	iters: 200, epoch: 2 | loss: 0.4314825
	speed: 0.0290s/iter; left time: 294.0233s
	iters: 300, epoch: 2 | loss: 0.3611152
	speed: 0.0267s/iter; left time: 268.0684s
	iters: 400, epoch: 2 | loss: 0.4443704
	speed: 0.0251s/iter; left time: 249.2336s
	iters: 500, epoch: 2 | loss: 0.3337827
	speed: 0.0239s/iter; left time: 235.0451s
	iters: 600, epoch: 2 | loss: 0.4063064
	speed: 0.0232s/iter; left time: 225.9541s
	iters: 700, epoch: 2 | loss: 0.3084160
	speed: 0.0230s/iter; left time: 221.3669s
	iters: 800, epoch: 2 | loss: 0.3823878
	speed: 0.0232s/iter; left time: 220.5010s
	iters: 900, epoch: 2 | loss: 0.3580571
	speed: 0.0234s/iter; left time: 220.2344s
	iters: 1000, epoch: 2 | loss: 0.3214670
	speed: 0.0238s/iter; left time: 221.7838s
	iters: 1100, epoch: 2 | loss: 0.4245478
	speed: 0.0243s/iter; left time: 224.2869s
Epoch: 2 cost time: 27.606384754180908
Epoch: 2, Steps: 1147 | Train Loss: 0.4856729 Vali Loss: 0.4634107 Test Loss: 0.1885862
Validation loss decreased (0.502112 --> 0.463411).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3692326
	speed: 0.0243s/iter; left time: 220.5953s
	iters: 200, epoch: 3 | loss: 0.3913473
	speed: 0.0288s/iter; left time: 258.3102s
	iters: 300, epoch: 3 | loss: 1.2138838
	speed: 0.0269s/iter; left time: 239.1587s
	iters: 400, epoch: 3 | loss: 0.2718745
	speed: 0.0252s/iter; left time: 221.2002s
	iters: 500, epoch: 3 | loss: 0.3665785
	speed: 0.0265s/iter; left time: 229.7495s
	iters: 600, epoch: 3 | loss: 0.3534313
	speed: 0.0275s/iter; left time: 235.4433s
	iters: 700, epoch: 3 | loss: 0.2931243
	speed: 0.0271s/iter; left time: 229.5894s
	iters: 800, epoch: 3 | loss: 0.3976268
	speed: 0.0265s/iter; left time: 222.0840s
	iters: 900, epoch: 3 | loss: 0.2742805
	speed: 0.0261s/iter; left time: 216.0417s
	iters: 1000, epoch: 3 | loss: 0.2917262
	speed: 0.0258s/iter; left time: 211.0198s
	iters: 1100, epoch: 3 | loss: 0.5011882
	speed: 0.0256s/iter; left time: 207.0564s
Epoch: 3 cost time: 29.44069266319275
Epoch: 3, Steps: 1147 | Train Loss: 0.4617524 Vali Loss: 0.4556950 Test Loss: 0.1896350
Validation loss decreased (0.463411 --> 0.455695).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4335781
	speed: 0.0296s/iter; left time: 235.0662s
	iters: 200, epoch: 4 | loss: 0.5518000
	speed: 0.0307s/iter; left time: 240.5704s
	iters: 300, epoch: 4 | loss: 0.4506467
	speed: 0.0279s/iter; left time: 215.3644s
	iters: 400, epoch: 4 | loss: 0.5103747
	speed: 0.0266s/iter; left time: 202.9035s
	iters: 500, epoch: 4 | loss: 0.3882089
	speed: 0.0273s/iter; left time: 205.3713s
	iters: 600, epoch: 4 | loss: 0.6482329
	speed: 0.0268s/iter; left time: 198.8275s
	iters: 700, epoch: 4 | loss: 0.3259907
	speed: 0.0265s/iter; left time: 193.9188s
	iters: 800, epoch: 4 | loss: 0.2795266
	speed: 0.0260s/iter; left time: 187.6885s
	iters: 900, epoch: 4 | loss: 0.3283322
	speed: 0.0264s/iter; left time: 188.0714s
	iters: 1000, epoch: 4 | loss: 0.2315657
	speed: 0.0269s/iter; left time: 188.8835s
	iters: 1100, epoch: 4 | loss: 0.3033137
	speed: 0.0266s/iter; left time: 184.2483s
Epoch: 4 cost time: 30.353302717208862
Epoch: 4, Steps: 1147 | Train Loss: 0.4482633 Vali Loss: 0.4366673 Test Loss: 0.1845438
Validation loss decreased (0.455695 --> 0.436667).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3840806
	speed: 0.0419s/iter; left time: 284.4187s
	iters: 200, epoch: 5 | loss: 1.2036649
	speed: 0.0364s/iter; left time: 243.3034s
	iters: 300, epoch: 5 | loss: 0.2660693
	speed: 0.0316s/iter; left time: 208.0838s
	iters: 400, epoch: 5 | loss: 0.3499350
	speed: 0.0295s/iter; left time: 191.0676s
	iters: 500, epoch: 5 | loss: 0.3014854
	speed: 0.0281s/iter; left time: 179.3046s
	iters: 600, epoch: 5 | loss: 0.3754723
	speed: 0.0272s/iter; left time: 170.6536s
	iters: 700, epoch: 5 | loss: 0.2594238
	speed: 0.0266s/iter; left time: 164.4505s
	iters: 800, epoch: 5 | loss: 0.4783198
	speed: 0.0260s/iter; left time: 158.0493s
	iters: 900, epoch: 5 | loss: 1.3052483
	speed: 0.0255s/iter; left time: 152.4375s
	iters: 1000, epoch: 5 | loss: 0.3583137
	speed: 0.0248s/iter; left time: 146.0630s
	iters: 1100, epoch: 5 | loss: 0.2753944
	speed: 0.0239s/iter; left time: 138.3836s
Epoch: 5 cost time: 27.208837032318115
Epoch: 5, Steps: 1147 | Train Loss: 0.4411136 Vali Loss: 0.4349361 Test Loss: 0.1836392
Validation loss decreased (0.436667 --> 0.434936).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4607324
	speed: 0.0253s/iter; left time: 142.7239s
	iters: 200, epoch: 6 | loss: 0.7986797
	speed: 0.0250s/iter; left time: 138.1583s
	iters: 300, epoch: 6 | loss: 0.2384789
	speed: 0.0249s/iter; left time: 135.3469s
	iters: 400, epoch: 6 | loss: 0.3494619
	speed: 0.0242s/iter; left time: 129.1921s
	iters: 500, epoch: 6 | loss: 1.3050764
	speed: 0.0246s/iter; left time: 128.9673s
	iters: 600, epoch: 6 | loss: 0.4654964
	speed: 0.0264s/iter; left time: 135.7338s
	iters: 700, epoch: 6 | loss: 1.0646535
	speed: 0.0258s/iter; left time: 129.9958s
	iters: 800, epoch: 6 | loss: 0.3452394
	speed: 0.0258s/iter; left time: 127.3825s
	iters: 900, epoch: 6 | loss: 0.6023469
	speed: 0.0255s/iter; left time: 123.4683s
	iters: 1000, epoch: 6 | loss: 0.3120958
	speed: 0.0252s/iter; left time: 119.4051s
	iters: 1100, epoch: 6 | loss: 0.3768492
	speed: 0.0256s/iter; left time: 118.8756s
Epoch: 6 cost time: 29.923945665359497
Epoch: 6, Steps: 1147 | Train Loss: 0.4365930 Vali Loss: 0.4331358 Test Loss: 0.1837983
Validation loss decreased (0.434936 --> 0.433136).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2538191
	speed: 0.0367s/iter; left time: 164.9573s
	iters: 200, epoch: 7 | loss: 0.2756398
	speed: 0.0348s/iter; left time: 152.7761s
	iters: 300, epoch: 7 | loss: 0.6365668
	speed: 0.0344s/iter; left time: 147.6767s
	iters: 400, epoch: 7 | loss: 0.2942095
	speed: 0.0337s/iter; left time: 141.2594s
	iters: 500, epoch: 7 | loss: 0.2960975
	speed: 0.0315s/iter; left time: 128.7115s
	iters: 600, epoch: 7 | loss: 0.4356310
	speed: 0.0300s/iter; left time: 119.8030s
	iters: 700, epoch: 7 | loss: 0.3103383
	speed: 0.0299s/iter; left time: 116.1444s
	iters: 800, epoch: 7 | loss: 0.3035896
	speed: 0.0302s/iter; left time: 114.3496s
	iters: 900, epoch: 7 | loss: 0.3925675
	speed: 0.0303s/iter; left time: 111.6444s
	iters: 1000, epoch: 7 | loss: 0.3105708
	speed: 0.0304s/iter; left time: 109.1559s
	iters: 1100, epoch: 7 | loss: 0.2070694
	speed: 0.0297s/iter; left time: 103.7329s
Epoch: 7 cost time: 33.92929434776306
Epoch: 7, Steps: 1147 | Train Loss: 0.4342852 Vali Loss: 0.4326062 Test Loss: 0.1839260
Validation loss decreased (0.433136 --> 0.432606).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3520629
	speed: 0.0400s/iter; left time: 133.8080s
	iters: 200, epoch: 8 | loss: 0.3875325
	speed: 0.0323s/iter; left time: 104.5709s
	iters: 300, epoch: 8 | loss: 0.4288453
	speed: 0.0290s/iter; left time: 91.1721s
	iters: 400, epoch: 8 | loss: 0.4262604
	speed: 0.0275s/iter; left time: 83.6777s
	iters: 500, epoch: 8 | loss: 0.4369164
	speed: 0.0266s/iter; left time: 78.3268s
	iters: 600, epoch: 8 | loss: 0.3392796
	speed: 0.0259s/iter; left time: 73.4695s
	iters: 700, epoch: 8 | loss: 0.2980143
	speed: 0.0254s/iter; left time: 69.7321s
	iters: 800, epoch: 8 | loss: 0.3775296
	speed: 0.0246s/iter; left time: 64.9344s
	iters: 900, epoch: 8 | loss: 0.3674065
	speed: 0.0238s/iter; left time: 60.4503s
	iters: 1000, epoch: 8 | loss: 0.3644336
	speed: 0.0230s/iter; left time: 56.2179s
	iters: 1100, epoch: 8 | loss: 0.3506153
	speed: 0.0231s/iter; left time: 54.1659s
Epoch: 8 cost time: 26.876447677612305
Epoch: 8, Steps: 1147 | Train Loss: 0.4331729 Vali Loss: 0.4322336 Test Loss: 0.1840101
Validation loss decreased (0.432606 --> 0.432234).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2441971
	speed: 0.0387s/iter; left time: 84.8859s
	iters: 200, epoch: 9 | loss: 0.2545648
	speed: 0.0370s/iter; left time: 77.5922s
	iters: 300, epoch: 9 | loss: 0.3651147
	speed: 0.0337s/iter; left time: 67.1721s
	iters: 400, epoch: 9 | loss: 0.3913526
	speed: 0.0311s/iter; left time: 58.9902s
	iters: 500, epoch: 9 | loss: 0.3119459
	speed: 0.0306s/iter; left time: 54.9455s
	iters: 600, epoch: 9 | loss: 0.2846143
	speed: 0.0291s/iter; left time: 49.2799s
	iters: 700, epoch: 9 | loss: 0.4135709
	speed: 0.0277s/iter; left time: 44.1703s
	iters: 800, epoch: 9 | loss: 0.2206146
	speed: 0.0273s/iter; left time: 40.7389s
	iters: 900, epoch: 9 | loss: 1.1501683
	speed: 0.0266s/iter; left time: 37.0636s
	iters: 1000, epoch: 9 | loss: 0.4324221
	speed: 0.0261s/iter; left time: 33.7372s
	iters: 1100, epoch: 9 | loss: 0.3444964
	speed: 0.0260s/iter; left time: 31.0534s
Epoch: 9 cost time: 29.72745966911316
Epoch: 9, Steps: 1147 | Train Loss: 0.4326494 Vali Loss: 0.4326104 Test Loss: 0.1836263
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3720428
	speed: 0.0263s/iter; left time: 27.5344s
	iters: 200, epoch: 10 | loss: 0.3195120
	speed: 0.0248s/iter; left time: 23.4947s
	iters: 300, epoch: 10 | loss: 0.2500164
	speed: 0.0238s/iter; left time: 20.2180s
	iters: 400, epoch: 10 | loss: 0.4539948
	speed: 0.0234s/iter; left time: 17.4833s
	iters: 500, epoch: 10 | loss: 0.2735479
	speed: 0.0231s/iter; left time: 14.9914s
	iters: 600, epoch: 10 | loss: 0.3273260
	speed: 0.0230s/iter; left time: 12.6241s
	iters: 700, epoch: 10 | loss: 1.2637916
	speed: 0.0231s/iter; left time: 10.3357s
	iters: 800, epoch: 10 | loss: 0.3421385
	speed: 0.0231s/iter; left time: 8.0339s
	iters: 900, epoch: 10 | loss: 0.3571395
	speed: 0.0231s/iter; left time: 5.7271s
	iters: 1000, epoch: 10 | loss: 0.4362387
	speed: 0.0230s/iter; left time: 3.4052s
	iters: 1100, epoch: 10 | loss: 0.4291297
	speed: 0.0229s/iter; left time: 1.1012s
Epoch: 10 cost time: 26.41502594947815
Epoch: 10, Steps: 1147 | Train Loss: 0.4322120 Vali Loss: 0.4326185 Test Loss: 0.1838152
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.18401013314723969, mae:0.22514089941978455
Seed: 123
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_192      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip True
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.5704045
	speed: 0.0355s/iter; left time: 402.7336s
	iters: 200, epoch: 1 | loss: 0.5488572
	speed: 0.0271s/iter; left time: 304.7831s
	iters: 300, epoch: 1 | loss: 0.6396263
	speed: 0.0239s/iter; left time: 266.4131s
	iters: 400, epoch: 1 | loss: 0.5234114
	speed: 0.0223s/iter; left time: 245.8042s
	iters: 500, epoch: 1 | loss: 0.4805562
	speed: 0.0212s/iter; left time: 231.8310s
	iters: 600, epoch: 1 | loss: 1.0091665
	speed: 0.0230s/iter; left time: 249.5758s
	iters: 700, epoch: 1 | loss: 0.7345921
	speed: 0.0249s/iter; left time: 267.0470s
	iters: 800, epoch: 1 | loss: 0.7875031
	speed: 0.0246s/iter; left time: 261.9155s
	iters: 900, epoch: 1 | loss: 0.5924630
	speed: 0.0245s/iter; left time: 258.6378s
	iters: 1000, epoch: 1 | loss: 0.3646622
	speed: 0.0243s/iter; left time: 254.2178s
	iters: 1100, epoch: 1 | loss: 0.4378593
	speed: 0.0242s/iter; left time: 250.0323s
Epoch: 1 cost time: 27.678938150405884
Epoch: 1, Steps: 1144 | Train Loss: 0.6257728 Vali Loss: 0.6024700 Test Loss: 0.2498580
Validation loss decreased (inf --> 0.602470).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6034843
	speed: 0.0294s/iter; left time: 299.3650s
	iters: 200, epoch: 2 | loss: 0.4381717
	speed: 0.0257s/iter; left time: 259.9466s
	iters: 300, epoch: 2 | loss: 0.5272963
	speed: 0.0249s/iter; left time: 248.8945s
	iters: 400, epoch: 2 | loss: 0.4576866
	speed: 0.0244s/iter; left time: 241.8209s
	iters: 500, epoch: 2 | loss: 0.5883566
	speed: 0.0241s/iter; left time: 236.1422s
	iters: 600, epoch: 2 | loss: 0.5351737
	speed: 0.0240s/iter; left time: 232.9261s
	iters: 700, epoch: 2 | loss: 0.4414802
	speed: 0.0242s/iter; left time: 232.4367s
	iters: 800, epoch: 2 | loss: 0.4100599
	speed: 0.0241s/iter; left time: 228.4301s
	iters: 900, epoch: 2 | loss: 0.9018452
	speed: 0.0234s/iter; left time: 220.1605s
	iters: 1000, epoch: 2 | loss: 0.4375832
	speed: 0.0237s/iter; left time: 219.9890s
	iters: 1100, epoch: 2 | loss: 0.9065208
	speed: 0.0251s/iter; left time: 230.9303s
Epoch: 2 cost time: 29.3355815410614
Epoch: 2, Steps: 1144 | Train Loss: 0.5722217 Vali Loss: 0.5677984 Test Loss: 0.2456430
Validation loss decreased (0.602470 --> 0.567798).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5618020
	speed: 0.0397s/iter; left time: 359.5529s
	iters: 200, epoch: 3 | loss: 0.4536783
	speed: 0.0375s/iter; left time: 336.1039s
	iters: 300, epoch: 3 | loss: 0.4107735
	speed: 0.0374s/iter; left time: 331.0788s
	iters: 400, epoch: 3 | loss: 0.4432716
	speed: 0.0347s/iter; left time: 303.3994s
	iters: 500, epoch: 3 | loss: 0.8646323
	speed: 0.0317s/iter; left time: 274.3572s
	iters: 600, epoch: 3 | loss: 0.4699586
	speed: 0.0296s/iter; left time: 253.1611s
	iters: 700, epoch: 3 | loss: 0.4749205
	speed: 0.0281s/iter; left time: 237.3419s
	iters: 800, epoch: 3 | loss: 0.7973049
	speed: 0.0273s/iter; left time: 228.4473s
	iters: 900, epoch: 3 | loss: 0.5570809
	speed: 0.0268s/iter; left time: 220.8708s
	iters: 1000, epoch: 3 | loss: 0.4780948
	speed: 0.0265s/iter; left time: 216.2802s
	iters: 1100, epoch: 3 | loss: 0.3922380
	speed: 0.0261s/iter; left time: 210.1716s
Epoch: 3 cost time: 29.802260875701904
Epoch: 3, Steps: 1144 | Train Loss: 0.5472005 Vali Loss: 0.5397721 Test Loss: 0.2344215
Validation loss decreased (0.567798 --> 0.539772).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.9555336
	speed: 0.0309s/iter; left time: 244.3625s
	iters: 200, epoch: 4 | loss: 0.4162712
	speed: 0.0247s/iter; left time: 193.2375s
	iters: 300, epoch: 4 | loss: 0.9400774
	speed: 0.0234s/iter; left time: 180.7232s
	iters: 400, epoch: 4 | loss: 0.4225880
	speed: 0.0238s/iter; left time: 180.8386s
	iters: 500, epoch: 4 | loss: 0.3391650
	speed: 0.0235s/iter; left time: 176.4672s
	iters: 600, epoch: 4 | loss: 1.1288987
	speed: 0.0235s/iter; left time: 174.1558s
	iters: 700, epoch: 4 | loss: 0.5300668
	speed: 0.0231s/iter; left time: 169.1118s
	iters: 800, epoch: 4 | loss: 0.3646082
	speed: 0.0226s/iter; left time: 163.2059s
	iters: 900, epoch: 4 | loss: 0.6269099
	speed: 0.0226s/iter; left time: 161.0026s
	iters: 1000, epoch: 4 | loss: 0.4858398
	speed: 0.0226s/iter; left time: 158.2807s
	iters: 1100, epoch: 4 | loss: 0.3749524
	speed: 0.0225s/iter; left time: 155.7819s
Epoch: 4 cost time: 25.899457454681396
Epoch: 4, Steps: 1144 | Train Loss: 0.5314026 Vali Loss: 0.5265368 Test Loss: 0.2322803
Validation loss decreased (0.539772 --> 0.526537).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3667027
	speed: 0.0301s/iter; left time: 203.8142s
	iters: 200, epoch: 5 | loss: 0.4979693
	speed: 0.0262s/iter; left time: 174.4214s
	iters: 300, epoch: 5 | loss: 0.4277419
	speed: 0.0252s/iter; left time: 165.2022s
	iters: 400, epoch: 5 | loss: 0.3364192
	speed: 0.0250s/iter; left time: 161.6049s
	iters: 500, epoch: 5 | loss: 0.9205540
	speed: 0.0249s/iter; left time: 158.4960s
	iters: 600, epoch: 5 | loss: 0.4263819
	speed: 0.0245s/iter; left time: 153.6934s
	iters: 700, epoch: 5 | loss: 0.5653729
	speed: 0.0243s/iter; left time: 149.6655s
	iters: 800, epoch: 5 | loss: 0.4450422
	speed: 0.0242s/iter; left time: 146.5149s
	iters: 900, epoch: 5 | loss: 0.4101941
	speed: 0.0247s/iter; left time: 147.2127s
	iters: 1000, epoch: 5 | loss: 0.3262080
	speed: 0.0243s/iter; left time: 142.4728s
	iters: 1100, epoch: 5 | loss: 1.0570560
	speed: 0.0239s/iter; left time: 137.7139s
Epoch: 5 cost time: 27.324229955673218
Epoch: 5, Steps: 1144 | Train Loss: 0.5258057 Vali Loss: 0.5246314 Test Loss: 0.2316530
Validation loss decreased (0.526537 --> 0.524631).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4018200
	speed: 0.0389s/iter; left time: 218.4045s
	iters: 200, epoch: 6 | loss: 0.5259790
	speed: 0.0319s/iter; left time: 176.1451s
	iters: 300, epoch: 6 | loss: 0.3418124
	speed: 0.0295s/iter; left time: 159.6727s
	iters: 400, epoch: 6 | loss: 0.4176889
	speed: 0.0282s/iter; left time: 150.1757s
	iters: 500, epoch: 6 | loss: 0.3929528
	speed: 0.0275s/iter; left time: 143.4707s
	iters: 600, epoch: 6 | loss: 0.4941210
	speed: 0.0270s/iter; left time: 138.1508s
	iters: 700, epoch: 6 | loss: 0.5129782
	speed: 0.0264s/iter; left time: 132.3527s
	iters: 800, epoch: 6 | loss: 0.5849271
	speed: 0.0256s/iter; left time: 125.7433s
	iters: 900, epoch: 6 | loss: 0.4504903
	speed: 0.0249s/iter; left time: 119.8122s
	iters: 1000, epoch: 6 | loss: 0.4276104
	speed: 0.0243s/iter; left time: 114.9522s
	iters: 1100, epoch: 6 | loss: 0.3635761
	speed: 0.0241s/iter; left time: 111.3472s
Epoch: 6 cost time: 27.665976524353027
Epoch: 6, Steps: 1144 | Train Loss: 0.5224499 Vali Loss: 0.5229443 Test Loss: 0.2309285
Validation loss decreased (0.524631 --> 0.522944).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.9061831
	speed: 0.0273s/iter; left time: 122.0016s
	iters: 200, epoch: 7 | loss: 0.4059347
	speed: 0.0241s/iter; left time: 105.4763s
	iters: 300, epoch: 7 | loss: 0.4251342
	speed: 0.0249s/iter; left time: 106.3704s
	iters: 400, epoch: 7 | loss: 0.5323581
	speed: 0.0241s/iter; left time: 100.4795s
	iters: 500, epoch: 7 | loss: 0.4661181
	speed: 0.0240s/iter; left time: 97.9118s
	iters: 600, epoch: 7 | loss: 0.3884414
	speed: 0.0234s/iter; left time: 93.1807s
	iters: 700, epoch: 7 | loss: 0.4100609
	speed: 0.0229s/iter; left time: 88.6847s
	iters: 800, epoch: 7 | loss: 0.3812153
	speed: 0.0224s/iter; left time: 84.7234s
	iters: 900, epoch: 7 | loss: 0.5300035
	speed: 0.0221s/iter; left time: 81.3450s
	iters: 1000, epoch: 7 | loss: 0.5629102
	speed: 0.0220s/iter; left time: 78.7113s
	iters: 1100, epoch: 7 | loss: 0.3908594
	speed: 0.0222s/iter; left time: 77.3393s
Epoch: 7 cost time: 25.671239852905273
Epoch: 7, Steps: 1144 | Train Loss: 0.5209487 Vali Loss: 0.5196213 Test Loss: 0.2306171
Validation loss decreased (0.522944 --> 0.519621).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4549529
	speed: 0.0422s/iter; left time: 140.5923s
	iters: 200, epoch: 8 | loss: 0.5353798
	speed: 0.0351s/iter; left time: 113.4202s
	iters: 300, epoch: 8 | loss: 0.5361275
	speed: 0.0309s/iter; left time: 96.8696s
	iters: 400, epoch: 8 | loss: 0.4454746
	speed: 0.0288s/iter; left time: 87.2911s
	iters: 500, epoch: 8 | loss: 0.3298988
	speed: 0.0279s/iter; left time: 81.8978s
	iters: 600, epoch: 8 | loss: 0.4107860
	speed: 0.0268s/iter; left time: 75.9083s
	iters: 700, epoch: 8 | loss: 0.5004871
	speed: 0.0258s/iter; left time: 70.5540s
	iters: 800, epoch: 8 | loss: 0.3905489
	speed: 0.0251s/iter; left time: 66.1361s
	iters: 900, epoch: 8 | loss: 0.4952403
	speed: 0.0246s/iter; left time: 62.2145s
	iters: 1000, epoch: 8 | loss: 0.3743834
	speed: 0.0243s/iter; left time: 59.1482s
	iters: 1100, epoch: 8 | loss: 0.3607701
	speed: 0.0243s/iter; left time: 56.6985s
Epoch: 8 cost time: 27.94642996788025
Epoch: 8, Steps: 1144 | Train Loss: 0.5202997 Vali Loss: 0.5195673 Test Loss: 0.2309550
Validation loss decreased (0.519621 --> 0.519567).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3003678
	speed: 0.0332s/iter; left time: 72.6101s
	iters: 200, epoch: 9 | loss: 0.3526076
	speed: 0.0276s/iter; left time: 57.6199s
	iters: 300, epoch: 9 | loss: 0.4733216
	speed: 0.0257s/iter; left time: 51.1094s
	iters: 400, epoch: 9 | loss: 0.3664320
	speed: 0.0247s/iter; left time: 46.6281s
	iters: 500, epoch: 9 | loss: 0.3839140
	speed: 0.0269s/iter; left time: 48.1671s
	iters: 600, epoch: 9 | loss: 0.3989781
	speed: 0.0262s/iter; left time: 44.1700s
	iters: 700, epoch: 9 | loss: 0.3700854
	speed: 0.0253s/iter; left time: 40.1539s
	iters: 800, epoch: 9 | loss: 0.4160847
	speed: 0.0246s/iter; left time: 36.6820s
	iters: 900, epoch: 9 | loss: 1.4392565
	speed: 0.0241s/iter; left time: 33.4460s
	iters: 1000, epoch: 9 | loss: 0.5227539
	speed: 0.0243s/iter; left time: 31.3698s
	iters: 1100, epoch: 9 | loss: 0.5384178
	speed: 0.0244s/iter; left time: 28.9799s
Epoch: 9 cost time: 28.025444507598877
Epoch: 9, Steps: 1144 | Train Loss: 0.5197140 Vali Loss: 0.5195642 Test Loss: 0.2309389
Validation loss decreased (0.519567 --> 0.519564).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.8876106
	speed: 0.0329s/iter; left time: 34.3907s
	iters: 200, epoch: 10 | loss: 0.5295248
	speed: 0.0255s/iter; left time: 24.0953s
	iters: 300, epoch: 10 | loss: 0.8172511
	speed: 0.0228s/iter; left time: 19.2286s
	iters: 400, epoch: 10 | loss: 0.3965741
	speed: 0.0220s/iter; left time: 16.3891s
	iters: 500, epoch: 10 | loss: 0.3861517
	speed: 0.0214s/iter; left time: 13.8110s
	iters: 600, epoch: 10 | loss: 0.4707587
	speed: 0.0197s/iter; left time: 10.7605s
	iters: 700, epoch: 10 | loss: 0.3394982
	speed: 0.0187s/iter; left time: 8.3225s
	iters: 800, epoch: 10 | loss: 0.4926123
	speed: 0.0186s/iter; left time: 6.4266s
	iters: 900, epoch: 10 | loss: 0.4802136
	speed: 0.0183s/iter; left time: 4.4838s
	iters: 1000, epoch: 10 | loss: 0.5788647
	speed: 0.0185s/iter; left time: 2.6885s
	iters: 1100, epoch: 10 | loss: 1.0122565
	speed: 0.0183s/iter; left time: 0.8240s
Epoch: 10 cost time: 20.92511510848999
Epoch: 10, Steps: 1144 | Train Loss: 0.5195192 Vali Loss: 0.5196248 Test Loss: 0.2310468
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.23093897104263306, mae:0.2638939917087555
Use GPU: cuda:0
no_skip True
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.5984973
	speed: 0.0365s/iter; left time: 413.8128s
	iters: 200, epoch: 1 | loss: 0.6245806
	speed: 0.0292s/iter; left time: 328.4836s
	iters: 300, epoch: 1 | loss: 0.4407202
	speed: 0.0269s/iter; left time: 299.6796s
	iters: 400, epoch: 1 | loss: 0.6245303
	speed: 0.0259s/iter; left time: 286.0976s
	iters: 500, epoch: 1 | loss: 0.3771944
	speed: 0.0255s/iter; left time: 278.5230s
	iters: 600, epoch: 1 | loss: 0.8099440
	speed: 0.0250s/iter; left time: 271.0576s
	iters: 700, epoch: 1 | loss: 0.6823658
	speed: 0.0246s/iter; left time: 264.6190s
	iters: 800, epoch: 1 | loss: 0.5577536
	speed: 0.0244s/iter; left time: 259.5021s
	iters: 900, epoch: 1 | loss: 0.4953811
	speed: 0.0250s/iter; left time: 263.3938s
	iters: 1000, epoch: 1 | loss: 0.9453533
	speed: 0.0249s/iter; left time: 259.7811s
	iters: 1100, epoch: 1 | loss: 0.4256176
	speed: 0.0248s/iter; left time: 256.6582s
Epoch: 1 cost time: 28.673075199127197
Epoch: 1, Steps: 1144 | Train Loss: 0.6041386 Vali Loss: 0.5750712 Test Loss: 0.2489250
Validation loss decreased (inf --> 0.575071).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4034079
	speed: 0.0468s/iter; left time: 476.8554s
	iters: 200, epoch: 2 | loss: 0.4908309
	speed: 0.0445s/iter; left time: 448.8573s
	iters: 300, epoch: 2 | loss: 0.4263046
	speed: 0.0425s/iter; left time: 425.0811s
	iters: 400, epoch: 2 | loss: 0.5107919
	speed: 0.0375s/iter; left time: 371.5470s
	iters: 500, epoch: 2 | loss: 0.4106561
	speed: 0.0346s/iter; left time: 338.6228s
	iters: 600, epoch: 2 | loss: 0.4753711
	speed: 0.0325s/iter; left time: 315.0861s
	iters: 700, epoch: 2 | loss: 0.4667419
	speed: 0.0311s/iter; left time: 298.0607s
	iters: 800, epoch: 2 | loss: 0.4099726
	speed: 0.0302s/iter; left time: 287.1591s
	iters: 900, epoch: 2 | loss: 0.5426685
	speed: 0.0298s/iter; left time: 280.1584s
	iters: 1000, epoch: 2 | loss: 0.4409857
	speed: 0.0290s/iter; left time: 269.6095s
	iters: 1100, epoch: 2 | loss: 0.4587093
	speed: 0.0285s/iter; left time: 262.1804s
Epoch: 2 cost time: 32.443488121032715
Epoch: 2, Steps: 1144 | Train Loss: 0.5497911 Vali Loss: 0.5608643 Test Loss: 0.2410432
Validation loss decreased (0.575071 --> 0.560864).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4043294
	speed: 0.0325s/iter; left time: 294.1619s
	iters: 200, epoch: 3 | loss: 0.4485051
	speed: 0.0297s/iter; left time: 266.3144s
	iters: 300, epoch: 3 | loss: 0.5726542
	speed: 0.0281s/iter; left time: 248.3311s
	iters: 400, epoch: 3 | loss: 0.5525132
	speed: 0.0264s/iter; left time: 231.2834s
	iters: 500, epoch: 3 | loss: 0.4479316
	speed: 0.0251s/iter; left time: 216.8200s
	iters: 600, epoch: 3 | loss: 0.9046239
	speed: 0.0237s/iter; left time: 202.4503s
	iters: 700, epoch: 3 | loss: 0.4629253
	speed: 0.0227s/iter; left time: 191.9102s
	iters: 800, epoch: 3 | loss: 0.5910416
	speed: 0.0221s/iter; left time: 184.3757s
	iters: 900, epoch: 3 | loss: 0.4508930
	speed: 0.0216s/iter; left time: 178.1245s
	iters: 1000, epoch: 3 | loss: 0.5024124
	speed: 0.0211s/iter; left time: 171.6699s
	iters: 1100, epoch: 3 | loss: 0.9283645
	speed: 0.0205s/iter; left time: 165.0118s
Epoch: 3 cost time: 23.313848733901978
Epoch: 3, Steps: 1144 | Train Loss: 0.5277794 Vali Loss: 0.5163913 Test Loss: 0.2317237
Validation loss decreased (0.560864 --> 0.516391).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4825754
	speed: 0.0356s/iter; left time: 281.6277s
	iters: 200, epoch: 4 | loss: 0.3756635
	speed: 0.0307s/iter; left time: 239.3510s
	iters: 300, epoch: 4 | loss: 0.4559585
	speed: 0.0290s/iter; left time: 223.7570s
	iters: 400, epoch: 4 | loss: 0.5050770
	speed: 0.0281s/iter; left time: 213.7200s
	iters: 500, epoch: 4 | loss: 0.4441090
	speed: 0.0276s/iter; left time: 207.2896s
	iters: 600, epoch: 4 | loss: 0.9490750
	speed: 0.0270s/iter; left time: 199.7349s
	iters: 700, epoch: 4 | loss: 0.7446691
	speed: 0.0263s/iter; left time: 192.2062s
	iters: 800, epoch: 4 | loss: 0.4246784
	speed: 0.0264s/iter; left time: 190.5741s
	iters: 900, epoch: 4 | loss: 0.3528093
	speed: 0.0271s/iter; left time: 192.4974s
	iters: 1000, epoch: 4 | loss: 0.5046924
	speed: 0.0264s/iter; left time: 185.3512s
	iters: 1100, epoch: 4 | loss: 0.4056162
	speed: 0.0260s/iter; left time: 179.7724s
Epoch: 4 cost time: 29.745021104812622
Epoch: 4, Steps: 1144 | Train Loss: 0.5172238 Vali Loss: 0.5083112 Test Loss: 0.2303820
Validation loss decreased (0.516391 --> 0.508311).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4038130
	speed: 0.0266s/iter; left time: 180.0574s
	iters: 200, epoch: 5 | loss: 0.3057274
	speed: 0.0244s/iter; left time: 162.4609s
	iters: 300, epoch: 5 | loss: 0.5035608
	speed: 0.0235s/iter; left time: 153.9569s
	iters: 400, epoch: 5 | loss: 0.9982090
	speed: 0.0244s/iter; left time: 157.7254s
	iters: 500, epoch: 5 | loss: 0.3016023
	speed: 0.0267s/iter; left time: 169.9959s
	iters: 600, epoch: 5 | loss: 0.4458958
	speed: 0.0264s/iter; left time: 165.5053s
	iters: 700, epoch: 5 | loss: 0.4345290
	speed: 0.0262s/iter; left time: 161.4074s
	iters: 800, epoch: 5 | loss: 0.4477236
	speed: 0.0269s/iter; left time: 163.0149s
	iters: 900, epoch: 5 | loss: 0.5069730
	speed: 0.0275s/iter; left time: 163.7395s
	iters: 1000, epoch: 5 | loss: 0.4549058
	speed: 0.0279s/iter; left time: 163.4791s
	iters: 1100, epoch: 5 | loss: 0.4332574
	speed: 0.0274s/iter; left time: 157.8217s
Epoch: 5 cost time: 31.219621419906616
Epoch: 5, Steps: 1144 | Train Loss: 0.5113596 Vali Loss: 0.5107939 Test Loss: 0.2308025
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4256653
	speed: 0.0338s/iter; left time: 190.2650s
	iters: 200, epoch: 6 | loss: 0.4539829
	speed: 0.0299s/iter; left time: 165.3348s
	iters: 300, epoch: 6 | loss: 0.5233106
	speed: 0.0283s/iter; left time: 153.2397s
	iters: 400, epoch: 6 | loss: 0.4593916
	speed: 0.0269s/iter; left time: 143.2999s
	iters: 500, epoch: 6 | loss: 0.5348817
	speed: 0.0252s/iter; left time: 131.8117s
	iters: 600, epoch: 6 | loss: 0.4789582
	speed: 0.0238s/iter; left time: 121.8128s
	iters: 700, epoch: 6 | loss: 0.4180779
	speed: 0.0238s/iter; left time: 119.6929s
	iters: 800, epoch: 6 | loss: 0.4497938
	speed: 0.0239s/iter; left time: 117.5478s
	iters: 900, epoch: 6 | loss: 1.3631121
	speed: 0.0232s/iter; left time: 111.8694s
	iters: 1000, epoch: 6 | loss: 0.4264271
	speed: 0.0229s/iter; left time: 108.2137s
	iters: 1100, epoch: 6 | loss: 0.8833637
	speed: 0.0227s/iter; left time: 104.9115s
Epoch: 6 cost time: 26.406084775924683
Epoch: 6, Steps: 1144 | Train Loss: 0.5078343 Vali Loss: 0.5025952 Test Loss: 0.2290875
Validation loss decreased (0.508311 --> 0.502595).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4647019
	speed: 0.0365s/iter; left time: 163.2261s
	iters: 200, epoch: 7 | loss: 0.4694685
	speed: 0.0310s/iter; left time: 135.5007s
	iters: 300, epoch: 7 | loss: 0.3817991
	speed: 0.0288s/iter; left time: 123.0556s
	iters: 400, epoch: 7 | loss: 0.8850784
	speed: 0.0277s/iter; left time: 115.5610s
	iters: 500, epoch: 7 | loss: 0.3188758
	speed: 0.0270s/iter; left time: 109.9000s
	iters: 600, epoch: 7 | loss: 0.4411914
	speed: 0.0264s/iter; left time: 105.1047s
	iters: 700, epoch: 7 | loss: 0.5030879
	speed: 0.0263s/iter; left time: 101.9633s
	iters: 800, epoch: 7 | loss: 0.4936163
	speed: 0.0255s/iter; left time: 96.2951s
	iters: 900, epoch: 7 | loss: 1.0189817
	speed: 0.0254s/iter; left time: 93.2276s
	iters: 1000, epoch: 7 | loss: 0.4451991
	speed: 0.0255s/iter; left time: 91.0929s
	iters: 1100, epoch: 7 | loss: 0.4492866
	speed: 0.0259s/iter; left time: 90.1301s
Epoch: 7 cost time: 29.977181673049927
Epoch: 7, Steps: 1144 | Train Loss: 0.5060544 Vali Loss: 0.5067541 Test Loss: 0.2301661
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4822503
	speed: 0.0313s/iter; left time: 104.1726s
	iters: 200, epoch: 8 | loss: 0.4353289
	speed: 0.0277s/iter; left time: 89.6036s
	iters: 300, epoch: 8 | loss: 0.4499169
	speed: 0.0267s/iter; left time: 83.6230s
	iters: 400, epoch: 8 | loss: 0.5250959
	speed: 0.0263s/iter; left time: 79.8888s
	iters: 500, epoch: 8 | loss: 0.6843638
	speed: 0.0261s/iter; left time: 76.5597s
	iters: 600, epoch: 8 | loss: 0.3895649
	speed: 0.0256s/iter; left time: 72.5279s
	iters: 700, epoch: 8 | loss: 0.3411164
	speed: 0.0251s/iter; left time: 68.5997s
	iters: 800, epoch: 8 | loss: 0.3545138
	speed: 0.0248s/iter; left time: 65.3192s
	iters: 900, epoch: 8 | loss: 0.4189765
	speed: 0.0246s/iter; left time: 62.3083s
	iters: 1000, epoch: 8 | loss: 0.5192220
	speed: 0.0244s/iter; left time: 59.3755s
	iters: 1100, epoch: 8 | loss: 0.8459253
	speed: 0.0243s/iter; left time: 56.7539s
Epoch: 8 cost time: 27.93338179588318
Epoch: 8, Steps: 1144 | Train Loss: 0.5051666 Vali Loss: 0.5039212 Test Loss: 0.2292867
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4512258
	speed: 0.0233s/iter; left time: 51.0028s
	iters: 200, epoch: 9 | loss: 0.3797314
	speed: 0.0223s/iter; left time: 46.5753s
	iters: 300, epoch: 9 | loss: 0.3834252
	speed: 0.0214s/iter; left time: 42.5448s
	iters: 400, epoch: 9 | loss: 0.4233142
	speed: 0.0203s/iter; left time: 38.4340s
	iters: 500, epoch: 9 | loss: 0.4353141
	speed: 0.0196s/iter; left time: 35.0513s
	iters: 600, epoch: 9 | loss: 0.3418291
	speed: 0.0195s/iter; left time: 32.8534s
	iters: 700, epoch: 9 | loss: 0.4729097
	speed: 0.0195s/iter; left time: 30.9713s
	iters: 800, epoch: 9 | loss: 0.4267218
	speed: 0.0195s/iter; left time: 29.1053s
	iters: 900, epoch: 9 | loss: 0.9523837
	speed: 0.0194s/iter; left time: 26.9765s
	iters: 1000, epoch: 9 | loss: 0.5197443
	speed: 0.0202s/iter; left time: 26.0174s
	iters: 1100, epoch: 9 | loss: 0.3850965
	speed: 0.0215s/iter; left time: 25.6053s
Epoch: 9 cost time: 25.229256868362427
Epoch: 9, Steps: 1144 | Train Loss: 0.5046996 Vali Loss: 0.5052216 Test Loss: 0.2296912
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.4147368
	speed: 0.0319s/iter; left time: 33.3116s
	iters: 200, epoch: 10 | loss: 0.4023386
	speed: 0.0323s/iter; left time: 30.5275s
	iters: 300, epoch: 10 | loss: 0.4086351
	speed: 0.0335s/iter; left time: 28.3164s
	iters: 400, epoch: 10 | loss: 0.3924288
	speed: 0.0330s/iter; left time: 24.5883s
	iters: 500, epoch: 10 | loss: 0.5122980
	speed: 0.0309s/iter; left time: 19.9571s
	iters: 600, epoch: 10 | loss: 0.4109605
	speed: 0.0295s/iter; left time: 16.0940s
	iters: 700, epoch: 10 | loss: 0.2941883
	speed: 0.0288s/iter; left time: 12.8152s
	iters: 800, epoch: 10 | loss: 0.4179645
	speed: 0.0280s/iter; left time: 9.6666s
	iters: 900, epoch: 10 | loss: 0.3895502
	speed: 0.0273s/iter; left time: 6.6793s
	iters: 1000, epoch: 10 | loss: 0.4770288
	speed: 0.0267s/iter; left time: 3.8779s
	iters: 1100, epoch: 10 | loss: 0.4054871
	speed: 0.0263s/iter; left time: 1.1854s
Epoch: 10 cost time: 30.060175895690918
Epoch: 10, Steps: 1144 | Train Loss: 0.5045635 Vali Loss: 0.5047788 Test Loss: 0.2294068
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.22908757627010345, mae:0.26180699467658997
Use GPU: cuda:0
no_skip True
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.6588745
	speed: 0.0316s/iter; left time: 357.9573s
	iters: 200, epoch: 1 | loss: 0.6801176
	speed: 0.0311s/iter; left time: 349.9558s
	iters: 300, epoch: 1 | loss: 0.6542743
	speed: 0.0283s/iter; left time: 315.5591s
	iters: 400, epoch: 1 | loss: 0.4281988
	speed: 0.0269s/iter; left time: 297.1388s
	iters: 500, epoch: 1 | loss: 0.5755605
	speed: 0.0259s/iter; left time: 283.3326s
	iters: 600, epoch: 1 | loss: 0.3955375
	speed: 0.0252s/iter; left time: 272.7977s
	iters: 700, epoch: 1 | loss: 0.4726159
	speed: 0.0247s/iter; left time: 265.2125s
	iters: 800, epoch: 1 | loss: 0.5092691
	speed: 0.0243s/iter; left time: 258.5728s
	iters: 900, epoch: 1 | loss: 0.4093469
	speed: 0.0244s/iter; left time: 257.5294s
	iters: 1000, epoch: 1 | loss: 0.4591745
	speed: 0.0245s/iter; left time: 255.8988s
	iters: 1100, epoch: 1 | loss: 0.4580419
	speed: 0.0245s/iter; left time: 253.8433s
Epoch: 1 cost time: 28.222400426864624
Epoch: 1, Steps: 1144 | Train Loss: 0.6099756 Vali Loss: 0.5732169 Test Loss: 0.2406712
Validation loss decreased (inf --> 0.573217).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5105478
	speed: 0.0268s/iter; left time: 272.8006s
	iters: 200, epoch: 2 | loss: 0.4515669
	speed: 0.0224s/iter; left time: 226.1290s
	iters: 300, epoch: 2 | loss: 0.3664031
	speed: 0.0207s/iter; left time: 206.7147s
	iters: 400, epoch: 2 | loss: 0.3174670
	speed: 0.0196s/iter; left time: 194.4561s
	iters: 500, epoch: 2 | loss: 0.8790549
	speed: 0.0190s/iter; left time: 186.5195s
	iters: 600, epoch: 2 | loss: 0.4540306
	speed: 0.0197s/iter; left time: 191.3127s
	iters: 700, epoch: 2 | loss: 0.6132649
	speed: 0.0213s/iter; left time: 204.8951s
	iters: 800, epoch: 2 | loss: 0.4000118
	speed: 0.0215s/iter; left time: 203.7795s
	iters: 900, epoch: 2 | loss: 0.3179570
	speed: 0.0215s/iter; left time: 202.4711s
	iters: 1000, epoch: 2 | loss: 0.5795182
	speed: 0.0217s/iter; left time: 201.7068s
	iters: 1100, epoch: 2 | loss: 0.6399016
	speed: 0.0219s/iter; left time: 201.4696s
Epoch: 2 cost time: 25.275909662246704
Epoch: 2, Steps: 1144 | Train Loss: 0.5521014 Vali Loss: 0.5314373 Test Loss: 0.2349649
Validation loss decreased (0.573217 --> 0.531437).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4598985
	speed: 0.0400s/iter; left time: 362.0704s
	iters: 200, epoch: 3 | loss: 0.3621186
	speed: 0.0319s/iter; left time: 285.3318s
	iters: 300, epoch: 3 | loss: 0.5268866
	speed: 0.0285s/iter; left time: 251.9694s
	iters: 400, epoch: 3 | loss: 0.5374389
	speed: 0.0265s/iter; left time: 232.3503s
	iters: 500, epoch: 3 | loss: 1.0813713
	speed: 0.0258s/iter; left time: 223.1183s
	iters: 600, epoch: 3 | loss: 0.4645474
	speed: 0.0252s/iter; left time: 215.3263s
	iters: 700, epoch: 3 | loss: 0.3935763
	speed: 0.0248s/iter; left time: 209.4078s
	iters: 800, epoch: 3 | loss: 0.4843099
	speed: 0.0244s/iter; left time: 204.2196s
	iters: 900, epoch: 3 | loss: 0.3450319
	speed: 0.0241s/iter; left time: 199.1262s
	iters: 1000, epoch: 3 | loss: 0.4147407
	speed: 0.0238s/iter; left time: 194.4264s
	iters: 1100, epoch: 3 | loss: 0.4107849
	speed: 0.0238s/iter; left time: 191.2965s
Epoch: 3 cost time: 27.269659519195557
Epoch: 3, Steps: 1144 | Train Loss: 0.5312678 Vali Loss: 0.5220759 Test Loss: 0.2310317
Validation loss decreased (0.531437 --> 0.522076).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3573070
	speed: 0.0357s/iter; left time: 282.5656s
	iters: 200, epoch: 4 | loss: 0.3596314
	speed: 0.0291s/iter; left time: 227.3293s
	iters: 300, epoch: 4 | loss: 0.8666709
	speed: 0.0268s/iter; left time: 206.5196s
	iters: 400, epoch: 4 | loss: 0.4384521
	speed: 0.0256s/iter; left time: 194.5383s
	iters: 500, epoch: 4 | loss: 0.3272659
	speed: 0.0247s/iter; left time: 185.8389s
	iters: 600, epoch: 4 | loss: 0.4273399
	speed: 0.0254s/iter; left time: 188.2609s
	iters: 700, epoch: 4 | loss: 0.6747647
	speed: 0.0267s/iter; left time: 195.4606s
	iters: 800, epoch: 4 | loss: 0.7465987
	speed: 0.0276s/iter; left time: 198.7703s
	iters: 900, epoch: 4 | loss: 0.3385984
	speed: 0.0274s/iter; left time: 194.7622s
	iters: 1000, epoch: 4 | loss: 0.4332608
	speed: 0.0269s/iter; left time: 188.2564s
	iters: 1100, epoch: 4 | loss: 0.4104740
	speed: 0.0265s/iter; left time: 182.8875s
Epoch: 4 cost time: 30.240911722183228
Epoch: 4, Steps: 1144 | Train Loss: 0.5196939 Vali Loss: 0.5160463 Test Loss: 0.2301918
Validation loss decreased (0.522076 --> 0.516046).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5321501
	speed: 0.0239s/iter; left time: 161.5243s
	iters: 200, epoch: 5 | loss: 0.4799644
	speed: 0.0214s/iter; left time: 142.4315s
	iters: 300, epoch: 5 | loss: 0.5612116
	speed: 0.0210s/iter; left time: 137.6459s
	iters: 400, epoch: 5 | loss: 0.4577111
	speed: 0.0224s/iter; left time: 144.6471s
	iters: 500, epoch: 5 | loss: 0.3802459
	speed: 0.0223s/iter; left time: 141.6865s
	iters: 600, epoch: 5 | loss: 0.3653017
	speed: 0.0232s/iter; left time: 145.3042s
	iters: 700, epoch: 5 | loss: 0.4332729
	speed: 0.0246s/iter; left time: 151.8059s
	iters: 800, epoch: 5 | loss: 0.9144320
	speed: 0.0256s/iter; left time: 155.2121s
	iters: 900, epoch: 5 | loss: 0.4536618
	speed: 0.0259s/iter; left time: 154.5301s
	iters: 1000, epoch: 5 | loss: 0.3710971
	speed: 0.0260s/iter; left time: 152.2324s
	iters: 1100, epoch: 5 | loss: 0.4460969
	speed: 0.0259s/iter; left time: 149.4499s
Epoch: 5 cost time: 29.61379051208496
Epoch: 5, Steps: 1144 | Train Loss: 0.5138022 Vali Loss: 0.5129758 Test Loss: 0.2302143
Validation loss decreased (0.516046 --> 0.512976).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3579060
	speed: 0.0383s/iter; left time: 215.5017s
	iters: 200, epoch: 6 | loss: 0.8920854
	speed: 0.0326s/iter; left time: 179.8630s
	iters: 300, epoch: 6 | loss: 0.3977194
	speed: 0.0297s/iter; left time: 160.8372s
	iters: 400, epoch: 6 | loss: 0.4637034
	speed: 0.0282s/iter; left time: 150.1219s
	iters: 500, epoch: 6 | loss: 0.4081228
	speed: 0.0273s/iter; left time: 142.7929s
	iters: 600, epoch: 6 | loss: 0.4558991
	speed: 0.0268s/iter; left time: 137.2468s
	iters: 700, epoch: 6 | loss: 0.3428714
	speed: 0.0263s/iter; left time: 132.1289s
	iters: 800, epoch: 6 | loss: 0.8970776
	speed: 0.0255s/iter; left time: 125.4698s
	iters: 900, epoch: 6 | loss: 0.3899446
	speed: 0.0247s/iter; left time: 119.2773s
	iters: 1000, epoch: 6 | loss: 0.4633735
	speed: 0.0243s/iter; left time: 114.6283s
	iters: 1100, epoch: 6 | loss: 0.4949670
	speed: 0.0239s/iter; left time: 110.4725s
Epoch: 6 cost time: 27.25656747817993
Epoch: 6, Steps: 1144 | Train Loss: 0.5100582 Vali Loss: 0.5122052 Test Loss: 0.2289669
Validation loss decreased (0.512976 --> 0.512205).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3826297
	speed: 0.0356s/iter; left time: 159.4785s
	iters: 200, epoch: 7 | loss: 0.4597141
	speed: 0.0339s/iter; left time: 148.1691s
	iters: 300, epoch: 7 | loss: 0.5588958
	speed: 0.0344s/iter; left time: 147.3178s
	iters: 400, epoch: 7 | loss: 0.4280079
	speed: 0.0341s/iter; left time: 142.3596s
	iters: 500, epoch: 7 | loss: 0.4449508
	speed: 0.0342s/iter; left time: 139.2476s
	iters: 600, epoch: 7 | loss: 0.4776467
	speed: 0.0319s/iter; left time: 126.7810s
	iters: 700, epoch: 7 | loss: 0.3573093
	speed: 0.0300s/iter; left time: 116.4737s
	iters: 800, epoch: 7 | loss: 0.4854960
	speed: 0.0288s/iter; left time: 108.8528s
	iters: 900, epoch: 7 | loss: 0.3835246
	speed: 0.0278s/iter; left time: 102.3699s
	iters: 1000, epoch: 7 | loss: 1.3426914
	speed: 0.0268s/iter; left time: 95.7740s
	iters: 1100, epoch: 7 | loss: 0.4053217
	speed: 0.0260s/iter; left time: 90.3051s
Epoch: 7 cost time: 29.581527948379517
Epoch: 7, Steps: 1144 | Train Loss: 0.5084022 Vali Loss: 0.5118089 Test Loss: 0.2285704
Validation loss decreased (0.512205 --> 0.511809).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3093750
	speed: 0.0245s/iter; left time: 81.5586s
	iters: 200, epoch: 8 | loss: 0.4323216
	speed: 0.0211s/iter; left time: 68.2223s
	iters: 300, epoch: 8 | loss: 0.4364674
	speed: 0.0208s/iter; left time: 65.1700s
	iters: 400, epoch: 8 | loss: 0.8880123
	speed: 0.0205s/iter; left time: 62.0560s
	iters: 500, epoch: 8 | loss: 0.4386953
	speed: 0.0194s/iter; left time: 56.7979s
	iters: 600, epoch: 8 | loss: 0.4471218
	speed: 0.0196s/iter; left time: 55.4529s
	iters: 700, epoch: 8 | loss: 0.4842759
	speed: 0.0200s/iter; left time: 54.6011s
	iters: 800, epoch: 8 | loss: 1.3304135
	speed: 0.0203s/iter; left time: 53.4830s
	iters: 900, epoch: 8 | loss: 0.4045300
	speed: 0.0203s/iter; left time: 51.3046s
	iters: 1000, epoch: 8 | loss: 0.9519171
	speed: 0.0204s/iter; left time: 49.6141s
	iters: 1100, epoch: 8 | loss: 0.3188569
	speed: 0.0206s/iter; left time: 47.9700s
Epoch: 8 cost time: 23.738465070724487
Epoch: 8, Steps: 1144 | Train Loss: 0.5074075 Vali Loss: 0.5111634 Test Loss: 0.2286233
Validation loss decreased (0.511809 --> 0.511163).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3959727
	speed: 0.0345s/iter; left time: 75.5960s
	iters: 200, epoch: 9 | loss: 0.5152870
	speed: 0.0329s/iter; left time: 68.6831s
	iters: 300, epoch: 9 | loss: 0.9766034
	speed: 0.0315s/iter; left time: 62.6507s
	iters: 400, epoch: 9 | loss: 0.4415867
	speed: 0.0303s/iter; left time: 57.1527s
	iters: 500, epoch: 9 | loss: 0.8616967
	speed: 0.0303s/iter; left time: 54.2024s
	iters: 600, epoch: 9 | loss: 0.4195744
	speed: 0.0289s/iter; left time: 48.7428s
	iters: 700, epoch: 9 | loss: 0.3993394
	speed: 0.0283s/iter; left time: 44.9687s
	iters: 800, epoch: 9 | loss: 0.4266296
	speed: 0.0282s/iter; left time: 41.9978s
	iters: 900, epoch: 9 | loss: 0.8401423
	speed: 0.0278s/iter; left time: 38.5499s
	iters: 1000, epoch: 9 | loss: 0.4303441
	speed: 0.0274s/iter; left time: 35.2939s
	iters: 1100, epoch: 9 | loss: 0.5205382
	speed: 0.0269s/iter; left time: 31.9342s
Epoch: 9 cost time: 30.652470111846924
Epoch: 9, Steps: 1144 | Train Loss: 0.5068682 Vali Loss: 0.5116035 Test Loss: 0.2285647
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.9599672
	speed: 0.0314s/iter; left time: 32.7785s
	iters: 200, epoch: 10 | loss: 0.4950052
	speed: 0.0270s/iter; left time: 25.5366s
	iters: 300, epoch: 10 | loss: 0.4312811
	speed: 0.0257s/iter; left time: 21.6914s
	iters: 400, epoch: 10 | loss: 0.3565277
	speed: 0.0249s/iter; left time: 18.5379s
	iters: 500, epoch: 10 | loss: 0.4974668
	speed: 0.0244s/iter; left time: 15.7595s
	iters: 600, epoch: 10 | loss: 0.9896188
	speed: 0.0244s/iter; left time: 13.2905s
	iters: 700, epoch: 10 | loss: 0.8529999
	speed: 0.0242s/iter; left time: 10.7872s
	iters: 800, epoch: 10 | loss: 0.3897998
	speed: 0.0249s/iter; left time: 8.5766s
	iters: 900, epoch: 10 | loss: 1.0045923
	speed: 0.0255s/iter; left time: 6.2588s
	iters: 1000, epoch: 10 | loss: 0.4049825
	speed: 0.0255s/iter; left time: 3.6969s
	iters: 1100, epoch: 10 | loss: 0.4014542
	speed: 0.0252s/iter; left time: 1.1326s
Epoch: 10 cost time: 29.265486240386963
Epoch: 10, Steps: 1144 | Train Loss: 0.5066087 Vali Loss: 0.5106552 Test Loss: 0.2284742
Validation loss decreased (0.511163 --> 0.510655).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.22847425937652588, mae:0.2620573937892914
Seed: 123
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_336      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip True
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.7761517
	speed: 0.0445s/iter; left time: 502.6650s
	iters: 200, epoch: 1 | loss: 0.5760033
	speed: 0.0342s/iter; left time: 383.1797s
	iters: 300, epoch: 1 | loss: 0.6038486
	speed: 0.0304s/iter; left time: 337.0953s
	iters: 400, epoch: 1 | loss: 0.6591912
	speed: 0.0285s/iter; left time: 313.8737s
	iters: 500, epoch: 1 | loss: 1.1102188
	speed: 0.0299s/iter; left time: 325.5815s
	iters: 600, epoch: 1 | loss: 0.6610365
	speed: 0.0308s/iter; left time: 332.2727s
	iters: 700, epoch: 1 | loss: 0.6097841
	speed: 0.0310s/iter; left time: 331.7147s
	iters: 800, epoch: 1 | loss: 0.6112972
	speed: 0.0308s/iter; left time: 326.8778s
	iters: 900, epoch: 1 | loss: 0.5172440
	speed: 0.0299s/iter; left time: 313.5713s
	iters: 1000, epoch: 1 | loss: 0.5447751
	speed: 0.0298s/iter; left time: 309.6608s
	iters: 1100, epoch: 1 | loss: 0.6119528
	speed: 0.0289s/iter; left time: 297.6921s
Epoch: 1 cost time: 33.004669189453125
Epoch: 1, Steps: 1140 | Train Loss: 0.6874549 Vali Loss: 0.6672856 Test Loss: 0.2960205
Validation loss decreased (inf --> 0.667286).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6235892
	speed: 0.0359s/iter; left time: 364.7580s
	iters: 200, epoch: 2 | loss: 0.4700953
	speed: 0.0322s/iter; left time: 324.2452s
	iters: 300, epoch: 2 | loss: 0.4763961
	speed: 0.0314s/iter; left time: 312.5624s
	iters: 400, epoch: 2 | loss: 0.5509125
	speed: 0.0300s/iter; left time: 295.4372s
	iters: 500, epoch: 2 | loss: 0.9504104
	speed: 0.0289s/iter; left time: 281.8383s
	iters: 600, epoch: 2 | loss: 0.8986832
	speed: 0.0283s/iter; left time: 273.6583s
	iters: 700, epoch: 2 | loss: 0.4891577
	speed: 0.0282s/iter; left time: 269.4717s
	iters: 800, epoch: 2 | loss: 0.4951796
	speed: 0.0277s/iter; left time: 261.6116s
	iters: 900, epoch: 2 | loss: 0.5240843
	speed: 0.0271s/iter; left time: 253.9187s
	iters: 1000, epoch: 2 | loss: 0.4475198
	speed: 0.0266s/iter; left time: 246.6156s
	iters: 1100, epoch: 2 | loss: 0.8128387
	speed: 0.0262s/iter; left time: 240.1071s
Epoch: 2 cost time: 29.83135223388672
Epoch: 2, Steps: 1140 | Train Loss: 0.6302208 Vali Loss: 0.6337270 Test Loss: 0.2907417
Validation loss decreased (0.667286 --> 0.633727).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5746760
	speed: 0.0394s/iter; left time: 355.3319s
	iters: 200, epoch: 3 | loss: 0.4311044
	speed: 0.0311s/iter; left time: 277.8460s
	iters: 300, epoch: 3 | loss: 0.5796829
	speed: 0.0282s/iter; left time: 248.9512s
	iters: 400, epoch: 3 | loss: 0.5881845
	speed: 0.0269s/iter; left time: 234.8305s
	iters: 500, epoch: 3 | loss: 0.5365020
	speed: 0.0261s/iter; left time: 225.2393s
	iters: 600, epoch: 3 | loss: 0.5461992
	speed: 0.0253s/iter; left time: 215.2753s
	iters: 700, epoch: 3 | loss: 0.5010827
	speed: 0.0245s/iter; left time: 206.7326s
	iters: 800, epoch: 3 | loss: 0.5318858
	speed: 0.0239s/iter; left time: 199.1459s
	iters: 900, epoch: 3 | loss: 0.5719147
	speed: 0.0238s/iter; left time: 195.4511s
	iters: 1000, epoch: 3 | loss: 0.4263062
	speed: 0.0237s/iter; left time: 192.2739s
	iters: 1100, epoch: 3 | loss: 0.5203817
	speed: 0.0237s/iter; left time: 189.9066s
Epoch: 3 cost time: 26.936700105667114
Epoch: 3, Steps: 1140 | Train Loss: 0.6070781 Vali Loss: 0.6091577 Test Loss: 0.2865838
Validation loss decreased (0.633727 --> 0.609158).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.7513409
	speed: 0.0316s/iter; left time: 249.1011s
	iters: 200, epoch: 4 | loss: 0.5250130
	speed: 0.0276s/iter; left time: 215.0528s
	iters: 300, epoch: 4 | loss: 0.6541079
	speed: 0.0266s/iter; left time: 204.6353s
	iters: 400, epoch: 4 | loss: 0.4764709
	speed: 0.0257s/iter; left time: 195.0448s
	iters: 500, epoch: 4 | loss: 0.4904125
	speed: 0.0252s/iter; left time: 188.5990s
	iters: 600, epoch: 4 | loss: 0.5791895
	speed: 0.0247s/iter; left time: 182.2688s
	iters: 700, epoch: 4 | loss: 0.8069195
	speed: 0.0262s/iter; left time: 190.8771s
	iters: 800, epoch: 4 | loss: 0.4465742
	speed: 0.0258s/iter; left time: 185.3038s
	iters: 900, epoch: 4 | loss: 0.7926747
	speed: 0.0253s/iter; left time: 179.1092s
	iters: 1000, epoch: 4 | loss: 0.8022339
	speed: 0.0250s/iter; left time: 174.2164s
	iters: 1100, epoch: 4 | loss: 0.7873729
	speed: 0.0247s/iter; left time: 169.7919s
Epoch: 4 cost time: 28.145039081573486
Epoch: 4, Steps: 1140 | Train Loss: 0.5974050 Vali Loss: 0.6070067 Test Loss: 0.2865500
Validation loss decreased (0.609158 --> 0.607007).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.8974504
	speed: 0.0390s/iter; left time: 263.0587s
	iters: 200, epoch: 5 | loss: 0.6015882
	speed: 0.0374s/iter; left time: 248.1723s
	iters: 300, epoch: 5 | loss: 0.5519687
	speed: 0.0342s/iter; left time: 223.5613s
	iters: 400, epoch: 5 | loss: 1.0155963
	speed: 0.0313s/iter; left time: 201.4924s
	iters: 500, epoch: 5 | loss: 0.4933020
	speed: 0.0303s/iter; left time: 191.9046s
	iters: 600, epoch: 5 | loss: 0.4964433
	speed: 0.0297s/iter; left time: 185.4431s
	iters: 700, epoch: 5 | loss: 0.5616196
	speed: 0.0289s/iter; left time: 177.6329s
	iters: 800, epoch: 5 | loss: 0.4693070
	speed: 0.0282s/iter; left time: 170.6255s
	iters: 900, epoch: 5 | loss: 0.7362524
	speed: 0.0286s/iter; left time: 169.9770s
	iters: 1000, epoch: 5 | loss: 0.5524346
	speed: 0.0279s/iter; left time: 163.0842s
	iters: 1100, epoch: 5 | loss: 0.4869421
	speed: 0.0274s/iter; left time: 157.1464s
Epoch: 5 cost time: 31.022626161575317
Epoch: 5, Steps: 1140 | Train Loss: 0.5921029 Vali Loss: 0.6036975 Test Loss: 0.2858039
Validation loss decreased (0.607007 --> 0.603697).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4949189
	speed: 0.0413s/iter; left time: 231.2442s
	iters: 200, epoch: 6 | loss: 0.6746781
	speed: 0.0341s/iter; left time: 187.4787s
	iters: 300, epoch: 6 | loss: 0.4450291
	speed: 0.0301s/iter; left time: 162.7335s
	iters: 400, epoch: 6 | loss: 0.5455962
	speed: 0.0286s/iter; left time: 151.5990s
	iters: 500, epoch: 6 | loss: 0.5358462
	speed: 0.0273s/iter; left time: 142.0281s
	iters: 600, epoch: 6 | loss: 0.7915063
	speed: 0.0264s/iter; left time: 134.7880s
	iters: 700, epoch: 6 | loss: 0.7739270
	speed: 0.0254s/iter; left time: 126.8585s
	iters: 800, epoch: 6 | loss: 0.4196176
	speed: 0.0246s/iter; left time: 120.5889s
	iters: 900, epoch: 6 | loss: 1.0641629
	speed: 0.0239s/iter; left time: 114.7257s
	iters: 1000, epoch: 6 | loss: 0.5215819
	speed: 0.0229s/iter; left time: 107.6563s
	iters: 1100, epoch: 6 | loss: 0.4766258
	speed: 0.0221s/iter; left time: 101.6612s
Epoch: 6 cost time: 25.291157960891724
Epoch: 6, Steps: 1140 | Train Loss: 0.5892121 Vali Loss: 0.6005719 Test Loss: 0.2851191
Validation loss decreased (0.603697 --> 0.600572).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5065386
	speed: 0.0470s/iter; left time: 209.4475s
	iters: 200, epoch: 7 | loss: 1.0158859
	speed: 0.0418s/iter; left time: 182.1414s
	iters: 300, epoch: 7 | loss: 0.7260017
	speed: 0.0353s/iter; left time: 150.3283s
	iters: 400, epoch: 7 | loss: 0.4726444
	speed: 0.0324s/iter; left time: 134.9753s
	iters: 500, epoch: 7 | loss: 0.3962848
	speed: 0.0303s/iter; left time: 123.0880s
	iters: 600, epoch: 7 | loss: 0.6755537
	speed: 0.0289s/iter; left time: 114.5875s
	iters: 700, epoch: 7 | loss: 0.4341142
	speed: 0.0280s/iter; left time: 107.9925s
	iters: 800, epoch: 7 | loss: 0.5037243
	speed: 0.0273s/iter; left time: 102.7529s
	iters: 900, epoch: 7 | loss: 0.5013353
	speed: 0.0268s/iter; left time: 98.1563s
	iters: 1000, epoch: 7 | loss: 0.7658010
	speed: 0.0262s/iter; left time: 93.3822s
	iters: 1100, epoch: 7 | loss: 0.4785258
	speed: 0.0255s/iter; left time: 88.2589s
Epoch: 7 cost time: 28.664045095443726
Epoch: 7, Steps: 1140 | Train Loss: 0.5879158 Vali Loss: 0.5993809 Test Loss: 0.2848469
Validation loss decreased (0.600572 --> 0.599381).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.5298504
	speed: 0.0411s/iter; left time: 136.5335s
	iters: 200, epoch: 8 | loss: 0.6287006
	speed: 0.0403s/iter; left time: 129.9096s
	iters: 300, epoch: 8 | loss: 0.4303395
	speed: 0.0394s/iter; left time: 122.8228s
	iters: 400, epoch: 8 | loss: 0.9334201
	speed: 0.0392s/iter; left time: 118.3566s
	iters: 500, epoch: 8 | loss: 0.7762629
	speed: 0.0391s/iter; left time: 114.1394s
	iters: 600, epoch: 8 | loss: 0.5278904
	speed: 0.0371s/iter; left time: 104.6282s
	iters: 700, epoch: 8 | loss: 0.7487831
	speed: 0.0350s/iter; left time: 95.2536s
	iters: 800, epoch: 8 | loss: 0.5442901
	speed: 0.0348s/iter; left time: 91.2647s
	iters: 900, epoch: 8 | loss: 0.5676458
	speed: 0.0343s/iter; left time: 86.4257s
	iters: 1000, epoch: 8 | loss: 0.4794639
	speed: 0.0330s/iter; left time: 79.9624s
	iters: 1100, epoch: 8 | loss: 0.7781473
	speed: 0.0318s/iter; left time: 73.9149s
Epoch: 8 cost time: 35.92434501647949
Epoch: 8, Steps: 1140 | Train Loss: 0.5872720 Vali Loss: 0.6015851 Test Loss: 0.2848858
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.5562645
	speed: 0.0274s/iter; left time: 59.6863s
	iters: 200, epoch: 9 | loss: 1.1419777
	speed: 0.0268s/iter; left time: 55.8719s
	iters: 300, epoch: 9 | loss: 0.4141448
	speed: 0.0293s/iter; left time: 57.9552s
	iters: 400, epoch: 9 | loss: 0.7521294
	speed: 0.0285s/iter; left time: 53.5646s
	iters: 500, epoch: 9 | loss: 0.8354959
	speed: 0.0268s/iter; left time: 47.6770s
	iters: 600, epoch: 9 | loss: 0.6025257
	speed: 0.0253s/iter; left time: 42.5709s
	iters: 700, epoch: 9 | loss: 0.5542020
	speed: 0.0241s/iter; left time: 38.1049s
	iters: 800, epoch: 9 | loss: 0.5194155
	speed: 0.0237s/iter; left time: 35.1614s
	iters: 900, epoch: 9 | loss: 0.5018676
	speed: 0.0240s/iter; left time: 33.1909s
	iters: 1000, epoch: 9 | loss: 0.4448388
	speed: 0.0237s/iter; left time: 30.3593s
	iters: 1100, epoch: 9 | loss: 0.6107599
	speed: 0.0231s/iter; left time: 27.2790s
Epoch: 9 cost time: 26.16743302345276
Epoch: 9, Steps: 1140 | Train Loss: 0.5867616 Vali Loss: 0.6000405 Test Loss: 0.2848723
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.7601880
	speed: 0.0220s/iter; left time: 22.9291s
	iters: 200, epoch: 10 | loss: 0.5026934
	speed: 0.0204s/iter; left time: 19.1717s
	iters: 300, epoch: 10 | loss: 0.6983982
	speed: 0.0227s/iter; left time: 19.0575s
	iters: 400, epoch: 10 | loss: 0.5151266
	speed: 0.0236s/iter; left time: 17.4820s
	iters: 500, epoch: 10 | loss: 0.5306305
	speed: 0.0251s/iter; left time: 16.0941s
	iters: 600, epoch: 10 | loss: 0.7924944
	speed: 0.0246s/iter; left time: 13.3329s
	iters: 700, epoch: 10 | loss: 0.7962822
	speed: 0.0247s/iter; left time: 10.8896s
	iters: 800, epoch: 10 | loss: 0.4888295
	speed: 0.0249s/iter; left time: 8.4952s
	iters: 900, epoch: 10 | loss: 0.5351241
	speed: 0.0256s/iter; left time: 6.1706s
	iters: 1000, epoch: 10 | loss: 0.4615855
	speed: 0.0261s/iter; left time: 3.6834s
	iters: 1100, epoch: 10 | loss: 0.5252570
	speed: 0.0268s/iter; left time: 1.1004s
Epoch: 10 cost time: 30.621715784072876
Epoch: 10, Steps: 1140 | Train Loss: 0.5867344 Vali Loss: 0.6004208 Test Loss: 0.2848440
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.2848469018936157, mae:0.3021772503852844
Use GPU: cuda:0
no_skip True
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.5839515
	speed: 0.0318s/iter; left time: 359.5290s
	iters: 200, epoch: 1 | loss: 0.5726721
	speed: 0.0275s/iter; left time: 308.1047s
	iters: 300, epoch: 1 | loss: 0.5590609
	speed: 0.0261s/iter; left time: 289.4937s
	iters: 400, epoch: 1 | loss: 1.0447944
	speed: 0.0253s/iter; left time: 278.0935s
	iters: 500, epoch: 1 | loss: 0.5637668
	speed: 0.0253s/iter; left time: 276.2280s
	iters: 600, epoch: 1 | loss: 0.6267304
	speed: 0.0253s/iter; left time: 273.4927s
	iters: 700, epoch: 1 | loss: 0.4449539
	speed: 0.0248s/iter; left time: 265.9156s
	iters: 800, epoch: 1 | loss: 0.6202139
	speed: 0.0247s/iter; left time: 261.8291s
	iters: 900, epoch: 1 | loss: 0.7330709
	speed: 0.0245s/iter; left time: 256.8208s
	iters: 1000, epoch: 1 | loss: 0.7829309
	speed: 0.0243s/iter; left time: 252.7383s
	iters: 1100, epoch: 1 | loss: 0.7392837
	speed: 0.0244s/iter; left time: 251.0309s
Epoch: 1 cost time: 28.160175323486328
Epoch: 1, Steps: 1140 | Train Loss: 0.6694759 Vali Loss: 0.6400058 Test Loss: 0.2928067
Validation loss decreased (inf --> 0.640006).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6322205
	speed: 0.0321s/iter; left time: 326.6389s
	iters: 200, epoch: 2 | loss: 1.0320745
	speed: 0.0247s/iter; left time: 248.9388s
	iters: 300, epoch: 2 | loss: 0.5000662
	speed: 0.0214s/iter; left time: 213.1724s
	iters: 400, epoch: 2 | loss: 0.5353962
	speed: 0.0199s/iter; left time: 196.2807s
	iters: 500, epoch: 2 | loss: 0.4696749
	speed: 0.0193s/iter; left time: 188.7165s
	iters: 600, epoch: 2 | loss: 0.5340924
	speed: 0.0203s/iter; left time: 195.6374s
	iters: 700, epoch: 2 | loss: 0.7889650
	speed: 0.0209s/iter; left time: 199.9110s
	iters: 800, epoch: 2 | loss: 0.6802635
	speed: 0.0211s/iter; left time: 199.3637s
	iters: 900, epoch: 2 | loss: 0.5385661
	speed: 0.0217s/iter; left time: 203.1577s
	iters: 1000, epoch: 2 | loss: 0.4692634
	speed: 0.0228s/iter; left time: 210.8157s
	iters: 1100, epoch: 2 | loss: 0.5169581
	speed: 0.0239s/iter; left time: 218.7800s
Epoch: 2 cost time: 27.395015716552734
Epoch: 2, Steps: 1140 | Train Loss: 0.6171458 Vali Loss: 0.6648889 Test Loss: 0.3001547
EarlyStopping counter: 1 out of 5
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3970843
	speed: 0.0301s/iter; left time: 271.7698s
	iters: 200, epoch: 3 | loss: 0.5711584
	speed: 0.0265s/iter; left time: 236.1638s
	iters: 300, epoch: 3 | loss: 0.6840312
	speed: 0.0252s/iter; left time: 222.5726s
	iters: 400, epoch: 3 | loss: 0.7170854
	speed: 0.0255s/iter; left time: 222.1467s
	iters: 500, epoch: 3 | loss: 1.0249349
	speed: 0.0254s/iter; left time: 218.5890s
	iters: 600, epoch: 3 | loss: 0.5400553
	speed: 0.0249s/iter; left time: 212.1306s
	iters: 700, epoch: 3 | loss: 0.7180969
	speed: 0.0244s/iter; left time: 205.1988s
	iters: 800, epoch: 3 | loss: 0.5424186
	speed: 0.0241s/iter; left time: 200.4585s
	iters: 900, epoch: 3 | loss: 0.6222621
	speed: 0.0239s/iter; left time: 196.0983s
	iters: 1000, epoch: 3 | loss: 0.5452539
	speed: 0.0236s/iter; left time: 191.6853s
	iters: 1100, epoch: 3 | loss: 0.4921731
	speed: 0.0246s/iter; left time: 197.0331s
Epoch: 3 cost time: 28.282208919525146
Epoch: 3, Steps: 1140 | Train Loss: 0.5982589 Vali Loss: 0.6203343 Test Loss: 0.2878644
Validation loss decreased (0.640006 --> 0.620334).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4598619
	speed: 0.0301s/iter; left time: 237.2356s
	iters: 200, epoch: 4 | loss: 0.5223380
	speed: 0.0270s/iter; left time: 210.1773s
	iters: 300, epoch: 4 | loss: 0.4277726
	speed: 0.0282s/iter; left time: 216.9123s
	iters: 400, epoch: 4 | loss: 0.5516278
	speed: 0.0291s/iter; left time: 220.2454s
	iters: 500, epoch: 4 | loss: 0.5318875
	speed: 0.0286s/iter; left time: 213.9311s
	iters: 600, epoch: 4 | loss: 0.8378965
	speed: 0.0277s/iter; left time: 204.2313s
	iters: 700, epoch: 4 | loss: 0.5157945
	speed: 0.0270s/iter; left time: 196.9303s
	iters: 800, epoch: 4 | loss: 0.4783543
	speed: 0.0265s/iter; left time: 190.0931s
	iters: 900, epoch: 4 | loss: 0.6085910
	speed: 0.0260s/iter; left time: 184.1849s
	iters: 1000, epoch: 4 | loss: 0.5471859
	speed: 0.0258s/iter; left time: 180.1455s
	iters: 1100, epoch: 4 | loss: 0.4190513
	speed: 0.0256s/iter; left time: 176.4019s
Epoch: 4 cost time: 29.185901403427124
Epoch: 4, Steps: 1140 | Train Loss: 0.5878822 Vali Loss: 0.6108333 Test Loss: 0.2863955
Validation loss decreased (0.620334 --> 0.610833).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4479637
	speed: 0.0353s/iter; left time: 238.1219s
	iters: 200, epoch: 5 | loss: 0.5487689
	speed: 0.0266s/iter; left time: 176.7406s
	iters: 300, epoch: 5 | loss: 0.4344246
	speed: 0.0251s/iter; left time: 163.8594s
	iters: 400, epoch: 5 | loss: 0.7209927
	speed: 0.0255s/iter; left time: 164.4900s
	iters: 500, epoch: 5 | loss: 0.4904837
	speed: 0.0243s/iter; left time: 154.1245s
	iters: 600, epoch: 5 | loss: 0.4965624
	speed: 0.0230s/iter; left time: 143.7547s
	iters: 700, epoch: 5 | loss: 0.6273847
	speed: 0.0229s/iter; left time: 140.4535s
	iters: 800, epoch: 5 | loss: 0.5104578
	speed: 0.0227s/iter; left time: 137.1884s
	iters: 900, epoch: 5 | loss: 0.7493358
	speed: 0.0226s/iter; left time: 134.0338s
	iters: 1000, epoch: 5 | loss: 0.4816798
	speed: 0.0227s/iter; left time: 132.4280s
	iters: 1100, epoch: 5 | loss: 0.5466093
	speed: 0.0228s/iter; left time: 130.9728s
Epoch: 5 cost time: 26.087509393692017
Epoch: 5, Steps: 1140 | Train Loss: 0.5824495 Vali Loss: 0.6012236 Test Loss: 0.2853825
Validation loss decreased (0.610833 --> 0.601224).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5240362
	speed: 0.0427s/iter; left time: 238.9804s
	iters: 200, epoch: 6 | loss: 0.6683354
	speed: 0.0359s/iter; left time: 197.7068s
	iters: 300, epoch: 6 | loss: 0.4735489
	speed: 0.0320s/iter; left time: 172.9145s
	iters: 400, epoch: 6 | loss: 0.3856014
	speed: 0.0297s/iter; left time: 157.3934s
	iters: 500, epoch: 6 | loss: 0.7554810
	speed: 0.0283s/iter; left time: 147.3219s
	iters: 600, epoch: 6 | loss: 0.5393591
	speed: 0.0273s/iter; left time: 139.4999s
	iters: 700, epoch: 6 | loss: 0.4915609
	speed: 0.0268s/iter; left time: 133.9949s
	iters: 800, epoch: 6 | loss: 0.4801102
	speed: 0.0265s/iter; left time: 129.7340s
	iters: 900, epoch: 6 | loss: 0.4690964
	speed: 0.0261s/iter; left time: 125.2831s
	iters: 1000, epoch: 6 | loss: 0.8274689
	speed: 0.0257s/iter; left time: 120.7046s
	iters: 1100, epoch: 6 | loss: 0.4036099
	speed: 0.0253s/iter; left time: 116.2515s
Epoch: 6 cost time: 28.708792209625244
Epoch: 6, Steps: 1140 | Train Loss: 0.5786220 Vali Loss: 0.6009050 Test Loss: 0.2847627
Validation loss decreased (0.601224 --> 0.600905).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4396474
	speed: 0.0438s/iter; left time: 195.2103s
	iters: 200, epoch: 7 | loss: 0.4494139
	speed: 0.0417s/iter; left time: 181.7612s
	iters: 300, epoch: 7 | loss: 0.5509627
	speed: 0.0357s/iter; left time: 152.0316s
	iters: 400, epoch: 7 | loss: 0.8521255
	speed: 0.0327s/iter; left time: 136.0457s
	iters: 500, epoch: 7 | loss: 0.5375848
	speed: 0.0306s/iter; left time: 124.4227s
	iters: 600, epoch: 7 | loss: 0.4937171
	speed: 0.0293s/iter; left time: 115.9142s
	iters: 700, epoch: 7 | loss: 0.4458235
	speed: 0.0283s/iter; left time: 109.4102s
	iters: 800, epoch: 7 | loss: 0.5718961
	speed: 0.0275s/iter; left time: 103.3627s
	iters: 900, epoch: 7 | loss: 0.5312833
	speed: 0.0269s/iter; left time: 98.5125s
	iters: 1000, epoch: 7 | loss: 0.7076997
	speed: 0.0264s/iter; left time: 94.0630s
	iters: 1100, epoch: 7 | loss: 0.5099476
	speed: 0.0260s/iter; left time: 90.0541s
Epoch: 7 cost time: 29.94993495941162
Epoch: 7, Steps: 1140 | Train Loss: 0.5772473 Vali Loss: 0.6014735 Test Loss: 0.2845788
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4382422
	speed: 0.0259s/iter; left time: 85.9941s
	iters: 200, epoch: 8 | loss: 0.5509931
	speed: 0.0234s/iter; left time: 75.2716s
	iters: 300, epoch: 8 | loss: 0.4604000
	speed: 0.0224s/iter; left time: 69.8942s
	iters: 400, epoch: 8 | loss: 0.5172202
	speed: 0.0215s/iter; left time: 64.9795s
	iters: 500, epoch: 8 | loss: 0.5551358
	speed: 0.0205s/iter; left time: 59.8704s
	iters: 600, epoch: 8 | loss: 0.5551004
	speed: 0.0198s/iter; left time: 55.9180s
	iters: 700, epoch: 8 | loss: 0.3981084
	speed: 0.0193s/iter; left time: 52.5167s
	iters: 800, epoch: 8 | loss: 0.7753545
	speed: 0.0190s/iter; left time: 49.7380s
	iters: 900, epoch: 8 | loss: 0.5865376
	speed: 0.0195s/iter; left time: 49.2069s
	iters: 1000, epoch: 8 | loss: 0.5826442
	speed: 0.0201s/iter; left time: 48.5961s
	iters: 1100, epoch: 8 | loss: 0.4694114
	speed: 0.0205s/iter; left time: 47.6362s
Epoch: 8 cost time: 23.71169662475586
Epoch: 8, Steps: 1140 | Train Loss: 0.5759161 Vali Loss: 0.5996007 Test Loss: 0.2844847
Validation loss decreased (0.600905 --> 0.599601).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4712873
	speed: 0.0326s/iter; left time: 70.9945s
	iters: 200, epoch: 9 | loss: 1.2916992
	speed: 0.0286s/iter; left time: 59.5284s
	iters: 300, epoch: 9 | loss: 0.5515157
	speed: 0.0262s/iter; left time: 51.9920s
	iters: 400, epoch: 9 | loss: 0.4606524
	speed: 0.0275s/iter; left time: 51.7083s
	iters: 500, epoch: 9 | loss: 0.4587227
	speed: 0.0278s/iter; left time: 49.5403s
	iters: 600, epoch: 9 | loss: 0.8899857
	speed: 0.0272s/iter; left time: 45.7607s
	iters: 700, epoch: 9 | loss: 0.5253613
	speed: 0.0268s/iter; left time: 42.3498s
	iters: 800, epoch: 9 | loss: 0.8132521
	speed: 0.0265s/iter; left time: 39.2432s
	iters: 900, epoch: 9 | loss: 0.4724937
	speed: 0.0263s/iter; left time: 36.2520s
	iters: 1000, epoch: 9 | loss: 0.5146246
	speed: 0.0260s/iter; left time: 33.3653s
	iters: 1100, epoch: 9 | loss: 0.4927976
	speed: 0.0259s/iter; left time: 30.5799s
Epoch: 9 cost time: 29.59659719467163
Epoch: 9, Steps: 1140 | Train Loss: 0.5756374 Vali Loss: 0.5983601 Test Loss: 0.2843694
Validation loss decreased (0.599601 --> 0.598360).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.5301813
	speed: 0.0261s/iter; left time: 27.1446s
	iters: 200, epoch: 10 | loss: 0.5713655
	speed: 0.0251s/iter; left time: 23.6008s
	iters: 300, epoch: 10 | loss: 0.6423439
	speed: 0.0244s/iter; left time: 20.5023s
	iters: 400, epoch: 10 | loss: 0.5005341
	speed: 0.0240s/iter; left time: 17.7903s
	iters: 500, epoch: 10 | loss: 0.6177709
	speed: 0.0240s/iter; left time: 15.4096s
	iters: 600, epoch: 10 | loss: 0.4688095
	speed: 0.0239s/iter; left time: 12.9210s
	iters: 700, epoch: 10 | loss: 0.4561775
	speed: 0.0237s/iter; left time: 10.4624s
	iters: 800, epoch: 10 | loss: 0.4039057
	speed: 0.0236s/iter; left time: 8.0560s
	iters: 900, epoch: 10 | loss: 0.4630648
	speed: 0.0236s/iter; left time: 5.6757s
	iters: 1000, epoch: 10 | loss: 0.6929002
	speed: 0.0235s/iter; left time: 3.3095s
	iters: 1100, epoch: 10 | loss: 0.5545346
	speed: 0.0233s/iter; left time: 0.9571s
Epoch: 10 cost time: 26.772179126739502
Epoch: 10, Steps: 1140 | Train Loss: 0.5753563 Vali Loss: 0.5993474 Test Loss: 0.2843804
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.28436940908432007, mae:0.3019813597202301
Use GPU: cuda:0
no_skip True
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.9236866
	speed: 0.0291s/iter; left time: 328.4397s
	iters: 200, epoch: 1 | loss: 0.6261807
	speed: 0.0249s/iter; left time: 279.0810s
	iters: 300, epoch: 1 | loss: 0.8767303
	speed: 0.0229s/iter; left time: 254.3366s
	iters: 400, epoch: 1 | loss: 0.6317915
	speed: 0.0238s/iter; left time: 261.4905s
	iters: 500, epoch: 1 | loss: 0.5517083
	speed: 0.0251s/iter; left time: 274.0918s
	iters: 600, epoch: 1 | loss: 0.6333407
	speed: 0.0256s/iter; left time: 276.3274s
	iters: 700, epoch: 1 | loss: 0.7776397
	speed: 0.0253s/iter; left time: 270.4563s
	iters: 800, epoch: 1 | loss: 0.6295594
	speed: 0.0249s/iter; left time: 264.3542s
	iters: 900, epoch: 1 | loss: 0.5967571
	speed: 0.0247s/iter; left time: 259.5085s
	iters: 1000, epoch: 1 | loss: 0.5618085
	speed: 0.0245s/iter; left time: 254.9425s
	iters: 1100, epoch: 1 | loss: 0.5527061
	speed: 0.0241s/iter; left time: 248.0117s
Epoch: 1 cost time: 27.446059226989746
Epoch: 1, Steps: 1140 | Train Loss: 0.6740376 Vali Loss: 0.6452141 Test Loss: 0.2922083
Validation loss decreased (inf --> 0.645214).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5142487
	speed: 0.0465s/iter; left time: 472.3466s
	iters: 200, epoch: 2 | loss: 0.5549827
	speed: 0.0436s/iter; left time: 438.5330s
	iters: 300, epoch: 2 | loss: 0.5405932
	speed: 0.0408s/iter; left time: 406.7764s
	iters: 400, epoch: 2 | loss: 0.6117054
	speed: 0.0400s/iter; left time: 394.1078s
	iters: 500, epoch: 2 | loss: 0.5719549
	speed: 0.0392s/iter; left time: 382.5055s
	iters: 600, epoch: 2 | loss: 0.6538409
	speed: 0.0381s/iter; left time: 368.1925s
	iters: 700, epoch: 2 | loss: 0.5150834
	speed: 0.0366s/iter; left time: 349.5070s
	iters: 800, epoch: 2 | loss: 0.8346744
	speed: 0.0345s/iter; left time: 326.2670s
	iters: 900, epoch: 2 | loss: 1.1706731
	speed: 0.0328s/iter; left time: 306.9102s
	iters: 1000, epoch: 2 | loss: 0.4746070
	speed: 0.0314s/iter; left time: 291.0993s
	iters: 1100, epoch: 2 | loss: 0.5996606
	speed: 0.0304s/iter; left time: 278.3972s
Epoch: 2 cost time: 34.4096565246582
Epoch: 2, Steps: 1140 | Train Loss: 0.6203989 Vali Loss: 0.6167758 Test Loss: 0.2894259
Validation loss decreased (0.645214 --> 0.616776).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6047568
	speed: 0.0473s/iter; left time: 426.3648s
	iters: 200, epoch: 3 | loss: 0.6959336
	speed: 0.0394s/iter; left time: 351.4314s
	iters: 300, epoch: 3 | loss: 0.5475016
	speed: 0.0345s/iter; left time: 304.3220s
	iters: 400, epoch: 3 | loss: 0.4743549
	speed: 0.0322s/iter; left time: 280.7265s
	iters: 500, epoch: 3 | loss: 0.4911039
	speed: 0.0307s/iter; left time: 264.7623s
	iters: 600, epoch: 3 | loss: 0.4804709
	speed: 0.0297s/iter; left time: 253.2617s
	iters: 700, epoch: 3 | loss: 0.5422496
	speed: 0.0290s/iter; left time: 244.1174s
	iters: 800, epoch: 3 | loss: 0.5374136
	speed: 0.0289s/iter; left time: 240.1469s
	iters: 900, epoch: 3 | loss: 0.5057049
	speed: 0.0275s/iter; left time: 225.7202s
	iters: 1000, epoch: 3 | loss: 0.5738645
	speed: 0.0263s/iter; left time: 213.6905s
	iters: 1100, epoch: 3 | loss: 0.6090186
	speed: 0.0254s/iter; left time: 203.9972s
Epoch: 3 cost time: 28.88469958305359
Epoch: 3, Steps: 1140 | Train Loss: 0.6002569 Vali Loss: 0.6229307 Test Loss: 0.2883021
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5066305
	speed: 0.0336s/iter; left time: 264.7703s
	iters: 200, epoch: 4 | loss: 0.4989484
	speed: 0.0308s/iter; left time: 239.7002s
	iters: 300, epoch: 4 | loss: 0.6352002
	speed: 0.0289s/iter; left time: 221.7001s
	iters: 400, epoch: 4 | loss: 0.8439692
	speed: 0.0278s/iter; left time: 210.4702s
	iters: 500, epoch: 4 | loss: 0.4902870
	speed: 0.0272s/iter; left time: 203.1682s
	iters: 600, epoch: 4 | loss: 0.5337936
	speed: 0.0267s/iter; left time: 196.7888s
	iters: 700, epoch: 4 | loss: 0.6666374
	speed: 0.0271s/iter; left time: 197.2230s
	iters: 800, epoch: 4 | loss: 0.4998882
	speed: 0.0265s/iter; left time: 189.9588s
	iters: 900, epoch: 4 | loss: 0.4938442
	speed: 0.0260s/iter; left time: 183.9127s
	iters: 1000, epoch: 4 | loss: 0.7936766
	speed: 0.0257s/iter; left time: 179.0745s
	iters: 1100, epoch: 4 | loss: 0.6115366
	speed: 0.0259s/iter; left time: 178.1668s
Epoch: 4 cost time: 29.462490797042847
Epoch: 4, Steps: 1140 | Train Loss: 0.5901406 Vali Loss: 0.6077248 Test Loss: 0.2846203
Validation loss decreased (0.616776 --> 0.607725).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4897963
	speed: 0.0282s/iter; left time: 190.3875s
	iters: 200, epoch: 5 | loss: 0.4627806
	speed: 0.0265s/iter; left time: 176.1794s
	iters: 300, epoch: 5 | loss: 0.7826489
	speed: 0.0260s/iter; left time: 170.3082s
	iters: 400, epoch: 5 | loss: 0.7192927
	speed: 0.0257s/iter; left time: 165.7846s
	iters: 500, epoch: 5 | loss: 0.5855359
	speed: 0.0254s/iter; left time: 161.1355s
	iters: 600, epoch: 5 | loss: 0.5531271
	speed: 0.0256s/iter; left time: 159.4889s
	iters: 700, epoch: 5 | loss: 0.4667769
	speed: 0.0252s/iter; left time: 154.9210s
	iters: 800, epoch: 5 | loss: 0.5110264
	speed: 0.0256s/iter; left time: 154.7616s
	iters: 900, epoch: 5 | loss: 0.4752646
	speed: 0.0259s/iter; left time: 154.1149s
	iters: 1000, epoch: 5 | loss: 0.5489897
	speed: 0.0255s/iter; left time: 148.8431s
	iters: 1100, epoch: 5 | loss: 0.7627869
	speed: 0.0250s/iter; left time: 143.5312s
Epoch: 5 cost time: 28.408252716064453
Epoch: 5, Steps: 1140 | Train Loss: 0.5837744 Vali Loss: 0.6058238 Test Loss: 0.2834459
Validation loss decreased (0.607725 --> 0.605824).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5258679
	speed: 0.0394s/iter; left time: 220.4947s
	iters: 200, epoch: 6 | loss: 0.4869424
	speed: 0.0378s/iter; left time: 207.7693s
	iters: 300, epoch: 6 | loss: 0.5445856
	speed: 0.0358s/iter; left time: 193.3423s
	iters: 400, epoch: 6 | loss: 0.5678794
	speed: 0.0369s/iter; left time: 195.5914s
	iters: 500, epoch: 6 | loss: 0.6410658
	speed: 0.0343s/iter; left time: 178.4204s
	iters: 600, epoch: 6 | loss: 0.6095929
	speed: 0.0325s/iter; left time: 166.0180s
	iters: 700, epoch: 6 | loss: 0.5230348
	speed: 0.0317s/iter; left time: 158.3235s
	iters: 800, epoch: 6 | loss: 0.4375193
	speed: 0.0301s/iter; left time: 147.6987s
	iters: 900, epoch: 6 | loss: 0.4850076
	speed: 0.0293s/iter; left time: 140.5747s
	iters: 1000, epoch: 6 | loss: 0.5752506
	speed: 0.0283s/iter; left time: 133.0023s
	iters: 1100, epoch: 6 | loss: 0.4430803
	speed: 0.0270s/iter; left time: 124.2051s
Epoch: 6 cost time: 30.47551465034485
Epoch: 6, Steps: 1140 | Train Loss: 0.5804267 Vali Loss: 0.6075698 Test Loss: 0.2836923
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5288271
	speed: 0.0265s/iter; left time: 118.0385s
	iters: 200, epoch: 7 | loss: 0.5244341
	speed: 0.0255s/iter; left time: 111.3316s
	iters: 300, epoch: 7 | loss: 0.4797790
	speed: 0.0252s/iter; left time: 107.3070s
	iters: 400, epoch: 7 | loss: 0.4497537
	speed: 0.0249s/iter; left time: 103.7497s
	iters: 500, epoch: 7 | loss: 0.4396993
	speed: 0.0248s/iter; left time: 100.5427s
	iters: 600, epoch: 7 | loss: 0.3675693
	speed: 0.0246s/iter; left time: 97.5772s
	iters: 700, epoch: 7 | loss: 0.5735289
	speed: 0.0243s/iter; left time: 93.9752s
	iters: 800, epoch: 7 | loss: 0.5149505
	speed: 0.0240s/iter; left time: 90.2320s
	iters: 900, epoch: 7 | loss: 0.4831875
	speed: 0.0238s/iter; left time: 87.3071s
	iters: 1000, epoch: 7 | loss: 0.4708902
	speed: 0.0237s/iter; left time: 84.5056s
	iters: 1100, epoch: 7 | loss: 0.6060620
	speed: 0.0235s/iter; left time: 81.4894s
Epoch: 7 cost time: 26.994940042495728
Epoch: 7, Steps: 1140 | Train Loss: 0.5790563 Vali Loss: 0.6048295 Test Loss: 0.2829736
Validation loss decreased (0.605824 --> 0.604830).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.8253194
	speed: 0.0253s/iter; left time: 84.1003s
	iters: 200, epoch: 8 | loss: 0.4515924
	speed: 0.0236s/iter; left time: 76.1228s
	iters: 300, epoch: 8 | loss: 0.4302040
	speed: 0.0238s/iter; left time: 74.3554s
	iters: 400, epoch: 8 | loss: 0.4941559
	speed: 0.0239s/iter; left time: 72.3345s
	iters: 500, epoch: 8 | loss: 0.7079928
	speed: 0.0240s/iter; left time: 70.1043s
	iters: 600, epoch: 8 | loss: 0.5834565
	speed: 0.0240s/iter; left time: 67.8091s
	iters: 700, epoch: 8 | loss: 0.7764542
	speed: 0.0240s/iter; left time: 65.4099s
	iters: 800, epoch: 8 | loss: 0.6383221
	speed: 0.0241s/iter; left time: 63.0511s
	iters: 900, epoch: 8 | loss: 0.5431420
	speed: 0.0241s/iter; left time: 60.7096s
	iters: 1000, epoch: 8 | loss: 0.8178470
	speed: 0.0241s/iter; left time: 58.3089s
	iters: 1100, epoch: 8 | loss: 0.4335045
	speed: 0.0248s/iter; left time: 57.5170s
Epoch: 8 cost time: 28.24943494796753
Epoch: 8, Steps: 1140 | Train Loss: 0.5775883 Vali Loss: 0.6027967 Test Loss: 0.2827070
Validation loss decreased (0.604830 --> 0.602797).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4249018
	speed: 0.0318s/iter; left time: 69.4406s
	iters: 200, epoch: 9 | loss: 0.4060981
	speed: 0.0281s/iter; left time: 58.5584s
	iters: 300, epoch: 9 | loss: 0.5011668
	speed: 0.0293s/iter; left time: 58.0737s
	iters: 400, epoch: 9 | loss: 0.4792362
	speed: 0.0304s/iter; left time: 57.1867s
	iters: 500, epoch: 9 | loss: 0.4855739
	speed: 0.0304s/iter; left time: 54.1671s
	iters: 600, epoch: 9 | loss: 0.4421530
	speed: 0.0311s/iter; left time: 52.3601s
	iters: 700, epoch: 9 | loss: 0.4167835
	speed: 0.0316s/iter; left time: 50.0082s
	iters: 800, epoch: 9 | loss: 0.4565146
	speed: 0.0314s/iter; left time: 46.4726s
	iters: 900, epoch: 9 | loss: 0.4915144
	speed: 0.0296s/iter; left time: 40.9452s
	iters: 1000, epoch: 9 | loss: 0.8016489
	speed: 0.0281s/iter; left time: 36.0542s
	iters: 1100, epoch: 9 | loss: 0.6841536
	speed: 0.0268s/iter; left time: 31.6309s
Epoch: 9 cost time: 30.117525815963745
Epoch: 9, Steps: 1140 | Train Loss: 0.5772312 Vali Loss: 0.6069740 Test Loss: 0.2827368
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.7525830
	speed: 0.0276s/iter; left time: 28.7796s
	iters: 200, epoch: 10 | loss: 0.5108641
	speed: 0.0245s/iter; left time: 23.0130s
	iters: 300, epoch: 10 | loss: 0.8317216
	speed: 0.0237s/iter; left time: 19.9253s
	iters: 400, epoch: 10 | loss: 0.5617203
	speed: 0.0233s/iter; left time: 17.2796s
	iters: 500, epoch: 10 | loss: 0.4743907
	speed: 0.0241s/iter; left time: 15.4800s
	iters: 600, epoch: 10 | loss: 0.4098686
	speed: 0.0243s/iter; left time: 13.1287s
	iters: 700, epoch: 10 | loss: 0.5969439
	speed: 0.0244s/iter; left time: 10.7490s
	iters: 800, epoch: 10 | loss: 0.7685130
	speed: 0.0244s/iter; left time: 8.3370s
	iters: 900, epoch: 10 | loss: 0.4250599
	speed: 0.0245s/iter; left time: 5.9061s
	iters: 1000, epoch: 10 | loss: 0.7358356
	speed: 0.0245s/iter; left time: 3.4566s
	iters: 1100, epoch: 10 | loss: 0.4306393
	speed: 0.0244s/iter; left time: 0.9996s
Epoch: 10 cost time: 27.847752571105957
Epoch: 10, Steps: 1140 | Train Loss: 0.5767550 Vali Loss: 0.6032736 Test Loss: 0.2825534
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.28270697593688965, mae:0.30108511447906494
Seed: 123
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_720      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip True
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.6938655
	speed: 0.0543s/iter; left time: 607.1124s
	iters: 200, epoch: 1 | loss: 0.6067713
	speed: 0.0401s/iter; left time: 443.8082s
	iters: 300, epoch: 1 | loss: 0.7619923
	speed: 0.0348s/iter; left time: 382.0788s
	iters: 400, epoch: 1 | loss: 0.7081260
	speed: 0.0318s/iter; left time: 345.6664s
	iters: 500, epoch: 1 | loss: 0.6502836
	speed: 0.0302s/iter; left time: 325.9348s
	iters: 600, epoch: 1 | loss: 0.7215496
	speed: 0.0287s/iter; left time: 306.3480s
	iters: 700, epoch: 1 | loss: 0.7134209
	speed: 0.0274s/iter; left time: 290.2698s
	iters: 800, epoch: 1 | loss: 0.6443169
	speed: 0.0268s/iter; left time: 280.9540s
	iters: 900, epoch: 1 | loss: 0.6585306
	speed: 0.0267s/iter; left time: 277.4704s
	iters: 1000, epoch: 1 | loss: 0.7322791
	speed: 0.0263s/iter; left time: 270.1068s
	iters: 1100, epoch: 1 | loss: 0.6544784
	speed: 0.0259s/iter; left time: 263.4571s
Epoch: 1 cost time: 29.17611598968506
Epoch: 1, Steps: 1128 | Train Loss: 0.7593980 Vali Loss: 0.7720677 Test Loss: 0.3712404
Validation loss decreased (inf --> 0.772068).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7649830
	speed: 0.0269s/iter; left time: 270.4829s
	iters: 200, epoch: 2 | loss: 0.7656043
	speed: 0.0245s/iter; left time: 243.9831s
	iters: 300, epoch: 2 | loss: 1.0732663
	speed: 0.0230s/iter; left time: 226.6002s
	iters: 400, epoch: 2 | loss: 0.6510774
	speed: 0.0220s/iter; left time: 214.9720s
	iters: 500, epoch: 2 | loss: 0.5758567
	speed: 0.0208s/iter; left time: 201.1678s
	iters: 600, epoch: 2 | loss: 0.5280629
	speed: 0.0197s/iter; left time: 187.8732s
	iters: 700, epoch: 2 | loss: 0.6032325
	speed: 0.0189s/iter; left time: 178.7481s
	iters: 800, epoch: 2 | loss: 0.9729741
	speed: 0.0183s/iter; left time: 171.3278s
	iters: 900, epoch: 2 | loss: 0.7161407
	speed: 0.0192s/iter; left time: 177.8040s
	iters: 1000, epoch: 2 | loss: 0.5143174
	speed: 0.0190s/iter; left time: 173.9785s
	iters: 1100, epoch: 2 | loss: 0.7955613
	speed: 0.0191s/iter; left time: 172.7388s
Epoch: 2 cost time: 21.67121124267578
Epoch: 2, Steps: 1128 | Train Loss: 0.7086693 Vali Loss: 0.7802682 Test Loss: 0.3662061
EarlyStopping counter: 1 out of 5
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7517350
	speed: 0.0190s/iter; left time: 169.1449s
	iters: 200, epoch: 3 | loss: 0.5145222
	speed: 0.0251s/iter; left time: 221.8304s
	iters: 300, epoch: 3 | loss: 0.6743730
	speed: 0.0271s/iter; left time: 236.5311s
	iters: 400, epoch: 3 | loss: 0.5576636
	speed: 0.0256s/iter; left time: 220.5775s
	iters: 500, epoch: 3 | loss: 0.6086102
	speed: 0.0249s/iter; left time: 212.2579s
	iters: 600, epoch: 3 | loss: 0.7357268
	speed: 0.0241s/iter; left time: 203.0454s
	iters: 700, epoch: 3 | loss: 0.7448870
	speed: 0.0234s/iter; left time: 194.8217s
	iters: 800, epoch: 3 | loss: 0.7585351
	speed: 0.0232s/iter; left time: 190.6016s
	iters: 900, epoch: 3 | loss: 0.6720318
	speed: 0.0231s/iter; left time: 187.3496s
	iters: 1000, epoch: 3 | loss: 0.6421778
	speed: 0.0232s/iter; left time: 186.2715s
	iters: 1100, epoch: 3 | loss: 0.6583732
	speed: 0.0233s/iter; left time: 184.8951s
Epoch: 3 cost time: 26.486770629882812
Epoch: 3, Steps: 1128 | Train Loss: 0.6871192 Vali Loss: 0.7351750 Test Loss: 0.3601323
Validation loss decreased (0.772068 --> 0.735175).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.9196526
	speed: 0.0416s/iter; left time: 324.2817s
	iters: 200, epoch: 4 | loss: 0.6861013
	speed: 0.0391s/iter; left time: 301.1003s
	iters: 300, epoch: 4 | loss: 0.7116960
	speed: 0.0334s/iter; left time: 254.0553s
	iters: 400, epoch: 4 | loss: 0.6839179
	speed: 0.0306s/iter; left time: 229.3572s
	iters: 500, epoch: 4 | loss: 0.5876721
	speed: 0.0288s/iter; left time: 213.1691s
	iters: 600, epoch: 4 | loss: 0.7158080
	speed: 0.0275s/iter; left time: 200.5893s
	iters: 700, epoch: 4 | loss: 0.5261459
	speed: 0.0268s/iter; left time: 193.0269s
	iters: 800, epoch: 4 | loss: 0.7837347
	speed: 0.0262s/iter; left time: 185.7053s
	iters: 900, epoch: 4 | loss: 0.6633581
	speed: 0.0258s/iter; left time: 180.4564s
	iters: 1000, epoch: 4 | loss: 0.7309526
	speed: 0.0262s/iter; left time: 180.9846s
	iters: 1100, epoch: 4 | loss: 0.5902151
	speed: 0.0265s/iter; left time: 180.3175s
Epoch: 4 cost time: 30.122162103652954
Epoch: 4, Steps: 1128 | Train Loss: 0.6771834 Vali Loss: 0.7277912 Test Loss: 0.3602273
Validation loss decreased (0.735175 --> 0.727791).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5567565
	speed: 0.0253s/iter; left time: 168.8603s
	iters: 200, epoch: 5 | loss: 0.7531732
	speed: 0.0249s/iter; left time: 163.8787s
	iters: 300, epoch: 5 | loss: 0.6586657
	speed: 0.0245s/iter; left time: 158.6465s
	iters: 400, epoch: 5 | loss: 0.6877111
	speed: 0.0239s/iter; left time: 152.3503s
	iters: 500, epoch: 5 | loss: 0.8825730
	speed: 0.0230s/iter; left time: 144.4330s
	iters: 600, epoch: 5 | loss: 0.8082317
	speed: 0.0224s/iter; left time: 138.3429s
	iters: 700, epoch: 5 | loss: 0.7069853
	speed: 0.0220s/iter; left time: 133.6670s
	iters: 800, epoch: 5 | loss: 0.6871752
	speed: 0.0218s/iter; left time: 129.8400s
	iters: 900, epoch: 5 | loss: 0.7091633
	speed: 0.0217s/iter; left time: 127.2796s
	iters: 1000, epoch: 5 | loss: 0.6946973
	speed: 0.0216s/iter; left time: 124.6865s
	iters: 1100, epoch: 5 | loss: 0.5767984
	speed: 0.0215s/iter; left time: 122.0381s
Epoch: 5 cost time: 24.40316915512085
Epoch: 5, Steps: 1128 | Train Loss: 0.6717989 Vali Loss: 0.7255346 Test Loss: 0.3588667
Validation loss decreased (0.727791 --> 0.725535).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.7200452
	speed: 0.0260s/iter; left time: 144.1105s
	iters: 200, epoch: 6 | loss: 0.6743674
	speed: 0.0208s/iter; left time: 113.3149s
	iters: 300, epoch: 6 | loss: 0.6869233
	speed: 0.0210s/iter; left time: 112.2056s
	iters: 400, epoch: 6 | loss: 0.6220294
	speed: 0.0216s/iter; left time: 113.3239s
	iters: 500, epoch: 6 | loss: 0.5836237
	speed: 0.0220s/iter; left time: 113.1089s
	iters: 600, epoch: 6 | loss: 0.9001769
	speed: 0.0220s/iter; left time: 110.6514s
	iters: 700, epoch: 6 | loss: 0.8770642
	speed: 0.0220s/iter; left time: 108.6859s
	iters: 800, epoch: 6 | loss: 0.5865248
	speed: 0.0220s/iter; left time: 106.5742s
	iters: 900, epoch: 6 | loss: 0.6521581
	speed: 0.0221s/iter; left time: 104.8242s
	iters: 1000, epoch: 6 | loss: 0.5077099
	speed: 0.0222s/iter; left time: 102.8581s
	iters: 1100, epoch: 6 | loss: 0.6900928
	speed: 0.0222s/iter; left time: 100.8431s
Epoch: 6 cost time: 25.22051501274109
Epoch: 6, Steps: 1128 | Train Loss: 0.6693220 Vali Loss: 0.7247627 Test Loss: 0.3590107
Validation loss decreased (0.725535 --> 0.724763).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4771216
	speed: 0.0393s/iter; left time: 173.5302s
	iters: 200, epoch: 7 | loss: 0.5937554
	speed: 0.0312s/iter; left time: 134.6350s
	iters: 300, epoch: 7 | loss: 0.7432976
	speed: 0.0280s/iter; left time: 118.1480s
	iters: 400, epoch: 7 | loss: 0.7580487
	speed: 0.0265s/iter; left time: 108.8425s
	iters: 500, epoch: 7 | loss: 0.5905589
	speed: 0.0256s/iter; left time: 102.7209s
	iters: 600, epoch: 7 | loss: 0.6254233
	speed: 0.0251s/iter; left time: 98.2757s
	iters: 700, epoch: 7 | loss: 0.5482163
	speed: 0.0250s/iter; left time: 95.4510s
	iters: 800, epoch: 7 | loss: 0.7663719
	speed: 0.0249s/iter; left time: 92.4800s
	iters: 900, epoch: 7 | loss: 0.5330572
	speed: 0.0247s/iter; left time: 89.2581s
	iters: 1000, epoch: 7 | loss: 0.5825086
	speed: 0.0245s/iter; left time: 86.2316s
	iters: 1100, epoch: 7 | loss: 0.6524009
	speed: 0.0244s/iter; left time: 83.3199s
Epoch: 7 cost time: 27.61760663986206
Epoch: 7, Steps: 1128 | Train Loss: 0.6670318 Vali Loss: 0.7272677 Test Loss: 0.3596555
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.6843284
	speed: 0.0357s/iter; left time: 117.3466s
	iters: 200, epoch: 8 | loss: 0.6620852
	speed: 0.0323s/iter; left time: 103.0120s
	iters: 300, epoch: 8 | loss: 0.7230889
	speed: 0.0289s/iter; left time: 89.1745s
	iters: 400, epoch: 8 | loss: 0.6210521
	speed: 0.0272s/iter; left time: 81.0621s
	iters: 500, epoch: 8 | loss: 0.7531433
	speed: 0.0263s/iter; left time: 75.8867s
	iters: 600, epoch: 8 | loss: 0.6214415
	speed: 0.0257s/iter; left time: 71.5140s
	iters: 700, epoch: 8 | loss: 0.5648652
	speed: 0.0253s/iter; left time: 67.9120s
	iters: 800, epoch: 8 | loss: 0.6984427
	speed: 0.0250s/iter; left time: 64.7127s
	iters: 900, epoch: 8 | loss: 0.8679641
	speed: 0.0248s/iter; left time: 61.6244s
	iters: 1000, epoch: 8 | loss: 0.5718639
	speed: 0.0246s/iter; left time: 58.7354s
	iters: 1100, epoch: 8 | loss: 0.5645163
	speed: 0.0245s/iter; left time: 55.9015s
Epoch: 8 cost time: 27.67997097969055
Epoch: 8, Steps: 1128 | Train Loss: 0.6665113 Vali Loss: 0.7255536 Test Loss: 0.3591521
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.7957893
	speed: 0.0227s/iter; left time: 48.9172s
	iters: 200, epoch: 9 | loss: 0.5365313
	speed: 0.0198s/iter; left time: 40.7657s
	iters: 300, epoch: 9 | loss: 0.8668067
	speed: 0.0213s/iter; left time: 41.7740s
	iters: 400, epoch: 9 | loss: 0.6950778
	speed: 0.0209s/iter; left time: 38.8638s
	iters: 500, epoch: 9 | loss: 1.0161829
	speed: 0.0207s/iter; left time: 36.4247s
	iters: 600, epoch: 9 | loss: 0.6884911
	speed: 0.0202s/iter; left time: 33.3949s
	iters: 700, epoch: 9 | loss: 0.6404279
	speed: 0.0196s/iter; left time: 30.5652s
	iters: 800, epoch: 9 | loss: 0.7104580
	speed: 0.0199s/iter; left time: 29.0510s
	iters: 900, epoch: 9 | loss: 0.7944623
	speed: 0.0202s/iter; left time: 27.3686s
	iters: 1000, epoch: 9 | loss: 0.7128099
	speed: 0.0204s/iter; left time: 25.5856s
	iters: 1100, epoch: 9 | loss: 0.7415110
	speed: 0.0206s/iter; left time: 23.8304s
Epoch: 9 cost time: 23.49752950668335
Epoch: 9, Steps: 1128 | Train Loss: 0.6660263 Vali Loss: 0.7245293 Test Loss: 0.3591674
Validation loss decreased (0.724763 --> 0.724529).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.5785642
	speed: 0.0265s/iter; left time: 27.2539s
	iters: 200, epoch: 10 | loss: 0.6294200
	speed: 0.0245s/iter; left time: 22.7879s
	iters: 300, epoch: 10 | loss: 0.5831347
	speed: 0.0236s/iter; left time: 19.6032s
	iters: 400, epoch: 10 | loss: 0.6674070
	speed: 0.0237s/iter; left time: 17.2708s
	iters: 500, epoch: 10 | loss: 0.8555669
	speed: 0.0238s/iter; left time: 14.9493s
	iters: 600, epoch: 10 | loss: 0.6781142
	speed: 0.0239s/iter; left time: 12.6174s
	iters: 700, epoch: 10 | loss: 0.5562677
	speed: 0.0240s/iter; left time: 10.3093s
	iters: 800, epoch: 10 | loss: 0.6650006
	speed: 0.0252s/iter; left time: 8.2954s
	iters: 900, epoch: 10 | loss: 0.5936951
	speed: 0.0265s/iter; left time: 6.0739s
	iters: 1000, epoch: 10 | loss: 0.7949631
	speed: 0.0261s/iter; left time: 3.3688s
	iters: 1100, epoch: 10 | loss: 0.7069731
	speed: 0.0255s/iter; left time: 0.7398s
Epoch: 10 cost time: 28.74409770965576
Epoch: 10, Steps: 1128 | Train Loss: 0.6657170 Vali Loss: 0.7253510 Test Loss: 0.3591483
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.3591673672199249, mae:0.35095128417015076
Use GPU: cuda:0
no_skip True
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.6564423
	speed: 0.0236s/iter; left time: 264.2917s
	iters: 200, epoch: 1 | loss: 0.6610703
	speed: 0.0228s/iter; left time: 253.0948s
	iters: 300, epoch: 1 | loss: 0.6154628
	speed: 0.0252s/iter; left time: 277.1435s
	iters: 400, epoch: 1 | loss: 0.6485943
	speed: 0.0281s/iter; left time: 306.0500s
	iters: 500, epoch: 1 | loss: 0.7298565
	speed: 0.0276s/iter; left time: 297.9002s
	iters: 600, epoch: 1 | loss: 0.7081321
	speed: 0.0273s/iter; left time: 291.4166s
	iters: 700, epoch: 1 | loss: 0.5731461
	speed: 0.0269s/iter; left time: 285.0236s
	iters: 800, epoch: 1 | loss: 0.7837188
	speed: 0.0266s/iter; left time: 278.3313s
	iters: 900, epoch: 1 | loss: 0.9030299
	speed: 0.0259s/iter; left time: 269.1575s
	iters: 1000, epoch: 1 | loss: 0.5871317
	speed: 0.0258s/iter; left time: 265.5749s
	iters: 1100, epoch: 1 | loss: 0.7532883
	speed: 0.0261s/iter; left time: 265.8860s
Epoch: 1 cost time: 29.82884955406189
Epoch: 1, Steps: 1128 | Train Loss: 0.7641257 Vali Loss: 0.7707366 Test Loss: 0.3688880
Validation loss decreased (inf --> 0.770737).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8466626
	speed: 0.0288s/iter; left time: 289.2486s
	iters: 200, epoch: 2 | loss: 0.8434937
	speed: 0.0252s/iter; left time: 251.0026s
	iters: 300, epoch: 2 | loss: 0.9550373
	speed: 0.0273s/iter; left time: 269.1213s
	iters: 400, epoch: 2 | loss: 0.8756203
	speed: 0.0266s/iter; left time: 259.5850s
	iters: 500, epoch: 2 | loss: 0.5651176
	speed: 0.0263s/iter; left time: 254.0507s
	iters: 600, epoch: 2 | loss: 0.7675356
	speed: 0.0261s/iter; left time: 249.3785s
	iters: 700, epoch: 2 | loss: 0.8099023
	speed: 0.0253s/iter; left time: 239.3418s
	iters: 800, epoch: 2 | loss: 0.6433560
	speed: 0.0249s/iter; left time: 232.6283s
	iters: 900, epoch: 2 | loss: 0.7912990
	speed: 0.0243s/iter; left time: 225.1372s
	iters: 1000, epoch: 2 | loss: 0.6862510
	speed: 0.0239s/iter; left time: 218.9719s
	iters: 1100, epoch: 2 | loss: 0.5940186
	speed: 0.0237s/iter; left time: 215.0077s
Epoch: 2 cost time: 26.814329147338867
Epoch: 2, Steps: 1128 | Train Loss: 0.7260889 Vali Loss: 0.7682778 Test Loss: 0.3671861
Validation loss decreased (0.770737 --> 0.768278).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6871921
	speed: 0.0311s/iter; left time: 277.2075s
	iters: 200, epoch: 3 | loss: 0.7419683
	speed: 0.0270s/iter; left time: 238.3603s
	iters: 300, epoch: 3 | loss: 0.6937757
	speed: 0.0255s/iter; left time: 222.4099s
	iters: 400, epoch: 3 | loss: 0.5720901
	speed: 0.0248s/iter; left time: 213.5543s
	iters: 500, epoch: 3 | loss: 0.7347637
	speed: 0.0243s/iter; left time: 207.0010s
	iters: 600, epoch: 3 | loss: 0.6870816
	speed: 0.0245s/iter; left time: 206.3503s
	iters: 700, epoch: 3 | loss: 0.8505062
	speed: 0.0246s/iter; left time: 204.8818s
	iters: 800, epoch: 3 | loss: 0.5180645
	speed: 0.0250s/iter; left time: 205.8999s
	iters: 900, epoch: 3 | loss: 0.8349778
	speed: 0.0248s/iter; left time: 201.6387s
	iters: 1000, epoch: 3 | loss: 0.6921095
	speed: 0.0247s/iter; left time: 198.1142s
	iters: 1100, epoch: 3 | loss: 0.6623811
	speed: 0.0245s/iter; left time: 194.3852s
Epoch: 3 cost time: 27.949716329574585
Epoch: 3, Steps: 1128 | Train Loss: 0.7044218 Vali Loss: 0.7683881 Test Loss: 0.3651635
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5703757
	speed: 0.0406s/iter; left time: 316.3886s
	iters: 200, epoch: 4 | loss: 0.7048373
	speed: 0.0318s/iter; left time: 244.5147s
	iters: 300, epoch: 4 | loss: 0.6261535
	speed: 0.0302s/iter; left time: 229.3967s
	iters: 400, epoch: 4 | loss: 0.5850148
	speed: 0.0306s/iter; left time: 229.2985s
	iters: 500, epoch: 4 | loss: 0.6775097
	speed: 0.0294s/iter; left time: 217.4107s
	iters: 600, epoch: 4 | loss: 0.7807895
	speed: 0.0286s/iter; left time: 208.7971s
	iters: 700, epoch: 4 | loss: 0.6854650
	speed: 0.0280s/iter; left time: 201.8594s
	iters: 800, epoch: 4 | loss: 0.9052418
	speed: 0.0283s/iter; left time: 200.9231s
	iters: 900, epoch: 4 | loss: 0.6146759
	speed: 0.0279s/iter; left time: 195.0088s
	iters: 1000, epoch: 4 | loss: 0.5831398
	speed: 0.0273s/iter; left time: 188.3702s
	iters: 1100, epoch: 4 | loss: 0.6544504
	speed: 0.0271s/iter; left time: 184.1647s
Epoch: 4 cost time: 30.757347345352173
Epoch: 4, Steps: 1128 | Train Loss: 0.6949880 Vali Loss: 0.7671841 Test Loss: 0.3640033
Validation loss decreased (0.768278 --> 0.767184).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.7178040
	speed: 0.0252s/iter; left time: 168.2748s
	iters: 200, epoch: 5 | loss: 0.6121529
	speed: 0.0221s/iter; left time: 144.9345s
	iters: 300, epoch: 5 | loss: 0.5646424
	speed: 0.0225s/iter; left time: 145.3763s
	iters: 400, epoch: 5 | loss: 0.7996564
	speed: 0.0213s/iter; left time: 135.8285s
	iters: 500, epoch: 5 | loss: 0.7293885
	speed: 0.0205s/iter; left time: 128.3673s
	iters: 600, epoch: 5 | loss: 0.6858314
	speed: 0.0198s/iter; left time: 121.8526s
	iters: 700, epoch: 5 | loss: 0.6374420
	speed: 0.0205s/iter; left time: 124.3350s
	iters: 800, epoch: 5 | loss: 0.8705621
	speed: 0.0221s/iter; left time: 131.7264s
	iters: 900, epoch: 5 | loss: 0.5780057
	speed: 0.0233s/iter; left time: 136.7473s
	iters: 1000, epoch: 5 | loss: 0.6417652
	speed: 0.0243s/iter; left time: 140.0616s
	iters: 1100, epoch: 5 | loss: 0.6017529
	speed: 0.0250s/iter; left time: 141.4526s
Epoch: 5 cost time: 28.44366955757141
Epoch: 5, Steps: 1128 | Train Loss: 0.6888275 Vali Loss: 0.7696466 Test Loss: 0.3631524
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6540433
	speed: 0.0337s/iter; left time: 186.8697s
	iters: 200, epoch: 6 | loss: 0.6383434
	speed: 0.0293s/iter; left time: 159.2720s
	iters: 300, epoch: 6 | loss: 0.5611612
	speed: 0.0271s/iter; left time: 144.7504s
	iters: 400, epoch: 6 | loss: 0.7235937
	speed: 0.0259s/iter; left time: 135.8859s
	iters: 500, epoch: 6 | loss: 0.5683148
	speed: 0.0253s/iter; left time: 130.1390s
	iters: 600, epoch: 6 | loss: 0.6447669
	speed: 0.0249s/iter; left time: 125.3794s
	iters: 700, epoch: 6 | loss: 0.5505707
	speed: 0.0246s/iter; left time: 121.3048s
	iters: 800, epoch: 6 | loss: 0.6926513
	speed: 0.0250s/iter; left time: 121.2209s
	iters: 900, epoch: 6 | loss: 0.7612138
	speed: 0.0261s/iter; left time: 123.6788s
	iters: 1000, epoch: 6 | loss: 0.6919848
	speed: 0.0269s/iter; left time: 124.6664s
	iters: 1100, epoch: 6 | loss: 0.5802398
	speed: 0.0269s/iter; left time: 122.0273s
Epoch: 6 cost time: 30.267838954925537
Epoch: 6, Steps: 1128 | Train Loss: 0.6866369 Vali Loss: 0.7663124 Test Loss: 0.3628661
Validation loss decreased (0.767184 --> 0.766312).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5720610
	speed: 0.0278s/iter; left time: 122.5153s
	iters: 200, epoch: 7 | loss: 0.6881396
	speed: 0.0261s/iter; left time: 112.3824s
	iters: 300, epoch: 7 | loss: 0.7390713
	speed: 0.0255s/iter; left time: 107.6140s
	iters: 400, epoch: 7 | loss: 0.6540954
	speed: 0.0252s/iter; left time: 103.5096s
	iters: 500, epoch: 7 | loss: 0.7136189
	speed: 0.0242s/iter; left time: 97.0342s
	iters: 600, epoch: 7 | loss: 0.8043229
	speed: 0.0240s/iter; left time: 93.7337s
	iters: 700, epoch: 7 | loss: 0.6693403
	speed: 0.0236s/iter; left time: 90.1384s
	iters: 800, epoch: 7 | loss: 0.6295322
	speed: 0.0237s/iter; left time: 88.0222s
	iters: 900, epoch: 7 | loss: 0.8139862
	speed: 0.0239s/iter; left time: 86.2191s
	iters: 1000, epoch: 7 | loss: 0.5963398
	speed: 0.0239s/iter; left time: 84.0169s
	iters: 1100, epoch: 7 | loss: 0.7920082
	speed: 0.0245s/iter; left time: 83.5465s
Epoch: 7 cost time: 27.817286252975464
Epoch: 7, Steps: 1128 | Train Loss: 0.6849757 Vali Loss: 0.7646544 Test Loss: 0.3623903
Validation loss decreased (0.766312 --> 0.764654).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.6122073
	speed: 0.0276s/iter; left time: 90.7048s
	iters: 200, epoch: 8 | loss: 0.5741829
	speed: 0.0227s/iter; left time: 72.2455s
	iters: 300, epoch: 8 | loss: 0.7160067
	speed: 0.0211s/iter; left time: 65.1302s
	iters: 400, epoch: 8 | loss: 0.5875612
	speed: 0.0201s/iter; left time: 60.0361s
	iters: 500, epoch: 8 | loss: 0.6239539
	speed: 0.0196s/iter; left time: 56.4445s
	iters: 600, epoch: 8 | loss: 0.5909866
	speed: 0.0192s/iter; left time: 53.3921s
	iters: 700, epoch: 8 | loss: 0.6098974
	speed: 0.0190s/iter; left time: 51.0343s
	iters: 800, epoch: 8 | loss: 0.6071099
	speed: 0.0193s/iter; left time: 49.9670s
	iters: 900, epoch: 8 | loss: 0.5946332
	speed: 0.0199s/iter; left time: 49.3622s
	iters: 1000, epoch: 8 | loss: 0.6007590
	speed: 0.0203s/iter; left time: 48.4748s
	iters: 1100, epoch: 8 | loss: 0.5345963
	speed: 0.0209s/iter; left time: 47.7772s
Epoch: 8 cost time: 24.122081518173218
Epoch: 8, Steps: 1128 | Train Loss: 0.6839049 Vali Loss: 0.7652617 Test Loss: 0.3619542
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.7435415
	speed: 0.0285s/iter; left time: 61.5161s
	iters: 200, epoch: 9 | loss: 0.7125823
	speed: 0.0248s/iter; left time: 50.9454s
	iters: 300, epoch: 9 | loss: 0.7131075
	speed: 0.0240s/iter; left time: 46.9276s
	iters: 400, epoch: 9 | loss: 0.7139867
	speed: 0.0236s/iter; left time: 43.7682s
	iters: 500, epoch: 9 | loss: 0.5889943
	speed: 0.0234s/iter; left time: 41.0795s
	iters: 600, epoch: 9 | loss: 0.6793761
	speed: 0.0236s/iter; left time: 39.0344s
	iters: 700, epoch: 9 | loss: 0.6460372
	speed: 0.0237s/iter; left time: 36.9064s
	iters: 800, epoch: 9 | loss: 0.8134419
	speed: 0.0235s/iter; left time: 34.2832s
	iters: 900, epoch: 9 | loss: 0.9285663
	speed: 0.0236s/iter; left time: 32.0263s
	iters: 1000, epoch: 9 | loss: 0.6427511
	speed: 0.0235s/iter; left time: 29.5309s
	iters: 1100, epoch: 9 | loss: 0.6167460
	speed: 0.0234s/iter; left time: 27.0613s
Epoch: 9 cost time: 26.47483491897583
Epoch: 9, Steps: 1128 | Train Loss: 0.6836155 Vali Loss: 0.7663107 Test Loss: 0.3620202
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.6726030
	speed: 0.0392s/iter; left time: 40.3213s
	iters: 200, epoch: 10 | loss: 0.6816976
	speed: 0.0308s/iter; left time: 28.6242s
	iters: 300, epoch: 10 | loss: 0.8301142
	speed: 0.0278s/iter; left time: 23.0418s
	iters: 400, epoch: 10 | loss: 0.8374718
	speed: 0.0264s/iter; left time: 19.2498s
	iters: 500, epoch: 10 | loss: 0.7153993
	speed: 0.0256s/iter; left time: 16.0846s
	iters: 600, epoch: 10 | loss: 0.6298538
	speed: 0.0255s/iter; left time: 13.4747s
	iters: 700, epoch: 10 | loss: 0.7507093
	speed: 0.0267s/iter; left time: 11.4424s
	iters: 800, epoch: 10 | loss: 0.7826766
	speed: 0.0275s/iter; left time: 9.0512s
	iters: 900, epoch: 10 | loss: 0.5988582
	speed: 0.0282s/iter; left time: 6.4584s
	iters: 1000, epoch: 10 | loss: 0.5913788
	speed: 0.0280s/iter; left time: 3.6104s
	iters: 1100, epoch: 10 | loss: 0.5547251
	speed: 0.0278s/iter; left time: 0.8065s
Epoch: 10 cost time: 31.42485809326172
Epoch: 10, Steps: 1128 | Train Loss: 0.6836158 Vali Loss: 0.7659385 Test Loss: 0.3620524
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.36239027976989746, mae:0.35240069031715393
Use GPU: cuda:0
no_skip True
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.6446785
	speed: 0.0227s/iter; left time: 253.3231s
	iters: 200, epoch: 1 | loss: 0.7043697
	speed: 0.0199s/iter; left time: 220.1150s
	iters: 300, epoch: 1 | loss: 0.7645994
	speed: 0.0188s/iter; left time: 206.2935s
	iters: 400, epoch: 1 | loss: 0.8581032
	speed: 0.0181s/iter; left time: 196.8492s
	iters: 500, epoch: 1 | loss: 0.7406723
	speed: 0.0193s/iter; left time: 207.9806s
	iters: 600, epoch: 1 | loss: 0.7351952
	speed: 0.0194s/iter; left time: 206.7038s
	iters: 700, epoch: 1 | loss: 0.8302033
	speed: 0.0193s/iter; left time: 203.8207s
	iters: 800, epoch: 1 | loss: 0.7732805
	speed: 0.0194s/iter; left time: 203.5920s
	iters: 900, epoch: 1 | loss: 0.7556324
	speed: 0.0189s/iter; left time: 195.7779s
	iters: 1000, epoch: 1 | loss: 0.7963886
	speed: 0.0182s/iter; left time: 187.2547s
	iters: 1100, epoch: 1 | loss: 0.8552398
	speed: 0.0178s/iter; left time: 180.8963s
Epoch: 1 cost time: 20.199176788330078
Epoch: 1, Steps: 1128 | Train Loss: 0.7738632 Vali Loss: 0.7942061 Test Loss: 0.3734369
Validation loss decreased (inf --> 0.794206).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7585236
	speed: 0.0294s/iter; left time: 295.9907s
	iters: 200, epoch: 2 | loss: 0.6848566
	speed: 0.0273s/iter; left time: 271.2670s
	iters: 300, epoch: 2 | loss: 0.6692764
	speed: 0.0265s/iter; left time: 260.7283s
	iters: 400, epoch: 2 | loss: 0.7622419
	speed: 0.0261s/iter; left time: 254.5154s
	iters: 500, epoch: 2 | loss: 0.9271390
	speed: 0.0256s/iter; left time: 246.8375s
	iters: 600, epoch: 2 | loss: 0.5897882
	speed: 0.0249s/iter; left time: 237.6647s
	iters: 700, epoch: 2 | loss: 0.5911111
	speed: 0.0244s/iter; left time: 230.9485s
	iters: 800, epoch: 2 | loss: 0.7650423
	speed: 0.0242s/iter; left time: 226.5648s
	iters: 900, epoch: 2 | loss: 0.7197095
	speed: 0.0243s/iter; left time: 224.4612s
	iters: 1000, epoch: 2 | loss: 0.5420297
	speed: 0.0241s/iter; left time: 220.7030s
	iters: 1100, epoch: 2 | loss: 0.5510399
	speed: 0.0239s/iter; left time: 216.1392s
Epoch: 2 cost time: 26.9788715839386
Epoch: 2, Steps: 1128 | Train Loss: 0.7172656 Vali Loss: 0.7697313 Test Loss: 0.3667260
Validation loss decreased (0.794206 --> 0.769731).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.9019218
	speed: 0.0331s/iter; left time: 295.0667s
	iters: 200, epoch: 3 | loss: 0.6668543
	speed: 0.0286s/iter; left time: 252.7798s
	iters: 300, epoch: 3 | loss: 0.4795133
	speed: 0.0271s/iter; left time: 236.0316s
	iters: 400, epoch: 3 | loss: 0.5149560
	speed: 0.0263s/iter; left time: 227.0291s
	iters: 500, epoch: 3 | loss: 0.5794621
	speed: 0.0259s/iter; left time: 220.8198s
	iters: 600, epoch: 3 | loss: 0.8560987
	speed: 0.0253s/iter; left time: 213.2521s
	iters: 700, epoch: 3 | loss: 0.7439024
	speed: 0.0247s/iter; left time: 206.0200s
	iters: 800, epoch: 3 | loss: 0.6293530
	speed: 0.0243s/iter; left time: 200.0297s
	iters: 900, epoch: 3 | loss: 1.0172684
	speed: 0.0241s/iter; left time: 195.8003s
	iters: 1000, epoch: 3 | loss: 0.7853162
	speed: 0.0242s/iter; left time: 194.0974s
	iters: 1100, epoch: 3 | loss: 0.6715428
	speed: 0.0246s/iter; left time: 195.2127s
Epoch: 3 cost time: 28.228697299957275
Epoch: 3, Steps: 1128 | Train Loss: 0.6958991 Vali Loss: 0.7438476 Test Loss: 0.3615347
Validation loss decreased (0.769731 --> 0.743848).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.7259973
	speed: 0.0258s/iter; left time: 200.7965s
	iters: 200, epoch: 4 | loss: 0.8350595
	speed: 0.0241s/iter; left time: 185.3895s
	iters: 300, epoch: 4 | loss: 0.5784628
	speed: 0.0236s/iter; left time: 179.0058s
	iters: 400, epoch: 4 | loss: 0.6038373
	speed: 0.0234s/iter; left time: 175.2378s
	iters: 500, epoch: 4 | loss: 0.7022510
	speed: 0.0254s/iter; left time: 187.9169s
	iters: 600, epoch: 4 | loss: 0.4919894
	speed: 0.0252s/iter; left time: 183.7847s
	iters: 700, epoch: 4 | loss: 0.9889315
	speed: 0.0248s/iter; left time: 178.3072s
	iters: 800, epoch: 4 | loss: 0.7221677
	speed: 0.0245s/iter; left time: 173.7209s
	iters: 900, epoch: 4 | loss: 0.7091867
	speed: 0.0243s/iter; left time: 170.2148s
	iters: 1000, epoch: 4 | loss: 0.5783127
	speed: 0.0241s/iter; left time: 166.4161s
	iters: 1100, epoch: 4 | loss: 0.6446084
	speed: 0.0240s/iter; left time: 162.9108s
Epoch: 4 cost time: 27.380996227264404
Epoch: 4, Steps: 1128 | Train Loss: 0.6844288 Vali Loss: 0.7345650 Test Loss: 0.3616782
Validation loss decreased (0.743848 --> 0.734565).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6498836
	speed: 0.0189s/iter; left time: 125.7308s
	iters: 200, epoch: 5 | loss: 0.7405502
	speed: 0.0248s/iter; left time: 162.6979s
	iters: 300, epoch: 5 | loss: 0.5647947
	speed: 0.0264s/iter; left time: 170.6121s
	iters: 400, epoch: 5 | loss: 0.8063902
	speed: 0.0260s/iter; left time: 165.5586s
	iters: 500, epoch: 5 | loss: 0.8289277
	speed: 0.0254s/iter; left time: 158.9545s
	iters: 600, epoch: 5 | loss: 0.7717963
	speed: 0.0250s/iter; left time: 154.0661s
	iters: 700, epoch: 5 | loss: 0.5452179
	speed: 0.0246s/iter; left time: 149.3543s
	iters: 800, epoch: 5 | loss: 0.6929955
	speed: 0.0243s/iter; left time: 145.2805s
	iters: 900, epoch: 5 | loss: 0.7441877
	speed: 0.0240s/iter; left time: 140.8603s
	iters: 1000, epoch: 5 | loss: 0.8310808
	speed: 0.0240s/iter; left time: 138.4265s
	iters: 1100, epoch: 5 | loss: 0.7609323
	speed: 0.0240s/iter; left time: 136.1496s
Epoch: 5 cost time: 27.211891412734985
Epoch: 5, Steps: 1128 | Train Loss: 0.6796472 Vali Loss: 0.7338240 Test Loss: 0.3598518
Validation loss decreased (0.734565 --> 0.733824).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 1.0301849
	speed: 0.0259s/iter; left time: 143.2486s
	iters: 200, epoch: 6 | loss: 0.7682775
	speed: 0.0237s/iter; left time: 129.2097s
	iters: 300, epoch: 6 | loss: 0.5691416
	speed: 0.0235s/iter; left time: 125.5608s
	iters: 400, epoch: 6 | loss: 0.8004666
	speed: 0.0233s/iter; left time: 122.2312s
	iters: 500, epoch: 6 | loss: 0.6759956
	speed: 0.0244s/iter; left time: 125.5880s
	iters: 600, epoch: 6 | loss: 0.7165973
	speed: 0.0240s/iter; left time: 121.0458s
	iters: 700, epoch: 6 | loss: 0.5195026
	speed: 0.0234s/iter; left time: 115.6349s
	iters: 800, epoch: 6 | loss: 0.6948060
	speed: 0.0241s/iter; left time: 116.6721s
	iters: 900, epoch: 6 | loss: 0.6932219
	speed: 0.0246s/iter; left time: 116.4743s
	iters: 1000, epoch: 6 | loss: 0.5937825
	speed: 0.0252s/iter; left time: 116.8038s
	iters: 1100, epoch: 6 | loss: 0.6653101
	speed: 0.0260s/iter; left time: 118.0402s
Epoch: 6 cost time: 29.43619656562805
Epoch: 6, Steps: 1128 | Train Loss: 0.6759123 Vali Loss: 0.7346687 Test Loss: 0.3592171
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.6873335
	speed: 0.0390s/iter; left time: 171.9100s
	iters: 200, epoch: 7 | loss: 0.6159906
	speed: 0.0389s/iter; left time: 167.6541s
	iters: 300, epoch: 7 | loss: 0.5991312
	speed: 0.0376s/iter; left time: 158.2538s
	iters: 400, epoch: 7 | loss: 0.7500457
	speed: 0.0335s/iter; left time: 137.6616s
	iters: 500, epoch: 7 | loss: 0.5774579
	speed: 0.0306s/iter; left time: 122.8529s
	iters: 600, epoch: 7 | loss: 0.5699595
	speed: 0.0305s/iter; left time: 119.2829s
	iters: 700, epoch: 7 | loss: 0.5855608
	speed: 0.0297s/iter; left time: 113.1073s
	iters: 800, epoch: 7 | loss: 0.7791398
	speed: 0.0291s/iter; left time: 108.0579s
	iters: 900, epoch: 7 | loss: 0.5450766
	speed: 0.0286s/iter; left time: 103.1707s
	iters: 1000, epoch: 7 | loss: 0.5828564
	speed: 0.0279s/iter; left time: 98.1108s
	iters: 1100, epoch: 7 | loss: 0.5858238
	speed: 0.0272s/iter; left time: 92.7457s
Epoch: 7 cost time: 30.510334968566895
Epoch: 7, Steps: 1128 | Train Loss: 0.6746458 Vali Loss: 0.7401427 Test Loss: 0.3605350
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.6534626
	speed: 0.0355s/iter; left time: 116.7176s
	iters: 200, epoch: 8 | loss: 0.6294340
	speed: 0.0269s/iter; left time: 85.8162s
	iters: 300, epoch: 8 | loss: 0.7436333
	speed: 0.0244s/iter; left time: 75.2977s
	iters: 400, epoch: 8 | loss: 0.5573322
	speed: 0.0233s/iter; left time: 69.5471s
	iters: 500, epoch: 8 | loss: 0.6963662
	speed: 0.0230s/iter; left time: 66.2151s
	iters: 600, epoch: 8 | loss: 0.7427666
	speed: 0.0230s/iter; left time: 63.9211s
	iters: 700, epoch: 8 | loss: 0.7623114
	speed: 0.0227s/iter; left time: 60.8323s
	iters: 800, epoch: 8 | loss: 0.5805845
	speed: 0.0226s/iter; left time: 58.4273s
	iters: 900, epoch: 8 | loss: 0.6512750
	speed: 0.0226s/iter; left time: 56.0583s
	iters: 1000, epoch: 8 | loss: 0.6622832
	speed: 0.0225s/iter; left time: 53.7658s
	iters: 1100, epoch: 8 | loss: 0.5833200
	speed: 0.0227s/iter; left time: 51.8971s
Epoch: 8 cost time: 25.792269945144653
Epoch: 8, Steps: 1128 | Train Loss: 0.6735803 Vali Loss: 0.7366663 Test Loss: 0.3600536
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.7030383
	speed: 0.0347s/iter; left time: 74.9397s
	iters: 200, epoch: 9 | loss: 0.5681577
	speed: 0.0315s/iter; left time: 64.6942s
	iters: 300, epoch: 9 | loss: 0.7403209
	speed: 0.0289s/iter; left time: 56.6547s
	iters: 400, epoch: 9 | loss: 0.5315204
	speed: 0.0273s/iter; left time: 50.7733s
	iters: 500, epoch: 9 | loss: 0.7301069
	speed: 0.0263s/iter; left time: 46.2178s
	iters: 600, epoch: 9 | loss: 0.9323729
	speed: 0.0260s/iter; left time: 43.0666s
	iters: 700, epoch: 9 | loss: 0.5899119
	speed: 0.0256s/iter; left time: 39.8071s
	iters: 800, epoch: 9 | loss: 0.5827878
	speed: 0.0251s/iter; left time: 36.5787s
	iters: 900, epoch: 9 | loss: 0.4907279
	speed: 0.0248s/iter; left time: 33.6624s
	iters: 1000, epoch: 9 | loss: 0.7377571
	speed: 0.0246s/iter; left time: 30.9678s
	iters: 1100, epoch: 9 | loss: 0.6880216
	speed: 0.0249s/iter; left time: 28.7674s
Epoch: 9 cost time: 28.160830974578857
Epoch: 9, Steps: 1128 | Train Loss: 0.6730831 Vali Loss: 0.7350639 Test Loss: 0.3599043
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.9080969
	speed: 0.0368s/iter; left time: 37.8831s
	iters: 200, epoch: 10 | loss: 0.7181686
	speed: 0.0295s/iter; left time: 27.4068s
	iters: 300, epoch: 10 | loss: 0.5323001
	speed: 0.0275s/iter; left time: 22.7706s
	iters: 400, epoch: 10 | loss: 0.5093669
	speed: 0.0255s/iter; left time: 18.6194s
	iters: 500, epoch: 10 | loss: 0.7774163
	speed: 0.0246s/iter; left time: 15.4490s
	iters: 600, epoch: 10 | loss: 0.6449847
	speed: 0.0242s/iter; left time: 12.8054s
	iters: 700, epoch: 10 | loss: 0.7025883
	speed: 0.0240s/iter; left time: 10.2978s
	iters: 800, epoch: 10 | loss: 0.6005458
	speed: 0.0239s/iter; left time: 7.8647s
	iters: 900, epoch: 10 | loss: 0.7702867
	speed: 0.0241s/iter; left time: 5.5257s
	iters: 1000, epoch: 10 | loss: 0.5734679
	speed: 0.0236s/iter; left time: 3.0385s
	iters: 1100, epoch: 10 | loss: 0.5903646
	speed: 0.0230s/iter; left time: 0.6659s
Epoch: 10 cost time: 25.808714151382446
Epoch: 10, Steps: 1128 | Train Loss: 0.6729585 Vali Loss: 0.7357875 Test Loss: 0.3599841
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.3598518371582031, mae:0.35117512941360474
Seed: 456
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_96       Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip True
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.5539821
	speed: 0.0355s/iter; left time: 403.9960s
	iters: 200, epoch: 1 | loss: 0.5185903
	speed: 0.0289s/iter; left time: 325.3013s
	iters: 300, epoch: 1 | loss: 0.8524455
	speed: 0.0267s/iter; left time: 298.5912s
	iters: 400, epoch: 1 | loss: 0.4679956
	speed: 0.0256s/iter; left time: 283.1924s
	iters: 500, epoch: 1 | loss: 0.3011624
	speed: 0.0249s/iter; left time: 272.6726s
	iters: 600, epoch: 1 | loss: 0.4701740
	speed: 0.0244s/iter; left time: 265.5396s
	iters: 700, epoch: 1 | loss: 0.4602740
	speed: 0.0241s/iter; left time: 259.6821s
	iters: 800, epoch: 1 | loss: 0.3060859
	speed: 0.0237s/iter; left time: 253.3206s
	iters: 900, epoch: 1 | loss: 0.4421798
	speed: 0.0236s/iter; left time: 249.6062s
	iters: 1000, epoch: 1 | loss: 0.3074494
	speed: 0.0234s/iter; left time: 244.8095s
	iters: 1100, epoch: 1 | loss: 1.2766773
	speed: 0.0230s/iter; left time: 238.3038s
Epoch: 1 cost time: 26.211037635803223
Epoch: 1, Steps: 1147 | Train Loss: 0.5341100 Vali Loss: 0.4856346 Test Loss: 0.1943778
Validation loss decreased (inf --> 0.485635).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4248668
	speed: 0.0297s/iter; left time: 304.0356s
	iters: 200, epoch: 2 | loss: 0.5991853
	speed: 0.0262s/iter; left time: 264.9011s
	iters: 300, epoch: 2 | loss: 0.4189869
	speed: 0.0247s/iter; left time: 247.3593s
	iters: 400, epoch: 2 | loss: 0.3511558
	speed: 0.0242s/iter; left time: 239.7621s
	iters: 500, epoch: 2 | loss: 0.3160388
	speed: 0.0237s/iter; left time: 233.3021s
	iters: 600, epoch: 2 | loss: 0.3397522
	speed: 0.0235s/iter; left time: 228.4234s
	iters: 700, epoch: 2 | loss: 0.3491007
	speed: 0.0237s/iter; left time: 227.8343s
	iters: 800, epoch: 2 | loss: 1.2952825
	speed: 0.0239s/iter; left time: 227.2796s
	iters: 900, epoch: 2 | loss: 0.3757082
	speed: 0.0239s/iter; left time: 225.5809s
	iters: 1000, epoch: 2 | loss: 0.2956468
	speed: 0.0241s/iter; left time: 224.4220s
	iters: 1100, epoch: 2 | loss: 0.3452605
	speed: 0.0248s/iter; left time: 228.5340s
Epoch: 2 cost time: 28.918798685073853
Epoch: 2, Steps: 1147 | Train Loss: 0.4768539 Vali Loss: 0.4531515 Test Loss: 0.1884714
Validation loss decreased (0.485635 --> 0.453151).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4184566
	speed: 0.0262s/iter; left time: 237.8391s
	iters: 200, epoch: 3 | loss: 0.2793791
	speed: 0.0237s/iter; left time: 213.0874s
	iters: 300, epoch: 3 | loss: 0.4155373
	speed: 0.0232s/iter; left time: 205.6432s
	iters: 400, epoch: 3 | loss: 0.3642334
	speed: 0.0242s/iter; left time: 212.5043s
	iters: 500, epoch: 3 | loss: 0.3534885
	speed: 0.0237s/iter; left time: 205.7229s
	iters: 600, epoch: 3 | loss: 0.5152783
	speed: 0.0237s/iter; left time: 203.0270s
	iters: 700, epoch: 3 | loss: 0.2892544
	speed: 0.0250s/iter; left time: 212.1390s
	iters: 800, epoch: 3 | loss: 1.1825626
	speed: 0.0255s/iter; left time: 213.7232s
	iters: 900, epoch: 3 | loss: 0.3917120
	speed: 0.0251s/iter; left time: 207.3428s
	iters: 1000, epoch: 3 | loss: 0.2947696
	speed: 0.0248s/iter; left time: 202.8856s
	iters: 1100, epoch: 3 | loss: 0.4446264
	speed: 0.0246s/iter; left time: 198.6370s
Epoch: 3 cost time: 28.228050231933594
Epoch: 3, Steps: 1147 | Train Loss: 0.4535213 Vali Loss: 0.4415053 Test Loss: 0.1830201
Validation loss decreased (0.453151 --> 0.441505).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 1.1038707
	speed: 0.0266s/iter; left time: 210.6819s
	iters: 200, epoch: 4 | loss: 0.5185323
	speed: 0.0287s/iter; left time: 224.3792s
	iters: 300, epoch: 4 | loss: 1.2429353
	speed: 0.0281s/iter; left time: 217.0479s
	iters: 400, epoch: 4 | loss: 0.4764349
	speed: 0.0262s/iter; left time: 200.1873s
	iters: 500, epoch: 4 | loss: 0.5406264
	speed: 0.0250s/iter; left time: 188.5739s
	iters: 600, epoch: 4 | loss: 1.3078117
	speed: 0.0249s/iter; left time: 184.8599s
	iters: 700, epoch: 4 | loss: 0.3426584
	speed: 0.0248s/iter; left time: 181.6739s
	iters: 800, epoch: 4 | loss: 0.3061293
	speed: 0.0247s/iter; left time: 178.6920s
	iters: 900, epoch: 4 | loss: 0.3009329
	speed: 0.0247s/iter; left time: 175.8536s
	iters: 1000, epoch: 4 | loss: 0.3533873
	speed: 0.0246s/iter; left time: 173.1443s
	iters: 1100, epoch: 4 | loss: 0.3091367
	speed: 0.0245s/iter; left time: 169.7205s
Epoch: 4 cost time: 28.360247135162354
Epoch: 4, Steps: 1147 | Train Loss: 0.4409389 Vali Loss: 0.4383365 Test Loss: 0.1811707
Validation loss decreased (0.441505 --> 0.438336).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4219289
	speed: 0.0241s/iter; left time: 163.3167s
	iters: 200, epoch: 5 | loss: 0.3608316
	speed: 0.0198s/iter; left time: 132.2456s
	iters: 300, epoch: 5 | loss: 0.3896916
	speed: 0.0188s/iter; left time: 124.0624s
	iters: 400, epoch: 5 | loss: 0.2630758
	speed: 0.0189s/iter; left time: 122.6099s
	iters: 500, epoch: 5 | loss: 0.3806939
	speed: 0.0193s/iter; left time: 123.4520s
	iters: 600, epoch: 5 | loss: 0.3060652
	speed: 0.0196s/iter; left time: 123.2445s
	iters: 700, epoch: 5 | loss: 0.2767708
	speed: 0.0210s/iter; left time: 130.0163s
	iters: 800, epoch: 5 | loss: 0.3941169
	speed: 0.0231s/iter; left time: 140.3984s
	iters: 900, epoch: 5 | loss: 0.3251985
	speed: 0.0246s/iter; left time: 147.0850s
	iters: 1000, epoch: 5 | loss: 0.3821940
	speed: 0.0256s/iter; left time: 150.8045s
	iters: 1100, epoch: 5 | loss: 0.2402315
	speed: 0.0266s/iter; left time: 153.6176s
Epoch: 5 cost time: 31.033447265625
Epoch: 5, Steps: 1147 | Train Loss: 0.4330990 Vali Loss: 0.4332758 Test Loss: 0.1792957
Validation loss decreased (0.438336 --> 0.433276).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 1.3163351
	speed: 0.0241s/iter; left time: 136.1061s
	iters: 200, epoch: 6 | loss: 0.2844017
	speed: 0.0177s/iter; left time: 98.1290s
	iters: 300, epoch: 6 | loss: 0.2860209
	speed: 0.0170s/iter; left time: 92.1968s
	iters: 400, epoch: 6 | loss: 0.3063541
	speed: 0.0186s/iter; left time: 99.3131s
	iters: 500, epoch: 6 | loss: 0.5075471
	speed: 0.0196s/iter; left time: 102.6168s
	iters: 600, epoch: 6 | loss: 0.4534374
	speed: 0.0214s/iter; left time: 109.7588s
	iters: 700, epoch: 6 | loss: 0.3975904
	speed: 0.0217s/iter; left time: 109.5286s
	iters: 800, epoch: 6 | loss: 0.3708046
	speed: 0.0221s/iter; left time: 109.0363s
	iters: 900, epoch: 6 | loss: 0.3383520
	speed: 0.0224s/iter; left time: 108.1454s
	iters: 1000, epoch: 6 | loss: 0.2890442
	speed: 0.0226s/iter; left time: 106.9085s
	iters: 1100, epoch: 6 | loss: 0.3578805
	speed: 0.0227s/iter; left time: 105.2915s
Epoch: 6 cost time: 26.437498569488525
Epoch: 6, Steps: 1147 | Train Loss: 0.4295514 Vali Loss: 0.4368057 Test Loss: 0.1786236
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3104377
	speed: 0.0226s/iter; left time: 101.3325s
	iters: 200, epoch: 7 | loss: 0.3458184
	speed: 0.0226s/iter; left time: 99.1803s
	iters: 300, epoch: 7 | loss: 0.4247989
	speed: 0.0223s/iter; left time: 95.7070s
	iters: 400, epoch: 7 | loss: 0.2948338
	speed: 0.0219s/iter; left time: 91.6158s
	iters: 500, epoch: 7 | loss: 0.4134670
	speed: 0.0218s/iter; left time: 89.0821s
	iters: 600, epoch: 7 | loss: 0.3450014
	speed: 0.0217s/iter; left time: 86.3778s
	iters: 700, epoch: 7 | loss: 0.3389557
	speed: 0.0231s/iter; left time: 89.9316s
	iters: 800, epoch: 7 | loss: 0.5413333
	speed: 0.0247s/iter; left time: 93.5139s
	iters: 900, epoch: 7 | loss: 0.3106723
	speed: 0.0262s/iter; left time: 96.5906s
	iters: 1000, epoch: 7 | loss: 0.2981903
	speed: 0.0276s/iter; left time: 98.9861s
	iters: 1100, epoch: 7 | loss: 0.3341064
	speed: 0.0288s/iter; left time: 100.3851s
Epoch: 7 cost time: 33.389606952667236
Epoch: 7, Steps: 1147 | Train Loss: 0.4275567 Vali Loss: 0.4348379 Test Loss: 0.1783110
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.5063621
	speed: 0.0247s/iter; left time: 82.6911s
	iters: 200, epoch: 8 | loss: 0.3049896
	speed: 0.0228s/iter; left time: 74.0287s
	iters: 300, epoch: 8 | loss: 0.2981162
	speed: 0.0228s/iter; left time: 71.5150s
	iters: 400, epoch: 8 | loss: 0.2815236
	speed: 0.0227s/iter; left time: 69.0903s
	iters: 500, epoch: 8 | loss: 0.3164030
	speed: 0.0227s/iter; left time: 66.6660s
	iters: 600, epoch: 8 | loss: 0.3229131
	speed: 0.0235s/iter; left time: 66.8614s
	iters: 700, epoch: 8 | loss: 0.4560148
	speed: 0.0237s/iter; left time: 64.9139s
	iters: 800, epoch: 8 | loss: 0.4214113
	speed: 0.0238s/iter; left time: 62.7665s
	iters: 900, epoch: 8 | loss: 0.3239340
	speed: 0.0239s/iter; left time: 60.6478s
	iters: 1000, epoch: 8 | loss: 0.2938400
	speed: 0.0239s/iter; left time: 58.4470s
	iters: 1100, epoch: 8 | loss: 0.2599351
	speed: 0.0238s/iter; left time: 55.7763s
Epoch: 8 cost time: 27.396217823028564
Epoch: 8, Steps: 1147 | Train Loss: 0.4265430 Vali Loss: 0.4349859 Test Loss: 0.1777131
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2983269
	speed: 0.0310s/iter; left time: 68.0083s
	iters: 200, epoch: 9 | loss: 0.3073389
	speed: 0.0317s/iter; left time: 66.3739s
	iters: 300, epoch: 9 | loss: 0.4743817
	speed: 0.0268s/iter; left time: 53.4066s
	iters: 400, epoch: 9 | loss: 0.3483182
	speed: 0.0266s/iter; left time: 50.4319s
	iters: 500, epoch: 9 | loss: 0.2983436
	speed: 0.0267s/iter; left time: 47.8618s
	iters: 600, epoch: 9 | loss: 0.2989913
	speed: 0.0259s/iter; left time: 43.8455s
	iters: 700, epoch: 9 | loss: 0.4588973
	speed: 0.0258s/iter; left time: 41.1066s
	iters: 800, epoch: 9 | loss: 0.3454275
	speed: 0.0257s/iter; left time: 38.3867s
	iters: 900, epoch: 9 | loss: 0.2980675
	speed: 0.0256s/iter; left time: 35.7554s
	iters: 1000, epoch: 9 | loss: 0.3294221
	speed: 0.0253s/iter; left time: 32.7713s
	iters: 1100, epoch: 9 | loss: 0.2236853
	speed: 0.0250s/iter; left time: 29.8955s
Epoch: 9 cost time: 28.651374578475952
Epoch: 9, Steps: 1147 | Train Loss: 0.4261636 Vali Loss: 0.4353454 Test Loss: 0.1777773
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3306198
	speed: 0.0378s/iter; left time: 39.6413s
	iters: 200, epoch: 10 | loss: 0.2880634
	speed: 0.0323s/iter; left time: 30.6231s
	iters: 300, epoch: 10 | loss: 1.0245091
	speed: 0.0321s/iter; left time: 27.2334s
	iters: 400, epoch: 10 | loss: 0.4274607
	speed: 0.0320s/iter; left time: 23.9672s
	iters: 500, epoch: 10 | loss: 0.4851122
	speed: 0.0305s/iter; left time: 19.7852s
	iters: 600, epoch: 10 | loss: 0.3028643
	speed: 0.0295s/iter; left time: 16.1536s
	iters: 700, epoch: 10 | loss: 1.2507538
	speed: 0.0289s/iter; left time: 12.9405s
	iters: 800, epoch: 10 | loss: 0.2604695
	speed: 0.0282s/iter; left time: 9.8040s
	iters: 900, epoch: 10 | loss: 0.2541346
	speed: 0.0276s/iter; left time: 6.8503s
	iters: 1000, epoch: 10 | loss: 0.3119501
	speed: 0.0271s/iter; left time: 4.0099s
	iters: 1100, epoch: 10 | loss: 0.2848737
	speed: 0.0267s/iter; left time: 1.2808s
Epoch: 10 cost time: 30.681926250457764
Epoch: 10, Steps: 1147 | Train Loss: 0.4260061 Vali Loss: 0.4366754 Test Loss: 0.1778458
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.17929573357105255, mae:0.22017474472522736
Use GPU: cuda:0
no_skip True
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.4194987
	speed: 0.0299s/iter; left time: 340.2331s
	iters: 200, epoch: 1 | loss: 0.4245164
	speed: 0.0264s/iter; left time: 297.2366s
	iters: 300, epoch: 1 | loss: 0.3482685
	speed: 0.0257s/iter; left time: 286.6560s
	iters: 400, epoch: 1 | loss: 0.4163566
	speed: 0.0253s/iter; left time: 279.7556s
	iters: 500, epoch: 1 | loss: 0.3876906
	speed: 0.0245s/iter; left time: 269.1097s
	iters: 600, epoch: 1 | loss: 0.5305611
	speed: 0.0239s/iter; left time: 259.5326s
	iters: 700, epoch: 1 | loss: 0.2656995
	speed: 0.0236s/iter; left time: 254.1918s
	iters: 800, epoch: 1 | loss: 0.3703441
	speed: 0.0234s/iter; left time: 249.3352s
	iters: 900, epoch: 1 | loss: 0.3886459
	speed: 0.0231s/iter; left time: 244.6527s
	iters: 1000, epoch: 1 | loss: 0.2828592
	speed: 0.0240s/iter; left time: 251.3358s
	iters: 1100, epoch: 1 | loss: 0.4012959
	speed: 0.0250s/iter; left time: 258.9097s
Epoch: 1 cost time: 29.282371759414673
Epoch: 1, Steps: 1147 | Train Loss: 0.5305222 Vali Loss: 0.5054409 Test Loss: 0.2028740
Validation loss decreased (inf --> 0.505441).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3840692
	speed: 0.0228s/iter; left time: 233.3001s
	iters: 200, epoch: 2 | loss: 0.3020986
	speed: 0.0187s/iter; left time: 189.5278s
	iters: 300, epoch: 2 | loss: 0.3599571
	speed: 0.0201s/iter; left time: 201.7308s
	iters: 400, epoch: 2 | loss: 0.4964559
	speed: 0.0209s/iter; left time: 207.4927s
	iters: 500, epoch: 2 | loss: 0.3002001
	speed: 0.0213s/iter; left time: 209.1770s
	iters: 600, epoch: 2 | loss: 0.4489713
	speed: 0.0215s/iter; left time: 209.1801s
	iters: 700, epoch: 2 | loss: 0.4467369
	speed: 0.0217s/iter; left time: 208.7720s
	iters: 800, epoch: 2 | loss: 0.7180626
	speed: 0.0218s/iter; left time: 207.6964s
	iters: 900, epoch: 2 | loss: 0.4796305
	speed: 0.0221s/iter; left time: 208.6706s
	iters: 1000, epoch: 2 | loss: 0.4896990
	speed: 0.0225s/iter; left time: 209.7898s
	iters: 1100, epoch: 2 | loss: 0.3800941
	speed: 0.0228s/iter; left time: 210.0843s
Epoch: 2 cost time: 26.38205122947693
Epoch: 2, Steps: 1147 | Train Loss: 0.4801556 Vali Loss: 0.4543736 Test Loss: 0.1846572
Validation loss decreased (0.505441 --> 0.454374).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5818161
	speed: 0.0263s/iter; left time: 238.3035s
	iters: 200, epoch: 3 | loss: 0.3536929
	speed: 0.0251s/iter; left time: 225.4474s
	iters: 300, epoch: 3 | loss: 0.4921768
	speed: 0.0243s/iter; left time: 215.6488s
	iters: 400, epoch: 3 | loss: 0.2743859
	speed: 0.0238s/iter; left time: 209.2307s
	iters: 500, epoch: 3 | loss: 1.5843263
	speed: 0.0235s/iter; left time: 204.3393s
	iters: 600, epoch: 3 | loss: 0.3696047
	speed: 0.0236s/iter; left time: 202.0629s
	iters: 700, epoch: 3 | loss: 0.3909244
	speed: 0.0234s/iter; left time: 198.3033s
	iters: 800, epoch: 3 | loss: 0.3284221
	speed: 0.0232s/iter; left time: 194.6972s
	iters: 900, epoch: 3 | loss: 0.4300528
	speed: 0.0242s/iter; left time: 200.0838s
	iters: 1000, epoch: 3 | loss: 0.3089815
	speed: 0.0252s/iter; left time: 205.8644s
	iters: 1100, epoch: 3 | loss: 1.3037275
	speed: 0.0255s/iter; left time: 206.1520s
Epoch: 3 cost time: 29.362147092819214
Epoch: 3, Steps: 1147 | Train Loss: 0.4570001 Vali Loss: 0.4442292 Test Loss: 0.1832603
Validation loss decreased (0.454374 --> 0.444229).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4125366
	speed: 0.0319s/iter; left time: 253.1718s
	iters: 200, epoch: 4 | loss: 0.3155930
	speed: 0.0291s/iter; left time: 227.6760s
	iters: 300, epoch: 4 | loss: 0.3560732
	speed: 0.0279s/iter; left time: 215.9104s
	iters: 400, epoch: 4 | loss: 0.4989578
	speed: 0.0266s/iter; left time: 202.9709s
	iters: 500, epoch: 4 | loss: 0.2749648
	speed: 0.0263s/iter; left time: 198.1682s
	iters: 600, epoch: 4 | loss: 0.2912153
	speed: 0.0257s/iter; left time: 190.6996s
	iters: 700, epoch: 4 | loss: 0.3644884
	speed: 0.0252s/iter; left time: 184.6720s
	iters: 800, epoch: 4 | loss: 0.4638735
	speed: 0.0248s/iter; left time: 179.5429s
	iters: 900, epoch: 4 | loss: 0.3461788
	speed: 0.0247s/iter; left time: 175.9258s
	iters: 1000, epoch: 4 | loss: 0.2845891
	speed: 0.0246s/iter; left time: 173.2051s
	iters: 1100, epoch: 4 | loss: 0.2321291
	speed: 0.0246s/iter; left time: 170.7102s
Epoch: 4 cost time: 28.38501477241516
Epoch: 4, Steps: 1147 | Train Loss: 0.4442215 Vali Loss: 0.4475625 Test Loss: 0.1855678
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3650293
	speed: 0.0231s/iter; left time: 156.3498s
	iters: 200, epoch: 5 | loss: 0.3694574
	speed: 0.0201s/iter; left time: 134.3294s
	iters: 300, epoch: 5 | loss: 1.3509955
	speed: 0.0188s/iter; left time: 123.5282s
	iters: 400, epoch: 5 | loss: 0.4127256
	speed: 0.0186s/iter; left time: 120.6337s
	iters: 500, epoch: 5 | loss: 1.3025223
	speed: 0.0202s/iter; left time: 128.6694s
	iters: 600, epoch: 5 | loss: 0.2956718
	speed: 0.0215s/iter; left time: 135.1056s
	iters: 700, epoch: 5 | loss: 1.4162514
	speed: 0.0216s/iter; left time: 133.6764s
	iters: 800, epoch: 5 | loss: 0.3726338
	speed: 0.0217s/iter; left time: 131.9176s
	iters: 900, epoch: 5 | loss: 0.2922071
	speed: 0.0219s/iter; left time: 131.1912s
	iters: 1000, epoch: 5 | loss: 0.4931893
	speed: 0.0232s/iter; left time: 136.3189s
	iters: 1100, epoch: 5 | loss: 0.5199134
	speed: 0.0242s/iter; left time: 140.0210s
Epoch: 5 cost time: 28.336399793624878
Epoch: 5, Steps: 1147 | Train Loss: 0.4368037 Vali Loss: 0.4418170 Test Loss: 0.1818056
Validation loss decreased (0.444229 --> 0.441817).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3059480
	speed: 0.0275s/iter; left time: 155.0253s
	iters: 200, epoch: 6 | loss: 0.4052987
	speed: 0.0248s/iter; left time: 137.0476s
	iters: 300, epoch: 6 | loss: 1.2374728
	speed: 0.0256s/iter; left time: 139.2791s
	iters: 400, epoch: 6 | loss: 0.3289211
	speed: 0.0255s/iter; left time: 136.2567s
	iters: 500, epoch: 6 | loss: 0.2722820
	speed: 0.0258s/iter; left time: 134.8939s
	iters: 600, epoch: 6 | loss: 0.2549936
	speed: 0.0251s/iter; left time: 128.7636s
	iters: 700, epoch: 6 | loss: 0.4295102
	speed: 0.0246s/iter; left time: 123.6993s
	iters: 800, epoch: 6 | loss: 0.3637776
	speed: 0.0245s/iter; left time: 121.1108s
	iters: 900, epoch: 6 | loss: 0.3267742
	speed: 0.0245s/iter; left time: 118.4292s
	iters: 1000, epoch: 6 | loss: 0.3247789
	speed: 0.0246s/iter; left time: 116.2991s
	iters: 1100, epoch: 6 | loss: 0.5028448
	speed: 0.0246s/iter; left time: 113.8178s
Epoch: 6 cost time: 28.304761171340942
Epoch: 6, Steps: 1147 | Train Loss: 0.4329836 Vali Loss: 0.4410614 Test Loss: 0.1830414
Validation loss decreased (0.441817 --> 0.441061).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3415061
	speed: 0.0342s/iter; left time: 153.3991s
	iters: 200, epoch: 7 | loss: 0.3093635
	speed: 0.0272s/iter; left time: 119.5060s
	iters: 300, epoch: 7 | loss: 0.2550668
	speed: 0.0245s/iter; left time: 105.2165s
	iters: 400, epoch: 7 | loss: 0.3314526
	speed: 0.0241s/iter; left time: 100.8613s
	iters: 500, epoch: 7 | loss: 0.2735607
	speed: 0.0231s/iter; left time: 94.3758s
	iters: 600, epoch: 7 | loss: 0.2687083
	speed: 0.0229s/iter; left time: 91.3368s
	iters: 700, epoch: 7 | loss: 0.2713045
	speed: 0.0229s/iter; left time: 89.0294s
	iters: 800, epoch: 7 | loss: 0.4125804
	speed: 0.0229s/iter; left time: 86.6022s
	iters: 900, epoch: 7 | loss: 0.2041094
	speed: 0.0228s/iter; left time: 84.2850s
	iters: 1000, epoch: 7 | loss: 0.3220897
	speed: 0.0229s/iter; left time: 82.0389s
	iters: 1100, epoch: 7 | loss: 0.3439726
	speed: 0.0229s/iter; left time: 79.9138s
Epoch: 7 cost time: 26.325381755828857
Epoch: 7, Steps: 1147 | Train Loss: 0.4309633 Vali Loss: 0.4392055 Test Loss: 0.1822963
Validation loss decreased (0.441061 --> 0.439205).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3078634
	speed: 0.0203s/iter; left time: 67.9564s
	iters: 200, epoch: 8 | loss: 0.2891482
	speed: 0.0173s/iter; left time: 55.9262s
	iters: 300, epoch: 8 | loss: 0.2834654
	speed: 0.0151s/iter; left time: 47.4998s
	iters: 400, epoch: 8 | loss: 0.3333712
	speed: 0.0141s/iter; left time: 42.7846s
	iters: 500, epoch: 8 | loss: 0.2736859
	speed: 0.0136s/iter; left time: 39.8707s
	iters: 600, epoch: 8 | loss: 0.2974078
	speed: 0.0145s/iter; left time: 41.0789s
	iters: 700, epoch: 8 | loss: 0.4020419
	speed: 0.0156s/iter; left time: 42.8779s
	iters: 800, epoch: 8 | loss: 0.2702816
	speed: 0.0165s/iter; left time: 43.6435s
	iters: 900, epoch: 8 | loss: 0.3122761
	speed: 0.0172s/iter; left time: 43.7346s
	iters: 1000, epoch: 8 | loss: 0.2431201
	speed: 0.0178s/iter; left time: 43.3653s
	iters: 1100, epoch: 8 | loss: 0.3504947
	speed: 0.0182s/iter; left time: 42.6391s
Epoch: 8 cost time: 21.177903175354004
Epoch: 8, Steps: 1147 | Train Loss: 0.4297114 Vali Loss: 0.4400056 Test Loss: 0.1819114
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2874966
	speed: 0.0247s/iter; left time: 54.2444s
	iters: 200, epoch: 9 | loss: 0.4831266
	speed: 0.0231s/iter; left time: 48.2918s
	iters: 300, epoch: 9 | loss: 0.3506495
	speed: 0.0215s/iter; left time: 42.9765s
	iters: 400, epoch: 9 | loss: 0.2845560
	speed: 0.0203s/iter; left time: 38.4198s
	iters: 500, epoch: 9 | loss: 1.2993412
	speed: 0.0197s/iter; left time: 35.3091s
	iters: 600, epoch: 9 | loss: 0.2626892
	speed: 0.0196s/iter; left time: 33.2867s
	iters: 700, epoch: 9 | loss: 0.4222934
	speed: 0.0201s/iter; left time: 32.0321s
	iters: 800, epoch: 9 | loss: 0.3273975
	speed: 0.0204s/iter; left time: 30.5151s
	iters: 900, epoch: 9 | loss: 0.3248655
	speed: 0.0207s/iter; left time: 28.8308s
	iters: 1000, epoch: 9 | loss: 0.5921411
	speed: 0.0209s/iter; left time: 27.0338s
	iters: 1100, epoch: 9 | loss: 0.4328430
	speed: 0.0210s/iter; left time: 25.1461s
Epoch: 9 cost time: 24.35098433494568
Epoch: 9, Steps: 1147 | Train Loss: 0.4293275 Vali Loss: 0.4379875 Test Loss: 0.1815692
Validation loss decreased (0.439205 --> 0.437988).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2869835
	speed: 0.0246s/iter; left time: 25.8076s
	iters: 200, epoch: 10 | loss: 0.3477376
	speed: 0.0231s/iter; left time: 21.8551s
	iters: 300, epoch: 10 | loss: 1.3478087
	speed: 0.0218s/iter; left time: 18.4600s
	iters: 400, epoch: 10 | loss: 1.2798615
	speed: 0.0205s/iter; left time: 15.3240s
	iters: 500, epoch: 10 | loss: 0.5712965
	speed: 0.0197s/iter; left time: 12.7479s
	iters: 600, epoch: 10 | loss: 0.5519887
	speed: 0.0197s/iter; left time: 10.7745s
	iters: 700, epoch: 10 | loss: 0.4355395
	speed: 0.0201s/iter; left time: 8.9848s
	iters: 800, epoch: 10 | loss: 0.3132114
	speed: 0.0204s/iter; left time: 7.0947s
	iters: 900, epoch: 10 | loss: 0.3495472
	speed: 0.0206s/iter; left time: 5.1200s
	iters: 1000, epoch: 10 | loss: 0.4577270
	speed: 0.0209s/iter; left time: 3.0867s
	iters: 1100, epoch: 10 | loss: 0.2308732
	speed: 0.0210s/iter; left time: 1.0092s
Epoch: 10 cost time: 24.325726985931396
Epoch: 10, Steps: 1147 | Train Loss: 0.4290288 Vali Loss: 0.4389503 Test Loss: 0.1814396
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.18156912922859192, mae:0.22322288155555725
Use GPU: cuda:0
no_skip True
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.5138509
	speed: 0.0198s/iter; left time: 225.6067s
	iters: 200, epoch: 1 | loss: 0.5590425
	speed: 0.0177s/iter; left time: 199.0151s
	iters: 300, epoch: 1 | loss: 0.5176025
	speed: 0.0156s/iter; left time: 174.4795s
	iters: 400, epoch: 1 | loss: 0.4690887
	speed: 0.0153s/iter; left time: 169.6944s
	iters: 500, epoch: 1 | loss: 0.5536767
	speed: 0.0157s/iter; left time: 171.8144s
	iters: 600, epoch: 1 | loss: 0.4332953
	speed: 0.0159s/iter; left time: 173.3331s
	iters: 700, epoch: 1 | loss: 0.5278984
	speed: 0.0161s/iter; left time: 173.5406s
	iters: 800, epoch: 1 | loss: 0.2903340
	speed: 0.0169s/iter; left time: 180.5073s
	iters: 900, epoch: 1 | loss: 0.2899633
	speed: 0.0176s/iter; left time: 185.8732s
	iters: 1000, epoch: 1 | loss: 0.4371974
	speed: 0.0181s/iter; left time: 189.7479s
	iters: 1100, epoch: 1 | loss: 0.3905808
	speed: 0.0186s/iter; left time: 192.4850s
Epoch: 1 cost time: 21.607099056243896
Epoch: 1, Steps: 1147 | Train Loss: 0.5393395 Vali Loss: 0.4880526 Test Loss: 0.1916720
Validation loss decreased (inf --> 0.488053).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4037281
	speed: 0.0221s/iter; left time: 225.7699s
	iters: 200, epoch: 2 | loss: 0.3506340
	speed: 0.0193s/iter; left time: 195.6801s
	iters: 300, epoch: 2 | loss: 0.4853688
	speed: 0.0186s/iter; left time: 186.5724s
	iters: 400, epoch: 2 | loss: 0.3870314
	speed: 0.0189s/iter; left time: 187.4205s
	iters: 500, epoch: 2 | loss: 0.4588223
	speed: 0.0194s/iter; left time: 190.9608s
	iters: 600, epoch: 2 | loss: 0.5158055
	speed: 0.0200s/iter; left time: 194.2792s
	iters: 700, epoch: 2 | loss: 0.3568376
	speed: 0.0204s/iter; left time: 196.0757s
	iters: 800, epoch: 2 | loss: 0.3576157
	speed: 0.0207s/iter; left time: 196.7947s
	iters: 900, epoch: 2 | loss: 0.3437708
	speed: 0.0209s/iter; left time: 196.8475s
	iters: 1000, epoch: 2 | loss: 0.3871966
	speed: 0.0211s/iter; left time: 196.4809s
	iters: 1100, epoch: 2 | loss: 0.5268283
	speed: 0.0212s/iter; left time: 195.7267s
Epoch: 2 cost time: 24.53815269470215
Epoch: 2, Steps: 1147 | Train Loss: 0.4835599 Vali Loss: 0.4688961 Test Loss: 0.1894688
Validation loss decreased (0.488053 --> 0.468896).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7219518
	speed: 0.0221s/iter; left time: 200.4305s
	iters: 200, epoch: 3 | loss: 0.4895488
	speed: 0.0195s/iter; left time: 175.0210s
	iters: 300, epoch: 3 | loss: 0.2944398
	speed: 0.0187s/iter; left time: 166.0903s
	iters: 400, epoch: 3 | loss: 0.3255197
	speed: 0.0189s/iter; left time: 166.1474s
	iters: 500, epoch: 3 | loss: 0.3195559
	speed: 0.0195s/iter; left time: 169.6232s
	iters: 600, epoch: 3 | loss: 0.6042625
	speed: 0.0201s/iter; left time: 172.1460s
	iters: 700, epoch: 3 | loss: 0.2687693
	speed: 0.0204s/iter; left time: 173.3076s
	iters: 800, epoch: 3 | loss: 0.3179599
	speed: 0.0207s/iter; left time: 173.5863s
	iters: 900, epoch: 3 | loss: 0.3786734
	speed: 0.0209s/iter; left time: 173.3171s
	iters: 1000, epoch: 3 | loss: 0.5125718
	speed: 0.0211s/iter; left time: 172.6544s
	iters: 1100, epoch: 3 | loss: 0.4225136
	speed: 0.0213s/iter; left time: 171.6782s
Epoch: 3 cost time: 24.57506489753723
Epoch: 3, Steps: 1147 | Train Loss: 0.4601399 Vali Loss: 0.4678138 Test Loss: 0.1919477
Validation loss decreased (0.468896 --> 0.467814).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4375398
	speed: 0.0228s/iter; left time: 180.7816s
	iters: 200, epoch: 4 | loss: 0.3644816
	speed: 0.0197s/iter; left time: 154.3603s
	iters: 300, epoch: 4 | loss: 0.3987245
	speed: 0.0189s/iter; left time: 145.7870s
	iters: 400, epoch: 4 | loss: 0.4163085
	speed: 0.0190s/iter; left time: 145.1737s
	iters: 500, epoch: 4 | loss: 0.5959361
	speed: 0.0196s/iter; left time: 147.5757s
	iters: 600, epoch: 4 | loss: 0.3343903
	speed: 0.0199s/iter; left time: 148.0794s
	iters: 700, epoch: 4 | loss: 0.3675745
	speed: 0.0197s/iter; left time: 144.3375s
	iters: 800, epoch: 4 | loss: 0.4696515
	speed: 0.0194s/iter; left time: 140.1676s
	iters: 900, epoch: 4 | loss: 0.3070588
	speed: 0.0192s/iter; left time: 136.6318s
	iters: 1000, epoch: 4 | loss: 1.2811486
	speed: 0.0190s/iter; left time: 133.4559s
	iters: 1100, epoch: 4 | loss: 0.2633906
	speed: 0.0189s/iter; left time: 131.0339s
Epoch: 4 cost time: 21.99867033958435
Epoch: 4, Steps: 1147 | Train Loss: 0.4489348 Vali Loss: 0.4432920 Test Loss: 0.1863416
Validation loss decreased (0.467814 --> 0.443292).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3213476
	speed: 0.0216s/iter; left time: 146.7108s
	iters: 200, epoch: 5 | loss: 0.4307002
	speed: 0.0191s/iter; left time: 127.6153s
	iters: 300, epoch: 5 | loss: 0.3742771
	speed: 0.0186s/iter; left time: 122.3637s
	iters: 400, epoch: 5 | loss: 0.4447170
	speed: 0.0188s/iter; left time: 122.1558s
	iters: 500, epoch: 5 | loss: 0.4267270
	speed: 0.0189s/iter; left time: 120.8528s
	iters: 600, epoch: 5 | loss: 0.5428466
	speed: 0.0190s/iter; left time: 119.4216s
	iters: 700, epoch: 5 | loss: 0.2637467
	speed: 0.0192s/iter; left time: 118.9937s
	iters: 800, epoch: 5 | loss: 0.4475128
	speed: 0.0197s/iter; left time: 119.6954s
	iters: 900, epoch: 5 | loss: 0.3035094
	speed: 0.0200s/iter; left time: 119.7416s
	iters: 1000, epoch: 5 | loss: 0.3672989
	speed: 0.0203s/iter; left time: 119.3477s
	iters: 1100, epoch: 5 | loss: 0.4562511
	speed: 0.0205s/iter; left time: 118.5867s
Epoch: 5 cost time: 23.74341654777527
Epoch: 5, Steps: 1147 | Train Loss: 0.4416335 Vali Loss: 0.4406101 Test Loss: 0.1836944
Validation loss decreased (0.443292 --> 0.440610).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4100743
	speed: 0.0222s/iter; left time: 125.0249s
	iters: 200, epoch: 6 | loss: 0.3516586
	speed: 0.0212s/iter; left time: 117.3019s
	iters: 300, epoch: 6 | loss: 0.3130738
	speed: 0.0213s/iter; left time: 115.6077s
	iters: 400, epoch: 6 | loss: 0.3762144
	speed: 0.0210s/iter; left time: 111.9369s
	iters: 500, epoch: 6 | loss: 0.2631045
	speed: 0.0207s/iter; left time: 108.1749s
	iters: 600, epoch: 6 | loss: 0.2866797
	speed: 0.0205s/iter; left time: 105.4793s
	iters: 700, epoch: 6 | loss: 0.4016907
	speed: 0.0207s/iter; left time: 104.0841s
	iters: 800, epoch: 6 | loss: 0.3695438
	speed: 0.0209s/iter; left time: 103.2675s
	iters: 900, epoch: 6 | loss: 0.2833123
	speed: 0.0211s/iter; left time: 102.1527s
	iters: 1000, epoch: 6 | loss: 0.5396139
	speed: 0.0213s/iter; left time: 100.7866s
	iters: 1100, epoch: 6 | loss: 0.4802554
	speed: 0.0214s/iter; left time: 99.2551s
Epoch: 6 cost time: 24.748021602630615
Epoch: 6, Steps: 1147 | Train Loss: 0.4380608 Vali Loss: 0.4362975 Test Loss: 0.1823829
Validation loss decreased (0.440610 --> 0.436297).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4357808
	speed: 0.0217s/iter; left time: 97.2662s
	iters: 200, epoch: 7 | loss: 0.3185975
	speed: 0.0209s/iter; left time: 91.7547s
	iters: 300, epoch: 7 | loss: 0.4636554
	speed: 0.0205s/iter; left time: 87.8661s
	iters: 400, epoch: 7 | loss: 0.2725381
	speed: 0.0196s/iter; left time: 82.1409s
	iters: 500, epoch: 7 | loss: 0.3072036
	speed: 0.0186s/iter; left time: 75.9703s
	iters: 600, epoch: 7 | loss: 0.3350920
	speed: 0.0179s/iter; left time: 71.4255s
	iters: 700, epoch: 7 | loss: 0.3879776
	speed: 0.0175s/iter; left time: 67.9323s
	iters: 800, epoch: 7 | loss: 0.3213226
	speed: 0.0175s/iter; left time: 66.3864s
	iters: 900, epoch: 7 | loss: 0.3561836
	speed: 0.0176s/iter; left time: 64.8181s
	iters: 1000, epoch: 7 | loss: 0.3063233
	speed: 0.0176s/iter; left time: 62.9902s
	iters: 1100, epoch: 7 | loss: 0.5417576
	speed: 0.0176s/iter; left time: 61.4097s
Epoch: 7 cost time: 20.243219137191772
Epoch: 7, Steps: 1147 | Train Loss: 0.4360689 Vali Loss: 0.4347451 Test Loss: 0.1827737
Validation loss decreased (0.436297 --> 0.434745).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4020187
	speed: 0.0252s/iter; left time: 84.1234s
	iters: 200, epoch: 8 | loss: 0.3479191
	speed: 0.0241s/iter; left time: 78.0002s
	iters: 300, epoch: 8 | loss: 0.2538692
	speed: 0.0237s/iter; left time: 74.3899s
	iters: 400, epoch: 8 | loss: 0.4256972
	speed: 0.0228s/iter; left time: 69.5072s
	iters: 500, epoch: 8 | loss: 0.4866788
	speed: 0.0222s/iter; left time: 65.2907s
	iters: 600, epoch: 8 | loss: 0.3198092
	speed: 0.0218s/iter; left time: 61.9021s
	iters: 700, epoch: 8 | loss: 0.2865647
	speed: 0.0215s/iter; left time: 58.8894s
	iters: 800, epoch: 8 | loss: 0.2765174
	speed: 0.0213s/iter; left time: 56.1588s
	iters: 900, epoch: 8 | loss: 1.1857101
	speed: 0.0211s/iter; left time: 53.6625s
	iters: 1000, epoch: 8 | loss: 1.2290362
	speed: 0.0211s/iter; left time: 51.5595s
	iters: 1100, epoch: 8 | loss: 0.4540265
	speed: 0.0213s/iter; left time: 49.8062s
Epoch: 8 cost time: 24.580047369003296
Epoch: 8, Steps: 1147 | Train Loss: 0.4351636 Vali Loss: 0.4360891 Test Loss: 0.1826876
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3587115
	speed: 0.0249s/iter; left time: 54.7630s
	iters: 200, epoch: 9 | loss: 0.2729281
	speed: 0.0241s/iter; left time: 50.3919s
	iters: 300, epoch: 9 | loss: 0.4476754
	speed: 0.0237s/iter; left time: 47.3666s
	iters: 400, epoch: 9 | loss: 0.6237720
	speed: 0.0229s/iter; left time: 43.3365s
	iters: 500, epoch: 9 | loss: 0.3906384
	speed: 0.0222s/iter; left time: 39.8314s
	iters: 600, epoch: 9 | loss: 1.1889763
	speed: 0.0218s/iter; left time: 36.9097s
	iters: 700, epoch: 9 | loss: 0.4705200
	speed: 0.0213s/iter; left time: 33.8995s
	iters: 800, epoch: 9 | loss: 0.3814868
	speed: 0.0211s/iter; left time: 31.4799s
	iters: 900, epoch: 9 | loss: 0.3299628
	speed: 0.0209s/iter; left time: 29.2156s
	iters: 1000, epoch: 9 | loss: 0.4373114
	speed: 0.0210s/iter; left time: 27.2050s
	iters: 1100, epoch: 9 | loss: 0.3443663
	speed: 0.0212s/iter; left time: 25.2970s
Epoch: 9 cost time: 24.486641883850098
Epoch: 9, Steps: 1147 | Train Loss: 0.4341811 Vali Loss: 0.4350252 Test Loss: 0.1824798
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.5310405
	speed: 0.0246s/iter; left time: 25.8248s
	iters: 200, epoch: 10 | loss: 0.4329401
	speed: 0.0237s/iter; left time: 22.4647s
	iters: 300, epoch: 10 | loss: 1.1349021
	speed: 0.0234s/iter; left time: 19.8265s
	iters: 400, epoch: 10 | loss: 0.6094496
	speed: 0.0227s/iter; left time: 16.9859s
	iters: 500, epoch: 10 | loss: 0.2935498
	speed: 0.0221s/iter; left time: 14.2886s
	iters: 600, epoch: 10 | loss: 0.2685199
	speed: 0.0217s/iter; left time: 11.8803s
	iters: 700, epoch: 10 | loss: 0.2582690
	speed: 0.0211s/iter; left time: 9.4488s
	iters: 800, epoch: 10 | loss: 0.4683408
	speed: 0.0209s/iter; left time: 7.2820s
	iters: 900, epoch: 10 | loss: 0.2678992
	speed: 0.0208s/iter; left time: 5.1684s
	iters: 1000, epoch: 10 | loss: 0.3380786
	speed: 0.0209s/iter; left time: 3.0941s
	iters: 1100, epoch: 10 | loss: 0.3407036
	speed: 0.0211s/iter; left time: 1.0116s
Epoch: 10 cost time: 24.373911142349243
Epoch: 10, Steps: 1147 | Train Loss: 0.4343023 Vali Loss: 0.4350245 Test Loss: 0.1820919
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.18277375400066376, mae:0.22475159168243408
Seed: 456
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_192      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip True
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.4699776
	speed: 0.0266s/iter; left time: 301.1490s
	iters: 200, epoch: 1 | loss: 0.5037795
	speed: 0.0227s/iter; left time: 255.6253s
	iters: 300, epoch: 1 | loss: 0.6110770
	speed: 0.0228s/iter; left time: 253.5688s
	iters: 400, epoch: 1 | loss: 0.4250486
	speed: 0.0228s/iter; left time: 251.4723s
	iters: 500, epoch: 1 | loss: 0.7581743
	speed: 0.0228s/iter; left time: 249.3100s
	iters: 600, epoch: 1 | loss: 0.4835996
	speed: 0.0228s/iter; left time: 247.0595s
	iters: 700, epoch: 1 | loss: 0.4661070
	speed: 0.0228s/iter; left time: 244.8275s
	iters: 800, epoch: 1 | loss: 0.4295822
	speed: 0.0226s/iter; left time: 240.1664s
	iters: 900, epoch: 1 | loss: 0.9647819
	speed: 0.0222s/iter; left time: 234.1553s
	iters: 1000, epoch: 1 | loss: 0.4522210
	speed: 0.0220s/iter; left time: 229.4238s
	iters: 1100, epoch: 1 | loss: 0.4540658
	speed: 0.0216s/iter; left time: 223.6475s
Epoch: 1 cost time: 24.71391248703003
Epoch: 1, Steps: 1144 | Train Loss: 0.6106439 Vali Loss: 0.5599546 Test Loss: 0.2399934
Validation loss decreased (inf --> 0.559955).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8770716
	speed: 0.0249s/iter; left time: 254.3684s
	iters: 200, epoch: 2 | loss: 0.4946538
	speed: 0.0239s/iter; left time: 241.0720s
	iters: 300, epoch: 2 | loss: 0.4119645
	speed: 0.0235s/iter; left time: 235.0334s
	iters: 400, epoch: 2 | loss: 0.4981545
	speed: 0.0233s/iter; left time: 231.0549s
	iters: 500, epoch: 2 | loss: 0.3789501
	speed: 0.0232s/iter; left time: 227.6673s
	iters: 600, epoch: 2 | loss: 0.4986988
	speed: 0.0232s/iter; left time: 224.6476s
	iters: 700, epoch: 2 | loss: 0.4757580
	speed: 0.0231s/iter; left time: 221.9019s
	iters: 800, epoch: 2 | loss: 0.4338241
	speed: 0.0229s/iter; left time: 217.4657s
	iters: 900, epoch: 2 | loss: 0.9579991
	speed: 0.0225s/iter; left time: 211.5450s
	iters: 1000, epoch: 2 | loss: 0.4656848
	speed: 0.0223s/iter; left time: 206.9512s
	iters: 1100, epoch: 2 | loss: 0.4938960
	speed: 0.0218s/iter; left time: 200.7541s
Epoch: 2 cost time: 25.01893424987793
Epoch: 2, Steps: 1144 | Train Loss: 0.5507234 Vali Loss: 0.5439649 Test Loss: 0.2345928
Validation loss decreased (0.559955 --> 0.543965).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4405813
	speed: 0.0249s/iter; left time: 225.4553s
	iters: 200, epoch: 3 | loss: 0.5715010
	speed: 0.0239s/iter; left time: 213.7810s
	iters: 300, epoch: 3 | loss: 0.3790986
	speed: 0.0235s/iter; left time: 208.2577s
	iters: 400, epoch: 3 | loss: 0.5524709
	speed: 0.0233s/iter; left time: 204.3481s
	iters: 500, epoch: 3 | loss: 0.4174264
	speed: 0.0232s/iter; left time: 201.1640s
	iters: 600, epoch: 3 | loss: 0.5326326
	speed: 0.0232s/iter; left time: 198.2182s
	iters: 700, epoch: 3 | loss: 0.5482334
	speed: 0.0231s/iter; left time: 195.4647s
	iters: 800, epoch: 3 | loss: 0.8730491
	speed: 0.0229s/iter; left time: 190.9916s
	iters: 900, epoch: 3 | loss: 0.5128996
	speed: 0.0225s/iter; left time: 185.6176s
	iters: 1000, epoch: 3 | loss: 0.7080288
	speed: 0.0222s/iter; left time: 181.2151s
	iters: 1100, epoch: 3 | loss: 0.9854610
	speed: 0.0218s/iter; left time: 175.6930s
Epoch: 3 cost time: 24.977501392364502
Epoch: 3, Steps: 1144 | Train Loss: 0.5272650 Vali Loss: 0.5311422 Test Loss: 0.2312735
Validation loss decreased (0.543965 --> 0.531142).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4087968
	speed: 0.0219s/iter; left time: 173.1711s
	iters: 200, epoch: 4 | loss: 0.3699036
	speed: 0.0196s/iter; left time: 153.1768s
	iters: 300, epoch: 4 | loss: 0.9801094
	speed: 0.0191s/iter; left time: 147.0676s
	iters: 400, epoch: 4 | loss: 0.9252737
	speed: 0.0187s/iter; left time: 142.1962s
	iters: 500, epoch: 4 | loss: 0.9565806
	speed: 0.0185s/iter; left time: 138.5954s
	iters: 600, epoch: 4 | loss: 0.5615395
	speed: 0.0180s/iter; left time: 133.3357s
	iters: 700, epoch: 4 | loss: 0.5486253
	speed: 0.0184s/iter; left time: 134.4913s
	iters: 800, epoch: 4 | loss: 0.7894970
	speed: 0.0187s/iter; left time: 134.9905s
	iters: 900, epoch: 4 | loss: 0.3452766
	speed: 0.0188s/iter; left time: 133.6470s
	iters: 1000, epoch: 4 | loss: 0.4166541
	speed: 0.0189s/iter; left time: 132.3876s
	iters: 1100, epoch: 4 | loss: 0.3269930
	speed: 0.0187s/iter; left time: 129.0692s
Epoch: 4 cost time: 21.411571979522705
Epoch: 4, Steps: 1144 | Train Loss: 0.5184642 Vali Loss: 0.5126150 Test Loss: 0.2292341
Validation loss decreased (0.531142 --> 0.512615).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5103881
	speed: 0.0190s/iter; left time: 128.6511s
	iters: 200, epoch: 5 | loss: 0.3019876
	speed: 0.0183s/iter; left time: 121.8198s
	iters: 300, epoch: 5 | loss: 0.4918709
	speed: 0.0183s/iter; left time: 120.1598s
	iters: 400, epoch: 5 | loss: 0.3271984
	speed: 0.0194s/iter; left time: 125.3736s
	iters: 500, epoch: 5 | loss: 0.4232146
	speed: 0.0201s/iter; left time: 127.7638s
	iters: 600, epoch: 5 | loss: 0.4682432
	speed: 0.0205s/iter; left time: 128.6080s
	iters: 700, epoch: 5 | loss: 0.9556544
	speed: 0.0209s/iter; left time: 128.6043s
	iters: 800, epoch: 5 | loss: 0.8852165
	speed: 0.0211s/iter; left time: 127.9981s
	iters: 900, epoch: 5 | loss: 1.0567818
	speed: 0.0213s/iter; left time: 127.0155s
	iters: 1000, epoch: 5 | loss: 0.4560152
	speed: 0.0214s/iter; left time: 125.7964s
	iters: 1100, epoch: 5 | loss: 0.4100015
	speed: 0.0214s/iter; left time: 123.3700s
Epoch: 5 cost time: 24.560829877853394
Epoch: 5, Steps: 1144 | Train Loss: 0.5123717 Vali Loss: 0.5166996 Test Loss: 0.2295568
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3083608
	speed: 0.0185s/iter; left time: 103.8516s
	iters: 200, epoch: 6 | loss: 0.4825136
	speed: 0.0181s/iter; left time: 100.1144s
	iters: 300, epoch: 6 | loss: 0.4367687
	speed: 0.0186s/iter; left time: 100.8766s
	iters: 400, epoch: 6 | loss: 0.4436519
	speed: 0.0196s/iter; left time: 104.4762s
	iters: 500, epoch: 6 | loss: 0.9290603
	speed: 0.0204s/iter; left time: 106.2581s
	iters: 600, epoch: 6 | loss: 0.3857984
	speed: 0.0209s/iter; left time: 106.7784s
	iters: 700, epoch: 6 | loss: 0.4713930
	speed: 0.0212s/iter; left time: 106.3905s
	iters: 800, epoch: 6 | loss: 0.4835114
	speed: 0.0214s/iter; left time: 105.4055s
	iters: 900, epoch: 6 | loss: 0.5247667
	speed: 0.0216s/iter; left time: 104.2238s
	iters: 1000, epoch: 6 | loss: 0.4467692
	speed: 0.0218s/iter; left time: 102.8052s
	iters: 1100, epoch: 6 | loss: 0.4913961
	speed: 0.0219s/iter; left time: 101.1622s
Epoch: 6 cost time: 25.17008090019226
Epoch: 6, Steps: 1144 | Train Loss: 0.5092349 Vali Loss: 0.5154408 Test Loss: 0.2294852
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 1.3704890
	speed: 0.0192s/iter; left time: 85.9924s
	iters: 200, epoch: 7 | loss: 0.3808105
	speed: 0.0186s/iter; left time: 81.4416s
	iters: 300, epoch: 7 | loss: 0.9479573
	speed: 0.0189s/iter; left time: 80.6861s
	iters: 400, epoch: 7 | loss: 0.5490944
	speed: 0.0193s/iter; left time: 80.8069s
	iters: 500, epoch: 7 | loss: 0.3524157
	speed: 0.0191s/iter; left time: 78.0530s
	iters: 600, epoch: 7 | loss: 0.5482960
	speed: 0.0188s/iter; left time: 74.9247s
	iters: 700, epoch: 7 | loss: 0.4030071
	speed: 0.0187s/iter; left time: 72.3083s
	iters: 800, epoch: 7 | loss: 0.3161435
	speed: 0.0185s/iter; left time: 69.9085s
	iters: 900, epoch: 7 | loss: 0.4416501
	speed: 0.0186s/iter; left time: 68.3486s
	iters: 1000, epoch: 7 | loss: 0.4830500
	speed: 0.0190s/iter; left time: 68.1083s
	iters: 1100, epoch: 7 | loss: 0.3307625
	speed: 0.0194s/iter; left time: 67.5262s
Epoch: 7 cost time: 22.459951162338257
Epoch: 7, Steps: 1144 | Train Loss: 0.5076606 Vali Loss: 0.5154205 Test Loss: 0.2287633
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3684366
	speed: 0.0190s/iter; left time: 63.3109s
	iters: 200, epoch: 8 | loss: 0.3566855
	speed: 0.0183s/iter; left time: 59.1540s
	iters: 300, epoch: 8 | loss: 0.4992252
	speed: 0.0188s/iter; left time: 58.9312s
	iters: 400, epoch: 8 | loss: 0.4037732
	speed: 0.0194s/iter; left time: 58.8946s
	iters: 500, epoch: 8 | loss: 0.4422638
	speed: 0.0201s/iter; left time: 58.9613s
	iters: 600, epoch: 8 | loss: 0.4257878
	speed: 0.0206s/iter; left time: 58.2349s
	iters: 700, epoch: 8 | loss: 1.2560160
	speed: 0.0209s/iter; left time: 57.0732s
	iters: 800, epoch: 8 | loss: 0.4418724
	speed: 0.0211s/iter; left time: 55.6382s
	iters: 900, epoch: 8 | loss: 0.3627168
	speed: 0.0213s/iter; left time: 54.0002s
	iters: 1000, epoch: 8 | loss: 0.4231596
	speed: 0.0215s/iter; left time: 52.2328s
	iters: 1100, epoch: 8 | loss: 0.5706781
	speed: 0.0216s/iter; left time: 50.3821s
Epoch: 8 cost time: 24.88079047203064
Epoch: 8, Steps: 1144 | Train Loss: 0.5068763 Vali Loss: 0.5135677 Test Loss: 0.2283255
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.9284544
	speed: 0.0189s/iter; left time: 41.3778s
	iters: 200, epoch: 9 | loss: 0.4523991
	speed: 0.0182s/iter; left time: 38.0724s
	iters: 300, epoch: 9 | loss: 0.5247586
	speed: 0.0188s/iter; left time: 37.3410s
	iters: 400, epoch: 9 | loss: 0.3884032
	speed: 0.0194s/iter; left time: 36.5750s
	iters: 500, epoch: 9 | loss: 0.3678794
	speed: 0.0201s/iter; left time: 35.9795s
	iters: 600, epoch: 9 | loss: 0.3815482
	speed: 0.0206s/iter; left time: 34.7942s
	iters: 700, epoch: 9 | loss: 0.3289774
	speed: 0.0209s/iter; left time: 33.2376s
	iters: 800, epoch: 9 | loss: 0.4304359
	speed: 0.0212s/iter; left time: 31.5031s
	iters: 900, epoch: 9 | loss: 0.4140954
	speed: 0.0213s/iter; left time: 29.6488s
	iters: 1000, epoch: 9 | loss: 0.4970722
	speed: 0.0215s/iter; left time: 27.7045s
	iters: 1100, epoch: 9 | loss: 0.4656008
	speed: 0.0216s/iter; left time: 25.7005s
Epoch: 9 cost time: 24.921526432037354
Epoch: 9, Steps: 1144 | Train Loss: 0.5065543 Vali Loss: 0.5125046 Test Loss: 0.2283367
Validation loss decreased (0.512615 --> 0.512505).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.4898258
	speed: 0.0197s/iter; left time: 20.5624s
	iters: 200, epoch: 10 | loss: 0.3826172
	speed: 0.0189s/iter; left time: 17.8280s
	iters: 300, epoch: 10 | loss: 0.5087442
	speed: 0.0192s/iter; left time: 16.2373s
	iters: 400, epoch: 10 | loss: 0.8947507
	speed: 0.0197s/iter; left time: 14.6885s
	iters: 500, epoch: 10 | loss: 0.9607779
	speed: 0.0203s/iter; left time: 13.1227s
	iters: 600, epoch: 10 | loss: 0.4437172
	speed: 0.0208s/iter; left time: 11.3249s
	iters: 700, epoch: 10 | loss: 0.5111696
	speed: 0.0211s/iter; left time: 9.4001s
	iters: 800, epoch: 10 | loss: 0.3566097
	speed: 0.0207s/iter; left time: 7.1523s
	iters: 900, epoch: 10 | loss: 0.4202587
	speed: 0.0203s/iter; left time: 4.9856s
	iters: 1000, epoch: 10 | loss: 0.3611764
	speed: 0.0201s/iter; left time: 2.9198s
	iters: 1100, epoch: 10 | loss: 0.4190935
	speed: 0.0199s/iter; left time: 0.8955s
Epoch: 10 cost time: 22.782984495162964
Epoch: 10, Steps: 1144 | Train Loss: 0.5064401 Vali Loss: 0.5125704 Test Loss: 0.2283860
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.22833673655986786, mae:0.2618349492549896
Use GPU: cuda:0
no_skip True
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.9288230
	speed: 0.0222s/iter; left time: 251.7300s
	iters: 200, epoch: 1 | loss: 0.6852834
	speed: 0.0219s/iter; left time: 246.6860s
	iters: 300, epoch: 1 | loss: 0.4939030
	speed: 0.0223s/iter; left time: 248.8605s
	iters: 400, epoch: 1 | loss: 0.5413460
	speed: 0.0225s/iter; left time: 248.9610s
	iters: 500, epoch: 1 | loss: 0.4335200
	speed: 0.0227s/iter; left time: 248.3797s
	iters: 600, epoch: 1 | loss: 0.4473608
	speed: 0.0228s/iter; left time: 246.9499s
	iters: 700, epoch: 1 | loss: 0.5095853
	speed: 0.0228s/iter; left time: 245.3131s
	iters: 800, epoch: 1 | loss: 0.8502653
	speed: 0.0229s/iter; left time: 243.4836s
	iters: 900, epoch: 1 | loss: 0.4755328
	speed: 0.0229s/iter; left time: 241.6059s
	iters: 1000, epoch: 1 | loss: 0.5082125
	speed: 0.0229s/iter; left time: 239.6041s
	iters: 1100, epoch: 1 | loss: 0.5139626
	speed: 0.0229s/iter; left time: 236.4359s
Epoch: 1 cost time: 26.147310495376587
Epoch: 1, Steps: 1144 | Train Loss: 0.6034090 Vali Loss: 0.5561866 Test Loss: 0.2450692
Validation loss decreased (inf --> 0.556187).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6408188
	speed: 0.0217s/iter; left time: 221.7494s
	iters: 200, epoch: 2 | loss: 0.3614370
	speed: 0.0218s/iter; left time: 220.4307s
	iters: 300, epoch: 2 | loss: 0.4274008
	speed: 0.0223s/iter; left time: 222.9487s
	iters: 400, epoch: 2 | loss: 0.7356048
	speed: 0.0225s/iter; left time: 222.8305s
	iters: 500, epoch: 2 | loss: 0.9630635
	speed: 0.0226s/iter; left time: 221.6820s
	iters: 600, epoch: 2 | loss: 0.4274497
	speed: 0.0227s/iter; left time: 220.3139s
	iters: 700, epoch: 2 | loss: 0.4440877
	speed: 0.0228s/iter; left time: 218.5834s
	iters: 800, epoch: 2 | loss: 0.3879166
	speed: 0.0228s/iter; left time: 216.8586s
	iters: 900, epoch: 2 | loss: 0.7710254
	speed: 0.0229s/iter; left time: 215.0750s
	iters: 1000, epoch: 2 | loss: 0.5555598
	speed: 0.0229s/iter; left time: 213.0253s
	iters: 1100, epoch: 2 | loss: 0.6092819
	speed: 0.0228s/iter; left time: 210.0015s
Epoch: 2 cost time: 26.119047164916992
Epoch: 2, Steps: 1144 | Train Loss: 0.5484763 Vali Loss: 0.5299119 Test Loss: 0.2375614
Validation loss decreased (0.556187 --> 0.529912).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3480848
	speed: 0.0225s/iter; left time: 203.3716s
	iters: 200, epoch: 3 | loss: 0.4300185
	speed: 0.0222s/iter; left time: 198.4546s
	iters: 300, epoch: 3 | loss: 0.4389456
	speed: 0.0224s/iter; left time: 198.2471s
	iters: 400, epoch: 3 | loss: 0.3969757
	speed: 0.0225s/iter; left time: 196.9628s
	iters: 500, epoch: 3 | loss: 0.9048121
	speed: 0.0226s/iter; left time: 195.2286s
	iters: 600, epoch: 3 | loss: 0.3150460
	speed: 0.0226s/iter; left time: 193.3797s
	iters: 700, epoch: 3 | loss: 1.0184103
	speed: 0.0227s/iter; left time: 191.4964s
	iters: 800, epoch: 3 | loss: 0.7381496
	speed: 0.0222s/iter; left time: 185.4158s
	iters: 900, epoch: 3 | loss: 0.4217966
	speed: 0.0216s/iter; left time: 178.6622s
	iters: 1000, epoch: 3 | loss: 0.4028787
	speed: 0.0213s/iter; left time: 173.4026s
	iters: 1100, epoch: 3 | loss: 0.4457024
	speed: 0.0208s/iter; left time: 167.8928s
Epoch: 3 cost time: 23.745442152023315
Epoch: 3, Steps: 1144 | Train Loss: 0.5298593 Vali Loss: 0.5292876 Test Loss: 0.2387914
Validation loss decreased (0.529912 --> 0.529288).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4250911
	speed: 0.0215s/iter; left time: 170.2027s
	iters: 200, epoch: 4 | loss: 0.6327095
	speed: 0.0209s/iter; left time: 162.8888s
	iters: 300, epoch: 4 | loss: 0.5039669
	speed: 0.0203s/iter; left time: 156.3044s
	iters: 400, epoch: 4 | loss: 0.5585417
	speed: 0.0206s/iter; left time: 157.0660s
	iters: 500, epoch: 4 | loss: 0.4937556
	speed: 0.0211s/iter; left time: 158.3067s
	iters: 600, epoch: 4 | loss: 0.3549449
	speed: 0.0214s/iter; left time: 158.3126s
	iters: 700, epoch: 4 | loss: 0.3877189
	speed: 0.0216s/iter; left time: 157.6856s
	iters: 800, epoch: 4 | loss: 0.3586748
	speed: 0.0217s/iter; left time: 156.6786s
	iters: 900, epoch: 4 | loss: 0.3697824
	speed: 0.0219s/iter; left time: 155.4023s
	iters: 1000, epoch: 4 | loss: 0.4305013
	speed: 0.0220s/iter; left time: 153.8890s
	iters: 1100, epoch: 4 | loss: 0.4104582
	speed: 0.0219s/iter; left time: 151.4597s
Epoch: 4 cost time: 25.08013415336609
Epoch: 4, Steps: 1144 | Train Loss: 0.5202344 Vali Loss: 0.5109863 Test Loss: 0.2309737
Validation loss decreased (0.529288 --> 0.510986).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4979887
	speed: 0.0222s/iter; left time: 150.0276s
	iters: 200, epoch: 5 | loss: 0.4169221
	speed: 0.0208s/iter; left time: 138.6334s
	iters: 300, epoch: 5 | loss: 0.4242856
	speed: 0.0203s/iter; left time: 133.4896s
	iters: 400, epoch: 5 | loss: 0.9161988
	speed: 0.0208s/iter; left time: 134.6583s
	iters: 500, epoch: 5 | loss: 0.4467774
	speed: 0.0212s/iter; left time: 135.1270s
	iters: 600, epoch: 5 | loss: 0.5633363
	speed: 0.0215s/iter; left time: 134.6260s
	iters: 700, epoch: 5 | loss: 0.4714154
	speed: 0.0217s/iter; left time: 133.6658s
	iters: 800, epoch: 5 | loss: 0.4566252
	speed: 0.0218s/iter; left time: 132.3836s
	iters: 900, epoch: 5 | loss: 0.3853497
	speed: 0.0219s/iter; left time: 130.8559s
	iters: 1000, epoch: 5 | loss: 0.4753821
	speed: 0.0220s/iter; left time: 129.1919s
	iters: 1100, epoch: 5 | loss: 0.4559639
	speed: 0.0220s/iter; left time: 126.8749s
Epoch: 5 cost time: 25.224997520446777
Epoch: 5, Steps: 1144 | Train Loss: 0.5138155 Vali Loss: 0.5127837 Test Loss: 0.2309158
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3927940
	speed: 0.0185s/iter; left time: 104.0391s
	iters: 200, epoch: 6 | loss: 0.8497272
	speed: 0.0176s/iter; left time: 97.2360s
	iters: 300, epoch: 6 | loss: 0.4512608
	speed: 0.0183s/iter; left time: 99.1717s
	iters: 400, epoch: 6 | loss: 0.4631890
	speed: 0.0191s/iter; left time: 101.6003s
	iters: 500, epoch: 6 | loss: 0.4549650
	speed: 0.0198s/iter; left time: 103.6018s
	iters: 600, epoch: 6 | loss: 0.4662148
	speed: 0.0203s/iter; left time: 104.1823s
	iters: 700, epoch: 6 | loss: 0.3886094
	speed: 0.0207s/iter; left time: 104.1325s
	iters: 800, epoch: 6 | loss: 0.4669783
	speed: 0.0211s/iter; left time: 103.6138s
	iters: 900, epoch: 6 | loss: 0.3795203
	speed: 0.0213s/iter; left time: 102.6615s
	iters: 1000, epoch: 6 | loss: 0.3843917
	speed: 0.0215s/iter; left time: 101.3296s
	iters: 1100, epoch: 6 | loss: 0.3242520
	speed: 0.0212s/iter; left time: 98.1950s
Epoch: 6 cost time: 24.304636001586914
Epoch: 6, Steps: 1144 | Train Loss: 0.5106662 Vali Loss: 0.5065062 Test Loss: 0.2292490
Validation loss decreased (0.510986 --> 0.506506).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5136520
	speed: 0.0186s/iter; left time: 83.4130s
	iters: 200, epoch: 7 | loss: 0.4547596
	speed: 0.0186s/iter; left time: 81.4151s
	iters: 300, epoch: 7 | loss: 0.3721299
	speed: 0.0190s/iter; left time: 81.2685s
	iters: 400, epoch: 7 | loss: 0.8334449
	speed: 0.0200s/iter; left time: 83.3587s
	iters: 500, epoch: 7 | loss: 0.4221306
	speed: 0.0205s/iter; left time: 83.7413s
	iters: 600, epoch: 7 | loss: 0.4485240
	speed: 0.0209s/iter; left time: 83.1834s
	iters: 700, epoch: 7 | loss: 0.4649373
	speed: 0.0212s/iter; left time: 82.1486s
	iters: 800, epoch: 7 | loss: 0.3819883
	speed: 0.0214s/iter; left time: 80.8252s
	iters: 900, epoch: 7 | loss: 0.5886626
	speed: 0.0216s/iter; left time: 79.2686s
	iters: 1000, epoch: 7 | loss: 0.2834488
	speed: 0.0217s/iter; left time: 77.5675s
	iters: 1100, epoch: 7 | loss: 0.3373049
	speed: 0.0218s/iter; left time: 75.7734s
Epoch: 7 cost time: 25.046934604644775
Epoch: 7, Steps: 1144 | Train Loss: 0.5088267 Vali Loss: 0.5080736 Test Loss: 0.2300340
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3473585
	speed: 0.0183s/iter; left time: 61.0940s
	iters: 200, epoch: 8 | loss: 0.4753395
	speed: 0.0182s/iter; left time: 58.7949s
	iters: 300, epoch: 8 | loss: 0.4871716
	speed: 0.0186s/iter; left time: 58.2589s
	iters: 400, epoch: 8 | loss: 0.4956238
	speed: 0.0197s/iter; left time: 59.6326s
	iters: 500, epoch: 8 | loss: 0.4749276
	speed: 0.0203s/iter; left time: 59.5344s
	iters: 600, epoch: 8 | loss: 0.4124794
	speed: 0.0208s/iter; left time: 58.8424s
	iters: 700, epoch: 8 | loss: 0.7734010
	speed: 0.0211s/iter; left time: 57.5812s
	iters: 800, epoch: 8 | loss: 0.4593560
	speed: 0.0213s/iter; left time: 56.0537s
	iters: 900, epoch: 8 | loss: 0.3569467
	speed: 0.0215s/iter; left time: 54.3631s
	iters: 1000, epoch: 8 | loss: 0.3341364
	speed: 0.0216s/iter; left time: 52.5563s
	iters: 1100, epoch: 8 | loss: 0.8475732
	speed: 0.0217s/iter; left time: 50.6570s
Epoch: 8 cost time: 24.967761278152466
Epoch: 8, Steps: 1144 | Train Loss: 0.5080688 Vali Loss: 0.5085793 Test Loss: 0.2304065
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4828337
	speed: 0.0190s/iter; left time: 41.5996s
	iters: 200, epoch: 9 | loss: 0.6285475
	speed: 0.0183s/iter; left time: 38.2558s
	iters: 300, epoch: 9 | loss: 0.9393346
	speed: 0.0187s/iter; left time: 37.1252s
	iters: 400, epoch: 9 | loss: 0.5539142
	speed: 0.0197s/iter; left time: 37.1654s
	iters: 500, epoch: 9 | loss: 0.3864316
	speed: 0.0203s/iter; left time: 36.3328s
	iters: 600, epoch: 9 | loss: 0.3716260
	speed: 0.0208s/iter; left time: 35.0623s
	iters: 700, epoch: 9 | loss: 0.4977002
	speed: 0.0211s/iter; left time: 33.4551s
	iters: 800, epoch: 9 | loss: 0.4252355
	speed: 0.0213s/iter; left time: 31.6794s
	iters: 900, epoch: 9 | loss: 0.4859723
	speed: 0.0215s/iter; left time: 29.7980s
	iters: 1000, epoch: 9 | loss: 0.3502714
	speed: 0.0216s/iter; left time: 27.8299s
	iters: 1100, epoch: 9 | loss: 0.3357353
	speed: 0.0217s/iter; left time: 25.8040s
Epoch: 9 cost time: 24.946629524230957
Epoch: 9, Steps: 1144 | Train Loss: 0.5075698 Vali Loss: 0.5086868 Test Loss: 0.2301106
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.4365991
	speed: 0.0142s/iter; left time: 14.8433s
	iters: 200, epoch: 10 | loss: 0.3995352
	speed: 0.0128s/iter; left time: 12.1311s
	iters: 300, epoch: 10 | loss: 0.4955551
	speed: 0.0132s/iter; left time: 11.1313s
	iters: 400, epoch: 10 | loss: 0.8048195
	speed: 0.0138s/iter; left time: 10.2914s
	iters: 500, epoch: 10 | loss: 0.3368392
	speed: 0.0149s/iter; left time: 9.5876s
	iters: 600, epoch: 10 | loss: 0.4755692
	speed: 0.0152s/iter; left time: 8.2668s
	iters: 700, epoch: 10 | loss: 0.3756965
	speed: 0.0157s/iter; left time: 6.9693s
	iters: 800, epoch: 10 | loss: 0.7990422
	speed: 0.0166s/iter; left time: 5.7121s
	iters: 900, epoch: 10 | loss: 0.4230067
	speed: 0.0173s/iter; left time: 4.2272s
	iters: 1000, epoch: 10 | loss: 0.9400831
	speed: 0.0178s/iter; left time: 2.5830s
	iters: 1100, epoch: 10 | loss: 0.3338242
	speed: 0.0183s/iter; left time: 0.8223s
Epoch: 10 cost time: 21.23287081718445
Epoch: 10, Steps: 1144 | Train Loss: 0.5074724 Vali Loss: 0.5079165 Test Loss: 0.2301752
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.2292490154504776, mae:0.26258283853530884
Use GPU: cuda:0
no_skip True
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.4893083
	speed: 0.0220s/iter; left time: 249.9722s
	iters: 200, epoch: 1 | loss: 0.5393617
	speed: 0.0219s/iter; left time: 246.1095s
	iters: 300, epoch: 1 | loss: 0.5107931
	speed: 0.0223s/iter; left time: 248.4974s
	iters: 400, epoch: 1 | loss: 0.6194210
	speed: 0.0225s/iter; left time: 248.8060s
	iters: 500, epoch: 1 | loss: 0.4519182
	speed: 0.0227s/iter; left time: 247.9491s
	iters: 600, epoch: 1 | loss: 0.4487769
	speed: 0.0227s/iter; left time: 246.4517s
	iters: 700, epoch: 1 | loss: 0.4501898
	speed: 0.0228s/iter; left time: 244.9428s
	iters: 800, epoch: 1 | loss: 0.6142831
	speed: 0.0229s/iter; left time: 243.2867s
	iters: 900, epoch: 1 | loss: 0.5647106
	speed: 0.0229s/iter; left time: 241.4525s
	iters: 1000, epoch: 1 | loss: 0.8187562
	speed: 0.0229s/iter; left time: 239.5092s
	iters: 1100, epoch: 1 | loss: 0.4197988
	speed: 0.0229s/iter; left time: 237.3053s
Epoch: 1 cost time: 26.17093253135681
Epoch: 1, Steps: 1144 | Train Loss: 0.6001705 Vali Loss: 0.5590359 Test Loss: 0.2412517
Validation loss decreased (inf --> 0.559036).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4043414
	speed: 0.0221s/iter; left time: 224.9804s
	iters: 200, epoch: 2 | loss: 0.4946779
	speed: 0.0221s/iter; left time: 223.5090s
	iters: 300, epoch: 2 | loss: 0.3681855
	speed: 0.0224s/iter; left time: 223.5515s
	iters: 400, epoch: 2 | loss: 0.4398431
	speed: 0.0225s/iter; left time: 222.4293s
	iters: 500, epoch: 2 | loss: 0.5175112
	speed: 0.0226s/iter; left time: 220.9318s
	iters: 600, epoch: 2 | loss: 0.4284448
	speed: 0.0226s/iter; left time: 219.1008s
	iters: 700, epoch: 2 | loss: 0.4231657
	speed: 0.0226s/iter; left time: 217.1465s
	iters: 800, epoch: 2 | loss: 0.5330056
	speed: 0.0227s/iter; left time: 215.1566s
	iters: 900, epoch: 2 | loss: 0.5882035
	speed: 0.0227s/iter; left time: 213.0615s
	iters: 1000, epoch: 2 | loss: 1.0274932
	speed: 0.0227s/iter; left time: 210.9220s
	iters: 1100, epoch: 2 | loss: 0.4634871
	speed: 0.0227s/iter; left time: 208.3451s
Epoch: 2 cost time: 25.870967864990234
Epoch: 2, Steps: 1144 | Train Loss: 0.5527683 Vali Loss: 0.5517057 Test Loss: 0.2407980
Validation loss decreased (0.559036 --> 0.551706).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4171486
	speed: 0.0215s/iter; left time: 194.4064s
	iters: 200, epoch: 3 | loss: 0.8318039
	speed: 0.0201s/iter; left time: 179.6169s
	iters: 300, epoch: 3 | loss: 0.4166567
	speed: 0.0183s/iter; left time: 161.6202s
	iters: 400, epoch: 3 | loss: 0.4744160
	speed: 0.0176s/iter; left time: 153.6727s
	iters: 500, epoch: 3 | loss: 0.3465674
	speed: 0.0176s/iter; left time: 151.9094s
	iters: 600, epoch: 3 | loss: 0.5561281
	speed: 0.0176s/iter; left time: 150.1539s
	iters: 700, epoch: 3 | loss: 0.9171858
	speed: 0.0175s/iter; left time: 147.5738s
	iters: 800, epoch: 3 | loss: 0.4820656
	speed: 0.0173s/iter; left time: 144.9002s
	iters: 900, epoch: 3 | loss: 0.4467184
	speed: 0.0180s/iter; left time: 148.4377s
	iters: 1000, epoch: 3 | loss: 0.5321451
	speed: 0.0185s/iter; left time: 150.7687s
	iters: 1100, epoch: 3 | loss: 0.9185811
	speed: 0.0188s/iter; left time: 151.0696s
Epoch: 3 cost time: 21.6482412815094
Epoch: 3, Steps: 1144 | Train Loss: 0.5314694 Vali Loss: 0.5223103 Test Loss: 0.2332656
Validation loss decreased (0.551706 --> 0.522310).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4430716
	speed: 0.0229s/iter; left time: 180.8209s
	iters: 200, epoch: 4 | loss: 0.3628020
	speed: 0.0211s/iter; left time: 164.8827s
	iters: 300, epoch: 4 | loss: 0.4272958
	speed: 0.0207s/iter; left time: 159.2021s
	iters: 400, epoch: 4 | loss: 0.3682354
	speed: 0.0209s/iter; left time: 158.8576s
	iters: 500, epoch: 4 | loss: 0.4347686
	speed: 0.0213s/iter; left time: 159.7169s
	iters: 600, epoch: 4 | loss: 0.8456713
	speed: 0.0215s/iter; left time: 159.4983s
	iters: 700, epoch: 4 | loss: 0.5251561
	speed: 0.0217s/iter; left time: 158.6783s
	iters: 800, epoch: 4 | loss: 0.4305422
	speed: 0.0218s/iter; left time: 157.5139s
	iters: 900, epoch: 4 | loss: 0.4814983
	speed: 0.0220s/iter; left time: 156.0889s
	iters: 1000, epoch: 4 | loss: 0.4763145
	speed: 0.0220s/iter; left time: 154.5077s
	iters: 1100, epoch: 4 | loss: 0.4166051
	speed: 0.0219s/iter; left time: 151.5377s
Epoch: 4 cost time: 25.08551812171936
Epoch: 4, Steps: 1144 | Train Loss: 0.5195051 Vali Loss: 0.5181372 Test Loss: 0.2325839
Validation loss decreased (0.522310 --> 0.518137).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5312983
	speed: 0.0183s/iter; left time: 123.9925s
	iters: 200, epoch: 5 | loss: 0.3729529
	speed: 0.0168s/iter; left time: 111.8358s
	iters: 300, epoch: 5 | loss: 0.3764222
	speed: 0.0164s/iter; left time: 107.6668s
	iters: 400, epoch: 5 | loss: 0.3851617
	speed: 0.0165s/iter; left time: 106.5821s
	iters: 500, epoch: 5 | loss: 0.4039931
	speed: 0.0168s/iter; left time: 106.9461s
	iters: 600, epoch: 5 | loss: 0.4505804
	speed: 0.0176s/iter; left time: 110.5382s
	iters: 700, epoch: 5 | loss: 0.8218337
	speed: 0.0188s/iter; left time: 115.9165s
	iters: 800, epoch: 5 | loss: 0.4359081
	speed: 0.0193s/iter; left time: 117.1758s
	iters: 900, epoch: 5 | loss: 0.4421900
	speed: 0.0197s/iter; left time: 117.6163s
	iters: 1000, epoch: 5 | loss: 0.3639280
	speed: 0.0200s/iter; left time: 117.5370s
	iters: 1100, epoch: 5 | loss: 0.6323063
	speed: 0.0203s/iter; left time: 117.0291s
Epoch: 5 cost time: 23.466398000717163
Epoch: 5, Steps: 1144 | Train Loss: 0.5130056 Vali Loss: 0.5120186 Test Loss: 0.2312002
Validation loss decreased (0.518137 --> 0.512019).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4489115
	speed: 0.0217s/iter; left time: 122.2019s
	iters: 200, epoch: 6 | loss: 0.3471837
	speed: 0.0208s/iter; left time: 114.9653s
	iters: 300, epoch: 6 | loss: 0.4750149
	speed: 0.0203s/iter; left time: 109.9579s
	iters: 400, epoch: 6 | loss: 0.3658464
	speed: 0.0202s/iter; left time: 107.2389s
	iters: 500, epoch: 6 | loss: 0.5701728
	speed: 0.0201s/iter; left time: 105.0425s
	iters: 600, epoch: 6 | loss: 0.3451243
	speed: 0.0195s/iter; left time: 100.0341s
	iters: 700, epoch: 6 | loss: 0.4432229
	speed: 0.0193s/iter; left time: 97.0808s
	iters: 800, epoch: 6 | loss: 0.3860707
	speed: 0.0191s/iter; left time: 93.9388s
	iters: 900, epoch: 6 | loss: 0.3884025
	speed: 0.0189s/iter; left time: 91.2540s
	iters: 1000, epoch: 6 | loss: 0.4135653
	speed: 0.0188s/iter; left time: 88.7545s
	iters: 1100, epoch: 6 | loss: 0.3698798
	speed: 0.0189s/iter; left time: 87.2607s
Epoch: 6 cost time: 21.905539989471436
Epoch: 6, Steps: 1144 | Train Loss: 0.5098610 Vali Loss: 0.5100291 Test Loss: 0.2297083
Validation loss decreased (0.512019 --> 0.510029).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4982413
	speed: 0.0220s/iter; left time: 98.7106s
	iters: 200, epoch: 7 | loss: 0.3429027
	speed: 0.0209s/iter; left time: 91.5728s
	iters: 300, epoch: 7 | loss: 0.4804602
	speed: 0.0205s/iter; left time: 87.7475s
	iters: 400, epoch: 7 | loss: 0.4714762
	speed: 0.0203s/iter; left time: 84.7153s
	iters: 500, epoch: 7 | loss: 0.3344907
	speed: 0.0202s/iter; left time: 82.5592s
	iters: 600, epoch: 7 | loss: 0.4621499
	speed: 0.0204s/iter; left time: 81.0591s
	iters: 700, epoch: 7 | loss: 0.7757147
	speed: 0.0207s/iter; left time: 80.4146s
	iters: 800, epoch: 7 | loss: 0.6056387
	speed: 0.0210s/iter; left time: 79.3587s
	iters: 900, epoch: 7 | loss: 0.8252574
	speed: 0.0212s/iter; left time: 78.0482s
	iters: 1000, epoch: 7 | loss: 0.9882396
	speed: 0.0214s/iter; left time: 76.5228s
	iters: 1100, epoch: 7 | loss: 0.9053218
	speed: 0.0215s/iter; left time: 74.8588s
Epoch: 7 cost time: 24.76964545249939
Epoch: 7, Steps: 1144 | Train Loss: 0.5079684 Vali Loss: 0.5117478 Test Loss: 0.2305882
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.5368918
	speed: 0.0218s/iter; left time: 72.7661s
	iters: 200, epoch: 8 | loss: 0.4980515
	speed: 0.0208s/iter; left time: 67.3922s
	iters: 300, epoch: 8 | loss: 0.4857208
	speed: 0.0199s/iter; left time: 62.2136s
	iters: 400, epoch: 8 | loss: 0.5114294
	speed: 0.0198s/iter; left time: 60.1750s
	iters: 500, epoch: 8 | loss: 0.5016012
	speed: 0.0199s/iter; left time: 58.2934s
	iters: 600, epoch: 8 | loss: 0.4206238
	speed: 0.0201s/iter; left time: 57.0692s
	iters: 700, epoch: 8 | loss: 0.3288245
	speed: 0.0206s/iter; left time: 56.1936s
	iters: 800, epoch: 8 | loss: 0.3816277
	speed: 0.0209s/iter; left time: 55.0390s
	iters: 900, epoch: 8 | loss: 0.4036653
	speed: 0.0212s/iter; left time: 53.6071s
	iters: 1000, epoch: 8 | loss: 0.5334001
	speed: 0.0213s/iter; left time: 51.9385s
	iters: 1100, epoch: 8 | loss: 0.4077057
	speed: 0.0215s/iter; left time: 50.2025s
Epoch: 8 cost time: 24.747287273406982
Epoch: 8, Steps: 1144 | Train Loss: 0.5070644 Vali Loss: 0.5122359 Test Loss: 0.2306370
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4025266
	speed: 0.0217s/iter; left time: 47.4217s
	iters: 200, epoch: 9 | loss: 0.5081783
	speed: 0.0207s/iter; left time: 43.2247s
	iters: 300, epoch: 9 | loss: 0.5448357
	speed: 0.0195s/iter; left time: 38.6960s
	iters: 400, epoch: 9 | loss: 0.3285735
	speed: 0.0195s/iter; left time: 36.8629s
	iters: 500, epoch: 9 | loss: 0.3970029
	speed: 0.0196s/iter; left time: 35.1397s
	iters: 600, epoch: 9 | loss: 0.4361653
	speed: 0.0200s/iter; left time: 33.8346s
	iters: 700, epoch: 9 | loss: 0.3986519
	speed: 0.0204s/iter; left time: 32.4810s
	iters: 800, epoch: 9 | loss: 0.4375782
	speed: 0.0208s/iter; left time: 30.8993s
	iters: 900, epoch: 9 | loss: 0.4486280
	speed: 0.0210s/iter; left time: 29.1944s
	iters: 1000, epoch: 9 | loss: 0.4323602
	speed: 0.0209s/iter; left time: 26.9054s
	iters: 1100, epoch: 9 | loss: 0.3648845
	speed: 0.0206s/iter; left time: 24.4843s
Epoch: 9 cost time: 23.54619312286377
Epoch: 9, Steps: 1144 | Train Loss: 0.5062985 Vali Loss: 0.5116938 Test Loss: 0.2303599
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.7968002
	speed: 0.0216s/iter; left time: 22.6038s
	iters: 200, epoch: 10 | loss: 0.3833478
	speed: 0.0198s/iter; left time: 18.7514s
	iters: 300, epoch: 10 | loss: 0.8531178
	speed: 0.0190s/iter; left time: 16.0622s
	iters: 400, epoch: 10 | loss: 0.4540461
	speed: 0.0193s/iter; left time: 14.3625s
	iters: 500, epoch: 10 | loss: 0.3359268
	speed: 0.0196s/iter; left time: 12.6247s
	iters: 600, epoch: 10 | loss: 0.3971606
	speed: 0.0201s/iter; left time: 10.9711s
	iters: 700, epoch: 10 | loss: 0.4415899
	speed: 0.0205s/iter; left time: 9.1357s
	iters: 800, epoch: 10 | loss: 0.4211525
	speed: 0.0208s/iter; left time: 7.1849s
	iters: 900, epoch: 10 | loss: 0.3993590
	speed: 0.0211s/iter; left time: 5.1588s
	iters: 1000, epoch: 10 | loss: 0.3836656
	speed: 0.0212s/iter; left time: 3.0802s
	iters: 1100, epoch: 10 | loss: 0.7818550
	speed: 0.0214s/iter; left time: 0.9627s
Epoch: 10 cost time: 24.662545919418335
Epoch: 10, Steps: 1144 | Train Loss: 0.5061449 Vali Loss: 0.5102912 Test Loss: 0.2299917
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.22970816493034363, mae:0.2625144124031067
Seed: 456
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_336      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip True
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.5967330
	speed: 0.0369s/iter; left time: 417.4077s
	iters: 200, epoch: 1 | loss: 0.9471087
	speed: 0.0300s/iter; left time: 335.8094s
	iters: 300, epoch: 1 | loss: 0.5511591
	speed: 0.0278s/iter; left time: 308.4411s
	iters: 400, epoch: 1 | loss: 0.4367000
	speed: 0.0266s/iter; left time: 292.9458s
	iters: 500, epoch: 1 | loss: 0.5225707
	speed: 0.0259s/iter; left time: 282.7440s
	iters: 600, epoch: 1 | loss: 0.5324643
	speed: 0.0255s/iter; left time: 275.0649s
	iters: 700, epoch: 1 | loss: 0.5959488
	speed: 0.0250s/iter; left time: 267.5148s
	iters: 800, epoch: 1 | loss: 0.5428525
	speed: 0.0244s/iter; left time: 258.2061s
	iters: 900, epoch: 1 | loss: 0.6455225
	speed: 0.0239s/iter; left time: 251.0614s
	iters: 1000, epoch: 1 | loss: 0.5053662
	speed: 0.0236s/iter; left time: 245.4249s
	iters: 1100, epoch: 1 | loss: 0.6108235
	speed: 0.0235s/iter; left time: 242.5435s
Epoch: 1 cost time: 26.91426992416382
Epoch: 1, Steps: 1140 | Train Loss: 0.6708589 Vali Loss: 0.6699995 Test Loss: 0.2967401
Validation loss decreased (inf --> 0.670000).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8865898
	speed: 0.0245s/iter; left time: 249.1622s
	iters: 200, epoch: 2 | loss: 0.8381243
	speed: 0.0235s/iter; left time: 236.2155s
	iters: 300, epoch: 2 | loss: 0.7956156
	speed: 0.0216s/iter; left time: 215.3962s
	iters: 400, epoch: 2 | loss: 0.5564404
	speed: 0.0207s/iter; left time: 203.7960s
	iters: 500, epoch: 2 | loss: 0.5630530
	speed: 0.0202s/iter; left time: 197.5799s
	iters: 600, epoch: 2 | loss: 0.5333329
	speed: 0.0200s/iter; left time: 192.8263s
	iters: 700, epoch: 2 | loss: 0.4911619
	speed: 0.0198s/iter; left time: 189.2399s
	iters: 800, epoch: 2 | loss: 0.4218502
	speed: 0.0198s/iter; left time: 187.3394s
	iters: 900, epoch: 2 | loss: 0.4699625
	speed: 0.0199s/iter; left time: 185.9673s
	iters: 1000, epoch: 2 | loss: 0.9215747
	speed: 0.0201s/iter; left time: 186.1686s
	iters: 1100, epoch: 2 | loss: 0.5697405
	speed: 0.0204s/iter; left time: 186.6020s
Epoch: 2 cost time: 23.405333995819092
Epoch: 2, Steps: 1140 | Train Loss: 0.6246167 Vali Loss: 0.6304119 Test Loss: 0.2897258
Validation loss decreased (0.670000 --> 0.630412).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5224004
	speed: 0.0247s/iter; left time: 222.7557s
	iters: 200, epoch: 3 | loss: 0.5658892
	speed: 0.0239s/iter; left time: 212.8656s
	iters: 300, epoch: 3 | loss: 0.5066511
	speed: 0.0236s/iter; left time: 208.6163s
	iters: 400, epoch: 3 | loss: 0.5258747
	speed: 0.0235s/iter; left time: 204.8865s
	iters: 500, epoch: 3 | loss: 0.5927819
	speed: 0.0234s/iter; left time: 201.8209s
	iters: 600, epoch: 3 | loss: 0.5715500
	speed: 0.0232s/iter; left time: 197.6331s
	iters: 700, epoch: 3 | loss: 0.4849578
	speed: 0.0227s/iter; left time: 191.3164s
	iters: 800, epoch: 3 | loss: 0.4545502
	speed: 0.0224s/iter; left time: 186.4962s
	iters: 900, epoch: 3 | loss: 0.4750587
	speed: 0.0222s/iter; left time: 182.5447s
	iters: 1000, epoch: 3 | loss: 0.5127308
	speed: 0.0223s/iter; left time: 180.9929s
	iters: 1100, epoch: 3 | loss: 0.6522116
	speed: 0.0224s/iter; left time: 179.2845s
Epoch: 3 cost time: 25.63190007209778
Epoch: 3, Steps: 1140 | Train Loss: 0.6034969 Vali Loss: 0.6257679 Test Loss: 0.2872986
Validation loss decreased (0.630412 --> 0.625768).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4632254
	speed: 0.0242s/iter; left time: 190.8997s
	iters: 200, epoch: 4 | loss: 0.5494059
	speed: 0.0237s/iter; left time: 184.1825s
	iters: 300, epoch: 4 | loss: 0.5125211
	speed: 0.0235s/iter; left time: 180.2024s
	iters: 400, epoch: 4 | loss: 0.8186802
	speed: 0.0234s/iter; left time: 177.1522s
	iters: 500, epoch: 4 | loss: 0.4948602
	speed: 0.0233s/iter; left time: 174.3323s
	iters: 600, epoch: 4 | loss: 0.5865756
	speed: 0.0229s/iter; left time: 169.0837s
	iters: 700, epoch: 4 | loss: 0.7697446
	speed: 0.0224s/iter; left time: 163.4271s
	iters: 800, epoch: 4 | loss: 0.5478498
	speed: 0.0222s/iter; left time: 159.0995s
	iters: 900, epoch: 4 | loss: 0.4799018
	speed: 0.0219s/iter; left time: 154.9906s
	iters: 1000, epoch: 4 | loss: 0.8179504
	speed: 0.0217s/iter; left time: 151.5189s
	iters: 1100, epoch: 4 | loss: 0.4761476
	speed: 0.0216s/iter; left time: 148.5407s
Epoch: 4 cost time: 24.75985026359558
Epoch: 4, Steps: 1140 | Train Loss: 0.5941486 Vali Loss: 0.6079384 Test Loss: 0.2842966
Validation loss decreased (0.625768 --> 0.607938).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 1.4948661
	speed: 0.0254s/iter; left time: 171.2331s
	iters: 200, epoch: 5 | loss: 0.4875031
	speed: 0.0242s/iter; left time: 160.7880s
	iters: 300, epoch: 5 | loss: 0.4698553
	speed: 0.0238s/iter; left time: 155.7607s
	iters: 400, epoch: 5 | loss: 0.4517200
	speed: 0.0236s/iter; left time: 152.1640s
	iters: 500, epoch: 5 | loss: 0.4795108
	speed: 0.0231s/iter; left time: 146.2888s
	iters: 600, epoch: 5 | loss: 0.8073906
	speed: 0.0223s/iter; left time: 139.2403s
	iters: 700, epoch: 5 | loss: 0.5161653
	speed: 0.0216s/iter; left time: 132.9257s
	iters: 800, epoch: 5 | loss: 0.4008520
	speed: 0.0209s/iter; left time: 125.9814s
	iters: 900, epoch: 5 | loss: 0.5402393
	speed: 0.0201s/iter; left time: 119.4695s
	iters: 1000, epoch: 5 | loss: 0.5654904
	speed: 0.0200s/iter; left time: 117.0895s
	iters: 1100, epoch: 5 | loss: 0.4387157
	speed: 0.0202s/iter; left time: 115.7241s
Epoch: 5 cost time: 23.194624185562134
Epoch: 5, Steps: 1140 | Train Loss: 0.5890342 Vali Loss: 0.6031608 Test Loss: 0.2826058
Validation loss decreased (0.607938 --> 0.603161).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4665028
	speed: 0.0256s/iter; left time: 143.4805s
	iters: 200, epoch: 6 | loss: 0.8016341
	speed: 0.0243s/iter; left time: 133.7278s
	iters: 300, epoch: 6 | loss: 0.6864324
	speed: 0.0239s/iter; left time: 128.9550s
	iters: 400, epoch: 6 | loss: 0.5490307
	speed: 0.0237s/iter; left time: 125.4363s
	iters: 500, epoch: 6 | loss: 0.5150087
	speed: 0.0235s/iter; left time: 122.4074s
	iters: 600, epoch: 6 | loss: 0.8431020
	speed: 0.0235s/iter; left time: 119.6571s
	iters: 700, epoch: 6 | loss: 0.5176311
	speed: 0.0234s/iter; left time: 117.0042s
	iters: 800, epoch: 6 | loss: 0.5344988
	speed: 0.0230s/iter; left time: 112.6573s
	iters: 900, epoch: 6 | loss: 0.4721499
	speed: 0.0226s/iter; left time: 108.6421s
	iters: 1000, epoch: 6 | loss: 0.6041024
	speed: 0.0224s/iter; left time: 105.1175s
	iters: 1100, epoch: 6 | loss: 0.4127786
	speed: 0.0224s/iter; left time: 102.8869s
Epoch: 6 cost time: 25.578752756118774
Epoch: 6, Steps: 1140 | Train Loss: 0.5855438 Vali Loss: 0.6039554 Test Loss: 0.2826474
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.9402201
	speed: 0.0252s/iter; left time: 112.4470s
	iters: 200, epoch: 7 | loss: 0.4375354
	speed: 0.0241s/iter; left time: 105.0801s
	iters: 300, epoch: 7 | loss: 0.5564938
	speed: 0.0237s/iter; left time: 101.1569s
	iters: 400, epoch: 7 | loss: 0.4922134
	speed: 0.0236s/iter; left time: 98.0500s
	iters: 500, epoch: 7 | loss: 0.4920241
	speed: 0.0235s/iter; left time: 95.2625s
	iters: 600, epoch: 7 | loss: 0.5310112
	speed: 0.0234s/iter; left time: 92.6209s
	iters: 700, epoch: 7 | loss: 0.4775329
	speed: 0.0233s/iter; left time: 89.8874s
	iters: 800, epoch: 7 | loss: 0.5096731
	speed: 0.0229s/iter; left time: 85.9827s
	iters: 900, epoch: 7 | loss: 0.4395701
	speed: 0.0226s/iter; left time: 82.5573s
	iters: 1000, epoch: 7 | loss: 0.5047806
	speed: 0.0224s/iter; left time: 79.6809s
	iters: 1100, epoch: 7 | loss: 0.4364057
	speed: 0.0224s/iter; left time: 77.6436s
Epoch: 7 cost time: 25.64343237876892
Epoch: 7, Steps: 1140 | Train Loss: 0.5842013 Vali Loss: 0.6030747 Test Loss: 0.2828894
Validation loss decreased (0.603161 --> 0.603075).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 1.2342460
	speed: 0.0249s/iter; left time: 82.6563s
	iters: 200, epoch: 8 | loss: 0.6419553
	speed: 0.0240s/iter; left time: 77.2205s
	iters: 300, epoch: 8 | loss: 0.5602390
	speed: 0.0236s/iter; left time: 73.7744s
	iters: 400, epoch: 8 | loss: 0.5273377
	speed: 0.0235s/iter; left time: 70.9369s
	iters: 500, epoch: 8 | loss: 0.5512041
	speed: 0.0234s/iter; left time: 68.3374s
	iters: 600, epoch: 8 | loss: 0.4341685
	speed: 0.0233s/iter; left time: 65.8170s
	iters: 700, epoch: 8 | loss: 0.4744791
	speed: 0.0230s/iter; left time: 62.4493s
	iters: 800, epoch: 8 | loss: 0.7095090
	speed: 0.0220s/iter; left time: 57.6942s
	iters: 900, epoch: 8 | loss: 0.5579139
	speed: 0.0212s/iter; left time: 53.3954s
	iters: 1000, epoch: 8 | loss: 0.5179014
	speed: 0.0206s/iter; left time: 49.9007s
	iters: 1100, epoch: 8 | loss: 0.3598753
	speed: 0.0204s/iter; left time: 47.4066s
Epoch: 8 cost time: 23.234654188156128
Epoch: 8, Steps: 1140 | Train Loss: 0.5829286 Vali Loss: 0.6045336 Test Loss: 0.2827459
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4547881
	speed: 0.0201s/iter; left time: 43.8791s
	iters: 200, epoch: 9 | loss: 0.4499866
	speed: 0.0198s/iter; left time: 41.1680s
	iters: 300, epoch: 9 | loss: 0.6952755
	speed: 0.0206s/iter; left time: 40.7811s
	iters: 400, epoch: 9 | loss: 0.9351878
	speed: 0.0212s/iter; left time: 39.8483s
	iters: 500, epoch: 9 | loss: 0.5501591
	speed: 0.0215s/iter; left time: 38.3735s
	iters: 600, epoch: 9 | loss: 0.5233572
	speed: 0.0215s/iter; left time: 36.1171s
	iters: 700, epoch: 9 | loss: 0.5529812
	speed: 0.0212s/iter; left time: 33.5882s
	iters: 800, epoch: 9 | loss: 0.5456471
	speed: 0.0211s/iter; left time: 31.2656s
	iters: 900, epoch: 9 | loss: 0.4431045
	speed: 0.0211s/iter; left time: 29.1698s
	iters: 1000, epoch: 9 | loss: 0.5007280
	speed: 0.0213s/iter; left time: 27.2958s
	iters: 1100, epoch: 9 | loss: 0.4743654
	speed: 0.0215s/iter; left time: 25.3472s
Epoch: 9 cost time: 24.673985958099365
Epoch: 9, Steps: 1140 | Train Loss: 0.5826754 Vali Loss: 0.6017430 Test Loss: 0.2824982
Validation loss decreased (0.603075 --> 0.601743).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.8223830
	speed: 0.0228s/iter; left time: 23.7777s
	iters: 200, epoch: 10 | loss: 0.4511865
	speed: 0.0212s/iter; left time: 19.9337s
	iters: 300, epoch: 10 | loss: 0.5952591
	speed: 0.0218s/iter; left time: 18.3182s
	iters: 400, epoch: 10 | loss: 0.3925080
	speed: 0.0221s/iter; left time: 16.3596s
	iters: 500, epoch: 10 | loss: 0.6431490
	speed: 0.0223s/iter; left time: 14.2671s
	iters: 600, epoch: 10 | loss: 0.4559309
	speed: 0.0219s/iter; left time: 11.8554s
	iters: 700, epoch: 10 | loss: 0.5087839
	speed: 0.0216s/iter; left time: 9.5381s
	iters: 800, epoch: 10 | loss: 0.5190413
	speed: 0.0214s/iter; left time: 7.3022s
	iters: 900, epoch: 10 | loss: 0.5980576
	speed: 0.0215s/iter; left time: 5.1882s
	iters: 1000, epoch: 10 | loss: 0.5593243
	speed: 0.0217s/iter; left time: 3.0567s
	iters: 1100, epoch: 10 | loss: 0.4681070
	speed: 0.0218s/iter; left time: 0.8937s
Epoch: 10 cost time: 25.006434679031372
Epoch: 10, Steps: 1140 | Train Loss: 0.5825288 Vali Loss: 0.6015112 Test Loss: 0.2825140
Validation loss decreased (0.601743 --> 0.601511).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.2825140953063965, mae:0.30016350746154785
Use GPU: cuda:0
no_skip True
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.6043208
	speed: 0.0252s/iter; left time: 285.2911s
	iters: 200, epoch: 1 | loss: 0.5672477
	speed: 0.0241s/iter; left time: 270.3456s
	iters: 300, epoch: 1 | loss: 0.7304579
	speed: 0.0232s/iter; left time: 257.4294s
	iters: 400, epoch: 1 | loss: 0.5607733
	speed: 0.0224s/iter; left time: 245.9662s
	iters: 500, epoch: 1 | loss: 0.5504398
	speed: 0.0219s/iter; left time: 239.0986s
	iters: 600, epoch: 1 | loss: 0.6730848
	speed: 0.0218s/iter; left time: 235.6051s
	iters: 700, epoch: 1 | loss: 1.0683895
	speed: 0.0220s/iter; left time: 235.2214s
	iters: 800, epoch: 1 | loss: 0.5033309
	speed: 0.0221s/iter; left time: 234.3498s
	iters: 900, epoch: 1 | loss: 0.7981839
	speed: 0.0222s/iter; left time: 233.2125s
	iters: 1000, epoch: 1 | loss: 0.6628263
	speed: 0.0223s/iter; left time: 231.8050s
	iters: 1100, epoch: 1 | loss: 0.6011478
	speed: 0.0223s/iter; left time: 230.0410s
Epoch: 1 cost time: 25.364646434783936
Epoch: 1, Steps: 1140 | Train Loss: 0.6868283 Vali Loss: 0.6591920 Test Loss: 0.2958085
Validation loss decreased (inf --> 0.659192).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5711330
	speed: 0.0202s/iter; left time: 205.3735s
	iters: 200, epoch: 2 | loss: 0.5682174
	speed: 0.0175s/iter; left time: 176.4761s
	iters: 300, epoch: 2 | loss: 0.5497387
	speed: 0.0180s/iter; left time: 179.3228s
	iters: 400, epoch: 2 | loss: 0.5429662
	speed: 0.0185s/iter; left time: 182.8809s
	iters: 500, epoch: 2 | loss: 0.5049434
	speed: 0.0190s/iter; left time: 185.2341s
	iters: 600, epoch: 2 | loss: 1.0346613
	speed: 0.0197s/iter; left time: 190.1780s
	iters: 700, epoch: 2 | loss: 0.5386858
	speed: 0.0202s/iter; left time: 193.1259s
	iters: 800, epoch: 2 | loss: 0.8486207
	speed: 0.0206s/iter; left time: 194.6261s
	iters: 900, epoch: 2 | loss: 0.4830889
	speed: 0.0209s/iter; left time: 195.2446s
	iters: 1000, epoch: 2 | loss: 0.5865294
	speed: 0.0211s/iter; left time: 195.2437s
	iters: 1100, epoch: 2 | loss: 0.7561705
	speed: 0.0213s/iter; left time: 194.9038s
Epoch: 2 cost time: 24.24562668800354
Epoch: 2, Steps: 1140 | Train Loss: 0.6326000 Vali Loss: 0.6237442 Test Loss: 0.2900112
Validation loss decreased (0.659192 --> 0.623744).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6992794
	speed: 0.0255s/iter; left time: 230.2666s
	iters: 200, epoch: 3 | loss: 0.4386175
	speed: 0.0233s/iter; left time: 207.9701s
	iters: 300, epoch: 3 | loss: 0.4693540
	speed: 0.0222s/iter; left time: 195.7240s
	iters: 400, epoch: 3 | loss: 0.5514387
	speed: 0.0217s/iter; left time: 188.9085s
	iters: 500, epoch: 3 | loss: 0.6802353
	speed: 0.0217s/iter; left time: 187.1866s
	iters: 600, epoch: 3 | loss: 0.6912850
	speed: 0.0219s/iter; left time: 186.8564s
	iters: 700, epoch: 3 | loss: 1.1716757
	speed: 0.0221s/iter; left time: 186.0116s
	iters: 800, epoch: 3 | loss: 0.5224627
	speed: 0.0222s/iter; left time: 184.7484s
	iters: 900, epoch: 3 | loss: 0.4910089
	speed: 0.0223s/iter; left time: 183.2607s
	iters: 1000, epoch: 3 | loss: 0.5303214
	speed: 0.0224s/iter; left time: 181.6467s
	iters: 1100, epoch: 3 | loss: 0.5775002
	speed: 0.0224s/iter; left time: 179.8344s
Epoch: 3 cost time: 25.541303157806396
Epoch: 3, Steps: 1140 | Train Loss: 0.6087759 Vali Loss: 0.6249290 Test Loss: 0.2893518
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8336679
	speed: 0.0254s/iter; left time: 200.5029s
	iters: 200, epoch: 4 | loss: 0.9115840
	speed: 0.0225s/iter; left time: 174.6840s
	iters: 300, epoch: 4 | loss: 0.4477315
	speed: 0.0217s/iter; left time: 166.3141s
	iters: 400, epoch: 4 | loss: 0.4927800
	speed: 0.0212s/iter; left time: 160.6656s
	iters: 500, epoch: 4 | loss: 0.5276873
	speed: 0.0210s/iter; left time: 157.2489s
	iters: 600, epoch: 4 | loss: 0.8185649
	speed: 0.0208s/iter; left time: 153.2616s
	iters: 700, epoch: 4 | loss: 0.7087242
	speed: 0.0210s/iter; left time: 152.8356s
	iters: 800, epoch: 4 | loss: 1.0337719
	speed: 0.0212s/iter; left time: 152.5315s
	iters: 900, epoch: 4 | loss: 0.4822197
	speed: 0.0214s/iter; left time: 151.7894s
	iters: 1000, epoch: 4 | loss: 0.5634250
	speed: 0.0216s/iter; left time: 150.7196s
	iters: 1100, epoch: 4 | loss: 0.5739309
	speed: 0.0217s/iter; left time: 149.4364s
Epoch: 4 cost time: 24.839709997177124
Epoch: 4, Steps: 1140 | Train Loss: 0.5965687 Vali Loss: 0.6208202 Test Loss: 0.2885212
Validation loss decreased (0.623744 --> 0.620820).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6216205
	speed: 0.0210s/iter; left time: 141.6346s
	iters: 200, epoch: 5 | loss: 0.4165893
	speed: 0.0195s/iter; left time: 129.5312s
	iters: 300, epoch: 5 | loss: 0.7833087
	speed: 0.0186s/iter; left time: 121.6395s
	iters: 400, epoch: 5 | loss: 0.7464668
	speed: 0.0177s/iter; left time: 114.2174s
	iters: 500, epoch: 5 | loss: 0.5477173
	speed: 0.0173s/iter; left time: 109.4937s
	iters: 600, epoch: 5 | loss: 0.4983761
	speed: 0.0177s/iter; left time: 110.4534s
	iters: 700, epoch: 5 | loss: 0.4644416
	speed: 0.0184s/iter; left time: 113.0150s
	iters: 800, epoch: 5 | loss: 0.4436287
	speed: 0.0190s/iter; left time: 114.6270s
	iters: 900, epoch: 5 | loss: 0.5350396
	speed: 0.0194s/iter; left time: 115.3717s
	iters: 1000, epoch: 5 | loss: 0.4181906
	speed: 0.0198s/iter; left time: 115.5272s
	iters: 1100, epoch: 5 | loss: 0.4607733
	speed: 0.0201s/iter; left time: 115.2143s
Epoch: 5 cost time: 23.02958655357361
Epoch: 5, Steps: 1140 | Train Loss: 0.5906127 Vali Loss: 0.6093681 Test Loss: 0.2848268
Validation loss decreased (0.620820 --> 0.609368).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4177795
	speed: 0.0252s/iter; left time: 141.0349s
	iters: 200, epoch: 6 | loss: 0.4700572
	speed: 0.0241s/iter; left time: 132.4277s
	iters: 300, epoch: 6 | loss: 0.5353953
	speed: 0.0234s/iter; left time: 126.3005s
	iters: 400, epoch: 6 | loss: 0.5470155
	speed: 0.0225s/iter; left time: 119.2592s
	iters: 500, epoch: 6 | loss: 0.5025141
	speed: 0.0220s/iter; left time: 114.5847s
	iters: 600, epoch: 6 | loss: 0.5493449
	speed: 0.0218s/iter; left time: 111.0693s
	iters: 700, epoch: 6 | loss: 0.4655420
	speed: 0.0219s/iter; left time: 109.7696s
	iters: 800, epoch: 6 | loss: 0.9989794
	speed: 0.0221s/iter; left time: 108.2007s
	iters: 900, epoch: 6 | loss: 0.8094812
	speed: 0.0222s/iter; left time: 106.4660s
	iters: 1000, epoch: 6 | loss: 0.8718544
	speed: 0.0223s/iter; left time: 104.6374s
	iters: 1100, epoch: 6 | loss: 0.5554082
	speed: 0.0223s/iter; left time: 102.7047s
Epoch: 6 cost time: 25.535110235214233
Epoch: 6, Steps: 1140 | Train Loss: 0.5877236 Vali Loss: 0.6088319 Test Loss: 0.2848740
Validation loss decreased (0.609368 --> 0.608832).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.7335436
	speed: 0.0250s/iter; left time: 111.7200s
	iters: 200, epoch: 7 | loss: 0.5256886
	speed: 0.0240s/iter; left time: 104.7807s
	iters: 300, epoch: 7 | loss: 0.4427552
	speed: 0.0227s/iter; left time: 96.7638s
	iters: 400, epoch: 7 | loss: 0.4607920
	speed: 0.0220s/iter; left time: 91.5000s
	iters: 500, epoch: 7 | loss: 0.7969865
	speed: 0.0216s/iter; left time: 87.7817s
	iters: 600, epoch: 7 | loss: 0.5115702
	speed: 0.0216s/iter; left time: 85.6680s
	iters: 700, epoch: 7 | loss: 0.4653283
	speed: 0.0218s/iter; left time: 84.2868s
	iters: 800, epoch: 7 | loss: 0.4510046
	speed: 0.0220s/iter; left time: 82.7516s
	iters: 900, epoch: 7 | loss: 0.7540316
	speed: 0.0221s/iter; left time: 81.0433s
	iters: 1000, epoch: 7 | loss: 0.5795347
	speed: 0.0222s/iter; left time: 79.2263s
	iters: 1100, epoch: 7 | loss: 0.4402723
	speed: 0.0223s/iter; left time: 77.2980s
Epoch: 7 cost time: 25.581010818481445
Epoch: 7, Steps: 1140 | Train Loss: 0.5858593 Vali Loss: 0.6068802 Test Loss: 0.2840370
Validation loss decreased (0.608832 --> 0.606880).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4952646
	speed: 0.0219s/iter; left time: 72.8834s
	iters: 200, epoch: 8 | loss: 0.8610182
	speed: 0.0208s/iter; left time: 66.8497s
	iters: 300, epoch: 8 | loss: 0.5704121
	speed: 0.0194s/iter; left time: 60.6985s
	iters: 400, epoch: 8 | loss: 0.5433215
	speed: 0.0182s/iter; left time: 55.0635s
	iters: 500, epoch: 8 | loss: 0.5380663
	speed: 0.0175s/iter; left time: 51.0492s
	iters: 600, epoch: 8 | loss: 0.8179126
	speed: 0.0171s/iter; left time: 48.3153s
	iters: 700, epoch: 8 | loss: 0.6107352
	speed: 0.0173s/iter; left time: 47.1427s
	iters: 800, epoch: 8 | loss: 0.5572299
	speed: 0.0178s/iter; left time: 46.5624s
	iters: 900, epoch: 8 | loss: 0.5719082
	speed: 0.0183s/iter; left time: 46.2603s
	iters: 1000, epoch: 8 | loss: 0.5080281
	speed: 0.0188s/iter; left time: 45.5464s
	iters: 1100, epoch: 8 | loss: 0.5112525
	speed: 0.0192s/iter; left time: 44.5449s
Epoch: 8 cost time: 22.157955646514893
Epoch: 8, Steps: 1140 | Train Loss: 0.5850595 Vali Loss: 0.6094506 Test Loss: 0.2847349
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4570079
	speed: 0.0217s/iter; left time: 47.2349s
	iters: 200, epoch: 9 | loss: 0.7383780
	speed: 0.0208s/iter; left time: 43.3439s
	iters: 300, epoch: 9 | loss: 0.8893069
	speed: 0.0206s/iter; left time: 40.7829s
	iters: 400, epoch: 9 | loss: 0.5445474
	speed: 0.0204s/iter; left time: 38.3922s
	iters: 500, epoch: 9 | loss: 0.8520151
	speed: 0.0204s/iter; left time: 36.3534s
	iters: 600, epoch: 9 | loss: 0.5333698
	speed: 0.0206s/iter; left time: 34.5781s
	iters: 700, epoch: 9 | loss: 0.4389268
	speed: 0.0209s/iter; left time: 33.0653s
	iters: 800, epoch: 9 | loss: 1.0188613
	speed: 0.0212s/iter; left time: 31.3599s
	iters: 900, epoch: 9 | loss: 0.5477188
	speed: 0.0214s/iter; left time: 29.5236s
	iters: 1000, epoch: 9 | loss: 0.7917312
	speed: 0.0215s/iter; left time: 27.5916s
	iters: 1100, epoch: 9 | loss: 0.5313851
	speed: 0.0217s/iter; left time: 25.5951s
Epoch: 9 cost time: 24.891525506973267
Epoch: 9, Steps: 1140 | Train Loss: 0.5846026 Vali Loss: 0.6112097 Test Loss: 0.2846052
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.8096657
	speed: 0.0215s/iter; left time: 22.3552s
	iters: 200, epoch: 10 | loss: 0.5172377
	speed: 0.0207s/iter; left time: 19.4938s
	iters: 300, epoch: 10 | loss: 0.5074252
	speed: 0.0203s/iter; left time: 17.0327s
	iters: 400, epoch: 10 | loss: 0.5444335
	speed: 0.0201s/iter; left time: 14.9228s
	iters: 500, epoch: 10 | loss: 0.5034555
	speed: 0.0201s/iter; left time: 12.9056s
	iters: 600, epoch: 10 | loss: 0.8126528
	speed: 0.0205s/iter; left time: 11.0654s
	iters: 700, epoch: 10 | loss: 0.4857790
	speed: 0.0208s/iter; left time: 9.1808s
	iters: 800, epoch: 10 | loss: 0.5589085
	speed: 0.0211s/iter; left time: 7.1914s
	iters: 900, epoch: 10 | loss: 0.6113957
	speed: 0.0213s/iter; left time: 5.1337s
	iters: 1000, epoch: 10 | loss: 0.6091315
	speed: 0.0215s/iter; left time: 3.0276s
	iters: 1100, epoch: 10 | loss: 0.6999542
	speed: 0.0216s/iter; left time: 0.8860s
Epoch: 10 cost time: 24.811777114868164
Epoch: 10, Steps: 1140 | Train Loss: 0.5844864 Vali Loss: 0.6097137 Test Loss: 0.2845701
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.28403693437576294, mae:0.301788866519928
Use GPU: cuda:0
no_skip True
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.8204007
	speed: 0.0225s/iter; left time: 253.9345s
	iters: 200, epoch: 1 | loss: 0.8092334
	speed: 0.0213s/iter; left time: 238.9498s
	iters: 300, epoch: 1 | loss: 0.6096138
	speed: 0.0211s/iter; left time: 234.3477s
	iters: 400, epoch: 1 | loss: 0.5277046
	speed: 0.0210s/iter; left time: 231.1370s
	iters: 500, epoch: 1 | loss: 0.4871423
	speed: 0.0204s/iter; left time: 221.9530s
	iters: 600, epoch: 1 | loss: 0.8753024
	speed: 0.0199s/iter; left time: 214.8933s
	iters: 700, epoch: 1 | loss: 0.5540373
	speed: 0.0196s/iter; left time: 209.6212s
	iters: 800, epoch: 1 | loss: 0.9671994
	speed: 0.0194s/iter; left time: 205.2333s
	iters: 900, epoch: 1 | loss: 0.5171250
	speed: 0.0193s/iter; left time: 202.2877s
	iters: 1000, epoch: 1 | loss: 0.5642705
	speed: 0.0196s/iter; left time: 204.2494s
	iters: 1100, epoch: 1 | loss: 0.5656573
	speed: 0.0199s/iter; left time: 205.4722s
Epoch: 1 cost time: 22.806527614593506
Epoch: 1, Steps: 1140 | Train Loss: 0.6712521 Vali Loss: 0.6377788 Test Loss: 0.2928725
Validation loss decreased (inf --> 0.637779).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4332544
	speed: 0.0227s/iter; left time: 230.4001s
	iters: 200, epoch: 2 | loss: 0.9756856
	speed: 0.0215s/iter; left time: 215.8378s
	iters: 300, epoch: 2 | loss: 0.5149343
	speed: 0.0215s/iter; left time: 214.2361s
	iters: 400, epoch: 2 | loss: 0.5635415
	speed: 0.0219s/iter; left time: 215.8893s
	iters: 500, epoch: 2 | loss: 0.7708277
	speed: 0.0221s/iter; left time: 215.8753s
	iters: 600, epoch: 2 | loss: 0.5540242
	speed: 0.0223s/iter; left time: 215.1036s
	iters: 700, epoch: 2 | loss: 0.5575301
	speed: 0.0224s/iter; left time: 213.9568s
	iters: 800, epoch: 2 | loss: 0.5869723
	speed: 0.0225s/iter; left time: 212.4660s
	iters: 900, epoch: 2 | loss: 0.8604943
	speed: 0.0225s/iter; left time: 210.7940s
	iters: 1000, epoch: 2 | loss: 0.5436419
	speed: 0.0226s/iter; left time: 209.0399s
	iters: 1100, epoch: 2 | loss: 0.5034645
	speed: 0.0226s/iter; left time: 207.2119s
Epoch: 2 cost time: 25.761024475097656
Epoch: 2, Steps: 1140 | Train Loss: 0.6227056 Vali Loss: 0.6185661 Test Loss: 0.2898731
Validation loss decreased (0.637779 --> 0.618566).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5961552
	speed: 0.0227s/iter; left time: 205.1990s
	iters: 200, epoch: 3 | loss: 0.5060445
	speed: 0.0214s/iter; left time: 190.5089s
	iters: 300, epoch: 3 | loss: 1.0582072
	speed: 0.0208s/iter; left time: 183.8171s
	iters: 400, epoch: 3 | loss: 0.5813279
	speed: 0.0205s/iter; left time: 179.1935s
	iters: 500, epoch: 3 | loss: 0.7003771
	speed: 0.0200s/iter; left time: 172.7693s
	iters: 600, epoch: 3 | loss: 0.8448561
	speed: 0.0199s/iter; left time: 169.1629s
	iters: 700, epoch: 3 | loss: 0.7024982
	speed: 0.0196s/iter; left time: 165.1922s
	iters: 800, epoch: 3 | loss: 0.7981141
	speed: 0.0194s/iter; left time: 161.7887s
	iters: 900, epoch: 3 | loss: 0.5076144
	speed: 0.0193s/iter; left time: 158.7298s
	iters: 1000, epoch: 3 | loss: 0.8104243
	speed: 0.0192s/iter; left time: 155.9256s
	iters: 1100, epoch: 3 | loss: 0.8463774
	speed: 0.0191s/iter; left time: 153.3480s
Epoch: 3 cost time: 21.767354011535645
Epoch: 3, Steps: 1140 | Train Loss: 0.6037380 Vali Loss: 0.6064392 Test Loss: 0.2857495
Validation loss decreased (0.618566 --> 0.606439).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6196211
	speed: 0.0199s/iter; left time: 156.8104s
	iters: 200, epoch: 4 | loss: 0.6536852
	speed: 0.0190s/iter; left time: 148.0386s
	iters: 300, epoch: 4 | loss: 0.6871069
	speed: 0.0188s/iter; left time: 144.0205s
	iters: 400, epoch: 4 | loss: 0.6188122
	speed: 0.0186s/iter; left time: 141.1793s
	iters: 500, epoch: 4 | loss: 0.3899008
	speed: 0.0185s/iter; left time: 138.7186s
	iters: 600, epoch: 4 | loss: 0.4471436
	speed: 0.0185s/iter; left time: 136.4673s
	iters: 700, epoch: 4 | loss: 0.7024407
	speed: 0.0183s/iter; left time: 133.0112s
	iters: 800, epoch: 4 | loss: 0.8623450
	speed: 0.0177s/iter; left time: 127.3455s
	iters: 900, epoch: 4 | loss: 0.5041726
	speed: 0.0173s/iter; left time: 122.1758s
	iters: 1000, epoch: 4 | loss: 0.5401573
	speed: 0.0169s/iter; left time: 118.2077s
	iters: 1100, epoch: 4 | loss: 0.6470731
	speed: 0.0168s/iter; left time: 115.5038s
Epoch: 4 cost time: 19.157531261444092
Epoch: 4, Steps: 1140 | Train Loss: 0.5925297 Vali Loss: 0.5998327 Test Loss: 0.2847525
Validation loss decreased (0.606439 --> 0.599833).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5068009
	speed: 0.0199s/iter; left time: 134.3601s
	iters: 200, epoch: 5 | loss: 0.8344804
	speed: 0.0191s/iter; left time: 126.5311s
	iters: 300, epoch: 5 | loss: 0.5076251
	speed: 0.0188s/iter; left time: 122.9878s
	iters: 400, epoch: 5 | loss: 0.6614491
	speed: 0.0187s/iter; left time: 120.1499s
	iters: 500, epoch: 5 | loss: 0.4336621
	speed: 0.0186s/iter; left time: 117.6449s
	iters: 600, epoch: 5 | loss: 0.4668896
	speed: 0.0185s/iter; left time: 115.4231s
	iters: 700, epoch: 5 | loss: 0.7934276
	speed: 0.0185s/iter; left time: 113.3704s
	iters: 800, epoch: 5 | loss: 0.4071532
	speed: 0.0184s/iter; left time: 111.2304s
	iters: 900, epoch: 5 | loss: 0.5376921
	speed: 0.0184s/iter; left time: 109.2579s
	iters: 1000, epoch: 5 | loss: 0.5399483
	speed: 0.0184s/iter; left time: 107.3297s
	iters: 1100, epoch: 5 | loss: 0.5297826
	speed: 0.0183s/iter; left time: 105.1838s
Epoch: 5 cost time: 20.828579664230347
Epoch: 5, Steps: 1140 | Train Loss: 0.5874111 Vali Loss: 0.5966352 Test Loss: 0.2848752
Validation loss decreased (0.599833 --> 0.596635).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5203829
	speed: 0.0172s/iter; left time: 96.0927s
	iters: 200, epoch: 6 | loss: 0.4755133
	speed: 0.0151s/iter; left time: 83.0462s
	iters: 300, epoch: 6 | loss: 0.4588483
	speed: 0.0148s/iter; left time: 79.9505s
	iters: 400, epoch: 6 | loss: 0.9956928
	speed: 0.0144s/iter; left time: 76.2547s
	iters: 500, epoch: 6 | loss: 0.5687496
	speed: 0.0141s/iter; left time: 73.4700s
	iters: 600, epoch: 6 | loss: 0.4282663
	speed: 0.0139s/iter; left time: 71.1559s
	iters: 700, epoch: 6 | loss: 0.5377786
	speed: 0.0138s/iter; left time: 69.1305s
	iters: 800, epoch: 6 | loss: 0.7452230
	speed: 0.0137s/iter; left time: 67.3151s
	iters: 900, epoch: 6 | loss: 0.5191488
	speed: 0.0137s/iter; left time: 65.5894s
	iters: 1000, epoch: 6 | loss: 0.5984147
	speed: 0.0136s/iter; left time: 63.9241s
	iters: 1100, epoch: 6 | loss: 0.4580868
	speed: 0.0135s/iter; left time: 62.3356s
Epoch: 6 cost time: 15.486693382263184
Epoch: 6, Steps: 1140 | Train Loss: 0.5851427 Vali Loss: 0.6000862 Test Loss: 0.2851684
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5447528
	speed: 0.0144s/iter; left time: 64.2774s
	iters: 200, epoch: 7 | loss: 0.6779488
	speed: 0.0137s/iter; left time: 59.7752s
	iters: 300, epoch: 7 | loss: 1.0258963
	speed: 0.0135s/iter; left time: 57.4950s
	iters: 400, epoch: 7 | loss: 0.5028863
	speed: 0.0134s/iter; left time: 55.7446s
	iters: 500, epoch: 7 | loss: 0.4816656
	speed: 0.0133s/iter; left time: 54.1376s
	iters: 600, epoch: 7 | loss: 0.5208693
	speed: 0.0133s/iter; left time: 52.6235s
	iters: 700, epoch: 7 | loss: 0.5299865
	speed: 0.0132s/iter; left time: 51.0282s
	iters: 800, epoch: 7 | loss: 0.5645799
	speed: 0.0131s/iter; left time: 49.4184s
	iters: 900, epoch: 7 | loss: 0.4816964
	speed: 0.0128s/iter; left time: 46.8442s
	iters: 1000, epoch: 7 | loss: 0.5512852
	speed: 0.0124s/iter; left time: 44.1168s
	iters: 1100, epoch: 7 | loss: 0.5720718
	speed: 0.0122s/iter; left time: 42.0621s
Epoch: 7 cost time: 13.714275360107422
Epoch: 7, Steps: 1140 | Train Loss: 0.5829378 Vali Loss: 0.5982224 Test Loss: 0.2846397
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4926098
	speed: 0.0074s/iter; left time: 24.6805s
	iters: 200, epoch: 8 | loss: 0.8323770
	speed: 0.0066s/iter; left time: 21.2561s
	iters: 300, epoch: 8 | loss: 0.5244871
	speed: 0.0063s/iter; left time: 19.6727s
	iters: 400, epoch: 8 | loss: 0.4917285
	speed: 0.0064s/iter; left time: 19.3814s
	iters: 500, epoch: 8 | loss: 0.5707433
	speed: 0.0063s/iter; left time: 18.3639s
	iters: 600, epoch: 8 | loss: 0.7429866
	speed: 0.0062s/iter; left time: 17.5028s
	iters: 700, epoch: 8 | loss: 0.4262816
	speed: 0.0061s/iter; left time: 16.6888s
	iters: 800, epoch: 8 | loss: 0.5384946
	speed: 0.0061s/iter; left time: 16.0594s
	iters: 900, epoch: 8 | loss: 0.4355803
	speed: 0.0061s/iter; left time: 15.3395s
	iters: 1000, epoch: 8 | loss: 0.5317875
	speed: 0.0061s/iter; left time: 14.6512s
	iters: 1100, epoch: 8 | loss: 0.4388930
	speed: 0.0060s/iter; left time: 14.0255s
Epoch: 8 cost time: 7.0276994705200195
Epoch: 8, Steps: 1140 | Train Loss: 0.5820851 Vali Loss: 0.5929859 Test Loss: 0.2841644
Validation loss decreased (0.596635 --> 0.592986).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.7498397
	speed: 0.0145s/iter; left time: 31.6806s
	iters: 200, epoch: 9 | loss: 0.5156418
	speed: 0.0138s/iter; left time: 28.7487s
	iters: 300, epoch: 9 | loss: 0.4499866
	speed: 0.0136s/iter; left time: 26.8886s
	iters: 400, epoch: 9 | loss: 0.4231089
	speed: 0.0135s/iter; left time: 25.3165s
	iters: 500, epoch: 9 | loss: 0.7477621
	speed: 0.0133s/iter; left time: 23.7495s
	iters: 600, epoch: 9 | loss: 0.5195425
	speed: 0.0133s/iter; left time: 22.3214s
	iters: 700, epoch: 9 | loss: 0.7503628
	speed: 0.0132s/iter; left time: 20.9428s
	iters: 800, epoch: 9 | loss: 0.5027305
	speed: 0.0132s/iter; left time: 19.5581s
	iters: 900, epoch: 9 | loss: 0.5414794
	speed: 0.0132s/iter; left time: 18.2379s
	iters: 1000, epoch: 9 | loss: 0.5143209
	speed: 0.0132s/iter; left time: 16.8866s
	iters: 1100, epoch: 9 | loss: 0.5653988
	speed: 0.0132s/iter; left time: 15.5763s
Epoch: 9 cost time: 15.105884313583374
Epoch: 9, Steps: 1140 | Train Loss: 0.5817699 Vali Loss: 0.5924154 Test Loss: 0.2841145
Validation loss decreased (0.592986 --> 0.592415).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.6175790
	speed: 0.0149s/iter; left time: 15.4735s
	iters: 200, epoch: 10 | loss: 0.5623507
	speed: 0.0139s/iter; left time: 13.0720s
	iters: 300, epoch: 10 | loss: 0.5012243
	speed: 0.0135s/iter; left time: 11.3877s
	iters: 400, epoch: 10 | loss: 0.5496680
	speed: 0.0134s/iter; left time: 9.9520s
	iters: 500, epoch: 10 | loss: 0.7101328
	speed: 0.0134s/iter; left time: 8.5763s
	iters: 600, epoch: 10 | loss: 0.6243221
	speed: 0.0133s/iter; left time: 7.2062s
	iters: 700, epoch: 10 | loss: 0.4463786
	speed: 0.0133s/iter; left time: 5.8458s
	iters: 800, epoch: 10 | loss: 0.8261076
	speed: 0.0132s/iter; left time: 4.5016s
	iters: 900, epoch: 10 | loss: 0.5825719
	speed: 0.0132s/iter; left time: 3.1804s
	iters: 1000, epoch: 10 | loss: 0.4622793
	speed: 0.0132s/iter; left time: 1.8600s
	iters: 1100, epoch: 10 | loss: 0.4426811
	speed: 0.0132s/iter; left time: 0.5400s
Epoch: 10 cost time: 15.085910320281982
Epoch: 10, Steps: 1140 | Train Loss: 0.5814552 Vali Loss: 0.5934708 Test Loss: 0.2840245
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.2841145694255829, mae:0.3020419776439667
Seed: 456
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_720      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip True
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.6143923
	speed: 0.0201s/iter; left time: 224.7097s
	iters: 200, epoch: 1 | loss: 0.6752570
	speed: 0.0146s/iter; left time: 162.0850s
	iters: 300, epoch: 1 | loss: 0.6699894
	speed: 0.0131s/iter; left time: 143.7024s
	iters: 400, epoch: 1 | loss: 0.8342036
	speed: 0.0116s/iter; left time: 126.0573s
	iters: 500, epoch: 1 | loss: 0.7545220
	speed: 0.0105s/iter; left time: 112.8869s
	iters: 600, epoch: 1 | loss: 0.6152527
	speed: 0.0098s/iter; left time: 104.8941s
	iters: 700, epoch: 1 | loss: 0.7725978
	speed: 0.0103s/iter; left time: 109.0655s
	iters: 800, epoch: 1 | loss: 0.8713405
	speed: 0.0107s/iter; left time: 111.9458s
	iters: 900, epoch: 1 | loss: 0.7528618
	speed: 0.0110s/iter; left time: 113.8135s
	iters: 1000, epoch: 1 | loss: 0.6513838
	speed: 0.0112s/iter; left time: 115.0195s
	iters: 1100, epoch: 1 | loss: 0.8405477
	speed: 0.0114s/iter; left time: 115.7644s
Epoch: 1 cost time: 12.927849292755127
Epoch: 1, Steps: 1128 | Train Loss: 0.7615610 Vali Loss: 0.7759132 Test Loss: 0.3712605
Validation loss decreased (inf --> 0.775913).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9677483
	speed: 0.0148s/iter; left time: 148.8859s
	iters: 200, epoch: 2 | loss: 0.6800727
	speed: 0.0140s/iter; left time: 139.0127s
	iters: 300, epoch: 2 | loss: 0.5582680
	speed: 0.0137s/iter; left time: 134.6488s
	iters: 400, epoch: 2 | loss: 0.6508659
	speed: 0.0136s/iter; left time: 132.2187s
	iters: 500, epoch: 2 | loss: 0.8278822
	speed: 0.0135s/iter; left time: 129.9382s
	iters: 600, epoch: 2 | loss: 0.6908067
	speed: 0.0134s/iter; left time: 128.0531s
	iters: 700, epoch: 2 | loss: 0.7553307
	speed: 0.0134s/iter; left time: 126.3207s
	iters: 800, epoch: 2 | loss: 0.6994178
	speed: 0.0133s/iter; left time: 124.6906s
	iters: 900, epoch: 2 | loss: 0.7314051
	speed: 0.0133s/iter; left time: 123.2035s
	iters: 1000, epoch: 2 | loss: 0.6501052
	speed: 0.0133s/iter; left time: 121.6413s
	iters: 1100, epoch: 2 | loss: 0.5685303
	speed: 0.0133s/iter; left time: 120.2390s
Epoch: 2 cost time: 15.027721881866455
Epoch: 2, Steps: 1128 | Train Loss: 0.7302805 Vali Loss: 0.7673979 Test Loss: 0.3713865
Validation loss decreased (0.775913 --> 0.767398).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5633953
	speed: 0.0150s/iter; left time: 133.7088s
	iters: 200, epoch: 3 | loss: 0.8642020
	speed: 0.0141s/iter; left time: 124.5115s
	iters: 300, epoch: 3 | loss: 0.7526905
	speed: 0.0138s/iter; left time: 120.3291s
	iters: 400, epoch: 3 | loss: 0.7102796
	speed: 0.0136s/iter; left time: 117.4939s
	iters: 500, epoch: 3 | loss: 0.6100770
	speed: 0.0135s/iter; left time: 115.2279s
	iters: 600, epoch: 3 | loss: 0.6398281
	speed: 0.0135s/iter; left time: 113.4784s
	iters: 700, epoch: 3 | loss: 0.7490299
	speed: 0.0134s/iter; left time: 111.9520s
	iters: 800, epoch: 3 | loss: 0.7519677
	speed: 0.0134s/iter; left time: 110.1978s
	iters: 900, epoch: 3 | loss: 0.8116865
	speed: 0.0134s/iter; left time: 108.7737s
	iters: 1000, epoch: 3 | loss: 0.8089511
	speed: 0.0134s/iter; left time: 107.2477s
	iters: 1100, epoch: 3 | loss: 0.9043500
	speed: 0.0133s/iter; left time: 105.5964s
Epoch: 3 cost time: 15.101566553115845
Epoch: 3, Steps: 1128 | Train Loss: 0.7088753 Vali Loss: 0.7658464 Test Loss: 0.3663122
Validation loss decreased (0.767398 --> 0.765846).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.7026591
	speed: 0.0152s/iter; left time: 118.7455s
	iters: 200, epoch: 4 | loss: 0.6135776
	speed: 0.0143s/iter; left time: 109.8086s
	iters: 300, epoch: 4 | loss: 0.6909673
	speed: 0.0140s/iter; left time: 106.4784s
	iters: 400, epoch: 4 | loss: 0.5679582
	speed: 0.0129s/iter; left time: 96.6037s
	iters: 500, epoch: 4 | loss: 0.8775377
	speed: 0.0120s/iter; left time: 88.7304s
	iters: 600, epoch: 4 | loss: 0.7256855
	speed: 0.0116s/iter; left time: 84.5920s
	iters: 700, epoch: 4 | loss: 0.6433910
	speed: 0.0113s/iter; left time: 81.1824s
	iters: 800, epoch: 4 | loss: 0.7016961
	speed: 0.0115s/iter; left time: 81.7494s
	iters: 900, epoch: 4 | loss: 0.5654873
	speed: 0.0117s/iter; left time: 81.8927s
	iters: 1000, epoch: 4 | loss: 0.8358849
	speed: 0.0119s/iter; left time: 81.7419s
	iters: 1100, epoch: 4 | loss: 0.7616124
	speed: 0.0120s/iter; left time: 81.4345s
Epoch: 4 cost time: 13.601994276046753
Epoch: 4, Steps: 1128 | Train Loss: 0.6986596 Vali Loss: 0.7633983 Test Loss: 0.3646378
Validation loss decreased (0.765846 --> 0.763398).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6137383
	speed: 0.0151s/iter; left time: 100.8509s
	iters: 200, epoch: 5 | loss: 0.5843076
	speed: 0.0142s/iter; left time: 93.3097s
	iters: 300, epoch: 5 | loss: 0.6521728
	speed: 0.0139s/iter; left time: 89.9216s
	iters: 400, epoch: 5 | loss: 0.5833918
	speed: 0.0137s/iter; left time: 87.5355s
	iters: 500, epoch: 5 | loss: 0.6381168
	speed: 0.0136s/iter; left time: 85.4956s
	iters: 600, epoch: 5 | loss: 0.7019613
	speed: 0.0136s/iter; left time: 83.6786s
	iters: 700, epoch: 5 | loss: 0.6033145
	speed: 0.0135s/iter; left time: 82.0049s
	iters: 800, epoch: 5 | loss: 0.6825629
	speed: 0.0135s/iter; left time: 80.4640s
	iters: 900, epoch: 5 | loss: 0.8500093
	speed: 0.0134s/iter; left time: 78.9122s
	iters: 1000, epoch: 5 | loss: 0.5979310
	speed: 0.0134s/iter; left time: 77.4416s
	iters: 1100, epoch: 5 | loss: 0.7391021
	speed: 0.0134s/iter; left time: 76.0264s
Epoch: 5 cost time: 15.180964946746826
Epoch: 5, Steps: 1128 | Train Loss: 0.6916609 Vali Loss: 0.7558699 Test Loss: 0.3625062
Validation loss decreased (0.763398 --> 0.755870).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.7259303
	speed: 0.0147s/iter; left time: 81.2439s
	iters: 200, epoch: 6 | loss: 0.5192293
	speed: 0.0139s/iter; left time: 75.8497s
	iters: 300, epoch: 6 | loss: 0.6592975
	speed: 0.0137s/iter; left time: 73.0518s
	iters: 400, epoch: 6 | loss: 0.5557219
	speed: 0.0136s/iter; left time: 71.1965s
	iters: 500, epoch: 6 | loss: 0.6258392
	speed: 0.0135s/iter; left time: 69.4990s
	iters: 600, epoch: 6 | loss: 0.7333586
	speed: 0.0135s/iter; left time: 67.9306s
	iters: 700, epoch: 6 | loss: 0.5004159
	speed: 0.0134s/iter; left time: 66.3711s
	iters: 800, epoch: 6 | loss: 0.6453403
	speed: 0.0134s/iter; left time: 64.8777s
	iters: 900, epoch: 6 | loss: 0.7168773
	speed: 0.0134s/iter; left time: 63.4321s
	iters: 1000, epoch: 6 | loss: 0.7469558
	speed: 0.0134s/iter; left time: 62.0247s
	iters: 1100, epoch: 6 | loss: 0.6913844
	speed: 0.0134s/iter; left time: 60.6359s
Epoch: 6 cost time: 15.11074709892273
Epoch: 6, Steps: 1128 | Train Loss: 0.6882237 Vali Loss: 0.7542621 Test Loss: 0.3629643
Validation loss decreased (0.755870 --> 0.754262).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.6272956
	speed: 0.0147s/iter; left time: 65.0294s
	iters: 200, epoch: 7 | loss: 0.6565871
	speed: 0.0139s/iter; left time: 59.8930s
	iters: 300, epoch: 7 | loss: 0.6708791
	speed: 0.0136s/iter; left time: 57.4214s
	iters: 400, epoch: 7 | loss: 0.9302415
	speed: 0.0135s/iter; left time: 55.6005s
	iters: 500, epoch: 7 | loss: 0.6698232
	speed: 0.0129s/iter; left time: 51.5833s
	iters: 600, epoch: 7 | loss: 0.6455891
	speed: 0.0123s/iter; left time: 48.0116s
	iters: 700, epoch: 7 | loss: 0.8344423
	speed: 0.0119s/iter; left time: 45.5165s
	iters: 800, epoch: 7 | loss: 0.7362032
	speed: 0.0119s/iter; left time: 44.0650s
	iters: 900, epoch: 7 | loss: 0.7392868
	speed: 0.0120s/iter; left time: 43.3991s
	iters: 1000, epoch: 7 | loss: 0.5835130
	speed: 0.0121s/iter; left time: 42.5849s
	iters: 1100, epoch: 7 | loss: 0.6639842
	speed: 0.0122s/iter; left time: 41.6566s
Epoch: 7 cost time: 13.83888840675354
Epoch: 7, Steps: 1128 | Train Loss: 0.6862213 Vali Loss: 0.7561613 Test Loss: 0.3626064
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.6966158
	speed: 0.0147s/iter; left time: 48.2565s
	iters: 200, epoch: 8 | loss: 0.6720907
	speed: 0.0140s/iter; left time: 44.4638s
	iters: 300, epoch: 8 | loss: 0.5777040
	speed: 0.0137s/iter; left time: 42.2894s
	iters: 400, epoch: 8 | loss: 0.7073641
	speed: 0.0136s/iter; left time: 40.5119s
	iters: 500, epoch: 8 | loss: 0.5493078
	speed: 0.0135s/iter; left time: 38.9775s
	iters: 600, epoch: 8 | loss: 0.5911393
	speed: 0.0135s/iter; left time: 37.4764s
	iters: 700, epoch: 8 | loss: 0.6984969
	speed: 0.0134s/iter; left time: 35.9086s
	iters: 800, epoch: 8 | loss: 0.6073955
	speed: 0.0134s/iter; left time: 34.5196s
	iters: 900, epoch: 8 | loss: 0.6053081
	speed: 0.0133s/iter; left time: 33.1043s
	iters: 1000, epoch: 8 | loss: 0.6053973
	speed: 0.0133s/iter; left time: 31.7126s
	iters: 1100, epoch: 8 | loss: 0.8383746
	speed: 0.0133s/iter; left time: 30.3708s
Epoch: 8 cost time: 15.057730197906494
Epoch: 8, Steps: 1128 | Train Loss: 0.6853846 Vali Loss: 0.7543135 Test Loss: 0.3624355
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.5811343
	speed: 0.0148s/iter; left time: 31.9873s
	iters: 200, epoch: 9 | loss: 0.5760976
	speed: 0.0141s/iter; left time: 28.9313s
	iters: 300, epoch: 9 | loss: 0.5898551
	speed: 0.0138s/iter; left time: 26.9402s
	iters: 400, epoch: 9 | loss: 0.7566922
	speed: 0.0136s/iter; left time: 25.3183s
	iters: 500, epoch: 9 | loss: 0.5732244
	speed: 0.0135s/iter; left time: 23.7637s
	iters: 600, epoch: 9 | loss: 0.7262672
	speed: 0.0135s/iter; left time: 22.3027s
	iters: 700, epoch: 9 | loss: 0.7105752
	speed: 0.0134s/iter; left time: 20.8810s
	iters: 800, epoch: 9 | loss: 0.6806501
	speed: 0.0134s/iter; left time: 19.4960s
	iters: 900, epoch: 9 | loss: 0.6572487
	speed: 0.0134s/iter; left time: 18.1272s
	iters: 1000, epoch: 9 | loss: 0.8165627
	speed: 0.0133s/iter; left time: 16.7727s
	iters: 1100, epoch: 9 | loss: 0.6481869
	speed: 0.0133s/iter; left time: 15.4226s
Epoch: 9 cost time: 15.088413000106812
Epoch: 9, Steps: 1128 | Train Loss: 0.6847905 Vali Loss: 0.7556697 Test Loss: 0.3624640
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.5187324
	speed: 0.0146s/iter; left time: 15.0114s
	iters: 200, epoch: 10 | loss: 0.6642426
	speed: 0.0139s/iter; left time: 12.9127s
	iters: 300, epoch: 10 | loss: 0.6561950
	speed: 0.0137s/iter; left time: 11.3814s
	iters: 400, epoch: 10 | loss: 0.7281178
	speed: 0.0136s/iter; left time: 9.9311s
	iters: 500, epoch: 10 | loss: 0.7714650
	speed: 0.0135s/iter; left time: 8.5086s
	iters: 600, epoch: 10 | loss: 0.6886584
	speed: 0.0129s/iter; left time: 6.8106s
	iters: 700, epoch: 10 | loss: 0.6275374
	speed: 0.0124s/iter; left time: 5.3409s
	iters: 800, epoch: 10 | loss: 0.7438831
	speed: 0.0121s/iter; left time: 3.9711s
	iters: 900, epoch: 10 | loss: 0.5699228
	speed: 0.0119s/iter; left time: 2.7233s
	iters: 1000, epoch: 10 | loss: 0.6172217
	speed: 0.0120s/iter; left time: 1.5508s
	iters: 1100, epoch: 10 | loss: 0.5332435
	speed: 0.0121s/iter; left time: 0.3513s
Epoch: 10 cost time: 13.774406433105469
Epoch: 10, Steps: 1128 | Train Loss: 0.6845911 Vali Loss: 0.7548259 Test Loss: 0.3623650
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.362964391708374, mae:0.35320672392845154
Use GPU: cuda:0
no_skip True
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.7496484
	speed: 0.0148s/iter; left time: 164.9777s
	iters: 200, epoch: 1 | loss: 0.6177170
	speed: 0.0140s/iter; left time: 154.8136s
	iters: 300, epoch: 1 | loss: 0.7164599
	speed: 0.0137s/iter; left time: 150.4107s
	iters: 400, epoch: 1 | loss: 0.6886451
	speed: 0.0136s/iter; left time: 147.8268s
	iters: 500, epoch: 1 | loss: 0.7065763
	speed: 0.0135s/iter; left time: 145.5074s
	iters: 600, epoch: 1 | loss: 0.7019601
	speed: 0.0135s/iter; left time: 143.6864s
	iters: 700, epoch: 1 | loss: 0.6973127
	speed: 0.0134s/iter; left time: 142.0126s
	iters: 800, epoch: 1 | loss: 1.0151515
	speed: 0.0134s/iter; left time: 140.4147s
	iters: 900, epoch: 1 | loss: 0.6436349
	speed: 0.0134s/iter; left time: 138.7333s
	iters: 1000, epoch: 1 | loss: 0.8646965
	speed: 0.0133s/iter; left time: 137.2083s
	iters: 1100, epoch: 1 | loss: 0.6762465
	speed: 0.0133s/iter; left time: 135.7554s
Epoch: 1 cost time: 15.093806028366089
Epoch: 1, Steps: 1128 | Train Loss: 0.7520916 Vali Loss: 0.8072345 Test Loss: 0.3713980
Validation loss decreased (inf --> 0.807234).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7021921
	speed: 0.0146s/iter; left time: 146.8966s
	iters: 200, epoch: 2 | loss: 0.6793693
	speed: 0.0138s/iter; left time: 137.8435s
	iters: 300, epoch: 2 | loss: 0.6388587
	speed: 0.0136s/iter; left time: 134.0369s
	iters: 400, epoch: 2 | loss: 0.6045247
	speed: 0.0135s/iter; left time: 131.3677s
	iters: 500, epoch: 2 | loss: 0.6968429
	speed: 0.0134s/iter; left time: 129.2223s
	iters: 600, epoch: 2 | loss: 0.6920463
	speed: 0.0134s/iter; left time: 127.5646s
	iters: 700, epoch: 2 | loss: 0.7622971
	speed: 0.0133s/iter; left time: 126.0952s
	iters: 800, epoch: 2 | loss: 0.6465837
	speed: 0.0133s/iter; left time: 124.5661s
	iters: 900, epoch: 2 | loss: 0.6254357
	speed: 0.0133s/iter; left time: 123.0107s
	iters: 1000, epoch: 2 | loss: 0.7121719
	speed: 0.0133s/iter; left time: 121.4553s
	iters: 1100, epoch: 2 | loss: 0.7764149
	speed: 0.0133s/iter; left time: 120.0100s
Epoch: 2 cost time: 15.01332139968872
Epoch: 2, Steps: 1128 | Train Loss: 0.7074903 Vali Loss: 0.7401232 Test Loss: 0.3629715
Validation loss decreased (0.807234 --> 0.740123).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6283526
	speed: 0.0148s/iter; left time: 132.1055s
	iters: 200, epoch: 3 | loss: 0.7232881
	speed: 0.0140s/iter; left time: 123.1932s
	iters: 300, epoch: 3 | loss: 0.7785443
	speed: 0.0137s/iter; left time: 119.2044s
	iters: 400, epoch: 3 | loss: 0.7441458
	speed: 0.0133s/iter; left time: 114.9290s
	iters: 500, epoch: 3 | loss: 0.6262628
	speed: 0.0126s/iter; left time: 107.4326s
	iters: 600, epoch: 3 | loss: 0.5978801
	speed: 0.0121s/iter; left time: 101.9247s
	iters: 700, epoch: 3 | loss: 0.5758244
	speed: 0.0118s/iter; left time: 97.9012s
	iters: 800, epoch: 3 | loss: 0.5327485
	speed: 0.0118s/iter; left time: 96.8176s
	iters: 900, epoch: 3 | loss: 0.9190501
	speed: 0.0119s/iter; left time: 96.7693s
	iters: 1000, epoch: 3 | loss: 0.6075774
	speed: 0.0120s/iter; left time: 96.5382s
	iters: 1100, epoch: 3 | loss: 0.7780005
	speed: 0.0121s/iter; left time: 96.1248s
Epoch: 3 cost time: 13.774675369262695
Epoch: 3, Steps: 1128 | Train Loss: 0.6874687 Vali Loss: 0.7400451 Test Loss: 0.3630141
Validation loss decreased (0.740123 --> 0.740045).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.7199417
	speed: 0.0151s/iter; left time: 118.0687s
	iters: 200, epoch: 4 | loss: 0.7179286
	speed: 0.0142s/iter; left time: 109.1089s
	iters: 300, epoch: 4 | loss: 0.5814563
	speed: 0.0139s/iter; left time: 105.5853s
	iters: 400, epoch: 4 | loss: 0.7057237
	speed: 0.0138s/iter; left time: 103.1274s
	iters: 500, epoch: 4 | loss: 0.6691397
	speed: 0.0137s/iter; left time: 101.2123s
	iters: 600, epoch: 4 | loss: 0.6693847
	speed: 0.0136s/iter; left time: 99.5135s
	iters: 700, epoch: 4 | loss: 0.7316694
	speed: 0.0136s/iter; left time: 97.8525s
	iters: 800, epoch: 4 | loss: 0.6690061
	speed: 0.0136s/iter; left time: 96.3250s
	iters: 900, epoch: 4 | loss: 0.9038394
	speed: 0.0135s/iter; left time: 94.7630s
	iters: 1000, epoch: 4 | loss: 0.6380035
	speed: 0.0135s/iter; left time: 93.2368s
	iters: 1100, epoch: 4 | loss: 0.6847180
	speed: 0.0135s/iter; left time: 91.7481s
Epoch: 4 cost time: 15.29826545715332
Epoch: 4, Steps: 1128 | Train Loss: 0.6768180 Vali Loss: 0.7343919 Test Loss: 0.3608067
Validation loss decreased (0.740045 --> 0.734392).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.9666438
	speed: 0.0153s/iter; left time: 102.0778s
	iters: 200, epoch: 5 | loss: 0.7268046
	speed: 0.0143s/iter; left time: 94.0846s
	iters: 300, epoch: 5 | loss: 0.5035185
	speed: 0.0140s/iter; left time: 90.5301s
	iters: 400, epoch: 5 | loss: 0.7071377
	speed: 0.0138s/iter; left time: 88.1230s
	iters: 500, epoch: 5 | loss: 0.7375353
	speed: 0.0137s/iter; left time: 86.0647s
	iters: 600, epoch: 5 | loss: 0.5612161
	speed: 0.0137s/iter; left time: 84.2911s
	iters: 700, epoch: 5 | loss: 0.5800048
	speed: 0.0136s/iter; left time: 82.6452s
	iters: 800, epoch: 5 | loss: 0.5081372
	speed: 0.0136s/iter; left time: 81.0843s
	iters: 900, epoch: 5 | loss: 0.7491744
	speed: 0.0136s/iter; left time: 79.5571s
	iters: 1000, epoch: 5 | loss: 0.6300486
	speed: 0.0135s/iter; left time: 78.0768s
	iters: 1100, epoch: 5 | loss: 0.8057204
	speed: 0.0135s/iter; left time: 76.6365s
Epoch: 5 cost time: 15.32360577583313
Epoch: 5, Steps: 1128 | Train Loss: 0.6713052 Vali Loss: 0.7293306 Test Loss: 0.3605783
Validation loss decreased (0.734392 --> 0.729331).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.7274356
	speed: 0.0154s/iter; left time: 85.3002s
	iters: 200, epoch: 6 | loss: 0.7273080
	speed: 0.0144s/iter; left time: 78.1462s
	iters: 300, epoch: 6 | loss: 0.5746849
	speed: 0.0140s/iter; left time: 74.9039s
	iters: 400, epoch: 6 | loss: 0.6200046
	speed: 0.0137s/iter; left time: 71.7148s
	iters: 500, epoch: 6 | loss: 0.7744192
	speed: 0.0131s/iter; left time: 67.5000s
	iters: 600, epoch: 6 | loss: 0.5973423
	speed: 0.0127s/iter; left time: 63.8910s
	iters: 700, epoch: 6 | loss: 0.7265714
	speed: 0.0124s/iter; left time: 61.1061s
	iters: 800, epoch: 6 | loss: 0.6068977
	speed: 0.0118s/iter; left time: 57.3338s
	iters: 900, epoch: 6 | loss: 0.5804738
	speed: 0.0116s/iter; left time: 55.0506s
	iters: 1000, epoch: 6 | loss: 0.5651628
	speed: 0.0112s/iter; left time: 52.2051s
	iters: 1100, epoch: 6 | loss: 0.7201474
	speed: 0.0108s/iter; left time: 48.9054s
Epoch: 6 cost time: 12.101298332214355
Epoch: 6, Steps: 1128 | Train Loss: 0.6679381 Vali Loss: 0.7284450 Test Loss: 0.3599904
Validation loss decreased (0.729331 --> 0.728445).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5996023
	speed: 0.0147s/iter; left time: 64.7386s
	iters: 200, epoch: 7 | loss: 0.6090032
	speed: 0.0139s/iter; left time: 60.0560s
	iters: 300, epoch: 7 | loss: 0.5664133
	speed: 0.0137s/iter; left time: 57.5952s
	iters: 400, epoch: 7 | loss: 0.6032663
	speed: 0.0136s/iter; left time: 55.7809s
	iters: 500, epoch: 7 | loss: 0.6963142
	speed: 0.0135s/iter; left time: 54.1206s
	iters: 600, epoch: 7 | loss: 0.8003801
	speed: 0.0135s/iter; left time: 52.6490s
	iters: 700, epoch: 7 | loss: 0.5792582
	speed: 0.0134s/iter; left time: 51.1565s
	iters: 800, epoch: 7 | loss: 0.6174230
	speed: 0.0134s/iter; left time: 49.6755s
	iters: 900, epoch: 7 | loss: 0.5476102
	speed: 0.0134s/iter; left time: 48.2409s
	iters: 1000, epoch: 7 | loss: 0.5457309
	speed: 0.0133s/iter; left time: 46.8201s
	iters: 1100, epoch: 7 | loss: 0.6514140
	speed: 0.0133s/iter; left time: 45.4788s
Epoch: 7 cost time: 15.085968732833862
Epoch: 7, Steps: 1128 | Train Loss: 0.6663844 Vali Loss: 0.7272864 Test Loss: 0.3604353
Validation loss decreased (0.728445 --> 0.727286).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.7681084
	speed: 0.0146s/iter; left time: 47.9466s
	iters: 200, epoch: 8 | loss: 0.7430856
	speed: 0.0139s/iter; left time: 44.2858s
	iters: 300, epoch: 8 | loss: 0.6520619
	speed: 0.0136s/iter; left time: 42.0779s
	iters: 400, epoch: 8 | loss: 0.9978181
	speed: 0.0135s/iter; left time: 40.3855s
	iters: 500, epoch: 8 | loss: 0.8957009
	speed: 0.0134s/iter; left time: 38.7840s
	iters: 600, epoch: 8 | loss: 0.7372520
	speed: 0.0134s/iter; left time: 37.3394s
	iters: 700, epoch: 8 | loss: 0.7143059
	speed: 0.0134s/iter; left time: 35.9074s
	iters: 800, epoch: 8 | loss: 0.6679233
	speed: 0.0134s/iter; left time: 34.5282s
	iters: 900, epoch: 8 | loss: 0.6369504
	speed: 0.0133s/iter; left time: 33.1413s
	iters: 1000, epoch: 8 | loss: 0.6350058
	speed: 0.0133s/iter; left time: 31.7296s
	iters: 1100, epoch: 8 | loss: 0.7010081
	speed: 0.0133s/iter; left time: 30.3648s
Epoch: 8 cost time: 15.04523515701294
Epoch: 8, Steps: 1128 | Train Loss: 0.6658594 Vali Loss: 0.7293646 Test Loss: 0.3602987
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.6397707
	speed: 0.0148s/iter; left time: 31.9696s
	iters: 200, epoch: 9 | loss: 0.6333043
	speed: 0.0140s/iter; left time: 28.7149s
	iters: 300, epoch: 9 | loss: 0.6195931
	speed: 0.0137s/iter; left time: 26.7367s
	iters: 400, epoch: 9 | loss: 0.5863889
	speed: 0.0135s/iter; left time: 25.0792s
	iters: 500, epoch: 9 | loss: 0.6677791
	speed: 0.0134s/iter; left time: 23.5834s
	iters: 600, epoch: 9 | loss: 0.5647442
	speed: 0.0134s/iter; left time: 22.2022s
	iters: 700, epoch: 9 | loss: 0.5715742
	speed: 0.0134s/iter; left time: 20.8221s
	iters: 800, epoch: 9 | loss: 0.5693220
	speed: 0.0133s/iter; left time: 19.4396s
	iters: 900, epoch: 9 | loss: 0.5362067
	speed: 0.0132s/iter; left time: 17.8450s
	iters: 1000, epoch: 9 | loss: 0.5333564
	speed: 0.0128s/iter; left time: 16.0462s
	iters: 1100, epoch: 9 | loss: 0.5929043
	speed: 0.0125s/iter; left time: 14.4572s
Epoch: 9 cost time: 14.074155330657959
Epoch: 9, Steps: 1128 | Train Loss: 0.6649175 Vali Loss: 0.7262997 Test Loss: 0.3600050
Validation loss decreased (0.727286 --> 0.726300).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.5832192
	speed: 0.0139s/iter; left time: 14.3254s
	iters: 200, epoch: 10 | loss: 0.5188268
	speed: 0.0135s/iter; left time: 12.5615s
	iters: 300, epoch: 10 | loss: 0.9223059
	speed: 0.0134s/iter; left time: 11.1023s
	iters: 400, epoch: 10 | loss: 0.5584221
	speed: 0.0133s/iter; left time: 9.7162s
	iters: 500, epoch: 10 | loss: 0.6968783
	speed: 0.0133s/iter; left time: 8.3611s
	iters: 600, epoch: 10 | loss: 0.5714631
	speed: 0.0133s/iter; left time: 7.0238s
	iters: 700, epoch: 10 | loss: 0.8308374
	speed: 0.0133s/iter; left time: 5.6882s
	iters: 800, epoch: 10 | loss: 0.6925254
	speed: 0.0132s/iter; left time: 4.3578s
	iters: 900, epoch: 10 | loss: 0.6691529
	speed: 0.0132s/iter; left time: 3.0320s
	iters: 1000, epoch: 10 | loss: 0.5766464
	speed: 0.0132s/iter; left time: 1.7082s
	iters: 1100, epoch: 10 | loss: 0.5276151
	speed: 0.0132s/iter; left time: 0.3839s
Epoch: 10 cost time: 14.989465951919556
Epoch: 10, Steps: 1128 | Train Loss: 0.6652941 Vali Loss: 0.7265291 Test Loss: 0.3600549
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.36000490188598633, mae:0.35126861929893494
Use GPU: cuda:0
no_skip True
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.9092871
	speed: 0.0148s/iter; left time: 165.1197s
	iters: 200, epoch: 1 | loss: 1.1783900
	speed: 0.0140s/iter; left time: 154.9991s
	iters: 300, epoch: 1 | loss: 0.7353137
	speed: 0.0137s/iter; left time: 150.3682s
	iters: 400, epoch: 1 | loss: 0.6499453
	speed: 0.0135s/iter; left time: 147.2161s
	iters: 500, epoch: 1 | loss: 0.7208129
	speed: 0.0134s/iter; left time: 144.8908s
	iters: 600, epoch: 1 | loss: 0.8061144
	speed: 0.0134s/iter; left time: 143.2450s
	iters: 700, epoch: 1 | loss: 0.8155610
	speed: 0.0134s/iter; left time: 141.6271s
	iters: 800, epoch: 1 | loss: 0.9458283
	speed: 0.0133s/iter; left time: 139.8878s
	iters: 900, epoch: 1 | loss: 0.7798926
	speed: 0.0133s/iter; left time: 138.4552s
	iters: 1000, epoch: 1 | loss: 0.6655731
	speed: 0.0133s/iter; left time: 136.7566s
	iters: 1100, epoch: 1 | loss: 0.6526440
	speed: 0.0133s/iter; left time: 135.0601s
Epoch: 1 cost time: 15.020053148269653
Epoch: 1, Steps: 1128 | Train Loss: 0.7552167 Vali Loss: 0.7551370 Test Loss: 0.3646889
Validation loss decreased (inf --> 0.755137).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7396064
	speed: 0.0144s/iter; left time: 144.4664s
	iters: 200, epoch: 2 | loss: 0.7311075
	speed: 0.0138s/iter; left time: 137.0739s
	iters: 300, epoch: 2 | loss: 0.7463943
	speed: 0.0136s/iter; left time: 134.1395s
	iters: 400, epoch: 2 | loss: 0.8026972
	speed: 0.0135s/iter; left time: 131.3762s
	iters: 500, epoch: 2 | loss: 0.9052399
	speed: 0.0134s/iter; left time: 129.0483s
	iters: 600, epoch: 2 | loss: 0.7069207
	speed: 0.0133s/iter; left time: 127.0682s
	iters: 700, epoch: 2 | loss: 0.6286489
	speed: 0.0133s/iter; left time: 125.3052s
	iters: 800, epoch: 2 | loss: 0.5085986
	speed: 0.0132s/iter; left time: 123.8988s
	iters: 900, epoch: 2 | loss: 0.7423875
	speed: 0.0133s/iter; left time: 122.6748s
	iters: 1000, epoch: 2 | loss: 0.8104134
	speed: 0.0131s/iter; left time: 119.6560s
	iters: 1100, epoch: 2 | loss: 0.6003214
	speed: 0.0128s/iter; left time: 116.2475s
Epoch: 2 cost time: 14.487189769744873
Epoch: 2, Steps: 1128 | Train Loss: 0.7068644 Vali Loss: 0.7507978 Test Loss: 0.3637858
Validation loss decreased (0.755137 --> 0.750798).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7963412
	speed: 0.0147s/iter; left time: 131.5142s
	iters: 200, epoch: 3 | loss: 0.8745470
	speed: 0.0140s/iter; left time: 123.2970s
	iters: 300, epoch: 3 | loss: 0.6787405
	speed: 0.0137s/iter; left time: 119.5819s
	iters: 400, epoch: 3 | loss: 0.5522723
	speed: 0.0136s/iter; left time: 116.9087s
	iters: 500, epoch: 3 | loss: 0.7258264
	speed: 0.0134s/iter; left time: 114.6598s
	iters: 600, epoch: 3 | loss: 0.6667573
	speed: 0.0134s/iter; left time: 112.8253s
	iters: 700, epoch: 3 | loss: 0.6758612
	speed: 0.0133s/iter; left time: 111.0401s
	iters: 800, epoch: 3 | loss: 0.6186230
	speed: 0.0133s/iter; left time: 109.5269s
	iters: 900, epoch: 3 | loss: 0.5578049
	speed: 0.0133s/iter; left time: 107.9045s
	iters: 1000, epoch: 3 | loss: 0.7433192
	speed: 0.0133s/iter; left time: 106.4349s
	iters: 1100, epoch: 3 | loss: 1.0713472
	speed: 0.0133s/iter; left time: 105.0504s
Epoch: 3 cost time: 15.00107455253601
Epoch: 3, Steps: 1128 | Train Loss: 0.6897269 Vali Loss: 0.7390704 Test Loss: 0.3629722
Validation loss decreased (0.750798 --> 0.739070).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8488251
	speed: 0.0147s/iter; left time: 114.2707s
	iters: 200, epoch: 4 | loss: 0.7290288
	speed: 0.0139s/iter; left time: 106.9037s
	iters: 300, epoch: 4 | loss: 0.6820437
	speed: 0.0136s/iter; left time: 103.6564s
	iters: 400, epoch: 4 | loss: 0.8453226
	speed: 0.0135s/iter; left time: 101.4866s
	iters: 500, epoch: 4 | loss: 0.5615831
	speed: 0.0135s/iter; left time: 99.5647s
	iters: 600, epoch: 4 | loss: 0.6829927
	speed: 0.0134s/iter; left time: 98.0136s
	iters: 700, epoch: 4 | loss: 0.7169493
	speed: 0.0134s/iter; left time: 96.2988s
	iters: 800, epoch: 4 | loss: 0.6482820
	speed: 0.0134s/iter; left time: 94.8392s
	iters: 900, epoch: 4 | loss: 0.5888628
	speed: 0.0133s/iter; left time: 93.3119s
	iters: 1000, epoch: 4 | loss: 0.7936096
	speed: 0.0133s/iter; left time: 91.7194s
	iters: 1100, epoch: 4 | loss: 0.6591432
	speed: 0.0133s/iter; left time: 90.3050s
Epoch: 4 cost time: 15.052668571472168
Epoch: 4, Steps: 1128 | Train Loss: 0.6801525 Vali Loss: 0.7256579 Test Loss: 0.3611410
Validation loss decreased (0.739070 --> 0.725658).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6239444
	speed: 0.0147s/iter; left time: 98.0288s
	iters: 200, epoch: 5 | loss: 0.7672296
	speed: 0.0138s/iter; left time: 90.9041s
	iters: 300, epoch: 5 | loss: 0.6254529
	speed: 0.0135s/iter; left time: 87.5228s
	iters: 400, epoch: 5 | loss: 0.7692647
	speed: 0.0135s/iter; left time: 85.8137s
	iters: 500, epoch: 5 | loss: 0.6951001
	speed: 0.0134s/iter; left time: 83.9695s
	iters: 600, epoch: 5 | loss: 0.6306261
	speed: 0.0134s/iter; left time: 82.4751s
	iters: 700, epoch: 5 | loss: 0.5765149
	speed: 0.0134s/iter; left time: 81.0681s
	iters: 800, epoch: 5 | loss: 0.5925181
	speed: 0.0133s/iter; left time: 79.6154s
	iters: 900, epoch: 5 | loss: 0.5985168
	speed: 0.0133s/iter; left time: 78.1688s
	iters: 1000, epoch: 5 | loss: 0.6879864
	speed: 0.0133s/iter; left time: 76.6796s
	iters: 1100, epoch: 5 | loss: 0.6337118
	speed: 0.0130s/iter; left time: 73.5095s
Epoch: 5 cost time: 14.614825010299683
Epoch: 5, Steps: 1128 | Train Loss: 0.6751580 Vali Loss: 0.7320142 Test Loss: 0.3616353
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5747316
	speed: 0.0149s/iter; left time: 82.7548s
	iters: 200, epoch: 6 | loss: 0.8214746
	speed: 0.0141s/iter; left time: 76.4820s
	iters: 300, epoch: 6 | loss: 0.5317957
	speed: 0.0137s/iter; left time: 73.3951s
	iters: 400, epoch: 6 | loss: 0.7299848
	speed: 0.0136s/iter; left time: 71.2152s
	iters: 500, epoch: 6 | loss: 0.5817062
	speed: 0.0135s/iter; left time: 69.3247s
	iters: 600, epoch: 6 | loss: 0.6883518
	speed: 0.0134s/iter; left time: 67.6532s
	iters: 700, epoch: 6 | loss: 0.7460910
	speed: 0.0134s/iter; left time: 66.1178s
	iters: 800, epoch: 6 | loss: 0.6591058
	speed: 0.0134s/iter; left time: 64.6397s
	iters: 900, epoch: 6 | loss: 0.6764545
	speed: 0.0133s/iter; left time: 63.2035s
	iters: 1000, epoch: 6 | loss: 0.6347802
	speed: 0.0133s/iter; left time: 61.7357s
	iters: 1100, epoch: 6 | loss: 0.8255075
	speed: 0.0133s/iter; left time: 60.2720s
Epoch: 6 cost time: 15.0349702835083
Epoch: 6, Steps: 1128 | Train Loss: 0.6723195 Vali Loss: 0.7271128 Test Loss: 0.3608641
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5914609
	speed: 0.0142s/iter; left time: 62.6578s
	iters: 200, epoch: 7 | loss: 0.5786376
	speed: 0.0136s/iter; left time: 58.6942s
	iters: 300, epoch: 7 | loss: 0.6680682
	speed: 0.0135s/iter; left time: 56.7464s
	iters: 400, epoch: 7 | loss: 0.7104700
	speed: 0.0134s/iter; left time: 54.9923s
	iters: 500, epoch: 7 | loss: 0.7660284
	speed: 0.0133s/iter; left time: 53.5063s
	iters: 600, epoch: 7 | loss: 0.6535482
	speed: 0.0133s/iter; left time: 51.9833s
	iters: 700, epoch: 7 | loss: 0.7356913
	speed: 0.0133s/iter; left time: 50.5979s
	iters: 800, epoch: 7 | loss: 0.8680118
	speed: 0.0132s/iter; left time: 49.1704s
	iters: 900, epoch: 7 | loss: 0.6138324
	speed: 0.0132s/iter; left time: 47.7639s
	iters: 1000, epoch: 7 | loss: 0.6021022
	speed: 0.0132s/iter; left time: 46.4155s
	iters: 1100, epoch: 7 | loss: 0.5273877
	speed: 0.0132s/iter; left time: 45.0991s
Epoch: 7 cost time: 14.959514617919922
Epoch: 7, Steps: 1128 | Train Loss: 0.6707977 Vali Loss: 0.7229381 Test Loss: 0.3600108
Validation loss decreased (0.725658 --> 0.722938).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.6966667
	speed: 0.0146s/iter; left time: 48.1236s
	iters: 200, epoch: 8 | loss: 0.8260580
	speed: 0.0139s/iter; left time: 44.1221s
	iters: 300, epoch: 8 | loss: 0.6052392
	speed: 0.0136s/iter; left time: 41.9583s
	iters: 400, epoch: 8 | loss: 0.5427467
	speed: 0.0134s/iter; left time: 40.1098s
	iters: 500, epoch: 8 | loss: 0.6265074
	speed: 0.0134s/iter; left time: 38.5854s
	iters: 600, epoch: 8 | loss: 0.6222331
	speed: 0.0133s/iter; left time: 37.1123s
	iters: 700, epoch: 8 | loss: 0.5707746
	speed: 0.0133s/iter; left time: 35.7032s
	iters: 800, epoch: 8 | loss: 0.7720279
	speed: 0.0133s/iter; left time: 34.3283s
	iters: 900, epoch: 8 | loss: 0.5991997
	speed: 0.0133s/iter; left time: 32.9311s
	iters: 1000, epoch: 8 | loss: 0.5415441
	speed: 0.0132s/iter; left time: 31.5913s
	iters: 1100, epoch: 8 | loss: 0.5751293
	speed: 0.0131s/iter; left time: 30.0131s
Epoch: 8 cost time: 14.81300663948059
Epoch: 8, Steps: 1128 | Train Loss: 0.6705492 Vali Loss: 0.7242221 Test Loss: 0.3603964
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.7642552
	speed: 0.0145s/iter; left time: 31.2619s
	iters: 200, epoch: 9 | loss: 0.6697523
	speed: 0.0139s/iter; left time: 28.4928s
	iters: 300, epoch: 9 | loss: 0.6453463
	speed: 0.0136s/iter; left time: 26.6617s
	iters: 400, epoch: 9 | loss: 0.6644736
	speed: 0.0135s/iter; left time: 25.0806s
	iters: 500, epoch: 9 | loss: 0.6012022
	speed: 0.0134s/iter; left time: 23.6035s
	iters: 600, epoch: 9 | loss: 0.6375549
	speed: 0.0134s/iter; left time: 22.1991s
	iters: 700, epoch: 9 | loss: 0.6738653
	speed: 0.0134s/iter; left time: 20.7977s
	iters: 800, epoch: 9 | loss: 0.6773823
	speed: 0.0133s/iter; left time: 19.4257s
	iters: 900, epoch: 9 | loss: 0.6365695
	speed: 0.0133s/iter; left time: 18.0676s
	iters: 1000, epoch: 9 | loss: 0.6486831
	speed: 0.0133s/iter; left time: 16.7121s
	iters: 1100, epoch: 9 | loss: 0.8250168
	speed: 0.0133s/iter; left time: 15.3613s
Epoch: 9 cost time: 15.034934997558594
Epoch: 9, Steps: 1128 | Train Loss: 0.6700155 Vali Loss: 0.7253529 Test Loss: 0.3603242
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.5729748
	speed: 0.0144s/iter; left time: 14.8092s
	iters: 200, epoch: 10 | loss: 0.5139443
	speed: 0.0138s/iter; left time: 12.8224s
	iters: 300, epoch: 10 | loss: 0.7024372
	speed: 0.0136s/iter; left time: 11.2616s
	iters: 400, epoch: 10 | loss: 0.6466141
	speed: 0.0135s/iter; left time: 9.8128s
	iters: 500, epoch: 10 | loss: 0.7140245
	speed: 0.0134s/iter; left time: 8.4258s
	iters: 600, epoch: 10 | loss: 0.6705765
	speed: 0.0134s/iter; left time: 7.0626s
	iters: 700, epoch: 10 | loss: 0.6869292
	speed: 0.0133s/iter; left time: 5.7124s
	iters: 800, epoch: 10 | loss: 0.8234637
	speed: 0.0133s/iter; left time: 4.3695s
	iters: 900, epoch: 10 | loss: 0.8464954
	speed: 0.0133s/iter; left time: 3.0357s
	iters: 1000, epoch: 10 | loss: 0.6558811
	speed: 0.0132s/iter; left time: 1.7091s
	iters: 1100, epoch: 10 | loss: 0.6305393
	speed: 0.0132s/iter; left time: 0.3837s
Epoch: 10 cost time: 14.991894483566284
Epoch: 10, Steps: 1128 | Train Loss: 0.6697692 Vali Loss: 0.7238352 Test Loss: 0.3605051
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipTrue_FDCFalse_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.3600107729434967, mae:0.3510693311691284
