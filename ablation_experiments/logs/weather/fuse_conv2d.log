nohup: ignoring input
Seed: 42
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_96       Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip False
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.4397103
	speed: 0.0569s/iter; left time: 647.0363s
	iters: 200, epoch: 1 | loss: 0.3609476
	speed: 0.0407s/iter; left time: 458.8996s
	iters: 300, epoch: 1 | loss: 0.3897900
	speed: 0.0353s/iter; left time: 394.4083s
	iters: 400, epoch: 1 | loss: 0.2929974
	speed: 0.0326s/iter; left time: 361.3547s
	iters: 500, epoch: 1 | loss: 0.4487432
	speed: 0.0310s/iter; left time: 339.7315s
	iters: 600, epoch: 1 | loss: 0.3853012
	speed: 0.0299s/iter; left time: 324.6145s
	iters: 700, epoch: 1 | loss: 0.3981205
	speed: 0.0290s/iter; left time: 312.1652s
	iters: 800, epoch: 1 | loss: 0.3080541
	speed: 0.0284s/iter; left time: 302.6187s
	iters: 900, epoch: 1 | loss: 0.4511429
	speed: 0.0279s/iter; left time: 294.8732s
	iters: 1000, epoch: 1 | loss: 0.4367055
	speed: 0.0275s/iter; left time: 288.0935s
	iters: 1100, epoch: 1 | loss: 0.3564616
	speed: 0.0273s/iter; left time: 283.2463s
Epoch: 1 cost time: 31.37395167350769
Epoch: 1, Steps: 1147 | Train Loss: 0.4866215 Vali Loss: 0.4399648 Test Loss: 0.1852222
Validation loss decreased (inf --> 0.439965).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4858750
	speed: 0.0367s/iter; left time: 375.1538s
	iters: 200, epoch: 2 | loss: 0.2936196
	speed: 0.0337s/iter; left time: 341.3245s
	iters: 300, epoch: 2 | loss: 0.4117801
	speed: 0.0309s/iter; left time: 310.2049s
	iters: 400, epoch: 2 | loss: 0.2901655
	speed: 0.0293s/iter; left time: 291.1966s
	iters: 500, epoch: 2 | loss: 0.3262567
	speed: 0.0284s/iter; left time: 279.0775s
	iters: 600, epoch: 2 | loss: 0.5937262
	speed: 0.0278s/iter; left time: 270.4139s
	iters: 700, epoch: 2 | loss: 0.3514218
	speed: 0.0274s/iter; left time: 263.4070s
	iters: 800, epoch: 2 | loss: 1.0771128
	speed: 0.0270s/iter; left time: 257.3612s
	iters: 900, epoch: 2 | loss: 0.3083588
	speed: 0.0268s/iter; left time: 252.1183s
	iters: 1000, epoch: 2 | loss: 1.2181731
	speed: 0.0265s/iter; left time: 246.6879s
	iters: 1100, epoch: 2 | loss: 0.2646813
	speed: 0.0260s/iter; left time: 240.1492s
Epoch: 2 cost time: 29.774973392486572
Epoch: 2, Steps: 1147 | Train Loss: 0.4414643 Vali Loss: 0.4185831 Test Loss: 0.1753858
Validation loss decreased (0.439965 --> 0.418583).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2762469
	speed: 0.0357s/iter; left time: 324.0021s
	iters: 200, epoch: 3 | loss: 0.3788484
	speed: 0.0291s/iter; left time: 261.0606s
	iters: 300, epoch: 3 | loss: 0.4235337
	speed: 0.0265s/iter; left time: 235.5441s
	iters: 400, epoch: 3 | loss: 0.2981108
	speed: 0.0258s/iter; left time: 226.5978s
	iters: 500, epoch: 3 | loss: 0.3937866
	speed: 0.0256s/iter; left time: 221.7191s
	iters: 600, epoch: 3 | loss: 0.2841266
	speed: 0.0254s/iter; left time: 218.0095s
	iters: 700, epoch: 3 | loss: 0.3389455
	speed: 0.0253s/iter; left time: 214.5283s
	iters: 800, epoch: 3 | loss: 0.3497843
	speed: 0.0252s/iter; left time: 211.0569s
	iters: 900, epoch: 3 | loss: 0.2793123
	speed: 0.0251s/iter; left time: 207.6641s
	iters: 1000, epoch: 3 | loss: 0.4653591
	speed: 0.0256s/iter; left time: 209.1026s
	iters: 1100, epoch: 3 | loss: 0.3109565
	speed: 0.0255s/iter; left time: 206.2279s
Epoch: 3 cost time: 29.121803283691406
Epoch: 3, Steps: 1147 | Train Loss: 0.4214789 Vali Loss: 0.4204485 Test Loss: 0.1755195
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2234125
	speed: 0.0287s/iter; left time: 227.8315s
	iters: 200, epoch: 4 | loss: 0.3200433
	speed: 0.0228s/iter; left time: 178.3079s
	iters: 300, epoch: 4 | loss: 0.3645126
	speed: 0.0209s/iter; left time: 161.4325s
	iters: 400, epoch: 4 | loss: 0.3406116
	speed: 0.0197s/iter; left time: 150.6191s
	iters: 500, epoch: 4 | loss: 0.2902186
	speed: 0.0189s/iter; left time: 142.6515s
	iters: 600, epoch: 4 | loss: 0.3294000
	speed: 0.0198s/iter; left time: 146.9711s
	iters: 700, epoch: 4 | loss: 0.3840083
	speed: 0.0205s/iter; left time: 150.1011s
	iters: 800, epoch: 4 | loss: 0.2605498
	speed: 0.0210s/iter; left time: 152.0877s
	iters: 900, epoch: 4 | loss: 0.3026552
	speed: 0.0215s/iter; left time: 152.9575s
	iters: 1000, epoch: 4 | loss: 0.3668571
	speed: 0.0217s/iter; left time: 152.4887s
	iters: 1100, epoch: 4 | loss: 0.3244129
	speed: 0.0217s/iter; left time: 150.6183s
Epoch: 4 cost time: 24.982378244400024
Epoch: 4, Steps: 1147 | Train Loss: 0.4103321 Vali Loss: 0.4155415 Test Loss: 0.1720952
Validation loss decreased (0.418583 --> 0.415541).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2374185
	speed: 0.0402s/iter; left time: 272.5606s
	iters: 200, epoch: 5 | loss: 0.3063332
	speed: 0.0371s/iter; left time: 247.9268s
	iters: 300, epoch: 5 | loss: 0.2854322
	speed: 0.0359s/iter; left time: 236.0468s
	iters: 400, epoch: 5 | loss: 0.5251542
	speed: 0.0353s/iter; left time: 228.6105s
	iters: 500, epoch: 5 | loss: 1.2267557
	speed: 0.0329s/iter; left time: 210.2705s
	iters: 600, epoch: 5 | loss: 0.2050254
	speed: 0.0315s/iter; left time: 197.8872s
	iters: 700, epoch: 5 | loss: 0.4067254
	speed: 0.0306s/iter; left time: 189.2979s
	iters: 800, epoch: 5 | loss: 1.2279609
	speed: 0.0296s/iter; left time: 180.1841s
	iters: 900, epoch: 5 | loss: 0.3699372
	speed: 0.0289s/iter; left time: 173.1560s
	iters: 1000, epoch: 5 | loss: 0.3155296
	speed: 0.0283s/iter; left time: 166.2643s
	iters: 1100, epoch: 5 | loss: 0.3036844
	speed: 0.0278s/iter; left time: 160.6130s
Epoch: 5 cost time: 31.994051456451416
Epoch: 5, Steps: 1147 | Train Loss: 0.4034444 Vali Loss: 0.4158454 Test Loss: 0.1719504
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3505897
	speed: 0.0292s/iter; left time: 164.4467s
	iters: 200, epoch: 6 | loss: 0.3062505
	speed: 0.0253s/iter; left time: 140.2878s
	iters: 300, epoch: 6 | loss: 0.2533628
	speed: 0.0239s/iter; left time: 129.9516s
	iters: 400, epoch: 6 | loss: 0.2425732
	speed: 0.0241s/iter; left time: 128.3661s
	iters: 500, epoch: 6 | loss: 0.2462756
	speed: 0.0242s/iter; left time: 126.4691s
	iters: 600, epoch: 6 | loss: 0.4773909
	speed: 0.0242s/iter; left time: 124.2368s
	iters: 700, epoch: 6 | loss: 0.3117829
	speed: 0.0240s/iter; left time: 120.7395s
	iters: 800, epoch: 6 | loss: 0.3200805
	speed: 0.0238s/iter; left time: 117.2564s
	iters: 900, epoch: 6 | loss: 0.2358246
	speed: 0.0236s/iter; left time: 114.2859s
	iters: 1000, epoch: 6 | loss: 0.2999772
	speed: 0.0236s/iter; left time: 111.5670s
	iters: 1100, epoch: 6 | loss: 0.9583436
	speed: 0.0235s/iter; left time: 108.9048s
Epoch: 6 cost time: 27.05907940864563
Epoch: 6, Steps: 1147 | Train Loss: 0.4004105 Vali Loss: 0.4161530 Test Loss: 0.1714857
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3214053
	speed: 0.0200s/iter; left time: 89.5619s
	iters: 200, epoch: 7 | loss: 1.3256792
	speed: 0.0179s/iter; left time: 78.7548s
	iters: 300, epoch: 7 | loss: 0.3001994
	speed: 0.0174s/iter; left time: 74.4451s
	iters: 400, epoch: 7 | loss: 0.2804822
	speed: 0.0175s/iter; left time: 73.3797s
	iters: 500, epoch: 7 | loss: 0.2496782
	speed: 0.0175s/iter; left time: 71.7583s
	iters: 600, epoch: 7 | loss: 0.4210423
	speed: 0.0175s/iter; left time: 69.7896s
	iters: 700, epoch: 7 | loss: 1.2374990
	speed: 0.0182s/iter; left time: 70.7665s
	iters: 800, epoch: 7 | loss: 0.2910090
	speed: 0.0194s/iter; left time: 73.4289s
	iters: 900, epoch: 7 | loss: 0.2150759
	speed: 0.0198s/iter; left time: 72.9755s
	iters: 1000, epoch: 7 | loss: 0.3425170
	speed: 0.0212s/iter; left time: 76.0162s
	iters: 1100, epoch: 7 | loss: 0.3282056
	speed: 0.0225s/iter; left time: 78.6443s
Epoch: 7 cost time: 26.317225694656372
Epoch: 7, Steps: 1147 | Train Loss: 0.3989007 Vali Loss: 0.4154878 Test Loss: 0.1711673
Validation loss decreased (0.415541 --> 0.415488).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2798672
	speed: 0.0362s/iter; left time: 121.1236s
	iters: 200, epoch: 8 | loss: 0.3758151
	speed: 0.0288s/iter; left time: 93.2529s
	iters: 300, epoch: 8 | loss: 0.2618092
	speed: 0.0270s/iter; left time: 84.9411s
	iters: 400, epoch: 8 | loss: 0.3075587
	speed: 0.0260s/iter; left time: 79.1527s
	iters: 500, epoch: 8 | loss: 0.2206554
	speed: 0.0253s/iter; left time: 74.3986s
	iters: 600, epoch: 8 | loss: 0.2435690
	speed: 0.0253s/iter; left time: 71.9760s
	iters: 700, epoch: 8 | loss: 1.4411056
	speed: 0.0260s/iter; left time: 71.2509s
	iters: 800, epoch: 8 | loss: 0.4106173
	speed: 0.0266s/iter; left time: 70.1611s
	iters: 900, epoch: 8 | loss: 0.3203830
	speed: 0.0267s/iter; left time: 67.9778s
	iters: 1000, epoch: 8 | loss: 0.2953169
	speed: 0.0275s/iter; left time: 67.2663s
	iters: 1100, epoch: 8 | loss: 0.2525047
	speed: 0.0272s/iter; left time: 63.7848s
Epoch: 8 cost time: 31.233849048614502
Epoch: 8, Steps: 1147 | Train Loss: 0.3979993 Vali Loss: 0.4157299 Test Loss: 0.1708367
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2766021
	speed: 0.0382s/iter; left time: 83.9272s
	iters: 200, epoch: 9 | loss: 0.2075129
	speed: 0.0357s/iter; left time: 74.7372s
	iters: 300, epoch: 9 | loss: 0.2165318
	speed: 0.0338s/iter; left time: 67.4628s
	iters: 400, epoch: 9 | loss: 0.2399983
	speed: 0.0332s/iter; left time: 62.8324s
	iters: 500, epoch: 9 | loss: 0.2140190
	speed: 0.0313s/iter; left time: 56.1042s
	iters: 600, epoch: 9 | loss: 0.3076876
	speed: 0.0298s/iter; left time: 50.5597s
	iters: 700, epoch: 9 | loss: 0.4039423
	speed: 0.0290s/iter; left time: 46.2685s
	iters: 800, epoch: 9 | loss: 0.3088804
	speed: 0.0287s/iter; left time: 42.9330s
	iters: 900, epoch: 9 | loss: 0.3137185
	speed: 0.0292s/iter; left time: 40.7320s
	iters: 1000, epoch: 9 | loss: 0.3714235
	speed: 0.0291s/iter; left time: 37.7394s
	iters: 1100, epoch: 9 | loss: 0.2278519
	speed: 0.0283s/iter; left time: 33.8457s
Epoch: 9 cost time: 32.20908737182617
Epoch: 9, Steps: 1147 | Train Loss: 0.3975098 Vali Loss: 0.4160503 Test Loss: 0.1711777
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 1.3343707
	speed: 0.0321s/iter; left time: 33.6288s
	iters: 200, epoch: 10 | loss: 0.2910399
	speed: 0.0298s/iter; left time: 28.2424s
	iters: 300, epoch: 10 | loss: 0.2322505
	speed: 0.0258s/iter; left time: 21.8883s
	iters: 400, epoch: 10 | loss: 0.4077266
	speed: 0.0239s/iter; left time: 17.9006s
	iters: 500, epoch: 10 | loss: 0.2486119
	speed: 0.0256s/iter; left time: 16.5712s
	iters: 600, epoch: 10 | loss: 0.1753310
	speed: 0.0254s/iter; left time: 13.9088s
	iters: 700, epoch: 10 | loss: 0.1863917
	speed: 0.0253s/iter; left time: 11.3418s
	iters: 800, epoch: 10 | loss: 1.0119824
	speed: 0.0253s/iter; left time: 8.7957s
	iters: 900, epoch: 10 | loss: 0.4477792
	speed: 0.0255s/iter; left time: 6.3352s
	iters: 1000, epoch: 10 | loss: 0.2844977
	speed: 0.0251s/iter; left time: 3.7154s
	iters: 1100, epoch: 10 | loss: 0.3566330
	speed: 0.0248s/iter; left time: 1.1911s
Epoch: 10 cost time: 28.371212482452393
Epoch: 10, Steps: 1147 | Train Loss: 0.3970817 Vali Loss: 0.4160076 Test Loss: 0.1709840
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.17116722464561462, mae:0.21547645330429077
Use GPU: cuda:0
no_skip False
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.3594613
	speed: 0.0281s/iter; left time: 320.0779s
	iters: 200, epoch: 1 | loss: 0.4081229
	speed: 0.0259s/iter; left time: 291.5536s
	iters: 300, epoch: 1 | loss: 0.4061143
	speed: 0.0275s/iter; left time: 307.3656s
	iters: 400, epoch: 1 | loss: 0.4020498
	speed: 0.0285s/iter; left time: 315.1221s
	iters: 500, epoch: 1 | loss: 0.4448388
	speed: 0.0286s/iter; left time: 313.8340s
	iters: 600, epoch: 1 | loss: 0.3624960
	speed: 0.0290s/iter; left time: 314.7761s
	iters: 700, epoch: 1 | loss: 0.3087635
	speed: 0.0280s/iter; left time: 301.8575s
	iters: 800, epoch: 1 | loss: 0.4128844
	speed: 0.0272s/iter; left time: 290.4111s
	iters: 900, epoch: 1 | loss: 0.5625511
	speed: 0.0273s/iter; left time: 288.2263s
	iters: 1000, epoch: 1 | loss: 0.4138797
	speed: 0.0274s/iter; left time: 286.8846s
	iters: 1100, epoch: 1 | loss: 0.3042746
	speed: 0.0269s/iter; left time: 279.2254s
Epoch: 1 cost time: 30.76092839241028
Epoch: 1, Steps: 1147 | Train Loss: 0.4963652 Vali Loss: 0.4596184 Test Loss: 0.1880369
Validation loss decreased (inf --> 0.459618).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3666892
	speed: 0.0385s/iter; left time: 393.5181s
	iters: 200, epoch: 2 | loss: 0.3131632
	speed: 0.0322s/iter; left time: 326.1013s
	iters: 300, epoch: 2 | loss: 0.2649770
	speed: 0.0304s/iter; left time: 304.7752s
	iters: 400, epoch: 2 | loss: 1.1920071
	speed: 0.0306s/iter; left time: 303.7656s
	iters: 500, epoch: 2 | loss: 0.2886029
	speed: 0.0307s/iter; left time: 301.9551s
	iters: 600, epoch: 2 | loss: 0.3902960
	speed: 0.0304s/iter; left time: 295.7066s
	iters: 700, epoch: 2 | loss: 0.3747149
	speed: 0.0290s/iter; left time: 279.0468s
	iters: 800, epoch: 2 | loss: 0.4716673
	speed: 0.0275s/iter; left time: 261.6081s
	iters: 900, epoch: 2 | loss: 0.2136585
	speed: 0.0262s/iter; left time: 247.2769s
	iters: 1000, epoch: 2 | loss: 0.2608796
	speed: 0.0253s/iter; left time: 236.1127s
	iters: 1100, epoch: 2 | loss: 0.3910395
	speed: 0.0247s/iter; left time: 227.4738s
Epoch: 2 cost time: 28.1998074054718
Epoch: 2, Steps: 1147 | Train Loss: 0.4441293 Vali Loss: 0.4290438 Test Loss: 0.1790927
Validation loss decreased (0.459618 --> 0.429044).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3937735
	speed: 0.0386s/iter; left time: 349.9714s
	iters: 200, epoch: 3 | loss: 0.2921934
	speed: 0.0325s/iter; left time: 291.5117s
	iters: 300, epoch: 3 | loss: 0.3640135
	speed: 0.0292s/iter; left time: 259.2518s
	iters: 400, epoch: 3 | loss: 0.2518901
	speed: 0.0275s/iter; left time: 241.2841s
	iters: 500, epoch: 3 | loss: 0.3270385
	speed: 0.0264s/iter; left time: 229.3527s
	iters: 600, epoch: 3 | loss: 0.2952483
	speed: 0.0262s/iter; left time: 224.4446s
	iters: 700, epoch: 3 | loss: 0.4966957
	speed: 0.0257s/iter; left time: 217.6507s
	iters: 800, epoch: 3 | loss: 0.3169917
	speed: 0.0252s/iter; left time: 211.3091s
	iters: 900, epoch: 3 | loss: 0.2307659
	speed: 0.0246s/iter; left time: 203.6520s
	iters: 1000, epoch: 3 | loss: 0.3006184
	speed: 0.0243s/iter; left time: 198.5686s
	iters: 1100, epoch: 3 | loss: 0.2820539
	speed: 0.0241s/iter; left time: 194.8625s
Epoch: 3 cost time: 27.710615158081055
Epoch: 3, Steps: 1147 | Train Loss: 0.4246861 Vali Loss: 0.4258462 Test Loss: 0.1762650
Validation loss decreased (0.429044 --> 0.425846).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 1.2344255
	speed: 0.0432s/iter; left time: 342.8984s
	iters: 200, epoch: 4 | loss: 0.3585077
	speed: 0.0383s/iter; left time: 299.9143s
	iters: 300, epoch: 4 | loss: 0.3951108
	speed: 0.0331s/iter; left time: 255.7791s
	iters: 400, epoch: 4 | loss: 0.2754170
	speed: 0.0299s/iter; left time: 228.3436s
	iters: 500, epoch: 4 | loss: 0.3426228
	speed: 0.0277s/iter; left time: 208.6136s
	iters: 600, epoch: 4 | loss: 0.2337009
	speed: 0.0267s/iter; left time: 198.6789s
	iters: 700, epoch: 4 | loss: 0.2798617
	speed: 0.0261s/iter; left time: 191.2258s
	iters: 800, epoch: 4 | loss: 0.3356530
	speed: 0.0264s/iter; left time: 191.0064s
	iters: 900, epoch: 4 | loss: 0.3057665
	speed: 0.0268s/iter; left time: 191.3348s
	iters: 1000, epoch: 4 | loss: 0.4365973
	speed: 0.0264s/iter; left time: 185.4838s
	iters: 1100, epoch: 4 | loss: 1.3143538
	speed: 0.0260s/iter; left time: 180.3368s
Epoch: 4 cost time: 29.801111936569214
Epoch: 4, Steps: 1147 | Train Loss: 0.4136111 Vali Loss: 0.4193773 Test Loss: 0.1728907
Validation loss decreased (0.425846 --> 0.419377).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2444936
	speed: 0.0331s/iter; left time: 224.7923s
	iters: 200, epoch: 5 | loss: 0.3108418
	speed: 0.0302s/iter; left time: 201.5863s
	iters: 300, epoch: 5 | loss: 1.2322090
	speed: 0.0276s/iter; left time: 181.6239s
	iters: 400, epoch: 5 | loss: 0.3277350
	speed: 0.0261s/iter; left time: 169.1405s
	iters: 500, epoch: 5 | loss: 0.3526009
	speed: 0.0248s/iter; left time: 158.2355s
	iters: 600, epoch: 5 | loss: 0.3191217
	speed: 0.0242s/iter; left time: 152.2253s
	iters: 700, epoch: 5 | loss: 0.2244774
	speed: 0.0239s/iter; left time: 147.5824s
	iters: 800, epoch: 5 | loss: 0.3274853
	speed: 0.0236s/iter; left time: 143.3103s
	iters: 900, epoch: 5 | loss: 0.2677986
	speed: 0.0233s/iter; left time: 139.5843s
	iters: 1000, epoch: 5 | loss: 0.4953298
	speed: 0.0228s/iter; left time: 133.9641s
	iters: 1100, epoch: 5 | loss: 0.3000821
	speed: 0.0222s/iter; left time: 128.2208s
Epoch: 5 cost time: 25.319189310073853
Epoch: 5, Steps: 1147 | Train Loss: 0.4066733 Vali Loss: 0.4219539 Test Loss: 0.1727226
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2393993
	speed: 0.0428s/iter; left time: 241.1264s
	iters: 200, epoch: 6 | loss: 0.3047190
	speed: 0.0327s/iter; left time: 181.2771s
	iters: 300, epoch: 6 | loss: 0.3692326
	speed: 0.0302s/iter; left time: 164.1073s
	iters: 400, epoch: 6 | loss: 0.4175833
	speed: 0.0296s/iter; left time: 157.7156s
	iters: 500, epoch: 6 | loss: 0.3088737
	speed: 0.0282s/iter; left time: 147.6748s
	iters: 600, epoch: 6 | loss: 0.3238167
	speed: 0.0273s/iter; left time: 140.3441s
	iters: 700, epoch: 6 | loss: 0.3497541
	speed: 0.0266s/iter; left time: 133.7204s
	iters: 800, epoch: 6 | loss: 0.2888741
	speed: 0.0267s/iter; left time: 131.6554s
	iters: 900, epoch: 6 | loss: 0.3531938
	speed: 0.0262s/iter; left time: 126.4980s
	iters: 1000, epoch: 6 | loss: 0.3131543
	speed: 0.0257s/iter; left time: 121.9300s
	iters: 1100, epoch: 6 | loss: 0.2312545
	speed: 0.0256s/iter; left time: 118.6544s
Epoch: 6 cost time: 30.08834409713745
Epoch: 6, Steps: 1147 | Train Loss: 0.4038588 Vali Loss: 0.4227484 Test Loss: 0.1726727
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 1.3580757
	speed: 0.0278s/iter; left time: 124.9025s
	iters: 200, epoch: 7 | loss: 0.3092993
	speed: 0.0252s/iter; left time: 110.4472s
	iters: 300, epoch: 7 | loss: 0.3220949
	speed: 0.0242s/iter; left time: 103.7809s
	iters: 400, epoch: 7 | loss: 0.4183457
	speed: 0.0230s/iter; left time: 96.3446s
	iters: 500, epoch: 7 | loss: 0.4767917
	speed: 0.0223s/iter; left time: 91.2382s
	iters: 600, epoch: 7 | loss: 0.2113047
	speed: 0.0220s/iter; left time: 87.6395s
	iters: 700, epoch: 7 | loss: 0.2981480
	speed: 0.0216s/iter; left time: 83.8846s
	iters: 800, epoch: 7 | loss: 0.2630461
	speed: 0.0217s/iter; left time: 82.0729s
	iters: 900, epoch: 7 | loss: 0.3373155
	speed: 0.0218s/iter; left time: 80.3051s
	iters: 1000, epoch: 7 | loss: 0.3809437
	speed: 0.0219s/iter; left time: 78.4737s
	iters: 1100, epoch: 7 | loss: 0.3127280
	speed: 0.0219s/iter; left time: 76.4399s
Epoch: 7 cost time: 25.37569761276245
Epoch: 7, Steps: 1147 | Train Loss: 0.4020839 Vali Loss: 0.4223410 Test Loss: 0.1720986
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3063244
	speed: 0.0350s/iter; left time: 117.1187s
	iters: 200, epoch: 8 | loss: 0.2553870
	speed: 0.0360s/iter; left time: 116.8035s
	iters: 300, epoch: 8 | loss: 0.2732819
	speed: 0.0328s/iter; left time: 103.1392s
	iters: 400, epoch: 8 | loss: 0.3187521
	speed: 0.0296s/iter; left time: 89.9946s
	iters: 500, epoch: 8 | loss: 1.0506247
	speed: 0.0284s/iter; left time: 83.6649s
	iters: 600, epoch: 8 | loss: 0.3609634
	speed: 0.0281s/iter; left time: 79.7706s
	iters: 700, epoch: 8 | loss: 1.2639256
	speed: 0.0267s/iter; left time: 73.3134s
	iters: 800, epoch: 8 | loss: 0.3156178
	speed: 0.0257s/iter; left time: 67.8086s
	iters: 900, epoch: 8 | loss: 0.2640249
	speed: 0.0247s/iter; left time: 62.7240s
	iters: 1000, epoch: 8 | loss: 0.2631883
	speed: 0.0241s/iter; left time: 58.8335s
	iters: 1100, epoch: 8 | loss: 0.3267893
	speed: 0.0237s/iter; left time: 55.4855s
Epoch: 8 cost time: 27.283443927764893
Epoch: 8, Steps: 1147 | Train Loss: 0.4012046 Vali Loss: 0.4223103 Test Loss: 0.1723126
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3267866
	speed: 0.0237s/iter; left time: 51.9944s
	iters: 200, epoch: 9 | loss: 0.2915162
	speed: 0.0212s/iter; left time: 44.4592s
	iters: 300, epoch: 9 | loss: 0.2580994
	speed: 0.0205s/iter; left time: 40.8270s
	iters: 400, epoch: 9 | loss: 0.3632917
	speed: 0.0208s/iter; left time: 39.4639s
	iters: 500, epoch: 9 | loss: 0.5268681
	speed: 0.0206s/iter; left time: 36.9853s
	iters: 600, epoch: 9 | loss: 0.3046007
	speed: 0.0204s/iter; left time: 34.4935s
	iters: 700, epoch: 9 | loss: 0.3951261
	speed: 0.0206s/iter; left time: 32.8357s
	iters: 800, epoch: 9 | loss: 0.3287334
	speed: 0.0211s/iter; left time: 31.5430s
	iters: 900, epoch: 9 | loss: 0.2674544
	speed: 0.0213s/iter; left time: 29.6975s
	iters: 1000, epoch: 9 | loss: 1.2642776
	speed: 0.0214s/iter; left time: 27.7321s
	iters: 1100, epoch: 9 | loss: 0.2812001
	speed: 0.0215s/iter; left time: 25.7133s
Epoch: 9 cost time: 24.811872005462646
Epoch: 9, Steps: 1147 | Train Loss: 0.4007913 Vali Loss: 0.4225951 Test Loss: 0.1722654
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.17289060354232788, mae:0.21632659435272217
Use GPU: cuda:0
no_skip False
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 2.4460006
	speed: 0.0252s/iter; left time: 286.4599s
	iters: 200, epoch: 1 | loss: 0.4408463
	speed: 0.0226s/iter; left time: 254.8705s
	iters: 300, epoch: 1 | loss: 0.2667561
	speed: 0.0220s/iter; left time: 245.8525s
	iters: 400, epoch: 1 | loss: 0.3380446
	speed: 0.0219s/iter; left time: 242.8840s
	iters: 500, epoch: 1 | loss: 0.3939415
	speed: 0.0221s/iter; left time: 242.0476s
	iters: 600, epoch: 1 | loss: 0.5798035
	speed: 0.0240s/iter; left time: 260.4999s
	iters: 700, epoch: 1 | loss: 0.3263938
	speed: 0.0252s/iter; left time: 271.3620s
	iters: 800, epoch: 1 | loss: 0.3643956
	speed: 0.0250s/iter; left time: 266.9959s
	iters: 900, epoch: 1 | loss: 0.3685055
	speed: 0.0247s/iter; left time: 261.0483s
	iters: 1000, epoch: 1 | loss: 0.4635666
	speed: 0.0254s/iter; left time: 266.4091s
	iters: 1100, epoch: 1 | loss: 0.3002442
	speed: 0.0265s/iter; left time: 275.2817s
Epoch: 1 cost time: 30.588412523269653
Epoch: 1, Steps: 1147 | Train Loss: 0.4934601 Vali Loss: 0.4634703 Test Loss: 0.1889559
Validation loss decreased (inf --> 0.463470).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3674775
	speed: 0.0270s/iter; left time: 276.3142s
	iters: 200, epoch: 2 | loss: 0.4220693
	speed: 0.0247s/iter; left time: 250.2172s
	iters: 300, epoch: 2 | loss: 0.3888342
	speed: 0.0237s/iter; left time: 237.6617s
	iters: 400, epoch: 2 | loss: 0.2460774
	speed: 0.0262s/iter; left time: 259.9396s
	iters: 500, epoch: 2 | loss: 0.3084846
	speed: 0.0285s/iter; left time: 279.9945s
	iters: 600, epoch: 2 | loss: 0.4920389
	speed: 0.0301s/iter; left time: 292.9310s
	iters: 700, epoch: 2 | loss: 1.3845472
	speed: 0.0291s/iter; left time: 280.0271s
	iters: 800, epoch: 2 | loss: 0.6050410
	speed: 0.0276s/iter; left time: 263.2289s
	iters: 900, epoch: 2 | loss: 0.3439168
	speed: 0.0265s/iter; left time: 249.6342s
	iters: 1000, epoch: 2 | loss: 0.3638853
	speed: 0.0256s/iter; left time: 238.7233s
	iters: 1100, epoch: 2 | loss: 1.2607951
	speed: 0.0246s/iter; left time: 226.9686s
Epoch: 2 cost time: 27.938743352890015
Epoch: 2, Steps: 1147 | Train Loss: 0.4427091 Vali Loss: 0.4225384 Test Loss: 0.1753873
Validation loss decreased (0.463470 --> 0.422538).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2868739
	speed: 0.0417s/iter; left time: 378.5762s
	iters: 200, epoch: 3 | loss: 1.2090951
	speed: 0.0412s/iter; left time: 369.6681s
	iters: 300, epoch: 3 | loss: 0.2742689
	speed: 0.0395s/iter; left time: 350.6287s
	iters: 400, epoch: 3 | loss: 0.3948124
	speed: 0.0383s/iter; left time: 336.0001s
	iters: 500, epoch: 3 | loss: 0.3525519
	speed: 0.0380s/iter; left time: 330.0890s
	iters: 600, epoch: 3 | loss: 1.2603264
	speed: 0.0376s/iter; left time: 322.6904s
	iters: 700, epoch: 3 | loss: 0.3144358
	speed: 0.0359s/iter; left time: 304.1227s
	iters: 800, epoch: 3 | loss: 0.3002984
	speed: 0.0339s/iter; left time: 284.0021s
	iters: 900, epoch: 3 | loss: 0.3985496
	speed: 0.0329s/iter; left time: 272.6025s
	iters: 1000, epoch: 3 | loss: 1.2099705
	speed: 0.0321s/iter; left time: 262.7971s
	iters: 1100, epoch: 3 | loss: 0.5940977
	speed: 0.0311s/iter; left time: 251.3382s
Epoch: 3 cost time: 35.40804719924927
Epoch: 3, Steps: 1147 | Train Loss: 0.4193045 Vali Loss: 0.4153650 Test Loss: 0.1714780
Validation loss decreased (0.422538 --> 0.415365).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2829773
	speed: 0.0408s/iter; left time: 323.2827s
	iters: 200, epoch: 4 | loss: 0.3457523
	speed: 0.0377s/iter; left time: 295.1648s
	iters: 300, epoch: 4 | loss: 0.3256093
	speed: 0.0345s/iter; left time: 266.5084s
	iters: 400, epoch: 4 | loss: 1.2970561
	speed: 0.0319s/iter; left time: 243.0166s
	iters: 500, epoch: 4 | loss: 1.2353623
	speed: 0.0298s/iter; left time: 224.1024s
	iters: 600, epoch: 4 | loss: 0.8461047
	speed: 0.0280s/iter; left time: 207.7192s
	iters: 700, epoch: 4 | loss: 0.2652306
	speed: 0.0268s/iter; left time: 196.8023s
	iters: 800, epoch: 4 | loss: 0.4681816
	speed: 0.0259s/iter; left time: 187.5803s
	iters: 900, epoch: 4 | loss: 0.3151909
	speed: 0.0253s/iter; left time: 180.1180s
	iters: 1000, epoch: 4 | loss: 0.2894222
	speed: 0.0253s/iter; left time: 177.7391s
	iters: 1100, epoch: 4 | loss: 0.3436044
	speed: 0.0254s/iter; left time: 176.2783s
Epoch: 4 cost time: 29.25439214706421
Epoch: 4, Steps: 1147 | Train Loss: 0.4099272 Vali Loss: 0.4111077 Test Loss: 0.1713312
Validation loss decreased (0.415365 --> 0.411108).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3314513
	speed: 0.0291s/iter; left time: 197.5786s
	iters: 200, epoch: 5 | loss: 0.3257824
	speed: 0.0311s/iter; left time: 207.8203s
	iters: 300, epoch: 5 | loss: 0.2588187
	speed: 0.0285s/iter; left time: 187.6372s
	iters: 400, epoch: 5 | loss: 0.2492472
	speed: 0.0272s/iter; left time: 176.0492s
	iters: 500, epoch: 5 | loss: 1.4642993
	speed: 0.0263s/iter; left time: 167.8002s
	iters: 600, epoch: 5 | loss: 0.4343305
	speed: 0.0249s/iter; left time: 156.6493s
	iters: 700, epoch: 5 | loss: 0.2608902
	speed: 0.0239s/iter; left time: 147.8533s
	iters: 800, epoch: 5 | loss: 0.3173211
	speed: 0.0240s/iter; left time: 145.7268s
	iters: 900, epoch: 5 | loss: 0.2749521
	speed: 0.0239s/iter; left time: 143.2345s
	iters: 1000, epoch: 5 | loss: 0.2753196
	speed: 0.0233s/iter; left time: 137.0404s
	iters: 1100, epoch: 5 | loss: 0.3323269
	speed: 0.0231s/iter; left time: 133.5799s
Epoch: 5 cost time: 26.53990864753723
Epoch: 5, Steps: 1147 | Train Loss: 0.4033983 Vali Loss: 0.4138950 Test Loss: 0.1712072
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2581297
	speed: 0.0318s/iter; left time: 179.0357s
	iters: 200, epoch: 6 | loss: 1.0301154
	speed: 0.0299s/iter; left time: 165.2701s
	iters: 300, epoch: 6 | loss: 0.2747283
	speed: 0.0322s/iter; left time: 174.9150s
	iters: 400, epoch: 6 | loss: 0.3082413
	speed: 0.0327s/iter; left time: 174.3910s
	iters: 500, epoch: 6 | loss: 0.3374952
	speed: 0.0316s/iter; left time: 165.5356s
	iters: 600, epoch: 6 | loss: 0.3380142
	speed: 0.0301s/iter; left time: 154.7045s
	iters: 700, epoch: 6 | loss: 0.2321508
	speed: 0.0288s/iter; left time: 144.9347s
	iters: 800, epoch: 6 | loss: 0.3119845
	speed: 0.0277s/iter; left time: 136.7011s
	iters: 900, epoch: 6 | loss: 0.2539663
	speed: 0.0270s/iter; left time: 130.7271s
	iters: 1000, epoch: 6 | loss: 0.1820570
	speed: 0.0264s/iter; left time: 125.2616s
	iters: 1100, epoch: 6 | loss: 0.2233404
	speed: 0.0274s/iter; left time: 126.8451s
Epoch: 6 cost time: 31.899682760238647
Epoch: 6, Steps: 1147 | Train Loss: 0.4000595 Vali Loss: 0.4140237 Test Loss: 0.1704167
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2526924
	speed: 0.0365s/iter; left time: 164.0205s
	iters: 200, epoch: 7 | loss: 0.2696760
	speed: 0.0359s/iter; left time: 157.5434s
	iters: 300, epoch: 7 | loss: 0.3139043
	speed: 0.0351s/iter; left time: 150.5339s
	iters: 400, epoch: 7 | loss: 0.4336279
	speed: 0.0327s/iter; left time: 136.9556s
	iters: 500, epoch: 7 | loss: 0.2701569
	speed: 0.0310s/iter; left time: 126.8982s
	iters: 600, epoch: 7 | loss: 0.4146038
	speed: 0.0296s/iter; left time: 118.1498s
	iters: 700, epoch: 7 | loss: 0.3466359
	speed: 0.0283s/iter; left time: 110.0632s
	iters: 800, epoch: 7 | loss: 0.2735797
	speed: 0.0273s/iter; left time: 103.5518s
	iters: 900, epoch: 7 | loss: 0.3344308
	speed: 0.0268s/iter; left time: 98.7163s
	iters: 1000, epoch: 7 | loss: 1.0858147
	speed: 0.0263s/iter; left time: 94.3314s
	iters: 1100, epoch: 7 | loss: 0.2865071
	speed: 0.0259s/iter; left time: 90.3076s
Epoch: 7 cost time: 29.74431037902832
Epoch: 7, Steps: 1147 | Train Loss: 0.3985563 Vali Loss: 0.4148465 Test Loss: 0.1702542
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2943325
	speed: 0.0252s/iter; left time: 84.0683s
	iters: 200, epoch: 8 | loss: 0.4390179
	speed: 0.0237s/iter; left time: 76.7070s
	iters: 300, epoch: 8 | loss: 0.2662043
	speed: 0.0231s/iter; left time: 72.6398s
	iters: 400, epoch: 8 | loss: 0.3260260
	speed: 0.0225s/iter; left time: 68.5087s
	iters: 500, epoch: 8 | loss: 0.2644777
	speed: 0.0236s/iter; left time: 69.5539s
	iters: 600, epoch: 8 | loss: 0.3297343
	speed: 0.0227s/iter; left time: 64.6481s
	iters: 700, epoch: 8 | loss: 0.2417956
	speed: 0.0223s/iter; left time: 61.2792s
	iters: 800, epoch: 8 | loss: 0.3383527
	speed: 0.0230s/iter; left time: 60.8010s
	iters: 900, epoch: 8 | loss: 0.4989130
	speed: 0.0228s/iter; left time: 57.9527s
	iters: 1000, epoch: 8 | loss: 0.2669767
	speed: 0.0223s/iter; left time: 54.4450s
	iters: 1100, epoch: 8 | loss: 0.4145022
	speed: 0.0222s/iter; left time: 51.9894s
Epoch: 8 cost time: 25.586811780929565
Epoch: 8, Steps: 1147 | Train Loss: 0.3975905 Vali Loss: 0.4150673 Test Loss: 0.1701567
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 1.2407043
	speed: 0.0240s/iter; left time: 52.6489s
	iters: 200, epoch: 9 | loss: 0.3204675
	speed: 0.0215s/iter; left time: 44.9984s
	iters: 300, epoch: 9 | loss: 0.3884983
	speed: 0.0212s/iter; left time: 42.3085s
	iters: 400, epoch: 9 | loss: 0.3973800
	speed: 0.0206s/iter; left time: 39.1151s
	iters: 500, epoch: 9 | loss: 0.3684871
	speed: 0.0214s/iter; left time: 38.4585s
	iters: 600, epoch: 9 | loss: 0.3168747
	speed: 0.0215s/iter; left time: 36.4863s
	iters: 700, epoch: 9 | loss: 1.2748142
	speed: 0.0236s/iter; left time: 37.6320s
	iters: 800, epoch: 9 | loss: 0.4173290
	speed: 0.0255s/iter; left time: 38.0754s
	iters: 900, epoch: 9 | loss: 0.2568036
	speed: 0.0267s/iter; left time: 37.2197s
	iters: 1000, epoch: 9 | loss: 0.3519510
	speed: 0.0277s/iter; left time: 35.9168s
	iters: 1100, epoch: 9 | loss: 0.2889819
	speed: 0.0286s/iter; left time: 34.1585s
Epoch: 9 cost time: 33.33534002304077
Epoch: 9, Steps: 1147 | Train Loss: 0.3972352 Vali Loss: 0.4146681 Test Loss: 0.1699962
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.17133113741874695, mae:0.21527524292469025
Seed: 42
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_192      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip False
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.4901747
	speed: 0.0564s/iter; left time: 639.7333s
	iters: 200, epoch: 1 | loss: 0.7435262
	speed: 0.0472s/iter; left time: 530.0923s
	iters: 300, epoch: 1 | loss: 0.3858164
	speed: 0.0436s/iter; left time: 485.2506s
	iters: 400, epoch: 1 | loss: 0.6816621
	speed: 0.0384s/iter; left time: 423.9124s
	iters: 500, epoch: 1 | loss: 0.4003650
	speed: 0.0351s/iter; left time: 384.5212s
	iters: 600, epoch: 1 | loss: 0.9381112
	speed: 0.0329s/iter; left time: 356.4825s
	iters: 700, epoch: 1 | loss: 0.4054588
	speed: 0.0314s/iter; left time: 337.2543s
	iters: 800, epoch: 1 | loss: 0.4452380
	speed: 0.0319s/iter; left time: 339.9557s
	iters: 900, epoch: 1 | loss: 0.8561926
	speed: 0.0308s/iter; left time: 324.2489s
	iters: 1000, epoch: 1 | loss: 0.3541325
	speed: 0.0292s/iter; left time: 304.6031s
	iters: 1100, epoch: 1 | loss: 0.4690910
	speed: 0.0279s/iter; left time: 288.5337s
Epoch: 1 cost time: 31.39638042449951
Epoch: 1, Steps: 1144 | Train Loss: 0.5520420 Vali Loss: 0.5160847 Test Loss: 0.2323644
Validation loss decreased (inf --> 0.516085).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3859776
	speed: 0.0252s/iter; left time: 257.2662s
	iters: 200, epoch: 2 | loss: 0.9335037
	speed: 0.0236s/iter; left time: 238.1374s
	iters: 300, epoch: 2 | loss: 0.8845428
	speed: 0.0234s/iter; left time: 233.8896s
	iters: 400, epoch: 2 | loss: 0.4371114
	speed: 0.0230s/iter; left time: 227.8394s
	iters: 500, epoch: 2 | loss: 0.9350108
	speed: 0.0229s/iter; left time: 224.3329s
	iters: 600, epoch: 2 | loss: 0.5710170
	speed: 0.0228s/iter; left time: 221.4670s
	iters: 700, epoch: 2 | loss: 0.4581462
	speed: 0.0231s/iter; left time: 221.8966s
	iters: 800, epoch: 2 | loss: 0.4715916
	speed: 0.0233s/iter; left time: 220.9377s
	iters: 900, epoch: 2 | loss: 0.4383393
	speed: 0.0233s/iter; left time: 219.2932s
	iters: 1000, epoch: 2 | loss: 0.3116375
	speed: 0.0239s/iter; left time: 222.2165s
	iters: 1100, epoch: 2 | loss: 0.3768076
	speed: 0.0238s/iter; left time: 218.8263s
Epoch: 2 cost time: 27.29442024230957
Epoch: 2, Steps: 1144 | Train Loss: 0.5094348 Vali Loss: 0.5088181 Test Loss: 0.2268958
Validation loss decreased (0.516085 --> 0.508818).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 1.3722056
	speed: 0.0415s/iter; left time: 375.8624s
	iters: 200, epoch: 3 | loss: 0.3692428
	speed: 0.0340s/iter; left time: 303.9993s
	iters: 300, epoch: 3 | loss: 0.4503229
	speed: 0.0302s/iter; left time: 267.4608s
	iters: 400, epoch: 3 | loss: 0.2881182
	speed: 0.0282s/iter; left time: 246.9254s
	iters: 500, epoch: 3 | loss: 0.3648612
	speed: 0.0270s/iter; left time: 233.6724s
	iters: 600, epoch: 3 | loss: 0.2965137
	speed: 0.0262s/iter; left time: 224.3470s
	iters: 700, epoch: 3 | loss: 0.5232442
	speed: 0.0258s/iter; left time: 217.7338s
	iters: 800, epoch: 3 | loss: 0.3538482
	speed: 0.0256s/iter; left time: 214.1926s
	iters: 900, epoch: 3 | loss: 0.5094897
	speed: 0.0256s/iter; left time: 211.1953s
	iters: 1000, epoch: 3 | loss: 0.4096689
	speed: 0.0252s/iter; left time: 205.8600s
	iters: 1100, epoch: 3 | loss: 0.4130232
	speed: 0.0250s/iter; left time: 201.3570s
Epoch: 3 cost time: 28.65324878692627
Epoch: 3, Steps: 1144 | Train Loss: 0.4915102 Vali Loss: 0.4893529 Test Loss: 0.2214918
Validation loss decreased (0.508818 --> 0.489353).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3508957
	speed: 0.0377s/iter; left time: 298.0140s
	iters: 200, epoch: 4 | loss: 0.4305241
	speed: 0.0324s/iter; left time: 253.0004s
	iters: 300, epoch: 4 | loss: 0.3400032
	speed: 0.0298s/iter; left time: 230.0642s
	iters: 400, epoch: 4 | loss: 0.5329911
	speed: 0.0279s/iter; left time: 212.3852s
	iters: 500, epoch: 4 | loss: 0.3156011
	speed: 0.0267s/iter; left time: 200.4366s
	iters: 600, epoch: 4 | loss: 0.2929552
	speed: 0.0260s/iter; left time: 192.7129s
	iters: 700, epoch: 4 | loss: 0.3379356
	speed: 0.0255s/iter; left time: 186.6586s
	iters: 800, epoch: 4 | loss: 0.3927117
	speed: 0.0249s/iter; left time: 179.8048s
	iters: 900, epoch: 4 | loss: 0.4084876
	speed: 0.0243s/iter; left time: 172.4173s
	iters: 1000, epoch: 4 | loss: 0.4325804
	speed: 0.0245s/iter; left time: 171.4308s
	iters: 1100, epoch: 4 | loss: 0.8779835
	speed: 0.0239s/iter; left time: 164.9512s
Epoch: 4 cost time: 27.211243391036987
Epoch: 4, Steps: 1144 | Train Loss: 0.4804859 Vali Loss: 0.4905100 Test Loss: 0.2200025
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3608007
	speed: 0.0272s/iter; left time: 183.8487s
	iters: 200, epoch: 5 | loss: 0.3599046
	speed: 0.0249s/iter; left time: 165.8118s
	iters: 300, epoch: 5 | loss: 0.3330230
	speed: 0.0275s/iter; left time: 180.6196s
	iters: 400, epoch: 5 | loss: 0.8288358
	speed: 0.0283s/iter; left time: 182.9449s
	iters: 500, epoch: 5 | loss: 0.3640120
	speed: 0.0290s/iter; left time: 184.6341s
	iters: 600, epoch: 5 | loss: 0.3867189
	speed: 0.0294s/iter; left time: 184.3796s
	iters: 700, epoch: 5 | loss: 0.3409403
	speed: 0.0297s/iter; left time: 183.2745s
	iters: 800, epoch: 5 | loss: 0.4380039
	speed: 0.0288s/iter; left time: 174.7235s
	iters: 900, epoch: 5 | loss: 0.4240873
	speed: 0.0282s/iter; left time: 168.0156s
	iters: 1000, epoch: 5 | loss: 0.8283042
	speed: 0.0276s/iter; left time: 161.9082s
	iters: 1100, epoch: 5 | loss: 0.9408407
	speed: 0.0276s/iter; left time: 158.9856s
Epoch: 5 cost time: 31.621729135513306
Epoch: 5, Steps: 1144 | Train Loss: 0.4744761 Vali Loss: 0.4887377 Test Loss: 0.2199396
Validation loss decreased (0.489353 --> 0.488738).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3266383
	speed: 0.0374s/iter; left time: 210.1610s
	iters: 200, epoch: 6 | loss: 0.8491409
	speed: 0.0359s/iter; left time: 198.0665s
	iters: 300, epoch: 6 | loss: 0.4424684
	speed: 0.0363s/iter; left time: 196.7216s
	iters: 400, epoch: 6 | loss: 0.4319217
	speed: 0.0348s/iter; left time: 185.2492s
	iters: 500, epoch: 6 | loss: 0.3896566
	speed: 0.0324s/iter; left time: 169.0740s
	iters: 600, epoch: 6 | loss: 0.4060411
	speed: 0.0314s/iter; left time: 160.9385s
	iters: 700, epoch: 6 | loss: 0.3503375
	speed: 0.0313s/iter; left time: 157.1890s
	iters: 800, epoch: 6 | loss: 0.9672877
	speed: 0.0306s/iter; left time: 150.6513s
	iters: 900, epoch: 6 | loss: 0.3733121
	speed: 0.0297s/iter; left time: 143.0713s
	iters: 1000, epoch: 6 | loss: 0.3790475
	speed: 0.0289s/iter; left time: 136.6190s
	iters: 1100, epoch: 6 | loss: 0.6308179
	speed: 0.0283s/iter; left time: 130.9138s
Epoch: 6 cost time: 32.271772623062134
Epoch: 6, Steps: 1144 | Train Loss: 0.4711876 Vali Loss: 0.4879080 Test Loss: 0.2194302
Validation loss decreased (0.488738 --> 0.487908).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2552036
	speed: 0.0352s/iter; left time: 157.4893s
	iters: 200, epoch: 7 | loss: 0.3415649
	speed: 0.0299s/iter; left time: 131.0667s
	iters: 300, epoch: 7 | loss: 0.3690846
	speed: 0.0283s/iter; left time: 120.8259s
	iters: 400, epoch: 7 | loss: 0.3492259
	speed: 0.0273s/iter; left time: 114.1095s
	iters: 500, epoch: 7 | loss: 0.4705847
	speed: 0.0268s/iter; left time: 109.3257s
	iters: 600, epoch: 7 | loss: 0.2986299
	speed: 0.0256s/iter; left time: 101.6383s
	iters: 700, epoch: 7 | loss: 0.5255210
	speed: 0.0244s/iter; left time: 94.4835s
	iters: 800, epoch: 7 | loss: 0.3839417
	speed: 0.0243s/iter; left time: 91.8389s
	iters: 900, epoch: 7 | loss: 0.4943166
	speed: 0.0238s/iter; left time: 87.3445s
	iters: 1000, epoch: 7 | loss: 0.3576598
	speed: 0.0231s/iter; left time: 82.7045s
	iters: 1100, epoch: 7 | loss: 0.3553210
	speed: 0.0228s/iter; left time: 79.2738s
Epoch: 7 cost time: 26.280243396759033
Epoch: 7, Steps: 1144 | Train Loss: 0.4698427 Vali Loss: 0.4884290 Test Loss: 0.2195491
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3871096
	speed: 0.0276s/iter; left time: 91.8655s
	iters: 200, epoch: 8 | loss: 0.5301990
	speed: 0.0308s/iter; left time: 99.5537s
	iters: 300, epoch: 8 | loss: 1.3100111
	speed: 0.0329s/iter; left time: 103.2258s
	iters: 400, epoch: 8 | loss: 0.4107191
	speed: 0.0331s/iter; left time: 100.4778s
	iters: 500, epoch: 8 | loss: 1.2688745
	speed: 0.0318s/iter; left time: 93.3263s
	iters: 600, epoch: 8 | loss: 0.7996846
	speed: 0.0302s/iter; left time: 85.4612s
	iters: 700, epoch: 8 | loss: 0.3817575
	speed: 0.0294s/iter; left time: 80.3514s
	iters: 800, epoch: 8 | loss: 0.3129064
	speed: 0.0288s/iter; left time: 75.9207s
	iters: 900, epoch: 8 | loss: 0.4591944
	speed: 0.0284s/iter; left time: 71.9831s
	iters: 1000, epoch: 8 | loss: 0.3838982
	speed: 0.0279s/iter; left time: 67.7713s
	iters: 1100, epoch: 8 | loss: 0.7780249
	speed: 0.0273s/iter; left time: 63.7458s
Epoch: 8 cost time: 31.18123173713684
Epoch: 8, Steps: 1144 | Train Loss: 0.4688022 Vali Loss: 0.4879703 Test Loss: 0.2193908
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4263404
	speed: 0.0304s/iter; left time: 66.5618s
	iters: 200, epoch: 9 | loss: 0.3723613
	speed: 0.0265s/iter; left time: 55.3811s
	iters: 300, epoch: 9 | loss: 0.3358417
	speed: 0.0249s/iter; left time: 49.6098s
	iters: 400, epoch: 9 | loss: 0.3673092
	speed: 0.0243s/iter; left time: 45.8740s
	iters: 500, epoch: 9 | loss: 0.3272168
	speed: 0.0242s/iter; left time: 43.3090s
	iters: 600, epoch: 9 | loss: 0.4685927
	speed: 0.0240s/iter; left time: 40.5028s
	iters: 700, epoch: 9 | loss: 0.4016658
	speed: 0.0238s/iter; left time: 37.8344s
	iters: 800, epoch: 9 | loss: 0.7979085
	speed: 0.0247s/iter; left time: 36.7060s
	iters: 900, epoch: 9 | loss: 0.9688326
	speed: 0.0256s/iter; left time: 35.5958s
	iters: 1000, epoch: 9 | loss: 0.4462615
	speed: 0.0265s/iter; left time: 34.1591s
	iters: 1100, epoch: 9 | loss: 0.4378100
	speed: 0.0271s/iter; left time: 32.2809s
Epoch: 9 cost time: 31.167033433914185
Epoch: 9, Steps: 1144 | Train Loss: 0.4683514 Vali Loss: 0.4880014 Test Loss: 0.2194623
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.4532472
	speed: 0.0262s/iter; left time: 27.3948s
	iters: 200, epoch: 10 | loss: 0.4719042
	speed: 0.0245s/iter; left time: 23.1587s
	iters: 300, epoch: 10 | loss: 0.3969156
	speed: 0.0236s/iter; left time: 19.9095s
	iters: 400, epoch: 10 | loss: 0.3599280
	speed: 0.0239s/iter; left time: 17.8408s
	iters: 500, epoch: 10 | loss: 0.9178501
	speed: 0.0241s/iter; left time: 15.5639s
	iters: 600, epoch: 10 | loss: 0.4665618
	speed: 0.0241s/iter; left time: 13.1351s
	iters: 700, epoch: 10 | loss: 0.4652059
	speed: 0.0242s/iter; left time: 10.7650s
	iters: 800, epoch: 10 | loss: 0.3720751
	speed: 0.0243s/iter; left time: 8.3730s
	iters: 900, epoch: 10 | loss: 0.2902837
	speed: 0.0243s/iter; left time: 5.9573s
	iters: 1000, epoch: 10 | loss: 0.8093836
	speed: 0.0242s/iter; left time: 3.5018s
	iters: 1100, epoch: 10 | loss: 0.3254842
	speed: 0.0238s/iter; left time: 1.0698s
Epoch: 10 cost time: 27.089699029922485
Epoch: 10, Steps: 1144 | Train Loss: 0.4679451 Vali Loss: 0.4880726 Test Loss: 0.2194734
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.21943026781082153, mae:0.2571519911289215
Use GPU: cuda:0
no_skip False
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.5113389
	speed: 0.0332s/iter; left time: 376.8441s
	iters: 200, epoch: 1 | loss: 0.3441538
	speed: 0.0291s/iter; left time: 327.0122s
	iters: 300, epoch: 1 | loss: 0.7358339
	speed: 0.0277s/iter; left time: 309.0308s
	iters: 400, epoch: 1 | loss: 0.9008004
	speed: 0.0270s/iter; left time: 297.8989s
	iters: 500, epoch: 1 | loss: 0.4545895
	speed: 0.0265s/iter; left time: 289.6496s
	iters: 600, epoch: 1 | loss: 0.4142519
	speed: 0.0261s/iter; left time: 283.4489s
	iters: 700, epoch: 1 | loss: 0.5272844
	speed: 0.0263s/iter; left time: 282.6084s
	iters: 800, epoch: 1 | loss: 0.3604922
	speed: 0.0258s/iter; left time: 274.6854s
	iters: 900, epoch: 1 | loss: 0.4028433
	speed: 0.0254s/iter; left time: 268.0551s
	iters: 1000, epoch: 1 | loss: 0.3984264
	speed: 0.0253s/iter; left time: 263.8326s
	iters: 1100, epoch: 1 | loss: 0.4331111
	speed: 0.0252s/iter; left time: 260.8703s
Epoch: 1 cost time: 28.95701766014099
Epoch: 1, Steps: 1144 | Train Loss: 0.5587327 Vali Loss: 0.5255345 Test Loss: 0.2328853
Validation loss decreased (inf --> 0.525535).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5445506
	speed: 0.0240s/iter; left time: 245.2321s
	iters: 200, epoch: 2 | loss: 0.9505138
	speed: 0.0212s/iter; left time: 213.7803s
	iters: 300, epoch: 2 | loss: 0.4404175
	speed: 0.0230s/iter; left time: 229.8342s
	iters: 400, epoch: 2 | loss: 0.4007892
	speed: 0.0262s/iter; left time: 258.8674s
	iters: 500, epoch: 2 | loss: 0.4215010
	speed: 0.0251s/iter; left time: 246.3746s
	iters: 600, epoch: 2 | loss: 0.8596029
	speed: 0.0250s/iter; left time: 242.1370s
	iters: 700, epoch: 2 | loss: 0.4324077
	speed: 0.0247s/iter; left time: 237.1735s
	iters: 800, epoch: 2 | loss: 0.6183794
	speed: 0.0244s/iter; left time: 231.7624s
	iters: 900, epoch: 2 | loss: 0.4331032
	speed: 0.0242s/iter; left time: 227.2818s
	iters: 1000, epoch: 2 | loss: 0.3821676
	speed: 0.0240s/iter; left time: 223.5694s
	iters: 1100, epoch: 2 | loss: 0.4447132
	speed: 0.0239s/iter; left time: 220.0307s
Epoch: 2 cost time: 27.45064926147461
Epoch: 2, Steps: 1144 | Train Loss: 0.5130724 Vali Loss: 0.5011097 Test Loss: 0.2285714
Validation loss decreased (0.525535 --> 0.501110).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4464900
	speed: 0.0315s/iter; left time: 284.8874s
	iters: 200, epoch: 3 | loss: 0.3306829
	speed: 0.0268s/iter; left time: 239.9265s
	iters: 300, epoch: 3 | loss: 0.3290307
	speed: 0.0260s/iter; left time: 230.4490s
	iters: 400, epoch: 3 | loss: 0.4957298
	speed: 0.0251s/iter; left time: 219.3763s
	iters: 500, epoch: 3 | loss: 0.9107256
	speed: 0.0246s/iter; left time: 212.9053s
	iters: 600, epoch: 3 | loss: 0.3334806
	speed: 0.0243s/iter; left time: 207.6297s
	iters: 700, epoch: 3 | loss: 0.4224162
	speed: 0.0240s/iter; left time: 202.9498s
	iters: 800, epoch: 3 | loss: 0.3458052
	speed: 0.0243s/iter; left time: 203.2196s
	iters: 900, epoch: 3 | loss: 0.8510435
	speed: 0.0240s/iter; left time: 198.3343s
	iters: 1000, epoch: 3 | loss: 0.4880717
	speed: 0.0236s/iter; left time: 192.2409s
	iters: 1100, epoch: 3 | loss: 0.3478543
	speed: 0.0237s/iter; left time: 190.6227s
Epoch: 3 cost time: 27.080325603485107
Epoch: 3, Steps: 1144 | Train Loss: 0.4948866 Vali Loss: 0.4943121 Test Loss: 0.2235248
Validation loss decreased (0.501110 --> 0.494312).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4761945
	speed: 0.0418s/iter; left time: 330.6102s
	iters: 200, epoch: 4 | loss: 0.4200197
	speed: 0.0373s/iter; left time: 291.3315s
	iters: 300, epoch: 4 | loss: 0.4108336
	speed: 0.0323s/iter; left time: 249.1036s
	iters: 400, epoch: 4 | loss: 0.3914801
	speed: 0.0301s/iter; left time: 229.1633s
	iters: 500, epoch: 4 | loss: 0.4970786
	speed: 0.0286s/iter; left time: 215.0091s
	iters: 600, epoch: 4 | loss: 0.3801499
	speed: 0.0272s/iter; left time: 201.3272s
	iters: 700, epoch: 4 | loss: 0.4164521
	speed: 0.0261s/iter; left time: 191.1291s
	iters: 800, epoch: 4 | loss: 0.3584073
	speed: 0.0260s/iter; left time: 187.7528s
	iters: 900, epoch: 4 | loss: 0.4587392
	speed: 0.0270s/iter; left time: 192.0749s
	iters: 1000, epoch: 4 | loss: 0.5306626
	speed: 0.0268s/iter; left time: 187.7088s
	iters: 1100, epoch: 4 | loss: 0.3999986
	speed: 0.0266s/iter; left time: 183.5890s
Epoch: 4 cost time: 30.292213678359985
Epoch: 4, Steps: 1144 | Train Loss: 0.4849861 Vali Loss: 0.4875760 Test Loss: 0.2221592
Validation loss decreased (0.494312 --> 0.487576).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4154875
	speed: 0.0402s/iter; left time: 271.6762s
	iters: 200, epoch: 5 | loss: 0.4394085
	speed: 0.0362s/iter; left time: 241.2605s
	iters: 300, epoch: 5 | loss: 0.3131311
	speed: 0.0316s/iter; left time: 207.1885s
	iters: 400, epoch: 5 | loss: 0.3741876
	speed: 0.0292s/iter; left time: 188.5318s
	iters: 500, epoch: 5 | loss: 0.3673388
	speed: 0.0279s/iter; left time: 177.2692s
	iters: 600, epoch: 5 | loss: 0.5424919
	speed: 0.0274s/iter; left time: 171.6347s
	iters: 700, epoch: 5 | loss: 0.8463564
	speed: 0.0267s/iter; left time: 164.3982s
	iters: 800, epoch: 5 | loss: 0.2864928
	speed: 0.0261s/iter; left time: 158.1711s
	iters: 900, epoch: 5 | loss: 0.4331960
	speed: 0.0261s/iter; left time: 155.7370s
	iters: 1000, epoch: 5 | loss: 0.4347241
	speed: 0.0260s/iter; left time: 152.5252s
	iters: 1100, epoch: 5 | loss: 0.3863898
	speed: 0.0259s/iter; left time: 149.3472s
Epoch: 5 cost time: 29.754545211791992
Epoch: 5, Steps: 1144 | Train Loss: 0.4789995 Vali Loss: 0.4887955 Test Loss: 0.2218866
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4126936
	speed: 0.0300s/iter; left time: 168.5287s
	iters: 200, epoch: 6 | loss: 0.3646013
	speed: 0.0345s/iter; left time: 190.5677s
	iters: 300, epoch: 6 | loss: 0.4067634
	speed: 0.0346s/iter; left time: 187.4114s
	iters: 400, epoch: 6 | loss: 0.2910943
	speed: 0.0325s/iter; left time: 173.0102s
	iters: 500, epoch: 6 | loss: 0.4946412
	speed: 0.0307s/iter; left time: 160.4140s
	iters: 600, epoch: 6 | loss: 0.7974739
	speed: 0.0292s/iter; left time: 149.3988s
	iters: 700, epoch: 6 | loss: 0.4542708
	speed: 0.0281s/iter; left time: 140.8436s
	iters: 800, epoch: 6 | loss: 0.4929593
	speed: 0.0274s/iter; left time: 134.8379s
	iters: 900, epoch: 6 | loss: 0.4125498
	speed: 0.0268s/iter; left time: 129.1727s
	iters: 1000, epoch: 6 | loss: 0.9286094
	speed: 0.0267s/iter; left time: 126.1787s
	iters: 1100, epoch: 6 | loss: 0.9373600
	speed: 0.0268s/iter; left time: 123.7590s
Epoch: 6 cost time: 30.60365056991577
Epoch: 6, Steps: 1144 | Train Loss: 0.4760753 Vali Loss: 0.4865133 Test Loss: 0.2211975
Validation loss decreased (0.487576 --> 0.486513).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4670976
	speed: 0.0278s/iter; left time: 124.5851s
	iters: 200, epoch: 7 | loss: 0.3485626
	speed: 0.0252s/iter; left time: 110.1257s
	iters: 300, epoch: 7 | loss: 0.3618922
	speed: 0.0243s/iter; left time: 103.9654s
	iters: 400, epoch: 7 | loss: 0.4039180
	speed: 0.0239s/iter; left time: 99.6874s
	iters: 500, epoch: 7 | loss: 0.3661042
	speed: 0.0234s/iter; left time: 95.2885s
	iters: 600, epoch: 7 | loss: 0.4292934
	speed: 0.0230s/iter; left time: 91.6595s
	iters: 700, epoch: 7 | loss: 0.5093606
	speed: 0.0233s/iter; left time: 90.3968s
	iters: 800, epoch: 7 | loss: 0.3621966
	speed: 0.0245s/iter; left time: 92.4393s
	iters: 900, epoch: 7 | loss: 0.5133650
	speed: 0.0254s/iter; left time: 93.4473s
	iters: 1000, epoch: 7 | loss: 0.3863633
	speed: 0.0253s/iter; left time: 90.5594s
	iters: 1100, epoch: 7 | loss: 0.4640869
	speed: 0.0254s/iter; left time: 88.4088s
Epoch: 7 cost time: 29.531835794448853
Epoch: 7, Steps: 1144 | Train Loss: 0.4745623 Vali Loss: 0.4879383 Test Loss: 0.2216966
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3697900
	speed: 0.0285s/iter; left time: 95.0530s
	iters: 200, epoch: 8 | loss: 0.4771036
	speed: 0.0264s/iter; left time: 85.4806s
	iters: 300, epoch: 8 | loss: 0.4053271
	speed: 0.0250s/iter; left time: 78.2346s
	iters: 400, epoch: 8 | loss: 0.2885204
	speed: 0.0243s/iter; left time: 73.8507s
	iters: 500, epoch: 8 | loss: 0.3480589
	speed: 0.0240s/iter; left time: 70.4858s
	iters: 600, epoch: 8 | loss: 0.8919472
	speed: 0.0237s/iter; left time: 67.1020s
	iters: 700, epoch: 8 | loss: 0.4238534
	speed: 0.0232s/iter; left time: 63.3669s
	iters: 800, epoch: 8 | loss: 0.3805775
	speed: 0.0226s/iter; left time: 59.5450s
	iters: 900, epoch: 8 | loss: 0.3275906
	speed: 0.0226s/iter; left time: 57.2837s
	iters: 1000, epoch: 8 | loss: 0.9331529
	speed: 0.0222s/iter; left time: 54.1337s
	iters: 1100, epoch: 8 | loss: 0.3120678
	speed: 0.0219s/iter; left time: 51.0427s
Epoch: 8 cost time: 25.162381172180176
Epoch: 8, Steps: 1144 | Train Loss: 0.4734638 Vali Loss: 0.4873516 Test Loss: 0.2212184
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3747108
	speed: 0.0453s/iter; left time: 99.0950s
	iters: 200, epoch: 9 | loss: 0.4414539
	speed: 0.0435s/iter; left time: 90.8937s
	iters: 300, epoch: 9 | loss: 0.7934281
	speed: 0.0419s/iter; left time: 83.3028s
	iters: 400, epoch: 9 | loss: 0.3806713
	speed: 0.0362s/iter; left time: 68.3402s
	iters: 500, epoch: 9 | loss: 0.3891498
	speed: 0.0323s/iter; left time: 57.7896s
	iters: 600, epoch: 9 | loss: 0.3418467
	speed: 0.0301s/iter; left time: 50.8188s
	iters: 700, epoch: 9 | loss: 0.5384863
	speed: 0.0279s/iter; left time: 44.3653s
	iters: 800, epoch: 9 | loss: 0.4572486
	speed: 0.0261s/iter; left time: 38.8705s
	iters: 900, epoch: 9 | loss: 0.3737313
	speed: 0.0250s/iter; left time: 34.7737s
	iters: 1000, epoch: 9 | loss: 0.3198633
	speed: 0.0253s/iter; left time: 32.5743s
	iters: 1100, epoch: 9 | loss: 0.3554606
	speed: 0.0255s/iter; left time: 30.3281s
Epoch: 9 cost time: 29.870553731918335
Epoch: 9, Steps: 1144 | Train Loss: 0.4730654 Vali Loss: 0.4870988 Test Loss: 0.2212762
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.7629547
	speed: 0.0421s/iter; left time: 44.0366s
	iters: 200, epoch: 10 | loss: 0.3533231
	speed: 0.0391s/iter; left time: 36.9513s
	iters: 300, epoch: 10 | loss: 0.3852207
	speed: 0.0336s/iter; left time: 28.3516s
	iters: 400, epoch: 10 | loss: 0.8019111
	speed: 0.0308s/iter; left time: 22.9493s
	iters: 500, epoch: 10 | loss: 0.3471915
	speed: 0.0304s/iter; left time: 19.5871s
	iters: 600, epoch: 10 | loss: 0.2818960
	speed: 0.0284s/iter; left time: 15.4711s
	iters: 700, epoch: 10 | loss: 0.8107806
	speed: 0.0269s/iter; left time: 11.9818s
	iters: 800, epoch: 10 | loss: 0.7881052
	speed: 0.0262s/iter; left time: 9.0301s
	iters: 900, epoch: 10 | loss: 0.4563026
	speed: 0.0257s/iter; left time: 6.3073s
	iters: 1000, epoch: 10 | loss: 0.3391641
	speed: 0.0257s/iter; left time: 3.7204s
	iters: 1100, epoch: 10 | loss: 0.3954752
	speed: 0.0256s/iter; left time: 1.1504s
Epoch: 10 cost time: 29.30584406852722
Epoch: 10, Steps: 1144 | Train Loss: 0.4728519 Vali Loss: 0.4874038 Test Loss: 0.2212761
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.22119756042957306, mae:0.2576526701450348
Use GPU: cuda:0
no_skip False
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.6276326
	speed: 0.0219s/iter; left time: 248.3855s
	iters: 200, epoch: 1 | loss: 0.5329130
	speed: 0.0192s/iter; left time: 215.3877s
	iters: 300, epoch: 1 | loss: 0.5004308
	speed: 0.0186s/iter; left time: 207.1800s
	iters: 400, epoch: 1 | loss: 0.6385977
	speed: 0.0186s/iter; left time: 204.8577s
	iters: 500, epoch: 1 | loss: 0.3940199
	speed: 0.0192s/iter; left time: 209.7534s
	iters: 600, epoch: 1 | loss: 0.5411709
	speed: 0.0197s/iter; left time: 214.0116s
	iters: 700, epoch: 1 | loss: 0.5142006
	speed: 0.0202s/iter; left time: 217.1783s
	iters: 800, epoch: 1 | loss: 0.4496242
	speed: 0.0205s/iter; left time: 218.2105s
	iters: 900, epoch: 1 | loss: 0.5346482
	speed: 0.0213s/iter; left time: 224.1872s
	iters: 1000, epoch: 1 | loss: 0.5117068
	speed: 0.0228s/iter; left time: 237.6510s
	iters: 1100, epoch: 1 | loss: 0.8045972
	speed: 0.0240s/iter; left time: 247.7860s
Epoch: 1 cost time: 27.894068002700806
Epoch: 1, Steps: 1144 | Train Loss: 0.5558422 Vali Loss: 0.5246089 Test Loss: 0.2319038
Validation loss decreased (inf --> 0.524609).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4303897
	speed: 0.0240s/iter; left time: 244.7770s
	iters: 200, epoch: 2 | loss: 0.9525880
	speed: 0.0248s/iter; left time: 250.4231s
	iters: 300, epoch: 2 | loss: 0.3744516
	speed: 0.0259s/iter; left time: 259.3950s
	iters: 400, epoch: 2 | loss: 0.5437821
	speed: 0.0251s/iter; left time: 248.0033s
	iters: 500, epoch: 2 | loss: 0.5048388
	speed: 0.0248s/iter; left time: 243.2207s
	iters: 600, epoch: 2 | loss: 0.4927993
	speed: 0.0252s/iter; left time: 244.1718s
	iters: 700, epoch: 2 | loss: 1.0110960
	speed: 0.0262s/iter; left time: 251.5364s
	iters: 800, epoch: 2 | loss: 0.4732029
	speed: 0.0259s/iter; left time: 245.8423s
	iters: 900, epoch: 2 | loss: 0.4554995
	speed: 0.0257s/iter; left time: 241.8141s
	iters: 1000, epoch: 2 | loss: 0.3701162
	speed: 0.0256s/iter; left time: 238.1353s
	iters: 1100, epoch: 2 | loss: 0.3539909
	speed: 0.0255s/iter; left time: 234.4550s
Epoch: 2 cost time: 29.250795602798462
Epoch: 2, Steps: 1144 | Train Loss: 0.5136786 Vali Loss: 0.5035442 Test Loss: 0.2265295
Validation loss decreased (0.524609 --> 0.503544).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3743048
	speed: 0.0335s/iter; left time: 303.5285s
	iters: 200, epoch: 3 | loss: 0.3246862
	speed: 0.0325s/iter; left time: 291.2735s
	iters: 300, epoch: 3 | loss: 0.3670470
	speed: 0.0336s/iter; left time: 297.1831s
	iters: 400, epoch: 3 | loss: 0.4176227
	speed: 0.0334s/iter; left time: 292.6787s
	iters: 500, epoch: 3 | loss: 0.8621300
	speed: 0.0328s/iter; left time: 284.2373s
	iters: 600, epoch: 3 | loss: 0.3277448
	speed: 0.0311s/iter; left time: 265.8779s
	iters: 700, epoch: 3 | loss: 0.3860866
	speed: 0.0299s/iter; left time: 252.4885s
	iters: 800, epoch: 3 | loss: 0.4582501
	speed: 0.0289s/iter; left time: 241.6547s
	iters: 900, epoch: 3 | loss: 0.5500634
	speed: 0.0285s/iter; left time: 234.8698s
	iters: 1000, epoch: 3 | loss: 0.4879202
	speed: 0.0281s/iter; left time: 229.3882s
	iters: 1100, epoch: 3 | loss: 1.0113535
	speed: 0.0280s/iter; left time: 225.2505s
Epoch: 3 cost time: 32.496060609817505
Epoch: 3, Steps: 1144 | Train Loss: 0.4977611 Vali Loss: 0.4967661 Test Loss: 0.2235890
Validation loss decreased (0.503544 --> 0.496766).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3580619
	speed: 0.0296s/iter; left time: 234.1451s
	iters: 200, epoch: 4 | loss: 0.4121462
	speed: 0.0272s/iter; left time: 212.7895s
	iters: 300, epoch: 4 | loss: 0.3906749
	speed: 0.0264s/iter; left time: 203.7974s
	iters: 400, epoch: 4 | loss: 0.9455728
	speed: 0.0260s/iter; left time: 197.6895s
	iters: 500, epoch: 4 | loss: 0.4542267
	speed: 0.0255s/iter; left time: 191.4118s
	iters: 600, epoch: 4 | loss: 0.5613338
	speed: 0.0250s/iter; left time: 185.4426s
	iters: 700, epoch: 4 | loss: 0.4010448
	speed: 0.0249s/iter; left time: 182.2131s
	iters: 800, epoch: 4 | loss: 0.4793745
	speed: 0.0247s/iter; left time: 178.0296s
	iters: 900, epoch: 4 | loss: 0.5317662
	speed: 0.0245s/iter; left time: 173.8317s
	iters: 1000, epoch: 4 | loss: 0.3760922
	speed: 0.0240s/iter; left time: 168.1760s
	iters: 1100, epoch: 4 | loss: 0.8805072
	speed: 0.0236s/iter; left time: 162.9859s
Epoch: 4 cost time: 27.13920283317566
Epoch: 4, Steps: 1144 | Train Loss: 0.4868273 Vali Loss: 0.4948387 Test Loss: 0.2226491
Validation loss decreased (0.496766 --> 0.494839).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.9546859
	speed: 0.0185s/iter; left time: 125.3281s
	iters: 200, epoch: 5 | loss: 0.4255035
	speed: 0.0171s/iter; left time: 114.0172s
	iters: 300, epoch: 5 | loss: 0.4072612
	speed: 0.0179s/iter; left time: 117.7929s
	iters: 400, epoch: 5 | loss: 0.4371539
	speed: 0.0185s/iter; left time: 119.8899s
	iters: 500, epoch: 5 | loss: 0.3940963
	speed: 0.0185s/iter; left time: 117.8590s
	iters: 600, epoch: 5 | loss: 0.3895351
	speed: 0.0186s/iter; left time: 116.5527s
	iters: 700, epoch: 5 | loss: 0.9259703
	speed: 0.0186s/iter; left time: 114.8623s
	iters: 800, epoch: 5 | loss: 0.4253995
	speed: 0.0185s/iter; left time: 112.0424s
	iters: 900, epoch: 5 | loss: 0.4603663
	speed: 0.0189s/iter; left time: 112.9207s
	iters: 1000, epoch: 5 | loss: 0.3715296
	speed: 0.0194s/iter; left time: 113.5486s
	iters: 1100, epoch: 5 | loss: 0.3503480
	speed: 0.0210s/iter; left time: 120.9027s
Epoch: 5 cost time: 24.571847677230835
Epoch: 5, Steps: 1144 | Train Loss: 0.4807042 Vali Loss: 0.4942034 Test Loss: 0.2218556
Validation loss decreased (0.494839 --> 0.494203).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2917189
	speed: 0.0297s/iter; left time: 166.8163s
	iters: 200, epoch: 6 | loss: 0.4148052
	speed: 0.0263s/iter; left time: 145.0238s
	iters: 300, epoch: 6 | loss: 0.3814197
	speed: 0.0245s/iter; left time: 133.0006s
	iters: 400, epoch: 6 | loss: 0.3372030
	speed: 0.0234s/iter; left time: 124.4564s
	iters: 500, epoch: 6 | loss: 0.4732472
	speed: 0.0229s/iter; left time: 119.7032s
	iters: 600, epoch: 6 | loss: 0.4548740
	speed: 0.0225s/iter; left time: 115.1356s
	iters: 700, epoch: 6 | loss: 0.4203322
	speed: 0.0223s/iter; left time: 112.1219s
	iters: 800, epoch: 6 | loss: 0.8062134
	speed: 0.0222s/iter; left time: 109.1736s
	iters: 900, epoch: 6 | loss: 0.4419362
	speed: 0.0222s/iter; left time: 106.8111s
	iters: 1000, epoch: 6 | loss: 0.4511551
	speed: 0.0233s/iter; left time: 109.9313s
	iters: 1100, epoch: 6 | loss: 0.3495145
	speed: 0.0246s/iter; left time: 113.4741s
Epoch: 6 cost time: 28.766384601593018
Epoch: 6, Steps: 1144 | Train Loss: 0.4776791 Vali Loss: 0.4923755 Test Loss: 0.2212489
Validation loss decreased (0.494203 --> 0.492375).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4427144
	speed: 0.0351s/iter; left time: 157.1455s
	iters: 200, epoch: 7 | loss: 0.8712145
	speed: 0.0299s/iter; left time: 130.9985s
	iters: 300, epoch: 7 | loss: 0.3330840
	speed: 0.0285s/iter; left time: 121.7356s
	iters: 400, epoch: 7 | loss: 0.5182146
	speed: 0.0271s/iter; left time: 113.2480s
	iters: 500, epoch: 7 | loss: 0.9321416
	speed: 0.0264s/iter; left time: 107.7484s
	iters: 600, epoch: 7 | loss: 0.3591236
	speed: 0.0274s/iter; left time: 109.0401s
	iters: 700, epoch: 7 | loss: 0.4387278
	speed: 0.0264s/iter; left time: 102.5371s
	iters: 800, epoch: 7 | loss: 0.2677641
	speed: 0.0263s/iter; left time: 99.4126s
	iters: 900, epoch: 7 | loss: 0.4215754
	speed: 0.0274s/iter; left time: 100.6482s
	iters: 1000, epoch: 7 | loss: 0.4191052
	speed: 0.0278s/iter; left time: 99.3204s
	iters: 1100, epoch: 7 | loss: 0.3407065
	speed: 0.0275s/iter; left time: 95.6204s
Epoch: 7 cost time: 31.5071804523468
Epoch: 7, Steps: 1144 | Train Loss: 0.4759932 Vali Loss: 0.4918130 Test Loss: 0.2210922
Validation loss decreased (0.492375 --> 0.491813).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4967732
	speed: 0.0413s/iter; left time: 137.7669s
	iters: 200, epoch: 8 | loss: 0.4102663
	speed: 0.0340s/iter; left time: 110.0786s
	iters: 300, epoch: 8 | loss: 0.4165988
	speed: 0.0293s/iter; left time: 91.7638s
	iters: 400, epoch: 8 | loss: 0.3532380
	speed: 0.0259s/iter; left time: 78.6479s
	iters: 500, epoch: 8 | loss: 0.3830492
	speed: 0.0246s/iter; left time: 72.2931s
	iters: 600, epoch: 8 | loss: 0.2951652
	speed: 0.0238s/iter; left time: 67.3312s
	iters: 700, epoch: 8 | loss: 0.3906379
	speed: 0.0228s/iter; left time: 62.4254s
	iters: 800, epoch: 8 | loss: 0.4906960
	speed: 0.0220s/iter; left time: 57.8172s
	iters: 900, epoch: 8 | loss: 0.3642277
	speed: 0.0214s/iter; left time: 54.2078s
	iters: 1000, epoch: 8 | loss: 1.0073069
	speed: 0.0216s/iter; left time: 52.4418s
	iters: 1100, epoch: 8 | loss: 0.4554572
	speed: 0.0216s/iter; left time: 50.3736s
Epoch: 8 cost time: 24.962971210479736
Epoch: 8, Steps: 1144 | Train Loss: 0.4751436 Vali Loss: 0.4923855 Test Loss: 0.2210345
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4490815
	speed: 0.0407s/iter; left time: 89.0889s
	iters: 200, epoch: 9 | loss: 0.4575525
	speed: 0.0317s/iter; left time: 66.1542s
	iters: 300, epoch: 9 | loss: 0.3040354
	speed: 0.0286s/iter; left time: 56.8784s
	iters: 400, epoch: 9 | loss: 0.4978706
	speed: 0.0271s/iter; left time: 51.1689s
	iters: 500, epoch: 9 | loss: 0.4168075
	speed: 0.0262s/iter; left time: 46.8427s
	iters: 600, epoch: 9 | loss: 0.3783455
	speed: 0.0267s/iter; left time: 45.0777s
	iters: 700, epoch: 9 | loss: 0.9205009
	speed: 0.0281s/iter; left time: 44.6511s
	iters: 800, epoch: 9 | loss: 0.8346880
	speed: 0.0290s/iter; left time: 43.2201s
	iters: 900, epoch: 9 | loss: 0.3654528
	speed: 0.0282s/iter; left time: 39.1133s
	iters: 1000, epoch: 9 | loss: 0.4045516
	speed: 0.0275s/iter; left time: 35.4022s
	iters: 1100, epoch: 9 | loss: 0.3933202
	speed: 0.0269s/iter; left time: 31.9798s
Epoch: 9 cost time: 31.145379543304443
Epoch: 9, Steps: 1144 | Train Loss: 0.4746229 Vali Loss: 0.4917223 Test Loss: 0.2208351
Validation loss decreased (0.491813 --> 0.491722).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.7743156
	speed: 0.0462s/iter; left time: 48.2417s
	iters: 200, epoch: 10 | loss: 0.4836819
	speed: 0.0412s/iter; left time: 38.9140s
	iters: 300, epoch: 10 | loss: 0.3193906
	speed: 0.0351s/iter; left time: 29.6601s
	iters: 400, epoch: 10 | loss: 0.3923098
	speed: 0.0320s/iter; left time: 23.8110s
	iters: 500, epoch: 10 | loss: 0.5324414
	speed: 0.0300s/iter; left time: 19.3495s
	iters: 600, epoch: 10 | loss: 0.4470791
	speed: 0.0290s/iter; left time: 15.8162s
	iters: 700, epoch: 10 | loss: 0.4161907
	speed: 0.0281s/iter; left time: 12.5236s
	iters: 800, epoch: 10 | loss: 0.4146921
	speed: 0.0274s/iter; left time: 9.4632s
	iters: 900, epoch: 10 | loss: 0.3782308
	speed: 0.0269s/iter; left time: 6.5868s
	iters: 1000, epoch: 10 | loss: 0.3676653
	speed: 0.0266s/iter; left time: 3.8529s
	iters: 1100, epoch: 10 | loss: 0.5125544
	speed: 0.0265s/iter; left time: 1.1905s
Epoch: 10 cost time: 30.689071655273438
Epoch: 10, Steps: 1144 | Train Loss: 0.4744147 Vali Loss: 0.4919388 Test Loss: 0.2209036
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.22083498537540436, mae:0.25847163796424866
Seed: 42
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_336      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip False
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.5267988
	speed: 0.0454s/iter; left time: 513.0244s
	iters: 200, epoch: 1 | loss: 0.8304341
	speed: 0.0342s/iter; left time: 383.0354s
	iters: 300, epoch: 1 | loss: 0.5982081
	speed: 0.0304s/iter; left time: 337.0254s
	iters: 400, epoch: 1 | loss: 0.5665386
	speed: 0.0281s/iter; left time: 309.5476s
	iters: 500, epoch: 1 | loss: 0.4358746
	speed: 0.0273s/iter; left time: 298.1417s
	iters: 600, epoch: 1 | loss: 0.5248048
	speed: 0.0260s/iter; left time: 281.1150s
	iters: 700, epoch: 1 | loss: 0.5159647
	speed: 0.0250s/iter; left time: 267.3831s
	iters: 800, epoch: 1 | loss: 0.4806271
	speed: 0.0250s/iter; left time: 264.7533s
	iters: 900, epoch: 1 | loss: 0.4690708
	speed: 0.0248s/iter; left time: 259.9395s
	iters: 1000, epoch: 1 | loss: 0.7340667
	speed: 0.0245s/iter; left time: 254.9374s
	iters: 1100, epoch: 1 | loss: 0.7495206
	speed: 0.0243s/iter; left time: 250.2791s
Epoch: 1 cost time: 27.722288846969604
Epoch: 1, Steps: 1140 | Train Loss: 0.6215750 Vali Loss: 0.5976692 Test Loss: 0.2858621
Validation loss decreased (inf --> 0.597669).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7328615
	speed: 0.0401s/iter; left time: 407.2667s
	iters: 200, epoch: 2 | loss: 0.5268514
	speed: 0.0370s/iter; left time: 372.6784s
	iters: 300, epoch: 2 | loss: 0.5499107
	speed: 0.0332s/iter; left time: 330.9445s
	iters: 400, epoch: 2 | loss: 0.5099131
	speed: 0.0297s/iter; left time: 293.1312s
	iters: 500, epoch: 2 | loss: 0.7536882
	speed: 0.0290s/iter; left time: 283.1361s
	iters: 600, epoch: 2 | loss: 0.5284882
	speed: 0.0290s/iter; left time: 279.8511s
	iters: 700, epoch: 2 | loss: 0.5682139
	speed: 0.0284s/iter; left time: 271.3427s
	iters: 800, epoch: 2 | loss: 0.4323084
	speed: 0.0284s/iter; left time: 268.5811s
	iters: 900, epoch: 2 | loss: 0.5771398
	speed: 0.0283s/iter; left time: 265.3765s
	iters: 1000, epoch: 2 | loss: 0.4799929
	speed: 0.0281s/iter; left time: 259.9181s
	iters: 1100, epoch: 2 | loss: 0.4070510
	speed: 0.0278s/iter; left time: 254.9064s
Epoch: 2 cost time: 31.749013900756836
Epoch: 2, Steps: 1140 | Train Loss: 0.5777866 Vali Loss: 0.5857341 Test Loss: 0.2795537
Validation loss decreased (0.597669 --> 0.585734).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4235957
	speed: 0.0338s/iter; left time: 304.8393s
	iters: 200, epoch: 3 | loss: 0.7493015
	speed: 0.0319s/iter; left time: 284.2330s
	iters: 300, epoch: 3 | loss: 0.5582051
	speed: 0.0314s/iter; left time: 276.5968s
	iters: 400, epoch: 3 | loss: 0.5998079
	speed: 0.0319s/iter; left time: 278.2880s
	iters: 500, epoch: 3 | loss: 0.5673937
	speed: 0.0291s/iter; left time: 250.8003s
	iters: 600, epoch: 3 | loss: 0.8494638
	speed: 0.0272s/iter; left time: 232.1327s
	iters: 700, epoch: 3 | loss: 0.3648421
	speed: 0.0259s/iter; left time: 217.6842s
	iters: 800, epoch: 3 | loss: 0.5230086
	speed: 0.0257s/iter; left time: 213.4962s
	iters: 900, epoch: 3 | loss: 0.7509233
	speed: 0.0254s/iter; left time: 208.9990s
	iters: 1000, epoch: 3 | loss: 0.5096418
	speed: 0.0251s/iter; left time: 203.9617s
	iters: 1100, epoch: 3 | loss: 0.4692206
	speed: 0.0263s/iter; left time: 210.9222s
Epoch: 3 cost time: 30.417433261871338
Epoch: 3, Steps: 1140 | Train Loss: 0.5593640 Vali Loss: 0.5757197 Test Loss: 0.2760136
Validation loss decreased (0.585734 --> 0.575720).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8097053
	speed: 0.0380s/iter; left time: 299.0941s
	iters: 200, epoch: 4 | loss: 0.4674385
	speed: 0.0360s/iter; left time: 280.0657s
	iters: 300, epoch: 4 | loss: 0.3510520
	speed: 0.0325s/iter; left time: 249.8977s
	iters: 400, epoch: 4 | loss: 0.4500256
	speed: 0.0302s/iter; left time: 228.6279s
	iters: 500, epoch: 4 | loss: 0.4286786
	speed: 0.0286s/iter; left time: 213.9679s
	iters: 600, epoch: 4 | loss: 1.0455633
	speed: 0.0275s/iter; left time: 202.9798s
	iters: 700, epoch: 4 | loss: 0.3970844
	speed: 0.0267s/iter; left time: 194.3085s
	iters: 800, epoch: 4 | loss: 0.4436199
	speed: 0.0276s/iter; left time: 198.0221s
	iters: 900, epoch: 4 | loss: 0.3764657
	speed: 0.0281s/iter; left time: 198.9550s
	iters: 1000, epoch: 4 | loss: 0.5932831
	speed: 0.0282s/iter; left time: 196.8073s
	iters: 1100, epoch: 4 | loss: 0.5134038
	speed: 0.0284s/iter; left time: 195.3397s
Epoch: 4 cost time: 32.72111797332764
Epoch: 4, Steps: 1140 | Train Loss: 0.5471627 Vali Loss: 0.5732146 Test Loss: 0.2760201
Validation loss decreased (0.575720 --> 0.573215).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.7711157
	speed: 0.0283s/iter; left time: 190.6868s
	iters: 200, epoch: 5 | loss: 0.4870532
	speed: 0.0256s/iter; left time: 170.1927s
	iters: 300, epoch: 5 | loss: 0.7180010
	speed: 0.0245s/iter; left time: 160.4593s
	iters: 400, epoch: 5 | loss: 0.3933605
	speed: 0.0241s/iter; left time: 155.2073s
	iters: 500, epoch: 5 | loss: 0.4628684
	speed: 0.0238s/iter; left time: 150.6313s
	iters: 600, epoch: 5 | loss: 0.7739718
	speed: 0.0235s/iter; left time: 146.8605s
	iters: 700, epoch: 5 | loss: 0.6121262
	speed: 0.0233s/iter; left time: 142.9924s
	iters: 800, epoch: 5 | loss: 0.3990965
	speed: 0.0232s/iter; left time: 140.3040s
	iters: 900, epoch: 5 | loss: 0.4479418
	speed: 0.0231s/iter; left time: 137.4250s
	iters: 1000, epoch: 5 | loss: 0.3813396
	speed: 0.0227s/iter; left time: 132.6682s
	iters: 1100, epoch: 5 | loss: 0.4204641
	speed: 0.0226s/iter; left time: 130.0179s
Epoch: 5 cost time: 25.925119161605835
Epoch: 5, Steps: 1140 | Train Loss: 0.5405699 Vali Loss: 0.5774311 Test Loss: 0.2764147
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4317966
	speed: 0.0312s/iter; left time: 174.4950s
	iters: 200, epoch: 6 | loss: 0.4217267
	speed: 0.0268s/iter; left time: 147.2660s
	iters: 300, epoch: 6 | loss: 0.3896230
	speed: 0.0239s/iter; left time: 128.9148s
	iters: 400, epoch: 6 | loss: 0.4656665
	speed: 0.0220s/iter; left time: 116.6234s
	iters: 500, epoch: 6 | loss: 0.4587199
	speed: 0.0224s/iter; left time: 116.4996s
	iters: 600, epoch: 6 | loss: 0.4959959
	speed: 0.0232s/iter; left time: 118.1084s
	iters: 700, epoch: 6 | loss: 0.3682665
	speed: 0.0229s/iter; left time: 114.4008s
	iters: 800, epoch: 6 | loss: 0.7471015
	speed: 0.0223s/iter; left time: 109.1539s
	iters: 900, epoch: 6 | loss: 0.3915607
	speed: 0.0222s/iter; left time: 106.7952s
	iters: 1000, epoch: 6 | loss: 0.4972729
	speed: 0.0217s/iter; left time: 102.1627s
	iters: 1100, epoch: 6 | loss: 0.4135369
	speed: 0.0219s/iter; left time: 100.7366s
Epoch: 6 cost time: 25.017005681991577
Epoch: 6, Steps: 1140 | Train Loss: 0.5369904 Vali Loss: 0.5759138 Test Loss: 0.2754031
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4614045
	speed: 0.0439s/iter; left time: 195.7711s
	iters: 200, epoch: 7 | loss: 0.4095153
	speed: 0.0418s/iter; left time: 182.1430s
	iters: 300, epoch: 7 | loss: 0.4789447
	speed: 0.0407s/iter; left time: 173.2745s
	iters: 400, epoch: 7 | loss: 0.7366287
	speed: 0.0383s/iter; left time: 159.5504s
	iters: 500, epoch: 7 | loss: 0.3648264
	speed: 0.0347s/iter; left time: 140.9240s
	iters: 600, epoch: 7 | loss: 0.6672555
	speed: 0.0319s/iter; left time: 126.3049s
	iters: 700, epoch: 7 | loss: 0.7257321
	speed: 0.0297s/iter; left time: 114.6246s
	iters: 800, epoch: 7 | loss: 0.4313527
	speed: 0.0287s/iter; left time: 107.8835s
	iters: 900, epoch: 7 | loss: 0.4697329
	speed: 0.0291s/iter; left time: 106.5970s
	iters: 1000, epoch: 7 | loss: 0.6931622
	speed: 0.0287s/iter; left time: 102.1721s
	iters: 1100, epoch: 7 | loss: 0.4874259
	speed: 0.0284s/iter; left time: 98.1204s
Epoch: 7 cost time: 32.31122303009033
Epoch: 7, Steps: 1140 | Train Loss: 0.5352665 Vali Loss: 0.5757174 Test Loss: 0.2757764
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4191156
	speed: 0.0454s/iter; left time: 150.9017s
	iters: 200, epoch: 8 | loss: 1.0107207
	speed: 0.0381s/iter; left time: 122.6137s
	iters: 300, epoch: 8 | loss: 0.4358910
	speed: 0.0336s/iter; left time: 104.9887s
	iters: 400, epoch: 8 | loss: 0.4588619
	speed: 0.0318s/iter; left time: 95.9257s
	iters: 500, epoch: 8 | loss: 0.3831201
	speed: 0.0292s/iter; left time: 85.1521s
	iters: 600, epoch: 8 | loss: 0.6520617
	speed: 0.0275s/iter; left time: 77.5683s
	iters: 700, epoch: 8 | loss: 0.6529089
	speed: 0.0269s/iter; left time: 73.3300s
	iters: 800, epoch: 8 | loss: 0.7698203
	speed: 0.0265s/iter; left time: 69.3824s
	iters: 900, epoch: 8 | loss: 0.4618789
	speed: 0.0263s/iter; left time: 66.2019s
	iters: 1000, epoch: 8 | loss: 0.4666048
	speed: 0.0261s/iter; left time: 63.1776s
	iters: 1100, epoch: 8 | loss: 0.4312607
	speed: 0.0259s/iter; left time: 60.1908s
Epoch: 8 cost time: 29.614936351776123
Epoch: 8, Steps: 1140 | Train Loss: 0.5342058 Vali Loss: 0.5792665 Test Loss: 0.2759703
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.7331637
	speed: 0.0237s/iter; left time: 51.7556s
	iters: 200, epoch: 9 | loss: 0.4579779
	speed: 0.0218s/iter; left time: 45.3732s
	iters: 300, epoch: 9 | loss: 0.5477508
	speed: 0.0206s/iter; left time: 40.8333s
	iters: 400, epoch: 9 | loss: 0.6373613
	speed: 0.0199s/iter; left time: 37.3383s
	iters: 500, epoch: 9 | loss: 0.4167053
	speed: 0.0197s/iter; left time: 35.1603s
	iters: 600, epoch: 9 | loss: 0.4431072
	speed: 0.0191s/iter; left time: 32.0441s
	iters: 700, epoch: 9 | loss: 0.4174499
	speed: 0.0188s/iter; left time: 29.6801s
	iters: 800, epoch: 9 | loss: 0.3628156
	speed: 0.0188s/iter; left time: 27.8737s
	iters: 900, epoch: 9 | loss: 0.5100936
	speed: 0.0193s/iter; left time: 26.6562s
	iters: 1000, epoch: 9 | loss: 0.4068096
	speed: 0.0198s/iter; left time: 25.4053s
	iters: 1100, epoch: 9 | loss: 0.7159807
	speed: 0.0203s/iter; left time: 23.9184s
Epoch: 9 cost time: 23.368361711502075
Epoch: 9, Steps: 1140 | Train Loss: 0.5337715 Vali Loss: 0.5763737 Test Loss: 0.2758936
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.27602002024650574, mae:0.2989943027496338
Use GPU: cuda:0
no_skip False
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.5156915
	speed: 0.0332s/iter; left time: 375.2641s
	iters: 200, epoch: 1 | loss: 0.7324789
	speed: 0.0276s/iter; left time: 309.5503s
	iters: 300, epoch: 1 | loss: 1.0420476
	speed: 0.0251s/iter; left time: 278.1060s
	iters: 400, epoch: 1 | loss: 0.7972198
	speed: 0.0239s/iter; left time: 263.0365s
	iters: 500, epoch: 1 | loss: 0.7598708
	speed: 0.0228s/iter; left time: 248.8362s
	iters: 600, epoch: 1 | loss: 1.0808100
	speed: 0.0227s/iter; left time: 245.3413s
	iters: 700, epoch: 1 | loss: 0.5063981
	speed: 0.0223s/iter; left time: 238.3690s
	iters: 800, epoch: 1 | loss: 0.6703544
	speed: 0.0219s/iter; left time: 232.5804s
	iters: 900, epoch: 1 | loss: 0.5251415
	speed: 0.0218s/iter; left time: 228.6413s
	iters: 1000, epoch: 1 | loss: 0.4431584
	speed: 0.0222s/iter; left time: 230.6348s
	iters: 1100, epoch: 1 | loss: 0.4608117
	speed: 0.0224s/iter; left time: 230.3292s
Epoch: 1 cost time: 25.68858766555786
Epoch: 1, Steps: 1140 | Train Loss: 0.6262136 Vali Loss: 0.6007367 Test Loss: 0.2850977
Validation loss decreased (inf --> 0.600737).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5002314
	speed: 0.0383s/iter; left time: 389.5692s
	iters: 200, epoch: 2 | loss: 0.5892905
	speed: 0.0323s/iter; left time: 325.0438s
	iters: 300, epoch: 2 | loss: 1.0548061
	speed: 0.0290s/iter; left time: 288.8772s
	iters: 400, epoch: 2 | loss: 0.5021174
	speed: 0.0268s/iter; left time: 264.6398s
	iters: 500, epoch: 2 | loss: 0.6792740
	speed: 0.0257s/iter; left time: 250.4782s
	iters: 600, epoch: 2 | loss: 0.4189204
	speed: 0.0249s/iter; left time: 240.1992s
	iters: 700, epoch: 2 | loss: 0.8099025
	speed: 0.0242s/iter; left time: 231.5268s
	iters: 800, epoch: 2 | loss: 0.8178174
	speed: 0.0238s/iter; left time: 225.4313s
	iters: 900, epoch: 2 | loss: 0.4683191
	speed: 0.0237s/iter; left time: 222.2200s
	iters: 1000, epoch: 2 | loss: 0.4992751
	speed: 0.0238s/iter; left time: 220.7045s
	iters: 1100, epoch: 2 | loss: 0.4079497
	speed: 0.0239s/iter; left time: 219.2853s
Epoch: 2 cost time: 27.44338583946228
Epoch: 2, Steps: 1140 | Train Loss: 0.5781556 Vali Loss: 0.5856289 Test Loss: 0.2791496
Validation loss decreased (0.600737 --> 0.585629).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4347120
	speed: 0.0298s/iter; left time: 268.5521s
	iters: 200, epoch: 3 | loss: 0.5944189
	speed: 0.0242s/iter; left time: 215.7047s
	iters: 300, epoch: 3 | loss: 0.6428163
	speed: 0.0214s/iter; left time: 188.5777s
	iters: 400, epoch: 3 | loss: 0.4343412
	speed: 0.0198s/iter; left time: 173.0158s
	iters: 500, epoch: 3 | loss: 0.5084160
	speed: 0.0189s/iter; left time: 162.6512s
	iters: 600, epoch: 3 | loss: 0.7365224
	speed: 0.0189s/iter; left time: 160.9816s
	iters: 700, epoch: 3 | loss: 0.4242702
	speed: 0.0191s/iter; left time: 161.1620s
	iters: 800, epoch: 3 | loss: 0.5067337
	speed: 0.0196s/iter; left time: 162.9981s
	iters: 900, epoch: 3 | loss: 0.4181255
	speed: 0.0205s/iter; left time: 168.5298s
	iters: 1000, epoch: 3 | loss: 0.8296825
	speed: 0.0209s/iter; left time: 169.6032s
	iters: 1100, epoch: 3 | loss: 0.9412493
	speed: 0.0212s/iter; left time: 170.1642s
Epoch: 3 cost time: 24.439440488815308
Epoch: 3, Steps: 1140 | Train Loss: 0.5594882 Vali Loss: 0.5731600 Test Loss: 0.2774518
Validation loss decreased (0.585629 --> 0.573160).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5463709
	speed: 0.0279s/iter; left time: 220.0532s
	iters: 200, epoch: 4 | loss: 0.4757363
	speed: 0.0250s/iter; left time: 194.5418s
	iters: 300, epoch: 4 | loss: 0.5790150
	speed: 0.0239s/iter; left time: 183.9331s
	iters: 400, epoch: 4 | loss: 0.4203850
	speed: 0.0236s/iter; left time: 179.1968s
	iters: 500, epoch: 4 | loss: 0.4433952
	speed: 0.0248s/iter; left time: 185.9023s
	iters: 600, epoch: 4 | loss: 0.9721323
	speed: 0.0238s/iter; left time: 175.8495s
	iters: 700, epoch: 4 | loss: 0.4170352
	speed: 0.0233s/iter; left time: 169.2868s
	iters: 800, epoch: 4 | loss: 0.3916102
	speed: 0.0229s/iter; left time: 164.6708s
	iters: 900, epoch: 4 | loss: 0.4349667
	speed: 0.0228s/iter; left time: 161.3389s
	iters: 1000, epoch: 4 | loss: 0.4450949
	speed: 0.0226s/iter; left time: 157.5582s
	iters: 1100, epoch: 4 | loss: 0.7716917
	speed: 0.0224s/iter; left time: 154.1389s
Epoch: 4 cost time: 25.92848253250122
Epoch: 4, Steps: 1140 | Train Loss: 0.5486024 Vali Loss: 0.5740191 Test Loss: 0.2773273
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4900222
	speed: 0.0389s/iter; left time: 261.9649s
	iters: 200, epoch: 5 | loss: 0.4900815
	speed: 0.0324s/iter; left time: 214.9802s
	iters: 300, epoch: 5 | loss: 0.5165507
	speed: 0.0291s/iter; left time: 190.3163s
	iters: 400, epoch: 5 | loss: 0.5000362
	speed: 0.0275s/iter; left time: 176.8632s
	iters: 500, epoch: 5 | loss: 0.4165553
	speed: 0.0265s/iter; left time: 167.8612s
	iters: 600, epoch: 5 | loss: 0.5245151
	speed: 0.0271s/iter; left time: 169.2808s
	iters: 700, epoch: 5 | loss: 0.4797999
	speed: 0.0267s/iter; left time: 163.8166s
	iters: 800, epoch: 5 | loss: 0.4172017
	speed: 0.0262s/iter; left time: 158.4408s
	iters: 900, epoch: 5 | loss: 0.4713066
	speed: 0.0265s/iter; left time: 157.6585s
	iters: 1000, epoch: 5 | loss: 0.6672721
	speed: 0.0261s/iter; left time: 152.7056s
	iters: 1100, epoch: 5 | loss: 0.6060209
	speed: 0.0258s/iter; left time: 148.3848s
Epoch: 5 cost time: 29.5706787109375
Epoch: 5, Steps: 1140 | Train Loss: 0.5416373 Vali Loss: 0.5770702 Test Loss: 0.2779237
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6969306
	speed: 0.0231s/iter; left time: 129.5263s
	iters: 200, epoch: 6 | loss: 0.7274523
	speed: 0.0212s/iter; left time: 116.6075s
	iters: 300, epoch: 6 | loss: 0.4635217
	speed: 0.0198s/iter; left time: 106.6783s
	iters: 400, epoch: 6 | loss: 0.3579783
	speed: 0.0189s/iter; left time: 100.3619s
	iters: 500, epoch: 6 | loss: 0.4879791
	speed: 0.0195s/iter; left time: 101.6093s
	iters: 600, epoch: 6 | loss: 0.4569214
	speed: 0.0202s/iter; left time: 102.8666s
	iters: 700, epoch: 6 | loss: 0.4777012
	speed: 0.0205s/iter; left time: 102.5608s
	iters: 800, epoch: 6 | loss: 0.8402530
	speed: 0.0217s/iter; left time: 106.3737s
	iters: 900, epoch: 6 | loss: 0.4249978
	speed: 0.0226s/iter; left time: 108.6289s
	iters: 1000, epoch: 6 | loss: 0.5596581
	speed: 0.0228s/iter; left time: 107.1208s
	iters: 1100, epoch: 6 | loss: 0.4785318
	speed: 0.0228s/iter; left time: 105.0470s
Epoch: 6 cost time: 26.413389444351196
Epoch: 6, Steps: 1140 | Train Loss: 0.5380494 Vali Loss: 0.5772219 Test Loss: 0.2772615
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4797864
	speed: 0.0391s/iter; left time: 174.5535s
	iters: 200, epoch: 7 | loss: 0.5143303
	speed: 0.0318s/iter; left time: 138.8586s
	iters: 300, epoch: 7 | loss: 0.8061295
	speed: 0.0311s/iter; left time: 132.4070s
	iters: 400, epoch: 7 | loss: 0.6238152
	speed: 0.0328s/iter; left time: 136.6712s
	iters: 500, epoch: 7 | loss: 0.5456288
	speed: 0.0311s/iter; left time: 126.2465s
	iters: 600, epoch: 7 | loss: 0.4089672
	speed: 0.0291s/iter; left time: 115.4035s
	iters: 700, epoch: 7 | loss: 0.3991763
	speed: 0.0278s/iter; left time: 107.3303s
	iters: 800, epoch: 7 | loss: 0.7275956
	speed: 0.0268s/iter; left time: 100.9296s
	iters: 900, epoch: 7 | loss: 0.7406315
	speed: 0.0263s/iter; left time: 96.3474s
	iters: 1000, epoch: 7 | loss: 0.4712114
	speed: 0.0263s/iter; left time: 93.5914s
	iters: 1100, epoch: 7 | loss: 0.4524057
	speed: 0.0272s/iter; left time: 94.1036s
Epoch: 7 cost time: 31.479594469070435
Epoch: 7, Steps: 1140 | Train Loss: 0.5370227 Vali Loss: 0.5774604 Test Loss: 0.2770978
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.7320933
	speed: 0.0424s/iter; left time: 140.6937s
	iters: 200, epoch: 8 | loss: 1.0029143
	speed: 0.0407s/iter; left time: 131.0189s
	iters: 300, epoch: 8 | loss: 0.7723351
	speed: 0.0363s/iter; left time: 113.3846s
	iters: 400, epoch: 8 | loss: 1.0398574
	speed: 0.0336s/iter; left time: 101.3652s
	iters: 500, epoch: 8 | loss: 0.4672679
	speed: 0.0312s/iter; left time: 91.0592s
	iters: 600, epoch: 8 | loss: 0.7005520
	speed: 0.0293s/iter; left time: 82.6428s
	iters: 700, epoch: 8 | loss: 0.6733835
	speed: 0.0280s/iter; left time: 76.0683s
	iters: 800, epoch: 8 | loss: 0.7495345
	speed: 0.0276s/iter; left time: 72.2899s
	iters: 900, epoch: 8 | loss: 0.4533018
	speed: 0.0275s/iter; left time: 69.3569s
	iters: 1000, epoch: 8 | loss: 0.4706408
	speed: 0.0279s/iter; left time: 67.5112s
	iters: 1100, epoch: 8 | loss: 0.4499427
	speed: 0.0273s/iter; left time: 63.4783s
Epoch: 8 cost time: 31.064786434173584
Epoch: 8, Steps: 1140 | Train Loss: 0.5354226 Vali Loss: 0.5782211 Test Loss: 0.2772222
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.27745163440704346, mae:0.2989180088043213
Use GPU: cuda:0
no_skip False
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.5737299
	speed: 0.0306s/iter; left time: 346.3672s
	iters: 200, epoch: 1 | loss: 0.5577775
	speed: 0.0261s/iter; left time: 292.2707s
	iters: 300, epoch: 1 | loss: 0.6701199
	speed: 0.0240s/iter; left time: 266.8968s
	iters: 400, epoch: 1 | loss: 0.4838650
	speed: 0.0230s/iter; left time: 253.4480s
	iters: 500, epoch: 1 | loss: 0.7361814
	speed: 0.0229s/iter; left time: 249.2909s
	iters: 600, epoch: 1 | loss: 0.7865325
	speed: 0.0227s/iter; left time: 245.1967s
	iters: 700, epoch: 1 | loss: 0.4501785
	speed: 0.0224s/iter; left time: 239.4214s
	iters: 800, epoch: 1 | loss: 0.8475403
	speed: 0.0223s/iter; left time: 236.1591s
	iters: 900, epoch: 1 | loss: 0.4416650
	speed: 0.0223s/iter; left time: 234.0619s
	iters: 1000, epoch: 1 | loss: 1.0751606
	speed: 0.0236s/iter; left time: 245.4893s
	iters: 1100, epoch: 1 | loss: 0.4926669
	speed: 0.0247s/iter; left time: 254.8544s
Epoch: 1 cost time: 28.782729387283325
Epoch: 1, Steps: 1140 | Train Loss: 0.6273515 Vali Loss: 0.6180017 Test Loss: 0.2855277
Validation loss decreased (inf --> 0.618002).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4672621
	speed: 0.0261s/iter; left time: 265.0453s
	iters: 200, epoch: 2 | loss: 0.5594398
	speed: 0.0257s/iter; left time: 258.1127s
	iters: 300, epoch: 2 | loss: 0.4927077
	speed: 0.0241s/iter; left time: 240.1626s
	iters: 400, epoch: 2 | loss: 0.5012719
	speed: 0.0223s/iter; left time: 220.2765s
	iters: 500, epoch: 2 | loss: 0.5073765
	speed: 0.0219s/iter; left time: 214.1435s
	iters: 600, epoch: 2 | loss: 0.7604391
	speed: 0.0223s/iter; left time: 215.5064s
	iters: 700, epoch: 2 | loss: 0.4793427
	speed: 0.0225s/iter; left time: 214.8133s
	iters: 800, epoch: 2 | loss: 0.7298950
	speed: 0.0225s/iter; left time: 212.5000s
	iters: 900, epoch: 2 | loss: 0.6851524
	speed: 0.0223s/iter; left time: 209.0136s
	iters: 1000, epoch: 2 | loss: 0.5410745
	speed: 0.0224s/iter; left time: 207.1056s
	iters: 1100, epoch: 2 | loss: 0.4071260
	speed: 0.0225s/iter; left time: 206.2340s
Epoch: 2 cost time: 25.872003316879272
Epoch: 2, Steps: 1140 | Train Loss: 0.5829340 Vali Loss: 0.5945168 Test Loss: 0.2813759
Validation loss decreased (0.618002 --> 0.594517).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4476842
	speed: 0.0343s/iter; left time: 309.0957s
	iters: 200, epoch: 3 | loss: 0.4372422
	speed: 0.0279s/iter; left time: 249.1812s
	iters: 300, epoch: 3 | loss: 0.5061466
	speed: 0.0257s/iter; left time: 227.0749s
	iters: 400, epoch: 3 | loss: 0.4319816
	speed: 0.0251s/iter; left time: 218.9040s
	iters: 500, epoch: 3 | loss: 0.5570906
	speed: 0.0242s/iter; left time: 208.9835s
	iters: 600, epoch: 3 | loss: 0.5664368
	speed: 0.0233s/iter; left time: 198.2906s
	iters: 700, epoch: 3 | loss: 0.4639929
	speed: 0.0231s/iter; left time: 194.3706s
	iters: 800, epoch: 3 | loss: 0.4128472
	speed: 0.0230s/iter; left time: 191.0667s
	iters: 900, epoch: 3 | loss: 0.8010874
	speed: 0.0231s/iter; left time: 189.9718s
	iters: 1000, epoch: 3 | loss: 0.5873488
	speed: 0.0241s/iter; left time: 195.3710s
	iters: 1100, epoch: 3 | loss: 0.7469055
	speed: 0.0241s/iter; left time: 193.4625s
Epoch: 3 cost time: 27.46360731124878
Epoch: 3, Steps: 1140 | Train Loss: 0.5670518 Vali Loss: 0.5952933 Test Loss: 0.2801075
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.7394855
	speed: 0.0281s/iter; left time: 221.7981s
	iters: 200, epoch: 4 | loss: 0.4172672
	speed: 0.0259s/iter; left time: 201.4930s
	iters: 300, epoch: 4 | loss: 0.4770508
	speed: 0.0240s/iter; left time: 184.0423s
	iters: 400, epoch: 4 | loss: 0.4172668
	speed: 0.0231s/iter; left time: 175.4301s
	iters: 500, epoch: 4 | loss: 0.4828707
	speed: 0.0220s/iter; left time: 164.5032s
	iters: 600, epoch: 4 | loss: 0.4682359
	speed: 0.0218s/iter; left time: 160.9165s
	iters: 700, epoch: 4 | loss: 0.8062220
	speed: 0.0217s/iter; left time: 158.3553s
	iters: 800, epoch: 4 | loss: 0.5337642
	speed: 0.0219s/iter; left time: 157.1143s
	iters: 900, epoch: 4 | loss: 0.7852200
	speed: 0.0222s/iter; left time: 157.0212s
	iters: 1000, epoch: 4 | loss: 0.6554134
	speed: 0.0224s/iter; left time: 156.1765s
	iters: 1100, epoch: 4 | loss: 0.4410406
	speed: 0.0225s/iter; left time: 155.0111s
Epoch: 4 cost time: 25.878798961639404
Epoch: 4, Steps: 1140 | Train Loss: 0.5559931 Vali Loss: 0.5896365 Test Loss: 0.2789021
Validation loss decreased (0.594517 --> 0.589637).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4225220
	speed: 0.0440s/iter; left time: 296.3328s
	iters: 200, epoch: 5 | loss: 0.9014751
	speed: 0.0410s/iter; left time: 272.5067s
	iters: 300, epoch: 5 | loss: 0.5457988
	speed: 0.0409s/iter; left time: 267.3855s
	iters: 400, epoch: 5 | loss: 0.7439742
	speed: 0.0356s/iter; left time: 229.4975s
	iters: 500, epoch: 5 | loss: 0.3961528
	speed: 0.0324s/iter; left time: 205.6401s
	iters: 600, epoch: 5 | loss: 0.5149734
	speed: 0.0308s/iter; left time: 192.4819s
	iters: 700, epoch: 5 | loss: 0.4704936
	speed: 0.0291s/iter; left time: 178.4567s
	iters: 800, epoch: 5 | loss: 0.4858411
	speed: 0.0292s/iter; left time: 176.5538s
	iters: 900, epoch: 5 | loss: 0.6809697
	speed: 0.0292s/iter; left time: 173.7348s
	iters: 1000, epoch: 5 | loss: 0.7660263
	speed: 0.0284s/iter; left time: 165.8555s
	iters: 1100, epoch: 5 | loss: 0.4709253
	speed: 0.0278s/iter; left time: 159.8829s
Epoch: 5 cost time: 31.810075759887695
Epoch: 5, Steps: 1140 | Train Loss: 0.5495723 Vali Loss: 0.5926034 Test Loss: 0.2795140
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4521469
	speed: 0.0460s/iter; left time: 257.6446s
	iters: 200, epoch: 6 | loss: 0.4383315
	speed: 0.0368s/iter; left time: 202.4955s
	iters: 300, epoch: 6 | loss: 0.3885846
	speed: 0.0321s/iter; left time: 173.2962s
	iters: 400, epoch: 6 | loss: 0.4563848
	speed: 0.0298s/iter; left time: 158.0857s
	iters: 500, epoch: 6 | loss: 0.4718792
	speed: 0.0277s/iter; left time: 144.3020s
	iters: 600, epoch: 6 | loss: 0.4502009
	speed: 0.0266s/iter; left time: 135.6674s
	iters: 700, epoch: 6 | loss: 0.7216040
	speed: 0.0260s/iter; left time: 130.1158s
	iters: 800, epoch: 6 | loss: 0.9866524
	speed: 0.0254s/iter; left time: 124.6550s
	iters: 900, epoch: 6 | loss: 0.9661292
	speed: 0.0248s/iter; left time: 118.8704s
	iters: 1000, epoch: 6 | loss: 0.6069907
	speed: 0.0243s/iter; left time: 114.1746s
	iters: 1100, epoch: 6 | loss: 0.4221132
	speed: 0.0237s/iter; left time: 109.0048s
Epoch: 6 cost time: 26.92244863510132
Epoch: 6, Steps: 1140 | Train Loss: 0.5460649 Vali Loss: 0.5910535 Test Loss: 0.2788203
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3925374
	speed: 0.0276s/iter; left time: 122.9880s
	iters: 200, epoch: 7 | loss: 0.3942683
	speed: 0.0251s/iter; left time: 109.2794s
	iters: 300, epoch: 7 | loss: 0.7629859
	speed: 0.0242s/iter; left time: 103.1929s
	iters: 400, epoch: 7 | loss: 0.4473808
	speed: 0.0238s/iter; left time: 98.8515s
	iters: 500, epoch: 7 | loss: 0.4040720
	speed: 0.0235s/iter; left time: 95.5402s
	iters: 600, epoch: 7 | loss: 0.7501710
	speed: 0.0229s/iter; left time: 90.6908s
	iters: 700, epoch: 7 | loss: 0.3643281
	speed: 0.0228s/iter; left time: 88.1421s
	iters: 800, epoch: 7 | loss: 0.4772868
	speed: 0.0228s/iter; left time: 85.6208s
	iters: 900, epoch: 7 | loss: 0.4421647
	speed: 0.0227s/iter; left time: 83.1544s
	iters: 1000, epoch: 7 | loss: 0.5345088
	speed: 0.0226s/iter; left time: 80.5997s
	iters: 1100, epoch: 7 | loss: 0.5532286
	speed: 0.0228s/iter; left time: 78.7807s
Epoch: 7 cost time: 26.148144960403442
Epoch: 7, Steps: 1140 | Train Loss: 0.5442346 Vali Loss: 0.5930553 Test Loss: 0.2793026
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4935339
	speed: 0.0352s/iter; left time: 116.9072s
	iters: 200, epoch: 8 | loss: 0.5671283
	speed: 0.0304s/iter; left time: 98.0131s
	iters: 300, epoch: 8 | loss: 0.4912018
	speed: 0.0286s/iter; left time: 89.3120s
	iters: 400, epoch: 8 | loss: 0.4982579
	speed: 0.0275s/iter; left time: 83.0048s
	iters: 500, epoch: 8 | loss: 0.5830547
	speed: 0.0265s/iter; left time: 77.4667s
	iters: 600, epoch: 8 | loss: 0.5044166
	speed: 0.0261s/iter; left time: 73.6926s
	iters: 700, epoch: 8 | loss: 0.8800130
	speed: 0.0262s/iter; left time: 71.3852s
	iters: 800, epoch: 8 | loss: 0.4878539
	speed: 0.0255s/iter; left time: 66.8993s
	iters: 900, epoch: 8 | loss: 0.7020994
	speed: 0.0251s/iter; left time: 63.3840s
	iters: 1000, epoch: 8 | loss: 0.7009045
	speed: 0.0248s/iter; left time: 59.9717s
	iters: 1100, epoch: 8 | loss: 0.5061803
	speed: 0.0245s/iter; left time: 56.8459s
Epoch: 8 cost time: 27.982317209243774
Epoch: 8, Steps: 1140 | Train Loss: 0.5429625 Vali Loss: 0.5922764 Test Loss: 0.2791927
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4280585
	speed: 0.0219s/iter; left time: 47.7242s
	iters: 200, epoch: 9 | loss: 0.7531385
	speed: 0.0217s/iter; left time: 45.1142s
	iters: 300, epoch: 9 | loss: 0.7120239
	speed: 0.0227s/iter; left time: 44.8856s
	iters: 400, epoch: 9 | loss: 0.4303885
	speed: 0.0230s/iter; left time: 43.3283s
	iters: 500, epoch: 9 | loss: 0.4377482
	speed: 0.0238s/iter; left time: 42.3731s
	iters: 600, epoch: 9 | loss: 0.5268543
	speed: 0.0249s/iter; left time: 41.7978s
	iters: 700, epoch: 9 | loss: 0.4560983
	speed: 0.0246s/iter; left time: 38.8259s
	iters: 800, epoch: 9 | loss: 0.4608516
	speed: 0.0243s/iter; left time: 35.9994s
	iters: 900, epoch: 9 | loss: 0.3988005
	speed: 0.0239s/iter; left time: 33.0725s
	iters: 1000, epoch: 9 | loss: 0.4362817
	speed: 0.0236s/iter; left time: 30.2387s
	iters: 1100, epoch: 9 | loss: 0.4656560
	speed: 0.0232s/iter; left time: 27.4343s
Epoch: 9 cost time: 26.47063159942627
Epoch: 9, Steps: 1140 | Train Loss: 0.5425834 Vali Loss: 0.5928014 Test Loss: 0.2791810
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.2789021134376526, mae:0.3000853657722473
Seed: 42
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_720      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip False
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.6651487
	speed: 0.0530s/iter; left time: 592.8051s
	iters: 200, epoch: 1 | loss: 0.7811943
	speed: 0.0387s/iter; left time: 428.9030s
	iters: 300, epoch: 1 | loss: 0.6176246
	speed: 0.0339s/iter; left time: 372.5756s
	iters: 400, epoch: 1 | loss: 0.7293441
	speed: 0.0315s/iter; left time: 343.1109s
	iters: 500, epoch: 1 | loss: 0.6261045
	speed: 0.0301s/iter; left time: 324.1573s
	iters: 600, epoch: 1 | loss: 0.6382415
	speed: 0.0291s/iter; left time: 310.9649s
	iters: 700, epoch: 1 | loss: 0.5130424
	speed: 0.0281s/iter; left time: 297.8454s
	iters: 800, epoch: 1 | loss: 0.8412953
	speed: 0.0273s/iter; left time: 286.3430s
	iters: 900, epoch: 1 | loss: 0.6589098
	speed: 0.0268s/iter; left time: 277.8346s
	iters: 1000, epoch: 1 | loss: 0.5941604
	speed: 0.0262s/iter; left time: 269.2867s
	iters: 1100, epoch: 1 | loss: 0.7090474
	speed: 0.0256s/iter; left time: 260.8534s
Epoch: 1 cost time: 28.900312900543213
Epoch: 1, Steps: 1128 | Train Loss: 0.7007834 Vali Loss: 0.7234959 Test Loss: 0.3593775
Validation loss decreased (inf --> 0.723496).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6891991
	speed: 0.0380s/iter; left time: 382.3198s
	iters: 200, epoch: 2 | loss: 0.7146151
	speed: 0.0303s/iter; left time: 301.2432s
	iters: 300, epoch: 2 | loss: 0.6353567
	speed: 0.0277s/iter; left time: 272.6957s
	iters: 400, epoch: 2 | loss: 0.6210521
	speed: 0.0264s/iter; left time: 257.9617s
	iters: 500, epoch: 2 | loss: 0.5963264
	speed: 0.0257s/iter; left time: 248.1161s
	iters: 600, epoch: 2 | loss: 0.5676033
	speed: 0.0255s/iter; left time: 243.7160s
	iters: 700, epoch: 2 | loss: 0.8613590
	speed: 0.0254s/iter; left time: 240.1717s
	iters: 800, epoch: 2 | loss: 0.7539347
	speed: 0.0253s/iter; left time: 237.0342s
	iters: 900, epoch: 2 | loss: 0.5283630
	speed: 0.0257s/iter; left time: 237.4616s
	iters: 1000, epoch: 2 | loss: 0.6402929
	speed: 0.0260s/iter; left time: 238.1517s
	iters: 1100, epoch: 2 | loss: 0.5107037
	speed: 0.0256s/iter; left time: 231.6276s
Epoch: 2 cost time: 28.854294538497925
Epoch: 2, Steps: 1128 | Train Loss: 0.6613371 Vali Loss: 0.7151913 Test Loss: 0.3540694
Validation loss decreased (0.723496 --> 0.715191).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6306871
	speed: 0.0357s/iter; left time: 318.2464s
	iters: 200, epoch: 3 | loss: 0.6612006
	speed: 0.0297s/iter; left time: 262.0887s
	iters: 300, epoch: 3 | loss: 0.6528730
	speed: 0.0253s/iter; left time: 220.8021s
	iters: 400, epoch: 3 | loss: 0.5717140
	speed: 0.0254s/iter; left time: 218.9488s
	iters: 500, epoch: 3 | loss: 0.5309896
	speed: 0.0244s/iter; left time: 208.2822s
	iters: 600, epoch: 3 | loss: 0.5528000
	speed: 0.0244s/iter; left time: 205.3415s
	iters: 700, epoch: 3 | loss: 0.5475608
	speed: 0.0237s/iter; left time: 197.0973s
	iters: 800, epoch: 3 | loss: 0.4837451
	speed: 0.0231s/iter; left time: 189.9042s
	iters: 900, epoch: 3 | loss: 0.6840532
	speed: 0.0225s/iter; left time: 182.7550s
	iters: 1000, epoch: 3 | loss: 0.5751120
	speed: 0.0218s/iter; left time: 174.9646s
	iters: 1100, epoch: 3 | loss: 0.5337043
	speed: 0.0214s/iter; left time: 169.3967s
Epoch: 3 cost time: 24.168704986572266
Epoch: 3, Steps: 1128 | Train Loss: 0.6432060 Vali Loss: 0.7083855 Test Loss: 0.3527682
Validation loss decreased (0.715191 --> 0.708386).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6991414
	speed: 0.0354s/iter; left time: 275.8021s
	iters: 200, epoch: 4 | loss: 0.5582666
	speed: 0.0299s/iter; left time: 230.2909s
	iters: 300, epoch: 4 | loss: 0.7491379
	speed: 0.0280s/iter; left time: 212.3712s
	iters: 400, epoch: 4 | loss: 0.5253151
	speed: 0.0270s/iter; left time: 202.7365s
	iters: 500, epoch: 4 | loss: 0.5721711
	speed: 0.0262s/iter; left time: 193.5834s
	iters: 600, epoch: 4 | loss: 0.7425511
	speed: 0.0259s/iter; left time: 188.8006s
	iters: 700, epoch: 4 | loss: 0.4801461
	speed: 0.0254s/iter; left time: 183.1271s
	iters: 800, epoch: 4 | loss: 0.5857108
	speed: 0.0251s/iter; left time: 178.1500s
	iters: 900, epoch: 4 | loss: 0.7063582
	speed: 0.0245s/iter; left time: 171.2077s
	iters: 1000, epoch: 4 | loss: 0.7293273
	speed: 0.0239s/iter; left time: 165.1408s
	iters: 1100, epoch: 4 | loss: 0.6531575
	speed: 0.0232s/iter; left time: 157.9138s
Epoch: 4 cost time: 26.11560845375061
Epoch: 4, Steps: 1128 | Train Loss: 0.6329686 Vali Loss: 0.7104535 Test Loss: 0.3528555
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5918570
	speed: 0.0244s/iter; left time: 162.9671s
	iters: 200, epoch: 5 | loss: 0.4813672
	speed: 0.0246s/iter; left time: 161.6018s
	iters: 300, epoch: 5 | loss: 0.6345244
	speed: 0.0245s/iter; left time: 158.3441s
	iters: 400, epoch: 5 | loss: 0.5105395
	speed: 0.0245s/iter; left time: 156.2531s
	iters: 500, epoch: 5 | loss: 0.6537612
	speed: 0.0246s/iter; left time: 153.9603s
	iters: 600, epoch: 5 | loss: 0.5618880
	speed: 0.0245s/iter; left time: 151.3435s
	iters: 700, epoch: 5 | loss: 0.6583289
	speed: 0.0245s/iter; left time: 148.6140s
	iters: 800, epoch: 5 | loss: 0.8202426
	speed: 0.0245s/iter; left time: 146.1786s
	iters: 900, epoch: 5 | loss: 0.5558253
	speed: 0.0245s/iter; left time: 143.6279s
	iters: 1000, epoch: 5 | loss: 0.9117838
	speed: 0.0245s/iter; left time: 141.0694s
	iters: 1100, epoch: 5 | loss: 0.6819866
	speed: 0.0243s/iter; left time: 137.6168s
Epoch: 5 cost time: 27.479466199874878
Epoch: 5, Steps: 1128 | Train Loss: 0.6269619 Vali Loss: 0.7111937 Test Loss: 0.3528486
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.9957070
	speed: 0.0281s/iter; left time: 155.7179s
	iters: 200, epoch: 6 | loss: 0.7410634
	speed: 0.0253s/iter; left time: 137.7454s
	iters: 300, epoch: 6 | loss: 0.6135746
	speed: 0.0247s/iter; left time: 132.1076s
	iters: 400, epoch: 6 | loss: 0.4690835
	speed: 0.0254s/iter; left time: 133.0397s
	iters: 500, epoch: 6 | loss: 0.6543069
	speed: 0.0247s/iter; left time: 126.7538s
	iters: 600, epoch: 6 | loss: 0.7013672
	speed: 0.0241s/iter; left time: 121.4956s
	iters: 700, epoch: 6 | loss: 0.6140136
	speed: 0.0236s/iter; left time: 116.4137s
	iters: 800, epoch: 6 | loss: 0.6213608
	speed: 0.0231s/iter; left time: 111.9356s
	iters: 900, epoch: 6 | loss: 0.4619334
	speed: 0.0229s/iter; left time: 108.6270s
	iters: 1000, epoch: 6 | loss: 0.5285681
	speed: 0.0227s/iter; left time: 105.1748s
	iters: 1100, epoch: 6 | loss: 0.6138029
	speed: 0.0224s/iter; left time: 101.8947s
Epoch: 6 cost time: 25.38212823867798
Epoch: 6, Steps: 1128 | Train Loss: 0.6233981 Vali Loss: 0.7159680 Test Loss: 0.3537739
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8795089
	speed: 0.0345s/iter; left time: 152.2152s
	iters: 200, epoch: 7 | loss: 0.6417277
	speed: 0.0298s/iter; left time: 128.5570s
	iters: 300, epoch: 7 | loss: 0.4454684
	speed: 0.0274s/iter; left time: 115.5791s
	iters: 400, epoch: 7 | loss: 0.5581197
	speed: 0.0253s/iter; left time: 104.0081s
	iters: 500, epoch: 7 | loss: 0.6708559
	speed: 0.0253s/iter; left time: 101.4425s
	iters: 600, epoch: 7 | loss: 0.6937587
	speed: 0.0261s/iter; left time: 102.0638s
	iters: 700, epoch: 7 | loss: 0.6725690
	speed: 0.0259s/iter; left time: 98.6588s
	iters: 800, epoch: 7 | loss: 0.6922987
	speed: 0.0257s/iter; left time: 95.5091s
	iters: 900, epoch: 7 | loss: 0.5764055
	speed: 0.0256s/iter; left time: 92.5179s
	iters: 1000, epoch: 7 | loss: 0.5298860
	speed: 0.0256s/iter; left time: 89.7949s
	iters: 1100, epoch: 7 | loss: 0.5356373
	speed: 0.0257s/iter; left time: 87.7479s
Epoch: 7 cost time: 29.472599744796753
Epoch: 7, Steps: 1128 | Train Loss: 0.6214532 Vali Loss: 0.7151303 Test Loss: 0.3539471
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.5646436
	speed: 0.0354s/iter; left time: 116.3056s
	iters: 200, epoch: 8 | loss: 0.5423415
	speed: 0.0291s/iter; left time: 92.8176s
	iters: 300, epoch: 8 | loss: 0.6368155
	speed: 0.0261s/iter; left time: 80.4216s
	iters: 400, epoch: 8 | loss: 0.9682679
	speed: 0.0244s/iter; left time: 72.9673s
	iters: 500, epoch: 8 | loss: 1.0189890
	speed: 0.0235s/iter; left time: 67.9024s
	iters: 600, epoch: 8 | loss: 0.5744784
	speed: 0.0231s/iter; left time: 64.4345s
	iters: 700, epoch: 8 | loss: 0.7814108
	speed: 0.0231s/iter; left time: 61.9069s
	iters: 800, epoch: 8 | loss: 0.9279187
	speed: 0.0230s/iter; left time: 59.4327s
	iters: 900, epoch: 8 | loss: 0.4745955
	speed: 0.0230s/iter; left time: 57.1352s
	iters: 1000, epoch: 8 | loss: 0.6392708
	speed: 0.0231s/iter; left time: 55.1874s
	iters: 1100, epoch: 8 | loss: 0.6126509
	speed: 0.0233s/iter; left time: 53.1408s
Epoch: 8 cost time: 26.391351222991943
Epoch: 8, Steps: 1128 | Train Loss: 0.6205686 Vali Loss: 0.7162862 Test Loss: 0.3539170
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.3527681529521942, mae:0.3504127562046051
Use GPU: cuda:0
no_skip False
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.6635875
	speed: 0.0241s/iter; left time: 269.0418s
	iters: 200, epoch: 1 | loss: 0.9478549
	speed: 0.0225s/iter; left time: 249.6009s
	iters: 300, epoch: 1 | loss: 0.6859183
	speed: 0.0230s/iter; left time: 253.0601s
	iters: 400, epoch: 1 | loss: 0.5526159
	speed: 0.0222s/iter; left time: 241.0660s
	iters: 500, epoch: 1 | loss: 0.7675070
	speed: 0.0221s/iter; left time: 238.0789s
	iters: 600, epoch: 1 | loss: 0.5610088
	speed: 0.0225s/iter; left time: 240.1132s
	iters: 700, epoch: 1 | loss: 0.8412519
	speed: 0.0227s/iter; left time: 240.5938s
	iters: 800, epoch: 1 | loss: 0.6104634
	speed: 0.0227s/iter; left time: 237.5152s
	iters: 900, epoch: 1 | loss: 0.6421524
	speed: 0.0225s/iter; left time: 233.9637s
	iters: 1000, epoch: 1 | loss: 0.8746327
	speed: 0.0231s/iter; left time: 237.3448s
	iters: 1100, epoch: 1 | loss: 0.5139711
	speed: 0.0238s/iter; left time: 242.3997s
Epoch: 1 cost time: 27.230020761489868
Epoch: 1, Steps: 1128 | Train Loss: 0.7048643 Vali Loss: 0.7272204 Test Loss: 0.3600320
Validation loss decreased (inf --> 0.727220).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8937628
	speed: 0.0329s/iter; left time: 330.4369s
	iters: 200, epoch: 2 | loss: 0.6892549
	speed: 0.0296s/iter; left time: 295.0399s
	iters: 300, epoch: 2 | loss: 0.7116165
	speed: 0.0278s/iter; left time: 273.8673s
	iters: 400, epoch: 2 | loss: 0.6211987
	speed: 0.0267s/iter; left time: 260.8910s
	iters: 500, epoch: 2 | loss: 0.4991851
	speed: 0.0266s/iter; left time: 256.3583s
	iters: 600, epoch: 2 | loss: 0.5584026
	speed: 0.0280s/iter; left time: 267.6418s
	iters: 700, epoch: 2 | loss: 0.5696898
	speed: 0.0289s/iter; left time: 273.0450s
	iters: 800, epoch: 2 | loss: 0.5459635
	speed: 0.0283s/iter; left time: 265.0346s
	iters: 900, epoch: 2 | loss: 0.6506684
	speed: 0.0280s/iter; left time: 258.6582s
	iters: 1000, epoch: 2 | loss: 0.6140715
	speed: 0.0274s/iter; left time: 250.8270s
	iters: 1100, epoch: 2 | loss: 0.6979234
	speed: 0.0270s/iter; left time: 244.2053s
Epoch: 2 cost time: 30.593243837356567
Epoch: 2, Steps: 1128 | Train Loss: 0.6618316 Vali Loss: 0.7061117 Test Loss: 0.3549616
Validation loss decreased (0.727220 --> 0.706112).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5712194
	speed: 0.0302s/iter; left time: 269.9614s
	iters: 200, epoch: 3 | loss: 0.7187073
	speed: 0.0249s/iter; left time: 219.7599s
	iters: 300, epoch: 3 | loss: 0.6157231
	speed: 0.0237s/iter; left time: 207.1828s
	iters: 400, epoch: 3 | loss: 0.6506821
	speed: 0.0236s/iter; left time: 203.1544s
	iters: 500, epoch: 3 | loss: 0.8130702
	speed: 0.0234s/iter; left time: 199.4171s
	iters: 600, epoch: 3 | loss: 0.7977909
	speed: 0.0233s/iter; left time: 196.2219s
	iters: 700, epoch: 3 | loss: 0.5372906
	speed: 0.0235s/iter; left time: 195.4353s
	iters: 800, epoch: 3 | loss: 0.7482330
	speed: 0.0236s/iter; left time: 194.2584s
	iters: 900, epoch: 3 | loss: 0.7724829
	speed: 0.0237s/iter; left time: 192.6918s
	iters: 1000, epoch: 3 | loss: 0.6412244
	speed: 0.0236s/iter; left time: 189.6360s
	iters: 1100, epoch: 3 | loss: 0.5717068
	speed: 0.0236s/iter; left time: 187.0006s
Epoch: 3 cost time: 26.728453636169434
Epoch: 3, Steps: 1128 | Train Loss: 0.6446462 Vali Loss: 0.7089828 Test Loss: 0.3552271
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6852992
	speed: 0.0269s/iter; left time: 209.5522s
	iters: 200, epoch: 4 | loss: 0.7637703
	speed: 0.0248s/iter; left time: 190.7639s
	iters: 300, epoch: 4 | loss: 0.5117040
	speed: 0.0242s/iter; left time: 184.0650s
	iters: 400, epoch: 4 | loss: 0.5498438
	speed: 0.0256s/iter; left time: 191.9845s
	iters: 500, epoch: 4 | loss: 0.6175871
	speed: 0.0257s/iter; left time: 190.2546s
	iters: 600, epoch: 4 | loss: 0.5282315
	speed: 0.0274s/iter; left time: 199.7613s
	iters: 700, epoch: 4 | loss: 0.6209540
	speed: 0.0268s/iter; left time: 192.7618s
	iters: 800, epoch: 4 | loss: 0.5345309
	speed: 0.0258s/iter; left time: 182.8322s
	iters: 900, epoch: 4 | loss: 0.6175373
	speed: 0.0250s/iter; left time: 175.2621s
	iters: 1000, epoch: 4 | loss: 0.6293081
	speed: 0.0243s/iter; left time: 167.8579s
	iters: 1100, epoch: 4 | loss: 0.5545423
	speed: 0.0237s/iter; left time: 161.2018s
Epoch: 4 cost time: 26.718177318572998
Epoch: 4, Steps: 1128 | Train Loss: 0.6336978 Vali Loss: 0.7100504 Test Loss: 0.3549358
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5239106
	speed: 0.0339s/iter; left time: 226.0944s
	iters: 200, epoch: 5 | loss: 0.6962614
	speed: 0.0281s/iter; left time: 184.4055s
	iters: 300, epoch: 5 | loss: 0.8435857
	speed: 0.0269s/iter; left time: 174.3043s
	iters: 400, epoch: 5 | loss: 0.5090196
	speed: 0.0286s/iter; left time: 182.0965s
	iters: 500, epoch: 5 | loss: 0.6335599
	speed: 0.0285s/iter; left time: 178.4471s
	iters: 600, epoch: 5 | loss: 0.4897600
	speed: 0.0275s/iter; left time: 169.4829s
	iters: 700, epoch: 5 | loss: 0.5132479
	speed: 0.0268s/iter; left time: 162.3536s
	iters: 800, epoch: 5 | loss: 0.4891462
	speed: 0.0262s/iter; left time: 156.2571s
	iters: 900, epoch: 5 | loss: 0.5893580
	speed: 0.0260s/iter; left time: 152.5093s
	iters: 1000, epoch: 5 | loss: 0.7080207
	speed: 0.0258s/iter; left time: 149.0545s
	iters: 1100, epoch: 5 | loss: 0.5144036
	speed: 0.0257s/iter; left time: 145.9610s
Epoch: 5 cost time: 29.163673877716064
Epoch: 5, Steps: 1128 | Train Loss: 0.6270704 Vali Loss: 0.7113681 Test Loss: 0.3566372
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6477545
	speed: 0.0257s/iter; left time: 142.3429s
	iters: 200, epoch: 6 | loss: 0.5321873
	speed: 0.0239s/iter; left time: 129.8238s
	iters: 300, epoch: 6 | loss: 0.6071476
	speed: 0.0233s/iter; left time: 124.5416s
	iters: 400, epoch: 6 | loss: 1.1070015
	speed: 0.0237s/iter; left time: 124.3268s
	iters: 500, epoch: 6 | loss: 0.5610883
	speed: 0.0235s/iter; left time: 120.6046s
	iters: 600, epoch: 6 | loss: 0.8171852
	speed: 0.0228s/iter; left time: 114.7367s
	iters: 700, epoch: 6 | loss: 0.5539277
	speed: 0.0223s/iter; left time: 109.9617s
	iters: 800, epoch: 6 | loss: 0.5150181
	speed: 0.0224s/iter; left time: 108.4893s
	iters: 900, epoch: 6 | loss: 0.5595582
	speed: 0.0228s/iter; left time: 108.2267s
	iters: 1000, epoch: 6 | loss: 0.6834378
	speed: 0.0230s/iter; left time: 106.7036s
	iters: 1100, epoch: 6 | loss: 0.6025261
	speed: 0.0231s/iter; left time: 104.9164s
Epoch: 6 cost time: 26.21309804916382
Epoch: 6, Steps: 1128 | Train Loss: 0.6235005 Vali Loss: 0.7123963 Test Loss: 0.3570567
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5019046
	speed: 0.0322s/iter; left time: 142.3189s
	iters: 200, epoch: 7 | loss: 0.4773563
	speed: 0.0278s/iter; left time: 119.7581s
	iters: 300, epoch: 7 | loss: 0.8719721
	speed: 0.0263s/iter; left time: 110.8762s
	iters: 400, epoch: 7 | loss: 0.6414581
	speed: 0.0250s/iter; left time: 102.8946s
	iters: 500, epoch: 7 | loss: 0.6196736
	speed: 0.0239s/iter; left time: 95.9026s
	iters: 600, epoch: 7 | loss: 0.6474840
	speed: 0.0233s/iter; left time: 91.0869s
	iters: 700, epoch: 7 | loss: 0.5492424
	speed: 0.0227s/iter; left time: 86.5409s
	iters: 800, epoch: 7 | loss: 0.5234357
	speed: 0.0219s/iter; left time: 81.1426s
	iters: 900, epoch: 7 | loss: 0.5409349
	speed: 0.0214s/iter; left time: 77.1676s
	iters: 1000, epoch: 7 | loss: 0.6477728
	speed: 0.0209s/iter; left time: 73.5318s
	iters: 1100, epoch: 7 | loss: 0.5534923
	speed: 0.0206s/iter; left time: 70.2827s
Epoch: 7 cost time: 23.600103616714478
Epoch: 7, Steps: 1128 | Train Loss: 0.6216078 Vali Loss: 0.7139838 Test Loss: 0.3571601
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.35496166348457336, mae:0.3488592207431793
Use GPU: cuda:0
no_skip False
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.6817147
	speed: 0.0244s/iter; left time: 272.7800s
	iters: 200, epoch: 1 | loss: 0.5697140
	speed: 0.0223s/iter; left time: 247.1493s
	iters: 300, epoch: 1 | loss: 0.7202435
	speed: 0.0215s/iter; left time: 236.0715s
	iters: 400, epoch: 1 | loss: 0.7963426
	speed: 0.0211s/iter; left time: 229.6269s
	iters: 500, epoch: 1 | loss: 0.7385327
	speed: 0.0207s/iter; left time: 222.8470s
	iters: 600, epoch: 1 | loss: 0.5917056
	speed: 0.0203s/iter; left time: 216.4708s
	iters: 700, epoch: 1 | loss: 0.5742072
	speed: 0.0205s/iter; left time: 217.1231s
	iters: 800, epoch: 1 | loss: 0.6311088
	speed: 0.0207s/iter; left time: 217.3313s
	iters: 900, epoch: 1 | loss: 0.9981080
	speed: 0.0209s/iter; left time: 216.7125s
	iters: 1000, epoch: 1 | loss: 0.5599945
	speed: 0.0212s/iter; left time: 217.8489s
	iters: 1100, epoch: 1 | loss: 0.7250905
	speed: 0.0215s/iter; left time: 219.1732s
Epoch: 1 cost time: 24.527560472488403
Epoch: 1, Steps: 1128 | Train Loss: 0.7066050 Vali Loss: 0.7240512 Test Loss: 0.3583461
Validation loss decreased (inf --> 0.724051).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6217297
	speed: 0.0390s/iter; left time: 391.7240s
	iters: 200, epoch: 2 | loss: 0.9256925
	speed: 0.0310s/iter; left time: 308.6582s
	iters: 300, epoch: 2 | loss: 0.5738113
	speed: 0.0291s/iter; left time: 286.3714s
	iters: 400, epoch: 2 | loss: 0.6129715
	speed: 0.0267s/iter; left time: 260.5856s
	iters: 500, epoch: 2 | loss: 0.5909622
	speed: 0.0256s/iter; left time: 247.3619s
	iters: 600, epoch: 2 | loss: 0.6991428
	speed: 0.0263s/iter; left time: 251.1169s
	iters: 700, epoch: 2 | loss: 0.5360004
	speed: 0.0257s/iter; left time: 243.3482s
	iters: 800, epoch: 2 | loss: 0.5820025
	speed: 0.0254s/iter; left time: 237.5053s
	iters: 900, epoch: 2 | loss: 0.7091644
	speed: 0.0251s/iter; left time: 232.1270s
	iters: 1000, epoch: 2 | loss: 0.4685532
	speed: 0.0250s/iter; left time: 228.6538s
	iters: 1100, epoch: 2 | loss: 0.7182985
	speed: 0.0249s/iter; left time: 225.6966s
Epoch: 2 cost time: 28.266302824020386
Epoch: 2, Steps: 1128 | Train Loss: 0.6564884 Vali Loss: 0.7046547 Test Loss: 0.3527624
Validation loss decreased (0.724051 --> 0.704655).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5774435
	speed: 0.0329s/iter; left time: 293.7695s
	iters: 200, epoch: 3 | loss: 0.6170762
	speed: 0.0277s/iter; left time: 244.1692s
	iters: 300, epoch: 3 | loss: 0.6723593
	speed: 0.0268s/iter; left time: 234.0531s
	iters: 400, epoch: 3 | loss: 0.8120489
	speed: 0.0259s/iter; left time: 223.6652s
	iters: 500, epoch: 3 | loss: 0.5790928
	speed: 0.0250s/iter; left time: 213.1710s
	iters: 600, epoch: 3 | loss: 0.5320565
	speed: 0.0239s/iter; left time: 201.2726s
	iters: 700, epoch: 3 | loss: 0.6235304
	speed: 0.0230s/iter; left time: 191.4086s
	iters: 800, epoch: 3 | loss: 0.7885563
	speed: 0.0223s/iter; left time: 183.7894s
	iters: 900, epoch: 3 | loss: 0.4989285
	speed: 0.0218s/iter; left time: 177.2637s
	iters: 1000, epoch: 3 | loss: 0.8599125
	speed: 0.0214s/iter; left time: 171.8304s
	iters: 1100, epoch: 3 | loss: 0.7046114
	speed: 0.0215s/iter; left time: 170.7409s
Epoch: 3 cost time: 24.79789662361145
Epoch: 3, Steps: 1128 | Train Loss: 0.6390310 Vali Loss: 0.7036171 Test Loss: 0.3531190
Validation loss decreased (0.704655 --> 0.703617).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6338297
	speed: 0.0339s/iter; left time: 264.0615s
	iters: 200, epoch: 4 | loss: 0.5627304
	speed: 0.0285s/iter; left time: 219.5523s
	iters: 300, epoch: 4 | loss: 0.4758511
	speed: 0.0275s/iter; left time: 209.2522s
	iters: 400, epoch: 4 | loss: 0.6114088
	speed: 0.0267s/iter; left time: 199.9886s
	iters: 500, epoch: 4 | loss: 0.4785903
	speed: 0.0263s/iter; left time: 194.4833s
	iters: 600, epoch: 4 | loss: 0.5202351
	speed: 0.0258s/iter; left time: 187.9462s
	iters: 700, epoch: 4 | loss: 0.5546971
	speed: 0.0259s/iter; left time: 186.1590s
	iters: 800, epoch: 4 | loss: 0.5476168
	speed: 0.0255s/iter; left time: 180.8666s
	iters: 900, epoch: 4 | loss: 0.5005985
	speed: 0.0252s/iter; left time: 176.4041s
	iters: 1000, epoch: 4 | loss: 0.4899680
	speed: 0.0251s/iter; left time: 173.1268s
	iters: 1100, epoch: 4 | loss: 0.5345577
	speed: 0.0249s/iter; left time: 169.2467s
Epoch: 4 cost time: 28.13805103302002
Epoch: 4, Steps: 1128 | Train Loss: 0.6283525 Vali Loss: 0.7052135 Test Loss: 0.3535412
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.7221931
	speed: 0.0272s/iter; left time: 181.2612s
	iters: 200, epoch: 5 | loss: 0.8646624
	speed: 0.0285s/iter; left time: 186.9881s
	iters: 300, epoch: 5 | loss: 0.6697881
	speed: 0.0292s/iter; left time: 188.7174s
	iters: 400, epoch: 5 | loss: 0.5638790
	speed: 0.0281s/iter; left time: 179.0774s
	iters: 500, epoch: 5 | loss: 0.5390885
	speed: 0.0278s/iter; left time: 174.4066s
	iters: 600, epoch: 5 | loss: 0.5295255
	speed: 0.0269s/iter; left time: 165.9976s
	iters: 700, epoch: 5 | loss: 0.5516351
	speed: 0.0265s/iter; left time: 160.5501s
	iters: 800, epoch: 5 | loss: 0.7406825
	speed: 0.0259s/iter; left time: 154.7723s
	iters: 900, epoch: 5 | loss: 0.5605506
	speed: 0.0256s/iter; left time: 150.0190s
	iters: 1000, epoch: 5 | loss: 0.6289777
	speed: 0.0257s/iter; left time: 148.3084s
	iters: 1100, epoch: 5 | loss: 0.4888671
	speed: 0.0254s/iter; left time: 144.1930s
Epoch: 5 cost time: 28.743208408355713
Epoch: 5, Steps: 1128 | Train Loss: 0.6218748 Vali Loss: 0.7047186 Test Loss: 0.3540158
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5119940
	speed: 0.0303s/iter; left time: 167.7739s
	iters: 200, epoch: 6 | loss: 0.7580749
	speed: 0.0269s/iter; left time: 146.1200s
	iters: 300, epoch: 6 | loss: 0.6696966
	speed: 0.0260s/iter; left time: 138.9448s
	iters: 400, epoch: 6 | loss: 0.6486667
	speed: 0.0252s/iter; left time: 132.3205s
	iters: 500, epoch: 6 | loss: 0.6167472
	speed: 0.0239s/iter; left time: 122.9475s
	iters: 600, epoch: 6 | loss: 0.6547356
	speed: 0.0230s/iter; left time: 116.0194s
	iters: 700, epoch: 6 | loss: 0.4593195
	speed: 0.0224s/iter; left time: 110.7541s
	iters: 800, epoch: 6 | loss: 0.6199786
	speed: 0.0216s/iter; left time: 104.6455s
	iters: 900, epoch: 6 | loss: 0.6522363
	speed: 0.0210s/iter; left time: 99.3677s
	iters: 1000, epoch: 6 | loss: 0.4746720
	speed: 0.0205s/iter; left time: 95.0157s
	iters: 1100, epoch: 6 | loss: 0.7442464
	speed: 0.0202s/iter; left time: 91.7240s
Epoch: 6 cost time: 22.910282373428345
Epoch: 6, Steps: 1128 | Train Loss: 0.6185090 Vali Loss: 0.7095367 Test Loss: 0.3551593
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.6456392
	speed: 0.0211s/iter; left time: 93.1610s
	iters: 200, epoch: 7 | loss: 0.6649479
	speed: 0.0189s/iter; left time: 81.4038s
	iters: 300, epoch: 7 | loss: 0.4717313
	speed: 0.0178s/iter; left time: 75.0691s
	iters: 400, epoch: 7 | loss: 0.6254373
	speed: 0.0172s/iter; left time: 70.8674s
	iters: 500, epoch: 7 | loss: 0.7409240
	speed: 0.0168s/iter; left time: 67.4516s
	iters: 600, epoch: 7 | loss: 0.6161489
	speed: 0.0168s/iter; left time: 65.5991s
	iters: 700, epoch: 7 | loss: 0.5476068
	speed: 0.0171s/iter; left time: 65.0225s
	iters: 800, epoch: 7 | loss: 0.5518389
	speed: 0.0169s/iter; left time: 62.6663s
	iters: 900, epoch: 7 | loss: 0.4857253
	speed: 0.0173s/iter; left time: 62.4239s
	iters: 1000, epoch: 7 | loss: 0.5934552
	speed: 0.0175s/iter; left time: 61.4134s
	iters: 1100, epoch: 7 | loss: 0.4850273
	speed: 0.0179s/iter; left time: 61.1860s
Epoch: 7 cost time: 20.4414644241333
Epoch: 7, Steps: 1128 | Train Loss: 0.6167566 Vali Loss: 0.7075861 Test Loss: 0.3558838
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.7011003
	speed: 0.0260s/iter; left time: 85.5412s
	iters: 200, epoch: 8 | loss: 0.6366811
	speed: 0.0249s/iter; left time: 79.3943s
	iters: 300, epoch: 8 | loss: 0.4352374
	speed: 0.0245s/iter; left time: 75.7339s
	iters: 400, epoch: 8 | loss: 0.7061027
	speed: 0.0241s/iter; left time: 71.8123s
	iters: 500, epoch: 8 | loss: 0.5889387
	speed: 0.0238s/iter; left time: 68.6796s
	iters: 600, epoch: 8 | loss: 0.5691023
	speed: 0.0236s/iter; left time: 65.7699s
	iters: 700, epoch: 8 | loss: 0.8929132
	speed: 0.0234s/iter; left time: 62.9372s
	iters: 800, epoch: 8 | loss: 0.8939154
	speed: 0.0233s/iter; left time: 60.2785s
	iters: 900, epoch: 8 | loss: 0.7383118
	speed: 0.0229s/iter; left time: 57.0064s
	iters: 1000, epoch: 8 | loss: 0.5885692
	speed: 0.0228s/iter; left time: 54.3832s
	iters: 1100, epoch: 8 | loss: 0.5022394
	speed: 0.0225s/iter; left time: 51.3183s
Epoch: 8 cost time: 25.3081693649292
Epoch: 8, Steps: 1128 | Train Loss: 0.6159827 Vali Loss: 0.7100047 Test Loss: 0.3558510
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.3531191349029541, mae:0.35001587867736816
Seed: 123
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_96       Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip False
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.6163296
	speed: 0.0550s/iter; left time: 625.6088s
	iters: 200, epoch: 1 | loss: 0.3260768
	speed: 0.0449s/iter; left time: 505.7325s
	iters: 300, epoch: 1 | loss: 1.4135818
	speed: 0.0373s/iter; left time: 416.2370s
	iters: 400, epoch: 1 | loss: 0.3728575
	speed: 0.0329s/iter; left time: 364.2102s
	iters: 500, epoch: 1 | loss: 0.4380601
	speed: 0.0306s/iter; left time: 335.5258s
	iters: 600, epoch: 1 | loss: 0.5898454
	speed: 0.0293s/iter; left time: 318.0256s
	iters: 700, epoch: 1 | loss: 0.5431511
	speed: 0.0282s/iter; left time: 303.3178s
	iters: 800, epoch: 1 | loss: 0.3018833
	speed: 0.0274s/iter; left time: 292.0511s
	iters: 900, epoch: 1 | loss: 0.4166666
	speed: 0.0273s/iter; left time: 288.5355s
	iters: 1000, epoch: 1 | loss: 0.4753811
	speed: 0.0270s/iter; left time: 282.5530s
	iters: 1100, epoch: 1 | loss: 0.3278430
	speed: 0.0263s/iter; left time: 273.1352s
Epoch: 1 cost time: 29.996915578842163
Epoch: 1, Steps: 1147 | Train Loss: 0.4993546 Vali Loss: 0.4446568 Test Loss: 0.1833485
Validation loss decreased (inf --> 0.444657).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2743299
	speed: 0.0268s/iter; left time: 273.5557s
	iters: 200, epoch: 2 | loss: 0.3379158
	speed: 0.0242s/iter; left time: 244.5504s
	iters: 300, epoch: 2 | loss: 0.4133854
	speed: 0.0242s/iter; left time: 242.2279s
	iters: 400, epoch: 2 | loss: 0.4205624
	speed: 0.0239s/iter; left time: 237.3679s
	iters: 500, epoch: 2 | loss: 0.4468504
	speed: 0.0236s/iter; left time: 231.8028s
	iters: 600, epoch: 2 | loss: 0.3345205
	speed: 0.0242s/iter; left time: 235.7557s
	iters: 700, epoch: 2 | loss: 0.3864496
	speed: 0.0244s/iter; left time: 234.8647s
	iters: 800, epoch: 2 | loss: 0.2884487
	speed: 0.0249s/iter; left time: 237.3486s
	iters: 900, epoch: 2 | loss: 0.5280927
	speed: 0.0253s/iter; left time: 238.0021s
	iters: 1000, epoch: 2 | loss: 0.3673088
	speed: 0.0253s/iter; left time: 236.0793s
	iters: 1100, epoch: 2 | loss: 0.4264476
	speed: 0.0253s/iter; left time: 233.0948s
Epoch: 2 cost time: 29.081013679504395
Epoch: 2, Steps: 1147 | Train Loss: 0.4461564 Vali Loss: 0.4281994 Test Loss: 0.1774899
Validation loss decreased (0.444657 --> 0.428199).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3202063
	speed: 0.0292s/iter; left time: 264.6723s
	iters: 200, epoch: 3 | loss: 0.3100370
	speed: 0.0264s/iter; left time: 236.9523s
	iters: 300, epoch: 3 | loss: 0.3628473
	speed: 0.0253s/iter; left time: 225.0302s
	iters: 400, epoch: 3 | loss: 0.4310306
	speed: 0.0268s/iter; left time: 234.7956s
	iters: 500, epoch: 3 | loss: 0.3766644
	speed: 0.0276s/iter; left time: 239.8740s
	iters: 600, epoch: 3 | loss: 0.2758874
	speed: 0.0274s/iter; left time: 235.0069s
	iters: 700, epoch: 3 | loss: 0.2864512
	speed: 0.0275s/iter; left time: 233.0836s
	iters: 800, epoch: 3 | loss: 0.2408428
	speed: 0.0268s/iter; left time: 224.1587s
	iters: 900, epoch: 3 | loss: 0.2773559
	speed: 0.0265s/iter; left time: 219.3404s
	iters: 1000, epoch: 3 | loss: 0.5429096
	speed: 0.0263s/iter; left time: 215.4076s
	iters: 1100, epoch: 3 | loss: 0.4551479
	speed: 0.0262s/iter; left time: 211.8962s
Epoch: 3 cost time: 30.18678331375122
Epoch: 3, Steps: 1147 | Train Loss: 0.4255124 Vali Loss: 0.4241020 Test Loss: 0.1761509
Validation loss decreased (0.428199 --> 0.424102).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3448370
	speed: 0.0287s/iter; left time: 227.9177s
	iters: 200, epoch: 4 | loss: 0.2804041
	speed: 0.0255s/iter; left time: 199.5338s
	iters: 300, epoch: 4 | loss: 0.2403698
	speed: 0.0245s/iter; left time: 189.2387s
	iters: 400, epoch: 4 | loss: 0.4146232
	speed: 0.0255s/iter; left time: 194.3417s
	iters: 500, epoch: 4 | loss: 1.3357786
	speed: 0.0264s/iter; left time: 199.1406s
	iters: 600, epoch: 4 | loss: 0.3573517
	speed: 0.0253s/iter; left time: 187.7983s
	iters: 700, epoch: 4 | loss: 0.2544989
	speed: 0.0243s/iter; left time: 177.9211s
	iters: 800, epoch: 4 | loss: 0.2776370
	speed: 0.0234s/iter; left time: 169.2537s
	iters: 900, epoch: 4 | loss: 0.3487924
	speed: 0.0228s/iter; left time: 162.6617s
	iters: 1000, epoch: 4 | loss: 0.2449631
	speed: 0.0234s/iter; left time: 164.8176s
	iters: 1100, epoch: 4 | loss: 0.2848233
	speed: 0.0235s/iter; left time: 162.6072s
Epoch: 4 cost time: 26.85497760772705
Epoch: 4, Steps: 1147 | Train Loss: 0.4144960 Vali Loss: 0.4166988 Test Loss: 0.1736407
Validation loss decreased (0.424102 --> 0.416699).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3672791
	speed: 0.0372s/iter; left time: 252.4268s
	iters: 200, epoch: 5 | loss: 0.3336827
	speed: 0.0286s/iter; left time: 191.1392s
	iters: 300, epoch: 5 | loss: 0.3930535
	speed: 0.0262s/iter; left time: 172.3998s
	iters: 400, epoch: 5 | loss: 0.2690943
	speed: 0.0252s/iter; left time: 163.3243s
	iters: 500, epoch: 5 | loss: 0.3087467
	speed: 0.0249s/iter; left time: 158.8432s
	iters: 600, epoch: 5 | loss: 0.3433808
	speed: 0.0261s/iter; left time: 163.7477s
	iters: 700, epoch: 5 | loss: 0.3643800
	speed: 0.0256s/iter; left time: 158.2286s
	iters: 800, epoch: 5 | loss: 0.2583610
	speed: 0.0252s/iter; left time: 153.5077s
	iters: 900, epoch: 5 | loss: 0.3302459
	speed: 0.0251s/iter; left time: 150.4290s
	iters: 1000, epoch: 5 | loss: 0.2499062
	speed: 0.0251s/iter; left time: 147.7018s
	iters: 1100, epoch: 5 | loss: 0.2565673
	speed: 0.0250s/iter; left time: 144.7949s
Epoch: 5 cost time: 28.823509454727173
Epoch: 5, Steps: 1147 | Train Loss: 0.4085163 Vali Loss: 0.4178437 Test Loss: 0.1732308
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2895109
	speed: 0.0239s/iter; left time: 134.5009s
	iters: 200, epoch: 6 | loss: 0.3205135
	speed: 0.0219s/iter; left time: 121.3826s
	iters: 300, epoch: 6 | loss: 0.2631809
	speed: 0.0217s/iter; left time: 117.8847s
	iters: 400, epoch: 6 | loss: 0.3704652
	speed: 0.0233s/iter; left time: 124.0843s
	iters: 500, epoch: 6 | loss: 0.2271646
	speed: 0.0235s/iter; left time: 122.8524s
	iters: 600, epoch: 6 | loss: 0.4266161
	speed: 0.0233s/iter; left time: 119.6106s
	iters: 700, epoch: 6 | loss: 0.2398427
	speed: 0.0235s/iter; left time: 118.4419s
	iters: 800, epoch: 6 | loss: 0.3947861
	speed: 0.0235s/iter; left time: 116.0172s
	iters: 900, epoch: 6 | loss: 0.5082987
	speed: 0.0234s/iter; left time: 113.2003s
	iters: 1000, epoch: 6 | loss: 0.2812621
	speed: 0.0234s/iter; left time: 110.9170s
	iters: 1100, epoch: 6 | loss: 0.3990407
	speed: 0.0244s/iter; left time: 113.2876s
Epoch: 6 cost time: 28.74254846572876
Epoch: 6, Steps: 1147 | Train Loss: 0.4054034 Vali Loss: 0.4204322 Test Loss: 0.1734987
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3873061
	speed: 0.0350s/iter; left time: 157.1744s
	iters: 200, epoch: 7 | loss: 0.3037076
	speed: 0.0288s/iter; left time: 126.2306s
	iters: 300, epoch: 7 | loss: 0.2525179
	speed: 0.0282s/iter; left time: 120.9867s
	iters: 400, epoch: 7 | loss: 0.4340419
	speed: 0.0292s/iter; left time: 122.1177s
	iters: 500, epoch: 7 | loss: 0.3526183
	speed: 0.0269s/iter; left time: 109.8956s
	iters: 600, epoch: 7 | loss: 0.3766629
	speed: 0.0253s/iter; left time: 100.7985s
	iters: 700, epoch: 7 | loss: 0.4278851
	speed: 0.0241s/iter; left time: 93.6135s
	iters: 800, epoch: 7 | loss: 0.5394451
	speed: 0.0233s/iter; left time: 88.4155s
	iters: 900, epoch: 7 | loss: 0.3105708
	speed: 0.0237s/iter; left time: 87.4603s
	iters: 1000, epoch: 7 | loss: 0.3074800
	speed: 0.0249s/iter; left time: 89.3107s
	iters: 1100, epoch: 7 | loss: 0.3406356
	speed: 0.0257s/iter; left time: 89.5440s
Epoch: 7 cost time: 29.86460518836975
Epoch: 7, Steps: 1147 | Train Loss: 0.4036214 Vali Loss: 0.4175823 Test Loss: 0.1732303
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 1.1417569
	speed: 0.0385s/iter; left time: 128.7409s
	iters: 200, epoch: 8 | loss: 0.2550159
	speed: 0.0357s/iter; left time: 115.6828s
	iters: 300, epoch: 8 | loss: 0.3845011
	speed: 0.0337s/iter; left time: 105.7795s
	iters: 400, epoch: 8 | loss: 0.3776978
	speed: 0.0308s/iter; left time: 93.7436s
	iters: 500, epoch: 8 | loss: 0.4306425
	speed: 0.0292s/iter; left time: 85.7715s
	iters: 600, epoch: 8 | loss: 0.2290127
	speed: 0.0296s/iter; left time: 84.1390s
	iters: 700, epoch: 8 | loss: 1.4658654
	speed: 0.0297s/iter; left time: 81.5118s
	iters: 800, epoch: 8 | loss: 0.5832681
	speed: 0.0286s/iter; left time: 75.5175s
	iters: 900, epoch: 8 | loss: 0.2745837
	speed: 0.0276s/iter; left time: 70.0460s
	iters: 1000, epoch: 8 | loss: 0.4727429
	speed: 0.0270s/iter; left time: 65.8657s
	iters: 1100, epoch: 8 | loss: 0.2799323
	speed: 0.0279s/iter; left time: 65.3208s
Epoch: 8 cost time: 32.560723543167114
Epoch: 8, Steps: 1147 | Train Loss: 0.4029058 Vali Loss: 0.4188793 Test Loss: 0.1731334
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4048984
	speed: 0.0289s/iter; left time: 63.4528s
	iters: 200, epoch: 9 | loss: 0.2872454
	speed: 0.0259s/iter; left time: 54.1853s
	iters: 300, epoch: 9 | loss: 0.2645667
	speed: 0.0249s/iter; left time: 49.7159s
	iters: 400, epoch: 9 | loss: 0.2936535
	speed: 0.0258s/iter; left time: 48.9023s
	iters: 500, epoch: 9 | loss: 0.2775822
	speed: 0.0270s/iter; left time: 48.5137s
	iters: 600, epoch: 9 | loss: 1.3288980
	speed: 0.0257s/iter; left time: 43.5239s
	iters: 700, epoch: 9 | loss: 0.3381430
	speed: 0.0259s/iter; left time: 41.2521s
	iters: 800, epoch: 9 | loss: 1.2126635
	speed: 0.0258s/iter; left time: 38.6016s
	iters: 900, epoch: 9 | loss: 0.3209055
	speed: 0.0270s/iter; left time: 37.7191s
	iters: 1000, epoch: 9 | loss: 0.1863410
	speed: 0.0282s/iter; left time: 36.4591s
	iters: 1100, epoch: 9 | loss: 0.4817396
	speed: 0.0291s/iter; left time: 34.8134s
Epoch: 9 cost time: 33.69427490234375
Epoch: 9, Steps: 1147 | Train Loss: 0.4022838 Vali Loss: 0.4184163 Test Loss: 0.1727446
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.1736406683921814, mae:0.2171422392129898
Use GPU: cuda:0
no_skip False
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.4301468
	speed: 0.0319s/iter; left time: 362.7411s
	iters: 200, epoch: 1 | loss: 0.5455031
	speed: 0.0318s/iter; left time: 358.1149s
	iters: 300, epoch: 1 | loss: 0.3472704
	speed: 0.0294s/iter; left time: 328.6346s
	iters: 400, epoch: 1 | loss: 0.4497009
	speed: 0.0283s/iter; left time: 313.5116s
	iters: 500, epoch: 1 | loss: 0.3081448
	speed: 0.0276s/iter; left time: 302.7004s
	iters: 600, epoch: 1 | loss: 1.3078474
	speed: 0.0271s/iter; left time: 294.8301s
	iters: 700, epoch: 1 | loss: 0.3298805
	speed: 0.0268s/iter; left time: 288.8581s
	iters: 800, epoch: 1 | loss: 0.2745451
	speed: 0.0266s/iter; left time: 283.6199s
	iters: 900, epoch: 1 | loss: 0.6111159
	speed: 0.0263s/iter; left time: 278.3284s
	iters: 1000, epoch: 1 | loss: 0.4801974
	speed: 0.0260s/iter; left time: 272.5116s
	iters: 1100, epoch: 1 | loss: 0.3275822
	speed: 0.0259s/iter; left time: 268.3439s
Epoch: 1 cost time: 29.661282777786255
Epoch: 1, Steps: 1147 | Train Loss: 0.5022661 Vali Loss: 0.4423999 Test Loss: 0.1840787
Validation loss decreased (inf --> 0.442400).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5264102
	speed: 0.0233s/iter; left time: 238.6016s
	iters: 200, epoch: 2 | loss: 0.3562404
	speed: 0.0211s/iter; left time: 213.8953s
	iters: 300, epoch: 2 | loss: 0.2348933
	speed: 0.0215s/iter; left time: 215.9700s
	iters: 400, epoch: 2 | loss: 0.2702628
	speed: 0.0219s/iter; left time: 217.3737s
	iters: 500, epoch: 2 | loss: 0.3792308
	speed: 0.0229s/iter; left time: 225.4572s
	iters: 600, epoch: 2 | loss: 0.2739559
	speed: 0.0232s/iter; left time: 225.2977s
	iters: 700, epoch: 2 | loss: 0.2523250
	speed: 0.0231s/iter; left time: 222.4988s
	iters: 800, epoch: 2 | loss: 0.3495772
	speed: 0.0231s/iter; left time: 219.5692s
	iters: 900, epoch: 2 | loss: 0.2414682
	speed: 0.0233s/iter; left time: 219.6189s
	iters: 1000, epoch: 2 | loss: 0.6330749
	speed: 0.0240s/iter; left time: 224.0537s
	iters: 1100, epoch: 2 | loss: 0.6022483
	speed: 0.0245s/iter; left time: 226.3400s
Epoch: 2 cost time: 28.276042461395264
Epoch: 2, Steps: 1147 | Train Loss: 0.4490683 Vali Loss: 0.4303418 Test Loss: 0.1796124
Validation loss decreased (0.442400 --> 0.430342).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3214679
	speed: 0.0404s/iter; left time: 366.5906s
	iters: 200, epoch: 3 | loss: 0.2548507
	speed: 0.0390s/iter; left time: 349.7464s
	iters: 300, epoch: 3 | loss: 0.2874015
	speed: 0.0382s/iter; left time: 339.1125s
	iters: 400, epoch: 3 | loss: 0.2904736
	speed: 0.0346s/iter; left time: 303.7967s
	iters: 500, epoch: 3 | loss: 1.2366327
	speed: 0.0311s/iter; left time: 270.0885s
	iters: 600, epoch: 3 | loss: 0.2722603
	speed: 0.0287s/iter; left time: 245.7586s
	iters: 700, epoch: 3 | loss: 0.4218307
	speed: 0.0276s/iter; left time: 234.3805s
	iters: 800, epoch: 3 | loss: 0.3069326
	speed: 0.0265s/iter; left time: 221.6094s
	iters: 900, epoch: 3 | loss: 0.4404626
	speed: 0.0255s/iter; left time: 211.0883s
	iters: 1000, epoch: 3 | loss: 0.3547252
	speed: 0.0248s/iter; left time: 202.9535s
	iters: 1100, epoch: 3 | loss: 0.2400443
	speed: 0.0251s/iter; left time: 202.4071s
Epoch: 3 cost time: 28.70701551437378
Epoch: 3, Steps: 1147 | Train Loss: 0.4272270 Vali Loss: 0.4266398 Test Loss: 0.1741996
Validation loss decreased (0.430342 --> 0.426640).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3000502
	speed: 0.0416s/iter; left time: 329.6584s
	iters: 200, epoch: 4 | loss: 0.4475838
	speed: 0.0383s/iter; left time: 300.1865s
	iters: 300, epoch: 4 | loss: 0.4032862
	speed: 0.0334s/iter; left time: 257.9533s
	iters: 400, epoch: 4 | loss: 0.4177438
	speed: 0.0307s/iter; left time: 233.9783s
	iters: 500, epoch: 4 | loss: 1.5225806
	speed: 0.0291s/iter; left time: 218.7604s
	iters: 600, epoch: 4 | loss: 0.3002467
	speed: 0.0283s/iter; left time: 210.2006s
	iters: 700, epoch: 4 | loss: 1.2247138
	speed: 0.0285s/iter; left time: 209.1206s
	iters: 800, epoch: 4 | loss: 0.2767617
	speed: 0.0278s/iter; left time: 200.8713s
	iters: 900, epoch: 4 | loss: 0.2657435
	speed: 0.0272s/iter; left time: 193.9872s
	iters: 1000, epoch: 4 | loss: 0.3045685
	speed: 0.0271s/iter; left time: 190.6285s
	iters: 1100, epoch: 4 | loss: 0.3249968
	speed: 0.0270s/iter; left time: 187.2328s
Epoch: 4 cost time: 31.289443969726562
Epoch: 4, Steps: 1147 | Train Loss: 0.4151296 Vali Loss: 0.4275130 Test Loss: 0.1736842
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3109910
	speed: 0.0386s/iter; left time: 262.0748s
	iters: 200, epoch: 5 | loss: 0.2857272
	speed: 0.0338s/iter; left time: 225.7376s
	iters: 300, epoch: 5 | loss: 0.2816211
	speed: 0.0301s/iter; left time: 198.0993s
	iters: 400, epoch: 5 | loss: 0.3817791
	speed: 0.0282s/iter; left time: 182.9899s
	iters: 500, epoch: 5 | loss: 0.2815009
	speed: 0.0270s/iter; left time: 172.6251s
	iters: 600, epoch: 5 | loss: 0.2838660
	speed: 0.0266s/iter; left time: 167.0894s
	iters: 700, epoch: 5 | loss: 0.2297994
	speed: 0.0265s/iter; left time: 164.0443s
	iters: 800, epoch: 5 | loss: 0.3290278
	speed: 0.0261s/iter; left time: 158.9479s
	iters: 900, epoch: 5 | loss: 0.3397218
	speed: 0.0270s/iter; left time: 161.5292s
	iters: 1000, epoch: 5 | loss: 0.4209497
	speed: 0.0271s/iter; left time: 159.2825s
	iters: 1100, epoch: 5 | loss: 0.3320003
	speed: 0.0264s/iter; left time: 152.9538s
Epoch: 5 cost time: 30.2710862159729
Epoch: 5, Steps: 1147 | Train Loss: 0.4085318 Vali Loss: 0.4240009 Test Loss: 0.1732368
Validation loss decreased (0.426640 --> 0.424001).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4392747
	speed: 0.0252s/iter; left time: 142.0945s
	iters: 200, epoch: 6 | loss: 0.2555084
	speed: 0.0242s/iter; left time: 134.0397s
	iters: 300, epoch: 6 | loss: 0.2495780
	speed: 0.0235s/iter; left time: 127.7607s
	iters: 400, epoch: 6 | loss: 0.4568909
	speed: 0.0238s/iter; left time: 127.1920s
	iters: 500, epoch: 6 | loss: 0.4550779
	speed: 0.0241s/iter; left time: 126.4486s
	iters: 600, epoch: 6 | loss: 0.2717375
	speed: 0.0234s/iter; left time: 120.2923s
	iters: 700, epoch: 6 | loss: 0.2376857
	speed: 0.0229s/iter; left time: 115.3175s
	iters: 800, epoch: 6 | loss: 0.6572320
	speed: 0.0225s/iter; left time: 111.1672s
	iters: 900, epoch: 6 | loss: 0.3214808
	speed: 0.0221s/iter; left time: 106.7825s
	iters: 1000, epoch: 6 | loss: 0.2669463
	speed: 0.0217s/iter; left time: 102.5979s
	iters: 1100, epoch: 6 | loss: 1.2135702
	speed: 0.0213s/iter; left time: 98.8463s
Epoch: 6 cost time: 24.463189840316772
Epoch: 6, Steps: 1147 | Train Loss: 0.4054795 Vali Loss: 0.4262280 Test Loss: 0.1731765
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3012618
	speed: 0.0239s/iter; left time: 107.2775s
	iters: 200, epoch: 7 | loss: 0.2721690
	speed: 0.0233s/iter; left time: 102.1818s
	iters: 300, epoch: 7 | loss: 0.2791142
	speed: 0.0234s/iter; left time: 100.1892s
	iters: 400, epoch: 7 | loss: 0.3030771
	speed: 0.0236s/iter; left time: 98.8076s
	iters: 500, epoch: 7 | loss: 0.2545345
	speed: 0.0237s/iter; left time: 96.9280s
	iters: 600, epoch: 7 | loss: 0.3564065
	speed: 0.0238s/iter; left time: 94.8685s
	iters: 700, epoch: 7 | loss: 0.2620541
	speed: 0.0238s/iter; left time: 92.6454s
	iters: 800, epoch: 7 | loss: 0.9305130
	speed: 0.0239s/iter; left time: 90.4290s
	iters: 900, epoch: 7 | loss: 0.3037054
	speed: 0.0240s/iter; left time: 88.3526s
	iters: 1000, epoch: 7 | loss: 0.3696137
	speed: 0.0241s/iter; left time: 86.3370s
	iters: 1100, epoch: 7 | loss: 0.4379055
	speed: 0.0241s/iter; left time: 84.2471s
Epoch: 7 cost time: 27.865729093551636
Epoch: 7, Steps: 1147 | Train Loss: 0.4034874 Vali Loss: 0.4250887 Test Loss: 0.1726410
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2467120
	speed: 0.0225s/iter; left time: 75.3293s
	iters: 200, epoch: 8 | loss: 1.2224145
	speed: 0.0216s/iter; left time: 69.9149s
	iters: 300, epoch: 8 | loss: 1.2327091
	speed: 0.0215s/iter; left time: 67.5392s
	iters: 400, epoch: 8 | loss: 1.2071496
	speed: 0.0219s/iter; left time: 66.5360s
	iters: 500, epoch: 8 | loss: 0.2556353
	speed: 0.0219s/iter; left time: 64.5400s
	iters: 600, epoch: 8 | loss: 0.4451759
	speed: 0.0221s/iter; left time: 62.7447s
	iters: 700, epoch: 8 | loss: 0.2718381
	speed: 0.0221s/iter; left time: 60.7021s
	iters: 800, epoch: 8 | loss: 0.5395632
	speed: 0.0224s/iter; left time: 59.0995s
	iters: 900, epoch: 8 | loss: 0.2932926
	speed: 0.0228s/iter; left time: 57.9046s
	iters: 1000, epoch: 8 | loss: 0.4338894
	speed: 0.0239s/iter; left time: 58.3753s
	iters: 1100, epoch: 8 | loss: 0.4248901
	speed: 0.0249s/iter; left time: 58.3612s
Epoch: 8 cost time: 29.25101590156555
Epoch: 8, Steps: 1147 | Train Loss: 0.4026425 Vali Loss: 0.4249033 Test Loss: 0.1722600
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2832742
	speed: 0.0277s/iter; left time: 60.8836s
	iters: 200, epoch: 9 | loss: 0.4385788
	speed: 0.0260s/iter; left time: 54.4365s
	iters: 300, epoch: 9 | loss: 1.2680019
	speed: 0.0256s/iter; left time: 51.0320s
	iters: 400, epoch: 9 | loss: 0.3109168
	speed: 0.0255s/iter; left time: 48.2429s
	iters: 500, epoch: 9 | loss: 0.3422245
	speed: 0.0250s/iter; left time: 44.8241s
	iters: 600, epoch: 9 | loss: 0.4465203
	speed: 0.0247s/iter; left time: 41.9179s
	iters: 700, epoch: 9 | loss: 0.3174324
	speed: 0.0259s/iter; left time: 41.2547s
	iters: 800, epoch: 9 | loss: 0.2151492
	speed: 0.0267s/iter; left time: 39.9132s
	iters: 900, epoch: 9 | loss: 0.2931246
	speed: 0.0276s/iter; left time: 38.5188s
	iters: 1000, epoch: 9 | loss: 0.3090633
	speed: 0.0273s/iter; left time: 35.3607s
	iters: 1100, epoch: 9 | loss: 0.3172385
	speed: 0.0271s/iter; left time: 32.3512s
Epoch: 9 cost time: 31.610568284988403
Epoch: 9, Steps: 1147 | Train Loss: 0.4019706 Vali Loss: 0.4245248 Test Loss: 0.1723166
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2688272
	speed: 0.0272s/iter; left time: 28.4895s
	iters: 200, epoch: 10 | loss: 0.2291098
	speed: 0.0242s/iter; left time: 22.9487s
	iters: 300, epoch: 10 | loss: 0.2973667
	speed: 0.0238s/iter; left time: 20.1462s
	iters: 400, epoch: 10 | loss: 1.1468405
	speed: 0.0236s/iter; left time: 17.6314s
	iters: 500, epoch: 10 | loss: 0.3275802
	speed: 0.0234s/iter; left time: 15.1719s
	iters: 600, epoch: 10 | loss: 0.3642773
	speed: 0.0232s/iter; left time: 12.7380s
	iters: 700, epoch: 10 | loss: 0.2675054
	speed: 0.0231s/iter; left time: 10.3506s
	iters: 800, epoch: 10 | loss: 0.3676177
	speed: 0.0232s/iter; left time: 8.0844s
	iters: 900, epoch: 10 | loss: 0.3212665
	speed: 0.0233s/iter; left time: 5.7897s
	iters: 1000, epoch: 10 | loss: 0.2528846
	speed: 0.0234s/iter; left time: 3.4626s
	iters: 1100, epoch: 10 | loss: 0.2790778
	speed: 0.0235s/iter; left time: 1.1258s
Epoch: 10 cost time: 27.064762115478516
Epoch: 10, Steps: 1147 | Train Loss: 0.4017552 Vali Loss: 0.4247997 Test Loss: 0.1724191
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.17323680222034454, mae:0.21598762273788452
Use GPU: cuda:0
no_skip False
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.4149817
	speed: 0.0315s/iter; left time: 357.7354s
	iters: 200, epoch: 1 | loss: 0.4404201
	speed: 0.0283s/iter; left time: 319.4584s
	iters: 300, epoch: 1 | loss: 0.3117929
	speed: 0.0272s/iter; left time: 303.7035s
	iters: 400, epoch: 1 | loss: 0.3911691
	speed: 0.0266s/iter; left time: 295.0301s
	iters: 500, epoch: 1 | loss: 0.4436113
	speed: 0.0258s/iter; left time: 282.8623s
	iters: 600, epoch: 1 | loss: 0.3802823
	speed: 0.0253s/iter; left time: 275.3453s
	iters: 700, epoch: 1 | loss: 0.6815079
	speed: 0.0260s/iter; left time: 279.9546s
	iters: 800, epoch: 1 | loss: 0.6517868
	speed: 0.0257s/iter; left time: 274.3723s
	iters: 900, epoch: 1 | loss: 0.2629228
	speed: 0.0255s/iter; left time: 269.0370s
	iters: 1000, epoch: 1 | loss: 0.2953471
	speed: 0.0253s/iter; left time: 265.2289s
	iters: 1100, epoch: 1 | loss: 0.2721712
	speed: 0.0252s/iter; left time: 261.6644s
Epoch: 1 cost time: 28.841627836227417
Epoch: 1, Steps: 1147 | Train Loss: 0.4939152 Vali Loss: 0.4412876 Test Loss: 0.1832600
Validation loss decreased (inf --> 0.441288).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4899996
	speed: 0.0467s/iter; left time: 477.5149s
	iters: 200, epoch: 2 | loss: 0.4152221
	speed: 0.0445s/iter; left time: 450.3277s
	iters: 300, epoch: 2 | loss: 0.3994309
	speed: 0.0438s/iter; left time: 439.5210s
	iters: 400, epoch: 2 | loss: 0.3752749
	speed: 0.0436s/iter; left time: 432.4936s
	iters: 500, epoch: 2 | loss: 0.2168315
	speed: 0.0406s/iter; left time: 398.5104s
	iters: 600, epoch: 2 | loss: 0.3478021
	speed: 0.0375s/iter; left time: 364.5333s
	iters: 700, epoch: 2 | loss: 0.2356993
	speed: 0.0354s/iter; left time: 340.7329s
	iters: 800, epoch: 2 | loss: 1.2212402
	speed: 0.0338s/iter; left time: 322.0904s
	iters: 900, epoch: 2 | loss: 0.4802774
	speed: 0.0313s/iter; left time: 295.0715s
	iters: 1000, epoch: 2 | loss: 0.3382352
	speed: 0.0294s/iter; left time: 273.8182s
	iters: 1100, epoch: 2 | loss: 0.3094424
	speed: 0.0277s/iter; left time: 255.7350s
Epoch: 2 cost time: 31.464683055877686
Epoch: 2, Steps: 1147 | Train Loss: 0.4441258 Vali Loss: 0.4170631 Test Loss: 0.1754436
Validation loss decreased (0.441288 --> 0.417063).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3559516
	speed: 0.0266s/iter; left time: 241.1904s
	iters: 200, epoch: 3 | loss: 0.3023079
	speed: 0.0245s/iter; left time: 219.9012s
	iters: 300, epoch: 3 | loss: 0.3901675
	speed: 0.0255s/iter; left time: 226.7869s
	iters: 400, epoch: 3 | loss: 0.3669732
	speed: 0.0249s/iter; left time: 218.3954s
	iters: 500, epoch: 3 | loss: 0.3350041
	speed: 0.0248s/iter; left time: 215.1060s
	iters: 600, epoch: 3 | loss: 0.2449054
	speed: 0.0246s/iter; left time: 211.0847s
	iters: 700, epoch: 3 | loss: 0.4047351
	speed: 0.0245s/iter; left time: 207.7276s
	iters: 800, epoch: 3 | loss: 0.3037888
	speed: 0.0242s/iter; left time: 203.0259s
	iters: 900, epoch: 3 | loss: 0.3098507
	speed: 0.0240s/iter; left time: 198.5233s
	iters: 1000, epoch: 3 | loss: 0.3308697
	speed: 0.0240s/iter; left time: 195.8545s
	iters: 1100, epoch: 3 | loss: 0.3351627
	speed: 0.0236s/iter; left time: 190.7362s
Epoch: 3 cost time: 27.196098566055298
Epoch: 3, Steps: 1147 | Train Loss: 0.4217713 Vali Loss: 0.4147758 Test Loss: 0.1734067
Validation loss decreased (0.417063 --> 0.414776).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2600982
	speed: 0.0280s/iter; left time: 222.1206s
	iters: 200, epoch: 4 | loss: 0.3525109
	speed: 0.0250s/iter; left time: 195.4170s
	iters: 300, epoch: 4 | loss: 1.2112391
	speed: 0.0239s/iter; left time: 185.0927s
	iters: 400, epoch: 4 | loss: 0.2682401
	speed: 0.0254s/iter; left time: 193.5153s
	iters: 500, epoch: 4 | loss: 0.2002492
	speed: 0.0270s/iter; left time: 203.1403s
	iters: 600, epoch: 4 | loss: 0.2513601
	speed: 0.0266s/iter; left time: 197.9173s
	iters: 700, epoch: 4 | loss: 0.3182467
	speed: 0.0264s/iter; left time: 193.3995s
	iters: 800, epoch: 4 | loss: 0.2694447
	speed: 0.0260s/iter; left time: 187.6826s
	iters: 900, epoch: 4 | loss: 0.2703479
	speed: 0.0253s/iter; left time: 180.2275s
	iters: 1000, epoch: 4 | loss: 0.2538001
	speed: 0.0246s/iter; left time: 172.9271s
	iters: 1100, epoch: 4 | loss: 0.2764286
	speed: 0.0241s/iter; left time: 167.2300s
Epoch: 4 cost time: 27.72385883331299
Epoch: 4, Steps: 1147 | Train Loss: 0.4100600 Vali Loss: 0.4111158 Test Loss: 0.1720231
Validation loss decreased (0.414776 --> 0.411116).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2526946
	speed: 0.0258s/iter; left time: 175.0552s
	iters: 200, epoch: 5 | loss: 0.2597753
	speed: 0.0241s/iter; left time: 160.8890s
	iters: 300, epoch: 5 | loss: 0.4406065
	speed: 0.0237s/iter; left time: 155.6972s
	iters: 400, epoch: 5 | loss: 0.3438210
	speed: 0.0239s/iter; left time: 155.1688s
	iters: 500, epoch: 5 | loss: 0.3078460
	speed: 0.0241s/iter; left time: 153.9945s
	iters: 600, epoch: 5 | loss: 0.3361825
	speed: 0.0242s/iter; left time: 152.0769s
	iters: 700, epoch: 5 | loss: 0.5829787
	speed: 0.0243s/iter; left time: 150.0718s
	iters: 800, epoch: 5 | loss: 0.3555946
	speed: 0.0242s/iter; left time: 147.1741s
	iters: 900, epoch: 5 | loss: 0.3879982
	speed: 0.0238s/iter; left time: 142.1047s
	iters: 1000, epoch: 5 | loss: 0.3488736
	speed: 0.0227s/iter; left time: 133.8214s
	iters: 1100, epoch: 5 | loss: 0.3639288
	speed: 0.0218s/iter; left time: 126.2832s
Epoch: 5 cost time: 24.804826498031616
Epoch: 5, Steps: 1147 | Train Loss: 0.4036855 Vali Loss: 0.4121494 Test Loss: 0.1722966
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1896541
	speed: 0.0277s/iter; left time: 156.1554s
	iters: 200, epoch: 6 | loss: 0.2785809
	speed: 0.0267s/iter; left time: 147.8177s
	iters: 300, epoch: 6 | loss: 0.2853791
	speed: 0.0259s/iter; left time: 140.8247s
	iters: 400, epoch: 6 | loss: 0.2494068
	speed: 0.0250s/iter; left time: 133.3290s
	iters: 500, epoch: 6 | loss: 0.3627526
	speed: 0.0254s/iter; left time: 132.7788s
	iters: 600, epoch: 6 | loss: 0.2285738
	speed: 0.0260s/iter; left time: 133.6734s
	iters: 700, epoch: 6 | loss: 0.3091098
	speed: 0.0271s/iter; left time: 136.3960s
	iters: 800, epoch: 6 | loss: 0.3496686
	speed: 0.0280s/iter; left time: 138.0275s
	iters: 900, epoch: 6 | loss: 0.4243734
	speed: 0.0279s/iter; left time: 134.9648s
	iters: 1000, epoch: 6 | loss: 0.4368736
	speed: 0.0271s/iter; left time: 128.2907s
	iters: 1100, epoch: 6 | loss: 0.3162068
	speed: 0.0263s/iter; left time: 122.1469s
Epoch: 6 cost time: 30.062710762023926
Epoch: 6, Steps: 1147 | Train Loss: 0.4000785 Vali Loss: 0.4120846 Test Loss: 0.1719063
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2428460
	speed: 0.0263s/iter; left time: 117.8363s
	iters: 200, epoch: 7 | loss: 0.3037025
	speed: 0.0255s/iter; left time: 111.7856s
	iters: 300, epoch: 7 | loss: 0.2935840
	speed: 0.0246s/iter; left time: 105.4311s
	iters: 400, epoch: 7 | loss: 0.3110684
	speed: 0.0240s/iter; left time: 100.4232s
	iters: 500, epoch: 7 | loss: 0.3429578
	speed: 0.0237s/iter; left time: 96.8953s
	iters: 600, epoch: 7 | loss: 1.2664362
	speed: 0.0235s/iter; left time: 93.6567s
	iters: 700, epoch: 7 | loss: 0.2934858
	speed: 0.0244s/iter; left time: 94.9411s
	iters: 800, epoch: 7 | loss: 1.0017858
	speed: 0.0258s/iter; left time: 97.8824s
	iters: 900, epoch: 7 | loss: 0.3110680
	speed: 0.0268s/iter; left time: 98.7605s
	iters: 1000, epoch: 7 | loss: 0.3135854
	speed: 0.0265s/iter; left time: 94.9521s
	iters: 1100, epoch: 7 | loss: 0.2504668
	speed: 0.0261s/iter; left time: 91.0422s
Epoch: 7 cost time: 29.886975526809692
Epoch: 7, Steps: 1147 | Train Loss: 0.3983055 Vali Loss: 0.4118682 Test Loss: 0.1722665
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2465976
	speed: 0.0266s/iter; left time: 88.9263s
	iters: 200, epoch: 8 | loss: 0.2435824
	speed: 0.0243s/iter; left time: 78.9417s
	iters: 300, epoch: 8 | loss: 0.3012190
	speed: 0.0243s/iter; left time: 76.2990s
	iters: 400, epoch: 8 | loss: 0.3126272
	speed: 0.0245s/iter; left time: 74.4202s
	iters: 500, epoch: 8 | loss: 0.4359280
	speed: 0.0240s/iter; left time: 70.4814s
	iters: 600, epoch: 8 | loss: 0.2872251
	speed: 0.0237s/iter; left time: 67.2793s
	iters: 700, epoch: 8 | loss: 0.3433963
	speed: 0.0245s/iter; left time: 67.1062s
	iters: 800, epoch: 8 | loss: 0.4058282
	speed: 0.0246s/iter; left time: 64.8825s
	iters: 900, epoch: 8 | loss: 0.3946005
	speed: 0.0246s/iter; left time: 62.5279s
	iters: 1000, epoch: 8 | loss: 0.3207089
	speed: 0.0243s/iter; left time: 59.3916s
	iters: 1100, epoch: 8 | loss: 0.3298750
	speed: 0.0239s/iter; left time: 56.0113s
Epoch: 8 cost time: 27.374009609222412
Epoch: 8, Steps: 1147 | Train Loss: 0.3972601 Vali Loss: 0.4129324 Test Loss: 0.1719899
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2705140
	speed: 0.0225s/iter; left time: 49.4606s
	iters: 200, epoch: 9 | loss: 0.3539983
	speed: 0.0223s/iter; left time: 46.6200s
	iters: 300, epoch: 9 | loss: 0.2417671
	speed: 0.0225s/iter; left time: 44.9506s
	iters: 400, epoch: 9 | loss: 0.2731753
	speed: 0.0230s/iter; left time: 43.6031s
	iters: 500, epoch: 9 | loss: 0.3257452
	speed: 0.0245s/iter; left time: 43.9007s
	iters: 600, epoch: 9 | loss: 0.2959608
	speed: 0.0255s/iter; left time: 43.1985s
	iters: 700, epoch: 9 | loss: 0.3603396
	speed: 0.0251s/iter; left time: 39.9739s
	iters: 800, epoch: 9 | loss: 0.2947703
	speed: 0.0247s/iter; left time: 36.9012s
	iters: 900, epoch: 9 | loss: 0.3408583
	speed: 0.0243s/iter; left time: 33.9441s
	iters: 1000, epoch: 9 | loss: 0.2940291
	speed: 0.0242s/iter; left time: 31.2939s
	iters: 1100, epoch: 9 | loss: 0.2142654
	speed: 0.0242s/iter; left time: 28.8866s
Epoch: 9 cost time: 28.06621289253235
Epoch: 9, Steps: 1147 | Train Loss: 0.3966739 Vali Loss: 0.4134043 Test Loss: 0.1723803
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.17202310264110565, mae:0.21571005880832672
Seed: 123
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_192      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip False
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.4983417
	speed: 0.0570s/iter; left time: 646.1266s
	iters: 200, epoch: 1 | loss: 0.7261624
	speed: 0.0443s/iter; left time: 498.5346s
	iters: 300, epoch: 1 | loss: 0.9089168
	speed: 0.0397s/iter; left time: 442.1192s
	iters: 400, epoch: 1 | loss: 0.3847927
	speed: 0.0367s/iter; left time: 405.5765s
	iters: 500, epoch: 1 | loss: 0.4401209
	speed: 0.0350s/iter; left time: 383.4410s
	iters: 600, epoch: 1 | loss: 0.4581241
	speed: 0.0326s/iter; left time: 353.0132s
	iters: 700, epoch: 1 | loss: 0.5530099
	speed: 0.0308s/iter; left time: 330.7928s
	iters: 800, epoch: 1 | loss: 0.3714539
	speed: 0.0315s/iter; left time: 335.1825s
	iters: 900, epoch: 1 | loss: 0.5375144
	speed: 0.0318s/iter; left time: 334.7808s
	iters: 1000, epoch: 1 | loss: 0.9622109
	speed: 0.0311s/iter; left time: 324.4488s
	iters: 1100, epoch: 1 | loss: 0.8077025
	speed: 0.0305s/iter; left time: 315.4671s
Epoch: 1 cost time: 34.97819685935974
Epoch: 1, Steps: 1144 | Train Loss: 0.5639292 Vali Loss: 0.5179102 Test Loss: 0.2331211
Validation loss decreased (inf --> 0.517910).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3632421
	speed: 0.0283s/iter; left time: 288.9607s
	iters: 200, epoch: 2 | loss: 0.4083929
	speed: 0.0253s/iter; left time: 255.6194s
	iters: 300, epoch: 2 | loss: 0.4703470
	speed: 0.0241s/iter; left time: 241.0331s
	iters: 400, epoch: 2 | loss: 0.9038455
	speed: 0.0223s/iter; left time: 220.4593s
	iters: 500, epoch: 2 | loss: 0.4233625
	speed: 0.0211s/iter; left time: 207.0472s
	iters: 600, epoch: 2 | loss: 0.4983356
	speed: 0.0203s/iter; left time: 196.7227s
	iters: 700, epoch: 2 | loss: 0.3552364
	speed: 0.0195s/iter; left time: 187.0108s
	iters: 800, epoch: 2 | loss: 0.4061115
	speed: 0.0199s/iter; left time: 189.1196s
	iters: 900, epoch: 2 | loss: 0.3308461
	speed: 0.0203s/iter; left time: 190.3251s
	iters: 1000, epoch: 2 | loss: 0.3569548
	speed: 0.0204s/iter; left time: 189.9809s
	iters: 1100, epoch: 2 | loss: 0.3546582
	speed: 0.0209s/iter; left time: 192.4055s
Epoch: 2 cost time: 24.16741919517517
Epoch: 2, Steps: 1144 | Train Loss: 0.5118739 Vali Loss: 0.4996144 Test Loss: 0.2254931
Validation loss decreased (0.517910 --> 0.499614).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7596279
	speed: 0.0289s/iter; left time: 261.7327s
	iters: 200, epoch: 3 | loss: 0.8910288
	speed: 0.0258s/iter; left time: 230.7469s
	iters: 300, epoch: 3 | loss: 0.4316133
	speed: 0.0247s/iter; left time: 218.6066s
	iters: 400, epoch: 3 | loss: 0.3193463
	speed: 0.0253s/iter; left time: 221.1734s
	iters: 500, epoch: 3 | loss: 0.3593009
	speed: 0.0247s/iter; left time: 213.5653s
	iters: 600, epoch: 3 | loss: 0.5219376
	speed: 0.0249s/iter; left time: 212.9048s
	iters: 700, epoch: 3 | loss: 0.8482313
	speed: 0.0255s/iter; left time: 215.5521s
	iters: 800, epoch: 3 | loss: 0.6143688
	speed: 0.0250s/iter; left time: 209.1190s
	iters: 900, epoch: 3 | loss: 0.4015012
	speed: 0.0245s/iter; left time: 201.9970s
	iters: 1000, epoch: 3 | loss: 0.9129453
	speed: 0.0240s/iter; left time: 195.6320s
	iters: 1100, epoch: 3 | loss: 0.3153941
	speed: 0.0243s/iter; left time: 195.3256s
Epoch: 3 cost time: 28.04282832145691
Epoch: 3, Steps: 1144 | Train Loss: 0.4939302 Vali Loss: 0.4948893 Test Loss: 0.2226739
Validation loss decreased (0.499614 --> 0.494889).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4118334
	speed: 0.0281s/iter; left time: 222.1866s
	iters: 200, epoch: 4 | loss: 0.3552693
	speed: 0.0255s/iter; left time: 199.3603s
	iters: 300, epoch: 4 | loss: 0.8986270
	speed: 0.0246s/iter; left time: 189.7830s
	iters: 400, epoch: 4 | loss: 0.3822443
	speed: 0.0245s/iter; left time: 186.3388s
	iters: 500, epoch: 4 | loss: 0.4299344
	speed: 0.0245s/iter; left time: 184.2162s
	iters: 600, epoch: 4 | loss: 0.9330974
	speed: 0.0245s/iter; left time: 181.8218s
	iters: 700, epoch: 4 | loss: 0.3405855
	speed: 0.0242s/iter; left time: 177.1420s
	iters: 800, epoch: 4 | loss: 0.8290237
	speed: 0.0237s/iter; left time: 170.7533s
	iters: 900, epoch: 4 | loss: 0.3237439
	speed: 0.0236s/iter; left time: 167.7244s
	iters: 1000, epoch: 4 | loss: 0.3936194
	speed: 0.0246s/iter; left time: 172.6353s
	iters: 1100, epoch: 4 | loss: 0.3147620
	speed: 0.0254s/iter; left time: 175.6232s
Epoch: 4 cost time: 29.16504168510437
Epoch: 4, Steps: 1144 | Train Loss: 0.4846527 Vali Loss: 0.4957300 Test Loss: 0.2221855
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5026271
	speed: 0.0370s/iter; left time: 250.0036s
	iters: 200, epoch: 5 | loss: 0.4936150
	speed: 0.0306s/iter; left time: 203.9719s
	iters: 300, epoch: 5 | loss: 0.4425201
	speed: 0.0271s/iter; left time: 178.0121s
	iters: 400, epoch: 5 | loss: 0.4441941
	speed: 0.0251s/iter; left time: 162.2361s
	iters: 500, epoch: 5 | loss: 0.3809913
	speed: 0.0239s/iter; left time: 152.3798s
	iters: 600, epoch: 5 | loss: 0.4344817
	speed: 0.0227s/iter; left time: 142.1437s
	iters: 700, epoch: 5 | loss: 0.3770962
	speed: 0.0216s/iter; left time: 133.0516s
	iters: 800, epoch: 5 | loss: 0.4156886
	speed: 0.0207s/iter; left time: 125.6143s
	iters: 900, epoch: 5 | loss: 0.3955402
	speed: 0.0201s/iter; left time: 119.9471s
	iters: 1000, epoch: 5 | loss: 0.3964136
	speed: 0.0196s/iter; left time: 115.0063s
	iters: 1100, epoch: 5 | loss: 0.4247224
	speed: 0.0192s/iter; left time: 110.7418s
Epoch: 5 cost time: 21.80375647544861
Epoch: 5, Steps: 1144 | Train Loss: 0.4782946 Vali Loss: 0.4929277 Test Loss: 0.2216718
Validation loss decreased (0.494889 --> 0.492928).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5589526
	speed: 0.0258s/iter; left time: 145.1303s
	iters: 200, epoch: 6 | loss: 0.4798440
	speed: 0.0241s/iter; left time: 133.1107s
	iters: 300, epoch: 6 | loss: 0.8934199
	speed: 0.0235s/iter; left time: 127.3766s
	iters: 400, epoch: 6 | loss: 0.3854499
	speed: 0.0244s/iter; left time: 129.9547s
	iters: 500, epoch: 6 | loss: 0.3524111
	speed: 0.0260s/iter; left time: 135.6401s
	iters: 600, epoch: 6 | loss: 0.8410754
	speed: 0.0255s/iter; left time: 130.3559s
	iters: 700, epoch: 6 | loss: 0.8599377
	speed: 0.0254s/iter; left time: 127.3127s
	iters: 800, epoch: 6 | loss: 0.5691722
	speed: 0.0249s/iter; left time: 122.6588s
	iters: 900, epoch: 6 | loss: 0.3978601
	speed: 0.0243s/iter; left time: 117.3808s
	iters: 1000, epoch: 6 | loss: 0.7995061
	speed: 0.0245s/iter; left time: 115.4384s
	iters: 1100, epoch: 6 | loss: 0.3591596
	speed: 0.0246s/iter; left time: 113.6595s
Epoch: 6 cost time: 28.295217752456665
Epoch: 6, Steps: 1144 | Train Loss: 0.4750846 Vali Loss: 0.4928001 Test Loss: 0.2211091
Validation loss decreased (0.492928 --> 0.492800).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3679575
	speed: 0.0410s/iter; left time: 183.4985s
	iters: 200, epoch: 7 | loss: 0.4684548
	speed: 0.0344s/iter; left time: 150.6715s
	iters: 300, epoch: 7 | loss: 0.8591943
	speed: 0.0311s/iter; left time: 132.9154s
	iters: 400, epoch: 7 | loss: 0.9870859
	speed: 0.0290s/iter; left time: 121.0429s
	iters: 500, epoch: 7 | loss: 0.3951381
	speed: 0.0277s/iter; left time: 112.8205s
	iters: 600, epoch: 7 | loss: 0.5018554
	speed: 0.0271s/iter; left time: 107.6003s
	iters: 700, epoch: 7 | loss: 0.8085057
	speed: 0.0272s/iter; left time: 105.3867s
	iters: 800, epoch: 7 | loss: 0.4681705
	speed: 0.0264s/iter; left time: 99.8276s
	iters: 900, epoch: 7 | loss: 0.4055659
	speed: 0.0259s/iter; left time: 95.2450s
	iters: 1000, epoch: 7 | loss: 1.3245130
	speed: 0.0257s/iter; left time: 91.9164s
	iters: 1100, epoch: 7 | loss: 0.3314341
	speed: 0.0256s/iter; left time: 88.9590s
Epoch: 7 cost time: 29.369388580322266
Epoch: 7, Steps: 1144 | Train Loss: 0.4733417 Vali Loss: 0.4927503 Test Loss: 0.2215556
Validation loss decreased (0.492800 --> 0.492750).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2898358
	speed: 0.0426s/iter; left time: 142.0345s
	iters: 200, epoch: 8 | loss: 0.3675445
	speed: 0.0329s/iter; left time: 106.4886s
	iters: 300, epoch: 8 | loss: 0.3115305
	speed: 0.0275s/iter; left time: 86.0185s
	iters: 400, epoch: 8 | loss: 0.4022538
	speed: 0.0247s/iter; left time: 74.8124s
	iters: 500, epoch: 8 | loss: 0.4866235
	speed: 0.0228s/iter; left time: 66.9734s
	iters: 600, epoch: 8 | loss: 0.4786138
	speed: 0.0215s/iter; left time: 60.9119s
	iters: 700, epoch: 8 | loss: 0.3756855
	speed: 0.0206s/iter; left time: 56.3225s
	iters: 800, epoch: 8 | loss: 0.3367503
	speed: 0.0197s/iter; left time: 51.8567s
	iters: 900, epoch: 8 | loss: 0.3044803
	speed: 0.0196s/iter; left time: 49.7305s
	iters: 1000, epoch: 8 | loss: 1.2551010
	speed: 0.0201s/iter; left time: 48.9454s
	iters: 1100, epoch: 8 | loss: 0.4379598
	speed: 0.0205s/iter; left time: 47.9382s
Epoch: 8 cost time: 23.789084434509277
Epoch: 8, Steps: 1144 | Train Loss: 0.4723328 Vali Loss: 0.4925838 Test Loss: 0.2213034
Validation loss decreased (0.492750 --> 0.492584).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.9338599
	speed: 0.0312s/iter; left time: 68.3922s
	iters: 200, epoch: 9 | loss: 0.4426428
	speed: 0.0268s/iter; left time: 55.9924s
	iters: 300, epoch: 9 | loss: 0.4225749
	speed: 0.0253s/iter; left time: 50.2388s
	iters: 400, epoch: 9 | loss: 0.3103450
	speed: 0.0245s/iter; left time: 46.3643s
	iters: 500, epoch: 9 | loss: 0.4897063
	speed: 0.0244s/iter; left time: 43.5681s
	iters: 600, epoch: 9 | loss: 0.4247266
	speed: 0.0239s/iter; left time: 40.4404s
	iters: 700, epoch: 9 | loss: 0.4436270
	speed: 0.0233s/iter; left time: 37.0685s
	iters: 800, epoch: 9 | loss: 0.3365265
	speed: 0.0229s/iter; left time: 34.1347s
	iters: 900, epoch: 9 | loss: 0.4044172
	speed: 0.0226s/iter; left time: 31.3933s
	iters: 1000, epoch: 9 | loss: 0.2934856
	speed: 0.0224s/iter; left time: 28.8466s
	iters: 1100, epoch: 9 | loss: 0.3501997
	speed: 0.0226s/iter; left time: 26.8764s
Epoch: 9 cost time: 26.091280221939087
Epoch: 9, Steps: 1144 | Train Loss: 0.4720008 Vali Loss: 0.4921901 Test Loss: 0.2213009
Validation loss decreased (0.492584 --> 0.492190).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3494831
	speed: 0.0343s/iter; left time: 35.8390s
	iters: 200, epoch: 10 | loss: 1.0118616
	speed: 0.0286s/iter; left time: 27.0696s
	iters: 300, epoch: 10 | loss: 0.3513151
	speed: 0.0266s/iter; left time: 22.4524s
	iters: 400, epoch: 10 | loss: 0.3913260
	speed: 0.0255s/iter; left time: 19.0245s
	iters: 500, epoch: 10 | loss: 0.4498001
	speed: 0.0249s/iter; left time: 16.0715s
	iters: 600, epoch: 10 | loss: 0.4489357
	speed: 0.0248s/iter; left time: 13.5197s
	iters: 700, epoch: 10 | loss: 1.0664639
	speed: 0.0248s/iter; left time: 11.0391s
	iters: 800, epoch: 10 | loss: 0.3160324
	speed: 0.0245s/iter; left time: 8.4551s
	iters: 900, epoch: 10 | loss: 0.3443528
	speed: 0.0243s/iter; left time: 5.9417s
	iters: 1000, epoch: 10 | loss: 0.7341501
	speed: 0.0238s/iter; left time: 3.4465s
	iters: 1100, epoch: 10 | loss: 0.4380364
	speed: 0.0234s/iter; left time: 1.0542s
Epoch: 10 cost time: 26.87303376197815
Epoch: 10, Steps: 1144 | Train Loss: 0.4716223 Vali Loss: 0.4917843 Test Loss: 0.2213539
Validation loss decreased (0.492190 --> 0.491784).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.22135385870933533, mae:0.258197546005249
Use GPU: cuda:0
no_skip False
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.3782098
	speed: 0.0309s/iter; left time: 350.7459s
	iters: 200, epoch: 1 | loss: 0.7805709
	speed: 0.0269s/iter; left time: 302.1790s
	iters: 300, epoch: 1 | loss: 0.9422687
	speed: 0.0251s/iter; left time: 279.3170s
	iters: 400, epoch: 1 | loss: 0.6387627
	speed: 0.0240s/iter; left time: 264.8628s
	iters: 500, epoch: 1 | loss: 0.9649559
	speed: 0.0227s/iter; left time: 247.9404s
	iters: 600, epoch: 1 | loss: 0.4075425
	speed: 0.0215s/iter; left time: 233.1590s
	iters: 700, epoch: 1 | loss: 0.3986290
	speed: 0.0206s/iter; left time: 221.7190s
	iters: 800, epoch: 1 | loss: 0.4487346
	speed: 0.0197s/iter; left time: 210.1318s
	iters: 900, epoch: 1 | loss: 0.4962131
	speed: 0.0200s/iter; left time: 210.6802s
	iters: 1000, epoch: 1 | loss: 0.4888518
	speed: 0.0203s/iter; left time: 211.5930s
	iters: 1100, epoch: 1 | loss: 0.4629290
	speed: 0.0205s/iter; left time: 211.8960s
Epoch: 1 cost time: 23.662126541137695
Epoch: 1, Steps: 1144 | Train Loss: 0.5625260 Vali Loss: 0.5205117 Test Loss: 0.2335975
Validation loss decreased (inf --> 0.520512).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4064469
	speed: 0.0412s/iter; left time: 419.6763s
	iters: 200, epoch: 2 | loss: 0.4633706
	speed: 0.0359s/iter; left time: 362.2396s
	iters: 300, epoch: 2 | loss: 0.4202020
	speed: 0.0337s/iter; left time: 336.4197s
	iters: 400, epoch: 2 | loss: 0.4273896
	speed: 0.0308s/iter; left time: 304.6076s
	iters: 500, epoch: 2 | loss: 0.3633245
	speed: 0.0287s/iter; left time: 280.9564s
	iters: 600, epoch: 2 | loss: 0.4234045
	speed: 0.0273s/iter; left time: 264.6284s
	iters: 700, epoch: 2 | loss: 0.5427315
	speed: 0.0264s/iter; left time: 253.0802s
	iters: 800, epoch: 2 | loss: 0.9839400
	speed: 0.0261s/iter; left time: 247.7242s
	iters: 900, epoch: 2 | loss: 0.4702283
	speed: 0.0255s/iter; left time: 239.5044s
	iters: 1000, epoch: 2 | loss: 0.9314036
	speed: 0.0250s/iter; left time: 231.9798s
	iters: 1100, epoch: 2 | loss: 0.4080924
	speed: 0.0244s/iter; left time: 224.5267s
Epoch: 2 cost time: 28.119624853134155
Epoch: 2, Steps: 1144 | Train Loss: 0.5165483 Vali Loss: 0.4991508 Test Loss: 0.2264436
Validation loss decreased (0.520512 --> 0.499151).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4181599
	speed: 0.0432s/iter; left time: 390.6837s
	iters: 200, epoch: 3 | loss: 0.4519919
	speed: 0.0332s/iter; left time: 297.2206s
	iters: 300, epoch: 3 | loss: 0.4176806
	speed: 0.0301s/iter; left time: 266.4924s
	iters: 400, epoch: 3 | loss: 0.3655590
	speed: 0.0282s/iter; left time: 246.4681s
	iters: 500, epoch: 3 | loss: 0.3957528
	speed: 0.0270s/iter; left time: 233.4635s
	iters: 600, epoch: 3 | loss: 0.3971271
	speed: 0.0258s/iter; left time: 220.9020s
	iters: 700, epoch: 3 | loss: 0.3871162
	speed: 0.0253s/iter; left time: 213.8128s
	iters: 800, epoch: 3 | loss: 0.8762496
	speed: 0.0246s/iter; left time: 205.5288s
	iters: 900, epoch: 3 | loss: 0.3887004
	speed: 0.0240s/iter; left time: 198.3364s
	iters: 1000, epoch: 3 | loss: 0.3531884
	speed: 0.0241s/iter; left time: 196.1011s
	iters: 1100, epoch: 3 | loss: 0.4293361
	speed: 0.0237s/iter; left time: 191.2270s
Epoch: 3 cost time: 27.378551244735718
Epoch: 3, Steps: 1144 | Train Loss: 0.4977227 Vali Loss: 0.4939593 Test Loss: 0.2240300
Validation loss decreased (0.499151 --> 0.493959).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4898007
	speed: 0.0329s/iter; left time: 260.4937s
	iters: 200, epoch: 4 | loss: 0.5706316
	speed: 0.0256s/iter; left time: 200.0588s
	iters: 300, epoch: 4 | loss: 0.4088864
	speed: 0.0240s/iter; left time: 184.6338s
	iters: 400, epoch: 4 | loss: 1.0139730
	speed: 0.0221s/iter; left time: 168.4241s
	iters: 500, epoch: 4 | loss: 0.4570146
	speed: 0.0243s/iter; left time: 182.2883s
	iters: 600, epoch: 4 | loss: 0.3196683
	speed: 0.0243s/iter; left time: 180.0494s
	iters: 700, epoch: 4 | loss: 0.3573446
	speed: 0.0241s/iter; left time: 176.1500s
	iters: 800, epoch: 4 | loss: 0.5133135
	speed: 0.0239s/iter; left time: 172.5428s
	iters: 900, epoch: 4 | loss: 0.5719609
	speed: 0.0238s/iter; left time: 168.8742s
	iters: 1000, epoch: 4 | loss: 0.4389837
	speed: 0.0236s/iter; left time: 165.6733s
	iters: 1100, epoch: 4 | loss: 0.3492578
	speed: 0.0235s/iter; left time: 162.5506s
Epoch: 4 cost time: 26.895451307296753
Epoch: 4, Steps: 1144 | Train Loss: 0.4870472 Vali Loss: 0.4916004 Test Loss: 0.2222391
Validation loss decreased (0.493959 --> 0.491600).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.9184363
	speed: 0.0342s/iter; left time: 231.6974s
	iters: 200, epoch: 5 | loss: 0.4360798
	speed: 0.0286s/iter; left time: 190.9390s
	iters: 300, epoch: 5 | loss: 0.3968669
	speed: 0.0265s/iter; left time: 173.9722s
	iters: 400, epoch: 5 | loss: 0.3504298
	speed: 0.0255s/iter; left time: 165.1230s
	iters: 500, epoch: 5 | loss: 0.6281502
	speed: 0.0250s/iter; left time: 159.2824s
	iters: 600, epoch: 5 | loss: 0.3719432
	speed: 0.0246s/iter; left time: 153.8413s
	iters: 700, epoch: 5 | loss: 0.3361822
	speed: 0.0239s/iter; left time: 147.2388s
	iters: 800, epoch: 5 | loss: 0.3325201
	speed: 0.0240s/iter; left time: 145.6708s
	iters: 900, epoch: 5 | loss: 0.5035025
	speed: 0.0243s/iter; left time: 145.1761s
	iters: 1000, epoch: 5 | loss: 0.5027847
	speed: 0.0244s/iter; left time: 143.2387s
	iters: 1100, epoch: 5 | loss: 0.5221745
	speed: 0.0245s/iter; left time: 141.0358s
Epoch: 5 cost time: 28.122917890548706
Epoch: 5, Steps: 1144 | Train Loss: 0.4810687 Vali Loss: 0.4944508 Test Loss: 0.2228699
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4121008
	speed: 0.0288s/iter; left time: 161.9549s
	iters: 200, epoch: 6 | loss: 1.0049685
	speed: 0.0269s/iter; left time: 148.5134s
	iters: 300, epoch: 6 | loss: 0.3278452
	speed: 0.0263s/iter; left time: 142.6074s
	iters: 400, epoch: 6 | loss: 0.4627878
	speed: 0.0259s/iter; left time: 137.9504s
	iters: 500, epoch: 6 | loss: 0.3640082
	speed: 0.0257s/iter; left time: 133.9260s
	iters: 600, epoch: 6 | loss: 0.3474146
	speed: 0.0250s/iter; left time: 128.1996s
	iters: 700, epoch: 6 | loss: 0.4388916
	speed: 0.0245s/iter; left time: 122.9330s
	iters: 800, epoch: 6 | loss: 0.3728956
	speed: 0.0244s/iter; left time: 119.9838s
	iters: 900, epoch: 6 | loss: 0.3470219
	speed: 0.0248s/iter; left time: 119.4569s
	iters: 1000, epoch: 6 | loss: 0.3432411
	speed: 0.0245s/iter; left time: 115.7943s
	iters: 1100, epoch: 6 | loss: 0.3264754
	speed: 0.0245s/iter; left time: 113.3169s
Epoch: 6 cost time: 28.187615394592285
Epoch: 6, Steps: 1144 | Train Loss: 0.4778074 Vali Loss: 0.4933468 Test Loss: 0.2216715
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4957128
	speed: 0.0291s/iter; left time: 130.1452s
	iters: 200, epoch: 7 | loss: 0.3056347
	speed: 0.0258s/iter; left time: 112.9950s
	iters: 300, epoch: 7 | loss: 0.5143629
	speed: 0.0281s/iter; left time: 120.1350s
	iters: 400, epoch: 7 | loss: 0.3885676
	speed: 0.0268s/iter; left time: 112.1302s
	iters: 500, epoch: 7 | loss: 0.2955008
	speed: 0.0265s/iter; left time: 108.1707s
	iters: 600, epoch: 7 | loss: 0.4970230
	speed: 0.0272s/iter; left time: 108.0330s
	iters: 700, epoch: 7 | loss: 0.5234467
	speed: 0.0264s/iter; left time: 102.3823s
	iters: 800, epoch: 7 | loss: 0.3672603
	speed: 0.0265s/iter; left time: 100.1501s
	iters: 900, epoch: 7 | loss: 0.4780140
	speed: 0.0272s/iter; left time: 99.9107s
	iters: 1000, epoch: 7 | loss: 0.4639331
	speed: 0.0278s/iter; left time: 99.4299s
	iters: 1100, epoch: 7 | loss: 0.2715523
	speed: 0.0277s/iter; left time: 96.3598s
Epoch: 7 cost time: 31.560540437698364
Epoch: 7, Steps: 1144 | Train Loss: 0.4760816 Vali Loss: 0.4919856 Test Loss: 0.2212830
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3657347
	speed: 0.0454s/iter; left time: 151.4837s
	iters: 200, epoch: 8 | loss: 0.3676731
	speed: 0.0389s/iter; left time: 125.8353s
	iters: 300, epoch: 8 | loss: 0.4080584
	speed: 0.0349s/iter; left time: 109.4615s
	iters: 400, epoch: 8 | loss: 0.3903734
	speed: 0.0319s/iter; left time: 96.7329s
	iters: 500, epoch: 8 | loss: 0.8808503
	speed: 0.0300s/iter; left time: 87.9185s
	iters: 600, epoch: 8 | loss: 1.3305072
	speed: 0.0283s/iter; left time: 80.1639s
	iters: 700, epoch: 8 | loss: 0.4879205
	speed: 0.0272s/iter; left time: 74.3087s
	iters: 800, epoch: 8 | loss: 0.5038090
	speed: 0.0265s/iter; left time: 69.7411s
	iters: 900, epoch: 8 | loss: 0.6961261
	speed: 0.0257s/iter; left time: 64.9944s
	iters: 1000, epoch: 8 | loss: 0.4299483
	speed: 0.0251s/iter; left time: 61.1060s
	iters: 1100, epoch: 8 | loss: 0.8345985
	speed: 0.0249s/iter; left time: 58.1255s
Epoch: 8 cost time: 28.536248207092285
Epoch: 8, Steps: 1144 | Train Loss: 0.4753170 Vali Loss: 0.4923913 Test Loss: 0.2213454
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4530945
	speed: 0.0408s/iter; left time: 89.2050s
	iters: 200, epoch: 9 | loss: 0.4116882
	speed: 0.0404s/iter; left time: 84.3242s
	iters: 300, epoch: 9 | loss: 0.9664336
	speed: 0.0402s/iter; left time: 80.0542s
	iters: 400, epoch: 9 | loss: 0.5435647
	speed: 0.0371s/iter; left time: 70.1082s
	iters: 500, epoch: 9 | loss: 0.3596103
	speed: 0.0340s/iter; left time: 60.7510s
	iters: 600, epoch: 9 | loss: 0.4267577
	speed: 0.0316s/iter; left time: 53.3283s
	iters: 700, epoch: 9 | loss: 0.4608549
	speed: 0.0299s/iter; left time: 47.4419s
	iters: 800, epoch: 9 | loss: 0.4613920
	speed: 0.0286s/iter; left time: 42.6191s
	iters: 900, epoch: 9 | loss: 0.8072417
	speed: 0.0280s/iter; left time: 38.9371s
	iters: 1000, epoch: 9 | loss: 0.3970599
	speed: 0.0275s/iter; left time: 35.4394s
	iters: 1100, epoch: 9 | loss: 0.3487357
	speed: 0.0271s/iter; left time: 32.1696s
Epoch: 9 cost time: 30.890300273895264
Epoch: 9, Steps: 1144 | Train Loss: 0.4748448 Vali Loss: 0.4923922 Test Loss: 0.2213375
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.22223898768424988, mae:0.2585756182670593
Use GPU: cuda:0
no_skip False
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.6102040
	speed: 0.0459s/iter; left time: 520.3444s
	iters: 200, epoch: 1 | loss: 0.4156030
	speed: 0.0347s/iter; left time: 389.7337s
	iters: 300, epoch: 1 | loss: 0.4833691
	speed: 0.0295s/iter; left time: 328.2914s
	iters: 400, epoch: 1 | loss: 0.5591509
	speed: 0.0270s/iter; left time: 298.0790s
	iters: 500, epoch: 1 | loss: 1.3094862
	speed: 0.0266s/iter; left time: 290.9511s
	iters: 600, epoch: 1 | loss: 0.5051606
	speed: 0.0277s/iter; left time: 300.4878s
	iters: 700, epoch: 1 | loss: 0.3487445
	speed: 0.0268s/iter; left time: 288.2467s
	iters: 800, epoch: 1 | loss: 0.5875288
	speed: 0.0264s/iter; left time: 280.5564s
	iters: 900, epoch: 1 | loss: 0.5193126
	speed: 0.0260s/iter; left time: 273.7876s
	iters: 1000, epoch: 1 | loss: 0.4261299
	speed: 0.0257s/iter; left time: 268.0688s
	iters: 1100, epoch: 1 | loss: 0.4385452
	speed: 0.0259s/iter; left time: 267.3657s
Epoch: 1 cost time: 29.64650273323059
Epoch: 1, Steps: 1144 | Train Loss: 0.5601789 Vali Loss: 0.5187189 Test Loss: 0.2329194
Validation loss decreased (inf --> 0.518719).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4888821
	speed: 0.0289s/iter; left time: 294.7025s
	iters: 200, epoch: 2 | loss: 0.8695591
	speed: 0.0244s/iter; left time: 246.3610s
	iters: 300, epoch: 2 | loss: 0.5170011
	speed: 0.0230s/iter; left time: 230.1625s
	iters: 400, epoch: 2 | loss: 0.3729061
	speed: 0.0223s/iter; left time: 220.7250s
	iters: 500, epoch: 2 | loss: 0.3576955
	speed: 0.0221s/iter; left time: 216.4258s
	iters: 600, epoch: 2 | loss: 0.4958963
	speed: 0.0225s/iter; left time: 217.6994s
	iters: 700, epoch: 2 | loss: 0.4180990
	speed: 0.0226s/iter; left time: 216.8697s
	iters: 800, epoch: 2 | loss: 0.3842605
	speed: 0.0226s/iter; left time: 214.7602s
	iters: 900, epoch: 2 | loss: 0.3342657
	speed: 0.0226s/iter; left time: 212.8116s
	iters: 1000, epoch: 2 | loss: 1.0401677
	speed: 0.0227s/iter; left time: 210.9837s
	iters: 1100, epoch: 2 | loss: 0.3538216
	speed: 0.0227s/iter; left time: 208.4925s
Epoch: 2 cost time: 26.075596570968628
Epoch: 2, Steps: 1144 | Train Loss: 0.5150781 Vali Loss: 0.5007610 Test Loss: 0.2261232
Validation loss decreased (0.518719 --> 0.500761).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5425494
	speed: 0.0441s/iter; left time: 399.5906s
	iters: 200, epoch: 3 | loss: 0.3625440
	speed: 0.0326s/iter; left time: 291.6311s
	iters: 300, epoch: 3 | loss: 0.3449326
	speed: 0.0297s/iter; left time: 262.8051s
	iters: 400, epoch: 3 | loss: 0.3523834
	speed: 0.0273s/iter; left time: 239.3063s
	iters: 500, epoch: 3 | loss: 0.4461068
	speed: 0.0260s/iter; left time: 225.1568s
	iters: 600, epoch: 3 | loss: 0.3862029
	speed: 0.0254s/iter; left time: 217.6564s
	iters: 700, epoch: 3 | loss: 0.9572695
	speed: 0.0254s/iter; left time: 214.2901s
	iters: 800, epoch: 3 | loss: 0.3893197
	speed: 0.0251s/iter; left time: 209.6305s
	iters: 900, epoch: 3 | loss: 0.4022797
	speed: 0.0247s/iter; left time: 204.1873s
	iters: 1000, epoch: 3 | loss: 0.4466915
	speed: 0.0240s/iter; left time: 195.9877s
	iters: 1100, epoch: 3 | loss: 0.5029970
	speed: 0.0235s/iter; left time: 188.9979s
Epoch: 3 cost time: 26.70318031311035
Epoch: 3, Steps: 1144 | Train Loss: 0.4970703 Vali Loss: 0.4945906 Test Loss: 0.2232709
Validation loss decreased (0.500761 --> 0.494591).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8039095
	speed: 0.0240s/iter; left time: 189.9445s
	iters: 200, epoch: 4 | loss: 0.2950621
	speed: 0.0215s/iter; left time: 168.1042s
	iters: 300, epoch: 4 | loss: 0.8013765
	speed: 0.0194s/iter; left time: 149.6891s
	iters: 400, epoch: 4 | loss: 0.4149850
	speed: 0.0178s/iter; left time: 135.7643s
	iters: 500, epoch: 4 | loss: 0.5369924
	speed: 0.0170s/iter; left time: 127.3704s
	iters: 600, epoch: 4 | loss: 0.5355942
	speed: 0.0168s/iter; left time: 124.6312s
	iters: 700, epoch: 4 | loss: 0.9521298
	speed: 0.0168s/iter; left time: 122.4659s
	iters: 800, epoch: 4 | loss: 0.4005156
	speed: 0.0165s/iter; left time: 119.1660s
	iters: 900, epoch: 4 | loss: 0.4680528
	speed: 0.0161s/iter; left time: 114.7079s
	iters: 1000, epoch: 4 | loss: 0.4051462
	speed: 0.0164s/iter; left time: 115.2813s
	iters: 1100, epoch: 4 | loss: 0.3438128
	speed: 0.0168s/iter; left time: 116.1760s
Epoch: 4 cost time: 19.39926266670227
Epoch: 4, Steps: 1144 | Train Loss: 0.4878193 Vali Loss: 0.4977176 Test Loss: 0.2228546
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4405587
	speed: 0.0323s/iter; left time: 218.7055s
	iters: 200, epoch: 5 | loss: 0.3961743
	speed: 0.0268s/iter; left time: 178.6520s
	iters: 300, epoch: 5 | loss: 0.3196276
	speed: 0.0256s/iter; left time: 168.0495s
	iters: 400, epoch: 5 | loss: 0.3697991
	speed: 0.0250s/iter; left time: 161.5799s
	iters: 500, epoch: 5 | loss: 0.2986060
	speed: 0.0245s/iter; left time: 155.7883s
	iters: 600, epoch: 5 | loss: 0.4944687
	speed: 0.0241s/iter; left time: 151.1169s
	iters: 700, epoch: 5 | loss: 0.3977704
	speed: 0.0239s/iter; left time: 147.1157s
	iters: 800, epoch: 5 | loss: 0.3600844
	speed: 0.0235s/iter; left time: 142.5602s
	iters: 900, epoch: 5 | loss: 0.4226609
	speed: 0.0234s/iter; left time: 139.5144s
	iters: 1000, epoch: 5 | loss: 0.4505959
	speed: 0.0235s/iter; left time: 137.7713s
	iters: 1100, epoch: 5 | loss: 0.3885964
	speed: 0.0236s/iter; left time: 136.0396s
Epoch: 5 cost time: 27.050583839416504
Epoch: 5, Steps: 1144 | Train Loss: 0.4820743 Vali Loss: 0.4988090 Test Loss: 0.2227749
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8153481
	speed: 0.0285s/iter; left time: 160.4520s
	iters: 200, epoch: 6 | loss: 0.3756967
	speed: 0.0264s/iter; left time: 145.6378s
	iters: 300, epoch: 6 | loss: 0.4934330
	speed: 0.0256s/iter; left time: 138.6713s
	iters: 400, epoch: 6 | loss: 0.4722160
	speed: 0.0252s/iter; left time: 134.2258s
	iters: 500, epoch: 6 | loss: 0.8317975
	speed: 0.0250s/iter; left time: 130.5790s
	iters: 600, epoch: 6 | loss: 0.5104609
	speed: 0.0247s/iter; left time: 126.4934s
	iters: 700, epoch: 6 | loss: 0.3011358
	speed: 0.0244s/iter; left time: 122.5638s
	iters: 800, epoch: 6 | loss: 0.4122700
	speed: 0.0242s/iter; left time: 119.2231s
	iters: 900, epoch: 6 | loss: 0.4886896
	speed: 0.0240s/iter; left time: 115.8134s
	iters: 1000, epoch: 6 | loss: 0.5037326
	speed: 0.0239s/iter; left time: 112.6317s
	iters: 1100, epoch: 6 | loss: 0.3972310
	speed: 0.0237s/iter; left time: 109.7428s
Epoch: 6 cost time: 27.34536337852478
Epoch: 6, Steps: 1144 | Train Loss: 0.4789667 Vali Loss: 0.4971726 Test Loss: 0.2221224
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4617971
	speed: 0.0241s/iter; left time: 107.7054s
	iters: 200, epoch: 7 | loss: 0.4266367
	speed: 0.0219s/iter; left time: 95.8481s
	iters: 300, epoch: 7 | loss: 0.3252642
	speed: 0.0215s/iter; left time: 92.0931s
	iters: 400, epoch: 7 | loss: 0.3320307
	speed: 0.0225s/iter; left time: 94.0955s
	iters: 500, epoch: 7 | loss: 0.8468880
	speed: 0.0236s/iter; left time: 96.1352s
	iters: 600, epoch: 7 | loss: 0.7120491
	speed: 0.0246s/iter; left time: 97.8569s
	iters: 700, epoch: 7 | loss: 0.3930874
	speed: 0.0241s/iter; left time: 93.5843s
	iters: 800, epoch: 7 | loss: 1.3715031
	speed: 0.0235s/iter; left time: 88.7377s
	iters: 900, epoch: 7 | loss: 0.3451607
	speed: 0.0232s/iter; left time: 85.4063s
	iters: 1000, epoch: 7 | loss: 0.4068451
	speed: 0.0227s/iter; left time: 81.0495s
	iters: 1100, epoch: 7 | loss: 0.2778564
	speed: 0.0222s/iter; left time: 77.1785s
Epoch: 7 cost time: 25.32504940032959
Epoch: 7, Steps: 1144 | Train Loss: 0.4772831 Vali Loss: 0.4975094 Test Loss: 0.2219006
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.8420545
	speed: 0.0244s/iter; left time: 81.2699s
	iters: 200, epoch: 8 | loss: 0.5558334
	speed: 0.0229s/iter; left time: 74.1030s
	iters: 300, epoch: 8 | loss: 0.3550309
	speed: 0.0228s/iter; left time: 71.4622s
	iters: 400, epoch: 8 | loss: 0.4487798
	speed: 0.0235s/iter; left time: 71.3533s
	iters: 500, epoch: 8 | loss: 1.0191793
	speed: 0.0240s/iter; left time: 70.3202s
	iters: 600, epoch: 8 | loss: 0.3853604
	speed: 0.0242s/iter; left time: 68.5609s
	iters: 700, epoch: 8 | loss: 0.3153555
	speed: 0.0244s/iter; left time: 66.6541s
	iters: 800, epoch: 8 | loss: 0.5073242
	speed: 0.0246s/iter; left time: 64.6703s
	iters: 900, epoch: 8 | loss: 0.3713671
	speed: 0.0253s/iter; left time: 64.1449s
	iters: 1000, epoch: 8 | loss: 0.2661062
	speed: 0.0250s/iter; left time: 60.8924s
	iters: 1100, epoch: 8 | loss: 0.4045832
	speed: 0.0248s/iter; left time: 57.8279s
Epoch: 8 cost time: 28.382138967514038
Epoch: 8, Steps: 1144 | Train Loss: 0.4764529 Vali Loss: 0.4978790 Test Loss: 0.2218425
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.2232709527015686, mae:0.260814368724823
Seed: 123
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_336      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip False
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.9635121
	speed: 0.0568s/iter; left time: 642.2632s
	iters: 200, epoch: 1 | loss: 0.6110399
	speed: 0.0405s/iter; left time: 454.0117s
	iters: 300, epoch: 1 | loss: 1.0570663
	speed: 0.0352s/iter; left time: 390.3012s
	iters: 400, epoch: 1 | loss: 0.8303362
	speed: 0.0320s/iter; left time: 351.8636s
	iters: 500, epoch: 1 | loss: 0.5217682
	speed: 0.0301s/iter; left time: 327.8481s
	iters: 600, epoch: 1 | loss: 0.4949165
	speed: 0.0288s/iter; left time: 311.5442s
	iters: 700, epoch: 1 | loss: 0.5899354
	speed: 0.0282s/iter; left time: 301.7396s
	iters: 800, epoch: 1 | loss: 1.0644388
	speed: 0.0274s/iter; left time: 290.7161s
	iters: 900, epoch: 1 | loss: 0.5109698
	speed: 0.0267s/iter; left time: 280.2120s
	iters: 1000, epoch: 1 | loss: 0.7302778
	speed: 0.0260s/iter; left time: 270.7862s
	iters: 1100, epoch: 1 | loss: 0.7773249
	speed: 0.0254s/iter; left time: 261.9024s
Epoch: 1 cost time: 28.888304233551025
Epoch: 1, Steps: 1140 | Train Loss: 0.6307981 Vali Loss: 0.6014025 Test Loss: 0.2852033
Validation loss decreased (inf --> 0.601403).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5560253
	speed: 0.0419s/iter; left time: 425.9585s
	iters: 200, epoch: 2 | loss: 0.7495268
	speed: 0.0376s/iter; left time: 378.7878s
	iters: 300, epoch: 2 | loss: 0.4987053
	speed: 0.0335s/iter; left time: 334.1199s
	iters: 400, epoch: 2 | loss: 0.7061663
	speed: 0.0294s/iter; left time: 290.2577s
	iters: 500, epoch: 2 | loss: 0.7772673
	speed: 0.0270s/iter; left time: 263.3935s
	iters: 600, epoch: 2 | loss: 0.4493264
	speed: 0.0252s/iter; left time: 243.1493s
	iters: 700, epoch: 2 | loss: 0.4846675
	speed: 0.0243s/iter; left time: 232.6698s
	iters: 800, epoch: 2 | loss: 0.5778593
	speed: 0.0255s/iter; left time: 240.8961s
	iters: 900, epoch: 2 | loss: 0.4546260
	speed: 0.0258s/iter; left time: 241.8124s
	iters: 1000, epoch: 2 | loss: 0.4438145
	speed: 0.0255s/iter; left time: 236.5759s
	iters: 1100, epoch: 2 | loss: 0.4259717
	speed: 0.0253s/iter; left time: 231.7523s
Epoch: 2 cost time: 28.89127469062805
Epoch: 2, Steps: 1140 | Train Loss: 0.5809132 Vali Loss: 0.5833247 Test Loss: 0.2790059
Validation loss decreased (0.601403 --> 0.583325).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5557823
	speed: 0.0428s/iter; left time: 386.0483s
	iters: 200, epoch: 3 | loss: 0.4611437
	speed: 0.0421s/iter; left time: 375.5140s
	iters: 300, epoch: 3 | loss: 0.4890053
	speed: 0.0413s/iter; left time: 364.2226s
	iters: 400, epoch: 3 | loss: 0.5680050
	speed: 0.0357s/iter; left time: 311.2575s
	iters: 500, epoch: 3 | loss: 0.4839425
	speed: 0.0330s/iter; left time: 284.7539s
	iters: 600, epoch: 3 | loss: 0.7506205
	speed: 0.0309s/iter; left time: 262.9084s
	iters: 700, epoch: 3 | loss: 0.5069510
	speed: 0.0292s/iter; left time: 246.1728s
	iters: 800, epoch: 3 | loss: 0.4790806
	speed: 0.0282s/iter; left time: 234.2495s
	iters: 900, epoch: 3 | loss: 0.8054911
	speed: 0.0274s/iter; left time: 225.1799s
	iters: 1000, epoch: 3 | loss: 0.5083545
	speed: 0.0267s/iter; left time: 217.0528s
	iters: 1100, epoch: 3 | loss: 0.5241506
	speed: 0.0262s/iter; left time: 210.3235s
Epoch: 3 cost time: 29.751522064208984
Epoch: 3, Steps: 1140 | Train Loss: 0.5639103 Vali Loss: 0.5801728 Test Loss: 0.2774701
Validation loss decreased (0.583325 --> 0.580173).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4870204
	speed: 0.0417s/iter; left time: 328.2682s
	iters: 200, epoch: 4 | loss: 0.7752487
	speed: 0.0357s/iter; left time: 277.5976s
	iters: 300, epoch: 4 | loss: 0.4057077
	speed: 0.0322s/iter; left time: 247.2906s
	iters: 400, epoch: 4 | loss: 0.4843838
	speed: 0.0301s/iter; left time: 227.8786s
	iters: 500, epoch: 4 | loss: 0.4877641
	speed: 0.0285s/iter; left time: 212.9046s
	iters: 600, epoch: 4 | loss: 0.8505299
	speed: 0.0274s/iter; left time: 202.5306s
	iters: 700, epoch: 4 | loss: 0.4009688
	speed: 0.0268s/iter; left time: 195.1436s
	iters: 800, epoch: 4 | loss: 0.4544740
	speed: 0.0263s/iter; left time: 188.6878s
	iters: 900, epoch: 4 | loss: 0.3906617
	speed: 0.0258s/iter; left time: 182.7239s
	iters: 1000, epoch: 4 | loss: 0.5468059
	speed: 0.0254s/iter; left time: 177.4522s
	iters: 1100, epoch: 4 | loss: 0.6350226
	speed: 0.0250s/iter; left time: 172.3503s
Epoch: 4 cost time: 28.455641269683838
Epoch: 4, Steps: 1140 | Train Loss: 0.5523226 Vali Loss: 0.5830629 Test Loss: 0.2775135
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5262266
	speed: 0.0233s/iter; left time: 157.2222s
	iters: 200, epoch: 5 | loss: 0.5168567
	speed: 0.0222s/iter; left time: 147.4844s
	iters: 300, epoch: 5 | loss: 0.5329120
	speed: 0.0213s/iter; left time: 139.5996s
	iters: 400, epoch: 5 | loss: 0.4988236
	speed: 0.0209s/iter; left time: 134.6265s
	iters: 500, epoch: 5 | loss: 0.6275663
	speed: 0.0212s/iter; left time: 134.7363s
	iters: 600, epoch: 5 | loss: 0.4902657
	speed: 0.0221s/iter; left time: 138.1470s
	iters: 700, epoch: 5 | loss: 1.0629783
	speed: 0.0219s/iter; left time: 134.4685s
	iters: 800, epoch: 5 | loss: 0.7229912
	speed: 0.0218s/iter; left time: 131.4594s
	iters: 900, epoch: 5 | loss: 0.5286126
	speed: 0.0216s/iter; left time: 128.1909s
	iters: 1000, epoch: 5 | loss: 0.7102167
	speed: 0.0215s/iter; left time: 125.6274s
	iters: 1100, epoch: 5 | loss: 0.4221338
	speed: 0.0218s/iter; left time: 124.9093s
Epoch: 5 cost time: 24.943748235702515
Epoch: 5, Steps: 1140 | Train Loss: 0.5457727 Vali Loss: 0.5802316 Test Loss: 0.2768348
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3662908
	speed: 0.0428s/iter; left time: 239.9558s
	iters: 200, epoch: 6 | loss: 0.5253080
	speed: 0.0391s/iter; left time: 214.8802s
	iters: 300, epoch: 6 | loss: 0.4335716
	speed: 0.0363s/iter; left time: 196.1760s
	iters: 400, epoch: 6 | loss: 0.7803087
	speed: 0.0353s/iter; left time: 186.9060s
	iters: 500, epoch: 6 | loss: 0.4845798
	speed: 0.0331s/iter; left time: 171.9520s
	iters: 600, epoch: 6 | loss: 0.4316235
	speed: 0.0312s/iter; left time: 159.3327s
	iters: 700, epoch: 6 | loss: 0.4738557
	speed: 0.0309s/iter; left time: 154.5592s
	iters: 800, epoch: 6 | loss: 0.4159608
	speed: 0.0310s/iter; left time: 152.0163s
	iters: 900, epoch: 6 | loss: 0.6831775
	speed: 0.0302s/iter; left time: 145.0600s
	iters: 1000, epoch: 6 | loss: 0.4516039
	speed: 0.0300s/iter; left time: 141.2435s
	iters: 1100, epoch: 6 | loss: 0.3776593
	speed: 0.0305s/iter; left time: 140.2037s
Epoch: 6 cost time: 34.87787365913391
Epoch: 6, Steps: 1140 | Train Loss: 0.5421016 Vali Loss: 0.5818210 Test Loss: 0.2770489
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.6862257
	speed: 0.0242s/iter; left time: 107.9821s
	iters: 200, epoch: 7 | loss: 0.4461313
	speed: 0.0235s/iter; left time: 102.4182s
	iters: 300, epoch: 7 | loss: 0.3772517
	speed: 0.0231s/iter; left time: 98.5252s
	iters: 400, epoch: 7 | loss: 0.7263491
	speed: 0.0230s/iter; left time: 95.7706s
	iters: 500, epoch: 7 | loss: 0.5084992
	speed: 0.0226s/iter; left time: 91.8333s
	iters: 600, epoch: 7 | loss: 0.6996568
	speed: 0.0225s/iter; left time: 89.0360s
	iters: 700, epoch: 7 | loss: 0.5796844
	speed: 0.0224s/iter; left time: 86.3818s
	iters: 800, epoch: 7 | loss: 0.4580365
	speed: 0.0225s/iter; left time: 84.5845s
	iters: 900, epoch: 7 | loss: 0.4103329
	speed: 0.0228s/iter; left time: 83.5741s
	iters: 1000, epoch: 7 | loss: 0.5594675
	speed: 0.0231s/iter; left time: 82.0831s
	iters: 1100, epoch: 7 | loss: 0.4971781
	speed: 0.0232s/iter; left time: 80.3087s
Epoch: 7 cost time: 26.543376207351685
Epoch: 7, Steps: 1140 | Train Loss: 0.5401904 Vali Loss: 0.5811523 Test Loss: 0.2770195
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.7806752
	speed: 0.0300s/iter; left time: 99.4981s
	iters: 200, epoch: 8 | loss: 0.5682885
	speed: 0.0234s/iter; left time: 75.2483s
	iters: 300, epoch: 8 | loss: 0.7965771
	speed: 0.0241s/iter; left time: 75.2522s
	iters: 400, epoch: 8 | loss: 0.4703385
	speed: 0.0240s/iter; left time: 72.4127s
	iters: 500, epoch: 8 | loss: 0.4950211
	speed: 0.0242s/iter; left time: 70.7742s
	iters: 600, epoch: 8 | loss: 0.4937546
	speed: 0.0239s/iter; left time: 67.5571s
	iters: 700, epoch: 8 | loss: 0.5059774
	speed: 0.0237s/iter; left time: 64.4735s
	iters: 800, epoch: 8 | loss: 0.4122712
	speed: 0.0235s/iter; left time: 61.5358s
	iters: 900, epoch: 8 | loss: 0.4265574
	speed: 0.0235s/iter; left time: 59.3083s
	iters: 1000, epoch: 8 | loss: 0.4112965
	speed: 0.0236s/iter; left time: 57.0572s
	iters: 1100, epoch: 8 | loss: 0.4285130
	speed: 0.0235s/iter; left time: 54.4398s
Epoch: 8 cost time: 26.76484251022339
Epoch: 8, Steps: 1140 | Train Loss: 0.5394193 Vali Loss: 0.5809136 Test Loss: 0.2769214
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.27747008204460144, mae:0.2994985282421112
Use GPU: cuda:0
no_skip False
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.8811845
	speed: 0.0300s/iter; left time: 339.1756s
	iters: 200, epoch: 1 | loss: 0.6444407
	speed: 0.0260s/iter; left time: 290.8210s
	iters: 300, epoch: 1 | loss: 0.6197395
	speed: 0.0247s/iter; left time: 274.7360s
	iters: 400, epoch: 1 | loss: 0.6713581
	speed: 0.0241s/iter; left time: 265.6664s
	iters: 500, epoch: 1 | loss: 0.4593572
	speed: 0.0234s/iter; left time: 254.5553s
	iters: 600, epoch: 1 | loss: 0.6002740
	speed: 0.0231s/iter; left time: 249.2619s
	iters: 700, epoch: 1 | loss: 0.5605194
	speed: 0.0231s/iter; left time: 246.8711s
	iters: 800, epoch: 1 | loss: 0.7537810
	speed: 0.0228s/iter; left time: 242.1905s
	iters: 900, epoch: 1 | loss: 0.4895561
	speed: 0.0226s/iter; left time: 236.9737s
	iters: 1000, epoch: 1 | loss: 1.0902001
	speed: 0.0230s/iter; left time: 239.5507s
	iters: 1100, epoch: 1 | loss: 0.5070176
	speed: 0.0234s/iter; left time: 240.7293s
Epoch: 1 cost time: 27.306854963302612
Epoch: 1, Steps: 1140 | Train Loss: 0.6295324 Vali Loss: 0.6024842 Test Loss: 0.2838772
Validation loss decreased (inf --> 0.602484).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4538939
	speed: 0.0380s/iter; left time: 385.9260s
	iters: 200, epoch: 2 | loss: 0.8144680
	speed: 0.0361s/iter; left time: 363.0908s
	iters: 300, epoch: 2 | loss: 0.8274422
	speed: 0.0324s/iter; left time: 322.4196s
	iters: 400, epoch: 2 | loss: 1.3980515
	speed: 0.0296s/iter; left time: 291.7206s
	iters: 500, epoch: 2 | loss: 0.5014975
	speed: 0.0281s/iter; left time: 274.7246s
	iters: 600, epoch: 2 | loss: 0.5714164
	speed: 0.0272s/iter; left time: 262.9879s
	iters: 700, epoch: 2 | loss: 0.6495977
	speed: 0.0263s/iter; left time: 251.2349s
	iters: 800, epoch: 2 | loss: 0.7146079
	speed: 0.0257s/iter; left time: 243.2698s
	iters: 900, epoch: 2 | loss: 0.5119134
	speed: 0.0265s/iter; left time: 248.2408s
	iters: 1000, epoch: 2 | loss: 0.4036452
	speed: 0.0259s/iter; left time: 239.5276s
	iters: 1100, epoch: 2 | loss: 0.4794764
	speed: 0.0252s/iter; left time: 230.5063s
Epoch: 2 cost time: 28.89721393585205
Epoch: 2, Steps: 1140 | Train Loss: 0.5802856 Vali Loss: 0.5993319 Test Loss: 0.2854739
Validation loss decreased (0.602484 --> 0.599332).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4568362
	speed: 0.0283s/iter; left time: 255.0446s
	iters: 200, epoch: 3 | loss: 0.8044055
	speed: 0.0251s/iter; left time: 224.1305s
	iters: 300, epoch: 3 | loss: 0.5813479
	speed: 0.0242s/iter; left time: 213.8540s
	iters: 400, epoch: 3 | loss: 0.5396782
	speed: 0.0238s/iter; left time: 207.7057s
	iters: 500, epoch: 3 | loss: 0.4510403
	speed: 0.0232s/iter; left time: 199.9267s
	iters: 600, epoch: 3 | loss: 0.4422068
	speed: 0.0226s/iter; left time: 192.7894s
	iters: 700, epoch: 3 | loss: 0.4926707
	speed: 0.0223s/iter; left time: 187.7209s
	iters: 800, epoch: 3 | loss: 0.5194026
	speed: 0.0222s/iter; left time: 184.9151s
	iters: 900, epoch: 3 | loss: 0.4266288
	speed: 0.0225s/iter; left time: 185.0584s
	iters: 1000, epoch: 3 | loss: 0.4009300
	speed: 0.0232s/iter; left time: 188.4253s
	iters: 1100, epoch: 3 | loss: 0.4537275
	speed: 0.0232s/iter; left time: 185.9957s
Epoch: 3 cost time: 26.51669931411743
Epoch: 3, Steps: 1140 | Train Loss: 0.5626334 Vali Loss: 0.5765036 Test Loss: 0.2801466
Validation loss decreased (0.599332 --> 0.576504).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4290475
	speed: 0.0460s/iter; left time: 362.8592s
	iters: 200, epoch: 4 | loss: 0.4598878
	speed: 0.0433s/iter; left time: 336.9421s
	iters: 300, epoch: 4 | loss: 0.4115250
	speed: 0.0429s/iter; left time: 329.3563s
	iters: 400, epoch: 4 | loss: 0.5259783
	speed: 0.0400s/iter; left time: 303.5636s
	iters: 500, epoch: 4 | loss: 0.4906701
	speed: 0.0360s/iter; left time: 269.4628s
	iters: 600, epoch: 4 | loss: 0.4055485
	speed: 0.0334s/iter; left time: 246.3865s
	iters: 700, epoch: 4 | loss: 0.4959392
	speed: 0.0315s/iter; left time: 229.5473s
	iters: 800, epoch: 4 | loss: 0.5585194
	speed: 0.0300s/iter; left time: 215.1300s
	iters: 900, epoch: 4 | loss: 0.5242184
	speed: 0.0301s/iter; left time: 213.2469s
	iters: 1000, epoch: 4 | loss: 0.4682657
	speed: 0.0294s/iter; left time: 205.4869s
	iters: 1100, epoch: 4 | loss: 0.9666173
	speed: 0.0289s/iter; left time: 198.6240s
Epoch: 4 cost time: 32.855968952178955
Epoch: 4, Steps: 1140 | Train Loss: 0.5508284 Vali Loss: 0.5747656 Test Loss: 0.2793690
Validation loss decreased (0.576504 --> 0.574766).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6541806
	speed: 0.0428s/iter; left time: 288.4169s
	iters: 200, epoch: 5 | loss: 0.4655912
	speed: 0.0371s/iter; left time: 246.3995s
	iters: 300, epoch: 5 | loss: 0.4164156
	speed: 0.0325s/iter; left time: 212.8660s
	iters: 400, epoch: 5 | loss: 0.5095970
	speed: 0.0302s/iter; left time: 194.3876s
	iters: 500, epoch: 5 | loss: 0.4282574
	speed: 0.0296s/iter; left time: 187.4058s
	iters: 600, epoch: 5 | loss: 0.4590138
	speed: 0.0291s/iter; left time: 181.8340s
	iters: 700, epoch: 5 | loss: 0.7913432
	speed: 0.0275s/iter; left time: 168.8071s
	iters: 800, epoch: 5 | loss: 0.5112768
	speed: 0.0261s/iter; left time: 157.5097s
	iters: 900, epoch: 5 | loss: 0.5036671
	speed: 0.0250s/iter; left time: 148.4523s
	iters: 1000, epoch: 5 | loss: 0.4754612
	speed: 0.0241s/iter; left time: 140.5687s
	iters: 1100, epoch: 5 | loss: 0.6949799
	speed: 0.0235s/iter; left time: 135.1084s
Epoch: 5 cost time: 26.8115234375
Epoch: 5, Steps: 1140 | Train Loss: 0.5445729 Vali Loss: 0.5748219 Test Loss: 0.2789150
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.7206914
	speed: 0.0307s/iter; left time: 171.6871s
	iters: 200, epoch: 6 | loss: 0.4673567
	speed: 0.0267s/iter; left time: 146.7695s
	iters: 300, epoch: 6 | loss: 0.4710961
	speed: 0.0246s/iter; left time: 132.7457s
	iters: 400, epoch: 6 | loss: 0.4730116
	speed: 0.0238s/iter; left time: 126.1815s
	iters: 500, epoch: 6 | loss: 0.4172006
	speed: 0.0235s/iter; left time: 122.2088s
	iters: 600, epoch: 6 | loss: 0.4710193
	speed: 0.0231s/iter; left time: 117.6753s
	iters: 700, epoch: 6 | loss: 0.6660774
	speed: 0.0225s/iter; left time: 112.5725s
	iters: 800, epoch: 6 | loss: 0.5179608
	speed: 0.0222s/iter; left time: 108.8595s
	iters: 900, epoch: 6 | loss: 0.6602833
	speed: 0.0220s/iter; left time: 105.6943s
	iters: 1000, epoch: 6 | loss: 0.4429631
	speed: 0.0218s/iter; left time: 102.6331s
	iters: 1100, epoch: 6 | loss: 0.4894374
	speed: 0.0225s/iter; left time: 103.5097s
Epoch: 6 cost time: 26.410152435302734
Epoch: 6, Steps: 1140 | Train Loss: 0.5410021 Vali Loss: 0.5772333 Test Loss: 0.2789571
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5729393
	speed: 0.0265s/iter; left time: 118.3690s
	iters: 200, epoch: 7 | loss: 0.4433546
	speed: 0.0283s/iter; left time: 123.3566s
	iters: 300, epoch: 7 | loss: 0.5168760
	speed: 0.0265s/iter; left time: 113.0231s
	iters: 400, epoch: 7 | loss: 0.4482208
	speed: 0.0259s/iter; left time: 107.8440s
	iters: 500, epoch: 7 | loss: 0.7497178
	speed: 0.0272s/iter; left time: 110.3115s
	iters: 600, epoch: 7 | loss: 0.5413305
	speed: 0.0276s/iter; left time: 109.2968s
	iters: 700, epoch: 7 | loss: 0.4768959
	speed: 0.0267s/iter; left time: 103.1418s
	iters: 800, epoch: 7 | loss: 0.4863766
	speed: 0.0259s/iter; left time: 97.3438s
	iters: 900, epoch: 7 | loss: 0.8696947
	speed: 0.0253s/iter; left time: 92.6083s
	iters: 1000, epoch: 7 | loss: 0.4727617
	speed: 0.0249s/iter; left time: 88.8272s
	iters: 1100, epoch: 7 | loss: 0.6931919
	speed: 0.0246s/iter; left time: 85.2365s
Epoch: 7 cost time: 28.20044469833374
Epoch: 7, Steps: 1140 | Train Loss: 0.5392904 Vali Loss: 0.5755497 Test Loss: 0.2791700
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.8011566
	speed: 0.0300s/iter; left time: 99.5747s
	iters: 200, epoch: 8 | loss: 0.4641745
	speed: 0.0264s/iter; left time: 85.0250s
	iters: 300, epoch: 8 | loss: 0.7395095
	speed: 0.0252s/iter; left time: 78.5584s
	iters: 400, epoch: 8 | loss: 0.4827826
	speed: 0.0245s/iter; left time: 74.1412s
	iters: 500, epoch: 8 | loss: 0.4721408
	speed: 0.0242s/iter; left time: 70.5521s
	iters: 600, epoch: 8 | loss: 0.4205483
	speed: 0.0250s/iter; left time: 70.4314s
	iters: 700, epoch: 8 | loss: 0.4305570
	speed: 0.0244s/iter; left time: 66.3729s
	iters: 800, epoch: 8 | loss: 0.5375873
	speed: 0.0237s/iter; left time: 62.2354s
	iters: 900, epoch: 8 | loss: 0.4564197
	speed: 0.0241s/iter; left time: 60.8446s
	iters: 1000, epoch: 8 | loss: 0.4735094
	speed: 0.0247s/iter; left time: 59.8333s
	iters: 1100, epoch: 8 | loss: 0.7921115
	speed: 0.0242s/iter; left time: 56.2422s
Epoch: 8 cost time: 27.508378267288208
Epoch: 8, Steps: 1140 | Train Loss: 0.5381173 Vali Loss: 0.5759143 Test Loss: 0.2790495
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4328229
	speed: 0.0204s/iter; left time: 44.4647s
	iters: 200, epoch: 9 | loss: 0.4785583
	speed: 0.0195s/iter; left time: 40.6462s
	iters: 300, epoch: 9 | loss: 0.5454985
	speed: 0.0205s/iter; left time: 40.6658s
	iters: 400, epoch: 9 | loss: 0.4197848
	speed: 0.0209s/iter; left time: 39.2544s
	iters: 500, epoch: 9 | loss: 0.6737999
	speed: 0.0210s/iter; left time: 37.3930s
	iters: 600, epoch: 9 | loss: 0.4354461
	speed: 0.0213s/iter; left time: 35.7871s
	iters: 700, epoch: 9 | loss: 0.7689332
	speed: 0.0215s/iter; left time: 33.9446s
	iters: 800, epoch: 9 | loss: 0.4113084
	speed: 0.0216s/iter; left time: 32.0413s
	iters: 900, epoch: 9 | loss: 0.4768252
	speed: 0.0219s/iter; left time: 30.2723s
	iters: 1000, epoch: 9 | loss: 0.4662918
	speed: 0.0221s/iter; left time: 28.3382s
	iters: 1100, epoch: 9 | loss: 0.4737838
	speed: 0.0223s/iter; left time: 26.3376s
Epoch: 9 cost time: 25.63051986694336
Epoch: 9, Steps: 1140 | Train Loss: 0.5374587 Vali Loss: 0.5770132 Test Loss: 0.2791292
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.27936887741088867, mae:0.29970940947532654
Use GPU: cuda:0
no_skip False
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.5696509
	speed: 0.0273s/iter; left time: 308.0246s
	iters: 200, epoch: 1 | loss: 0.6095586
	speed: 0.0245s/iter; left time: 274.4691s
	iters: 300, epoch: 1 | loss: 0.4995236
	speed: 0.0241s/iter; left time: 267.1100s
	iters: 400, epoch: 1 | loss: 0.5959317
	speed: 0.0242s/iter; left time: 266.3815s
	iters: 500, epoch: 1 | loss: 1.0609465
	speed: 0.0233s/iter; left time: 253.7053s
	iters: 600, epoch: 1 | loss: 0.5214245
	speed: 0.0231s/iter; left time: 248.9674s
	iters: 700, epoch: 1 | loss: 0.8382903
	speed: 0.0229s/iter; left time: 245.5867s
	iters: 800, epoch: 1 | loss: 0.7738162
	speed: 0.0229s/iter; left time: 242.3578s
	iters: 900, epoch: 1 | loss: 0.5125164
	speed: 0.0231s/iter; left time: 242.5036s
	iters: 1000, epoch: 1 | loss: 0.4418003
	speed: 0.0233s/iter; left time: 242.3256s
	iters: 1100, epoch: 1 | loss: 0.4728212
	speed: 0.0243s/iter; left time: 250.7892s
Epoch: 1 cost time: 28.32761287689209
Epoch: 1, Steps: 1140 | Train Loss: 0.6233415 Vali Loss: 0.5978287 Test Loss: 0.2857896
Validation loss decreased (inf --> 0.597829).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7935559
	speed: 0.0299s/iter; left time: 303.7317s
	iters: 200, epoch: 2 | loss: 0.4733153
	speed: 0.0247s/iter; left time: 248.2655s
	iters: 300, epoch: 2 | loss: 0.4600164
	speed: 0.0231s/iter; left time: 230.1038s
	iters: 400, epoch: 2 | loss: 0.5512577
	speed: 0.0227s/iter; left time: 223.6366s
	iters: 500, epoch: 2 | loss: 0.5055146
	speed: 0.0224s/iter; left time: 219.1185s
	iters: 600, epoch: 2 | loss: 0.4236161
	speed: 0.0224s/iter; left time: 216.6721s
	iters: 700, epoch: 2 | loss: 0.7811429
	speed: 0.0225s/iter; left time: 215.2375s
	iters: 800, epoch: 2 | loss: 1.1534913
	speed: 0.0226s/iter; left time: 213.5961s
	iters: 900, epoch: 2 | loss: 0.4443490
	speed: 0.0227s/iter; left time: 212.3414s
	iters: 1000, epoch: 2 | loss: 0.7624760
	speed: 0.0223s/iter; left time: 206.4697s
	iters: 1100, epoch: 2 | loss: 0.4511534
	speed: 0.0221s/iter; left time: 202.2553s
Epoch: 2 cost time: 25.21336078643799
Epoch: 2, Steps: 1140 | Train Loss: 0.5826070 Vali Loss: 0.5867199 Test Loss: 0.2794773
Validation loss decreased (0.597829 --> 0.586720).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4078016
	speed: 0.0279s/iter; left time: 251.5904s
	iters: 200, epoch: 3 | loss: 0.4941582
	speed: 0.0240s/iter; left time: 214.1922s
	iters: 300, epoch: 3 | loss: 0.8609585
	speed: 0.0240s/iter; left time: 212.0874s
	iters: 400, epoch: 3 | loss: 0.7153674
	speed: 0.0241s/iter; left time: 210.0901s
	iters: 500, epoch: 3 | loss: 0.4258974
	speed: 0.0238s/iter; left time: 205.0648s
	iters: 600, epoch: 3 | loss: 0.4904648
	speed: 0.0238s/iter; left time: 202.8929s
	iters: 700, epoch: 3 | loss: 0.5328801
	speed: 0.0237s/iter; left time: 199.2703s
	iters: 800, epoch: 3 | loss: 0.6870655
	speed: 0.0236s/iter; left time: 196.3817s
	iters: 900, epoch: 3 | loss: 0.4000292
	speed: 0.0235s/iter; left time: 193.5208s
	iters: 1000, epoch: 3 | loss: 0.4348479
	speed: 0.0235s/iter; left time: 191.0718s
	iters: 1100, epoch: 3 | loss: 0.4724441
	speed: 0.0236s/iter; left time: 189.0286s
Epoch: 3 cost time: 27.029746770858765
Epoch: 3, Steps: 1140 | Train Loss: 0.5632510 Vali Loss: 0.5808126 Test Loss: 0.2777086
Validation loss decreased (0.586720 --> 0.580813).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6825687
	speed: 0.0313s/iter; left time: 246.4005s
	iters: 200, epoch: 4 | loss: 0.4050903
	speed: 0.0253s/iter; left time: 197.0825s
	iters: 300, epoch: 4 | loss: 0.4969604
	speed: 0.0233s/iter; left time: 178.9108s
	iters: 400, epoch: 4 | loss: 0.4251516
	speed: 0.0224s/iter; left time: 169.7343s
	iters: 500, epoch: 4 | loss: 0.7151743
	speed: 0.0228s/iter; left time: 170.2807s
	iters: 600, epoch: 4 | loss: 0.5208467
	speed: 0.0230s/iter; left time: 169.9575s
	iters: 700, epoch: 4 | loss: 0.5599797
	speed: 0.0233s/iter; left time: 169.3182s
	iters: 800, epoch: 4 | loss: 0.7959350
	speed: 0.0244s/iter; left time: 175.1014s
	iters: 900, epoch: 4 | loss: 0.4833625
	speed: 0.0255s/iter; left time: 180.7884s
	iters: 1000, epoch: 4 | loss: 0.4520619
	speed: 0.0260s/iter; left time: 181.8283s
	iters: 1100, epoch: 4 | loss: 1.1037199
	speed: 0.0269s/iter; left time: 184.7704s
Epoch: 4 cost time: 30.925412893295288
Epoch: 4, Steps: 1140 | Train Loss: 0.5526509 Vali Loss: 0.5845473 Test Loss: 0.2786252
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4026068
	speed: 0.0239s/iter; left time: 161.3167s
	iters: 200, epoch: 5 | loss: 0.6643959
	speed: 0.0219s/iter; left time: 145.4267s
	iters: 300, epoch: 5 | loss: 0.4637275
	speed: 0.0222s/iter; left time: 144.9400s
	iters: 400, epoch: 5 | loss: 0.4005918
	speed: 0.0222s/iter; left time: 142.7496s
	iters: 500, epoch: 5 | loss: 0.4138461
	speed: 0.0224s/iter; left time: 141.8577s
	iters: 600, epoch: 5 | loss: 0.4236510
	speed: 0.0227s/iter; left time: 141.9661s
	iters: 700, epoch: 5 | loss: 0.4207560
	speed: 0.0231s/iter; left time: 141.8562s
	iters: 800, epoch: 5 | loss: 0.4900093
	speed: 0.0230s/iter; left time: 138.8658s
	iters: 900, epoch: 5 | loss: 0.6969092
	speed: 0.0235s/iter; left time: 139.7798s
	iters: 1000, epoch: 5 | loss: 0.4404368
	speed: 0.0245s/iter; left time: 143.3675s
	iters: 1100, epoch: 5 | loss: 0.5656683
	speed: 0.0250s/iter; left time: 143.6375s
Epoch: 5 cost time: 28.891898155212402
Epoch: 5, Steps: 1140 | Train Loss: 0.5462858 Vali Loss: 0.5880207 Test Loss: 0.2782567
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4713035
	speed: 0.0211s/iter; left time: 118.1314s
	iters: 200, epoch: 6 | loss: 0.6274580
	speed: 0.0211s/iter; left time: 116.1868s
	iters: 300, epoch: 6 | loss: 0.3903073
	speed: 0.0213s/iter; left time: 115.1574s
	iters: 400, epoch: 6 | loss: 0.3920688
	speed: 0.0249s/iter; left time: 131.8430s
	iters: 500, epoch: 6 | loss: 0.6149385
	speed: 0.0271s/iter; left time: 140.8424s
	iters: 600, epoch: 6 | loss: 0.6115376
	speed: 0.0263s/iter; left time: 134.0368s
	iters: 700, epoch: 6 | loss: 0.4119984
	speed: 0.0257s/iter; left time: 128.7719s
	iters: 800, epoch: 6 | loss: 0.6896650
	speed: 0.0268s/iter; left time: 131.4136s
	iters: 900, epoch: 6 | loss: 0.4373161
	speed: 0.0277s/iter; left time: 133.1596s
	iters: 1000, epoch: 6 | loss: 0.5176919
	speed: 0.0274s/iter; left time: 128.8677s
	iters: 1100, epoch: 6 | loss: 0.4901797
	speed: 0.0270s/iter; left time: 124.0917s
Epoch: 6 cost time: 30.701383590698242
Epoch: 6, Steps: 1140 | Train Loss: 0.5430825 Vali Loss: 0.5837227 Test Loss: 0.2783316
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8950705
	speed: 0.0193s/iter; left time: 86.1490s
	iters: 200, epoch: 7 | loss: 0.7222529
	speed: 0.0191s/iter; left time: 83.0915s
	iters: 300, epoch: 7 | loss: 0.5357467
	speed: 0.0188s/iter; left time: 80.0843s
	iters: 400, epoch: 7 | loss: 0.4519949
	speed: 0.0199s/iter; left time: 82.7810s
	iters: 500, epoch: 7 | loss: 0.3872892
	speed: 0.0207s/iter; left time: 84.0997s
	iters: 600, epoch: 7 | loss: 0.6001522
	speed: 0.0212s/iter; left time: 84.1539s
	iters: 700, epoch: 7 | loss: 0.7406220
	speed: 0.0216s/iter; left time: 83.5693s
	iters: 800, epoch: 7 | loss: 0.5450853
	speed: 0.0220s/iter; left time: 82.6109s
	iters: 900, epoch: 7 | loss: 0.4039433
	speed: 0.0222s/iter; left time: 81.2490s
	iters: 1000, epoch: 7 | loss: 0.4480278
	speed: 0.0224s/iter; left time: 79.6705s
	iters: 1100, epoch: 7 | loss: 0.4972130
	speed: 0.0225s/iter; left time: 77.9502s
Epoch: 7 cost time: 25.85944128036499
Epoch: 7, Steps: 1140 | Train Loss: 0.5412414 Vali Loss: 0.5826448 Test Loss: 0.2780651
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.7899919
	speed: 0.0230s/iter; left time: 76.4917s
	iters: 200, epoch: 8 | loss: 0.4687897
	speed: 0.0215s/iter; left time: 69.3267s
	iters: 300, epoch: 8 | loss: 0.3476275
	speed: 0.0206s/iter; left time: 64.1681s
	iters: 400, epoch: 8 | loss: 0.4183755
	speed: 0.0205s/iter; left time: 61.9461s
	iters: 500, epoch: 8 | loss: 0.3939134
	speed: 0.0212s/iter; left time: 61.9301s
	iters: 600, epoch: 8 | loss: 0.7737688
	speed: 0.0230s/iter; left time: 64.7682s
	iters: 700, epoch: 8 | loss: 0.5347598
	speed: 0.0249s/iter; left time: 67.8456s
	iters: 800, epoch: 8 | loss: 0.4888473
	speed: 0.0249s/iter; left time: 65.2150s
	iters: 900, epoch: 8 | loss: 0.7090777
	speed: 0.0243s/iter; left time: 61.1953s
	iters: 1000, epoch: 8 | loss: 0.5342502
	speed: 0.0237s/iter; left time: 57.4211s
	iters: 1100, epoch: 8 | loss: 0.5068656
	speed: 0.0234s/iter; left time: 54.2204s
Epoch: 8 cost time: 26.619014024734497
Epoch: 8, Steps: 1140 | Train Loss: 0.5403075 Vali Loss: 0.5816846 Test Loss: 0.2777899
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.27770864963531494, mae:0.29884058237075806
Seed: 123
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_720      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip False
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.8025293
	speed: 0.0356s/iter; left time: 397.5624s
	iters: 200, epoch: 1 | loss: 0.9042673
	speed: 0.0292s/iter; left time: 323.3728s
	iters: 300, epoch: 1 | loss: 0.5915207
	speed: 0.0267s/iter; left time: 293.4374s
	iters: 400, epoch: 1 | loss: 0.7234189
	speed: 0.0269s/iter; left time: 292.6516s
	iters: 500, epoch: 1 | loss: 0.6033375
	speed: 0.0286s/iter; left time: 308.3050s
	iters: 600, epoch: 1 | loss: 0.6309053
	speed: 0.0288s/iter; left time: 307.3139s
	iters: 700, epoch: 1 | loss: 0.7156528
	speed: 0.0277s/iter; left time: 293.2334s
	iters: 800, epoch: 1 | loss: 0.5902486
	speed: 0.0271s/iter; left time: 283.6222s
	iters: 900, epoch: 1 | loss: 0.8641089
	speed: 0.0265s/iter; left time: 275.4209s
	iters: 1000, epoch: 1 | loss: 0.5958701
	speed: 0.0261s/iter; left time: 268.4460s
	iters: 1100, epoch: 1 | loss: 0.8706530
	speed: 0.0259s/iter; left time: 264.0983s
Epoch: 1 cost time: 29.527528047561646
Epoch: 1, Steps: 1128 | Train Loss: 0.7093017 Vali Loss: 0.7231342 Test Loss: 0.3569307
Validation loss decreased (inf --> 0.723134).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6698803
	speed: 0.0297s/iter; left time: 298.1067s
	iters: 200, epoch: 2 | loss: 0.6854690
	speed: 0.0262s/iter; left time: 261.0117s
	iters: 300, epoch: 2 | loss: 0.6640081
	speed: 0.0249s/iter; left time: 245.4356s
	iters: 400, epoch: 2 | loss: 0.5552340
	speed: 0.0245s/iter; left time: 238.6718s
	iters: 500, epoch: 2 | loss: 0.5554461
	speed: 0.0241s/iter; left time: 233.0841s
	iters: 600, epoch: 2 | loss: 0.6204095
	speed: 0.0240s/iter; left time: 229.4502s
	iters: 700, epoch: 2 | loss: 0.7151464
	speed: 0.0243s/iter; left time: 229.2841s
	iters: 800, epoch: 2 | loss: 0.6020563
	speed: 0.0240s/iter; left time: 224.2821s
	iters: 900, epoch: 2 | loss: 0.6980082
	speed: 0.0238s/iter; left time: 220.4279s
	iters: 1000, epoch: 2 | loss: 0.7008965
	speed: 0.0237s/iter; left time: 216.8231s
	iters: 1100, epoch: 2 | loss: 0.6845592
	speed: 0.0236s/iter; left time: 213.7971s
Epoch: 2 cost time: 26.74292254447937
Epoch: 2, Steps: 1128 | Train Loss: 0.6639614 Vali Loss: 0.7084349 Test Loss: 0.3543545
Validation loss decreased (0.723134 --> 0.708435).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6786251
	speed: 0.0403s/iter; left time: 359.5184s
	iters: 200, epoch: 3 | loss: 0.9020540
	speed: 0.0304s/iter; left time: 267.8984s
	iters: 300, epoch: 3 | loss: 0.8120233
	speed: 0.0262s/iter; left time: 228.8337s
	iters: 400, epoch: 3 | loss: 0.8014538
	speed: 0.0267s/iter; left time: 230.2666s
	iters: 500, epoch: 3 | loss: 0.5129769
	speed: 0.0262s/iter; left time: 223.3007s
	iters: 600, epoch: 3 | loss: 0.5221505
	speed: 0.0262s/iter; left time: 221.1043s
	iters: 700, epoch: 3 | loss: 0.7617415
	speed: 0.0275s/iter; left time: 228.6090s
	iters: 800, epoch: 3 | loss: 0.5762751
	speed: 0.0280s/iter; left time: 230.4331s
	iters: 900, epoch: 3 | loss: 0.5353160
	speed: 0.0274s/iter; left time: 222.8071s
	iters: 1000, epoch: 3 | loss: 0.4877989
	speed: 0.0269s/iter; left time: 215.9634s
	iters: 1100, epoch: 3 | loss: 0.7358207
	speed: 0.0266s/iter; left time: 210.7795s
Epoch: 3 cost time: 30.066348552703857
Epoch: 3, Steps: 1128 | Train Loss: 0.6478681 Vali Loss: 0.7058944 Test Loss: 0.3532336
Validation loss decreased (0.708435 --> 0.705894).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8960739
	speed: 0.0368s/iter; left time: 287.2624s
	iters: 200, epoch: 4 | loss: 0.5977485
	speed: 0.0297s/iter; left time: 228.7781s
	iters: 300, epoch: 4 | loss: 0.6431718
	speed: 0.0274s/iter; left time: 208.3518s
	iters: 400, epoch: 4 | loss: 0.5644423
	speed: 0.0263s/iter; left time: 196.8457s
	iters: 500, epoch: 4 | loss: 0.8814492
	speed: 0.0266s/iter; left time: 196.5587s
	iters: 600, epoch: 4 | loss: 0.5975500
	speed: 0.0278s/iter; left time: 202.7693s
	iters: 700, epoch: 4 | loss: 0.5989434
	speed: 0.0281s/iter; left time: 202.4028s
	iters: 800, epoch: 4 | loss: 0.4976686
	speed: 0.0277s/iter; left time: 196.4719s
	iters: 900, epoch: 4 | loss: 0.5016242
	speed: 0.0280s/iter; left time: 195.8967s
	iters: 1000, epoch: 4 | loss: 0.7057710
	speed: 0.0281s/iter; left time: 194.1049s
	iters: 1100, epoch: 4 | loss: 0.5731448
	speed: 0.0278s/iter; left time: 189.2674s
Epoch: 4 cost time: 31.630333185195923
Epoch: 4, Steps: 1128 | Train Loss: 0.6381283 Vali Loss: 0.7060550 Test Loss: 0.3539332
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6356735
	speed: 0.0254s/iter; left time: 169.1251s
	iters: 200, epoch: 5 | loss: 0.5593466
	speed: 0.0241s/iter; left time: 158.1912s
	iters: 300, epoch: 5 | loss: 0.7391878
	speed: 0.0238s/iter; left time: 153.6685s
	iters: 400, epoch: 5 | loss: 0.6245888
	speed: 0.0235s/iter; left time: 149.6954s
	iters: 500, epoch: 5 | loss: 0.5531399
	speed: 0.0233s/iter; left time: 146.3396s
	iters: 600, epoch: 5 | loss: 0.5538012
	speed: 0.0233s/iter; left time: 143.4413s
	iters: 700, epoch: 5 | loss: 0.5618054
	speed: 0.0232s/iter; left time: 140.5460s
	iters: 800, epoch: 5 | loss: 0.6047020
	speed: 0.0231s/iter; left time: 137.8867s
	iters: 900, epoch: 5 | loss: 0.7408236
	speed: 0.0230s/iter; left time: 135.0252s
	iters: 1000, epoch: 5 | loss: 0.5889789
	speed: 0.0230s/iter; left time: 132.4258s
	iters: 1100, epoch: 5 | loss: 0.6664214
	speed: 0.0229s/iter; left time: 129.8067s
Epoch: 5 cost time: 25.96400761604309
Epoch: 5, Steps: 1128 | Train Loss: 0.6315913 Vali Loss: 0.7077854 Test Loss: 0.3544988
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5317022
	speed: 0.0280s/iter; left time: 155.2167s
	iters: 200, epoch: 6 | loss: 0.5589899
	speed: 0.0243s/iter; left time: 132.3242s
	iters: 300, epoch: 6 | loss: 0.6409076
	speed: 0.0224s/iter; left time: 119.6827s
	iters: 400, epoch: 6 | loss: 0.6930468
	speed: 0.0221s/iter; left time: 115.6298s
	iters: 500, epoch: 6 | loss: 0.6717654
	speed: 0.0213s/iter; left time: 109.7265s
	iters: 600, epoch: 6 | loss: 0.5284599
	speed: 0.0207s/iter; left time: 104.3823s
	iters: 700, epoch: 6 | loss: 0.5410258
	speed: 0.0206s/iter; left time: 101.8192s
	iters: 800, epoch: 6 | loss: 0.7640836
	speed: 0.0200s/iter; left time: 96.9800s
	iters: 900, epoch: 6 | loss: 0.4862757
	speed: 0.0201s/iter; left time: 95.4222s
	iters: 1000, epoch: 6 | loss: 0.5193070
	speed: 0.0215s/iter; left time: 99.7057s
	iters: 1100, epoch: 6 | loss: 0.8287613
	speed: 0.0220s/iter; left time: 99.7436s
Epoch: 6 cost time: 24.946816205978394
Epoch: 6, Steps: 1128 | Train Loss: 0.6281086 Vali Loss: 0.7092559 Test Loss: 0.3554083
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4995943
	speed: 0.0247s/iter; left time: 108.9373s
	iters: 200, epoch: 7 | loss: 0.7934221
	speed: 0.0233s/iter; left time: 100.6719s
	iters: 300, epoch: 7 | loss: 0.7188252
	speed: 0.0238s/iter; left time: 100.2110s
	iters: 400, epoch: 7 | loss: 0.4695177
	speed: 0.0238s/iter; left time: 97.7074s
	iters: 500, epoch: 7 | loss: 0.7916096
	speed: 0.0236s/iter; left time: 94.7752s
	iters: 600, epoch: 7 | loss: 0.5166966
	speed: 0.0235s/iter; left time: 91.8272s
	iters: 700, epoch: 7 | loss: 0.6920551
	speed: 0.0234s/iter; left time: 89.0347s
	iters: 800, epoch: 7 | loss: 0.7155590
	speed: 0.0233s/iter; left time: 86.4412s
	iters: 900, epoch: 7 | loss: 0.5103188
	speed: 0.0232s/iter; left time: 83.8901s
	iters: 1000, epoch: 7 | loss: 0.7795487
	speed: 0.0233s/iter; left time: 81.9255s
	iters: 1100, epoch: 7 | loss: 0.4829237
	speed: 0.0234s/iter; left time: 79.8747s
Epoch: 7 cost time: 26.87315821647644
Epoch: 7, Steps: 1128 | Train Loss: 0.6261259 Vali Loss: 0.7093549 Test Loss: 0.3551770
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.8746448
	speed: 0.0302s/iter; left time: 99.1174s
	iters: 200, epoch: 8 | loss: 0.6302479
	speed: 0.0264s/iter; left time: 84.1297s
	iters: 300, epoch: 8 | loss: 0.6026204
	speed: 0.0253s/iter; left time: 78.2044s
	iters: 400, epoch: 8 | loss: 0.5783804
	speed: 0.0253s/iter; left time: 75.4123s
	iters: 500, epoch: 8 | loss: 0.5007154
	speed: 0.0251s/iter; left time: 72.5295s
	iters: 600, epoch: 8 | loss: 0.5303422
	speed: 0.0249s/iter; left time: 69.4717s
	iters: 700, epoch: 8 | loss: 0.6929232
	speed: 0.0246s/iter; left time: 66.0127s
	iters: 800, epoch: 8 | loss: 0.8222336
	speed: 0.0243s/iter; left time: 62.8259s
	iters: 900, epoch: 8 | loss: 0.5793767
	speed: 0.0241s/iter; left time: 59.8797s
	iters: 1000, epoch: 8 | loss: 0.5479161
	speed: 0.0239s/iter; left time: 57.0986s
	iters: 1100, epoch: 8 | loss: 0.5283532
	speed: 0.0238s/iter; left time: 54.4476s
Epoch: 8 cost time: 27.00567054748535
Epoch: 8, Steps: 1128 | Train Loss: 0.6253418 Vali Loss: 0.7109722 Test Loss: 0.3556803
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.3532337546348572, mae:0.3489253520965576
Use GPU: cuda:0
no_skip False
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.9127768
	speed: 0.0284s/iter; left time: 317.9281s
	iters: 200, epoch: 1 | loss: 0.7292482
	speed: 0.0273s/iter; left time: 302.5430s
	iters: 300, epoch: 1 | loss: 0.5891038
	speed: 0.0256s/iter; left time: 281.0767s
	iters: 400, epoch: 1 | loss: 0.6073153
	speed: 0.0246s/iter; left time: 268.0098s
	iters: 500, epoch: 1 | loss: 0.7746989
	speed: 0.0247s/iter; left time: 266.0688s
	iters: 600, epoch: 1 | loss: 0.5956448
	speed: 0.0252s/iter; left time: 269.6422s
	iters: 700, epoch: 1 | loss: 1.0527568
	speed: 0.0249s/iter; left time: 263.1394s
	iters: 800, epoch: 1 | loss: 0.6872248
	speed: 0.0246s/iter; left time: 257.6623s
	iters: 900, epoch: 1 | loss: 0.8760234
	speed: 0.0246s/iter; left time: 255.8257s
	iters: 1000, epoch: 1 | loss: 0.7189143
	speed: 0.0247s/iter; left time: 253.5506s
	iters: 1100, epoch: 1 | loss: 0.5500695
	speed: 0.0246s/iter; left time: 250.5561s
Epoch: 1 cost time: 27.850862979888916
Epoch: 1, Steps: 1128 | Train Loss: 0.7015628 Vali Loss: 0.7180515 Test Loss: 0.3549238
Validation loss decreased (inf --> 0.718051).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7643303
	speed: 0.0440s/iter; left time: 442.7153s
	iters: 200, epoch: 2 | loss: 0.7387306
	speed: 0.0387s/iter; left time: 385.0542s
	iters: 300, epoch: 2 | loss: 0.5758195
	speed: 0.0329s/iter; left time: 323.9438s
	iters: 400, epoch: 2 | loss: 0.5996805
	speed: 0.0308s/iter; left time: 300.5116s
	iters: 500, epoch: 2 | loss: 0.6211626
	speed: 0.0317s/iter; left time: 306.0089s
	iters: 600, epoch: 2 | loss: 0.5343218
	speed: 0.0315s/iter; left time: 301.0021s
	iters: 700, epoch: 2 | loss: 0.5680730
	speed: 0.0305s/iter; left time: 288.0609s
	iters: 800, epoch: 2 | loss: 0.5977517
	speed: 0.0297s/iter; left time: 277.5818s
	iters: 900, epoch: 2 | loss: 0.7925265
	speed: 0.0291s/iter; left time: 269.1320s
	iters: 1000, epoch: 2 | loss: 0.6681562
	speed: 0.0286s/iter; left time: 261.5117s
	iters: 1100, epoch: 2 | loss: 0.5656893
	speed: 0.0280s/iter; left time: 253.7460s
Epoch: 2 cost time: 31.513697147369385
Epoch: 2, Steps: 1128 | Train Loss: 0.6567555 Vali Loss: 0.7179160 Test Loss: 0.3557722
Validation loss decreased (0.718051 --> 0.717916).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6385235
	speed: 0.0251s/iter; left time: 224.3053s
	iters: 200, epoch: 3 | loss: 0.6739626
	speed: 0.0297s/iter; left time: 262.4110s
	iters: 300, epoch: 3 | loss: 0.5812196
	speed: 0.0286s/iter; left time: 249.3437s
	iters: 400, epoch: 3 | loss: 0.7885998
	speed: 0.0272s/iter; left time: 234.4155s
	iters: 500, epoch: 3 | loss: 0.5412059
	speed: 0.0264s/iter; left time: 224.6641s
	iters: 600, epoch: 3 | loss: 0.4863929
	speed: 0.0258s/iter; left time: 217.0506s
	iters: 700, epoch: 3 | loss: 0.6553509
	speed: 0.0254s/iter; left time: 211.0799s
	iters: 800, epoch: 3 | loss: 0.5126457
	speed: 0.0256s/iter; left time: 210.5939s
	iters: 900, epoch: 3 | loss: 0.5910224
	speed: 0.0265s/iter; left time: 215.0299s
	iters: 1000, epoch: 3 | loss: 0.6877921
	speed: 0.0263s/iter; left time: 211.2191s
	iters: 1100, epoch: 3 | loss: 0.5270640
	speed: 0.0270s/iter; left time: 214.3079s
Epoch: 3 cost time: 30.887964725494385
Epoch: 3, Steps: 1128 | Train Loss: 0.6405539 Vali Loss: 0.7113683 Test Loss: 0.3537947
Validation loss decreased (0.717916 --> 0.711368).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6016427
	speed: 0.0270s/iter; left time: 210.6607s
	iters: 200, epoch: 4 | loss: 0.6854726
	speed: 0.0236s/iter; left time: 181.7637s
	iters: 300, epoch: 4 | loss: 0.5125453
	speed: 0.0242s/iter; left time: 183.8851s
	iters: 400, epoch: 4 | loss: 0.5015031
	speed: 0.0260s/iter; left time: 195.0034s
	iters: 500, epoch: 4 | loss: 0.5301575
	speed: 0.0274s/iter; left time: 202.5849s
	iters: 600, epoch: 4 | loss: 0.6784073
	speed: 0.0276s/iter; left time: 201.3394s
	iters: 700, epoch: 4 | loss: 0.6016399
	speed: 0.0270s/iter; left time: 194.3752s
	iters: 800, epoch: 4 | loss: 0.6085718
	speed: 0.0265s/iter; left time: 188.1724s
	iters: 900, epoch: 4 | loss: 0.6062968
	speed: 0.0260s/iter; left time: 181.9087s
	iters: 1000, epoch: 4 | loss: 0.7427115
	speed: 0.0261s/iter; left time: 180.3403s
	iters: 1100, epoch: 4 | loss: 0.6164401
	speed: 0.0256s/iter; left time: 174.0733s
Epoch: 4 cost time: 28.871652841567993
Epoch: 4, Steps: 1128 | Train Loss: 0.6290815 Vali Loss: 0.7111560 Test Loss: 0.3542747
Validation loss decreased (0.711368 --> 0.711156).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4861777
	speed: 0.0269s/iter; left time: 179.1042s
	iters: 200, epoch: 5 | loss: 0.5267045
	speed: 0.0256s/iter; left time: 168.1559s
	iters: 300, epoch: 5 | loss: 0.7700111
	speed: 0.0253s/iter; left time: 163.4266s
	iters: 400, epoch: 5 | loss: 0.5589653
	speed: 0.0254s/iter; left time: 161.8061s
	iters: 500, epoch: 5 | loss: 0.6168018
	speed: 0.0253s/iter; left time: 158.4907s
	iters: 600, epoch: 5 | loss: 0.4931740
	speed: 0.0252s/iter; left time: 155.5370s
	iters: 700, epoch: 5 | loss: 0.6663848
	speed: 0.0251s/iter; left time: 152.4391s
	iters: 800, epoch: 5 | loss: 0.7424420
	speed: 0.0252s/iter; left time: 150.1968s
	iters: 900, epoch: 5 | loss: 0.5248480
	speed: 0.0248s/iter; left time: 145.7376s
	iters: 1000, epoch: 5 | loss: 0.6610043
	speed: 0.0245s/iter; left time: 141.4920s
	iters: 1100, epoch: 5 | loss: 0.5676343
	speed: 0.0241s/iter; left time: 136.8215s
Epoch: 5 cost time: 27.240413665771484
Epoch: 5, Steps: 1128 | Train Loss: 0.6223051 Vali Loss: 0.7151889 Test Loss: 0.3547914
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6746209
	speed: 0.0358s/iter; left time: 198.1622s
	iters: 200, epoch: 6 | loss: 0.7191060
	speed: 0.0345s/iter; left time: 187.9280s
	iters: 300, epoch: 6 | loss: 0.5618001
	speed: 0.0311s/iter; left time: 166.1698s
	iters: 400, epoch: 6 | loss: 0.8896446
	speed: 0.0294s/iter; left time: 154.0212s
	iters: 500, epoch: 6 | loss: 0.6499963
	speed: 0.0285s/iter; left time: 146.5026s
	iters: 600, epoch: 6 | loss: 0.4756705
	speed: 0.0279s/iter; left time: 140.7612s
	iters: 700, epoch: 6 | loss: 0.5271296
	speed: 0.0275s/iter; left time: 135.9717s
	iters: 800, epoch: 6 | loss: 0.4630099
	speed: 0.0272s/iter; left time: 131.5808s
	iters: 900, epoch: 6 | loss: 0.6561031
	speed: 0.0269s/iter; left time: 127.5912s
	iters: 1000, epoch: 6 | loss: 0.5849159
	speed: 0.0266s/iter; left time: 123.3331s
	iters: 1100, epoch: 6 | loss: 0.5338971
	speed: 0.0262s/iter; left time: 119.0683s
Epoch: 6 cost time: 29.48573613166809
Epoch: 6, Steps: 1128 | Train Loss: 0.6185530 Vali Loss: 0.7137889 Test Loss: 0.3546620
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.7183425
	speed: 0.0185s/iter; left time: 81.6680s
	iters: 200, epoch: 7 | loss: 0.8283640
	speed: 0.0203s/iter; left time: 87.4979s
	iters: 300, epoch: 7 | loss: 0.4777143
	speed: 0.0201s/iter; left time: 84.7523s
	iters: 400, epoch: 7 | loss: 0.5535274
	speed: 0.0200s/iter; left time: 82.3808s
	iters: 500, epoch: 7 | loss: 0.5310821
	speed: 0.0213s/iter; left time: 85.5708s
	iters: 600, epoch: 7 | loss: 0.6354841
	speed: 0.0241s/iter; left time: 94.4903s
	iters: 700, epoch: 7 | loss: 0.6359394
	speed: 0.0261s/iter; left time: 99.6139s
	iters: 800, epoch: 7 | loss: 0.7340215
	speed: 0.0267s/iter; left time: 99.3222s
	iters: 900, epoch: 7 | loss: 0.7549142
	speed: 0.0263s/iter; left time: 94.9665s
	iters: 1000, epoch: 7 | loss: 0.7000655
	speed: 0.0259s/iter; left time: 90.8180s
	iters: 1100, epoch: 7 | loss: 0.5740438
	speed: 0.0255s/iter; left time: 87.0907s
Epoch: 7 cost time: 28.825210571289062
Epoch: 7, Steps: 1128 | Train Loss: 0.6166763 Vali Loss: 0.7169327 Test Loss: 0.3554091
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.7483883
	speed: 0.0233s/iter; left time: 76.4448s
	iters: 200, epoch: 8 | loss: 0.6884177
	speed: 0.0218s/iter; left time: 69.3201s
	iters: 300, epoch: 8 | loss: 0.6028562
	speed: 0.0211s/iter; left time: 65.2477s
	iters: 400, epoch: 8 | loss: 0.7774605
	speed: 0.0224s/iter; left time: 66.7148s
	iters: 500, epoch: 8 | loss: 0.8294017
	speed: 0.0228s/iter; left time: 65.8405s
	iters: 600, epoch: 8 | loss: 0.8240311
	speed: 0.0232s/iter; left time: 64.6354s
	iters: 700, epoch: 8 | loss: 0.8270022
	speed: 0.0243s/iter; left time: 65.3689s
	iters: 800, epoch: 8 | loss: 0.8560323
	speed: 0.0259s/iter; left time: 66.9810s
	iters: 900, epoch: 8 | loss: 0.7231367
	speed: 0.0256s/iter; left time: 63.7036s
	iters: 1000, epoch: 8 | loss: 0.6785676
	speed: 0.0253s/iter; left time: 60.2835s
	iters: 1100, epoch: 8 | loss: 0.6601211
	speed: 0.0250s/iter; left time: 57.2175s
Epoch: 8 cost time: 28.297467708587646
Epoch: 8, Steps: 1128 | Train Loss: 0.6156642 Vali Loss: 0.7172132 Test Loss: 0.3555396
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.5788631
	speed: 0.0238s/iter; left time: 51.4102s
	iters: 200, epoch: 9 | loss: 0.6658179
	speed: 0.0222s/iter; left time: 45.6871s
	iters: 300, epoch: 9 | loss: 0.6849666
	speed: 0.0217s/iter; left time: 42.5257s
	iters: 400, epoch: 9 | loss: 0.7477238
	speed: 0.0224s/iter; left time: 41.5627s
	iters: 500, epoch: 9 | loss: 0.5866660
	speed: 0.0229s/iter; left time: 40.2128s
	iters: 600, epoch: 9 | loss: 0.5611535
	speed: 0.0232s/iter; left time: 38.4977s
	iters: 700, epoch: 9 | loss: 0.5644464
	speed: 0.0235s/iter; left time: 36.5572s
	iters: 800, epoch: 9 | loss: 0.4616373
	speed: 0.0236s/iter; left time: 34.4293s
	iters: 900, epoch: 9 | loss: 0.5757754
	speed: 0.0237s/iter; left time: 32.2269s
	iters: 1000, epoch: 9 | loss: 0.7099772
	speed: 0.0245s/iter; left time: 30.8168s
	iters: 1100, epoch: 9 | loss: 0.5915730
	speed: 0.0245s/iter; left time: 28.2936s
Epoch: 9 cost time: 27.672149896621704
Epoch: 9, Steps: 1128 | Train Loss: 0.6151717 Vali Loss: 0.7167373 Test Loss: 0.3554628
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.3542747497558594, mae:0.3510933518409729
Use GPU: cuda:0
no_skip False
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.6893892
	speed: 0.0197s/iter; left time: 220.7691s
	iters: 200, epoch: 1 | loss: 0.7627965
	speed: 0.0208s/iter; left time: 229.9538s
	iters: 300, epoch: 1 | loss: 0.7579356
	speed: 0.0241s/iter; left time: 264.4452s
	iters: 400, epoch: 1 | loss: 0.6033782
	speed: 0.0276s/iter; left time: 300.1664s
	iters: 500, epoch: 1 | loss: 0.8136670
	speed: 0.0296s/iter; left time: 319.6508s
	iters: 600, epoch: 1 | loss: 0.4991255
	speed: 0.0312s/iter; left time: 332.9983s
	iters: 700, epoch: 1 | loss: 0.7352448
	speed: 0.0318s/iter; left time: 336.9854s
	iters: 800, epoch: 1 | loss: 0.5633511
	speed: 0.0308s/iter; left time: 322.5711s
	iters: 900, epoch: 1 | loss: 0.6290476
	speed: 0.0299s/iter; left time: 310.4476s
	iters: 1000, epoch: 1 | loss: 0.5468463
	speed: 0.0291s/iter; left time: 299.6597s
	iters: 1100, epoch: 1 | loss: 0.6455051
	speed: 0.0289s/iter; left time: 294.0894s
Epoch: 1 cost time: 32.54357314109802
Epoch: 1, Steps: 1128 | Train Loss: 0.7095325 Vali Loss: 0.7275019 Test Loss: 0.3583892
Validation loss decreased (inf --> 0.727502).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5821090
	speed: 0.0353s/iter; left time: 355.3192s
	iters: 200, epoch: 2 | loss: 0.7230276
	speed: 0.0298s/iter; left time: 296.1569s
	iters: 300, epoch: 2 | loss: 0.6090564
	speed: 0.0279s/iter; left time: 274.5256s
	iters: 400, epoch: 2 | loss: 0.5934925
	speed: 0.0269s/iter; left time: 262.7818s
	iters: 500, epoch: 2 | loss: 0.5600299
	speed: 0.0264s/iter; left time: 254.8747s
	iters: 600, epoch: 2 | loss: 0.7236997
	speed: 0.0260s/iter; left time: 248.4576s
	iters: 700, epoch: 2 | loss: 0.6786928
	speed: 0.0257s/iter; left time: 243.3881s
	iters: 800, epoch: 2 | loss: 0.7002794
	speed: 0.0256s/iter; left time: 239.1429s
	iters: 900, epoch: 2 | loss: 0.5598001
	speed: 0.0254s/iter; left time: 234.7625s
	iters: 1000, epoch: 2 | loss: 0.9116442
	speed: 0.0251s/iter; left time: 229.9585s
	iters: 1100, epoch: 2 | loss: 0.6090496
	speed: 0.0250s/iter; left time: 225.9347s
Epoch: 2 cost time: 28.154231309890747
Epoch: 2, Steps: 1128 | Train Loss: 0.6620809 Vali Loss: 0.7102742 Test Loss: 0.3549525
Validation loss decreased (0.727502 --> 0.710274).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5069767
	speed: 0.0290s/iter; left time: 258.9834s
	iters: 200, epoch: 3 | loss: 0.5688697
	speed: 0.0256s/iter; left time: 226.2338s
	iters: 300, epoch: 3 | loss: 0.6744145
	speed: 0.0251s/iter; left time: 218.7493s
	iters: 400, epoch: 3 | loss: 0.9008305
	speed: 0.0245s/iter; left time: 211.2834s
	iters: 500, epoch: 3 | loss: 0.9716109
	speed: 0.0241s/iter; left time: 205.0355s
	iters: 600, epoch: 3 | loss: 0.6464378
	speed: 0.0242s/iter; left time: 204.0699s
	iters: 700, epoch: 3 | loss: 0.6772634
	speed: 0.0243s/iter; left time: 202.4978s
	iters: 800, epoch: 3 | loss: 0.5651740
	speed: 0.0244s/iter; left time: 200.5653s
	iters: 900, epoch: 3 | loss: 0.5630238
	speed: 0.0244s/iter; left time: 198.4301s
	iters: 1000, epoch: 3 | loss: 0.8017154
	speed: 0.0244s/iter; left time: 195.9871s
	iters: 1100, epoch: 3 | loss: 0.5453204
	speed: 0.0244s/iter; left time: 193.5245s
Epoch: 3 cost time: 27.689975023269653
Epoch: 3, Steps: 1128 | Train Loss: 0.6443981 Vali Loss: 0.7059854 Test Loss: 0.3549369
Validation loss decreased (0.710274 --> 0.705985).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6947678
	speed: 0.0325s/iter; left time: 253.7101s
	iters: 200, epoch: 4 | loss: 0.5095733
	speed: 0.0331s/iter; left time: 254.6376s
	iters: 300, epoch: 4 | loss: 0.5381275
	speed: 0.0313s/iter; left time: 237.5695s
	iters: 400, epoch: 4 | loss: 0.6644663
	speed: 0.0291s/iter; left time: 217.8464s
	iters: 500, epoch: 4 | loss: 0.5653555
	speed: 0.0279s/iter; left time: 206.4087s
	iters: 600, epoch: 4 | loss: 0.5494109
	speed: 0.0272s/iter; left time: 198.4890s
	iters: 700, epoch: 4 | loss: 0.4736463
	speed: 0.0269s/iter; left time: 193.4188s
	iters: 800, epoch: 4 | loss: 0.7513178
	speed: 0.0267s/iter; left time: 189.1500s
	iters: 900, epoch: 4 | loss: 0.5999386
	speed: 0.0268s/iter; left time: 187.2467s
	iters: 1000, epoch: 4 | loss: 0.6097302
	speed: 0.0279s/iter; left time: 192.3650s
	iters: 1100, epoch: 4 | loss: 0.7280285
	speed: 0.0283s/iter; left time: 192.3326s
Epoch: 4 cost time: 31.86741876602173
Epoch: 4, Steps: 1128 | Train Loss: 0.6339223 Vali Loss: 0.7089151 Test Loss: 0.3551006
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4902039
	speed: 0.0260s/iter; left time: 173.1484s
	iters: 200, epoch: 5 | loss: 0.8007156
	speed: 0.0245s/iter; left time: 160.9696s
	iters: 300, epoch: 5 | loss: 0.5730898
	speed: 0.0226s/iter; left time: 145.8830s
	iters: 400, epoch: 5 | loss: 0.5974507
	speed: 0.0217s/iter; left time: 138.3527s
	iters: 500, epoch: 5 | loss: 0.6561453
	speed: 0.0212s/iter; left time: 133.1704s
	iters: 600, epoch: 5 | loss: 0.7776216
	speed: 0.0210s/iter; left time: 129.4299s
	iters: 700, epoch: 5 | loss: 0.5647869
	speed: 0.0215s/iter; left time: 130.5288s
	iters: 800, epoch: 5 | loss: 0.5576345
	speed: 0.0218s/iter; left time: 130.2213s
	iters: 900, epoch: 5 | loss: 0.5965091
	speed: 0.0230s/iter; left time: 135.0132s
	iters: 1000, epoch: 5 | loss: 0.5366118
	speed: 0.0242s/iter; left time: 139.3827s
	iters: 1100, epoch: 5 | loss: 0.6325514
	speed: 0.0256s/iter; left time: 144.9450s
Epoch: 5 cost time: 28.903255701065063
Epoch: 5, Steps: 1128 | Train Loss: 0.6272797 Vali Loss: 0.7077974 Test Loss: 0.3547518
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4428730
	speed: 0.0260s/iter; left time: 144.3392s
	iters: 200, epoch: 6 | loss: 0.6514173
	speed: 0.0310s/iter; left time: 168.4590s
	iters: 300, epoch: 6 | loss: 0.5192224
	speed: 0.0285s/iter; left time: 152.3540s
	iters: 400, epoch: 6 | loss: 0.5246533
	speed: 0.0263s/iter; left time: 137.9966s
	iters: 500, epoch: 6 | loss: 0.6124225
	speed: 0.0266s/iter; left time: 136.6312s
	iters: 600, epoch: 6 | loss: 0.5356429
	speed: 0.0255s/iter; left time: 128.7076s
	iters: 700, epoch: 6 | loss: 0.6527301
	speed: 0.0252s/iter; left time: 124.4594s
	iters: 800, epoch: 6 | loss: 0.5398690
	speed: 0.0248s/iter; left time: 120.0374s
	iters: 900, epoch: 6 | loss: 0.5658836
	speed: 0.0240s/iter; left time: 113.5621s
	iters: 1000, epoch: 6 | loss: 0.7211775
	speed: 0.0233s/iter; left time: 107.9914s
	iters: 1100, epoch: 6 | loss: 0.5798416
	speed: 0.0229s/iter; left time: 103.9039s
Epoch: 6 cost time: 25.81204652786255
Epoch: 6, Steps: 1128 | Train Loss: 0.6237752 Vali Loss: 0.7104173 Test Loss: 0.3551678
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.7559312
	speed: 0.0255s/iter; left time: 112.3949s
	iters: 200, epoch: 7 | loss: 0.6554630
	speed: 0.0218s/iter; left time: 94.2191s
	iters: 300, epoch: 7 | loss: 0.7374562
	speed: 0.0201s/iter; left time: 84.6833s
	iters: 400, epoch: 7 | loss: 0.7657255
	speed: 0.0192s/iter; left time: 78.8212s
	iters: 500, epoch: 7 | loss: 0.5066484
	speed: 0.0182s/iter; left time: 72.9231s
	iters: 600, epoch: 7 | loss: 0.5414179
	speed: 0.0179s/iter; left time: 70.0661s
	iters: 700, epoch: 7 | loss: 0.5398144
	speed: 0.0182s/iter; left time: 69.4236s
	iters: 800, epoch: 7 | loss: 0.7228738
	speed: 0.0187s/iter; left time: 69.6047s
	iters: 900, epoch: 7 | loss: 0.5715519
	speed: 0.0192s/iter; left time: 69.2350s
	iters: 1000, epoch: 7 | loss: 0.6337076
	speed: 0.0195s/iter; left time: 68.6205s
	iters: 1100, epoch: 7 | loss: 0.5386172
	speed: 0.0198s/iter; left time: 67.4747s
Epoch: 7 cost time: 22.53034996986389
Epoch: 7, Steps: 1128 | Train Loss: 0.6220005 Vali Loss: 0.7116771 Test Loss: 0.3557713
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.5395660
	speed: 0.0401s/iter; left time: 131.8770s
	iters: 200, epoch: 8 | loss: 0.4978397
	speed: 0.0371s/iter; left time: 118.1436s
	iters: 300, epoch: 8 | loss: 0.8123408
	speed: 0.0323s/iter; left time: 99.7578s
	iters: 400, epoch: 8 | loss: 0.6149880
	speed: 0.0325s/iter; left time: 97.1491s
	iters: 500, epoch: 8 | loss: 0.6039343
	speed: 0.0309s/iter; left time: 89.0804s
	iters: 600, epoch: 8 | loss: 0.4639357
	speed: 0.0299s/iter; left time: 83.1820s
	iters: 700, epoch: 8 | loss: 0.5908804
	speed: 0.0291s/iter; left time: 78.0677s
	iters: 800, epoch: 8 | loss: 0.5354776
	speed: 0.0294s/iter; left time: 76.0096s
	iters: 900, epoch: 8 | loss: 0.8694748
	speed: 0.0290s/iter; left time: 72.1608s
	iters: 1000, epoch: 8 | loss: 0.6108922
	speed: 0.0284s/iter; left time: 67.8375s
	iters: 1100, epoch: 8 | loss: 0.6248862
	speed: 0.0278s/iter; left time: 63.5284s
Epoch: 8 cost time: 31.211148262023926
Epoch: 8, Steps: 1128 | Train Loss: 0.6212447 Vali Loss: 0.7136854 Test Loss: 0.3557515
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.3549368679523468, mae:0.349930077791214
Seed: 456
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_96       Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip False
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.3997341
	speed: 0.0501s/iter; left time: 570.0600s
	iters: 200, epoch: 1 | loss: 0.4162655
	speed: 0.0405s/iter; left time: 456.3120s
	iters: 300, epoch: 1 | loss: 0.4025760
	speed: 0.0363s/iter; left time: 405.5004s
	iters: 400, epoch: 1 | loss: 0.4490181
	speed: 0.0327s/iter; left time: 362.0728s
	iters: 500, epoch: 1 | loss: 0.3950303
	speed: 0.0303s/iter; left time: 332.4295s
	iters: 600, epoch: 1 | loss: 1.2848743
	speed: 0.0310s/iter; left time: 336.9528s
	iters: 700, epoch: 1 | loss: 0.3860499
	speed: 0.0311s/iter; left time: 334.8575s
	iters: 800, epoch: 1 | loss: 0.3594938
	speed: 0.0294s/iter; left time: 314.1455s
	iters: 900, epoch: 1 | loss: 0.3261655
	speed: 0.0277s/iter; left time: 293.1065s
	iters: 1000, epoch: 1 | loss: 0.3184528
	speed: 0.0262s/iter; left time: 274.5823s
	iters: 1100, epoch: 1 | loss: 0.3545989
	speed: 0.0250s/iter; left time: 259.7093s
Epoch: 1 cost time: 28.549647569656372
Epoch: 1, Steps: 1147 | Train Loss: 0.4979776 Vali Loss: 0.4484365 Test Loss: 0.1877270
Validation loss decreased (inf --> 0.448436).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5585916
	speed: 0.0287s/iter; left time: 293.9343s
	iters: 200, epoch: 2 | loss: 0.9736885
	speed: 0.0264s/iter; left time: 267.6283s
	iters: 300, epoch: 2 | loss: 0.4196698
	speed: 0.0253s/iter; left time: 253.4610s
	iters: 400, epoch: 2 | loss: 0.5163524
	speed: 0.0247s/iter; left time: 245.0365s
	iters: 500, epoch: 2 | loss: 0.4039072
	speed: 0.0243s/iter; left time: 238.2542s
	iters: 600, epoch: 2 | loss: 0.6667699
	speed: 0.0240s/iter; left time: 233.5114s
	iters: 700, epoch: 2 | loss: 0.3559053
	speed: 0.0238s/iter; left time: 229.0115s
	iters: 800, epoch: 2 | loss: 0.2729796
	speed: 0.0235s/iter; left time: 223.5713s
	iters: 900, epoch: 2 | loss: 0.2854534
	speed: 0.0233s/iter; left time: 219.1793s
	iters: 1000, epoch: 2 | loss: 0.2224444
	speed: 0.0230s/iter; left time: 214.0776s
	iters: 1100, epoch: 2 | loss: 0.3792207
	speed: 0.0229s/iter; left time: 211.0462s
Epoch: 2 cost time: 26.344841718673706
Epoch: 2, Steps: 1147 | Train Loss: 0.4458742 Vali Loss: 0.4337566 Test Loss: 0.1779406
Validation loss decreased (0.448436 --> 0.433757).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4147213
	speed: 0.0423s/iter; left time: 384.3345s
	iters: 200, epoch: 3 | loss: 0.3652534
	speed: 0.0400s/iter; left time: 359.2805s
	iters: 300, epoch: 3 | loss: 0.4173120
	speed: 0.0344s/iter; left time: 305.3682s
	iters: 400, epoch: 3 | loss: 0.4804343
	speed: 0.0315s/iter; left time: 276.1500s
	iters: 500, epoch: 3 | loss: 0.2482024
	speed: 0.0295s/iter; left time: 256.2075s
	iters: 600, epoch: 3 | loss: 1.1919490
	speed: 0.0278s/iter; left time: 238.5603s
	iters: 700, epoch: 3 | loss: 0.4538305
	speed: 0.0269s/iter; left time: 228.2457s
	iters: 800, epoch: 3 | loss: 0.2630395
	speed: 0.0260s/iter; left time: 218.0297s
	iters: 900, epoch: 3 | loss: 0.3089668
	speed: 0.0253s/iter; left time: 209.5593s
	iters: 1000, epoch: 3 | loss: 0.3678419
	speed: 0.0250s/iter; left time: 204.5818s
	iters: 1100, epoch: 3 | loss: 0.2497460
	speed: 0.0247s/iter; left time: 199.8107s
Epoch: 3 cost time: 28.521776914596558
Epoch: 3, Steps: 1147 | Train Loss: 0.4229398 Vali Loss: 0.4192858 Test Loss: 0.1739515
Validation loss decreased (0.433757 --> 0.419286).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2984946
	speed: 0.0462s/iter; left time: 366.0911s
	iters: 200, epoch: 4 | loss: 0.2184862
	speed: 0.0346s/iter; left time: 271.1666s
	iters: 300, epoch: 4 | loss: 0.2888217
	speed: 0.0311s/iter; left time: 240.7531s
	iters: 400, epoch: 4 | loss: 0.2575715
	speed: 0.0284s/iter; left time: 216.7323s
	iters: 500, epoch: 4 | loss: 0.3312344
	speed: 0.0267s/iter; left time: 200.8851s
	iters: 600, epoch: 4 | loss: 0.4344787
	speed: 0.0253s/iter; left time: 187.7026s
	iters: 700, epoch: 4 | loss: 0.2412848
	speed: 0.0253s/iter; left time: 185.1587s
	iters: 800, epoch: 4 | loss: 0.2848032
	speed: 0.0244s/iter; left time: 176.1354s
	iters: 900, epoch: 4 | loss: 0.3513215
	speed: 0.0235s/iter; left time: 167.5480s
	iters: 1000, epoch: 4 | loss: 0.3198413
	speed: 0.0231s/iter; left time: 162.5566s
	iters: 1100, epoch: 4 | loss: 1.2283616
	speed: 0.0234s/iter; left time: 162.3168s
Epoch: 4 cost time: 27.321300268173218
Epoch: 4, Steps: 1147 | Train Loss: 0.4113127 Vali Loss: 0.4147857 Test Loss: 0.1734304
Validation loss decreased (0.419286 --> 0.414786).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3373540
	speed: 0.0382s/iter; left time: 258.8184s
	iters: 200, epoch: 5 | loss: 0.3534542
	speed: 0.0321s/iter; left time: 214.3308s
	iters: 300, epoch: 5 | loss: 0.3354655
	speed: 0.0280s/iter; left time: 184.4274s
	iters: 400, epoch: 5 | loss: 0.3862216
	speed: 0.0265s/iter; left time: 171.7082s
	iters: 500, epoch: 5 | loss: 0.4815796
	speed: 0.0269s/iter; left time: 171.6963s
	iters: 600, epoch: 5 | loss: 0.4722802
	speed: 0.0276s/iter; left time: 173.4032s
	iters: 700, epoch: 5 | loss: 0.3773424
	speed: 0.0275s/iter; left time: 169.8647s
	iters: 800, epoch: 5 | loss: 0.3358441
	speed: 0.0283s/iter; left time: 172.1480s
	iters: 900, epoch: 5 | loss: 0.2046773
	speed: 0.0290s/iter; left time: 173.2313s
	iters: 1000, epoch: 5 | loss: 0.3488691
	speed: 0.0286s/iter; left time: 168.4489s
	iters: 1100, epoch: 5 | loss: 0.9300731
	speed: 0.0298s/iter; left time: 172.3873s
Epoch: 5 cost time: 34.740981340408325
Epoch: 5, Steps: 1147 | Train Loss: 0.4049526 Vali Loss: 0.4158468 Test Loss: 0.1721457
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3199303
	speed: 0.0342s/iter; left time: 192.8466s
	iters: 200, epoch: 6 | loss: 0.4716921
	speed: 0.0290s/iter; left time: 160.4143s
	iters: 300, epoch: 6 | loss: 0.2702355
	speed: 0.0291s/iter; left time: 158.0673s
	iters: 400, epoch: 6 | loss: 0.4481345
	speed: 0.0281s/iter; left time: 149.8347s
	iters: 500, epoch: 6 | loss: 0.8954668
	speed: 0.0290s/iter; left time: 152.0668s
	iters: 600, epoch: 6 | loss: 0.4058655
	speed: 0.0284s/iter; left time: 145.6689s
	iters: 700, epoch: 6 | loss: 0.2272595
	speed: 0.0278s/iter; left time: 140.0569s
	iters: 800, epoch: 6 | loss: 0.2729300
	speed: 0.0278s/iter; left time: 137.2820s
	iters: 900, epoch: 6 | loss: 0.3088413
	speed: 0.0278s/iter; left time: 134.3339s
	iters: 1000, epoch: 6 | loss: 0.3430774
	speed: 0.0277s/iter; left time: 131.4004s
	iters: 1100, epoch: 6 | loss: 1.3081770
	speed: 0.0282s/iter; left time: 130.9200s
Epoch: 6 cost time: 32.75833344459534
Epoch: 6, Steps: 1147 | Train Loss: 0.4012866 Vali Loss: 0.4186514 Test Loss: 0.1736212
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3078529
	speed: 0.0232s/iter; left time: 104.2245s
	iters: 200, epoch: 7 | loss: 1.2221321
	speed: 0.0216s/iter; left time: 94.7323s
	iters: 300, epoch: 7 | loss: 0.2584267
	speed: 0.0217s/iter; left time: 93.1759s
	iters: 400, epoch: 7 | loss: 0.4267802
	speed: 0.0220s/iter; left time: 92.0003s
	iters: 500, epoch: 7 | loss: 0.3505863
	speed: 0.0221s/iter; left time: 90.3275s
	iters: 600, epoch: 7 | loss: 0.3557987
	speed: 0.0213s/iter; left time: 85.0940s
	iters: 700, epoch: 7 | loss: 0.2479483
	speed: 0.0207s/iter; left time: 80.3194s
	iters: 800, epoch: 7 | loss: 0.2551317
	speed: 0.0202s/iter; left time: 76.6285s
	iters: 900, epoch: 7 | loss: 1.1490217
	speed: 0.0200s/iter; left time: 73.6477s
	iters: 1000, epoch: 7 | loss: 0.4351964
	speed: 0.0204s/iter; left time: 73.3064s
	iters: 1100, epoch: 7 | loss: 0.3146920
	speed: 0.0209s/iter; left time: 72.7568s
Epoch: 7 cost time: 24.26161813735962
Epoch: 7, Steps: 1147 | Train Loss: 0.3993791 Vali Loss: 0.4154752 Test Loss: 0.1722768
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2958540
	speed: 0.0350s/iter; left time: 117.0727s
	iters: 200, epoch: 8 | loss: 0.2236983
	speed: 0.0278s/iter; left time: 90.2532s
	iters: 300, epoch: 8 | loss: 0.2959194
	speed: 0.0254s/iter; left time: 79.8810s
	iters: 400, epoch: 8 | loss: 1.3285270
	speed: 0.0246s/iter; left time: 74.9112s
	iters: 500, epoch: 8 | loss: 0.4147857
	speed: 0.0240s/iter; left time: 70.6859s
	iters: 600, epoch: 8 | loss: 0.2996410
	speed: 0.0238s/iter; left time: 67.6953s
	iters: 700, epoch: 8 | loss: 0.3140849
	speed: 0.0237s/iter; left time: 64.9032s
	iters: 800, epoch: 8 | loss: 0.3440845
	speed: 0.0242s/iter; left time: 63.9642s
	iters: 900, epoch: 8 | loss: 0.2741413
	speed: 0.0249s/iter; left time: 63.4092s
	iters: 1000, epoch: 8 | loss: 0.2608691
	speed: 0.0254s/iter; left time: 61.9079s
	iters: 1100, epoch: 8 | loss: 0.2751236
	speed: 0.0263s/iter; left time: 61.5418s
Epoch: 8 cost time: 30.662651777267456
Epoch: 8, Steps: 1147 | Train Loss: 0.3986619 Vali Loss: 0.4175912 Test Loss: 0.1725412
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2423809
	speed: 0.0220s/iter; left time: 48.3893s
	iters: 200, epoch: 9 | loss: 0.4733738
	speed: 0.0210s/iter; left time: 44.0062s
	iters: 300, epoch: 9 | loss: 0.2331724
	speed: 0.0213s/iter; left time: 42.4906s
	iters: 400, epoch: 9 | loss: 0.3201095
	speed: 0.0244s/iter; left time: 46.2706s
	iters: 500, epoch: 9 | loss: 0.2556511
	speed: 0.0254s/iter; left time: 45.5482s
	iters: 600, epoch: 9 | loss: 0.3492615
	speed: 0.0251s/iter; left time: 42.6086s
	iters: 700, epoch: 9 | loss: 0.2889054
	speed: 0.0246s/iter; left time: 39.2788s
	iters: 800, epoch: 9 | loss: 0.2695201
	speed: 0.0244s/iter; left time: 36.5232s
	iters: 900, epoch: 9 | loss: 0.4397712
	speed: 0.0256s/iter; left time: 35.6448s
	iters: 1000, epoch: 9 | loss: 0.2590682
	speed: 0.0265s/iter; left time: 34.2956s
	iters: 1100, epoch: 9 | loss: 0.2795828
	speed: 0.0267s/iter; left time: 31.9514s
Epoch: 9 cost time: 30.717296838760376
Epoch: 9, Steps: 1147 | Train Loss: 0.3980017 Vali Loss: 0.4176842 Test Loss: 0.1724136
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.17343048751354218, mae:0.21645548939704895
Use GPU: cuda:0
no_skip False
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.4289572
	speed: 0.0244s/iter; left time: 277.5356s
	iters: 200, epoch: 1 | loss: 1.3968815
	speed: 0.0219s/iter; left time: 247.1144s
	iters: 300, epoch: 1 | loss: 0.6886482
	speed: 0.0198s/iter; left time: 221.4625s
	iters: 400, epoch: 1 | loss: 0.4202384
	speed: 0.0194s/iter; left time: 214.7283s
	iters: 500, epoch: 1 | loss: 0.3356408
	speed: 0.0205s/iter; left time: 224.3978s
	iters: 600, epoch: 1 | loss: 0.3073014
	speed: 0.0215s/iter; left time: 233.7077s
	iters: 700, epoch: 1 | loss: 0.4017890
	speed: 0.0221s/iter; left time: 237.7737s
	iters: 800, epoch: 1 | loss: 0.3634376
	speed: 0.0224s/iter; left time: 238.8422s
	iters: 900, epoch: 1 | loss: 0.3997675
	speed: 0.0226s/iter; left time: 239.2722s
	iters: 1000, epoch: 1 | loss: 0.3296360
	speed: 0.0228s/iter; left time: 239.0962s
	iters: 1100, epoch: 1 | loss: 0.4053785
	speed: 0.0230s/iter; left time: 238.6313s
Epoch: 1 cost time: 26.619287729263306
Epoch: 1, Steps: 1147 | Train Loss: 0.5099185 Vali Loss: 0.4464311 Test Loss: 0.1867134
Validation loss decreased (inf --> 0.446431).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4177120
	speed: 0.0315s/iter; left time: 322.2406s
	iters: 200, epoch: 2 | loss: 0.3591457
	speed: 0.0273s/iter; left time: 276.5541s
	iters: 300, epoch: 2 | loss: 0.4391493
	speed: 0.0266s/iter; left time: 267.0268s
	iters: 400, epoch: 2 | loss: 0.3634477
	speed: 0.0256s/iter; left time: 254.2747s
	iters: 500, epoch: 2 | loss: 0.3322266
	speed: 0.0250s/iter; left time: 245.7884s
	iters: 600, epoch: 2 | loss: 0.3444831
	speed: 0.0246s/iter; left time: 239.4431s
	iters: 700, epoch: 2 | loss: 0.5318386
	speed: 0.0244s/iter; left time: 234.5917s
	iters: 800, epoch: 2 | loss: 0.3444909
	speed: 0.0241s/iter; left time: 229.9777s
	iters: 900, epoch: 2 | loss: 0.4878936
	speed: 0.0242s/iter; left time: 227.7950s
	iters: 1000, epoch: 2 | loss: 0.2612565
	speed: 0.0242s/iter; left time: 225.4271s
	iters: 1100, epoch: 2 | loss: 0.2815658
	speed: 0.0242s/iter; left time: 222.9888s
Epoch: 2 cost time: 27.879907369613647
Epoch: 2, Steps: 1147 | Train Loss: 0.4468584 Vali Loss: 0.4227720 Test Loss: 0.1771463
Validation loss decreased (0.446431 --> 0.422772).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2712362
	speed: 0.0235s/iter; left time: 213.0594s
	iters: 200, epoch: 3 | loss: 0.3415778
	speed: 0.0214s/iter; left time: 192.5284s
	iters: 300, epoch: 3 | loss: 0.3143107
	speed: 0.0205s/iter; left time: 181.5693s
	iters: 400, epoch: 3 | loss: 0.2725809
	speed: 0.0234s/iter; left time: 205.5420s
	iters: 500, epoch: 3 | loss: 0.2121077
	speed: 0.0259s/iter; left time: 224.5504s
	iters: 600, epoch: 3 | loss: 0.2888735
	speed: 0.0274s/iter; left time: 234.9069s
	iters: 700, epoch: 3 | loss: 0.4133755
	speed: 0.0279s/iter; left time: 236.1828s
	iters: 800, epoch: 3 | loss: 1.2344068
	speed: 0.0272s/iter; left time: 227.8189s
	iters: 900, epoch: 3 | loss: 0.3644963
	speed: 0.0266s/iter; left time: 220.5101s
	iters: 1000, epoch: 3 | loss: 0.3075180
	speed: 0.0265s/iter; left time: 216.6926s
	iters: 1100, epoch: 3 | loss: 0.2788490
	speed: 0.0264s/iter; left time: 212.8457s
Epoch: 3 cost time: 30.299129486083984
Epoch: 3, Steps: 1147 | Train Loss: 0.4281647 Vali Loss: 0.4177029 Test Loss: 0.1749516
Validation loss decreased (0.422772 --> 0.417703).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 1.3605859
	speed: 0.0339s/iter; left time: 269.0868s
	iters: 200, epoch: 4 | loss: 0.2767897
	speed: 0.0284s/iter; left time: 222.5608s
	iters: 300, epoch: 4 | loss: 0.3882626
	speed: 0.0248s/iter; left time: 192.0025s
	iters: 400, epoch: 4 | loss: 1.3804060
	speed: 0.0231s/iter; left time: 176.4160s
	iters: 500, epoch: 4 | loss: 0.2513112
	speed: 0.0226s/iter; left time: 170.0751s
	iters: 600, epoch: 4 | loss: 0.4189629
	speed: 0.0232s/iter; left time: 172.2733s
	iters: 700, epoch: 4 | loss: 0.2916423
	speed: 0.0223s/iter; left time: 163.6977s
	iters: 800, epoch: 4 | loss: 0.4576440
	speed: 0.0233s/iter; left time: 168.1310s
	iters: 900, epoch: 4 | loss: 0.2735693
	speed: 0.0234s/iter; left time: 167.0059s
	iters: 1000, epoch: 4 | loss: 0.2836674
	speed: 0.0235s/iter; left time: 165.4376s
	iters: 1100, epoch: 4 | loss: 0.2957368
	speed: 0.0238s/iter; left time: 164.6966s
Epoch: 4 cost time: 27.38549041748047
Epoch: 4, Steps: 1147 | Train Loss: 0.4152881 Vali Loss: 0.4160925 Test Loss: 0.1735290
Validation loss decreased (0.417703 --> 0.416092).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3076160
	speed: 0.0317s/iter; left time: 215.1127s
	iters: 200, epoch: 5 | loss: 0.3373010
	speed: 0.0271s/iter; left time: 180.9785s
	iters: 300, epoch: 5 | loss: 0.3596496
	speed: 0.0255s/iter; left time: 168.0236s
	iters: 400, epoch: 5 | loss: 0.3442367
	speed: 0.0261s/iter; left time: 169.4145s
	iters: 500, epoch: 5 | loss: 1.1855395
	speed: 0.0271s/iter; left time: 172.7830s
	iters: 600, epoch: 5 | loss: 0.2712039
	speed: 0.0264s/iter; left time: 165.6259s
	iters: 700, epoch: 5 | loss: 0.3507588
	speed: 0.0259s/iter; left time: 160.0799s
	iters: 800, epoch: 5 | loss: 0.2674471
	speed: 0.0254s/iter; left time: 154.8098s
	iters: 900, epoch: 5 | loss: 0.3883598
	speed: 0.0251s/iter; left time: 150.4068s
	iters: 1000, epoch: 5 | loss: 0.2685364
	speed: 0.0247s/iter; left time: 145.3000s
	iters: 1100, epoch: 5 | loss: 0.3815675
	speed: 0.0243s/iter; left time: 140.3075s
Epoch: 5 cost time: 27.75485134124756
Epoch: 5, Steps: 1147 | Train Loss: 0.4086996 Vali Loss: 0.4153752 Test Loss: 0.1731655
Validation loss decreased (0.416092 --> 0.415375).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2722532
	speed: 0.0335s/iter; left time: 188.7679s
	iters: 200, epoch: 6 | loss: 0.2503877
	speed: 0.0311s/iter; left time: 172.0317s
	iters: 300, epoch: 6 | loss: 0.2898258
	speed: 0.0282s/iter; left time: 153.3501s
	iters: 400, epoch: 6 | loss: 0.2982294
	speed: 0.0267s/iter; left time: 142.4952s
	iters: 500, epoch: 6 | loss: 0.3093382
	speed: 0.0264s/iter; left time: 138.2211s
	iters: 600, epoch: 6 | loss: 0.4840230
	speed: 0.0261s/iter; left time: 134.2643s
	iters: 700, epoch: 6 | loss: 0.2633023
	speed: 0.0260s/iter; left time: 130.8092s
	iters: 800, epoch: 6 | loss: 0.2692771
	speed: 0.0258s/iter; left time: 127.4648s
	iters: 900, epoch: 6 | loss: 0.3541897
	speed: 0.0257s/iter; left time: 124.3399s
	iters: 1000, epoch: 6 | loss: 0.4117205
	speed: 0.0257s/iter; left time: 121.7239s
	iters: 1100, epoch: 6 | loss: 0.3418073
	speed: 0.0254s/iter; left time: 117.9815s
Epoch: 6 cost time: 29.249335050582886
Epoch: 6, Steps: 1147 | Train Loss: 0.4054006 Vali Loss: 0.4142890 Test Loss: 0.1731446
Validation loss decreased (0.415375 --> 0.414289).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.6254747
	speed: 0.0300s/iter; left time: 134.7887s
	iters: 200, epoch: 7 | loss: 0.4520373
	speed: 0.0266s/iter; left time: 116.6251s
	iters: 300, epoch: 7 | loss: 1.2614131
	speed: 0.0251s/iter; left time: 107.7192s
	iters: 400, epoch: 7 | loss: 0.5554785
	speed: 0.0232s/iter; left time: 97.2078s
	iters: 500, epoch: 7 | loss: 0.2533468
	speed: 0.0221s/iter; left time: 90.5559s
	iters: 600, epoch: 7 | loss: 0.3305103
	speed: 0.0214s/iter; left time: 85.1802s
	iters: 700, epoch: 7 | loss: 0.4170410
	speed: 0.0216s/iter; left time: 83.8842s
	iters: 800, epoch: 7 | loss: 0.2777203
	speed: 0.0211s/iter; left time: 79.8885s
	iters: 900, epoch: 7 | loss: 0.3150860
	speed: 0.0206s/iter; left time: 75.9143s
	iters: 1000, epoch: 7 | loss: 0.2907082
	speed: 0.0204s/iter; left time: 73.1499s
	iters: 1100, epoch: 7 | loss: 0.4334576
	speed: 0.0205s/iter; left time: 71.4099s
Epoch: 7 cost time: 23.630611181259155
Epoch: 7, Steps: 1147 | Train Loss: 0.4037070 Vali Loss: 0.4144095 Test Loss: 0.1723295
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2891425
	speed: 0.0253s/iter; left time: 84.6018s
	iters: 200, epoch: 8 | loss: 0.2539930
	speed: 0.0234s/iter; left time: 76.0189s
	iters: 300, epoch: 8 | loss: 0.2362938
	speed: 0.0238s/iter; left time: 74.9364s
	iters: 400, epoch: 8 | loss: 0.3563803
	speed: 0.0241s/iter; left time: 73.4397s
	iters: 500, epoch: 8 | loss: 1.1849639
	speed: 0.0243s/iter; left time: 71.4567s
	iters: 600, epoch: 8 | loss: 0.3456661
	speed: 0.0244s/iter; left time: 69.3834s
	iters: 700, epoch: 8 | loss: 0.2316784
	speed: 0.0243s/iter; left time: 66.5694s
	iters: 800, epoch: 8 | loss: 0.3280705
	speed: 0.0239s/iter; left time: 63.1655s
	iters: 900, epoch: 8 | loss: 0.2905375
	speed: 0.0237s/iter; left time: 60.1544s
	iters: 1000, epoch: 8 | loss: 0.2513292
	speed: 0.0235s/iter; left time: 57.4990s
	iters: 1100, epoch: 8 | loss: 0.3512490
	speed: 0.0236s/iter; left time: 55.3733s
Epoch: 8 cost time: 27.31260633468628
Epoch: 8, Steps: 1147 | Train Loss: 0.4026385 Vali Loss: 0.4137480 Test Loss: 0.1722004
Validation loss decreased (0.414289 --> 0.413748).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3058870
	speed: 0.0324s/iter; left time: 71.2131s
	iters: 200, epoch: 9 | loss: 1.3653281
	speed: 0.0267s/iter; left time: 56.0071s
	iters: 300, epoch: 9 | loss: 0.4966052
	speed: 0.0297s/iter; left time: 59.2587s
	iters: 400, epoch: 9 | loss: 0.3065755
	speed: 0.0313s/iter; left time: 59.3420s
	iters: 500, epoch: 9 | loss: 0.1995036
	speed: 0.0320s/iter; left time: 57.4389s
	iters: 600, epoch: 9 | loss: 0.2247763
	speed: 0.0323s/iter; left time: 54.7489s
	iters: 700, epoch: 9 | loss: 0.2088046
	speed: 0.0324s/iter; left time: 51.7411s
	iters: 800, epoch: 9 | loss: 0.3386076
	speed: 0.0328s/iter; left time: 49.0709s
	iters: 900, epoch: 9 | loss: 0.2285132
	speed: 0.0330s/iter; left time: 45.9860s
	iters: 1000, epoch: 9 | loss: 0.2740628
	speed: 0.0320s/iter; left time: 41.4226s
	iters: 1100, epoch: 9 | loss: 0.2894517
	speed: 0.0311s/iter; left time: 37.1494s
Epoch: 9 cost time: 35.65292143821716
Epoch: 9, Steps: 1147 | Train Loss: 0.4021848 Vali Loss: 0.4134135 Test Loss: 0.1721268
Validation loss decreased (0.413748 --> 0.413414).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3339494
	speed: 0.0251s/iter; left time: 26.2946s
	iters: 200, epoch: 10 | loss: 0.2925571
	speed: 0.0238s/iter; left time: 22.5280s
	iters: 300, epoch: 10 | loss: 1.3676025
	speed: 0.0233s/iter; left time: 19.7649s
	iters: 400, epoch: 10 | loss: 0.3555473
	speed: 0.0231s/iter; left time: 17.3056s
	iters: 500, epoch: 10 | loss: 0.3037557
	speed: 0.0235s/iter; left time: 15.2086s
	iters: 600, epoch: 10 | loss: 0.2744580
	speed: 0.0234s/iter; left time: 12.8101s
	iters: 700, epoch: 10 | loss: 0.3103231
	speed: 0.0236s/iter; left time: 10.5638s
	iters: 800, epoch: 10 | loss: 0.5888382
	speed: 0.0234s/iter; left time: 8.1534s
	iters: 900, epoch: 10 | loss: 0.3992204
	speed: 0.0234s/iter; left time: 5.7931s
	iters: 1000, epoch: 10 | loss: 0.2358042
	speed: 0.0234s/iter; left time: 3.4613s
	iters: 1100, epoch: 10 | loss: 0.2996141
	speed: 0.0236s/iter; left time: 1.1306s
Epoch: 10 cost time: 26.96413540840149
Epoch: 10, Steps: 1147 | Train Loss: 0.4019171 Vali Loss: 0.4131069 Test Loss: 0.1721475
Validation loss decreased (0.413414 --> 0.413107).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.17214751243591309, mae:0.21645431220531464
Use GPU: cuda:0
no_skip False
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.4424476
	speed: 0.0388s/iter; left time: 441.2078s
	iters: 200, epoch: 1 | loss: 0.6196293
	speed: 0.0309s/iter; left time: 348.1901s
	iters: 300, epoch: 1 | loss: 0.5737510
	speed: 0.0296s/iter; left time: 330.8522s
	iters: 400, epoch: 1 | loss: 0.4938297
	speed: 0.0303s/iter; left time: 335.0669s
	iters: 500, epoch: 1 | loss: 1.2873796
	speed: 0.0308s/iter; left time: 338.2952s
	iters: 600, epoch: 1 | loss: 0.3891645
	speed: 0.0317s/iter; left time: 344.8159s
	iters: 700, epoch: 1 | loss: 0.3873095
	speed: 0.0312s/iter; left time: 335.7411s
	iters: 800, epoch: 1 | loss: 0.3796221
	speed: 0.0302s/iter; left time: 321.9079s
	iters: 900, epoch: 1 | loss: 0.4463566
	speed: 0.0299s/iter; left time: 316.5549s
	iters: 1000, epoch: 1 | loss: 0.5312612
	speed: 0.0295s/iter; left time: 308.5889s
	iters: 1100, epoch: 1 | loss: 0.3097653
	speed: 0.0294s/iter; left time: 304.9190s
Epoch: 1 cost time: 33.91965341567993
Epoch: 1, Steps: 1147 | Train Loss: 0.5056251 Vali Loss: 0.4554749 Test Loss: 0.1860650
Validation loss decreased (inf --> 0.455475).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2915131
	speed: 0.0443s/iter; left time: 452.7094s
	iters: 200, epoch: 2 | loss: 0.4341864
	speed: 0.0368s/iter; left time: 372.1892s
	iters: 300, epoch: 2 | loss: 0.2708023
	speed: 0.0362s/iter; left time: 363.0623s
	iters: 400, epoch: 2 | loss: 0.4879184
	speed: 0.0333s/iter; left time: 330.0889s
	iters: 500, epoch: 2 | loss: 0.4462729
	speed: 0.0311s/iter; left time: 305.1279s
	iters: 600, epoch: 2 | loss: 0.2724373
	speed: 0.0294s/iter; left time: 285.9647s
	iters: 700, epoch: 2 | loss: 0.4216194
	speed: 0.0291s/iter; left time: 279.6930s
	iters: 800, epoch: 2 | loss: 0.3915192
	speed: 0.0282s/iter; left time: 268.1599s
	iters: 900, epoch: 2 | loss: 0.3436737
	speed: 0.0277s/iter; left time: 261.5084s
	iters: 1000, epoch: 2 | loss: 0.3128717
	speed: 0.0274s/iter; left time: 255.5473s
	iters: 1100, epoch: 2 | loss: 0.2948155
	speed: 0.0272s/iter; left time: 250.4444s
Epoch: 2 cost time: 31.148731231689453
Epoch: 2, Steps: 1147 | Train Loss: 0.4506308 Vali Loss: 0.4325953 Test Loss: 0.1795384
Validation loss decreased (0.455475 --> 0.432595).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3616379
	speed: 0.0274s/iter; left time: 248.6725s
	iters: 200, epoch: 3 | loss: 0.3269686
	speed: 0.0258s/iter; left time: 231.1709s
	iters: 300, epoch: 3 | loss: 0.4477541
	speed: 0.0253s/iter; left time: 224.2470s
	iters: 400, epoch: 3 | loss: 0.3301162
	speed: 0.0246s/iter; left time: 215.8120s
	iters: 500, epoch: 3 | loss: 0.2171216
	speed: 0.0236s/iter; left time: 204.5621s
	iters: 600, epoch: 3 | loss: 0.5278364
	speed: 0.0220s/iter; left time: 188.8102s
	iters: 700, epoch: 3 | loss: 0.4354762
	speed: 0.0211s/iter; left time: 178.7015s
	iters: 800, epoch: 3 | loss: 0.3179914
	speed: 0.0205s/iter; left time: 171.6519s
	iters: 900, epoch: 3 | loss: 0.5223567
	speed: 0.0198s/iter; left time: 163.8737s
	iters: 1000, epoch: 3 | loss: 0.2660645
	speed: 0.0197s/iter; left time: 160.8206s
	iters: 1100, epoch: 3 | loss: 1.3779651
	speed: 0.0198s/iter; left time: 159.5846s
Epoch: 3 cost time: 22.8939368724823
Epoch: 3, Steps: 1147 | Train Loss: 0.4293366 Vali Loss: 0.4269129 Test Loss: 0.1760063
Validation loss decreased (0.432595 --> 0.426913).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4199452
	speed: 0.0237s/iter; left time: 188.2280s
	iters: 200, epoch: 4 | loss: 0.2785592
	speed: 0.0216s/iter; left time: 168.7781s
	iters: 300, epoch: 4 | loss: 0.2965230
	speed: 0.0205s/iter; left time: 158.2695s
	iters: 400, epoch: 4 | loss: 0.5571886
	speed: 0.0215s/iter; left time: 164.3228s
	iters: 500, epoch: 4 | loss: 0.3181383
	speed: 0.0244s/iter; left time: 183.4870s
	iters: 600, epoch: 4 | loss: 0.2949153
	speed: 0.0258s/iter; left time: 191.3873s
	iters: 700, epoch: 4 | loss: 0.2966139
	speed: 0.0262s/iter; left time: 192.0270s
	iters: 800, epoch: 4 | loss: 0.4458759
	speed: 0.0259s/iter; left time: 187.1574s
	iters: 900, epoch: 4 | loss: 0.4229240
	speed: 0.0255s/iter; left time: 182.0168s
	iters: 1000, epoch: 4 | loss: 0.2976767
	speed: 0.0253s/iter; left time: 177.5956s
	iters: 1100, epoch: 4 | loss: 0.3707159
	speed: 0.0250s/iter; left time: 173.5758s
Epoch: 4 cost time: 28.824004888534546
Epoch: 4, Steps: 1147 | Train Loss: 0.4169488 Vali Loss: 0.4231951 Test Loss: 0.1784055
Validation loss decreased (0.426913 --> 0.423195).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5319853
	speed: 0.0272s/iter; left time: 184.6513s
	iters: 200, epoch: 5 | loss: 0.2786499
	speed: 0.0249s/iter; left time: 166.0876s
	iters: 300, epoch: 5 | loss: 1.3979981
	speed: 0.0238s/iter; left time: 156.8313s
	iters: 400, epoch: 5 | loss: 0.3292291
	speed: 0.0235s/iter; left time: 152.2627s
	iters: 500, epoch: 5 | loss: 1.2450563
	speed: 0.0233s/iter; left time: 148.7754s
	iters: 600, epoch: 5 | loss: 0.3769380
	speed: 0.0247s/iter; left time: 155.0696s
	iters: 700, epoch: 5 | loss: 0.3131956
	speed: 0.0259s/iter; left time: 159.8905s
	iters: 800, epoch: 5 | loss: 0.2780317
	speed: 0.0270s/iter; left time: 164.1565s
	iters: 900, epoch: 5 | loss: 0.2738464
	speed: 0.0271s/iter; left time: 161.8948s
	iters: 1000, epoch: 5 | loss: 0.1977395
	speed: 0.0265s/iter; left time: 156.1641s
	iters: 1100, epoch: 5 | loss: 0.2531932
	speed: 0.0262s/iter; left time: 151.5846s
Epoch: 5 cost time: 30.116868019104004
Epoch: 5, Steps: 1147 | Train Loss: 0.4107799 Vali Loss: 0.4206217 Test Loss: 0.1753006
Validation loss decreased (0.423195 --> 0.420622).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3359631
	speed: 0.0342s/iter; left time: 192.5087s
	iters: 200, epoch: 6 | loss: 0.3626711
	speed: 0.0302s/iter; left time: 166.9583s
	iters: 300, epoch: 6 | loss: 0.2330080
	speed: 0.0281s/iter; left time: 152.8110s
	iters: 400, epoch: 6 | loss: 0.2716783
	speed: 0.0283s/iter; left time: 150.8421s
	iters: 500, epoch: 6 | loss: 0.3105354
	speed: 0.0261s/iter; left time: 136.7633s
	iters: 600, epoch: 6 | loss: 1.0072652
	speed: 0.0244s/iter; left time: 125.4372s
	iters: 700, epoch: 6 | loss: 0.4624409
	speed: 0.0231s/iter; left time: 116.2290s
	iters: 800, epoch: 6 | loss: 0.4908361
	speed: 0.0221s/iter; left time: 109.2421s
	iters: 900, epoch: 6 | loss: 0.3128171
	speed: 0.0215s/iter; left time: 103.9177s
	iters: 1000, epoch: 6 | loss: 0.2503159
	speed: 0.0215s/iter; left time: 102.0263s
	iters: 1100, epoch: 6 | loss: 0.2851183
	speed: 0.0217s/iter; left time: 100.4711s
Epoch: 6 cost time: 25.06295394897461
Epoch: 6, Steps: 1147 | Train Loss: 0.4071796 Vali Loss: 0.4213926 Test Loss: 0.1758225
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3347117
	speed: 0.0221s/iter; left time: 99.0230s
	iters: 200, epoch: 7 | loss: 0.3612397
	speed: 0.0217s/iter; left time: 95.3131s
	iters: 300, epoch: 7 | loss: 0.2031067
	speed: 0.0217s/iter; left time: 93.1574s
	iters: 400, epoch: 7 | loss: 0.4578412
	speed: 0.0218s/iter; left time: 91.4282s
	iters: 500, epoch: 7 | loss: 0.7106817
	speed: 0.0218s/iter; left time: 89.2098s
	iters: 600, epoch: 7 | loss: 0.6039520
	speed: 0.0219s/iter; left time: 87.2205s
	iters: 700, epoch: 7 | loss: 0.2498671
	speed: 0.0219s/iter; left time: 85.1165s
	iters: 800, epoch: 7 | loss: 0.3473424
	speed: 0.0219s/iter; left time: 83.0884s
	iters: 900, epoch: 7 | loss: 0.3749744
	speed: 0.0220s/iter; left time: 80.9845s
	iters: 1000, epoch: 7 | loss: 0.3765582
	speed: 0.0222s/iter; left time: 79.7240s
	iters: 1100, epoch: 7 | loss: 0.3243791
	speed: 0.0223s/iter; left time: 77.6365s
Epoch: 7 cost time: 25.902496576309204
Epoch: 7, Steps: 1147 | Train Loss: 0.4054013 Vali Loss: 0.4209037 Test Loss: 0.1754904
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2925505
	speed: 0.0213s/iter; left time: 71.1989s
	iters: 200, epoch: 8 | loss: 0.3002098
	speed: 0.0209s/iter; left time: 67.6846s
	iters: 300, epoch: 8 | loss: 0.2795580
	speed: 0.0220s/iter; left time: 68.9729s
	iters: 400, epoch: 8 | loss: 0.3931197
	speed: 0.0223s/iter; left time: 67.7272s
	iters: 500, epoch: 8 | loss: 0.3357269
	speed: 0.0225s/iter; left time: 66.2773s
	iters: 600, epoch: 8 | loss: 0.2462285
	speed: 0.0226s/iter; left time: 64.0947s
	iters: 700, epoch: 8 | loss: 0.2833529
	speed: 0.0225s/iter; left time: 61.6199s
	iters: 800, epoch: 8 | loss: 0.3232887
	speed: 0.0225s/iter; left time: 59.3167s
	iters: 900, epoch: 8 | loss: 0.2437944
	speed: 0.0228s/iter; left time: 57.9559s
	iters: 1000, epoch: 8 | loss: 0.2876987
	speed: 0.0230s/iter; left time: 56.2549s
	iters: 1100, epoch: 8 | loss: 0.3788432
	speed: 0.0232s/iter; left time: 54.2735s
Epoch: 8 cost time: 26.778793811798096
Epoch: 8, Steps: 1147 | Train Loss: 0.4044889 Vali Loss: 0.4214293 Test Loss: 0.1753716
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 1.1424011
	speed: 0.0262s/iter; left time: 57.4022s
	iters: 200, epoch: 9 | loss: 0.3354082
	speed: 0.0229s/iter; left time: 47.9756s
	iters: 300, epoch: 9 | loss: 0.2213367
	speed: 0.0251s/iter; left time: 50.0504s
	iters: 400, epoch: 9 | loss: 0.2325440
	speed: 0.0255s/iter; left time: 48.4051s
	iters: 500, epoch: 9 | loss: 0.2233682
	speed: 0.0248s/iter; left time: 44.5653s
	iters: 600, epoch: 9 | loss: 0.4599763
	speed: 0.0234s/iter; left time: 39.6958s
	iters: 700, epoch: 9 | loss: 0.2074662
	speed: 0.0224s/iter; left time: 35.7249s
	iters: 800, epoch: 9 | loss: 0.3875808
	speed: 0.0219s/iter; left time: 32.7781s
	iters: 900, epoch: 9 | loss: 0.9843944
	speed: 0.0217s/iter; left time: 30.3217s
	iters: 1000, epoch: 9 | loss: 0.3551064
	speed: 0.0215s/iter; left time: 27.8843s
	iters: 1100, epoch: 9 | loss: 0.2771402
	speed: 0.0214s/iter; left time: 25.5247s
Epoch: 9 cost time: 24.53034996986389
Epoch: 9, Steps: 1147 | Train Loss: 0.4040221 Vali Loss: 0.4215550 Test Loss: 0.1754861
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3056988
	speed: 0.0296s/iter; left time: 31.0235s
	iters: 200, epoch: 10 | loss: 0.2503199
	speed: 0.0246s/iter; left time: 23.3526s
	iters: 300, epoch: 10 | loss: 0.2723475
	speed: 0.0229s/iter; left time: 19.4287s
	iters: 400, epoch: 10 | loss: 0.3306779
	speed: 0.0230s/iter; left time: 17.1969s
	iters: 500, epoch: 10 | loss: 0.3078193
	speed: 0.0225s/iter; left time: 14.6093s
	iters: 600, epoch: 10 | loss: 0.2822485
	speed: 0.0223s/iter; left time: 12.2196s
	iters: 700, epoch: 10 | loss: 0.2607722
	speed: 0.0231s/iter; left time: 10.3515s
	iters: 800, epoch: 10 | loss: 1.0401560
	speed: 0.0240s/iter; left time: 8.3523s
	iters: 900, epoch: 10 | loss: 0.3419335
	speed: 0.0254s/iter; left time: 6.2936s
	iters: 1000, epoch: 10 | loss: 0.4100707
	speed: 0.0265s/iter; left time: 3.9208s
	iters: 1100, epoch: 10 | loss: 0.3391351
	speed: 0.0274s/iter; left time: 1.3150s
Epoch: 10 cost time: 31.948853731155396
Epoch: 10, Steps: 1147 | Train Loss: 0.4038494 Vali Loss: 0.4212320 Test Loss: 0.1753778
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.17530056834220886, mae:0.21763144433498383
Seed: 456
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_192      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip False
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.4993684
	speed: 0.0418s/iter; left time: 473.5563s
	iters: 200, epoch: 1 | loss: 0.3931815
	speed: 0.0329s/iter; left time: 370.3160s
	iters: 300, epoch: 1 | loss: 0.5145161
	speed: 0.0300s/iter; left time: 334.2146s
	iters: 400, epoch: 1 | loss: 0.5730253
	speed: 0.0286s/iter; left time: 315.8329s
	iters: 500, epoch: 1 | loss: 0.4349049
	speed: 0.0278s/iter; left time: 304.0276s
	iters: 600, epoch: 1 | loss: 0.4663244
	speed: 0.0273s/iter; left time: 295.4604s
	iters: 700, epoch: 1 | loss: 0.5054849
	speed: 0.0268s/iter; left time: 288.0662s
	iters: 800, epoch: 1 | loss: 0.4171346
	speed: 0.0272s/iter; left time: 289.0948s
	iters: 900, epoch: 1 | loss: 0.9069353
	speed: 0.0273s/iter; left time: 288.0059s
	iters: 1000, epoch: 1 | loss: 0.4589502
	speed: 0.0268s/iter; left time: 279.5477s
	iters: 1100, epoch: 1 | loss: 0.4547575
	speed: 0.0262s/iter; left time: 270.6150s
Epoch: 1 cost time: 29.505298137664795
Epoch: 1, Steps: 1144 | Train Loss: 0.5624898 Vali Loss: 0.5241206 Test Loss: 0.2335258
Validation loss decreased (inf --> 0.524121).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4785715
	speed: 0.0422s/iter; left time: 429.8565s
	iters: 200, epoch: 2 | loss: 0.4925945
	speed: 0.0400s/iter; left time: 404.0105s
	iters: 300, epoch: 2 | loss: 0.4156071
	speed: 0.0399s/iter; left time: 398.9054s
	iters: 400, epoch: 2 | loss: 0.4305559
	speed: 0.0390s/iter; left time: 385.8023s
	iters: 500, epoch: 2 | loss: 0.8820333
	speed: 0.0359s/iter; left time: 351.7115s
	iters: 600, epoch: 2 | loss: 0.4192134
	speed: 0.0337s/iter; left time: 326.6652s
	iters: 700, epoch: 2 | loss: 0.4146405
	speed: 0.0320s/iter; left time: 306.8617s
	iters: 800, epoch: 2 | loss: 0.4617179
	speed: 0.0304s/iter; left time: 288.3518s
	iters: 900, epoch: 2 | loss: 0.4507859
	speed: 0.0296s/iter; left time: 278.3139s
	iters: 1000, epoch: 2 | loss: 0.4448578
	speed: 0.0286s/iter; left time: 265.5682s
	iters: 1100, epoch: 2 | loss: 0.4447279
	speed: 0.0280s/iter; left time: 257.3117s
Epoch: 2 cost time: 31.898242950439453
Epoch: 2, Steps: 1144 | Train Loss: 0.5141666 Vali Loss: 0.4999354 Test Loss: 0.2259030
Validation loss decreased (0.524121 --> 0.499935).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.8796111
	speed: 0.0462s/iter; left time: 417.9489s
	iters: 200, epoch: 3 | loss: 0.3799426
	speed: 0.0371s/iter; left time: 332.2111s
	iters: 300, epoch: 3 | loss: 0.3712330
	speed: 0.0330s/iter; left time: 292.3209s
	iters: 400, epoch: 3 | loss: 0.4509926
	speed: 0.0310s/iter; left time: 270.9509s
	iters: 500, epoch: 3 | loss: 0.3424835
	speed: 0.0297s/iter; left time: 257.1557s
	iters: 600, epoch: 3 | loss: 0.4459679
	speed: 0.0288s/iter; left time: 246.2188s
	iters: 700, epoch: 3 | loss: 0.3786900
	speed: 0.0280s/iter; left time: 236.9965s
	iters: 800, epoch: 3 | loss: 0.5268260
	speed: 0.0274s/iter; left time: 228.5464s
	iters: 900, epoch: 3 | loss: 0.4623576
	speed: 0.0262s/iter; left time: 216.5919s
	iters: 1000, epoch: 3 | loss: 0.3572806
	speed: 0.0253s/iter; left time: 205.9288s
	iters: 1100, epoch: 3 | loss: 0.3612668
	speed: 0.0247s/iter; left time: 198.9195s
Epoch: 3 cost time: 28.15310525894165
Epoch: 3, Steps: 1144 | Train Loss: 0.4949081 Vali Loss: 0.4978891 Test Loss: 0.2228272
Validation loss decreased (0.499935 --> 0.497889).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4990600
	speed: 0.0364s/iter; left time: 288.0640s
	iters: 200, epoch: 4 | loss: 0.4002644
	speed: 0.0374s/iter; left time: 292.0950s
	iters: 300, epoch: 4 | loss: 0.4884360
	speed: 0.0373s/iter; left time: 287.8984s
	iters: 400, epoch: 4 | loss: 0.5882223
	speed: 0.0364s/iter; left time: 276.7979s
	iters: 500, epoch: 4 | loss: 0.3933927
	speed: 0.0335s/iter; left time: 251.8631s
	iters: 600, epoch: 4 | loss: 0.5075121
	speed: 0.0319s/iter; left time: 236.6405s
	iters: 700, epoch: 4 | loss: 0.3753787
	speed: 0.0298s/iter; left time: 217.9274s
	iters: 800, epoch: 4 | loss: 0.4873472
	speed: 0.0282s/iter; left time: 203.4368s
	iters: 900, epoch: 4 | loss: 0.6914307
	speed: 0.0271s/iter; left time: 192.4856s
	iters: 1000, epoch: 4 | loss: 0.3894578
	speed: 0.0264s/iter; left time: 185.3389s
	iters: 1100, epoch: 4 | loss: 0.4144975
	speed: 0.0258s/iter; left time: 178.5240s
Epoch: 4 cost time: 29.37560510635376
Epoch: 4, Steps: 1144 | Train Loss: 0.4844126 Vali Loss: 0.4933093 Test Loss: 0.2207230
Validation loss decreased (0.497889 --> 0.493309).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3285786
	speed: 0.0310s/iter; left time: 209.8093s
	iters: 200, epoch: 5 | loss: 0.5628231
	speed: 0.0281s/iter; left time: 187.2756s
	iters: 300, epoch: 5 | loss: 0.4310703
	speed: 0.0304s/iter; left time: 199.4333s
	iters: 400, epoch: 5 | loss: 0.7588504
	speed: 0.0309s/iter; left time: 199.9945s
	iters: 500, epoch: 5 | loss: 0.2716141
	speed: 0.0307s/iter; left time: 195.5268s
	iters: 600, epoch: 5 | loss: 0.3884218
	speed: 0.0291s/iter; left time: 182.3622s
	iters: 700, epoch: 5 | loss: 0.4226781
	speed: 0.0274s/iter; left time: 168.6266s
	iters: 800, epoch: 5 | loss: 0.3686661
	speed: 0.0274s/iter; left time: 166.3602s
	iters: 900, epoch: 5 | loss: 0.9499876
	speed: 0.0267s/iter; left time: 159.3619s
	iters: 1000, epoch: 5 | loss: 0.3625347
	speed: 0.0264s/iter; left time: 154.5784s
	iters: 1100, epoch: 5 | loss: 0.7977717
	speed: 0.0260s/iter; left time: 149.6140s
Epoch: 5 cost time: 29.72444462776184
Epoch: 5, Steps: 1144 | Train Loss: 0.4780604 Vali Loss: 0.4935971 Test Loss: 0.2203107
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3976768
	speed: 0.0402s/iter; left time: 226.2221s
	iters: 200, epoch: 6 | loss: 0.2784188
	speed: 0.0349s/iter; left time: 192.8875s
	iters: 300, epoch: 6 | loss: 0.5606749
	speed: 0.0310s/iter; left time: 168.1603s
	iters: 400, epoch: 6 | loss: 0.4516441
	speed: 0.0298s/iter; left time: 158.6244s
	iters: 500, epoch: 6 | loss: 0.3604950
	speed: 0.0300s/iter; left time: 156.4183s
	iters: 600, epoch: 6 | loss: 0.8273715
	speed: 0.0288s/iter; left time: 147.6878s
	iters: 700, epoch: 6 | loss: 0.3864113
	speed: 0.0279s/iter; left time: 140.1004s
	iters: 800, epoch: 6 | loss: 0.4376475
	speed: 0.0273s/iter; left time: 134.4315s
	iters: 900, epoch: 6 | loss: 0.4274044
	speed: 0.0268s/iter; left time: 129.2297s
	iters: 1000, epoch: 6 | loss: 0.3583853
	speed: 0.0263s/iter; left time: 123.9497s
	iters: 1100, epoch: 6 | loss: 0.3858969
	speed: 0.0257s/iter; left time: 118.6514s
Epoch: 6 cost time: 29.259652137756348
Epoch: 6, Steps: 1144 | Train Loss: 0.4748494 Vali Loss: 0.4936697 Test Loss: 0.2198189
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3833357
	speed: 0.0395s/iter; left time: 176.9066s
	iters: 200, epoch: 7 | loss: 0.4137523
	speed: 0.0378s/iter; left time: 165.6011s
	iters: 300, epoch: 7 | loss: 0.4988422
	speed: 0.0364s/iter; left time: 155.8542s
	iters: 400, epoch: 7 | loss: 0.8642966
	speed: 0.0356s/iter; left time: 148.8622s
	iters: 500, epoch: 7 | loss: 0.2752269
	speed: 0.0354s/iter; left time: 144.3016s
	iters: 600, epoch: 7 | loss: 0.4919166
	speed: 0.0336s/iter; left time: 133.5699s
	iters: 700, epoch: 7 | loss: 0.4306796
	speed: 0.0323s/iter; left time: 125.0350s
	iters: 800, epoch: 7 | loss: 0.3620216
	speed: 0.0313s/iter; left time: 118.3153s
	iters: 900, epoch: 7 | loss: 0.3057366
	speed: 0.0304s/iter; left time: 111.6506s
	iters: 1000, epoch: 7 | loss: 0.3761016
	speed: 0.0296s/iter; left time: 105.7569s
	iters: 1100, epoch: 7 | loss: 0.3662947
	speed: 0.0286s/iter; left time: 99.3036s
Epoch: 7 cost time: 32.24221849441528
Epoch: 7, Steps: 1144 | Train Loss: 0.4729807 Vali Loss: 0.4928513 Test Loss: 0.2198116
Validation loss decreased (0.493309 --> 0.492851).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.8785201
	speed: 0.0308s/iter; left time: 102.5567s
	iters: 200, epoch: 8 | loss: 0.3576519
	speed: 0.0300s/iter; left time: 96.9712s
	iters: 300, epoch: 8 | loss: 0.4094508
	speed: 0.0279s/iter; left time: 87.2615s
	iters: 400, epoch: 8 | loss: 0.5152277
	speed: 0.0266s/iter; left time: 80.5376s
	iters: 500, epoch: 8 | loss: 0.4142091
	speed: 0.0258s/iter; left time: 75.7436s
	iters: 600, epoch: 8 | loss: 0.3956249
	speed: 0.0255s/iter; left time: 72.3403s
	iters: 700, epoch: 8 | loss: 0.3119625
	speed: 0.0256s/iter; left time: 69.9683s
	iters: 800, epoch: 8 | loss: 0.3789848
	speed: 0.0256s/iter; left time: 67.4009s
	iters: 900, epoch: 8 | loss: 0.7952691
	speed: 0.0256s/iter; left time: 64.8345s
	iters: 1000, epoch: 8 | loss: 0.8313079
	speed: 0.0253s/iter; left time: 61.5966s
	iters: 1100, epoch: 8 | loss: 0.2772555
	speed: 0.0252s/iter; left time: 58.6832s
Epoch: 8 cost time: 28.806299209594727
Epoch: 8, Steps: 1144 | Train Loss: 0.4719207 Vali Loss: 0.4936399 Test Loss: 0.2197766
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4312399
	speed: 0.0368s/iter; left time: 80.5363s
	iters: 200, epoch: 9 | loss: 0.4534550
	speed: 0.0321s/iter; left time: 67.1325s
	iters: 300, epoch: 9 | loss: 0.4967788
	speed: 0.0312s/iter; left time: 61.9923s
	iters: 400, epoch: 9 | loss: 0.3657158
	speed: 0.0312s/iter; left time: 58.9189s
	iters: 500, epoch: 9 | loss: 0.4305217
	speed: 0.0308s/iter; left time: 55.0797s
	iters: 600, epoch: 9 | loss: 0.3420553
	speed: 0.0297s/iter; left time: 50.2162s
	iters: 700, epoch: 9 | loss: 0.4495687
	speed: 0.0290s/iter; left time: 46.0252s
	iters: 800, epoch: 9 | loss: 0.4494470
	speed: 0.0284s/iter; left time: 42.2806s
	iters: 900, epoch: 9 | loss: 0.3816400
	speed: 0.0288s/iter; left time: 40.0643s
	iters: 1000, epoch: 9 | loss: 0.3696254
	speed: 0.0283s/iter; left time: 36.4587s
	iters: 1100, epoch: 9 | loss: 0.5562083
	speed: 0.0278s/iter; left time: 33.0663s
Epoch: 9 cost time: 31.733888864517212
Epoch: 9, Steps: 1144 | Train Loss: 0.4714637 Vali Loss: 0.4932621 Test Loss: 0.2198084
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3378495
	speed: 0.0417s/iter; left time: 43.5666s
	iters: 200, epoch: 10 | loss: 0.4774246
	speed: 0.0347s/iter; left time: 32.8323s
	iters: 300, epoch: 10 | loss: 0.3453222
	speed: 0.0309s/iter; left time: 26.1190s
	iters: 400, epoch: 10 | loss: 0.2975662
	speed: 0.0289s/iter; left time: 21.4991s
	iters: 500, epoch: 10 | loss: 0.4822627
	speed: 0.0276s/iter; left time: 17.7831s
	iters: 600, epoch: 10 | loss: 0.7910033
	speed: 0.0267s/iter; left time: 14.5546s
	iters: 700, epoch: 10 | loss: 0.3834338
	speed: 0.0263s/iter; left time: 11.7232s
	iters: 800, epoch: 10 | loss: 0.4398094
	speed: 0.0261s/iter; left time: 9.0039s
	iters: 900, epoch: 10 | loss: 0.3354818
	speed: 0.0259s/iter; left time: 6.3524s
	iters: 1000, epoch: 10 | loss: 0.3467224
	speed: 0.0258s/iter; left time: 3.7432s
	iters: 1100, epoch: 10 | loss: 0.3645537
	speed: 0.0265s/iter; left time: 1.1932s
Epoch: 10 cost time: 30.312670707702637
Epoch: 10, Steps: 1144 | Train Loss: 0.4712418 Vali Loss: 0.4933717 Test Loss: 0.2198277
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.2198115438222885, mae:0.25690948963165283
Use GPU: cuda:0
no_skip False
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 1.5059216
	speed: 0.0282s/iter; left time: 319.5395s
	iters: 200, epoch: 1 | loss: 0.3874804
	speed: 0.0260s/iter; left time: 291.9941s
	iters: 300, epoch: 1 | loss: 0.4164400
	speed: 0.0247s/iter; left time: 275.7102s
	iters: 400, epoch: 1 | loss: 0.4923573
	speed: 0.0241s/iter; left time: 266.0995s
	iters: 500, epoch: 1 | loss: 0.9870996
	speed: 0.0238s/iter; left time: 259.9321s
	iters: 600, epoch: 1 | loss: 0.5683038
	speed: 0.0238s/iter; left time: 257.7554s
	iters: 700, epoch: 1 | loss: 0.3917226
	speed: 0.0240s/iter; left time: 257.4607s
	iters: 800, epoch: 1 | loss: 0.3949663
	speed: 0.0241s/iter; left time: 256.3560s
	iters: 900, epoch: 1 | loss: 0.6031173
	speed: 0.0240s/iter; left time: 252.8901s
	iters: 1000, epoch: 1 | loss: 0.4175179
	speed: 0.0238s/iter; left time: 248.4552s
	iters: 1100, epoch: 1 | loss: 0.3560717
	speed: 0.0233s/iter; left time: 241.3238s
Epoch: 1 cost time: 26.593865394592285
Epoch: 1, Steps: 1144 | Train Loss: 0.5605517 Vali Loss: 0.5133868 Test Loss: 0.2323993
Validation loss decreased (inf --> 0.513387).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4544012
	speed: 0.0389s/iter; left time: 397.0122s
	iters: 200, epoch: 2 | loss: 0.5175291
	speed: 0.0317s/iter; left time: 320.1032s
	iters: 300, epoch: 2 | loss: 0.3925724
	speed: 0.0319s/iter; left time: 318.8568s
	iters: 400, epoch: 2 | loss: 0.4405402
	speed: 0.0333s/iter; left time: 329.8218s
	iters: 500, epoch: 2 | loss: 0.8978730
	speed: 0.0334s/iter; left time: 326.9092s
	iters: 600, epoch: 2 | loss: 0.4570625
	speed: 0.0319s/iter; left time: 309.5343s
	iters: 700, epoch: 2 | loss: 0.8443554
	speed: 0.0308s/iter; left time: 296.0188s
	iters: 800, epoch: 2 | loss: 0.3857474
	speed: 0.0298s/iter; left time: 282.8761s
	iters: 900, epoch: 2 | loss: 0.4396389
	speed: 0.0287s/iter; left time: 269.7406s
	iters: 1000, epoch: 2 | loss: 0.3774556
	speed: 0.0277s/iter; left time: 257.9674s
	iters: 1100, epoch: 2 | loss: 0.5388138
	speed: 0.0271s/iter; left time: 248.8407s
Epoch: 2 cost time: 30.846715688705444
Epoch: 2, Steps: 1144 | Train Loss: 0.5159212 Vali Loss: 0.4964699 Test Loss: 0.2273732
Validation loss decreased (0.513387 --> 0.496470).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3109070
	speed: 0.0322s/iter; left time: 291.1347s
	iters: 200, epoch: 3 | loss: 0.5139226
	speed: 0.0275s/iter; left time: 246.0325s
	iters: 300, epoch: 3 | loss: 0.3267911
	speed: 0.0259s/iter; left time: 228.9990s
	iters: 400, epoch: 3 | loss: 0.5317131
	speed: 0.0251s/iter; left time: 219.7185s
	iters: 500, epoch: 3 | loss: 0.7724894
	speed: 0.0247s/iter; left time: 213.9444s
	iters: 600, epoch: 3 | loss: 0.9996075
	speed: 0.0245s/iter; left time: 209.3503s
	iters: 700, epoch: 3 | loss: 0.7976643
	speed: 0.0238s/iter; left time: 201.3606s
	iters: 800, epoch: 3 | loss: 0.3678777
	speed: 0.0230s/iter; left time: 192.1579s
	iters: 900, epoch: 3 | loss: 0.3339458
	speed: 0.0227s/iter; left time: 187.3181s
	iters: 1000, epoch: 3 | loss: 0.3730771
	speed: 0.0225s/iter; left time: 183.5513s
	iters: 1100, epoch: 3 | loss: 0.3501589
	speed: 0.0219s/iter; left time: 176.7003s
Epoch: 3 cost time: 24.879241943359375
Epoch: 3, Steps: 1144 | Train Loss: 0.4958431 Vali Loss: 0.4903183 Test Loss: 0.2237653
Validation loss decreased (0.496470 --> 0.490318).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5537733
	speed: 0.0249s/iter; left time: 197.1007s
	iters: 200, epoch: 4 | loss: 0.3864942
	speed: 0.0238s/iter; left time: 185.8972s
	iters: 300, epoch: 4 | loss: 0.4054250
	speed: 0.0234s/iter; left time: 180.7097s
	iters: 400, epoch: 4 | loss: 0.4436270
	speed: 0.0233s/iter; left time: 176.9796s
	iters: 500, epoch: 4 | loss: 0.8889102
	speed: 0.0231s/iter; left time: 173.8007s
	iters: 600, epoch: 4 | loss: 0.4029940
	speed: 0.0229s/iter; left time: 169.6651s
	iters: 700, epoch: 4 | loss: 0.3673467
	speed: 0.0224s/iter; left time: 164.0762s
	iters: 800, epoch: 4 | loss: 0.4497905
	speed: 0.0222s/iter; left time: 159.7128s
	iters: 900, epoch: 4 | loss: 0.4598723
	speed: 0.0220s/iter; left time: 156.1611s
	iters: 1000, epoch: 4 | loss: 0.8513724
	speed: 0.0220s/iter; left time: 154.4735s
	iters: 1100, epoch: 4 | loss: 0.4797259
	speed: 0.0219s/iter; left time: 151.3128s
Epoch: 4 cost time: 25.05318260192871
Epoch: 4, Steps: 1144 | Train Loss: 0.4867994 Vali Loss: 0.4883907 Test Loss: 0.2237469
Validation loss decreased (0.490318 --> 0.488391).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.8583411
	speed: 0.0250s/iter; left time: 169.1614s
	iters: 200, epoch: 5 | loss: 0.4330175
	speed: 0.0239s/iter; left time: 159.1476s
	iters: 300, epoch: 5 | loss: 0.8055786
	speed: 0.0235s/iter; left time: 154.2172s
	iters: 400, epoch: 5 | loss: 0.4157675
	speed: 0.0233s/iter; left time: 150.6045s
	iters: 500, epoch: 5 | loss: 0.4132555
	speed: 0.0232s/iter; left time: 147.5838s
	iters: 600, epoch: 5 | loss: 0.7729447
	speed: 0.0229s/iter; left time: 143.1628s
	iters: 700, epoch: 5 | loss: 0.4022637
	speed: 0.0224s/iter; left time: 138.0620s
	iters: 800, epoch: 5 | loss: 0.3941402
	speed: 0.0221s/iter; left time: 134.1085s
	iters: 900, epoch: 5 | loss: 0.4242271
	speed: 0.0220s/iter; left time: 131.1552s
	iters: 1000, epoch: 5 | loss: 0.3843429
	speed: 0.0221s/iter; left time: 129.3434s
	iters: 1100, epoch: 5 | loss: 0.9432070
	speed: 0.0219s/iter; left time: 126.1767s
Epoch: 5 cost time: 25.042474269866943
Epoch: 5, Steps: 1144 | Train Loss: 0.4807180 Vali Loss: 0.4869909 Test Loss: 0.2228827
Validation loss decreased (0.488391 --> 0.486991).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3978158
	speed: 0.0249s/iter; left time: 140.1039s
	iters: 200, epoch: 6 | loss: 0.3399752
	speed: 0.0238s/iter; left time: 131.6192s
	iters: 300, epoch: 6 | loss: 0.4233150
	speed: 0.0235s/iter; left time: 127.1949s
	iters: 400, epoch: 6 | loss: 0.3274095
	speed: 0.0233s/iter; left time: 123.8483s
	iters: 500, epoch: 6 | loss: 0.3629281
	speed: 0.0232s/iter; left time: 120.9759s
	iters: 600, epoch: 6 | loss: 0.3817298
	speed: 0.0228s/iter; left time: 116.6595s
	iters: 700, epoch: 6 | loss: 1.2372490
	speed: 0.0223s/iter; left time: 112.1763s
	iters: 800, epoch: 6 | loss: 0.3030420
	speed: 0.0221s/iter; left time: 108.6389s
	iters: 900, epoch: 6 | loss: 0.3337015
	speed: 0.0218s/iter; left time: 105.1360s
	iters: 1000, epoch: 6 | loss: 0.3189565
	speed: 0.0216s/iter; left time: 102.1977s
	iters: 1100, epoch: 6 | loss: 0.3198945
	speed: 0.0211s/iter; left time: 97.6810s
Epoch: 6 cost time: 24.179752111434937
Epoch: 6, Steps: 1144 | Train Loss: 0.4777467 Vali Loss: 0.4872698 Test Loss: 0.2224136
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4190351
	speed: 0.0195s/iter; left time: 87.2350s
	iters: 200, epoch: 7 | loss: 0.3091134
	speed: 0.0184s/iter; left time: 80.6488s
	iters: 300, epoch: 7 | loss: 0.4464455
	speed: 0.0182s/iter; left time: 77.9825s
	iters: 400, epoch: 7 | loss: 0.4029703
	speed: 0.0194s/iter; left time: 80.9162s
	iters: 500, epoch: 7 | loss: 0.4440833
	speed: 0.0201s/iter; left time: 81.8763s
	iters: 600, epoch: 7 | loss: 0.4013647
	speed: 0.0206s/iter; left time: 81.7856s
	iters: 700, epoch: 7 | loss: 0.4003969
	speed: 0.0209s/iter; left time: 81.0292s
	iters: 800, epoch: 7 | loss: 0.4158606
	speed: 0.0209s/iter; left time: 78.9924s
	iters: 900, epoch: 7 | loss: 0.3642285
	speed: 0.0208s/iter; left time: 76.4138s
	iters: 1000, epoch: 7 | loss: 0.3939253
	speed: 0.0206s/iter; left time: 73.7195s
	iters: 1100, epoch: 7 | loss: 0.3743656
	speed: 0.0204s/iter; left time: 70.8371s
Epoch: 7 cost time: 23.37536358833313
Epoch: 7, Steps: 1144 | Train Loss: 0.4759082 Vali Loss: 0.4867589 Test Loss: 0.2223433
Validation loss decreased (0.486991 --> 0.486759).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3472233
	speed: 0.0248s/iter; left time: 82.5476s
	iters: 200, epoch: 8 | loss: 0.2807505
	speed: 0.0237s/iter; left time: 76.7766s
	iters: 300, epoch: 8 | loss: 0.3251590
	speed: 0.0234s/iter; left time: 73.3042s
	iters: 400, epoch: 8 | loss: 0.4033318
	speed: 0.0232s/iter; left time: 70.4259s
	iters: 500, epoch: 8 | loss: 0.3829821
	speed: 0.0231s/iter; left time: 67.8184s
	iters: 600, epoch: 8 | loss: 0.2848080
	speed: 0.0230s/iter; left time: 65.2991s
	iters: 700, epoch: 8 | loss: 0.4351664
	speed: 0.0230s/iter; left time: 62.8541s
	iters: 800, epoch: 8 | loss: 0.3773909
	speed: 0.0227s/iter; left time: 59.7430s
	iters: 900, epoch: 8 | loss: 0.3399079
	speed: 0.0224s/iter; left time: 56.6354s
	iters: 1000, epoch: 8 | loss: 1.1564814
	speed: 0.0221s/iter; left time: 53.6880s
	iters: 1100, epoch: 8 | loss: 0.3721978
	speed: 0.0218s/iter; left time: 50.8163s
Epoch: 8 cost time: 24.969526290893555
Epoch: 8, Steps: 1144 | Train Loss: 0.4749961 Vali Loss: 0.4871581 Test Loss: 0.2221108
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3790080
	speed: 0.0247s/iter; left time: 54.1437s
	iters: 200, epoch: 9 | loss: 0.3319397
	speed: 0.0237s/iter; left time: 49.5027s
	iters: 300, epoch: 9 | loss: 0.3694397
	speed: 0.0234s/iter; left time: 46.4469s
	iters: 400, epoch: 9 | loss: 0.4491149
	speed: 0.0232s/iter; left time: 43.8084s
	iters: 500, epoch: 9 | loss: 0.7805625
	speed: 0.0231s/iter; left time: 41.3001s
	iters: 600, epoch: 9 | loss: 0.3931955
	speed: 0.0230s/iter; left time: 38.8732s
	iters: 700, epoch: 9 | loss: 0.3072264
	speed: 0.0230s/iter; left time: 36.5013s
	iters: 800, epoch: 9 | loss: 0.3040879
	speed: 0.0227s/iter; left time: 33.7594s
	iters: 900, epoch: 9 | loss: 0.4827584
	speed: 0.0223s/iter; left time: 31.0196s
	iters: 1000, epoch: 9 | loss: 0.8686101
	speed: 0.0220s/iter; left time: 28.3651s
	iters: 1100, epoch: 9 | loss: 0.3882433
	speed: 0.0216s/iter; left time: 25.7037s
Epoch: 9 cost time: 24.73679280281067
Epoch: 9, Steps: 1144 | Train Loss: 0.4745405 Vali Loss: 0.4867536 Test Loss: 0.2223756
Validation loss decreased (0.486759 --> 0.486754).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.8825554
	speed: 0.0248s/iter; left time: 25.9225s
	iters: 200, epoch: 10 | loss: 0.4336584
	speed: 0.0229s/iter; left time: 21.6346s
	iters: 300, epoch: 10 | loss: 0.5060100
	speed: 0.0213s/iter; left time: 18.0325s
	iters: 400, epoch: 10 | loss: 0.3476684
	speed: 0.0203s/iter; left time: 15.1042s
	iters: 500, epoch: 10 | loss: 0.4876587
	speed: 0.0197s/iter; left time: 12.7023s
	iters: 600, epoch: 10 | loss: 0.3963552
	speed: 0.0193s/iter; left time: 10.5220s
	iters: 700, epoch: 10 | loss: 0.4478945
	speed: 0.0193s/iter; left time: 8.5840s
	iters: 800, epoch: 10 | loss: 0.8192263
	speed: 0.0195s/iter; left time: 6.7144s
	iters: 900, epoch: 10 | loss: 0.4491492
	speed: 0.0195s/iter; left time: 4.7741s
	iters: 1000, epoch: 10 | loss: 0.3114368
	speed: 0.0194s/iter; left time: 2.8183s
	iters: 1100, epoch: 10 | loss: 0.4005769
	speed: 0.0193s/iter; left time: 0.8682s
Epoch: 10 cost time: 22.203032732009888
Epoch: 10, Steps: 1144 | Train Loss: 0.4744410 Vali Loss: 0.4871987 Test Loss: 0.2222534
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.2223755419254303, mae:0.2589038014411926
Use GPU: cuda:0
no_skip False
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.5681741
	speed: 0.0249s/iter; left time: 282.3971s
	iters: 200, epoch: 1 | loss: 0.4382320
	speed: 0.0238s/iter; left time: 267.5429s
	iters: 300, epoch: 1 | loss: 0.6033205
	speed: 0.0235s/iter; left time: 261.2597s
	iters: 400, epoch: 1 | loss: 0.4345422
	speed: 0.0233s/iter; left time: 256.8407s
	iters: 500, epoch: 1 | loss: 0.4490196
	speed: 0.0232s/iter; left time: 253.2855s
	iters: 600, epoch: 1 | loss: 0.3951067
	speed: 0.0226s/iter; left time: 245.1348s
	iters: 700, epoch: 1 | loss: 0.5403097
	speed: 0.0222s/iter; left time: 238.5315s
	iters: 800, epoch: 1 | loss: 0.9237641
	speed: 0.0217s/iter; left time: 230.8931s
	iters: 900, epoch: 1 | loss: 0.3645633
	speed: 0.0214s/iter; left time: 225.2749s
	iters: 1000, epoch: 1 | loss: 0.7000806
	speed: 0.0213s/iter; left time: 221.9296s
	iters: 1100, epoch: 1 | loss: 0.4802263
	speed: 0.0212s/iter; left time: 219.5134s
Epoch: 1 cost time: 24.49091386795044
Epoch: 1, Steps: 1144 | Train Loss: 0.5594011 Vali Loss: 0.5301598 Test Loss: 0.2361085
Validation loss decreased (inf --> 0.530160).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5007971
	speed: 0.0249s/iter; left time: 253.9706s
	iters: 200, epoch: 2 | loss: 0.4120315
	speed: 0.0238s/iter; left time: 240.5232s
	iters: 300, epoch: 2 | loss: 0.4957824
	speed: 0.0234s/iter; left time: 234.4093s
	iters: 400, epoch: 2 | loss: 0.3935087
	speed: 0.0233s/iter; left time: 230.2024s
	iters: 500, epoch: 2 | loss: 0.4407703
	speed: 0.0232s/iter; left time: 226.8593s
	iters: 600, epoch: 2 | loss: 0.8282397
	speed: 0.0227s/iter; left time: 219.8977s
	iters: 700, epoch: 2 | loss: 0.4324109
	speed: 0.0223s/iter; left time: 213.6624s
	iters: 800, epoch: 2 | loss: 0.3831059
	speed: 0.0218s/iter; left time: 206.7051s
	iters: 900, epoch: 2 | loss: 0.5236149
	speed: 0.0214s/iter; left time: 200.6752s
	iters: 1000, epoch: 2 | loss: 0.4799174
	speed: 0.0212s/iter; left time: 197.5021s
	iters: 1100, epoch: 2 | loss: 0.7902523
	speed: 0.0211s/iter; left time: 193.9677s
Epoch: 2 cost time: 24.163342475891113
Epoch: 2, Steps: 1144 | Train Loss: 0.5128106 Vali Loss: 0.5054960 Test Loss: 0.2287820
Validation loss decreased (0.530160 --> 0.505496).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4195120
	speed: 0.0206s/iter; left time: 186.6227s
	iters: 200, epoch: 3 | loss: 0.3612198
	speed: 0.0192s/iter; left time: 171.9948s
	iters: 300, epoch: 3 | loss: 0.8150876
	speed: 0.0194s/iter; left time: 171.4009s
	iters: 400, epoch: 3 | loss: 0.4473102
	speed: 0.0189s/iter; left time: 165.5307s
	iters: 500, epoch: 3 | loss: 0.3574836
	speed: 0.0184s/iter; left time: 159.2309s
	iters: 600, epoch: 3 | loss: 0.8192865
	speed: 0.0178s/iter; left time: 151.9853s
	iters: 700, epoch: 3 | loss: 0.4201125
	speed: 0.0174s/iter; left time: 146.7800s
	iters: 800, epoch: 3 | loss: 0.4116904
	speed: 0.0173s/iter; left time: 144.1751s
	iters: 900, epoch: 3 | loss: 0.4540132
	speed: 0.0178s/iter; left time: 147.1921s
	iters: 1000, epoch: 3 | loss: 0.3609716
	speed: 0.0183s/iter; left time: 149.5697s
	iters: 1100, epoch: 3 | loss: 0.3821447
	speed: 0.0188s/iter; left time: 151.0780s
Epoch: 3 cost time: 21.786027193069458
Epoch: 3, Steps: 1144 | Train Loss: 0.4931515 Vali Loss: 0.4938801 Test Loss: 0.2245860
Validation loss decreased (0.505496 --> 0.493880).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.9197880
	speed: 0.0219s/iter; left time: 173.2535s
	iters: 200, epoch: 4 | loss: 0.4328703
	speed: 0.0209s/iter; left time: 162.9775s
	iters: 300, epoch: 4 | loss: 0.3707996
	speed: 0.0205s/iter; left time: 157.7416s
	iters: 400, epoch: 4 | loss: 0.3122123
	speed: 0.0210s/iter; left time: 160.0500s
	iters: 500, epoch: 4 | loss: 0.3848951
	speed: 0.0214s/iter; left time: 160.7119s
	iters: 600, epoch: 4 | loss: 0.3905598
	speed: 0.0212s/iter; left time: 156.8143s
	iters: 700, epoch: 4 | loss: 0.3718243
	speed: 0.0210s/iter; left time: 153.2066s
	iters: 800, epoch: 4 | loss: 0.3624392
	speed: 0.0208s/iter; left time: 150.1500s
	iters: 900, epoch: 4 | loss: 0.4767794
	speed: 0.0210s/iter; left time: 149.3536s
	iters: 1000, epoch: 4 | loss: 0.3723225
	speed: 0.0212s/iter; left time: 148.7000s
	iters: 1100, epoch: 4 | loss: 0.2989200
	speed: 0.0214s/iter; left time: 147.7925s
Epoch: 4 cost time: 24.655091047286987
Epoch: 4, Steps: 1144 | Train Loss: 0.4826900 Vali Loss: 0.4908209 Test Loss: 0.2225941
Validation loss decreased (0.493880 --> 0.490821).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3885485
	speed: 0.0226s/iter; left time: 152.6666s
	iters: 200, epoch: 5 | loss: 0.5564845
	speed: 0.0213s/iter; left time: 142.2852s
	iters: 300, epoch: 5 | loss: 0.8092647
	speed: 0.0210s/iter; left time: 137.6687s
	iters: 400, epoch: 5 | loss: 0.3224770
	speed: 0.0214s/iter; left time: 138.5055s
	iters: 500, epoch: 5 | loss: 0.3204959
	speed: 0.0217s/iter; left time: 137.8411s
	iters: 600, epoch: 5 | loss: 0.3153804
	speed: 0.0213s/iter; left time: 133.6545s
	iters: 700, epoch: 5 | loss: 0.3888792
	speed: 0.0211s/iter; left time: 130.1996s
	iters: 800, epoch: 5 | loss: 0.5189681
	speed: 0.0210s/iter; left time: 127.1002s
	iters: 900, epoch: 5 | loss: 0.3436421
	speed: 0.0211s/iter; left time: 126.0757s
	iters: 1000, epoch: 5 | loss: 0.3751293
	speed: 0.0213s/iter; left time: 124.9252s
	iters: 1100, epoch: 5 | loss: 0.2938675
	speed: 0.0214s/iter; left time: 123.5537s
Epoch: 5 cost time: 24.700066804885864
Epoch: 5, Steps: 1144 | Train Loss: 0.4770783 Vali Loss: 0.4893136 Test Loss: 0.2213692
Validation loss decreased (0.490821 --> 0.489314).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3671554
	speed: 0.0222s/iter; left time: 124.6839s
	iters: 200, epoch: 6 | loss: 0.4034256
	speed: 0.0212s/iter; left time: 116.7819s
	iters: 300, epoch: 6 | loss: 0.3664578
	speed: 0.0209s/iter; left time: 113.3789s
	iters: 400, epoch: 6 | loss: 0.4059613
	speed: 0.0214s/iter; left time: 113.7523s
	iters: 500, epoch: 6 | loss: 0.3991098
	speed: 0.0216s/iter; left time: 112.7340s
	iters: 600, epoch: 6 | loss: 0.3549516
	speed: 0.0213s/iter; left time: 108.9595s
	iters: 700, epoch: 6 | loss: 0.4125209
	speed: 0.0204s/iter; left time: 102.6765s
	iters: 800, epoch: 6 | loss: 0.4471041
	speed: 0.0197s/iter; left time: 96.7601s
	iters: 900, epoch: 6 | loss: 0.3327549
	speed: 0.0191s/iter; left time: 92.1896s
	iters: 1000, epoch: 6 | loss: 0.3942391
	speed: 0.0187s/iter; left time: 88.2352s
	iters: 1100, epoch: 6 | loss: 0.3828118
	speed: 0.0182s/iter; left time: 84.1598s
Epoch: 6 cost time: 20.59904718399048
Epoch: 6, Steps: 1144 | Train Loss: 0.4737323 Vali Loss: 0.4883628 Test Loss: 0.2213982
Validation loss decreased (0.489314 --> 0.488363).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3624167
	speed: 0.0102s/iter; left time: 45.7018s
	iters: 200, epoch: 7 | loss: 0.9148703
	speed: 0.0103s/iter; left time: 45.1251s
	iters: 300, epoch: 7 | loss: 0.4129877
	speed: 0.0095s/iter; left time: 40.5711s
	iters: 400, epoch: 7 | loss: 0.4949530
	speed: 0.0105s/iter; left time: 43.7672s
	iters: 500, epoch: 7 | loss: 0.5518154
	speed: 0.0114s/iter; left time: 46.2783s
	iters: 600, epoch: 7 | loss: 0.4761946
	speed: 0.0132s/iter; left time: 52.4982s
	iters: 700, epoch: 7 | loss: 0.5150614
	speed: 0.0146s/iter; left time: 56.4952s
	iters: 800, epoch: 7 | loss: 0.4267666
	speed: 0.0156s/iter; left time: 58.9460s
	iters: 900, epoch: 7 | loss: 0.3102036
	speed: 0.0164s/iter; left time: 60.3258s
	iters: 1000, epoch: 7 | loss: 0.3600979
	speed: 0.0170s/iter; left time: 60.9731s
	iters: 1100, epoch: 7 | loss: 0.3451713
	speed: 0.0176s/iter; left time: 61.1027s
Epoch: 7 cost time: 20.478217601776123
Epoch: 7, Steps: 1144 | Train Loss: 0.4722427 Vali Loss: 0.4884206 Test Loss: 0.2211809
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4820193
	speed: 0.0212s/iter; left time: 70.8061s
	iters: 200, epoch: 8 | loss: 0.3474987
	speed: 0.0191s/iter; left time: 61.7132s
	iters: 300, epoch: 8 | loss: 0.3076138
	speed: 0.0187s/iter; left time: 58.4398s
	iters: 400, epoch: 8 | loss: 0.4083984
	speed: 0.0190s/iter; left time: 57.5557s
	iters: 500, epoch: 8 | loss: 0.2871988
	speed: 0.0198s/iter; left time: 57.9292s
	iters: 600, epoch: 8 | loss: 0.8678220
	speed: 0.0203s/iter; left time: 57.3989s
	iters: 700, epoch: 8 | loss: 0.3538274
	speed: 0.0206s/iter; left time: 56.3538s
	iters: 800, epoch: 8 | loss: 0.3760166
	speed: 0.0209s/iter; left time: 55.0251s
	iters: 900, epoch: 8 | loss: 0.3992520
	speed: 0.0211s/iter; left time: 53.4743s
	iters: 1000, epoch: 8 | loss: 0.4208603
	speed: 0.0213s/iter; left time: 51.7762s
	iters: 1100, epoch: 8 | loss: 0.4531890
	speed: 0.0214s/iter; left time: 49.9806s
Epoch: 8 cost time: 24.678998470306396
Epoch: 8, Steps: 1144 | Train Loss: 0.4712630 Vali Loss: 0.4881382 Test Loss: 0.2212106
Validation loss decreased (0.488363 --> 0.488138).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3480529
	speed: 0.0209s/iter; left time: 45.8245s
	iters: 200, epoch: 9 | loss: 0.4428302
	speed: 0.0189s/iter; left time: 39.5592s
	iters: 300, epoch: 9 | loss: 0.4213180
	speed: 0.0185s/iter; left time: 36.7016s
	iters: 400, epoch: 9 | loss: 0.4342101
	speed: 0.0188s/iter; left time: 35.5766s
	iters: 500, epoch: 9 | loss: 0.3656419
	speed: 0.0196s/iter; left time: 35.1268s
	iters: 600, epoch: 9 | loss: 0.3875351
	speed: 0.0202s/iter; left time: 34.0572s
	iters: 700, epoch: 9 | loss: 0.3750519
	speed: 0.0205s/iter; left time: 32.6462s
	iters: 800, epoch: 9 | loss: 0.3520681
	speed: 0.0208s/iter; left time: 31.0186s
	iters: 900, epoch: 9 | loss: 0.4109994
	speed: 0.0211s/iter; left time: 29.2409s
	iters: 1000, epoch: 9 | loss: 0.4012246
	speed: 0.0212s/iter; left time: 27.3652s
	iters: 1100, epoch: 9 | loss: 0.3556809
	speed: 0.0214s/iter; left time: 25.4161s
Epoch: 9 cost time: 24.650230407714844
Epoch: 9, Steps: 1144 | Train Loss: 0.4707994 Vali Loss: 0.4881773 Test Loss: 0.2213952
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.4031991
	speed: 0.0209s/iter; left time: 21.8119s
	iters: 200, epoch: 10 | loss: 0.4171644
	speed: 0.0190s/iter; left time: 17.9286s
	iters: 300, epoch: 10 | loss: 0.7401420
	speed: 0.0185s/iter; left time: 15.6069s
	iters: 400, epoch: 10 | loss: 0.3729314
	speed: 0.0188s/iter; left time: 14.0066s
	iters: 500, epoch: 10 | loss: 0.5113744
	speed: 0.0189s/iter; left time: 12.1601s
	iters: 600, epoch: 10 | loss: 0.4275582
	speed: 0.0186s/iter; left time: 10.1326s
	iters: 700, epoch: 10 | loss: 0.3965689
	speed: 0.0185s/iter; left time: 8.2285s
	iters: 800, epoch: 10 | loss: 0.4823406
	speed: 0.0184s/iter; left time: 6.3376s
	iters: 900, epoch: 10 | loss: 0.3973328
	speed: 0.0183s/iter; left time: 4.4791s
	iters: 1000, epoch: 10 | loss: 0.3745498
	speed: 0.0180s/iter; left time: 2.6112s
	iters: 1100, epoch: 10 | loss: 0.3009148
	speed: 0.0183s/iter; left time: 0.8217s
Epoch: 10 cost time: 21.22888469696045
Epoch: 10, Steps: 1144 | Train Loss: 0.4706882 Vali Loss: 0.4885665 Test Loss: 0.2213494
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.22121068835258484, mae:0.2579713761806488
Seed: 456
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_336      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip False
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.6114162
	speed: 0.0351s/iter; left time: 396.3821s
	iters: 200, epoch: 1 | loss: 0.6473595
	speed: 0.0290s/iter; left time: 325.0739s
	iters: 300, epoch: 1 | loss: 0.5343147
	speed: 0.0269s/iter; left time: 299.1655s
	iters: 400, epoch: 1 | loss: 0.8233709
	speed: 0.0259s/iter; left time: 285.2079s
	iters: 500, epoch: 1 | loss: 0.6996610
	speed: 0.0253s/iter; left time: 275.8263s
	iters: 600, epoch: 1 | loss: 0.4789027
	speed: 0.0249s/iter; left time: 268.8031s
	iters: 700, epoch: 1 | loss: 0.5169806
	speed: 0.0246s/iter; left time: 263.1919s
	iters: 800, epoch: 1 | loss: 0.5655476
	speed: 0.0241s/iter; left time: 255.8013s
	iters: 900, epoch: 1 | loss: 0.6694984
	speed: 0.0234s/iter; left time: 245.6895s
	iters: 1000, epoch: 1 | loss: 0.5573835
	speed: 0.0228s/iter; left time: 236.6513s
	iters: 1100, epoch: 1 | loss: 0.5657612
	speed: 0.0222s/iter; left time: 228.8574s
Epoch: 1 cost time: 25.22182059288025
Epoch: 1, Steps: 1140 | Train Loss: 0.6277954 Vali Loss: 0.6053242 Test Loss: 0.2850801
Validation loss decreased (inf --> 0.605324).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4711026
	speed: 0.0255s/iter; left time: 259.0504s
	iters: 200, epoch: 2 | loss: 0.8865846
	speed: 0.0243s/iter; left time: 244.8503s
	iters: 300, epoch: 2 | loss: 0.4704782
	speed: 0.0239s/iter; left time: 238.5405s
	iters: 400, epoch: 2 | loss: 0.5380617
	speed: 0.0238s/iter; left time: 234.2396s
	iters: 500, epoch: 2 | loss: 0.4672419
	speed: 0.0236s/iter; left time: 230.6134s
	iters: 600, epoch: 2 | loss: 0.4743655
	speed: 0.0235s/iter; left time: 227.5043s
	iters: 700, epoch: 2 | loss: 0.7687984
	speed: 0.0235s/iter; left time: 224.6610s
	iters: 800, epoch: 2 | loss: 0.5910860
	speed: 0.0234s/iter; left time: 221.7935s
	iters: 900, epoch: 2 | loss: 0.4448274
	speed: 0.0232s/iter; left time: 216.7892s
	iters: 1000, epoch: 2 | loss: 0.5180366
	speed: 0.0227s/iter; left time: 210.2194s
	iters: 1100, epoch: 2 | loss: 0.5808056
	speed: 0.0222s/iter; left time: 203.0518s
Epoch: 2 cost time: 25.1704740524292
Epoch: 2, Steps: 1140 | Train Loss: 0.5793464 Vali Loss: 0.5844648 Test Loss: 0.2794520
Validation loss decreased (0.605324 --> 0.584465).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7637177
	speed: 0.0238s/iter; left time: 214.9697s
	iters: 200, epoch: 3 | loss: 0.3983001
	speed: 0.0210s/iter; left time: 187.2985s
	iters: 300, epoch: 3 | loss: 0.5319234
	speed: 0.0199s/iter; left time: 175.3138s
	iters: 400, epoch: 3 | loss: 0.5669217
	speed: 0.0193s/iter; left time: 168.1931s
	iters: 500, epoch: 3 | loss: 0.6299095
	speed: 0.0189s/iter; left time: 163.2127s
	iters: 600, epoch: 3 | loss: 0.4133472
	speed: 0.0192s/iter; left time: 163.3486s
	iters: 700, epoch: 3 | loss: 0.8284335
	speed: 0.0197s/iter; left time: 166.1882s
	iters: 800, epoch: 3 | loss: 0.7223007
	speed: 0.0202s/iter; left time: 167.7950s
	iters: 900, epoch: 3 | loss: 0.5770094
	speed: 0.0203s/iter; left time: 166.7856s
	iters: 1000, epoch: 3 | loss: 0.7856727
	speed: 0.0201s/iter; left time: 163.3849s
	iters: 1100, epoch: 3 | loss: 0.4042484
	speed: 0.0198s/iter; left time: 159.1558s
Epoch: 3 cost time: 22.639400243759155
Epoch: 3, Steps: 1140 | Train Loss: 0.5614339 Vali Loss: 0.5834529 Test Loss: 0.2786909
Validation loss decreased (0.584465 --> 0.583453).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5050198
	speed: 0.0253s/iter; left time: 199.2547s
	iters: 200, epoch: 4 | loss: 0.7460833
	speed: 0.0241s/iter; left time: 187.1472s
	iters: 300, epoch: 4 | loss: 0.4056976
	speed: 0.0237s/iter; left time: 181.7109s
	iters: 400, epoch: 4 | loss: 0.5253651
	speed: 0.0235s/iter; left time: 177.7968s
	iters: 500, epoch: 4 | loss: 0.4929987
	speed: 0.0233s/iter; left time: 174.5077s
	iters: 600, epoch: 4 | loss: 0.4601492
	speed: 0.0233s/iter; left time: 171.6088s
	iters: 700, epoch: 4 | loss: 0.4630966
	speed: 0.0232s/iter; left time: 168.8337s
	iters: 800, epoch: 4 | loss: 0.4787006
	speed: 0.0231s/iter; left time: 166.1828s
	iters: 900, epoch: 4 | loss: 0.7209027
	speed: 0.0228s/iter; left time: 161.4091s
	iters: 1000, epoch: 4 | loss: 0.4346330
	speed: 0.0224s/iter; left time: 156.1172s
	iters: 1100, epoch: 4 | loss: 0.4896732
	speed: 0.0219s/iter; left time: 150.3784s
Epoch: 4 cost time: 24.83850121498108
Epoch: 4, Steps: 1140 | Train Loss: 0.5514313 Vali Loss: 0.5786721 Test Loss: 0.2770010
Validation loss decreased (0.583453 --> 0.578672).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.9288787
	speed: 0.0254s/iter; left time: 171.3883s
	iters: 200, epoch: 5 | loss: 0.4614679
	speed: 0.0243s/iter; left time: 161.1268s
	iters: 300, epoch: 5 | loss: 0.5001264
	speed: 0.0238s/iter; left time: 155.8089s
	iters: 400, epoch: 5 | loss: 0.5281880
	speed: 0.0236s/iter; left time: 151.8798s
	iters: 500, epoch: 5 | loss: 0.3800078
	speed: 0.0234s/iter; left time: 148.5659s
	iters: 600, epoch: 5 | loss: 0.7931837
	speed: 0.0233s/iter; left time: 145.5903s
	iters: 700, epoch: 5 | loss: 0.6325098
	speed: 0.0233s/iter; left time: 142.8496s
	iters: 800, epoch: 5 | loss: 0.4276312
	speed: 0.0232s/iter; left time: 140.0989s
	iters: 900, epoch: 5 | loss: 0.4234788
	speed: 0.0228s/iter; left time: 135.5190s
	iters: 1000, epoch: 5 | loss: 0.5297288
	speed: 0.0223s/iter; left time: 130.5400s
	iters: 1100, epoch: 5 | loss: 0.5060183
	speed: 0.0218s/iter; left time: 125.3834s
Epoch: 5 cost time: 24.917190313339233
Epoch: 5, Steps: 1140 | Train Loss: 0.5441456 Vali Loss: 0.5808669 Test Loss: 0.2767488
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4604618
	speed: 0.0248s/iter; left time: 139.0196s
	iters: 200, epoch: 6 | loss: 0.4942505
	speed: 0.0238s/iter; left time: 131.1080s
	iters: 300, epoch: 6 | loss: 0.7235054
	speed: 0.0235s/iter; left time: 127.1714s
	iters: 400, epoch: 6 | loss: 0.6884571
	speed: 0.0230s/iter; left time: 122.0570s
	iters: 500, epoch: 6 | loss: 0.7181312
	speed: 0.0219s/iter; left time: 114.0790s
	iters: 600, epoch: 6 | loss: 0.8502047
	speed: 0.0213s/iter; left time: 108.4354s
	iters: 700, epoch: 6 | loss: 0.6924587
	speed: 0.0207s/iter; left time: 103.7568s
	iters: 800, epoch: 6 | loss: 0.4513404
	speed: 0.0203s/iter; left time: 99.7061s
	iters: 900, epoch: 6 | loss: 0.4038212
	speed: 0.0198s/iter; left time: 95.2189s
	iters: 1000, epoch: 6 | loss: 0.4182682
	speed: 0.0197s/iter; left time: 92.8168s
	iters: 1100, epoch: 6 | loss: 0.5736088
	speed: 0.0195s/iter; left time: 89.6383s
Epoch: 6 cost time: 22.20785689353943
Epoch: 6, Steps: 1140 | Train Loss: 0.5403839 Vali Loss: 0.5815833 Test Loss: 0.2770697
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4170033
	speed: 0.0253s/iter; left time: 112.6627s
	iters: 200, epoch: 7 | loss: 0.3475881
	speed: 0.0242s/iter; left time: 105.5586s
	iters: 300, epoch: 7 | loss: 0.4727562
	speed: 0.0238s/iter; left time: 101.5985s
	iters: 400, epoch: 7 | loss: 0.5187750
	speed: 0.0237s/iter; left time: 98.5055s
	iters: 500, epoch: 7 | loss: 0.5186062
	speed: 0.0236s/iter; left time: 95.7088s
	iters: 600, epoch: 7 | loss: 0.8290836
	speed: 0.0235s/iter; left time: 93.0983s
	iters: 700, epoch: 7 | loss: 0.4819220
	speed: 0.0235s/iter; left time: 90.5696s
	iters: 800, epoch: 7 | loss: 0.4797475
	speed: 0.0234s/iter; left time: 88.1474s
	iters: 900, epoch: 7 | loss: 0.4305023
	speed: 0.0234s/iter; left time: 85.6742s
	iters: 1000, epoch: 7 | loss: 0.4198135
	speed: 0.0232s/iter; left time: 82.5737s
	iters: 1100, epoch: 7 | loss: 0.4574802
	speed: 0.0226s/iter; left time: 78.3861s
Epoch: 7 cost time: 25.693312406539917
Epoch: 7, Steps: 1140 | Train Loss: 0.5384974 Vali Loss: 0.5817683 Test Loss: 0.2768214
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.7496200
	speed: 0.0250s/iter; left time: 83.1405s
	iters: 200, epoch: 8 | loss: 0.7175885
	speed: 0.0241s/iter; left time: 77.7299s
	iters: 300, epoch: 8 | loss: 0.5537010
	speed: 0.0238s/iter; left time: 74.3459s
	iters: 400, epoch: 8 | loss: 0.4695331
	speed: 0.0237s/iter; left time: 71.5821s
	iters: 500, epoch: 8 | loss: 0.6480450
	speed: 0.0236s/iter; left time: 68.9305s
	iters: 600, epoch: 8 | loss: 0.6743956
	speed: 0.0235s/iter; left time: 66.3403s
	iters: 700, epoch: 8 | loss: 0.4063405
	speed: 0.0235s/iter; left time: 63.8879s
	iters: 800, epoch: 8 | loss: 0.4244014
	speed: 0.0235s/iter; left time: 61.4658s
	iters: 900, epoch: 8 | loss: 0.4973506
	speed: 0.0234s/iter; left time: 59.0343s
	iters: 1000, epoch: 8 | loss: 0.4173723
	speed: 0.0232s/iter; left time: 56.1826s
	iters: 1100, epoch: 8 | loss: 0.4105925
	speed: 0.0227s/iter; left time: 52.6959s
Epoch: 8 cost time: 25.71321415901184
Epoch: 8, Steps: 1140 | Train Loss: 0.5376559 Vali Loss: 0.5798938 Test Loss: 0.2770069
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3703540
	speed: 0.0247s/iter; left time: 53.8851s
	iters: 200, epoch: 9 | loss: 0.7603660
	speed: 0.0238s/iter; left time: 49.5005s
	iters: 300, epoch: 9 | loss: 0.5237986
	speed: 0.0235s/iter; left time: 46.4748s
	iters: 400, epoch: 9 | loss: 0.4243932
	speed: 0.0233s/iter; left time: 43.8311s
	iters: 500, epoch: 9 | loss: 0.5294946
	speed: 0.0232s/iter; left time: 41.3429s
	iters: 600, epoch: 9 | loss: 0.5082201
	speed: 0.0232s/iter; left time: 38.9796s
	iters: 700, epoch: 9 | loss: 0.6628314
	speed: 0.0224s/iter; left time: 35.4613s
	iters: 800, epoch: 9 | loss: 0.4640610
	speed: 0.0218s/iter; left time: 32.2741s
	iters: 900, epoch: 9 | loss: 0.3920372
	speed: 0.0214s/iter; left time: 29.4994s
	iters: 1000, epoch: 9 | loss: 0.5615685
	speed: 0.0209s/iter; left time: 26.7492s
	iters: 1100, epoch: 9 | loss: 0.4116592
	speed: 0.0200s/iter; left time: 23.5794s
Epoch: 9 cost time: 22.63017177581787
Epoch: 9, Steps: 1140 | Train Loss: 0.5371295 Vali Loss: 0.5820598 Test Loss: 0.2768482
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.2770009934902191, mae:0.29886266589164734
Use GPU: cuda:0
no_skip False
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.6770702
	speed: 0.0253s/iter; left time: 285.3792s
	iters: 200, epoch: 1 | loss: 0.6511703
	speed: 0.0241s/iter; left time: 269.4699s
	iters: 300, epoch: 1 | loss: 0.6383689
	speed: 0.0236s/iter; left time: 262.3782s
	iters: 400, epoch: 1 | loss: 0.6143198
	speed: 0.0234s/iter; left time: 257.7571s
	iters: 500, epoch: 1 | loss: 0.4935219
	speed: 0.0233s/iter; left time: 254.1303s
	iters: 600, epoch: 1 | loss: 0.5712623
	speed: 0.0232s/iter; left time: 250.9193s
	iters: 700, epoch: 1 | loss: 0.5899993
	speed: 0.0232s/iter; left time: 247.9700s
	iters: 800, epoch: 1 | loss: 0.4817858
	speed: 0.0229s/iter; left time: 242.7651s
	iters: 900, epoch: 1 | loss: 0.5248455
	speed: 0.0223s/iter; left time: 233.9171s
	iters: 1000, epoch: 1 | loss: 0.7880671
	speed: 0.0217s/iter; left time: 226.1167s
	iters: 1100, epoch: 1 | loss: 0.5556172
	speed: 0.0214s/iter; left time: 220.1844s
Epoch: 1 cost time: 24.357645511627197
Epoch: 1, Steps: 1140 | Train Loss: 0.6308443 Vali Loss: 0.6101961 Test Loss: 0.2868442
Validation loss decreased (inf --> 0.610196).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9932958
	speed: 0.0253s/iter; left time: 257.2816s
	iters: 200, epoch: 2 | loss: 0.8811773
	speed: 0.0241s/iter; left time: 242.0996s
	iters: 300, epoch: 2 | loss: 0.4966555
	speed: 0.0237s/iter; left time: 235.9777s
	iters: 400, epoch: 2 | loss: 0.5405957
	speed: 0.0235s/iter; left time: 231.5742s
	iters: 500, epoch: 2 | loss: 0.6563886
	speed: 0.0234s/iter; left time: 227.9493s
	iters: 600, epoch: 2 | loss: 0.6163275
	speed: 0.0233s/iter; left time: 224.7421s
	iters: 700, epoch: 2 | loss: 0.4296564
	speed: 0.0232s/iter; left time: 221.8717s
	iters: 800, epoch: 2 | loss: 0.5054212
	speed: 0.0230s/iter; left time: 217.2867s
	iters: 900, epoch: 2 | loss: 0.5601261
	speed: 0.0224s/iter; left time: 209.2978s
	iters: 1000, epoch: 2 | loss: 0.4688754
	speed: 0.0218s/iter; left time: 201.9112s
	iters: 1100, epoch: 2 | loss: 0.7630548
	speed: 0.0213s/iter; left time: 195.5246s
Epoch: 2 cost time: 24.2764151096344
Epoch: 2, Steps: 1140 | Train Loss: 0.5824149 Vali Loss: 0.5865921 Test Loss: 0.2832280
Validation loss decreased (0.610196 --> 0.586592).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7785075
	speed: 0.0251s/iter; left time: 226.8540s
	iters: 200, epoch: 3 | loss: 0.5274266
	speed: 0.0240s/iter; left time: 214.0590s
	iters: 300, epoch: 3 | loss: 0.6754422
	speed: 0.0237s/iter; left time: 208.8154s
	iters: 400, epoch: 3 | loss: 0.6831871
	speed: 0.0235s/iter; left time: 205.2830s
	iters: 500, epoch: 3 | loss: 0.5245231
	speed: 0.0235s/iter; left time: 202.4318s
	iters: 600, epoch: 3 | loss: 0.6544812
	speed: 0.0234s/iter; left time: 199.7034s
	iters: 700, epoch: 3 | loss: 0.4608615
	speed: 0.0234s/iter; left time: 196.8064s
	iters: 800, epoch: 3 | loss: 0.9945217
	speed: 0.0227s/iter; left time: 188.8674s
	iters: 900, epoch: 3 | loss: 0.4861949
	speed: 0.0218s/iter; left time: 179.3538s
	iters: 1000, epoch: 3 | loss: 1.0293915
	speed: 0.0210s/iter; left time: 170.8339s
	iters: 1100, epoch: 3 | loss: 0.4347916
	speed: 0.0202s/iter; left time: 162.0903s
Epoch: 3 cost time: 22.728508234024048
Epoch: 3, Steps: 1140 | Train Loss: 0.5634427 Vali Loss: 0.5799217 Test Loss: 0.2812283
Validation loss decreased (0.586592 --> 0.579922).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.7323338
	speed: 0.0254s/iter; left time: 200.1002s
	iters: 200, epoch: 4 | loss: 0.4058747
	speed: 0.0241s/iter; left time: 187.5911s
	iters: 300, epoch: 4 | loss: 0.4500776
	speed: 0.0237s/iter; left time: 181.9507s
	iters: 400, epoch: 4 | loss: 0.4521171
	speed: 0.0235s/iter; left time: 177.8969s
	iters: 500, epoch: 4 | loss: 0.4382845
	speed: 0.0233s/iter; left time: 174.5942s
	iters: 600, epoch: 4 | loss: 0.7154412
	speed: 0.0233s/iter; left time: 171.6561s
	iters: 700, epoch: 4 | loss: 0.5441160
	speed: 0.0232s/iter; left time: 168.9113s
	iters: 800, epoch: 4 | loss: 0.3928814
	speed: 0.0232s/iter; left time: 166.2546s
	iters: 900, epoch: 4 | loss: 0.4086841
	speed: 0.0229s/iter; left time: 162.4015s
	iters: 1000, epoch: 4 | loss: 0.4840599
	speed: 0.0226s/iter; left time: 157.8416s
	iters: 1100, epoch: 4 | loss: 0.4976771
	speed: 0.0221s/iter; left time: 152.0312s
Epoch: 4 cost time: 25.03532648086548
Epoch: 4, Steps: 1140 | Train Loss: 0.5530679 Vali Loss: 0.5779493 Test Loss: 0.2801113
Validation loss decreased (0.579922 --> 0.577949).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.7901633
	speed: 0.0253s/iter; left time: 170.3261s
	iters: 200, epoch: 5 | loss: 0.4696961
	speed: 0.0241s/iter; left time: 160.0097s
	iters: 300, epoch: 5 | loss: 0.5023356
	speed: 0.0238s/iter; left time: 155.8870s
	iters: 400, epoch: 5 | loss: 0.5643231
	speed: 0.0236s/iter; left time: 151.9018s
	iters: 500, epoch: 5 | loss: 0.5291331
	speed: 0.0234s/iter; left time: 148.5880s
	iters: 600, epoch: 5 | loss: 0.4479685
	speed: 0.0233s/iter; left time: 145.6564s
	iters: 700, epoch: 5 | loss: 0.4825954
	speed: 0.0233s/iter; left time: 142.8811s
	iters: 800, epoch: 5 | loss: 0.7965999
	speed: 0.0232s/iter; left time: 140.2258s
	iters: 900, epoch: 5 | loss: 0.4296214
	speed: 0.0230s/iter; left time: 136.6096s
	iters: 1000, epoch: 5 | loss: 0.6803791
	speed: 0.0226s/iter; left time: 131.7697s
	iters: 1100, epoch: 5 | loss: 0.4355919
	speed: 0.0220s/iter; left time: 126.5607s
Epoch: 5 cost time: 25.028757333755493
Epoch: 5, Steps: 1140 | Train Loss: 0.5463957 Vali Loss: 0.5791000 Test Loss: 0.2800716
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.7041066
	speed: 0.0251s/iter; left time: 140.4206s
	iters: 200, epoch: 6 | loss: 0.4390009
	speed: 0.0240s/iter; left time: 131.8080s
	iters: 300, epoch: 6 | loss: 0.6538078
	speed: 0.0236s/iter; left time: 127.3274s
	iters: 400, epoch: 6 | loss: 0.3563814
	speed: 0.0234s/iter; left time: 123.9979s
	iters: 500, epoch: 6 | loss: 0.4012502
	speed: 0.0233s/iter; left time: 121.0966s
	iters: 600, epoch: 6 | loss: 0.5229650
	speed: 0.0232s/iter; left time: 118.3809s
	iters: 700, epoch: 6 | loss: 0.4020859
	speed: 0.0232s/iter; left time: 115.8023s
	iters: 800, epoch: 6 | loss: 0.4170771
	speed: 0.0231s/iter; left time: 113.2969s
	iters: 900, epoch: 6 | loss: 0.4091428
	speed: 0.0229s/iter; left time: 110.1354s
	iters: 1000, epoch: 6 | loss: 0.4608220
	speed: 0.0226s/iter; left time: 106.0123s
	iters: 1100, epoch: 6 | loss: 0.4972325
	speed: 0.0216s/iter; left time: 99.2293s
Epoch: 6 cost time: 24.302782773971558
Epoch: 6, Steps: 1140 | Train Loss: 0.5431227 Vali Loss: 0.5792506 Test Loss: 0.2805655
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.6606981
	speed: 0.0213s/iter; left time: 94.8522s
	iters: 200, epoch: 7 | loss: 0.3805126
	speed: 0.0199s/iter; left time: 86.9361s
	iters: 300, epoch: 7 | loss: 0.4492698
	speed: 0.0184s/iter; left time: 78.5256s
	iters: 400, epoch: 7 | loss: 0.8413740
	speed: 0.0195s/iter; left time: 81.2077s
	iters: 500, epoch: 7 | loss: 0.4359052
	speed: 0.0202s/iter; left time: 81.9695s
	iters: 600, epoch: 7 | loss: 0.4853215
	speed: 0.0206s/iter; left time: 81.6994s
	iters: 700, epoch: 7 | loss: 0.8259218
	speed: 0.0209s/iter; left time: 80.8648s
	iters: 800, epoch: 7 | loss: 0.5178245
	speed: 0.0211s/iter; left time: 79.5231s
	iters: 900, epoch: 7 | loss: 0.3830257
	speed: 0.0210s/iter; left time: 76.7977s
	iters: 1000, epoch: 7 | loss: 0.4192870
	speed: 0.0207s/iter; left time: 73.8886s
	iters: 1100, epoch: 7 | loss: 0.3741734
	speed: 0.0204s/iter; left time: 70.4843s
Epoch: 7 cost time: 23.198615550994873
Epoch: 7, Steps: 1140 | Train Loss: 0.5412339 Vali Loss: 0.5795774 Test Loss: 0.2807296
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3817941
	speed: 0.0250s/iter; left time: 82.9969s
	iters: 200, epoch: 8 | loss: 0.6699073
	speed: 0.0241s/iter; left time: 77.5437s
	iters: 300, epoch: 8 | loss: 0.4657235
	speed: 0.0238s/iter; left time: 74.2181s
	iters: 400, epoch: 8 | loss: 0.4401260
	speed: 0.0236s/iter; left time: 71.3328s
	iters: 500, epoch: 8 | loss: 0.5522581
	speed: 0.0235s/iter; left time: 68.7008s
	iters: 600, epoch: 8 | loss: 0.4607293
	speed: 0.0235s/iter; left time: 66.2345s
	iters: 700, epoch: 8 | loss: 0.5143831
	speed: 0.0234s/iter; left time: 63.7990s
	iters: 800, epoch: 8 | loss: 0.4639564
	speed: 0.0234s/iter; left time: 61.3829s
	iters: 900, epoch: 8 | loss: 0.4116757
	speed: 0.0234s/iter; left time: 58.9910s
	iters: 1000, epoch: 8 | loss: 0.7926443
	speed: 0.0232s/iter; left time: 56.2493s
	iters: 1100, epoch: 8 | loss: 0.5003294
	speed: 0.0227s/iter; left time: 52.7341s
Epoch: 8 cost time: 25.720248699188232
Epoch: 8, Steps: 1140 | Train Loss: 0.5405128 Vali Loss: 0.5804904 Test Loss: 0.2807167
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4825386
	speed: 0.0253s/iter; left time: 55.1362s
	iters: 200, epoch: 9 | loss: 0.4664507
	speed: 0.0241s/iter; left time: 50.0673s
	iters: 300, epoch: 9 | loss: 0.4219558
	speed: 0.0236s/iter; left time: 46.8370s
	iters: 400, epoch: 9 | loss: 0.4447330
	speed: 0.0234s/iter; left time: 44.0911s
	iters: 500, epoch: 9 | loss: 0.4961853
	speed: 0.0233s/iter; left time: 41.5334s
	iters: 600, epoch: 9 | loss: 0.4831589
	speed: 0.0232s/iter; left time: 39.0597s
	iters: 700, epoch: 9 | loss: 0.4561119
	speed: 0.0232s/iter; left time: 36.6450s
	iters: 800, epoch: 9 | loss: 0.3900756
	speed: 0.0231s/iter; left time: 34.2652s
	iters: 900, epoch: 9 | loss: 0.3695222
	speed: 0.0231s/iter; left time: 31.9013s
	iters: 1000, epoch: 9 | loss: 0.4782904
	speed: 0.0230s/iter; left time: 29.4143s
	iters: 1100, epoch: 9 | loss: 0.4790358
	speed: 0.0224s/iter; left time: 26.4223s
Epoch: 9 cost time: 25.432649612426758
Epoch: 9, Steps: 1140 | Train Loss: 0.5399296 Vali Loss: 0.5809543 Test Loss: 0.2809197
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.2801113426685333, mae:0.29986897110939026
Use GPU: cuda:0
no_skip False
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.4710994
	speed: 0.0204s/iter; left time: 230.6355s
	iters: 200, epoch: 1 | loss: 0.6352130
	speed: 0.0190s/iter; left time: 212.6208s
	iters: 300, epoch: 1 | loss: 0.6340030
	speed: 0.0185s/iter; left time: 205.6942s
	iters: 400, epoch: 1 | loss: 0.4895483
	speed: 0.0178s/iter; left time: 195.9362s
	iters: 500, epoch: 1 | loss: 0.5691639
	speed: 0.0183s/iter; left time: 199.8361s
	iters: 600, epoch: 1 | loss: 0.3977160
	speed: 0.0191s/iter; left time: 206.5514s
	iters: 700, epoch: 1 | loss: 0.5431358
	speed: 0.0197s/iter; left time: 210.6019s
	iters: 800, epoch: 1 | loss: 0.4982488
	speed: 0.0197s/iter; left time: 208.6206s
	iters: 900, epoch: 1 | loss: 0.9225419
	speed: 0.0193s/iter; left time: 203.0932s
	iters: 1000, epoch: 1 | loss: 0.4614937
	speed: 0.0191s/iter; left time: 198.5423s
	iters: 1100, epoch: 1 | loss: 0.4305390
	speed: 0.0191s/iter; left time: 196.7255s
Epoch: 1 cost time: 21.91522979736328
Epoch: 1, Steps: 1140 | Train Loss: 0.6182623 Vali Loss: 0.6004027 Test Loss: 0.2830130
Validation loss decreased (inf --> 0.600403).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5146297
	speed: 0.0248s/iter; left time: 252.0304s
	iters: 200, epoch: 2 | loss: 0.9986466
	speed: 0.0238s/iter; left time: 239.7647s
	iters: 300, epoch: 2 | loss: 0.4823673
	speed: 0.0235s/iter; left time: 234.0178s
	iters: 400, epoch: 2 | loss: 0.6328470
	speed: 0.0233s/iter; left time: 230.2088s
	iters: 500, epoch: 2 | loss: 0.8191311
	speed: 0.0232s/iter; left time: 226.8970s
	iters: 600, epoch: 2 | loss: 1.0727831
	speed: 0.0232s/iter; left time: 223.8801s
	iters: 700, epoch: 2 | loss: 0.4809898
	speed: 0.0231s/iter; left time: 221.0715s
	iters: 800, epoch: 2 | loss: 0.8252934
	speed: 0.0227s/iter; left time: 215.1242s
	iters: 900, epoch: 2 | loss: 0.4808034
	speed: 0.0221s/iter; left time: 207.2643s
	iters: 1000, epoch: 2 | loss: 0.4089566
	speed: 0.0216s/iter; left time: 200.1334s
	iters: 1100, epoch: 2 | loss: 0.4992388
	speed: 0.0212s/iter; left time: 194.0128s
Epoch: 2 cost time: 24.01986336708069
Epoch: 2, Steps: 1140 | Train Loss: 0.5752889 Vali Loss: 0.5817321 Test Loss: 0.2773173
Validation loss decreased (0.600403 --> 0.581732).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4312786
	speed: 0.0205s/iter; left time: 185.2704s
	iters: 200, epoch: 3 | loss: 0.4581432
	speed: 0.0193s/iter; left time: 172.2330s
	iters: 300, epoch: 3 | loss: 0.4642810
	speed: 0.0188s/iter; left time: 166.0694s
	iters: 400, epoch: 3 | loss: 0.4884123
	speed: 0.0193s/iter; left time: 168.2028s
	iters: 500, epoch: 3 | loss: 1.0436487
	speed: 0.0201s/iter; left time: 172.8793s
	iters: 600, epoch: 3 | loss: 0.8463215
	speed: 0.0205s/iter; left time: 174.9826s
	iters: 700, epoch: 3 | loss: 0.7344890
	speed: 0.0209s/iter; left time: 175.7702s
	iters: 800, epoch: 3 | loss: 0.4897620
	speed: 0.0211s/iter; left time: 175.7904s
	iters: 900, epoch: 3 | loss: 0.4721198
	speed: 0.0212s/iter; left time: 174.1856s
	iters: 1000, epoch: 3 | loss: 0.4607738
	speed: 0.0211s/iter; left time: 170.9519s
	iters: 1100, epoch: 3 | loss: 0.4024405
	speed: 0.0210s/iter; left time: 168.1310s
Epoch: 3 cost time: 23.99186635017395
Epoch: 3, Steps: 1140 | Train Loss: 0.5552310 Vali Loss: 0.5729744 Test Loss: 0.2752486
Validation loss decreased (0.581732 --> 0.572974).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4557720
	speed: 0.0220s/iter; left time: 173.1448s
	iters: 200, epoch: 4 | loss: 0.4323821
	speed: 0.0209s/iter; left time: 163.0078s
	iters: 300, epoch: 4 | loss: 0.7419661
	speed: 0.0199s/iter; left time: 152.4705s
	iters: 400, epoch: 4 | loss: 0.4462374
	speed: 0.0194s/iter; left time: 146.7009s
	iters: 500, epoch: 4 | loss: 0.4352773
	speed: 0.0190s/iter; left time: 141.8347s
	iters: 600, epoch: 4 | loss: 0.4890371
	speed: 0.0187s/iter; left time: 138.3203s
	iters: 700, epoch: 4 | loss: 0.4981680
	speed: 0.0186s/iter; left time: 135.3049s
	iters: 800, epoch: 4 | loss: 0.4304528
	speed: 0.0186s/iter; left time: 133.4563s
	iters: 900, epoch: 4 | loss: 0.4372922
	speed: 0.0189s/iter; left time: 133.9182s
	iters: 1000, epoch: 4 | loss: 0.4959641
	speed: 0.0190s/iter; left time: 132.7218s
	iters: 1100, epoch: 4 | loss: 0.5748425
	speed: 0.0191s/iter; left time: 131.5510s
Epoch: 4 cost time: 21.942806482315063
Epoch: 4, Steps: 1140 | Train Loss: 0.5433666 Vali Loss: 0.5753112 Test Loss: 0.2751817
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5715274
	speed: 0.0218s/iter; left time: 147.1857s
	iters: 200, epoch: 5 | loss: 0.4778094
	speed: 0.0209s/iter; left time: 138.9197s
	iters: 300, epoch: 5 | loss: 0.4677373
	speed: 0.0206s/iter; left time: 134.7635s
	iters: 400, epoch: 5 | loss: 0.6471994
	speed: 0.0212s/iter; left time: 136.4350s
	iters: 500, epoch: 5 | loss: 0.4977726
	speed: 0.0215s/iter; left time: 136.5198s
	iters: 600, epoch: 5 | loss: 0.3995078
	speed: 0.0218s/iter; left time: 135.7913s
	iters: 700, epoch: 5 | loss: 0.7910439
	speed: 0.0219s/iter; left time: 134.6337s
	iters: 800, epoch: 5 | loss: 0.5345676
	speed: 0.0220s/iter; left time: 133.1964s
	iters: 900, epoch: 5 | loss: 0.4092885
	speed: 0.0220s/iter; left time: 130.8558s
	iters: 1000, epoch: 5 | loss: 0.4064706
	speed: 0.0218s/iter; left time: 127.5348s
	iters: 1100, epoch: 5 | loss: 0.5108809
	speed: 0.0217s/iter; left time: 124.4658s
Epoch: 5 cost time: 24.780818700790405
Epoch: 5, Steps: 1140 | Train Loss: 0.5364110 Vali Loss: 0.5758614 Test Loss: 0.2760333
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4241330
	speed: 0.0225s/iter; left time: 126.2394s
	iters: 200, epoch: 6 | loss: 0.4686732
	speed: 0.0213s/iter; left time: 117.1341s
	iters: 300, epoch: 6 | loss: 0.4625680
	speed: 0.0210s/iter; left time: 113.3965s
	iters: 400, epoch: 6 | loss: 0.4003536
	speed: 0.0215s/iter; left time: 114.0892s
	iters: 500, epoch: 6 | loss: 0.4471473
	speed: 0.0218s/iter; left time: 113.5254s
	iters: 600, epoch: 6 | loss: 0.4814550
	speed: 0.0221s/iter; left time: 112.5162s
	iters: 700, epoch: 6 | loss: 0.7634667
	speed: 0.0222s/iter; left time: 111.0750s
	iters: 800, epoch: 6 | loss: 0.6388129
	speed: 0.0223s/iter; left time: 109.3928s
	iters: 900, epoch: 6 | loss: 0.4680891
	speed: 0.0223s/iter; left time: 106.8790s
	iters: 1000, epoch: 6 | loss: 0.5175582
	speed: 0.0220s/iter; left time: 103.5466s
	iters: 1100, epoch: 6 | loss: 0.6538557
	speed: 0.0219s/iter; left time: 100.5615s
Epoch: 6 cost time: 24.965336799621582
Epoch: 6, Steps: 1140 | Train Loss: 0.5331359 Vali Loss: 0.5771534 Test Loss: 0.2759379
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4926434
	speed: 0.0223s/iter; left time: 99.6111s
	iters: 200, epoch: 7 | loss: 0.6832051
	speed: 0.0212s/iter; left time: 92.4982s
	iters: 300, epoch: 7 | loss: 0.4140735
	speed: 0.0213s/iter; left time: 90.6722s
	iters: 400, epoch: 7 | loss: 0.6348404
	speed: 0.0217s/iter; left time: 90.2493s
	iters: 500, epoch: 7 | loss: 0.5969397
	speed: 0.0219s/iter; left time: 89.0246s
	iters: 600, epoch: 7 | loss: 0.4126651
	speed: 0.0221s/iter; left time: 87.6367s
	iters: 700, epoch: 7 | loss: 0.4310996
	speed: 0.0219s/iter; left time: 84.5818s
	iters: 800, epoch: 7 | loss: 0.5220879
	speed: 0.0214s/iter; left time: 80.5500s
	iters: 900, epoch: 7 | loss: 0.3640008
	speed: 0.0208s/iter; left time: 76.2987s
	iters: 1000, epoch: 7 | loss: 0.5413030
	speed: 0.0202s/iter; left time: 72.0103s
	iters: 1100, epoch: 7 | loss: 0.4273876
	speed: 0.0197s/iter; left time: 68.2565s
Epoch: 7 cost time: 22.547191381454468
Epoch: 7, Steps: 1140 | Train Loss: 0.5306044 Vali Loss: 0.5776198 Test Loss: 0.2759836
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4281120
	speed: 0.0228s/iter; left time: 75.5671s
	iters: 200, epoch: 8 | loss: 0.4020467
	speed: 0.0214s/iter; left time: 69.0373s
	iters: 300, epoch: 8 | loss: 0.7617759
	speed: 0.0219s/iter; left time: 68.2715s
	iters: 400, epoch: 8 | loss: 0.5177619
	speed: 0.0221s/iter; left time: 66.8765s
	iters: 500, epoch: 8 | loss: 0.4664159
	speed: 0.0223s/iter; left time: 65.1088s
	iters: 600, epoch: 8 | loss: 0.4824928
	speed: 0.0224s/iter; left time: 63.2132s
	iters: 700, epoch: 8 | loss: 0.4673063
	speed: 0.0225s/iter; left time: 61.1804s
	iters: 800, epoch: 8 | loss: 0.3894426
	speed: 0.0225s/iter; left time: 59.0680s
	iters: 900, epoch: 8 | loss: 1.0457203
	speed: 0.0225s/iter; left time: 56.7790s
	iters: 1000, epoch: 8 | loss: 0.4447092
	speed: 0.0223s/iter; left time: 53.8954s
	iters: 1100, epoch: 8 | loss: 0.6645864
	speed: 0.0221s/iter; left time: 51.1991s
Epoch: 8 cost time: 25.209396600723267
Epoch: 8, Steps: 1140 | Train Loss: 0.5294845 Vali Loss: 0.5778229 Test Loss: 0.2762013
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.2752484679222107, mae:0.29742830991744995
Seed: 456
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_720      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip False
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.6997043
	speed: 0.0395s/iter; left time: 441.2310s
	iters: 200, epoch: 1 | loss: 0.6425921
	speed: 0.0313s/iter; left time: 346.9235s
	iters: 300, epoch: 1 | loss: 0.6354839
	speed: 0.0286s/iter; left time: 314.5507s
	iters: 400, epoch: 1 | loss: 0.5646335
	speed: 0.0273s/iter; left time: 296.7969s
	iters: 500, epoch: 1 | loss: 0.8392310
	speed: 0.0264s/iter; left time: 285.1343s
	iters: 600, epoch: 1 | loss: 0.6265390
	speed: 0.0259s/iter; left time: 276.5686s
	iters: 700, epoch: 1 | loss: 0.8990940
	speed: 0.0253s/iter; left time: 267.8977s
	iters: 800, epoch: 1 | loss: 0.8146456
	speed: 0.0246s/iter; left time: 258.0982s
	iters: 900, epoch: 1 | loss: 0.7074851
	speed: 0.0242s/iter; left time: 250.7595s
	iters: 1000, epoch: 1 | loss: 0.7166758
	speed: 0.0238s/iter; left time: 245.1655s
	iters: 1100, epoch: 1 | loss: 0.5698718
	speed: 0.0238s/iter; left time: 242.0766s
Epoch: 1 cost time: 26.902830123901367
Epoch: 1, Steps: 1128 | Train Loss: 0.7086266 Vali Loss: 0.7239306 Test Loss: 0.3585064
Validation loss decreased (inf --> 0.723931).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7825318
	speed: 0.0253s/iter; left time: 254.7718s
	iters: 200, epoch: 2 | loss: 0.5916592
	speed: 0.0231s/iter; left time: 229.7696s
	iters: 300, epoch: 2 | loss: 0.8716117
	speed: 0.0213s/iter; left time: 210.0915s
	iters: 400, epoch: 2 | loss: 0.6299112
	speed: 0.0204s/iter; left time: 199.3687s
	iters: 500, epoch: 2 | loss: 0.4699780
	speed: 0.0201s/iter; left time: 193.6569s
	iters: 600, epoch: 2 | loss: 0.5453930
	speed: 0.0197s/iter; left time: 188.4765s
	iters: 700, epoch: 2 | loss: 0.6085427
	speed: 0.0197s/iter; left time: 186.2853s
	iters: 800, epoch: 2 | loss: 0.5716711
	speed: 0.0197s/iter; left time: 184.5875s
	iters: 900, epoch: 2 | loss: 0.7064468
	speed: 0.0198s/iter; left time: 182.9282s
	iters: 1000, epoch: 2 | loss: 0.5534622
	speed: 0.0201s/iter; left time: 183.8893s
	iters: 1100, epoch: 2 | loss: 0.4819992
	speed: 0.0204s/iter; left time: 184.3012s
Epoch: 2 cost time: 23.128769159317017
Epoch: 2, Steps: 1128 | Train Loss: 0.6618281 Vali Loss: 0.7085642 Test Loss: 0.3561827
Validation loss decreased (0.723931 --> 0.708564).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.8752615
	speed: 0.0255s/iter; left time: 227.4958s
	iters: 200, epoch: 3 | loss: 0.6619803
	speed: 0.0242s/iter; left time: 213.8741s
	iters: 300, epoch: 3 | loss: 0.5262467
	speed: 0.0238s/iter; left time: 207.9475s
	iters: 400, epoch: 3 | loss: 0.6075097
	speed: 0.0236s/iter; left time: 203.9250s
	iters: 500, epoch: 3 | loss: 0.6006420
	speed: 0.0235s/iter; left time: 200.5204s
	iters: 600, epoch: 3 | loss: 0.7094923
	speed: 0.0232s/iter; left time: 195.5074s
	iters: 700, epoch: 3 | loss: 0.6746470
	speed: 0.0227s/iter; left time: 189.2131s
	iters: 800, epoch: 3 | loss: 0.6093194
	speed: 0.0224s/iter; left time: 184.3510s
	iters: 900, epoch: 3 | loss: 0.5242067
	speed: 0.0223s/iter; left time: 181.2096s
	iters: 1000, epoch: 3 | loss: 0.5577124
	speed: 0.0224s/iter; left time: 179.5546s
	iters: 1100, epoch: 3 | loss: 0.7510385
	speed: 0.0224s/iter; left time: 177.7844s
Epoch: 3 cost time: 25.367558240890503
Epoch: 3, Steps: 1128 | Train Loss: 0.6422777 Vali Loss: 0.7080848 Test Loss: 0.3548515
Validation loss decreased (0.708564 --> 0.708085).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4780778
	speed: 0.0253s/iter; left time: 197.6108s
	iters: 200, epoch: 4 | loss: 0.5904160
	speed: 0.0242s/iter; left time: 186.2347s
	iters: 300, epoch: 4 | loss: 0.5386724
	speed: 0.0238s/iter; left time: 180.9536s
	iters: 400, epoch: 4 | loss: 0.8402996
	speed: 0.0236s/iter; left time: 177.1170s
	iters: 500, epoch: 4 | loss: 0.7361575
	speed: 0.0235s/iter; left time: 173.9845s
	iters: 600, epoch: 4 | loss: 0.5348548
	speed: 0.0230s/iter; left time: 167.5140s
	iters: 700, epoch: 4 | loss: 0.7218894
	speed: 0.0225s/iter; left time: 162.0349s
	iters: 800, epoch: 4 | loss: 0.6822369
	speed: 0.0222s/iter; left time: 157.4568s
	iters: 900, epoch: 4 | loss: 0.6320073
	speed: 0.0219s/iter; left time: 153.5735s
	iters: 1000, epoch: 4 | loss: 0.5857729
	speed: 0.0217s/iter; left time: 149.8754s
	iters: 1100, epoch: 4 | loss: 0.6176987
	speed: 0.0218s/iter; left time: 148.1355s
Epoch: 4 cost time: 24.60005235671997
Epoch: 4, Steps: 1128 | Train Loss: 0.6310747 Vali Loss: 0.7131671 Test Loss: 0.3561960
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6255209
	speed: 0.0253s/iter; left time: 168.6339s
	iters: 200, epoch: 5 | loss: 0.6849257
	speed: 0.0242s/iter; left time: 158.8010s
	iters: 300, epoch: 5 | loss: 0.6768849
	speed: 0.0238s/iter; left time: 153.8886s
	iters: 400, epoch: 5 | loss: 0.7238585
	speed: 0.0236s/iter; left time: 150.2763s
	iters: 500, epoch: 5 | loss: 0.6285052
	speed: 0.0229s/iter; left time: 143.7091s
	iters: 600, epoch: 5 | loss: 0.7647789
	speed: 0.0221s/iter; left time: 136.4956s
	iters: 700, epoch: 5 | loss: 0.5991304
	speed: 0.0215s/iter; left time: 130.2464s
	iters: 800, epoch: 5 | loss: 0.5786985
	speed: 0.0206s/iter; left time: 123.2577s
	iters: 900, epoch: 5 | loss: 0.5989749
	speed: 0.0199s/iter; left time: 116.6534s
	iters: 1000, epoch: 5 | loss: 0.6041822
	speed: 0.0199s/iter; left time: 114.6445s
	iters: 1100, epoch: 5 | loss: 0.4185145
	speed: 0.0200s/iter; left time: 113.5896s
Epoch: 5 cost time: 22.7553870677948
Epoch: 5, Steps: 1128 | Train Loss: 0.6242722 Vali Loss: 0.7152687 Test Loss: 0.3566715
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6815345
	speed: 0.0254s/iter; left time: 140.4761s
	iters: 200, epoch: 6 | loss: 0.6711917
	speed: 0.0242s/iter; left time: 131.5488s
	iters: 300, epoch: 6 | loss: 0.6092417
	speed: 0.0238s/iter; left time: 127.3300s
	iters: 400, epoch: 6 | loss: 0.5046936
	speed: 0.0236s/iter; left time: 123.9073s
	iters: 500, epoch: 6 | loss: 0.5347401
	speed: 0.0235s/iter; left time: 120.9096s
	iters: 600, epoch: 6 | loss: 0.5304425
	speed: 0.0234s/iter; left time: 118.1589s
	iters: 700, epoch: 6 | loss: 0.5388884
	speed: 0.0234s/iter; left time: 115.5416s
	iters: 800, epoch: 6 | loss: 0.7699450
	speed: 0.0230s/iter; left time: 111.2206s
	iters: 900, epoch: 6 | loss: 0.6285413
	speed: 0.0226s/iter; left time: 107.2822s
	iters: 1000, epoch: 6 | loss: 0.6150904
	speed: 0.0224s/iter; left time: 103.7447s
	iters: 1100, epoch: 6 | loss: 0.7272398
	speed: 0.0224s/iter; left time: 101.6169s
Epoch: 6 cost time: 25.363974809646606
Epoch: 6, Steps: 1128 | Train Loss: 0.6209647 Vali Loss: 0.7165399 Test Loss: 0.3562469
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8616146
	speed: 0.0254s/iter; left time: 112.1469s
	iters: 200, epoch: 7 | loss: 0.6275560
	speed: 0.0242s/iter; left time: 104.3622s
	iters: 300, epoch: 7 | loss: 0.9352124
	speed: 0.0238s/iter; left time: 100.3837s
	iters: 400, epoch: 7 | loss: 0.7548583
	speed: 0.0236s/iter; left time: 97.2116s
	iters: 500, epoch: 7 | loss: 0.5436708
	speed: 0.0235s/iter; left time: 94.3464s
	iters: 600, epoch: 7 | loss: 0.6627742
	speed: 0.0234s/iter; left time: 91.6702s
	iters: 700, epoch: 7 | loss: 0.5437943
	speed: 0.0232s/iter; left time: 88.4207s
	iters: 800, epoch: 7 | loss: 0.5092091
	speed: 0.0228s/iter; left time: 84.5664s
	iters: 900, epoch: 7 | loss: 0.5728647
	speed: 0.0225s/iter; left time: 81.2031s
	iters: 1000, epoch: 7 | loss: 0.6016259
	speed: 0.0223s/iter; left time: 78.3773s
	iters: 1100, epoch: 7 | loss: 0.5165569
	speed: 0.0224s/iter; left time: 76.3630s
Epoch: 7 cost time: 25.327134609222412
Epoch: 7, Steps: 1128 | Train Loss: 0.6187436 Vali Loss: 0.7197933 Test Loss: 0.3567326
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.5101276
	speed: 0.0253s/iter; left time: 82.9642s
	iters: 200, epoch: 8 | loss: 0.5323455
	speed: 0.0241s/iter; left time: 76.8695s
	iters: 300, epoch: 8 | loss: 0.6460387
	speed: 0.0238s/iter; left time: 73.2987s
	iters: 400, epoch: 8 | loss: 0.5596451
	speed: 0.0236s/iter; left time: 70.3628s
	iters: 500, epoch: 8 | loss: 0.4880410
	speed: 0.0235s/iter; left time: 67.6814s
	iters: 600, epoch: 8 | loss: 0.6100612
	speed: 0.0234s/iter; left time: 65.1951s
	iters: 700, epoch: 8 | loss: 0.6691011
	speed: 0.0230s/iter; left time: 61.6332s
	iters: 800, epoch: 8 | loss: 0.5616213
	speed: 0.0220s/iter; left time: 56.8381s
	iters: 900, epoch: 8 | loss: 0.5549215
	speed: 0.0212s/iter; left time: 52.6104s
	iters: 1000, epoch: 8 | loss: 0.6071126
	speed: 0.0207s/iter; left time: 49.2597s
	iters: 1100, epoch: 8 | loss: 0.6732866
	speed: 0.0205s/iter; left time: 46.7594s
Epoch: 8 cost time: 23.088587284088135
Epoch: 8, Steps: 1128 | Train Loss: 0.6180791 Vali Loss: 0.7199903 Test Loss: 0.3569516
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.35485151410102844, mae:0.3499186933040619
Use GPU: cuda:0
no_skip False
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.7937559
	speed: 0.0254s/iter; left time: 283.6817s
	iters: 200, epoch: 1 | loss: 0.6848277
	speed: 0.0242s/iter; left time: 267.6376s
	iters: 300, epoch: 1 | loss: 0.6828014
	speed: 0.0238s/iter; left time: 261.1345s
	iters: 400, epoch: 1 | loss: 0.6712034
	speed: 0.0230s/iter; left time: 250.2949s
	iters: 500, epoch: 1 | loss: 1.0021281
	speed: 0.0224s/iter; left time: 241.1789s
	iters: 600, epoch: 1 | loss: 0.7509780
	speed: 0.0220s/iter; left time: 235.0019s
	iters: 700, epoch: 1 | loss: 0.6374564
	speed: 0.0219s/iter; left time: 232.2098s
	iters: 800, epoch: 1 | loss: 0.5892147
	speed: 0.0221s/iter; left time: 231.4333s
	iters: 900, epoch: 1 | loss: 0.6343412
	speed: 0.0222s/iter; left time: 230.2651s
	iters: 1000, epoch: 1 | loss: 0.6280869
	speed: 0.0220s/iter; left time: 226.4211s
	iters: 1100, epoch: 1 | loss: 0.7890104
	speed: 0.0218s/iter; left time: 222.2131s
Epoch: 1 cost time: 24.703792810440063
Epoch: 1, Steps: 1128 | Train Loss: 0.7083345 Vali Loss: 0.7255318 Test Loss: 0.3597432
Validation loss decreased (inf --> 0.725532).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6750003
	speed: 0.0253s/iter; left time: 254.8314s
	iters: 200, epoch: 2 | loss: 0.8895662
	speed: 0.0242s/iter; left time: 240.4605s
	iters: 300, epoch: 2 | loss: 0.7653316
	speed: 0.0238s/iter; left time: 234.2534s
	iters: 400, epoch: 2 | loss: 0.5505549
	speed: 0.0230s/iter; left time: 224.0270s
	iters: 500, epoch: 2 | loss: 0.5819823
	speed: 0.0224s/iter; left time: 215.7928s
	iters: 600, epoch: 2 | loss: 0.5570265
	speed: 0.0220s/iter; left time: 209.9232s
	iters: 700, epoch: 2 | loss: 0.6374965
	speed: 0.0220s/iter; left time: 208.1314s
	iters: 800, epoch: 2 | loss: 0.6820948
	speed: 0.0221s/iter; left time: 207.0680s
	iters: 900, epoch: 2 | loss: 0.8836460
	speed: 0.0222s/iter; left time: 205.7508s
	iters: 1000, epoch: 2 | loss: 0.7599220
	speed: 0.0221s/iter; left time: 202.5285s
	iters: 1100, epoch: 2 | loss: 0.4969988
	speed: 0.0219s/iter; left time: 198.5860s
Epoch: 2 cost time: 24.7918643951416
Epoch: 2, Steps: 1128 | Train Loss: 0.6620608 Vali Loss: 0.7189371 Test Loss: 0.3556165
Validation loss decreased (0.725532 --> 0.718937).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6539678
	speed: 0.0244s/iter; left time: 217.7062s
	iters: 200, epoch: 3 | loss: 0.5722298
	speed: 0.0237s/iter; left time: 208.9500s
	iters: 300, epoch: 3 | loss: 0.6928939
	speed: 0.0232s/iter; left time: 202.3248s
	iters: 400, epoch: 3 | loss: 0.5657881
	speed: 0.0223s/iter; left time: 192.7041s
	iters: 500, epoch: 3 | loss: 0.6728262
	speed: 0.0219s/iter; left time: 187.0124s
	iters: 600, epoch: 3 | loss: 0.7148777
	speed: 0.0217s/iter; left time: 182.4059s
	iters: 700, epoch: 3 | loss: 0.7080492
	speed: 0.0218s/iter; left time: 181.8254s
	iters: 800, epoch: 3 | loss: 0.6547073
	speed: 0.0220s/iter; left time: 180.8628s
	iters: 900, epoch: 3 | loss: 0.6213694
	speed: 0.0221s/iter; left time: 179.5596s
	iters: 1000, epoch: 3 | loss: 0.8234656
	speed: 0.0222s/iter; left time: 178.0636s
	iters: 1100, epoch: 3 | loss: 0.5801475
	speed: 0.0223s/iter; left time: 176.4798s
Epoch: 3 cost time: 25.243611812591553
Epoch: 3, Steps: 1128 | Train Loss: 0.6456750 Vali Loss: 0.7184295 Test Loss: 0.3537909
Validation loss decreased (0.718937 --> 0.718430).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5603430
	speed: 0.0201s/iter; left time: 156.4786s
	iters: 200, epoch: 4 | loss: 0.6678086
	speed: 0.0174s/iter; left time: 133.6340s
	iters: 300, epoch: 4 | loss: 0.5739539
	speed: 0.0172s/iter; left time: 130.3536s
	iters: 400, epoch: 4 | loss: 0.5447790
	speed: 0.0179s/iter; left time: 134.1472s
	iters: 500, epoch: 4 | loss: 0.5354845
	speed: 0.0183s/iter; left time: 135.5202s
	iters: 600, epoch: 4 | loss: 0.5875839
	speed: 0.0191s/iter; left time: 139.6250s
	iters: 700, epoch: 4 | loss: 0.5565751
	speed: 0.0197s/iter; left time: 141.9304s
	iters: 800, epoch: 4 | loss: 0.5118667
	speed: 0.0202s/iter; left time: 143.0861s
	iters: 900, epoch: 4 | loss: 0.7516326
	speed: 0.0205s/iter; left time: 143.3489s
	iters: 1000, epoch: 4 | loss: 0.7938973
	speed: 0.0208s/iter; left time: 143.1323s
	iters: 1100, epoch: 4 | loss: 0.5188264
	speed: 0.0210s/iter; left time: 142.5323s
Epoch: 4 cost time: 23.831543445587158
Epoch: 4, Steps: 1128 | Train Loss: 0.6352907 Vali Loss: 0.7118620 Test Loss: 0.3544290
Validation loss decreased (0.718430 --> 0.711862).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5329399
	speed: 0.0252s/iter; left time: 167.7329s
	iters: 200, epoch: 5 | loss: 0.5481510
	speed: 0.0233s/iter; left time: 153.0935s
	iters: 300, epoch: 5 | loss: 0.8717411
	speed: 0.0222s/iter; left time: 143.3156s
	iters: 400, epoch: 5 | loss: 0.5818480
	speed: 0.0216s/iter; left time: 137.7994s
	iters: 500, epoch: 5 | loss: 0.6256330
	speed: 0.0216s/iter; left time: 135.2427s
	iters: 600, epoch: 5 | loss: 0.6559533
	speed: 0.0218s/iter; left time: 134.5790s
	iters: 700, epoch: 5 | loss: 0.6641271
	speed: 0.0220s/iter; left time: 133.4537s
	iters: 800, epoch: 5 | loss: 0.5740321
	speed: 0.0221s/iter; left time: 132.0071s
	iters: 900, epoch: 5 | loss: 0.5188496
	speed: 0.0222s/iter; left time: 130.3888s
	iters: 1000, epoch: 5 | loss: 0.6230600
	speed: 0.0223s/iter; left time: 128.6354s
	iters: 1100, epoch: 5 | loss: 0.4707109
	speed: 0.0224s/iter; left time: 126.7670s
Epoch: 5 cost time: 25.369064807891846
Epoch: 5, Steps: 1128 | Train Loss: 0.6288725 Vali Loss: 0.7140242 Test Loss: 0.3548757
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5055078
	speed: 0.0256s/iter; left time: 141.8740s
	iters: 200, epoch: 6 | loss: 0.5937715
	speed: 0.0227s/iter; left time: 123.5505s
	iters: 300, epoch: 6 | loss: 0.6473081
	speed: 0.0218s/iter; left time: 116.3824s
	iters: 400, epoch: 6 | loss: 0.5211063
	speed: 0.0213s/iter; left time: 111.7120s
	iters: 500, epoch: 6 | loss: 0.6849827
	speed: 0.0211s/iter; left time: 108.4999s
	iters: 600, epoch: 6 | loss: 0.5426312
	speed: 0.0209s/iter; left time: 105.1230s
	iters: 700, epoch: 6 | loss: 0.5278354
	speed: 0.0210s/iter; left time: 103.8410s
	iters: 800, epoch: 6 | loss: 0.5119476
	speed: 0.0213s/iter; left time: 102.9211s
	iters: 900, epoch: 6 | loss: 0.5243933
	speed: 0.0215s/iter; left time: 101.7080s
	iters: 1000, epoch: 6 | loss: 0.5574596
	speed: 0.0216s/iter; left time: 100.2809s
	iters: 1100, epoch: 6 | loss: 0.5064808
	speed: 0.0217s/iter; left time: 98.6819s
Epoch: 6 cost time: 24.63885521888733
Epoch: 6, Steps: 1128 | Train Loss: 0.6252987 Vali Loss: 0.7178816 Test Loss: 0.3555944
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5853171
	speed: 0.0217s/iter; left time: 95.6973s
	iters: 200, epoch: 7 | loss: 0.5673328
	speed: 0.0198s/iter; left time: 85.2941s
	iters: 300, epoch: 7 | loss: 0.8415674
	speed: 0.0188s/iter; left time: 79.2147s
	iters: 400, epoch: 7 | loss: 0.6707591
	speed: 0.0178s/iter; left time: 73.4165s
	iters: 500, epoch: 7 | loss: 0.7053898
	speed: 0.0172s/iter; left time: 69.0991s
	iters: 600, epoch: 7 | loss: 0.5370814
	speed: 0.0177s/iter; left time: 69.1242s
	iters: 700, epoch: 7 | loss: 0.5613555
	speed: 0.0184s/iter; left time: 70.0792s
	iters: 800, epoch: 7 | loss: 0.6751692
	speed: 0.0190s/iter; left time: 70.3942s
	iters: 900, epoch: 7 | loss: 0.5954244
	speed: 0.0194s/iter; left time: 70.1132s
	iters: 1000, epoch: 7 | loss: 0.6940343
	speed: 0.0198s/iter; left time: 69.4227s
	iters: 1100, epoch: 7 | loss: 0.5772810
	speed: 0.0201s/iter; left time: 68.4548s
Epoch: 7 cost time: 22.828075885772705
Epoch: 7, Steps: 1128 | Train Loss: 0.6239632 Vali Loss: 0.7162462 Test Loss: 0.3558783
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.6802532
	speed: 0.0252s/iter; left time: 82.9443s
	iters: 200, epoch: 8 | loss: 0.7350708
	speed: 0.0241s/iter; left time: 76.7842s
	iters: 300, epoch: 8 | loss: 0.7287209
	speed: 0.0233s/iter; left time: 71.8298s
	iters: 400, epoch: 8 | loss: 0.5863121
	speed: 0.0224s/iter; left time: 66.9291s
	iters: 500, epoch: 8 | loss: 0.5593868
	speed: 0.0220s/iter; left time: 63.4235s
	iters: 600, epoch: 8 | loss: 0.7870014
	speed: 0.0218s/iter; left time: 60.5823s
	iters: 700, epoch: 8 | loss: 0.8192793
	speed: 0.0219s/iter; left time: 58.8696s
	iters: 800, epoch: 8 | loss: 0.7511095
	speed: 0.0221s/iter; left time: 57.0139s
	iters: 900, epoch: 8 | loss: 0.7909208
	speed: 0.0222s/iter; left time: 55.0719s
	iters: 1000, epoch: 8 | loss: 0.5692187
	speed: 0.0222s/iter; left time: 53.0463s
	iters: 1100, epoch: 8 | loss: 0.7365490
	speed: 0.0223s/iter; left time: 50.9704s
Epoch: 8 cost time: 25.28814172744751
Epoch: 8, Steps: 1128 | Train Loss: 0.6227541 Vali Loss: 0.7177342 Test Loss: 0.3557412
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.7124577
	speed: 0.0253s/iter; left time: 54.6045s
	iters: 200, epoch: 9 | loss: 0.5074424
	speed: 0.0242s/iter; left time: 49.6968s
	iters: 300, epoch: 9 | loss: 0.6475632
	speed: 0.0227s/iter; left time: 44.4793s
	iters: 400, epoch: 9 | loss: 0.6521955
	speed: 0.0220s/iter; left time: 40.8475s
	iters: 500, epoch: 9 | loss: 0.5245036
	speed: 0.0216s/iter; left time: 37.9624s
	iters: 600, epoch: 9 | loss: 0.6081069
	speed: 0.0217s/iter; left time: 35.9466s
	iters: 700, epoch: 9 | loss: 0.4657686
	speed: 0.0219s/iter; left time: 34.0782s
	iters: 800, epoch: 9 | loss: 0.5747281
	speed: 0.0221s/iter; left time: 32.1298s
	iters: 900, epoch: 9 | loss: 0.4877825
	speed: 0.0222s/iter; left time: 30.1120s
	iters: 1000, epoch: 9 | loss: 0.6757635
	speed: 0.0223s/iter; left time: 28.0147s
	iters: 1100, epoch: 9 | loss: 0.5941234
	speed: 0.0224s/iter; left time: 25.8783s
Epoch: 9 cost time: 25.365270137786865
Epoch: 9, Steps: 1128 | Train Loss: 0.6221871 Vali Loss: 0.7152025 Test Loss: 0.3557798
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.3544289767742157, mae:0.35153210163116455
Use GPU: cuda:0
no_skip False
add a fuse layer of decoder
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.8410475
	speed: 0.0188s/iter; left time: 210.2765s
	iters: 200, epoch: 1 | loss: 0.6490138
	speed: 0.0168s/iter; left time: 186.0371s
	iters: 300, epoch: 1 | loss: 0.6300713
	speed: 0.0161s/iter; left time: 176.3595s
	iters: 400, epoch: 1 | loss: 0.6270536
	speed: 0.0162s/iter; left time: 176.1789s
	iters: 500, epoch: 1 | loss: 0.6904209
	speed: 0.0166s/iter; left time: 178.4806s
	iters: 600, epoch: 1 | loss: 0.8412627
	speed: 0.0176s/iter; left time: 188.2736s
	iters: 700, epoch: 1 | loss: 0.6204318
	speed: 0.0184s/iter; left time: 194.6768s
	iters: 800, epoch: 1 | loss: 0.7327947
	speed: 0.0190s/iter; left time: 198.8397s
	iters: 900, epoch: 1 | loss: 0.6521008
	speed: 0.0194s/iter; left time: 201.5701s
	iters: 1000, epoch: 1 | loss: 0.6578130
	speed: 0.0195s/iter; left time: 200.2267s
	iters: 1100, epoch: 1 | loss: 0.6122473
	speed: 0.0195s/iter; left time: 198.5838s
Epoch: 1 cost time: 22.146509170532227
Epoch: 1, Steps: 1128 | Train Loss: 0.6997467 Vali Loss: 0.7182302 Test Loss: 0.3579041
Validation loss decreased (inf --> 0.718230).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5852358
	speed: 0.0230s/iter; left time: 231.4769s
	iters: 200, epoch: 2 | loss: 0.7338370
	speed: 0.0215s/iter; left time: 213.9720s
	iters: 300, epoch: 2 | loss: 0.6953407
	speed: 0.0211s/iter; left time: 208.0739s
	iters: 400, epoch: 2 | loss: 0.5424682
	speed: 0.0214s/iter; left time: 208.4440s
	iters: 500, epoch: 2 | loss: 0.5420119
	speed: 0.0217s/iter; left time: 209.4217s
	iters: 600, epoch: 2 | loss: 0.5978801
	speed: 0.0219s/iter; left time: 209.2928s
	iters: 700, epoch: 2 | loss: 0.6570389
	speed: 0.0221s/iter; left time: 208.6110s
	iters: 800, epoch: 2 | loss: 0.5307811
	speed: 0.0222s/iter; left time: 207.4791s
	iters: 900, epoch: 2 | loss: 0.7980775
	speed: 0.0223s/iter; left time: 206.0937s
	iters: 1000, epoch: 2 | loss: 0.6080972
	speed: 0.0221s/iter; left time: 201.9935s
	iters: 1100, epoch: 2 | loss: 0.7787670
	speed: 0.0219s/iter; left time: 198.1923s
Epoch: 2 cost time: 24.779279470443726
Epoch: 2, Steps: 1128 | Train Loss: 0.6611701 Vali Loss: 0.7128746 Test Loss: 0.3577344
Validation loss decreased (0.718230 --> 0.712875).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5811883
	speed: 0.0225s/iter; left time: 200.5829s
	iters: 200, epoch: 3 | loss: 0.8562067
	speed: 0.0212s/iter; left time: 187.3256s
	iters: 300, epoch: 3 | loss: 0.6145109
	speed: 0.0208s/iter; left time: 181.5203s
	iters: 400, epoch: 3 | loss: 0.5222185
	speed: 0.0213s/iter; left time: 184.1354s
	iters: 500, epoch: 3 | loss: 0.7887709
	speed: 0.0217s/iter; left time: 184.7867s
	iters: 600, epoch: 3 | loss: 0.5569305
	speed: 0.0219s/iter; left time: 184.5173s
	iters: 700, epoch: 3 | loss: 0.4912403
	speed: 0.0221s/iter; left time: 183.6181s
	iters: 800, epoch: 3 | loss: 0.8183901
	speed: 0.0222s/iter; left time: 182.3682s
	iters: 900, epoch: 3 | loss: 0.4730290
	speed: 0.0223s/iter; left time: 180.8891s
	iters: 1000, epoch: 3 | loss: 0.6720043
	speed: 0.0221s/iter; left time: 177.0775s
	iters: 1100, epoch: 3 | loss: 0.5790241
	speed: 0.0219s/iter; left time: 173.3576s
Epoch: 3 cost time: 24.76285171508789
Epoch: 3, Steps: 1128 | Train Loss: 0.6463105 Vali Loss: 0.7095602 Test Loss: 0.3554345
Validation loss decreased (0.712875 --> 0.709560).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5744092
	speed: 0.0220s/iter; left time: 171.4846s
	iters: 200, epoch: 4 | loss: 0.5138620
	speed: 0.0212s/iter; left time: 163.2461s
	iters: 300, epoch: 4 | loss: 0.6875671
	speed: 0.0209s/iter; left time: 158.7850s
	iters: 400, epoch: 4 | loss: 0.5972397
	speed: 0.0210s/iter; left time: 157.4351s
	iters: 500, epoch: 4 | loss: 0.8712710
	speed: 0.0204s/iter; left time: 150.8632s
	iters: 600, epoch: 4 | loss: 0.7666488
	speed: 0.0199s/iter; left time: 145.1854s
	iters: 700, epoch: 4 | loss: 0.7332608
	speed: 0.0196s/iter; left time: 140.9879s
	iters: 800, epoch: 4 | loss: 0.7835456
	speed: 0.0194s/iter; left time: 137.4012s
	iters: 900, epoch: 4 | loss: 0.5701711
	speed: 0.0192s/iter; left time: 134.1400s
	iters: 1000, epoch: 4 | loss: 0.7584953
	speed: 0.0196s/iter; left time: 134.8657s
	iters: 1100, epoch: 4 | loss: 0.6394051
	speed: 0.0199s/iter; left time: 135.0663s
Epoch: 4 cost time: 22.625207662582397
Epoch: 4, Steps: 1128 | Train Loss: 0.6364325 Vali Loss: 0.7163950 Test Loss: 0.3554049
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5952079
	speed: 0.0219s/iter; left time: 146.1610s
	iters: 200, epoch: 5 | loss: 1.0468565
	speed: 0.0211s/iter; left time: 138.3632s
	iters: 300, epoch: 5 | loss: 0.6568530
	speed: 0.0211s/iter; left time: 136.6400s
	iters: 400, epoch: 5 | loss: 0.7973171
	speed: 0.0216s/iter; left time: 137.6002s
	iters: 500, epoch: 5 | loss: 0.5326986
	speed: 0.0219s/iter; left time: 137.1998s
	iters: 600, epoch: 5 | loss: 0.4639231
	speed: 0.0221s/iter; left time: 136.1663s
	iters: 700, epoch: 5 | loss: 0.6939381
	speed: 0.0222s/iter; left time: 134.8121s
	iters: 800, epoch: 5 | loss: 0.6458188
	speed: 0.0223s/iter; left time: 133.1846s
	iters: 900, epoch: 5 | loss: 0.6594026
	speed: 0.0224s/iter; left time: 131.4072s
	iters: 1000, epoch: 5 | loss: 0.5697328
	speed: 0.0225s/iter; left time: 129.5523s
	iters: 1100, epoch: 5 | loss: 0.8522705
	speed: 0.0225s/iter; left time: 127.5900s
Epoch: 5 cost time: 25.529902935028076
Epoch: 5, Steps: 1128 | Train Loss: 0.6311353 Vali Loss: 0.7158853 Test Loss: 0.3556671
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6546568
	speed: 0.0220s/iter; left time: 121.8916s
	iters: 200, epoch: 6 | loss: 0.6994020
	speed: 0.0211s/iter; left time: 114.5481s
	iters: 300, epoch: 6 | loss: 0.6848523
	speed: 0.0207s/iter; left time: 110.4220s
	iters: 400, epoch: 6 | loss: 0.5942596
	speed: 0.0205s/iter; left time: 107.2682s
	iters: 500, epoch: 6 | loss: 0.5565753
	speed: 0.0200s/iter; left time: 102.6988s
	iters: 600, epoch: 6 | loss: 0.7000925
	speed: 0.0196s/iter; left time: 98.9607s
	iters: 700, epoch: 6 | loss: 0.5666301
	speed: 0.0194s/iter; left time: 95.9771s
	iters: 800, epoch: 6 | loss: 0.5899497
	speed: 0.0193s/iter; left time: 93.2885s
	iters: 900, epoch: 6 | loss: 0.6110256
	speed: 0.0192s/iter; left time: 90.8035s
	iters: 1000, epoch: 6 | loss: 0.5466708
	speed: 0.0191s/iter; left time: 88.4801s
	iters: 1100, epoch: 6 | loss: 0.5628165
	speed: 0.0190s/iter; left time: 86.2364s
Epoch: 6 cost time: 21.467678785324097
Epoch: 6, Steps: 1128 | Train Loss: 0.6277530 Vali Loss: 0.7169150 Test Loss: 0.3566222
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.6158870
	speed: 0.0192s/iter; left time: 84.7394s
	iters: 200, epoch: 7 | loss: 0.5210224
	speed: 0.0187s/iter; left time: 80.5460s
	iters: 300, epoch: 7 | loss: 0.6163947
	speed: 0.0185s/iter; left time: 78.0497s
	iters: 400, epoch: 7 | loss: 0.5884934
	speed: 0.0184s/iter; left time: 75.8681s
	iters: 500, epoch: 7 | loss: 0.7355038
	speed: 0.0184s/iter; left time: 73.8611s
	iters: 600, epoch: 7 | loss: 0.5811588
	speed: 0.0184s/iter; left time: 71.8903s
	iters: 700, epoch: 7 | loss: 0.5409223
	speed: 0.0183s/iter; left time: 69.9632s
	iters: 800, epoch: 7 | loss: 0.5295593
	speed: 0.0178s/iter; left time: 66.0733s
	iters: 900, epoch: 7 | loss: 0.5405796
	speed: 0.0174s/iter; left time: 62.7931s
	iters: 1000, epoch: 7 | loss: 0.5082739
	speed: 0.0171s/iter; left time: 59.9029s
	iters: 1100, epoch: 7 | loss: 0.5143737
	speed: 0.0168s/iter; left time: 57.3621s
Epoch: 7 cost time: 19.048425674438477
Epoch: 7, Steps: 1128 | Train Loss: 0.6260378 Vali Loss: 0.7167481 Test Loss: 0.3561512
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4900216
	speed: 0.0191s/iter; left time: 62.6002s
	iters: 200, epoch: 8 | loss: 0.6216291
	speed: 0.0186s/iter; left time: 59.3136s
	iters: 300, epoch: 8 | loss: 0.6000643
	speed: 0.0185s/iter; left time: 57.0516s
	iters: 400, epoch: 8 | loss: 0.8000063
	speed: 0.0184s/iter; left time: 54.9983s
	iters: 500, epoch: 8 | loss: 0.5552097
	speed: 0.0184s/iter; left time: 53.0218s
	iters: 600, epoch: 8 | loss: 0.6259118
	speed: 0.0183s/iter; left time: 51.0922s
	iters: 700, epoch: 8 | loss: 0.5782518
	speed: 0.0183s/iter; left time: 49.2063s
	iters: 800, epoch: 8 | loss: 0.6395412
	speed: 0.0183s/iter; left time: 47.3745s
	iters: 900, epoch: 8 | loss: 0.5016521
	speed: 0.0183s/iter; left time: 45.4979s
	iters: 1000, epoch: 8 | loss: 0.4990281
	speed: 0.0183s/iter; left time: 43.6609s
	iters: 1100, epoch: 8 | loss: 0.6241581
	speed: 0.0183s/iter; left time: 41.8150s
Epoch: 8 cost time: 20.698181867599487
Epoch: 8, Steps: 1128 | Train Loss: 0.6252654 Vali Loss: 0.7185481 Test Loss: 0.3562937
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCTrue_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.355434387922287, mae:0.35074830055236816
