nohup: ignoring input
Seed: 42
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_96       Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.7953855
	speed: 0.0443s/iter; left time: 503.2685s
	iters: 200, epoch: 1 | loss: 0.3626766
	speed: 0.0360s/iter; left time: 405.3881s
	iters: 300, epoch: 1 | loss: 0.5521462
	speed: 0.0364s/iter; left time: 407.0371s
	iters: 400, epoch: 1 | loss: 0.2737295
	speed: 0.0368s/iter; left time: 407.1815s
	iters: 500, epoch: 1 | loss: 0.3089266
	speed: 0.0372s/iter; left time: 408.5648s
	iters: 600, epoch: 1 | loss: 0.2752015
	speed: 0.0373s/iter; left time: 405.4546s
	iters: 700, epoch: 1 | loss: 0.3326591
	speed: 0.0372s/iter; left time: 400.2833s
	iters: 800, epoch: 1 | loss: 0.2194513
	speed: 0.0371s/iter; left time: 395.5385s
	iters: 900, epoch: 1 | loss: 0.2911557
	speed: 0.0351s/iter; left time: 371.3274s
	iters: 1000, epoch: 1 | loss: 0.3137668
	speed: 0.0332s/iter; left time: 347.9685s
	iters: 1100, epoch: 1 | loss: 0.3730767
	speed: 0.0317s/iter; left time: 328.6321s
Epoch: 1 cost time: 35.70300531387329
Epoch: 1, Steps: 1147 | Train Loss: 0.4520755 Vali Loss: 0.4033223 Test Loss: 0.1730466
Validation loss decreased (inf --> 0.403322).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4375588
	speed: 0.0421s/iter; left time: 430.2071s
	iters: 200, epoch: 2 | loss: 0.2698121
	speed: 0.0394s/iter; left time: 398.6168s
	iters: 300, epoch: 2 | loss: 0.4416811
	speed: 0.0382s/iter; left time: 383.1173s
	iters: 400, epoch: 2 | loss: 0.2434595
	speed: 0.0377s/iter; left time: 374.0639s
	iters: 500, epoch: 2 | loss: 0.2975368
	speed: 0.0374s/iter; left time: 367.1865s
	iters: 600, epoch: 2 | loss: 0.3810591
	speed: 0.0357s/iter; left time: 346.8163s
	iters: 700, epoch: 2 | loss: 0.2953540
	speed: 0.0336s/iter; left time: 323.3532s
	iters: 800, epoch: 2 | loss: 1.0742736
	speed: 0.0316s/iter; left time: 300.9859s
	iters: 900, epoch: 2 | loss: 0.3726723
	speed: 0.0303s/iter; left time: 285.3443s
	iters: 1000, epoch: 2 | loss: 0.2339188
	speed: 0.0292s/iter; left time: 271.9466s
	iters: 1100, epoch: 2 | loss: 0.3218540
	speed: 0.0283s/iter; left time: 261.3382s
Epoch: 2 cost time: 32.30380916595459
Epoch: 2, Steps: 1147 | Train Loss: 0.4096016 Vali Loss: 0.3983376 Test Loss: 0.1662423
Validation loss decreased (0.403322 --> 0.398338).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 1.1838080
	speed: 0.0407s/iter; left time: 369.8234s
	iters: 200, epoch: 3 | loss: 0.3981869
	speed: 0.0382s/iter; left time: 343.1146s
	iters: 300, epoch: 3 | loss: 0.2504291
	speed: 0.0379s/iter; left time: 336.7591s
	iters: 400, epoch: 3 | loss: 0.2937608
	speed: 0.0381s/iter; left time: 334.2237s
	iters: 500, epoch: 3 | loss: 0.5054668
	speed: 0.0349s/iter; left time: 302.5270s
	iters: 600, epoch: 3 | loss: 0.2944097
	speed: 0.0326s/iter; left time: 279.8076s
	iters: 700, epoch: 3 | loss: 0.5610875
	speed: 0.0309s/iter; left time: 261.7446s
	iters: 800, epoch: 3 | loss: 0.3749504
	speed: 0.0289s/iter; left time: 241.8832s
	iters: 900, epoch: 3 | loss: 1.1722870
	speed: 0.0276s/iter; left time: 228.6284s
	iters: 1000, epoch: 3 | loss: 0.3627563
	speed: 0.0263s/iter; left time: 214.8409s
	iters: 1100, epoch: 3 | loss: 0.2372229
	speed: 0.0256s/iter; left time: 206.5463s
Epoch: 3 cost time: 29.262074947357178
Epoch: 3, Steps: 1147 | Train Loss: 0.3876670 Vali Loss: 0.3939281 Test Loss: 0.1652206
Validation loss decreased (0.398338 --> 0.393928).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2967281
	speed: 0.0320s/iter; left time: 254.0157s
	iters: 200, epoch: 4 | loss: 0.2212304
	speed: 0.0345s/iter; left time: 270.2254s
	iters: 300, epoch: 4 | loss: 0.3471538
	speed: 0.0359s/iter; left time: 277.4593s
	iters: 400, epoch: 4 | loss: 0.2727395
	speed: 0.0352s/iter; left time: 268.2342s
	iters: 500, epoch: 4 | loss: 0.3192453
	speed: 0.0345s/iter; left time: 259.5487s
	iters: 600, epoch: 4 | loss: 1.1977832
	speed: 0.0327s/iter; left time: 242.9720s
	iters: 700, epoch: 4 | loss: 1.0240515
	speed: 0.0307s/iter; left time: 225.3568s
	iters: 800, epoch: 4 | loss: 0.3034924
	speed: 0.0294s/iter; left time: 212.2455s
	iters: 900, epoch: 4 | loss: 0.2270487
	speed: 0.0288s/iter; left time: 205.2122s
	iters: 1000, epoch: 4 | loss: 1.2190379
	speed: 0.0284s/iter; left time: 199.9662s
	iters: 1100, epoch: 4 | loss: 0.2722258
	speed: 0.0281s/iter; left time: 194.6726s
Epoch: 4 cost time: 32.16907024383545
Epoch: 4, Steps: 1147 | Train Loss: 0.3761248 Vali Loss: 0.3974173 Test Loss: 0.1692583
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2606975
	speed: 0.0421s/iter; left time: 285.6497s
	iters: 200, epoch: 5 | loss: 1.2375045
	speed: 0.0388s/iter; left time: 259.6052s
	iters: 300, epoch: 5 | loss: 0.2312474
	speed: 0.0336s/iter; left time: 220.8717s
	iters: 400, epoch: 5 | loss: 0.4307126
	speed: 0.0309s/iter; left time: 200.4008s
	iters: 500, epoch: 5 | loss: 0.2730943
	speed: 0.0292s/iter; left time: 186.1275s
	iters: 600, epoch: 5 | loss: 0.2407034
	speed: 0.0281s/iter; left time: 176.4344s
	iters: 700, epoch: 5 | loss: 0.3534728
	speed: 0.0269s/iter; left time: 166.1707s
	iters: 800, epoch: 5 | loss: 0.2907291
	speed: 0.0263s/iter; left time: 160.0006s
	iters: 900, epoch: 5 | loss: 0.2966208
	speed: 0.0259s/iter; left time: 155.1213s
	iters: 1000, epoch: 5 | loss: 0.2437934
	speed: 0.0256s/iter; left time: 150.4781s
	iters: 1100, epoch: 5 | loss: 0.2365708
	speed: 0.0251s/iter; left time: 144.9299s
Epoch: 5 cost time: 28.791143894195557
Epoch: 5, Steps: 1147 | Train Loss: 0.3701516 Vali Loss: 0.3985247 Test Loss: 0.1694501
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1987860
	speed: 0.0418s/iter; left time: 235.3449s
	iters: 200, epoch: 6 | loss: 0.1872487
	speed: 0.0401s/iter; left time: 221.9642s
	iters: 300, epoch: 6 | loss: 0.1992228
	speed: 0.0383s/iter; left time: 208.1095s
	iters: 400, epoch: 6 | loss: 0.3522650
	speed: 0.0354s/iter; left time: 188.6301s
	iters: 500, epoch: 6 | loss: 0.2656863
	speed: 0.0328s/iter; left time: 171.9220s
	iters: 600, epoch: 6 | loss: 0.3799525
	speed: 0.0311s/iter; left time: 159.9697s
	iters: 700, epoch: 6 | loss: 0.2467381
	speed: 0.0301s/iter; left time: 151.3397s
	iters: 800, epoch: 6 | loss: 0.2402915
	speed: 0.0291s/iter; left time: 143.4089s
	iters: 900, epoch: 6 | loss: 0.3283761
	speed: 0.0281s/iter; left time: 136.0046s
	iters: 1000, epoch: 6 | loss: 0.2120143
	speed: 0.0272s/iter; left time: 128.9997s
	iters: 1100, epoch: 6 | loss: 0.2576784
	speed: 0.0264s/iter; left time: 122.4611s
Epoch: 6 cost time: 30.411380767822266
Epoch: 6, Steps: 1147 | Train Loss: 0.3673096 Vali Loss: 0.3960609 Test Loss: 0.1676399
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4712659
	speed: 0.0294s/iter; left time: 131.9443s
	iters: 200, epoch: 7 | loss: 0.3003213
	speed: 0.0259s/iter; left time: 113.7508s
	iters: 300, epoch: 7 | loss: 0.1835427
	speed: 0.0249s/iter; left time: 106.8459s
	iters: 400, epoch: 7 | loss: 0.2359769
	speed: 0.0241s/iter; left time: 100.8859s
	iters: 500, epoch: 7 | loss: 0.1847963
	speed: 0.0236s/iter; left time: 96.4421s
	iters: 600, epoch: 7 | loss: 0.2199489
	speed: 0.0233s/iter; left time: 92.8512s
	iters: 700, epoch: 7 | loss: 0.2068367
	speed: 0.0231s/iter; left time: 89.9453s
	iters: 800, epoch: 7 | loss: 0.5115856
	speed: 0.0228s/iter; left time: 86.5757s
	iters: 900, epoch: 7 | loss: 0.4229795
	speed: 0.0224s/iter; left time: 82.7259s
	iters: 1000, epoch: 7 | loss: 0.2216961
	speed: 0.0220s/iter; left time: 79.0710s
	iters: 1100, epoch: 7 | loss: 0.2062301
	speed: 0.0220s/iter; left time: 76.6511s
Epoch: 7 cost time: 25.29853916168213
Epoch: 7, Steps: 1147 | Train Loss: 0.3658879 Vali Loss: 0.3954066 Test Loss: 0.1667174
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3993835
	speed: 0.0422s/iter; left time: 141.1687s
	iters: 200, epoch: 8 | loss: 0.2395942
	speed: 0.0385s/iter; left time: 124.9116s
	iters: 300, epoch: 8 | loss: 0.3860789
	speed: 0.0350s/iter; left time: 110.1209s
	iters: 400, epoch: 8 | loss: 0.2399480
	speed: 0.0315s/iter; left time: 95.7394s
	iters: 500, epoch: 8 | loss: 0.5889062
	speed: 0.0296s/iter; left time: 86.9423s
	iters: 600, epoch: 8 | loss: 0.2676002
	speed: 0.0293s/iter; left time: 83.1611s
	iters: 700, epoch: 8 | loss: 0.4301048
	speed: 0.0282s/iter; left time: 77.3172s
	iters: 800, epoch: 8 | loss: 0.3209175
	speed: 0.0271s/iter; left time: 71.7184s
	iters: 900, epoch: 8 | loss: 0.2139423
	speed: 0.0264s/iter; left time: 67.1967s
	iters: 1000, epoch: 8 | loss: 0.3185410
	speed: 0.0259s/iter; left time: 63.1567s
	iters: 1100, epoch: 8 | loss: 0.2873052
	speed: 0.0255s/iter; left time: 59.6138s
Epoch: 8 cost time: 29.218859434127808
Epoch: 8, Steps: 1147 | Train Loss: 0.3647099 Vali Loss: 0.3952584 Test Loss: 0.1662654
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.6387844085693359, mae:0.6200176477432251
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.3808336
	speed: 0.0260s/iter; left time: 295.8862s
	iters: 200, epoch: 1 | loss: 0.3693194
	speed: 0.0240s/iter; left time: 270.0226s
	iters: 300, epoch: 1 | loss: 0.2836139
	speed: 0.0234s/iter; left time: 261.4334s
	iters: 400, epoch: 1 | loss: 0.3042329
	speed: 0.0231s/iter; left time: 255.4063s
	iters: 500, epoch: 1 | loss: 0.2771841
	speed: 0.0224s/iter; left time: 245.6364s
	iters: 600, epoch: 1 | loss: 0.3046757
	speed: 0.0216s/iter; left time: 235.0759s
	iters: 700, epoch: 1 | loss: 0.2848907
	speed: 0.0213s/iter; left time: 229.9074s
	iters: 800, epoch: 1 | loss: 0.3229556
	speed: 0.0204s/iter; left time: 217.7096s
	iters: 900, epoch: 1 | loss: 0.3080397
	speed: 0.0199s/iter; left time: 209.9846s
	iters: 1000, epoch: 1 | loss: 0.2909594
	speed: 0.0200s/iter; left time: 209.4326s
	iters: 1100, epoch: 1 | loss: 0.4809674
	speed: 0.0200s/iter; left time: 207.0139s
Epoch: 1 cost time: 23.001394510269165
Epoch: 1, Steps: 1147 | Train Loss: 0.4546374 Vali Loss: 0.4054224 Test Loss: 0.1792369
Validation loss decreased (inf --> 0.405422).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6216957
	speed: 0.0298s/iter; left time: 304.8433s
	iters: 200, epoch: 2 | loss: 0.3084500
	speed: 0.0274s/iter; left time: 277.2273s
	iters: 300, epoch: 2 | loss: 0.4733906
	speed: 0.0266s/iter; left time: 266.2149s
	iters: 400, epoch: 2 | loss: 0.2622218
	speed: 0.0271s/iter; left time: 268.5659s
	iters: 500, epoch: 2 | loss: 0.2954412
	speed: 0.0279s/iter; left time: 274.5625s
	iters: 600, epoch: 2 | loss: 0.2943522
	speed: 0.0269s/iter; left time: 261.8725s
	iters: 700, epoch: 2 | loss: 0.4140450
	speed: 0.0254s/iter; left time: 244.7326s
	iters: 800, epoch: 2 | loss: 0.4884470
	speed: 0.0245s/iter; left time: 233.6489s
	iters: 900, epoch: 2 | loss: 0.4640092
	speed: 0.0246s/iter; left time: 232.0616s
	iters: 1000, epoch: 2 | loss: 0.3509914
	speed: 0.0241s/iter; left time: 225.0315s
	iters: 1100, epoch: 2 | loss: 0.3504867
	speed: 0.0244s/iter; left time: 225.2202s
Epoch: 2 cost time: 28.25883436203003
Epoch: 2, Steps: 1147 | Train Loss: 0.4122177 Vali Loss: 0.3996982 Test Loss: 0.1748969
Validation loss decreased (0.405422 --> 0.399698).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3252628
	speed: 0.0430s/iter; left time: 390.3679s
	iters: 200, epoch: 3 | loss: 0.2999305
	speed: 0.0388s/iter; left time: 348.1868s
	iters: 300, epoch: 3 | loss: 0.2679106
	speed: 0.0359s/iter; left time: 319.0078s
	iters: 400, epoch: 3 | loss: 0.3102100
	speed: 0.0328s/iter; left time: 288.1435s
	iters: 500, epoch: 3 | loss: 0.2202379
	speed: 0.0308s/iter; left time: 266.9533s
	iters: 600, epoch: 3 | loss: 0.3395083
	speed: 0.0293s/iter; left time: 251.5087s
	iters: 700, epoch: 3 | loss: 0.2785600
	speed: 0.0282s/iter; left time: 238.7868s
	iters: 800, epoch: 3 | loss: 0.3197916
	speed: 0.0271s/iter; left time: 226.7647s
	iters: 900, epoch: 3 | loss: 0.3363566
	speed: 0.0262s/iter; left time: 217.0326s
	iters: 1000, epoch: 3 | loss: 0.3797730
	speed: 0.0257s/iter; left time: 210.5169s
	iters: 1100, epoch: 3 | loss: 0.2684952
	speed: 0.0253s/iter; left time: 204.7274s
Epoch: 3 cost time: 29.027337312698364
Epoch: 3, Steps: 1147 | Train Loss: 0.3905588 Vali Loss: 0.3932604 Test Loss: 0.1650483
Validation loss decreased (0.399698 --> 0.393260).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 1.0291761
	speed: 0.0350s/iter; left time: 277.8486s
	iters: 200, epoch: 4 | loss: 0.2154385
	speed: 0.0284s/iter; left time: 222.2593s
	iters: 300, epoch: 4 | loss: 0.4269912
	speed: 0.0274s/iter; left time: 211.5470s
	iters: 400, epoch: 4 | loss: 0.5647081
	speed: 0.0263s/iter; left time: 200.7645s
	iters: 500, epoch: 4 | loss: 0.2190785
	speed: 0.0249s/iter; left time: 187.4420s
	iters: 600, epoch: 4 | loss: 0.2606159
	speed: 0.0246s/iter; left time: 183.1336s
	iters: 700, epoch: 4 | loss: 1.9716952
	speed: 0.0241s/iter; left time: 176.7498s
	iters: 800, epoch: 4 | loss: 0.2384685
	speed: 0.0231s/iter; left time: 167.0693s
	iters: 900, epoch: 4 | loss: 0.2025570
	speed: 0.0222s/iter; left time: 158.3993s
	iters: 1000, epoch: 4 | loss: 0.2894436
	speed: 0.0221s/iter; left time: 155.0691s
	iters: 1100, epoch: 4 | loss: 0.3869477
	speed: 0.0221s/iter; left time: 153.2131s
Epoch: 4 cost time: 26.095664024353027
Epoch: 4, Steps: 1147 | Train Loss: 0.3791859 Vali Loss: 0.3982899 Test Loss: 0.1688087
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 1.2802981
	speed: 0.0313s/iter; left time: 212.6308s
	iters: 200, epoch: 5 | loss: 0.3188133
	speed: 0.0274s/iter; left time: 182.9095s
	iters: 300, epoch: 5 | loss: 0.2839259
	speed: 0.0257s/iter; left time: 168.8933s
	iters: 400, epoch: 5 | loss: 0.1969764
	speed: 0.0244s/iter; left time: 158.3017s
	iters: 500, epoch: 5 | loss: 0.2962900
	speed: 0.0240s/iter; left time: 153.3525s
	iters: 600, epoch: 5 | loss: 0.3142827
	speed: 0.0237s/iter; left time: 148.9484s
	iters: 700, epoch: 5 | loss: 0.2541007
	speed: 0.0234s/iter; left time: 144.6779s
	iters: 800, epoch: 5 | loss: 0.3267866
	speed: 0.0243s/iter; left time: 147.9793s
	iters: 900, epoch: 5 | loss: 0.2401228
	speed: 0.0249s/iter; left time: 149.2127s
	iters: 1000, epoch: 5 | loss: 0.2354156
	speed: 0.0250s/iter; left time: 147.3431s
	iters: 1100, epoch: 5 | loss: 0.3569589
	speed: 0.0250s/iter; left time: 144.5000s
Epoch: 5 cost time: 28.768177032470703
Epoch: 5, Steps: 1147 | Train Loss: 0.3731176 Vali Loss: 0.3966249 Test Loss: 0.1658960
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 1.1776699
	speed: 0.0344s/iter; left time: 194.0076s
	iters: 200, epoch: 6 | loss: 0.2743465
	speed: 0.0304s/iter; left time: 168.4553s
	iters: 300, epoch: 6 | loss: 0.2660850
	speed: 0.0274s/iter; left time: 149.1495s
	iters: 400, epoch: 6 | loss: 0.2446366
	speed: 0.0260s/iter; left time: 138.5862s
	iters: 500, epoch: 6 | loss: 0.2504419
	speed: 0.0255s/iter; left time: 133.5817s
	iters: 600, epoch: 6 | loss: 0.3588326
	speed: 0.0250s/iter; left time: 128.2113s
	iters: 700, epoch: 6 | loss: 0.2379479
	speed: 0.0244s/iter; left time: 122.9470s
	iters: 800, epoch: 6 | loss: 0.2492750
	speed: 0.0240s/iter; left time: 118.4355s
	iters: 900, epoch: 6 | loss: 0.2840056
	speed: 0.0236s/iter; left time: 114.3714s
	iters: 1000, epoch: 6 | loss: 0.3015630
	speed: 0.0237s/iter; left time: 112.1781s
	iters: 1100, epoch: 6 | loss: 0.2882679
	speed: 0.0242s/iter; left time: 112.1738s
Epoch: 6 cost time: 27.88609743118286
Epoch: 6, Steps: 1147 | Train Loss: 0.3699532 Vali Loss: 0.3976809 Test Loss: 0.1658124
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2271932
	speed: 0.0408s/iter; left time: 183.3381s
	iters: 200, epoch: 7 | loss: 0.3437782
	speed: 0.0346s/iter; left time: 151.9784s
	iters: 300, epoch: 7 | loss: 0.1727899
	speed: 0.0285s/iter; left time: 122.3208s
	iters: 400, epoch: 7 | loss: 0.2883409
	speed: 0.0258s/iter; left time: 108.0481s
	iters: 500, epoch: 7 | loss: 0.2365905
	speed: 0.0241s/iter; left time: 98.4662s
	iters: 600, epoch: 7 | loss: 0.3964183
	speed: 0.0226s/iter; left time: 90.3203s
	iters: 700, epoch: 7 | loss: 0.4266467
	speed: 0.0217s/iter; left time: 84.2724s
	iters: 800, epoch: 7 | loss: 1.1431460
	speed: 0.0210s/iter; left time: 79.7520s
	iters: 900, epoch: 7 | loss: 0.6048325
	speed: 0.0211s/iter; left time: 77.9149s
	iters: 1000, epoch: 7 | loss: 0.2810277
	speed: 0.0218s/iter; left time: 78.2356s
	iters: 1100, epoch: 7 | loss: 0.2642635
	speed: 0.0219s/iter; left time: 76.4156s
Epoch: 7 cost time: 25.539275646209717
Epoch: 7, Steps: 1147 | Train Loss: 0.3683896 Vali Loss: 0.3990093 Test Loss: 0.1677666
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.5631124
	speed: 0.0254s/iter; left time: 84.9150s
	iters: 200, epoch: 8 | loss: 0.2741513
	speed: 0.0241s/iter; left time: 78.2192s
	iters: 300, epoch: 8 | loss: 0.2673267
	speed: 0.0235s/iter; left time: 73.9056s
	iters: 400, epoch: 8 | loss: 0.2196321
	speed: 0.0226s/iter; left time: 68.6235s
	iters: 500, epoch: 8 | loss: 0.4103080
	speed: 0.0224s/iter; left time: 65.8264s
	iters: 600, epoch: 8 | loss: 0.2793172
	speed: 0.0223s/iter; left time: 63.4515s
	iters: 700, epoch: 8 | loss: 0.2171162
	speed: 0.0223s/iter; left time: 61.1335s
	iters: 800, epoch: 8 | loss: 0.1660140
	speed: 0.0224s/iter; left time: 59.2232s
	iters: 900, epoch: 8 | loss: 0.2666641
	speed: 0.0225s/iter; left time: 57.1094s
	iters: 1000, epoch: 8 | loss: 0.5774584
	speed: 0.0224s/iter; left time: 54.8221s
	iters: 1100, epoch: 8 | loss: 0.2057257
	speed: 0.0225s/iter; left time: 52.5855s
Epoch: 8 cost time: 25.903343200683594
Epoch: 8, Steps: 1147 | Train Loss: 0.3676909 Vali Loss: 0.3994722 Test Loss: 0.1677107
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.7074810862541199, mae:0.6565431952476501
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.5497294
	speed: 0.0265s/iter; left time: 301.3583s
	iters: 200, epoch: 1 | loss: 0.3102067
	speed: 0.0244s/iter; left time: 275.1346s
	iters: 300, epoch: 1 | loss: 0.3742800
	speed: 0.0239s/iter; left time: 266.8280s
	iters: 400, epoch: 1 | loss: 0.4722163
	speed: 0.0235s/iter; left time: 259.9639s
	iters: 500, epoch: 1 | loss: 0.3182456
	speed: 0.0234s/iter; left time: 257.1004s
	iters: 600, epoch: 1 | loss: 0.3314335
	speed: 0.0230s/iter; left time: 249.6880s
	iters: 700, epoch: 1 | loss: 0.3483171
	speed: 0.0229s/iter; left time: 247.0355s
	iters: 800, epoch: 1 | loss: 0.2689011
	speed: 0.0229s/iter; left time: 244.6911s
	iters: 900, epoch: 1 | loss: 0.3278203
	speed: 0.0229s/iter; left time: 242.0294s
	iters: 1000, epoch: 1 | loss: 0.3237803
	speed: 0.0241s/iter; left time: 252.3518s
	iters: 1100, epoch: 1 | loss: 0.5274920
	speed: 0.0251s/iter; left time: 259.8649s
Epoch: 1 cost time: 29.408432006835938
Epoch: 1, Steps: 1147 | Train Loss: 0.4548116 Vali Loss: 0.3996409 Test Loss: 0.1733470
Validation loss decreased (inf --> 0.399641).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5076995
	speed: 0.0308s/iter; left time: 315.2440s
	iters: 200, epoch: 2 | loss: 0.5752935
	speed: 0.0250s/iter; left time: 253.4475s
	iters: 300, epoch: 2 | loss: 0.3613563
	speed: 0.0242s/iter; left time: 242.3152s
	iters: 400, epoch: 2 | loss: 0.2821990
	speed: 0.0230s/iter; left time: 227.9730s
	iters: 500, epoch: 2 | loss: 0.2038448
	speed: 0.0229s/iter; left time: 224.6886s
	iters: 600, epoch: 2 | loss: 0.4507556
	speed: 0.0218s/iter; left time: 211.9490s
	iters: 700, epoch: 2 | loss: 0.3235974
	speed: 0.0211s/iter; left time: 202.9870s
	iters: 800, epoch: 2 | loss: 0.3028365
	speed: 0.0204s/iter; left time: 194.1196s
	iters: 900, epoch: 2 | loss: 0.4043311
	speed: 0.0201s/iter; left time: 188.9614s
	iters: 1000, epoch: 2 | loss: 0.4199519
	speed: 0.0199s/iter; left time: 185.5182s
	iters: 1100, epoch: 2 | loss: 0.4212090
	speed: 0.0199s/iter; left time: 183.6726s
Epoch: 2 cost time: 23.502796173095703
Epoch: 2, Steps: 1147 | Train Loss: 0.4124720 Vali Loss: 0.3986883 Test Loss: 0.1728397
Validation loss decreased (0.399641 --> 0.398688).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2663478
	speed: 0.0244s/iter; left time: 221.3338s
	iters: 200, epoch: 3 | loss: 0.2957273
	speed: 0.0231s/iter; left time: 207.1647s
	iters: 300, epoch: 3 | loss: 0.2804846
	speed: 0.0247s/iter; left time: 219.3765s
	iters: 400, epoch: 3 | loss: 0.2803361
	speed: 0.0262s/iter; left time: 230.0832s
	iters: 500, epoch: 3 | loss: 0.1994708
	speed: 0.0257s/iter; left time: 222.8913s
	iters: 600, epoch: 3 | loss: 0.2956434
	speed: 0.0250s/iter; left time: 214.5801s
	iters: 700, epoch: 3 | loss: 0.2172401
	speed: 0.0247s/iter; left time: 209.5249s
	iters: 800, epoch: 3 | loss: 0.2051920
	speed: 0.0244s/iter; left time: 204.0306s
	iters: 900, epoch: 3 | loss: 0.2955261
	speed: 0.0241s/iter; left time: 199.3383s
	iters: 1000, epoch: 3 | loss: 0.2453247
	speed: 0.0237s/iter; left time: 194.1872s
	iters: 1100, epoch: 3 | loss: 0.5006340
	speed: 0.0236s/iter; left time: 190.7996s
Epoch: 3 cost time: 27.118422508239746
Epoch: 3, Steps: 1147 | Train Loss: 0.3897992 Vali Loss: 0.4027776 Test Loss: 0.1689741
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 1.3141439
	speed: 0.0355s/iter; left time: 281.3075s
	iters: 200, epoch: 4 | loss: 0.2442405
	speed: 0.0300s/iter; left time: 234.5985s
	iters: 300, epoch: 4 | loss: 0.4894195
	speed: 0.0273s/iter; left time: 210.8678s
	iters: 400, epoch: 4 | loss: 0.2560329
	speed: 0.0263s/iter; left time: 200.9219s
	iters: 500, epoch: 4 | loss: 0.3219570
	speed: 0.0255s/iter; left time: 191.9212s
	iters: 600, epoch: 4 | loss: 0.2510253
	speed: 0.0250s/iter; left time: 185.6762s
	iters: 700, epoch: 4 | loss: 0.3352245
	speed: 0.0245s/iter; left time: 179.3991s
	iters: 800, epoch: 4 | loss: 0.2213777
	speed: 0.0242s/iter; left time: 175.2342s
	iters: 900, epoch: 4 | loss: 0.2691173
	speed: 0.0240s/iter; left time: 171.3067s
	iters: 1000, epoch: 4 | loss: 0.1874374
	speed: 0.0237s/iter; left time: 166.6744s
	iters: 1100, epoch: 4 | loss: 0.4769219
	speed: 0.0236s/iter; left time: 163.8730s
Epoch: 4 cost time: 27.24724841117859
Epoch: 4, Steps: 1147 | Train Loss: 0.3787324 Vali Loss: 0.4048696 Test Loss: 0.1707549
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 1.1792932
	speed: 0.0275s/iter; left time: 186.2760s
	iters: 200, epoch: 5 | loss: 0.2821985
	speed: 0.0249s/iter; left time: 166.4265s
	iters: 300, epoch: 5 | loss: 0.3834792
	speed: 0.0243s/iter; left time: 159.6456s
	iters: 400, epoch: 5 | loss: 0.2794270
	speed: 0.0244s/iter; left time: 158.4459s
	iters: 500, epoch: 5 | loss: 0.2387080
	speed: 0.0245s/iter; left time: 156.5765s
	iters: 600, epoch: 5 | loss: 0.4151936
	speed: 0.0246s/iter; left time: 154.4255s
	iters: 700, epoch: 5 | loss: 0.4727872
	speed: 0.0246s/iter; left time: 151.9191s
	iters: 800, epoch: 5 | loss: 0.2554510
	speed: 0.0240s/iter; left time: 146.1730s
	iters: 900, epoch: 5 | loss: 0.4033743
	speed: 0.0233s/iter; left time: 139.5569s
	iters: 1000, epoch: 5 | loss: 0.4084284
	speed: 0.0232s/iter; left time: 136.2895s
	iters: 1100, epoch: 5 | loss: 0.2875169
	speed: 0.0227s/iter; left time: 131.0878s
Epoch: 5 cost time: 25.904316425323486
Epoch: 5, Steps: 1147 | Train Loss: 0.3730677 Vali Loss: 0.4012711 Test Loss: 0.1681809
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2158622
	speed: 0.0207s/iter; left time: 116.6658s
	iters: 200, epoch: 6 | loss: 0.2344638
	speed: 0.0214s/iter; left time: 118.2192s
	iters: 300, epoch: 6 | loss: 0.3123546
	speed: 0.0219s/iter; left time: 119.2115s
	iters: 400, epoch: 6 | loss: 1.4475991
	speed: 0.0223s/iter; left time: 118.9692s
	iters: 500, epoch: 6 | loss: 0.2427865
	speed: 0.0226s/iter; left time: 118.4990s
	iters: 600, epoch: 6 | loss: 0.3264360
	speed: 0.0229s/iter; left time: 117.6541s
	iters: 700, epoch: 6 | loss: 0.3833994
	speed: 0.0232s/iter; left time: 117.0596s
	iters: 800, epoch: 6 | loss: 1.0381565
	speed: 0.0234s/iter; left time: 115.5169s
	iters: 900, epoch: 6 | loss: 0.2797845
	speed: 0.0236s/iter; left time: 113.8942s
	iters: 1000, epoch: 6 | loss: 0.2164397
	speed: 0.0235s/iter; left time: 111.3230s
	iters: 1100, epoch: 6 | loss: 0.2551799
	speed: 0.0233s/iter; left time: 108.1804s
Epoch: 6 cost time: 26.901900053024292
Epoch: 6, Steps: 1147 | Train Loss: 0.3697916 Vali Loss: 0.4020801 Test Loss: 0.1698652
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2916372
	speed: 0.0291s/iter; left time: 130.4836s
	iters: 200, epoch: 7 | loss: 0.2552353
	speed: 0.0263s/iter; left time: 115.4312s
	iters: 300, epoch: 7 | loss: 0.2591233
	speed: 0.0264s/iter; left time: 113.4145s
	iters: 400, epoch: 7 | loss: 0.3134119
	speed: 0.0253s/iter; left time: 105.9230s
	iters: 500, epoch: 7 | loss: 0.2107744
	speed: 0.0258s/iter; left time: 105.5508s
	iters: 600, epoch: 7 | loss: 0.3151574
	speed: 0.0258s/iter; left time: 103.0717s
	iters: 700, epoch: 7 | loss: 0.5140855
	speed: 0.0257s/iter; left time: 99.8712s
	iters: 800, epoch: 7 | loss: 0.3494576
	speed: 0.0256s/iter; left time: 97.1725s
	iters: 900, epoch: 7 | loss: 0.2932816
	speed: 0.0255s/iter; left time: 94.0674s
	iters: 1000, epoch: 7 | loss: 0.2592780
	speed: 0.0252s/iter; left time: 90.3919s
	iters: 1100, epoch: 7 | loss: 0.1954021
	speed: 0.0249s/iter; left time: 87.0012s
Epoch: 7 cost time: 28.6167209148407
Epoch: 7, Steps: 1147 | Train Loss: 0.3683899 Vali Loss: 0.4017244 Test Loss: 0.1698002
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.8084670305252075, mae:0.7383777499198914
Seed: 42
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_192      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.4279345
	speed: 0.0397s/iter; left time: 450.6371s
	iters: 200, epoch: 1 | loss: 0.4436807
	speed: 0.0311s/iter; left time: 349.0644s
	iters: 300, epoch: 1 | loss: 0.3873877
	speed: 0.0283s/iter; left time: 315.6200s
	iters: 400, epoch: 1 | loss: 0.3720721
	speed: 0.0269s/iter; left time: 296.9955s
	iters: 500, epoch: 1 | loss: 0.3748517
	speed: 0.0255s/iter; left time: 279.2672s
	iters: 600, epoch: 1 | loss: 0.5318221
	speed: 0.0243s/iter; left time: 263.2426s
	iters: 700, epoch: 1 | loss: 0.4574275
	speed: 0.0234s/iter; left time: 251.0630s
	iters: 800, epoch: 1 | loss: 0.5357047
	speed: 0.0227s/iter; left time: 241.3722s
	iters: 900, epoch: 1 | loss: 0.5076485
	speed: 0.0218s/iter; left time: 229.8570s
	iters: 1000, epoch: 1 | loss: 0.6858152
	speed: 0.0215s/iter; left time: 224.3219s
	iters: 1100, epoch: 1 | loss: 0.3819483
	speed: 0.0222s/iter; left time: 229.7919s
Epoch: 1 cost time: 25.483805656433105
Epoch: 1, Steps: 1144 | Train Loss: 0.5066824 Vali Loss: 0.4597033 Test Loss: 0.2180576
Validation loss decreased (inf --> 0.459703).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9086326
	speed: 0.0356s/iter; left time: 363.2343s
	iters: 200, epoch: 2 | loss: 0.5189632
	speed: 0.0301s/iter; left time: 303.9112s
	iters: 300, epoch: 2 | loss: 0.3538214
	speed: 0.0283s/iter; left time: 282.6661s
	iters: 400, epoch: 2 | loss: 0.3929717
	speed: 0.0267s/iter; left time: 264.5101s
	iters: 500, epoch: 2 | loss: 0.4197912
	speed: 0.0261s/iter; left time: 256.0013s
	iters: 600, epoch: 2 | loss: 0.3332335
	speed: 0.0268s/iter; left time: 259.7779s
	iters: 700, epoch: 2 | loss: 0.3512102
	speed: 0.0259s/iter; left time: 248.4586s
	iters: 800, epoch: 2 | loss: 0.8438689
	speed: 0.0256s/iter; left time: 242.9543s
	iters: 900, epoch: 2 | loss: 0.4519767
	speed: 0.0267s/iter; left time: 251.2852s
	iters: 1000, epoch: 2 | loss: 0.4098434
	speed: 0.0265s/iter; left time: 245.9091s
	iters: 1100, epoch: 2 | loss: 0.3992862
	speed: 0.0262s/iter; left time: 240.8879s
Epoch: 2 cost time: 29.871082544326782
Epoch: 2, Steps: 1144 | Train Loss: 0.4681052 Vali Loss: 0.4626841 Test Loss: 0.2191432
EarlyStopping counter: 1 out of 5
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3613050
	speed: 0.0396s/iter; left time: 358.4838s
	iters: 200, epoch: 3 | loss: 0.3435106
	speed: 0.0396s/iter; left time: 354.6871s
	iters: 300, epoch: 3 | loss: 0.3351871
	speed: 0.0374s/iter; left time: 331.3193s
	iters: 400, epoch: 3 | loss: 0.2570263
	speed: 0.0349s/iter; left time: 305.1552s
	iters: 500, epoch: 3 | loss: 0.3431586
	speed: 0.0324s/iter; left time: 280.4114s
	iters: 600, epoch: 3 | loss: 0.4492099
	speed: 0.0311s/iter; left time: 266.0614s
	iters: 700, epoch: 3 | loss: 0.4385392
	speed: 0.0311s/iter; left time: 262.5772s
	iters: 800, epoch: 3 | loss: 0.3290989
	speed: 0.0317s/iter; left time: 264.4895s
	iters: 900, epoch: 3 | loss: 0.3323340
	speed: 0.0312s/iter; left time: 257.7114s
	iters: 1000, epoch: 3 | loss: 0.3777905
	speed: 0.0303s/iter; left time: 247.2862s
	iters: 1100, epoch: 3 | loss: 0.3907191
	speed: 0.0296s/iter; left time: 238.0644s
Epoch: 3 cost time: 33.62232947349548
Epoch: 3, Steps: 1144 | Train Loss: 0.4461307 Vali Loss: 0.4563648 Test Loss: 0.2134382
Validation loss decreased (0.459703 --> 0.456365).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3703069
	speed: 0.0279s/iter; left time: 220.8474s
	iters: 200, epoch: 4 | loss: 0.6297817
	speed: 0.0243s/iter; left time: 189.3778s
	iters: 300, epoch: 4 | loss: 0.4312519
	speed: 0.0225s/iter; left time: 173.6724s
	iters: 400, epoch: 4 | loss: 0.3304624
	speed: 0.0210s/iter; left time: 159.6577s
	iters: 500, epoch: 4 | loss: 0.3304713
	speed: 0.0207s/iter; left time: 155.7546s
	iters: 600, epoch: 4 | loss: 0.3074133
	speed: 0.0211s/iter; left time: 155.9784s
	iters: 700, epoch: 4 | loss: 0.3096736
	speed: 0.0206s/iter; left time: 150.7678s
	iters: 800, epoch: 4 | loss: 0.8583981
	speed: 0.0203s/iter; left time: 146.6455s
	iters: 900, epoch: 4 | loss: 0.2512006
	speed: 0.0203s/iter; left time: 144.4041s
	iters: 1000, epoch: 4 | loss: 0.4049010
	speed: 0.0202s/iter; left time: 141.5945s
	iters: 1100, epoch: 4 | loss: 0.3664806
	speed: 0.0201s/iter; left time: 138.9580s
Epoch: 4 cost time: 23.05497908592224
Epoch: 4, Steps: 1144 | Train Loss: 0.4341123 Vali Loss: 0.4562215 Test Loss: 0.2161650
Validation loss decreased (0.456365 --> 0.456222).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2676366
	speed: 0.0290s/iter; left time: 196.0660s
	iters: 200, epoch: 5 | loss: 0.4066040
	speed: 0.0264s/iter; left time: 175.6378s
	iters: 300, epoch: 5 | loss: 0.9465082
	speed: 0.0249s/iter; left time: 163.4598s
	iters: 400, epoch: 5 | loss: 0.5329025
	speed: 0.0244s/iter; left time: 157.5748s
	iters: 500, epoch: 5 | loss: 0.4243713
	speed: 0.0242s/iter; left time: 154.0100s
	iters: 600, epoch: 5 | loss: 0.3752060
	speed: 0.0241s/iter; left time: 150.8544s
	iters: 700, epoch: 5 | loss: 0.3043626
	speed: 0.0240s/iter; left time: 148.1089s
	iters: 800, epoch: 5 | loss: 0.2924313
	speed: 0.0240s/iter; left time: 145.3800s
	iters: 900, epoch: 5 | loss: 0.3873696
	speed: 0.0239s/iter; left time: 142.6919s
	iters: 1000, epoch: 5 | loss: 0.3079708
	speed: 0.0239s/iter; left time: 140.0619s
	iters: 1100, epoch: 5 | loss: 0.4021921
	speed: 0.0239s/iter; left time: 137.5662s
Epoch: 5 cost time: 27.410327434539795
Epoch: 5, Steps: 1144 | Train Loss: 0.4279147 Vali Loss: 0.4556501 Test Loss: 0.2163209
Validation loss decreased (0.456222 --> 0.455650).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5048851
	speed: 0.0264s/iter; left time: 148.2741s
	iters: 200, epoch: 6 | loss: 0.2844384
	speed: 0.0229s/iter; left time: 126.3149s
	iters: 300, epoch: 6 | loss: 0.4442909
	speed: 0.0216s/iter; left time: 117.1771s
	iters: 400, epoch: 6 | loss: 0.3173504
	speed: 0.0200s/iter; left time: 106.6856s
	iters: 500, epoch: 6 | loss: 0.2274996
	speed: 0.0197s/iter; left time: 103.0891s
	iters: 600, epoch: 6 | loss: 0.2758449
	speed: 0.0196s/iter; left time: 100.3595s
	iters: 700, epoch: 6 | loss: 0.3196141
	speed: 0.0195s/iter; left time: 97.6776s
	iters: 800, epoch: 6 | loss: 0.3597493
	speed: 0.0198s/iter; left time: 97.2610s
	iters: 900, epoch: 6 | loss: 0.3740294
	speed: 0.0211s/iter; left time: 101.5366s
	iters: 1000, epoch: 6 | loss: 0.3833942
	speed: 0.0223s/iter; left time: 105.3943s
	iters: 1100, epoch: 6 | loss: 0.4149839
	speed: 0.0233s/iter; left time: 107.7096s
Epoch: 6 cost time: 27.239646434783936
Epoch: 6, Steps: 1144 | Train Loss: 0.4247045 Vali Loss: 0.4587784 Test Loss: 0.2175563
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2629761
	speed: 0.0276s/iter; left time: 123.7644s
	iters: 200, epoch: 7 | loss: 0.4062591
	speed: 0.0250s/iter; left time: 109.3623s
	iters: 300, epoch: 7 | loss: 0.3838516
	speed: 0.0243s/iter; left time: 103.8074s
	iters: 400, epoch: 7 | loss: 0.3923412
	speed: 0.0221s/iter; left time: 92.1800s
	iters: 500, epoch: 7 | loss: 0.3319944
	speed: 0.0206s/iter; left time: 84.1789s
	iters: 600, epoch: 7 | loss: 0.3346070
	speed: 0.0193s/iter; left time: 76.5712s
	iters: 700, epoch: 7 | loss: 0.4530513
	speed: 0.0184s/iter; left time: 71.4451s
	iters: 800, epoch: 7 | loss: 0.3625990
	speed: 0.0177s/iter; left time: 66.7985s
	iters: 900, epoch: 7 | loss: 0.8011298
	speed: 0.0175s/iter; left time: 64.4069s
	iters: 1000, epoch: 7 | loss: 0.7572426
	speed: 0.0178s/iter; left time: 63.6499s
	iters: 1100, epoch: 7 | loss: 0.2801149
	speed: 0.0186s/iter; left time: 64.5480s
Epoch: 7 cost time: 21.759577989578247
Epoch: 7, Steps: 1144 | Train Loss: 0.4230360 Vali Loss: 0.4587633 Test Loss: 0.2180890
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2674927
	speed: 0.0442s/iter; left time: 147.4270s
	iters: 200, epoch: 8 | loss: 0.3347742
	speed: 0.0361s/iter; left time: 116.6905s
	iters: 300, epoch: 8 | loss: 0.3377953
	speed: 0.0312s/iter; left time: 97.6714s
	iters: 400, epoch: 8 | loss: 0.3827765
	speed: 0.0296s/iter; left time: 89.7664s
	iters: 500, epoch: 8 | loss: 0.8816282
	speed: 0.0276s/iter; left time: 81.0954s
	iters: 600, epoch: 8 | loss: 0.2919204
	speed: 0.0264s/iter; left time: 74.8375s
	iters: 700, epoch: 8 | loss: 0.4113485
	speed: 0.0259s/iter; left time: 70.6920s
	iters: 800, epoch: 8 | loss: 0.3334517
	speed: 0.0254s/iter; left time: 66.9620s
	iters: 900, epoch: 8 | loss: 0.4381119
	speed: 0.0251s/iter; left time: 63.6402s
	iters: 1000, epoch: 8 | loss: 0.3858093
	speed: 0.0247s/iter; left time: 60.0947s
	iters: 1100, epoch: 8 | loss: 0.3523150
	speed: 0.0243s/iter; left time: 56.7350s
Epoch: 8 cost time: 27.76477861404419
Epoch: 8, Steps: 1144 | Train Loss: 0.4221294 Vali Loss: 0.4576796 Test Loss: 0.2174189
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.7408453
	speed: 0.0422s/iter; left time: 92.3438s
	iters: 200, epoch: 9 | loss: 0.3309499
	speed: 0.0375s/iter; left time: 78.3662s
	iters: 300, epoch: 9 | loss: 0.2780209
	speed: 0.0354s/iter; left time: 70.3335s
	iters: 400, epoch: 9 | loss: 0.2712159
	speed: 0.0318s/iter; left time: 59.9939s
	iters: 500, epoch: 9 | loss: 0.2242312
	speed: 0.0293s/iter; left time: 52.4124s
	iters: 600, epoch: 9 | loss: 0.3409321
	speed: 0.0279s/iter; left time: 47.0718s
	iters: 700, epoch: 9 | loss: 0.3450761
	speed: 0.0268s/iter; left time: 42.5251s
	iters: 800, epoch: 9 | loss: 0.3354723
	speed: 0.0257s/iter; left time: 38.2666s
	iters: 900, epoch: 9 | loss: 0.3805480
	speed: 0.0258s/iter; left time: 35.8620s
	iters: 1000, epoch: 9 | loss: 0.8232482
	speed: 0.0254s/iter; left time: 32.7484s
	iters: 1100, epoch: 9 | loss: 0.2981588
	speed: 0.0254s/iter; left time: 30.1422s
Epoch: 9 cost time: 29.105123043060303
Epoch: 9, Steps: 1144 | Train Loss: 0.4217514 Vali Loss: 0.4570589 Test Loss: 0.2173453
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3379092
	speed: 0.0366s/iter; left time: 38.2936s
	iters: 200, epoch: 10 | loss: 0.4250949
	speed: 0.0288s/iter; left time: 27.2019s
	iters: 300, epoch: 10 | loss: 0.2526727
	speed: 0.0249s/iter; left time: 21.0507s
	iters: 400, epoch: 10 | loss: 0.3532775
	speed: 0.0226s/iter; left time: 16.8289s
	iters: 500, epoch: 10 | loss: 0.3505039
	speed: 0.0217s/iter; left time: 13.9970s
	iters: 600, epoch: 10 | loss: 0.2562336
	speed: 0.0214s/iter; left time: 11.6361s
	iters: 700, epoch: 10 | loss: 0.7794499
	speed: 0.0210s/iter; left time: 9.3522s
	iters: 800, epoch: 10 | loss: 0.3178305
	speed: 0.0211s/iter; left time: 7.2708s
	iters: 900, epoch: 10 | loss: 0.3368500
	speed: 0.0213s/iter; left time: 5.2093s
	iters: 1000, epoch: 10 | loss: 0.2745964
	speed: 0.0214s/iter; left time: 3.1072s
	iters: 1100, epoch: 10 | loss: 0.2744157
	speed: 0.0217s/iter; left time: 0.9751s
Epoch: 10 cost time: 25.00625991821289
Epoch: 10, Steps: 1144 | Train Loss: 0.4215013 Vali Loss: 0.4580264 Test Loss: 0.2174037
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.5800114274024963, mae:0.5707352161407471
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 1.3433478
	speed: 0.0354s/iter; left time: 401.9272s
	iters: 200, epoch: 1 | loss: 0.3684885
	speed: 0.0287s/iter; left time: 322.7676s
	iters: 300, epoch: 1 | loss: 0.4436567
	speed: 0.0266s/iter; left time: 296.7248s
	iters: 400, epoch: 1 | loss: 0.3475827
	speed: 0.0260s/iter; left time: 287.5725s
	iters: 500, epoch: 1 | loss: 0.5035158
	speed: 0.0252s/iter; left time: 276.2508s
	iters: 600, epoch: 1 | loss: 0.4037590
	speed: 0.0242s/iter; left time: 262.2855s
	iters: 700, epoch: 1 | loss: 0.8387527
	speed: 0.0239s/iter; left time: 256.5703s
	iters: 800, epoch: 1 | loss: 0.8828853
	speed: 0.0236s/iter; left time: 251.6564s
	iters: 900, epoch: 1 | loss: 0.4035853
	speed: 0.0235s/iter; left time: 248.0953s
	iters: 1000, epoch: 1 | loss: 0.3652301
	speed: 0.0236s/iter; left time: 246.4522s
	iters: 1100, epoch: 1 | loss: 0.5518563
	speed: 0.0236s/iter; left time: 244.4310s
Epoch: 1 cost time: 27.106221437454224
Epoch: 1, Steps: 1144 | Train Loss: 0.5088595 Vali Loss: 0.4717577 Test Loss: 0.2185908
Validation loss decreased (inf --> 0.471758).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3605472
	speed: 0.0368s/iter; left time: 374.8350s
	iters: 200, epoch: 2 | loss: 0.4372466
	speed: 0.0352s/iter; left time: 355.0316s
	iters: 300, epoch: 2 | loss: 0.7933570
	speed: 0.0344s/iter; left time: 343.6562s
	iters: 400, epoch: 2 | loss: 0.3175012
	speed: 0.0320s/iter; left time: 316.6343s
	iters: 500, epoch: 2 | loss: 0.3241814
	speed: 0.0298s/iter; left time: 292.2275s
	iters: 600, epoch: 2 | loss: 0.4859368
	speed: 0.0288s/iter; left time: 279.0216s
	iters: 700, epoch: 2 | loss: 0.4438307
	speed: 0.0278s/iter; left time: 266.5495s
	iters: 800, epoch: 2 | loss: 0.3693308
	speed: 0.0274s/iter; left time: 260.0303s
	iters: 900, epoch: 2 | loss: 0.4610150
	speed: 0.0271s/iter; left time: 254.7124s
	iters: 1000, epoch: 2 | loss: 0.3906565
	speed: 0.0268s/iter; left time: 249.5435s
	iters: 1100, epoch: 2 | loss: 0.3843758
	speed: 0.0267s/iter; left time: 245.3225s
Epoch: 2 cost time: 30.535799980163574
Epoch: 2, Steps: 1144 | Train Loss: 0.4680407 Vali Loss: 0.4545202 Test Loss: 0.2178958
Validation loss decreased (0.471758 --> 0.454520).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3235928
	speed: 0.0311s/iter; left time: 281.5152s
	iters: 200, epoch: 3 | loss: 0.4111507
	speed: 0.0243s/iter; left time: 217.2844s
	iters: 300, epoch: 3 | loss: 0.4746517
	speed: 0.0218s/iter; left time: 192.8380s
	iters: 400, epoch: 3 | loss: 0.3792954
	speed: 0.0206s/iter; left time: 179.9795s
	iters: 500, epoch: 3 | loss: 1.3328202
	speed: 0.0184s/iter; left time: 159.2581s
	iters: 600, epoch: 3 | loss: 0.3931251
	speed: 0.0168s/iter; left time: 143.9845s
	iters: 700, epoch: 3 | loss: 0.3947996
	speed: 0.0163s/iter; left time: 137.6869s
	iters: 800, epoch: 3 | loss: 0.2924015
	speed: 0.0170s/iter; left time: 142.0322s
	iters: 900, epoch: 3 | loss: 0.8010162
	speed: 0.0178s/iter; left time: 146.5614s
	iters: 1000, epoch: 3 | loss: 0.3458135
	speed: 0.0184s/iter; left time: 149.6247s
	iters: 1100, epoch: 3 | loss: 0.2980507
	speed: 0.0188s/iter; left time: 151.7007s
Epoch: 3 cost time: 21.892216205596924
Epoch: 3, Steps: 1144 | Train Loss: 0.4454327 Vali Loss: 0.4549663 Test Loss: 0.2193827
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3690064
	speed: 0.0390s/iter; left time: 308.6405s
	iters: 200, epoch: 4 | loss: 0.3713239
	speed: 0.0366s/iter; left time: 285.8772s
	iters: 300, epoch: 4 | loss: 0.2474632
	speed: 0.0335s/iter; left time: 258.0336s
	iters: 400, epoch: 4 | loss: 0.3108014
	speed: 0.0306s/iter; left time: 232.7282s
	iters: 500, epoch: 4 | loss: 0.3234151
	speed: 0.0286s/iter; left time: 214.8521s
	iters: 600, epoch: 4 | loss: 0.8299042
	speed: 0.0270s/iter; left time: 200.0003s
	iters: 700, epoch: 4 | loss: 0.3847795
	speed: 0.0260s/iter; left time: 189.9259s
	iters: 800, epoch: 4 | loss: 0.2992632
	speed: 0.0254s/iter; left time: 183.3213s
	iters: 900, epoch: 4 | loss: 0.4204839
	speed: 0.0251s/iter; left time: 178.7105s
	iters: 1000, epoch: 4 | loss: 0.8314453
	speed: 0.0251s/iter; left time: 175.8278s
	iters: 1100, epoch: 4 | loss: 0.3663318
	speed: 0.0252s/iter; left time: 174.3435s
Epoch: 4 cost time: 28.869718074798584
Epoch: 4, Steps: 1144 | Train Loss: 0.4336637 Vali Loss: 0.4624081 Test Loss: 0.2180304
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5204425
	speed: 0.0414s/iter; left time: 280.3255s
	iters: 200, epoch: 5 | loss: 0.3544044
	speed: 0.0396s/iter; left time: 263.8038s
	iters: 300, epoch: 5 | loss: 0.3186378
	speed: 0.0359s/iter; left time: 235.6047s
	iters: 400, epoch: 5 | loss: 0.2963666
	speed: 0.0323s/iter; left time: 208.7457s
	iters: 500, epoch: 5 | loss: 0.3392450
	speed: 0.0300s/iter; left time: 190.9412s
	iters: 600, epoch: 5 | loss: 0.2506590
	speed: 0.0286s/iter; left time: 179.0917s
	iters: 700, epoch: 5 | loss: 0.2895429
	speed: 0.0276s/iter; left time: 170.0684s
	iters: 800, epoch: 5 | loss: 0.3508726
	speed: 0.0266s/iter; left time: 161.1558s
	iters: 900, epoch: 5 | loss: 0.3276892
	speed: 0.0258s/iter; left time: 153.6829s
	iters: 1000, epoch: 5 | loss: 0.2986923
	speed: 0.0255s/iter; left time: 149.3511s
	iters: 1100, epoch: 5 | loss: 0.7904350
	speed: 0.0252s/iter; left time: 145.3799s
Epoch: 5 cost time: 28.854279279708862
Epoch: 5, Steps: 1144 | Train Loss: 0.4276703 Vali Loss: 0.4583327 Test Loss: 0.2168923
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.7683185
	speed: 0.0277s/iter; left time: 155.4820s
	iters: 200, epoch: 6 | loss: 0.5978879
	speed: 0.0262s/iter; left time: 144.6423s
	iters: 300, epoch: 6 | loss: 0.2592556
	speed: 0.0257s/iter; left time: 139.4030s
	iters: 400, epoch: 6 | loss: 0.3789527
	speed: 0.0254s/iter; left time: 135.3101s
	iters: 500, epoch: 6 | loss: 0.4032739
	speed: 0.0244s/iter; left time: 127.6275s
	iters: 600, epoch: 6 | loss: 0.2794382
	speed: 0.0236s/iter; left time: 121.0707s
	iters: 700, epoch: 6 | loss: 0.3768705
	speed: 0.0226s/iter; left time: 113.6266s
	iters: 800, epoch: 6 | loss: 0.7752645
	speed: 0.0219s/iter; left time: 107.9606s
	iters: 900, epoch: 6 | loss: 1.0022532
	speed: 0.0210s/iter; left time: 101.2092s
	iters: 1000, epoch: 6 | loss: 0.2877615
	speed: 0.0199s/iter; left time: 93.9646s
	iters: 1100, epoch: 6 | loss: 0.3551507
	speed: 0.0196s/iter; left time: 90.4757s
Epoch: 6 cost time: 22.53059148788452
Epoch: 6, Steps: 1144 | Train Loss: 0.4242383 Vali Loss: 0.4611182 Test Loss: 0.2173696
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.6764057
	speed: 0.0378s/iter; left time: 169.4484s
	iters: 200, epoch: 7 | loss: 0.2870756
	speed: 0.0388s/iter; left time: 169.7640s
	iters: 300, epoch: 7 | loss: 0.3495248
	speed: 0.0389s/iter; left time: 166.4193s
	iters: 400, epoch: 7 | loss: 0.2615840
	speed: 0.0385s/iter; left time: 160.6635s
	iters: 500, epoch: 7 | loss: 0.3884901
	speed: 0.0359s/iter; left time: 146.2077s
	iters: 600, epoch: 7 | loss: 0.3965999
	speed: 0.0336s/iter; left time: 133.6727s
	iters: 700, epoch: 7 | loss: 0.3017701
	speed: 0.0320s/iter; left time: 124.0826s
	iters: 800, epoch: 7 | loss: 0.3970671
	speed: 0.0310s/iter; left time: 117.2195s
	iters: 900, epoch: 7 | loss: 0.6990484
	speed: 0.0301s/iter; left time: 110.8167s
	iters: 1000, epoch: 7 | loss: 0.4355283
	speed: 0.0290s/iter; left time: 103.8982s
	iters: 1100, epoch: 7 | loss: 0.3739604
	speed: 0.0282s/iter; left time: 98.2226s
Epoch: 7 cost time: 32.08412194252014
Epoch: 7, Steps: 1144 | Train Loss: 0.4229463 Vali Loss: 0.4603752 Test Loss: 0.2177821
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.5833984017372131, mae:0.5742774605751038
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.4131982
	speed: 0.0462s/iter; left time: 523.5561s
	iters: 200, epoch: 1 | loss: 0.8683624
	speed: 0.0404s/iter; left time: 454.2217s
	iters: 300, epoch: 1 | loss: 0.8519999
	speed: 0.0353s/iter; left time: 393.6004s
	iters: 400, epoch: 1 | loss: 0.3717778
	speed: 0.0322s/iter; left time: 355.4221s
	iters: 500, epoch: 1 | loss: 0.3926681
	speed: 0.0303s/iter; left time: 331.2694s
	iters: 600, epoch: 1 | loss: 0.3921149
	speed: 0.0287s/iter; left time: 311.2104s
	iters: 700, epoch: 1 | loss: 0.4501445
	speed: 0.0284s/iter; left time: 304.7046s
	iters: 800, epoch: 1 | loss: 0.3947693
	speed: 0.0275s/iter; left time: 292.7906s
	iters: 900, epoch: 1 | loss: 0.4608485
	speed: 0.0265s/iter; left time: 279.4323s
	iters: 1000, epoch: 1 | loss: 0.5017438
	speed: 0.0259s/iter; left time: 270.8593s
	iters: 1100, epoch: 1 | loss: 0.4407575
	speed: 0.0259s/iter; left time: 268.0667s
Epoch: 1 cost time: 29.914883375167847
Epoch: 1, Steps: 1144 | Train Loss: 0.5092166 Vali Loss: 0.4608403 Test Loss: 0.2188019
Validation loss decreased (inf --> 0.460840).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3635159
	speed: 0.0367s/iter; left time: 373.9978s
	iters: 200, epoch: 2 | loss: 0.3961801
	speed: 0.0284s/iter; left time: 286.9737s
	iters: 300, epoch: 2 | loss: 1.3183324
	speed: 0.0251s/iter; left time: 250.5052s
	iters: 400, epoch: 2 | loss: 0.4090131
	speed: 0.0227s/iter; left time: 224.9691s
	iters: 500, epoch: 2 | loss: 0.8025482
	speed: 0.0217s/iter; left time: 212.5156s
	iters: 600, epoch: 2 | loss: 0.3854818
	speed: 0.0209s/iter; left time: 202.3884s
	iters: 700, epoch: 2 | loss: 0.3351148
	speed: 0.0202s/iter; left time: 193.3815s
	iters: 800, epoch: 2 | loss: 0.9035793
	speed: 0.0194s/iter; left time: 183.8764s
	iters: 900, epoch: 2 | loss: 0.3248522
	speed: 0.0193s/iter; left time: 181.1227s
	iters: 1000, epoch: 2 | loss: 0.2999430
	speed: 0.0196s/iter; left time: 181.8988s
	iters: 1100, epoch: 2 | loss: 0.3218192
	speed: 0.0209s/iter; left time: 192.0867s
Epoch: 2 cost time: 24.587432861328125
Epoch: 2, Steps: 1144 | Train Loss: 0.4688219 Vali Loss: 0.4623944 Test Loss: 0.2172488
EarlyStopping counter: 1 out of 5
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4252610
	speed: 0.0297s/iter; left time: 268.9579s
	iters: 200, epoch: 3 | loss: 0.3467979
	speed: 0.0255s/iter; left time: 228.1717s
	iters: 300, epoch: 3 | loss: 0.7710087
	speed: 0.0246s/iter; left time: 217.5514s
	iters: 400, epoch: 3 | loss: 0.9036306
	speed: 0.0245s/iter; left time: 214.7343s
	iters: 500, epoch: 3 | loss: 0.3707839
	speed: 0.0243s/iter; left time: 210.5015s
	iters: 600, epoch: 3 | loss: 0.8707673
	speed: 0.0236s/iter; left time: 201.5148s
	iters: 700, epoch: 3 | loss: 0.4077371
	speed: 0.0237s/iter; left time: 200.0851s
	iters: 800, epoch: 3 | loss: 0.2876078
	speed: 0.0232s/iter; left time: 193.6449s
	iters: 900, epoch: 3 | loss: 0.3008900
	speed: 0.0228s/iter; left time: 188.3955s
	iters: 1000, epoch: 3 | loss: 0.4726723
	speed: 0.0229s/iter; left time: 186.9506s
	iters: 1100, epoch: 3 | loss: 0.4667938
	speed: 0.0230s/iter; left time: 185.6205s
Epoch: 3 cost time: 26.576740741729736
Epoch: 3, Steps: 1144 | Train Loss: 0.4467003 Vali Loss: 0.4638123 Test Loss: 0.2161200
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3112701
	speed: 0.0381s/iter; left time: 301.3635s
	iters: 200, epoch: 4 | loss: 0.3849227
	speed: 0.0331s/iter; left time: 258.4083s
	iters: 300, epoch: 4 | loss: 1.4204824
	speed: 0.0298s/iter; left time: 229.8359s
	iters: 400, epoch: 4 | loss: 0.3557615
	speed: 0.0286s/iter; left time: 217.5805s
	iters: 500, epoch: 4 | loss: 0.3821887
	speed: 0.0277s/iter; left time: 208.0583s
	iters: 600, epoch: 4 | loss: 0.3850937
	speed: 0.0269s/iter; left time: 199.2304s
	iters: 700, epoch: 4 | loss: 0.3085098
	speed: 0.0257s/iter; left time: 188.1664s
	iters: 800, epoch: 4 | loss: 0.3727292
	speed: 0.0257s/iter; left time: 184.9940s
	iters: 900, epoch: 4 | loss: 0.3748633
	speed: 0.0260s/iter; left time: 184.7951s
	iters: 1000, epoch: 4 | loss: 0.2733484
	speed: 0.0259s/iter; left time: 181.2948s
	iters: 1100, epoch: 4 | loss: 0.3111326
	speed: 0.0257s/iter; left time: 177.8251s
Epoch: 4 cost time: 29.518356323242188
Epoch: 4, Steps: 1144 | Train Loss: 0.4353861 Vali Loss: 0.4640820 Test Loss: 0.2150711
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.7241296
	speed: 0.0368s/iter; left time: 248.6223s
	iters: 200, epoch: 5 | loss: 0.3519809
	speed: 0.0324s/iter; left time: 215.6181s
	iters: 300, epoch: 5 | loss: 0.3822074
	speed: 0.0288s/iter; left time: 189.1207s
	iters: 400, epoch: 5 | loss: 0.3394709
	speed: 0.0261s/iter; left time: 168.7895s
	iters: 500, epoch: 5 | loss: 0.8103247
	speed: 0.0259s/iter; left time: 164.6884s
	iters: 600, epoch: 5 | loss: 0.4732744
	speed: 0.0246s/iter; left time: 153.8854s
	iters: 700, epoch: 5 | loss: 0.3687767
	speed: 0.0233s/iter; left time: 143.8777s
	iters: 800, epoch: 5 | loss: 0.3171222
	speed: 0.0224s/iter; left time: 135.8024s
	iters: 900, epoch: 5 | loss: 0.4523690
	speed: 0.0220s/iter; left time: 131.4367s
	iters: 1000, epoch: 5 | loss: 0.9212586
	speed: 0.0218s/iter; left time: 127.7499s
	iters: 1100, epoch: 5 | loss: 0.3947211
	speed: 0.0218s/iter; left time: 125.7292s
Epoch: 5 cost time: 24.99798846244812
Epoch: 5, Steps: 1144 | Train Loss: 0.4291929 Vali Loss: 0.4699635 Test Loss: 0.2152657
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3507772
	speed: 0.0250s/iter; left time: 140.6607s
	iters: 200, epoch: 6 | loss: 0.4497249
	speed: 0.0247s/iter; left time: 136.4994s
	iters: 300, epoch: 6 | loss: 0.3791287
	speed: 0.0239s/iter; left time: 129.5247s
	iters: 400, epoch: 6 | loss: 0.3918442
	speed: 0.0234s/iter; left time: 124.4841s
	iters: 500, epoch: 6 | loss: 0.2615848
	speed: 0.0236s/iter; left time: 123.3227s
	iters: 600, epoch: 6 | loss: 0.3698826
	speed: 0.0239s/iter; left time: 122.2737s
	iters: 700, epoch: 6 | loss: 0.3128486
	speed: 0.0239s/iter; left time: 119.9186s
	iters: 800, epoch: 6 | loss: 0.7881901
	speed: 0.0233s/iter; left time: 114.5855s
	iters: 900, epoch: 6 | loss: 0.2842967
	speed: 0.0228s/iter; left time: 109.9177s
	iters: 1000, epoch: 6 | loss: 0.8677439
	speed: 0.0227s/iter; left time: 106.9818s
	iters: 1100, epoch: 6 | loss: 0.7662049
	speed: 0.0226s/iter; left time: 104.4860s
Epoch: 6 cost time: 25.942803859710693
Epoch: 6, Steps: 1144 | Train Loss: 0.4260292 Vali Loss: 0.4653488 Test Loss: 0.2147724
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.6405311226844788, mae:0.6134413480758667
Seed: 42
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_336      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.5222347
	speed: 0.0432s/iter; left time: 488.2219s
	iters: 200, epoch: 1 | loss: 0.5137276
	speed: 0.0324s/iter; left time: 363.4355s
	iters: 300, epoch: 1 | loss: 0.4746755
	speed: 0.0288s/iter; left time: 320.0850s
	iters: 400, epoch: 1 | loss: 0.3857918
	speed: 0.0274s/iter; left time: 301.7002s
	iters: 500, epoch: 1 | loss: 0.4335290
	speed: 0.0290s/iter; left time: 315.9157s
	iters: 600, epoch: 1 | loss: 0.4461980
	speed: 0.0298s/iter; left time: 322.3532s
	iters: 700, epoch: 1 | loss: 0.7134572
	speed: 0.0304s/iter; left time: 325.6481s
	iters: 800, epoch: 1 | loss: 0.5436815
	speed: 0.0300s/iter; left time: 318.1152s
	iters: 900, epoch: 1 | loss: 0.4205691
	speed: 0.0295s/iter; left time: 309.4346s
	iters: 1000, epoch: 1 | loss: 0.4334201
	speed: 0.0290s/iter; left time: 301.9647s
	iters: 1100, epoch: 1 | loss: 1.0514984
	speed: 0.0277s/iter; left time: 285.7238s
Epoch: 1 cost time: 31.21523380279541
Epoch: 1, Steps: 1140 | Train Loss: 0.5618441 Vali Loss: 0.5455775 Test Loss: 0.2738332
Validation loss decreased (inf --> 0.545577).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4677790
	speed: 0.0287s/iter; left time: 291.3246s
	iters: 200, epoch: 2 | loss: 0.5655896
	speed: 0.0253s/iter; left time: 254.3176s
	iters: 300, epoch: 2 | loss: 0.8926656
	speed: 0.0241s/iter; left time: 239.9943s
	iters: 400, epoch: 2 | loss: 0.4089888
	speed: 0.0235s/iter; left time: 231.6930s
	iters: 500, epoch: 2 | loss: 0.3895566
	speed: 0.0232s/iter; left time: 226.6175s
	iters: 600, epoch: 2 | loss: 0.4562236
	speed: 0.0230s/iter; left time: 222.1496s
	iters: 700, epoch: 2 | loss: 0.4493180
	speed: 0.0232s/iter; left time: 221.4419s
	iters: 800, epoch: 2 | loss: 0.4455272
	speed: 0.0233s/iter; left time: 220.4734s
	iters: 900, epoch: 2 | loss: 0.3829160
	speed: 0.0234s/iter; left time: 219.2736s
	iters: 1000, epoch: 2 | loss: 0.3977754
	speed: 0.0234s/iter; left time: 216.4037s
	iters: 1100, epoch: 2 | loss: 0.4099476
	speed: 0.0233s/iter; left time: 213.2827s
Epoch: 2 cost time: 26.63006067276001
Epoch: 2, Steps: 1140 | Train Loss: 0.5209758 Vali Loss: 0.5327068 Test Loss: 0.2753880
Validation loss decreased (0.545577 --> 0.532707).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3637622
	speed: 0.0364s/iter; left time: 328.3979s
	iters: 200, epoch: 3 | loss: 0.3972112
	speed: 0.0342s/iter; left time: 304.8731s
	iters: 300, epoch: 3 | loss: 0.4161103
	speed: 0.0346s/iter; left time: 305.4815s
	iters: 400, epoch: 3 | loss: 0.6577871
	speed: 0.0318s/iter; left time: 277.0532s
	iters: 500, epoch: 3 | loss: 0.3808880
	speed: 0.0299s/iter; left time: 257.8960s
	iters: 600, epoch: 3 | loss: 0.3383909
	speed: 0.0287s/iter; left time: 244.5827s
	iters: 700, epoch: 3 | loss: 0.4558926
	speed: 0.0279s/iter; left time: 234.5874s
	iters: 800, epoch: 3 | loss: 0.4492403
	speed: 0.0272s/iter; left time: 226.2592s
	iters: 900, epoch: 3 | loss: 0.3669988
	speed: 0.0266s/iter; left time: 218.9314s
	iters: 1000, epoch: 3 | loss: 0.6852443
	speed: 0.0262s/iter; left time: 212.7435s
	iters: 1100, epoch: 3 | loss: 0.5103838
	speed: 0.0258s/iter; left time: 206.6667s
Epoch: 3 cost time: 29.147745609283447
Epoch: 3, Steps: 1140 | Train Loss: 0.4943257 Vali Loss: 0.5331640 Test Loss: 0.2755390
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3731976
	speed: 0.0312s/iter; left time: 245.8194s
	iters: 200, epoch: 4 | loss: 0.3668085
	speed: 0.0271s/iter; left time: 211.1582s
	iters: 300, epoch: 4 | loss: 0.3614975
	speed: 0.0259s/iter; left time: 198.6238s
	iters: 400, epoch: 4 | loss: 0.4805061
	speed: 0.0248s/iter; left time: 187.6502s
	iters: 500, epoch: 4 | loss: 0.3626490
	speed: 0.0247s/iter; left time: 184.8693s
	iters: 600, epoch: 4 | loss: 0.3544604
	speed: 0.0246s/iter; left time: 181.5320s
	iters: 700, epoch: 4 | loss: 0.4475170
	speed: 0.0245s/iter; left time: 178.2672s
	iters: 800, epoch: 4 | loss: 0.6397336
	speed: 0.0244s/iter; left time: 175.1023s
	iters: 900, epoch: 4 | loss: 0.4873005
	speed: 0.0237s/iter; left time: 168.1590s
	iters: 1000, epoch: 4 | loss: 0.4004971
	speed: 0.0231s/iter; left time: 161.4921s
	iters: 1100, epoch: 4 | loss: 0.3769430
	speed: 0.0225s/iter; left time: 154.7185s
Epoch: 4 cost time: 25.47251844406128
Epoch: 4, Steps: 1140 | Train Loss: 0.4804004 Vali Loss: 0.5419109 Test Loss: 0.2793821
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3194000
	speed: 0.0334s/iter; left time: 225.2613s
	iters: 200, epoch: 5 | loss: 0.3320228
	speed: 0.0279s/iter; left time: 185.1326s
	iters: 300, epoch: 5 | loss: 0.3345023
	speed: 0.0260s/iter; left time: 170.1802s
	iters: 400, epoch: 5 | loss: 0.4031008
	speed: 0.0250s/iter; left time: 161.1620s
	iters: 500, epoch: 5 | loss: 0.3544354
	speed: 0.0245s/iter; left time: 155.0932s
	iters: 600, epoch: 5 | loss: 0.3979267
	speed: 0.0245s/iter; left time: 153.0383s
	iters: 700, epoch: 5 | loss: 0.3601226
	speed: 0.0261s/iter; left time: 160.2259s
	iters: 800, epoch: 5 | loss: 0.3831056
	speed: 0.0274s/iter; left time: 165.4301s
	iters: 900, epoch: 5 | loss: 0.3673482
	speed: 0.0275s/iter; left time: 163.6319s
	iters: 1000, epoch: 5 | loss: 0.9172502
	speed: 0.0272s/iter; left time: 158.6877s
	iters: 1100, epoch: 5 | loss: 0.3540089
	speed: 0.0267s/iter; left time: 153.2829s
Epoch: 5 cost time: 30.298804759979248
Epoch: 5, Steps: 1140 | Train Loss: 0.4729008 Vali Loss: 0.5485467 Test Loss: 0.2821360
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3657593
	speed: 0.0395s/iter; left time: 221.3446s
	iters: 200, epoch: 6 | loss: 0.6370376
	speed: 0.0341s/iter; left time: 187.4097s
	iters: 300, epoch: 6 | loss: 0.4624941
	speed: 0.0300s/iter; left time: 161.9358s
	iters: 400, epoch: 6 | loss: 0.2986402
	speed: 0.0281s/iter; left time: 148.9455s
	iters: 500, epoch: 6 | loss: 0.3634149
	speed: 0.0272s/iter; left time: 141.6758s
	iters: 600, epoch: 6 | loss: 0.3362332
	speed: 0.0268s/iter; left time: 136.5534s
	iters: 700, epoch: 6 | loss: 0.3354464
	speed: 0.0267s/iter; left time: 133.3192s
	iters: 800, epoch: 6 | loss: 0.6077047
	speed: 0.0265s/iter; left time: 129.6665s
	iters: 900, epoch: 6 | loss: 0.5865179
	speed: 0.0263s/iter; left time: 126.1075s
	iters: 1000, epoch: 6 | loss: 0.3871708
	speed: 0.0261s/iter; left time: 122.6803s
	iters: 1100, epoch: 6 | loss: 0.3777018
	speed: 0.0256s/iter; left time: 117.6026s
Epoch: 6 cost time: 29.034947633743286
Epoch: 6, Steps: 1140 | Train Loss: 0.4692668 Vali Loss: 0.5470490 Test Loss: 0.2834611
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5614512
	speed: 0.0280s/iter; left time: 124.7013s
	iters: 200, epoch: 7 | loss: 0.3240784
	speed: 0.0264s/iter; left time: 115.0298s
	iters: 300, epoch: 7 | loss: 0.3332736
	speed: 0.0258s/iter; left time: 109.8933s
	iters: 400, epoch: 7 | loss: 0.3846199
	speed: 0.0252s/iter; left time: 104.8299s
	iters: 500, epoch: 7 | loss: 0.3426426
	speed: 0.0247s/iter; left time: 100.2479s
	iters: 600, epoch: 7 | loss: 0.3567992
	speed: 0.0244s/iter; left time: 96.7840s
	iters: 700, epoch: 7 | loss: 0.4061991
	speed: 0.0242s/iter; left time: 93.4596s
	iters: 800, epoch: 7 | loss: 0.3571598
	speed: 0.0240s/iter; left time: 90.2153s
	iters: 900, epoch: 7 | loss: 0.3333984
	speed: 0.0237s/iter; left time: 86.8942s
	iters: 1000, epoch: 7 | loss: 0.3952738
	speed: 0.0233s/iter; left time: 83.0379s
	iters: 1100, epoch: 7 | loss: 0.3728438
	speed: 0.0227s/iter; left time: 78.6166s
Epoch: 7 cost time: 25.829482078552246
Epoch: 7, Steps: 1140 | Train Loss: 0.4672998 Vali Loss: 0.5435959 Test Loss: 0.2815920
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.2753879725933075, mae:0.32144492864608765
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.7314103
	speed: 0.0210s/iter; left time: 237.4422s
	iters: 200, epoch: 1 | loss: 0.5127299
	speed: 0.0194s/iter; left time: 217.7038s
	iters: 300, epoch: 1 | loss: 0.4498225
	speed: 0.0197s/iter; left time: 218.3622s
	iters: 400, epoch: 1 | loss: 0.4715115
	speed: 0.0197s/iter; left time: 216.7537s
	iters: 500, epoch: 1 | loss: 0.5559564
	speed: 0.0190s/iter; left time: 207.6317s
	iters: 600, epoch: 1 | loss: 0.4108611
	speed: 0.0186s/iter; left time: 200.5307s
	iters: 700, epoch: 1 | loss: 0.6798603
	speed: 0.0180s/iter; left time: 192.4771s
	iters: 800, epoch: 1 | loss: 0.4530377
	speed: 0.0177s/iter; left time: 187.3371s
	iters: 900, epoch: 1 | loss: 0.4840870
	speed: 0.0183s/iter; left time: 192.4785s
	iters: 1000, epoch: 1 | loss: 0.4232619
	speed: 0.0190s/iter; left time: 197.3920s
	iters: 1100, epoch: 1 | loss: 0.9657236
	speed: 0.0195s/iter; left time: 200.6945s
Epoch: 1 cost time: 22.28541898727417
Epoch: 1, Steps: 1140 | Train Loss: 0.5629743 Vali Loss: 0.5339311 Test Loss: 0.2735543
Validation loss decreased (inf --> 0.533931).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4411798
	speed: 0.0275s/iter; left time: 279.5510s
	iters: 200, epoch: 2 | loss: 0.9621051
	speed: 0.0244s/iter; left time: 245.0508s
	iters: 300, epoch: 2 | loss: 0.7619225
	speed: 0.0255s/iter; left time: 254.4903s
	iters: 400, epoch: 2 | loss: 0.9609073
	speed: 0.0255s/iter; left time: 251.7008s
	iters: 500, epoch: 2 | loss: 0.4121639
	speed: 0.0242s/iter; left time: 236.4279s
	iters: 600, epoch: 2 | loss: 0.4507138
	speed: 0.0237s/iter; left time: 229.0098s
	iters: 700, epoch: 2 | loss: 0.5090625
	speed: 0.0235s/iter; left time: 224.2931s
	iters: 800, epoch: 2 | loss: 0.6743496
	speed: 0.0235s/iter; left time: 222.6937s
	iters: 900, epoch: 2 | loss: 0.4389996
	speed: 0.0236s/iter; left time: 221.0679s
	iters: 1000, epoch: 2 | loss: 0.4583429
	speed: 0.0236s/iter; left time: 218.6174s
	iters: 1100, epoch: 2 | loss: 0.4167259
	speed: 0.0236s/iter; left time: 216.4557s
Epoch: 2 cost time: 26.96597456932068
Epoch: 2, Steps: 1140 | Train Loss: 0.5211405 Vali Loss: 0.5380504 Test Loss: 0.2752526
EarlyStopping counter: 1 out of 5
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4681190
	speed: 0.0389s/iter; left time: 351.2275s
	iters: 200, epoch: 3 | loss: 0.3517854
	speed: 0.0380s/iter; left time: 338.7897s
	iters: 300, epoch: 3 | loss: 0.3767492
	speed: 0.0356s/iter; left time: 314.1965s
	iters: 400, epoch: 3 | loss: 0.4319971
	speed: 0.0323s/iter; left time: 281.5681s
	iters: 500, epoch: 3 | loss: 0.4215062
	speed: 0.0300s/iter; left time: 258.6712s
	iters: 600, epoch: 3 | loss: 0.4508281
	speed: 0.0284s/iter; left time: 241.7186s
	iters: 700, epoch: 3 | loss: 0.7800706
	speed: 0.0274s/iter; left time: 230.8821s
	iters: 800, epoch: 3 | loss: 0.4071345
	speed: 0.0267s/iter; left time: 222.3327s
	iters: 900, epoch: 3 | loss: 0.3912931
	speed: 0.0262s/iter; left time: 215.3584s
	iters: 1000, epoch: 3 | loss: 0.4989418
	speed: 0.0257s/iter; left time: 209.1147s
	iters: 1100, epoch: 3 | loss: 0.4161932
	speed: 0.0257s/iter; left time: 205.8997s
Epoch: 3 cost time: 29.32234025001526
Epoch: 3, Steps: 1140 | Train Loss: 0.4956861 Vali Loss: 0.5346935 Test Loss: 0.2767208
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.7882203
	speed: 0.0412s/iter; left time: 324.8708s
	iters: 200, epoch: 4 | loss: 0.6350278
	speed: 0.0330s/iter; left time: 256.7332s
	iters: 300, epoch: 4 | loss: 0.3110302
	speed: 0.0278s/iter; left time: 213.7393s
	iters: 400, epoch: 4 | loss: 0.6093298
	speed: 0.0251s/iter; left time: 190.1071s
	iters: 500, epoch: 4 | loss: 0.9006665
	speed: 0.0241s/iter; left time: 180.0342s
	iters: 600, epoch: 4 | loss: 0.3889472
	speed: 0.0233s/iter; left time: 171.9745s
	iters: 700, epoch: 4 | loss: 0.3693143
	speed: 0.0237s/iter; left time: 172.2020s
	iters: 800, epoch: 4 | loss: 0.3198764
	speed: 0.0228s/iter; left time: 163.4754s
	iters: 900, epoch: 4 | loss: 0.4902472
	speed: 0.0226s/iter; left time: 160.3310s
	iters: 1000, epoch: 4 | loss: 0.4072087
	speed: 0.0227s/iter; left time: 158.2151s
	iters: 1100, epoch: 4 | loss: 0.5970697
	speed: 0.0226s/iter; left time: 155.7936s
Epoch: 4 cost time: 26.220312356948853
Epoch: 4, Steps: 1140 | Train Loss: 0.4820772 Vali Loss: 0.5456993 Test Loss: 0.2800036
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.7362772
	speed: 0.0257s/iter; left time: 173.5698s
	iters: 200, epoch: 5 | loss: 0.3616570
	speed: 0.0242s/iter; left time: 160.6092s
	iters: 300, epoch: 5 | loss: 0.3767634
	speed: 0.0234s/iter; left time: 152.9811s
	iters: 400, epoch: 5 | loss: 0.3595151
	speed: 0.0231s/iter; left time: 148.9807s
	iters: 500, epoch: 5 | loss: 0.3661989
	speed: 0.0230s/iter; left time: 145.8499s
	iters: 600, epoch: 5 | loss: 0.4547425
	speed: 0.0230s/iter; left time: 143.3565s
	iters: 700, epoch: 5 | loss: 0.3877958
	speed: 0.0231s/iter; left time: 141.8234s
	iters: 800, epoch: 5 | loss: 0.4665155
	speed: 0.0233s/iter; left time: 140.4728s
	iters: 900, epoch: 5 | loss: 0.3388861
	speed: 0.0233s/iter; left time: 138.6316s
	iters: 1000, epoch: 5 | loss: 0.3491422
	speed: 0.0237s/iter; left time: 138.4288s
	iters: 1100, epoch: 5 | loss: 0.6698210
	speed: 0.0245s/iter; left time: 140.7766s
Epoch: 5 cost time: 28.246200799942017
Epoch: 5, Steps: 1140 | Train Loss: 0.4746570 Vali Loss: 0.5499725 Test Loss: 0.2810588
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6708093
	speed: 0.0319s/iter; left time: 178.4579s
	iters: 200, epoch: 6 | loss: 0.4584314
	speed: 0.0279s/iter; left time: 153.2445s
	iters: 300, epoch: 6 | loss: 0.3908902
	speed: 0.0265s/iter; left time: 143.2033s
	iters: 400, epoch: 6 | loss: 0.5195332
	speed: 0.0255s/iter; left time: 135.1868s
	iters: 500, epoch: 6 | loss: 0.3542085
	speed: 0.0250s/iter; left time: 129.9570s
	iters: 600, epoch: 6 | loss: 0.3820651
	speed: 0.0259s/iter; left time: 132.1987s
	iters: 700, epoch: 6 | loss: 0.3732305
	speed: 0.0260s/iter; left time: 129.9109s
	iters: 800, epoch: 6 | loss: 0.3879048
	speed: 0.0256s/iter; left time: 125.5225s
	iters: 900, epoch: 6 | loss: 0.4016454
	speed: 0.0263s/iter; left time: 126.4666s
	iters: 1000, epoch: 6 | loss: 0.6274962
	speed: 0.0269s/iter; left time: 126.4817s
	iters: 1100, epoch: 6 | loss: 0.3375176
	speed: 0.0267s/iter; left time: 122.6412s
Epoch: 6 cost time: 30.4127459526062
Epoch: 6, Steps: 1140 | Train Loss: 0.4711533 Vali Loss: 0.5486335 Test Loss: 0.2802575
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.5875208973884583, mae:0.5716885328292847
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.4258754
	speed: 0.0239s/iter; left time: 270.6149s
	iters: 200, epoch: 1 | loss: 0.4323708
	speed: 0.0184s/iter; left time: 205.7533s
	iters: 300, epoch: 1 | loss: 0.5961783
	speed: 0.0167s/iter; left time: 185.4892s
	iters: 400, epoch: 1 | loss: 0.4616385
	speed: 0.0159s/iter; left time: 175.2135s
	iters: 500, epoch: 1 | loss: 0.4986419
	speed: 0.0163s/iter; left time: 177.8085s
	iters: 600, epoch: 1 | loss: 0.5286264
	speed: 0.0168s/iter; left time: 181.0892s
	iters: 700, epoch: 1 | loss: 0.4479900
	speed: 0.0181s/iter; left time: 193.3752s
	iters: 800, epoch: 1 | loss: 0.4246207
	speed: 0.0183s/iter; left time: 193.5234s
	iters: 900, epoch: 1 | loss: 0.4860708
	speed: 0.0188s/iter; left time: 197.3312s
	iters: 1000, epoch: 1 | loss: 0.9599047
	speed: 0.0192s/iter; left time: 199.9992s
	iters: 1100, epoch: 1 | loss: 0.4311573
	speed: 0.0196s/iter; left time: 201.5187s
Epoch: 1 cost time: 22.776978015899658
Epoch: 1, Steps: 1140 | Train Loss: 0.5620706 Vali Loss: 0.5357062 Test Loss: 0.2734057
Validation loss decreased (inf --> 0.535706).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5047799
	speed: 0.0291s/iter; left time: 295.2519s
	iters: 200, epoch: 2 | loss: 0.7313554
	speed: 0.0260s/iter; left time: 262.0552s
	iters: 300, epoch: 2 | loss: 0.4645123
	speed: 0.0289s/iter; left time: 287.7830s
	iters: 400, epoch: 2 | loss: 0.6402597
	speed: 0.0284s/iter; left time: 280.4701s
	iters: 500, epoch: 2 | loss: 0.4564303
	speed: 0.0274s/iter; left time: 267.2648s
	iters: 600, epoch: 2 | loss: 0.9875994
	speed: 0.0266s/iter; left time: 256.8217s
	iters: 700, epoch: 2 | loss: 0.6815732
	speed: 0.0260s/iter; left time: 248.4736s
	iters: 800, epoch: 2 | loss: 0.6841976
	speed: 0.0258s/iter; left time: 243.8722s
	iters: 900, epoch: 2 | loss: 0.9520252
	speed: 0.0257s/iter; left time: 240.2702s
	iters: 1000, epoch: 2 | loss: 0.4917639
	speed: 0.0256s/iter; left time: 237.3764s
	iters: 1100, epoch: 2 | loss: 0.7038076
	speed: 0.0255s/iter; left time: 233.8382s
Epoch: 2 cost time: 29.092250108718872
Epoch: 2, Steps: 1140 | Train Loss: 0.5198281 Vali Loss: 0.5465338 Test Loss: 0.2810690
EarlyStopping counter: 1 out of 5
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4897948
	speed: 0.0292s/iter; left time: 263.3818s
	iters: 200, epoch: 3 | loss: 0.6414949
	speed: 0.0295s/iter; left time: 263.4296s
	iters: 300, epoch: 3 | loss: 0.3777674
	speed: 0.0320s/iter; left time: 282.6431s
	iters: 400, epoch: 3 | loss: 0.6365159
	speed: 0.0304s/iter; left time: 265.0489s
	iters: 500, epoch: 3 | loss: 0.3062220
	speed: 0.0294s/iter; left time: 253.7112s
	iters: 600, epoch: 3 | loss: 0.3977050
	speed: 0.0285s/iter; left time: 242.9847s
	iters: 700, epoch: 3 | loss: 0.3711250
	speed: 0.0276s/iter; left time: 232.2221s
	iters: 800, epoch: 3 | loss: 0.4707111
	speed: 0.0275s/iter; left time: 228.6555s
	iters: 900, epoch: 3 | loss: 0.4775175
	speed: 0.0280s/iter; left time: 229.9218s
	iters: 1000, epoch: 3 | loss: 0.3854232
	speed: 0.0282s/iter; left time: 229.1596s
	iters: 1100, epoch: 3 | loss: 0.6520144
	speed: 0.0276s/iter; left time: 221.2908s
Epoch: 3 cost time: 31.31243109703064
Epoch: 3, Steps: 1140 | Train Loss: 0.4931885 Vali Loss: 0.5453146 Test Loss: 0.2837694
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.9551542
	speed: 0.0394s/iter; left time: 310.4428s
	iters: 200, epoch: 4 | loss: 0.4209878
	speed: 0.0299s/iter; left time: 232.6324s
	iters: 300, epoch: 4 | loss: 0.3678521
	speed: 0.0260s/iter; left time: 199.8994s
	iters: 400, epoch: 4 | loss: 0.4372328
	speed: 0.0240s/iter; left time: 181.9961s
	iters: 500, epoch: 4 | loss: 0.7313434
	speed: 0.0226s/iter; left time: 169.3241s
	iters: 600, epoch: 4 | loss: 0.6950336
	speed: 0.0217s/iter; left time: 160.1280s
	iters: 700, epoch: 4 | loss: 0.4240172
	speed: 0.0223s/iter; left time: 162.0036s
	iters: 800, epoch: 4 | loss: 0.4340638
	speed: 0.0225s/iter; left time: 161.4037s
	iters: 900, epoch: 4 | loss: 0.4202136
	speed: 0.0227s/iter; left time: 160.7022s
	iters: 1000, epoch: 4 | loss: 0.3360374
	speed: 0.0224s/iter; left time: 156.6380s
	iters: 1100, epoch: 4 | loss: 0.3599164
	speed: 0.0221s/iter; left time: 152.1416s
Epoch: 4 cost time: 25.214601039886475
Epoch: 4, Steps: 1140 | Train Loss: 0.4791845 Vali Loss: 0.5495254 Test Loss: 0.2870817
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3421807
	speed: 0.0383s/iter; left time: 258.2459s
	iters: 200, epoch: 5 | loss: 0.4157817
	speed: 0.0321s/iter; left time: 212.8611s
	iters: 300, epoch: 5 | loss: 0.4568975
	speed: 0.0295s/iter; left time: 192.6988s
	iters: 400, epoch: 5 | loss: 0.4113202
	speed: 0.0300s/iter; left time: 193.0831s
	iters: 500, epoch: 5 | loss: 0.4787629
	speed: 0.0312s/iter; left time: 198.1083s
	iters: 600, epoch: 5 | loss: 0.6765156
	speed: 0.0301s/iter; left time: 187.6532s
	iters: 700, epoch: 5 | loss: 0.6554657
	speed: 0.0292s/iter; left time: 179.1799s
	iters: 800, epoch: 5 | loss: 0.3644379
	speed: 0.0283s/iter; left time: 171.1346s
	iters: 900, epoch: 5 | loss: 0.3354524
	speed: 0.0277s/iter; left time: 164.3955s
	iters: 1000, epoch: 5 | loss: 0.4087722
	speed: 0.0271s/iter; left time: 158.0922s
	iters: 1100, epoch: 5 | loss: 0.2994478
	speed: 0.0266s/iter; left time: 152.7589s
Epoch: 5 cost time: 30.176511764526367
Epoch: 5, Steps: 1140 | Train Loss: 0.4727176 Vali Loss: 0.5448022 Test Loss: 0.2885543
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.7108962
	speed: 0.0438s/iter; left time: 245.4882s
	iters: 200, epoch: 6 | loss: 0.3234024
	speed: 0.0386s/iter; left time: 212.1985s
	iters: 300, epoch: 6 | loss: 0.3995128
	speed: 0.0333s/iter; left time: 179.9307s
	iters: 400, epoch: 6 | loss: 0.4881549
	speed: 0.0322s/iter; left time: 170.8472s
	iters: 500, epoch: 6 | loss: 0.6837190
	speed: 0.0324s/iter; left time: 168.2994s
	iters: 600, epoch: 6 | loss: 0.3145983
	speed: 0.0327s/iter; left time: 166.7775s
	iters: 700, epoch: 6 | loss: 0.3200623
	speed: 0.0312s/iter; left time: 156.0521s
	iters: 800, epoch: 6 | loss: 0.3357192
	speed: 0.0299s/iter; left time: 146.6465s
	iters: 900, epoch: 6 | loss: 0.4853717
	speed: 0.0290s/iter; left time: 138.9946s
	iters: 1000, epoch: 6 | loss: 0.3545443
	speed: 0.0279s/iter; left time: 131.3331s
	iters: 1100, epoch: 6 | loss: 0.7412269
	speed: 0.0273s/iter; left time: 125.4424s
Epoch: 6 cost time: 31.36580753326416
Epoch: 6, Steps: 1140 | Train Loss: 0.4691312 Vali Loss: 0.5499022 Test Loss: 0.2910471
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.5946900248527527, mae:0.5763915181159973
Seed: 42
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_720      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.6161711
	speed: 0.0363s/iter; left time: 405.3236s
	iters: 200, epoch: 1 | loss: 0.5292724
	speed: 0.0281s/iter; left time: 311.0082s
	iters: 300, epoch: 1 | loss: 0.7202832
	speed: 0.0260s/iter; left time: 286.0050s
	iters: 400, epoch: 1 | loss: 0.6075745
	speed: 0.0250s/iter; left time: 272.0891s
	iters: 500, epoch: 1 | loss: 0.5167585
	speed: 0.0244s/iter; left time: 262.7702s
	iters: 600, epoch: 1 | loss: 0.5018761
	speed: 0.0242s/iter; left time: 258.8997s
	iters: 700, epoch: 1 | loss: 0.6380321
	speed: 0.0243s/iter; left time: 257.2745s
	iters: 800, epoch: 1 | loss: 0.4818849
	speed: 0.0243s/iter; left time: 255.0311s
	iters: 900, epoch: 1 | loss: 0.6078753
	speed: 0.0244s/iter; left time: 252.9464s
	iters: 1000, epoch: 1 | loss: 0.7785270
	speed: 0.0244s/iter; left time: 250.9297s
	iters: 1100, epoch: 1 | loss: 0.5446781
	speed: 0.0244s/iter; left time: 248.4273s
Epoch: 1 cost time: 27.763908624649048
Epoch: 1, Steps: 1128 | Train Loss: 0.6225387 Vali Loss: 0.6640191 Test Loss: 0.3456627
Validation loss decreased (inf --> 0.664019).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7318805
	speed: 0.0235s/iter; left time: 236.3361s
	iters: 200, epoch: 2 | loss: 0.7525100
	speed: 0.0229s/iter; left time: 227.8564s
	iters: 300, epoch: 2 | loss: 0.6367182
	speed: 0.0236s/iter; left time: 232.0892s
	iters: 400, epoch: 2 | loss: 0.6912220
	speed: 0.0239s/iter; left time: 232.8354s
	iters: 500, epoch: 2 | loss: 0.6695952
	speed: 0.0235s/iter; left time: 227.0534s
	iters: 600, epoch: 2 | loss: 0.4057321
	speed: 0.0233s/iter; left time: 222.3773s
	iters: 700, epoch: 2 | loss: 0.5668865
	speed: 0.0231s/iter; left time: 218.4390s
	iters: 800, epoch: 2 | loss: 0.4736921
	speed: 0.0230s/iter; left time: 214.8023s
	iters: 900, epoch: 2 | loss: 0.6190661
	speed: 0.0233s/iter; left time: 216.0005s
	iters: 1000, epoch: 2 | loss: 0.6553173
	speed: 0.0234s/iter; left time: 214.2859s
	iters: 1100, epoch: 2 | loss: 0.5085868
	speed: 0.0235s/iter; left time: 212.5785s
Epoch: 2 cost time: 26.673885822296143
Epoch: 2, Steps: 1128 | Train Loss: 0.5756033 Vali Loss: 0.6440681 Test Loss: 0.3507020
Validation loss decreased (0.664019 --> 0.644068).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6344234
	speed: 0.0334s/iter; left time: 297.9444s
	iters: 200, epoch: 3 | loss: 0.5598736
	speed: 0.0276s/iter; left time: 243.7999s
	iters: 300, epoch: 3 | loss: 0.5075866
	speed: 0.0286s/iter; left time: 249.6465s
	iters: 400, epoch: 3 | loss: 0.5948652
	speed: 0.0305s/iter; left time: 263.3949s
	iters: 500, epoch: 3 | loss: 0.5256471
	speed: 0.0321s/iter; left time: 273.5737s
	iters: 600, epoch: 3 | loss: 0.7367928
	speed: 0.0315s/iter; left time: 265.6123s
	iters: 700, epoch: 3 | loss: 0.4700948
	speed: 0.0295s/iter; left time: 245.9764s
	iters: 800, epoch: 3 | loss: 0.5297510
	speed: 0.0280s/iter; left time: 230.6537s
	iters: 900, epoch: 3 | loss: 0.5215003
	speed: 0.0267s/iter; left time: 217.1944s
	iters: 1000, epoch: 3 | loss: 0.5163584
	speed: 0.0261s/iter; left time: 209.2456s
	iters: 1100, epoch: 3 | loss: 0.4846082
	speed: 0.0255s/iter; left time: 202.1381s
Epoch: 3 cost time: 28.745280027389526
Epoch: 3, Steps: 1128 | Train Loss: 0.5434772 Vali Loss: 0.6698101 Test Loss: 0.3711424
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4231477
	speed: 0.0310s/iter; left time: 241.5035s
	iters: 200, epoch: 4 | loss: 0.4542002
	speed: 0.0277s/iter; left time: 213.1850s
	iters: 300, epoch: 4 | loss: 0.5877700
	speed: 0.0266s/iter; left time: 202.0783s
	iters: 400, epoch: 4 | loss: 0.7547892
	speed: 0.0260s/iter; left time: 194.8744s
	iters: 500, epoch: 4 | loss: 0.6118580
	speed: 0.0251s/iter; left time: 185.5107s
	iters: 600, epoch: 4 | loss: 0.5303484
	speed: 0.0245s/iter; left time: 178.5635s
	iters: 700, epoch: 4 | loss: 0.3985006
	speed: 0.0241s/iter; left time: 173.1679s
	iters: 800, epoch: 4 | loss: 0.4617289
	speed: 0.0238s/iter; left time: 168.5801s
	iters: 900, epoch: 4 | loss: 0.4280963
	speed: 0.0237s/iter; left time: 165.5948s
	iters: 1000, epoch: 4 | loss: 0.5720590
	speed: 0.0237s/iter; left time: 163.1179s
	iters: 1100, epoch: 4 | loss: 0.6762751
	speed: 0.0235s/iter; left time: 159.8312s
Epoch: 4 cost time: 26.656952142715454
Epoch: 4, Steps: 1128 | Train Loss: 0.5266904 Vali Loss: 0.6760024 Test Loss: 0.3832309
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5592843
	speed: 0.0262s/iter; left time: 174.5815s
	iters: 200, epoch: 5 | loss: 0.5287407
	speed: 0.0251s/iter; left time: 164.8209s
	iters: 300, epoch: 5 | loss: 0.4599244
	speed: 0.0278s/iter; left time: 179.5573s
	iters: 400, epoch: 5 | loss: 0.4127405
	speed: 0.0270s/iter; left time: 172.1973s
	iters: 500, epoch: 5 | loss: 0.7164134
	speed: 0.0265s/iter; left time: 165.9214s
	iters: 600, epoch: 5 | loss: 0.4389530
	speed: 0.0260s/iter; left time: 160.1870s
	iters: 700, epoch: 5 | loss: 0.3921573
	speed: 0.0255s/iter; left time: 154.9845s
	iters: 800, epoch: 5 | loss: 0.5129339
	speed: 0.0252s/iter; left time: 150.5618s
	iters: 900, epoch: 5 | loss: 0.4489753
	speed: 0.0249s/iter; left time: 146.4163s
	iters: 1000, epoch: 5 | loss: 0.5736065
	speed: 0.0247s/iter; left time: 142.4629s
	iters: 1100, epoch: 5 | loss: 0.4332491
	speed: 0.0245s/iter; left time: 138.8953s
Epoch: 5 cost time: 28.084601879119873
Epoch: 5, Steps: 1128 | Train Loss: 0.5184780 Vali Loss: 0.6825814 Test Loss: 0.3860536
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5171341
	speed: 0.0263s/iter; left time: 145.8005s
	iters: 200, epoch: 6 | loss: 0.6126877
	speed: 0.0234s/iter; left time: 127.1577s
	iters: 300, epoch: 6 | loss: 0.4318848
	speed: 0.0230s/iter; left time: 122.9140s
	iters: 400, epoch: 6 | loss: 0.6142907
	speed: 0.0229s/iter; left time: 119.7861s
	iters: 500, epoch: 6 | loss: 0.5159593
	speed: 0.0229s/iter; left time: 117.7874s
	iters: 600, epoch: 6 | loss: 0.5560477
	speed: 0.0232s/iter; left time: 117.1820s
	iters: 700, epoch: 6 | loss: 0.4938122
	speed: 0.0233s/iter; left time: 115.3261s
	iters: 800, epoch: 6 | loss: 0.3781525
	speed: 0.0232s/iter; left time: 112.3199s
	iters: 900, epoch: 6 | loss: 0.5165809
	speed: 0.0226s/iter; left time: 107.1897s
	iters: 1000, epoch: 6 | loss: 0.4363963
	speed: 0.0220s/iter; left time: 101.9899s
	iters: 1100, epoch: 6 | loss: 0.4177338
	speed: 0.0217s/iter; left time: 98.3368s
Epoch: 6 cost time: 24.438320636749268
Epoch: 6, Steps: 1128 | Train Loss: 0.5144619 Vali Loss: 0.6814158 Test Loss: 0.3901737
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.7139154
	speed: 0.0233s/iter; left time: 102.8655s
	iters: 200, epoch: 7 | loss: 0.4570285
	speed: 0.0226s/iter; left time: 97.6037s
	iters: 300, epoch: 7 | loss: 0.4578502
	speed: 0.0219s/iter; left time: 92.4527s
	iters: 400, epoch: 7 | loss: 0.5654996
	speed: 0.0221s/iter; left time: 90.9306s
	iters: 500, epoch: 7 | loss: 0.5795149
	speed: 0.0221s/iter; left time: 88.6434s
	iters: 600, epoch: 7 | loss: 0.5428276
	speed: 0.0220s/iter; left time: 86.1784s
	iters: 700, epoch: 7 | loss: 0.4153496
	speed: 0.0224s/iter; left time: 85.3295s
	iters: 800, epoch: 7 | loss: 0.6539457
	speed: 0.0225s/iter; left time: 83.5996s
	iters: 900, epoch: 7 | loss: 0.4468107
	speed: 0.0223s/iter; left time: 80.6967s
	iters: 1000, epoch: 7 | loss: 0.4136054
	speed: 0.0223s/iter; left time: 78.3913s
	iters: 1100, epoch: 7 | loss: 0.6163571
	speed: 0.0223s/iter; left time: 75.9705s
Epoch: 7 cost time: 25.22087526321411
Epoch: 7, Steps: 1128 | Train Loss: 0.5126097 Vali Loss: 0.6784149 Test Loss: 0.3896956
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.3507018983364105, mae:0.3765997886657715
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.5522550
	speed: 0.0307s/iter; left time: 343.5089s
	iters: 200, epoch: 1 | loss: 0.5514682
	speed: 0.0256s/iter; left time: 283.5490s
	iters: 300, epoch: 1 | loss: 0.8757242
	speed: 0.0232s/iter; left time: 255.1673s
	iters: 400, epoch: 1 | loss: 0.8651818
	speed: 0.0226s/iter; left time: 245.8200s
	iters: 500, epoch: 1 | loss: 0.5832282
	speed: 0.0228s/iter; left time: 246.1409s
	iters: 600, epoch: 1 | loss: 0.6121921
	speed: 0.0227s/iter; left time: 242.5086s
	iters: 700, epoch: 1 | loss: 0.7963312
	speed: 0.0226s/iter; left time: 238.9660s
	iters: 800, epoch: 1 | loss: 0.6824234
	speed: 0.0225s/iter; left time: 236.2754s
	iters: 900, epoch: 1 | loss: 0.6952960
	speed: 0.0225s/iter; left time: 233.2317s
	iters: 1000, epoch: 1 | loss: 0.4527203
	speed: 0.0224s/iter; left time: 230.4098s
	iters: 1100, epoch: 1 | loss: 0.6448156
	speed: 0.0226s/iter; left time: 230.5721s
Epoch: 1 cost time: 25.74750018119812
Epoch: 1, Steps: 1128 | Train Loss: 0.6215326 Vali Loss: 0.6858268 Test Loss: 0.3551992
Validation loss decreased (inf --> 0.685827).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5341999
	speed: 0.0364s/iter; left time: 366.2807s
	iters: 200, epoch: 2 | loss: 0.6774512
	speed: 0.0297s/iter; left time: 295.5639s
	iters: 300, epoch: 2 | loss: 0.6580303
	speed: 0.0268s/iter; left time: 264.1222s
	iters: 400, epoch: 2 | loss: 0.7265529
	speed: 0.0250s/iter; left time: 243.3557s
	iters: 500, epoch: 2 | loss: 0.5481659
	speed: 0.0237s/iter; left time: 229.2123s
	iters: 600, epoch: 2 | loss: 0.5446751
	speed: 0.0232s/iter; left time: 221.2613s
	iters: 700, epoch: 2 | loss: 0.4840779
	speed: 0.0239s/iter; left time: 225.5641s
	iters: 800, epoch: 2 | loss: 0.6058831
	speed: 0.0240s/iter; left time: 224.4627s
	iters: 900, epoch: 2 | loss: 0.7545149
	speed: 0.0237s/iter; left time: 219.0786s
	iters: 1000, epoch: 2 | loss: 0.5710295
	speed: 0.0232s/iter; left time: 212.4947s
	iters: 1100, epoch: 2 | loss: 0.9940811
	speed: 0.0226s/iter; left time: 204.7959s
Epoch: 2 cost time: 25.465337991714478
Epoch: 2, Steps: 1128 | Train Loss: 0.5729623 Vali Loss: 0.6725977 Test Loss: 0.3633438
Validation loss decreased (0.685827 --> 0.672598).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5687194
	speed: 0.0200s/iter; left time: 178.0903s
	iters: 200, epoch: 3 | loss: 0.6409013
	speed: 0.0213s/iter; left time: 188.1920s
	iters: 300, epoch: 3 | loss: 0.6184974
	speed: 0.0217s/iter; left time: 189.5370s
	iters: 400, epoch: 3 | loss: 0.4094636
	speed: 0.0218s/iter; left time: 187.8225s
	iters: 500, epoch: 3 | loss: 0.4850007
	speed: 0.0216s/iter; left time: 184.2533s
	iters: 600, epoch: 3 | loss: 0.6016427
	speed: 0.0212s/iter; left time: 178.3804s
	iters: 700, epoch: 3 | loss: 0.5007363
	speed: 0.0211s/iter; left time: 175.9293s
	iters: 800, epoch: 3 | loss: 0.4611828
	speed: 0.0212s/iter; left time: 174.4498s
	iters: 900, epoch: 3 | loss: 0.9003307
	speed: 0.0216s/iter; left time: 175.4548s
	iters: 1000, epoch: 3 | loss: 0.4001087
	speed: 0.0224s/iter; left time: 179.6908s
	iters: 1100, epoch: 3 | loss: 0.4400520
	speed: 0.0224s/iter; left time: 177.6412s
Epoch: 3 cost time: 25.519289255142212
Epoch: 3, Steps: 1128 | Train Loss: 0.5420860 Vali Loss: 0.6909451 Test Loss: 0.3823029
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8560143
	speed: 0.0392s/iter; left time: 305.8930s
	iters: 200, epoch: 4 | loss: 0.6522247
	speed: 0.0329s/iter; left time: 252.8957s
	iters: 300, epoch: 4 | loss: 0.4214912
	speed: 0.0303s/iter; left time: 229.9263s
	iters: 400, epoch: 4 | loss: 0.5485700
	speed: 0.0283s/iter; left time: 212.2898s
	iters: 500, epoch: 4 | loss: 0.7841114
	speed: 0.0268s/iter; left time: 198.6091s
	iters: 600, epoch: 4 | loss: 0.6997967
	speed: 0.0269s/iter; left time: 196.3173s
	iters: 700, epoch: 4 | loss: 0.3833983
	speed: 0.0265s/iter; left time: 190.4708s
	iters: 800, epoch: 4 | loss: 0.5397124
	speed: 0.0260s/iter; left time: 184.8664s
	iters: 900, epoch: 4 | loss: 0.4017108
	speed: 0.0259s/iter; left time: 181.2464s
	iters: 1000, epoch: 4 | loss: 0.5649521
	speed: 0.0258s/iter; left time: 177.6579s
	iters: 1100, epoch: 4 | loss: 0.3752801
	speed: 0.0256s/iter; left time: 173.7781s
Epoch: 4 cost time: 28.857231616973877
Epoch: 4, Steps: 1128 | Train Loss: 0.5259421 Vali Loss: 0.6854033 Test Loss: 0.3869407
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6526622
	speed: 0.0262s/iter; left time: 174.8475s
	iters: 200, epoch: 5 | loss: 0.4270140
	speed: 0.0254s/iter; left time: 166.6407s
	iters: 300, epoch: 5 | loss: 0.5834467
	speed: 0.0250s/iter; left time: 161.8972s
	iters: 400, epoch: 5 | loss: 0.4422268
	speed: 0.0257s/iter; left time: 163.5116s
	iters: 500, epoch: 5 | loss: 0.5652586
	speed: 0.0255s/iter; left time: 160.1069s
	iters: 600, epoch: 5 | loss: 0.4429828
	speed: 0.0250s/iter; left time: 154.2287s
	iters: 700, epoch: 5 | loss: 0.4878416
	speed: 0.0242s/iter; left time: 146.8325s
	iters: 800, epoch: 5 | loss: 0.4261882
	speed: 0.0236s/iter; left time: 141.1621s
	iters: 900, epoch: 5 | loss: 0.4067140
	speed: 0.0231s/iter; left time: 135.8145s
	iters: 1000, epoch: 5 | loss: 0.3614749
	speed: 0.0231s/iter; left time: 133.4325s
	iters: 1100, epoch: 5 | loss: 0.6544124
	speed: 0.0232s/iter; left time: 131.3275s
Epoch: 5 cost time: 26.278977870941162
Epoch: 5, Steps: 1128 | Train Loss: 0.5179758 Vali Loss: 0.6984375 Test Loss: 0.4025009
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4898531
	speed: 0.0301s/iter; left time: 166.7853s
	iters: 200, epoch: 6 | loss: 0.4680300
	speed: 0.0234s/iter; left time: 127.1045s
	iters: 300, epoch: 6 | loss: 0.3758879
	speed: 0.0210s/iter; left time: 112.3374s
	iters: 400, epoch: 6 | loss: 0.4632162
	speed: 0.0201s/iter; left time: 105.2883s
	iters: 500, epoch: 6 | loss: 0.4421870
	speed: 0.0197s/iter; left time: 101.1055s
	iters: 600, epoch: 6 | loss: 0.4577827
	speed: 0.0190s/iter; left time: 95.9987s
	iters: 700, epoch: 6 | loss: 0.6208373
	speed: 0.0192s/iter; left time: 94.6302s
	iters: 800, epoch: 6 | loss: 0.5528821
	speed: 0.0196s/iter; left time: 94.9694s
	iters: 900, epoch: 6 | loss: 0.5164244
	speed: 0.0209s/iter; left time: 99.1249s
	iters: 1000, epoch: 6 | loss: 0.6857562
	speed: 0.0214s/iter; left time: 99.1039s
	iters: 1100, epoch: 6 | loss: 0.4534069
	speed: 0.0215s/iter; left time: 97.5238s
Epoch: 6 cost time: 24.385441780090332
Epoch: 6, Steps: 1128 | Train Loss: 0.5141872 Vali Loss: 0.6981978 Test Loss: 0.3992606
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4215151
	speed: 0.0271s/iter; left time: 119.7459s
	iters: 200, epoch: 7 | loss: 0.4622502
	speed: 0.0258s/iter; left time: 111.0939s
	iters: 300, epoch: 7 | loss: 0.4042650
	speed: 0.0248s/iter; left time: 104.6097s
	iters: 400, epoch: 7 | loss: 0.4575357
	speed: 0.0243s/iter; left time: 100.0917s
	iters: 500, epoch: 7 | loss: 0.5977384
	speed: 0.0239s/iter; left time: 95.9562s
	iters: 600, epoch: 7 | loss: 0.4906479
	speed: 0.0236s/iter; left time: 92.2750s
	iters: 700, epoch: 7 | loss: 0.4453856
	speed: 0.0233s/iter; left time: 89.0324s
	iters: 800, epoch: 7 | loss: 0.4098958
	speed: 0.0230s/iter; left time: 85.5213s
	iters: 900, epoch: 7 | loss: 0.4913970
	speed: 0.0231s/iter; left time: 83.4846s
	iters: 1000, epoch: 7 | loss: 0.7685731
	speed: 0.0228s/iter; left time: 80.2600s
	iters: 1100, epoch: 7 | loss: 0.5946479
	speed: 0.0229s/iter; left time: 78.1983s
Epoch: 7 cost time: 25.88337779045105
Epoch: 7, Steps: 1128 | Train Loss: 0.5121492 Vali Loss: 0.6901911 Test Loss: 0.3961011
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.36334389448165894, mae:0.38323235511779785
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.6596413
	speed: 0.0458s/iter; left time: 512.1574s
	iters: 200, epoch: 1 | loss: 0.5430948
	speed: 0.0363s/iter; left time: 402.2944s
	iters: 300, epoch: 1 | loss: 0.5742071
	speed: 0.0312s/iter; left time: 342.5039s
	iters: 400, epoch: 1 | loss: 0.5759615
	speed: 0.0289s/iter; left time: 314.4767s
	iters: 500, epoch: 1 | loss: 0.8153110
	speed: 0.0275s/iter; left time: 296.7040s
	iters: 600, epoch: 1 | loss: 0.4381107
	speed: 0.0266s/iter; left time: 284.1421s
	iters: 700, epoch: 1 | loss: 0.7492399
	speed: 0.0258s/iter; left time: 273.2222s
	iters: 800, epoch: 1 | loss: 0.5375650
	speed: 0.0253s/iter; left time: 264.9253s
	iters: 900, epoch: 1 | loss: 0.5821893
	speed: 0.0249s/iter; left time: 258.0210s
	iters: 1000, epoch: 1 | loss: 0.7505085
	speed: 0.0247s/iter; left time: 253.4744s
	iters: 1100, epoch: 1 | loss: 0.5235450
	speed: 0.0244s/iter; left time: 247.9176s
Epoch: 1 cost time: 27.46548891067505
Epoch: 1, Steps: 1128 | Train Loss: 0.6233831 Vali Loss: 0.6458651 Test Loss: 0.3434418
Validation loss decreased (inf --> 0.645865).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5082805
	speed: 0.0283s/iter; left time: 284.4077s
	iters: 200, epoch: 2 | loss: 0.5706154
	speed: 0.0239s/iter; left time: 237.9609s
	iters: 300, epoch: 2 | loss: 0.5716352
	speed: 0.0225s/iter; left time: 221.6368s
	iters: 400, epoch: 2 | loss: 0.6082152
	speed: 0.0215s/iter; left time: 209.6330s
	iters: 500, epoch: 2 | loss: 0.5261326
	speed: 0.0206s/iter; left time: 198.7653s
	iters: 600, epoch: 2 | loss: 0.5566107
	speed: 0.0200s/iter; left time: 191.2233s
	iters: 700, epoch: 2 | loss: 0.4669527
	speed: 0.0200s/iter; left time: 189.3599s
	iters: 800, epoch: 2 | loss: 0.6256351
	speed: 0.0202s/iter; left time: 188.7967s
	iters: 900, epoch: 2 | loss: 0.5919423
	speed: 0.0207s/iter; left time: 191.7951s
	iters: 1000, epoch: 2 | loss: 0.5796580
	speed: 0.0211s/iter; left time: 192.9321s
	iters: 1100, epoch: 2 | loss: 0.4979737
	speed: 0.0218s/iter; left time: 197.4903s
Epoch: 2 cost time: 24.822608947753906
Epoch: 2, Steps: 1128 | Train Loss: 0.5765144 Vali Loss: 0.6709838 Test Loss: 0.3618021
EarlyStopping counter: 1 out of 5
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5900417
	speed: 0.0406s/iter; left time: 362.6870s
	iters: 200, epoch: 3 | loss: 0.4917572
	speed: 0.0406s/iter; left time: 358.5077s
	iters: 300, epoch: 3 | loss: 0.6067388
	speed: 0.0401s/iter; left time: 349.6982s
	iters: 400, epoch: 3 | loss: 0.5597922
	speed: 0.0382s/iter; left time: 329.6701s
	iters: 500, epoch: 3 | loss: 0.4178631
	speed: 0.0357s/iter; left time: 303.9375s
	iters: 600, epoch: 3 | loss: 0.4046146
	speed: 0.0338s/iter; left time: 284.4357s
	iters: 700, epoch: 3 | loss: 0.4821054
	speed: 0.0324s/iter; left time: 269.9684s
	iters: 800, epoch: 3 | loss: 0.4338664
	speed: 0.0314s/iter; left time: 258.4253s
	iters: 900, epoch: 3 | loss: 0.5885710
	speed: 0.0306s/iter; left time: 248.8444s
	iters: 1000, epoch: 3 | loss: 0.7531325
	speed: 0.0299s/iter; left time: 239.5645s
	iters: 1100, epoch: 3 | loss: 0.5004452
	speed: 0.0292s/iter; left time: 231.6214s
Epoch: 3 cost time: 32.837568521499634
Epoch: 3, Steps: 1128 | Train Loss: 0.5455597 Vali Loss: 0.6756113 Test Loss: 0.3757538
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4895009
	speed: 0.0244s/iter; left time: 190.2818s
	iters: 200, epoch: 4 | loss: 0.5621789
	speed: 0.0237s/iter; left time: 182.6740s
	iters: 300, epoch: 4 | loss: 0.4080878
	speed: 0.0234s/iter; left time: 177.9657s
	iters: 400, epoch: 4 | loss: 0.4749720
	speed: 0.0227s/iter; left time: 170.5089s
	iters: 500, epoch: 4 | loss: 0.5414015
	speed: 0.0224s/iter; left time: 165.7071s
	iters: 600, epoch: 4 | loss: 0.5326304
	speed: 0.0229s/iter; left time: 166.9927s
	iters: 700, epoch: 4 | loss: 0.4062031
	speed: 0.0228s/iter; left time: 164.0476s
	iters: 800, epoch: 4 | loss: 0.7291671
	speed: 0.0243s/iter; left time: 172.4505s
	iters: 900, epoch: 4 | loss: 0.5767975
	speed: 0.0247s/iter; left time: 172.7621s
	iters: 1000, epoch: 4 | loss: 0.4332857
	speed: 0.0245s/iter; left time: 169.2512s
	iters: 1100, epoch: 4 | loss: 0.7760563
	speed: 0.0244s/iter; left time: 165.8776s
Epoch: 4 cost time: 27.62144923210144
Epoch: 4, Steps: 1128 | Train Loss: 0.5297615 Vali Loss: 0.6788121 Test Loss: 0.3828132
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4614347
	speed: 0.0371s/iter; left time: 247.6724s
	iters: 200, epoch: 5 | loss: 0.5464805
	speed: 0.0273s/iter; left time: 179.0394s
	iters: 300, epoch: 5 | loss: 0.4236217
	speed: 0.0227s/iter; left time: 147.0113s
	iters: 400, epoch: 5 | loss: 0.4347206
	speed: 0.0213s/iter; left time: 135.6981s
	iters: 500, epoch: 5 | loss: 0.8290450
	speed: 0.0223s/iter; left time: 140.0752s
	iters: 600, epoch: 5 | loss: 0.4446949
	speed: 0.0222s/iter; left time: 137.0045s
	iters: 700, epoch: 5 | loss: 0.7383953
	speed: 0.0222s/iter; left time: 134.8442s
	iters: 800, epoch: 5 | loss: 0.7274895
	speed: 0.0224s/iter; left time: 133.9354s
	iters: 900, epoch: 5 | loss: 0.6851600
	speed: 0.0233s/iter; left time: 136.7051s
	iters: 1000, epoch: 5 | loss: 0.5715177
	speed: 0.0233s/iter; left time: 134.6481s
	iters: 1100, epoch: 5 | loss: 0.4779786
	speed: 0.0233s/iter; left time: 131.9975s
Epoch: 5 cost time: 26.409428119659424
Epoch: 5, Steps: 1128 | Train Loss: 0.5216864 Vali Loss: 0.6841235 Test Loss: 0.3926183
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4135339
	speed: 0.0290s/iter; left time: 160.4935s
	iters: 200, epoch: 6 | loss: 0.4744542
	speed: 0.0279s/iter; left time: 151.5758s
	iters: 300, epoch: 6 | loss: 0.4438978
	speed: 0.0290s/iter; left time: 155.1093s
	iters: 400, epoch: 6 | loss: 0.4391989
	speed: 0.0279s/iter; left time: 146.2531s
	iters: 500, epoch: 6 | loss: 0.7206690
	speed: 0.0268s/iter; left time: 137.8428s
	iters: 600, epoch: 6 | loss: 0.4742618
	speed: 0.0265s/iter; left time: 133.7679s
	iters: 700, epoch: 6 | loss: 0.5825699
	speed: 0.0263s/iter; left time: 129.9956s
	iters: 800, epoch: 6 | loss: 0.4918524
	speed: 0.0260s/iter; left time: 125.9932s
	iters: 900, epoch: 6 | loss: 0.4038947
	speed: 0.0262s/iter; left time: 124.3844s
	iters: 1000, epoch: 6 | loss: 0.4306394
	speed: 0.0259s/iter; left time: 120.1586s
	iters: 1100, epoch: 6 | loss: 0.6035635
	speed: 0.0261s/iter; left time: 118.5315s
Epoch: 6 cost time: 29.688345909118652
Epoch: 6, Steps: 1128 | Train Loss: 0.5179625 Vali Loss: 0.6913563 Test Loss: 0.3990138
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_42<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.571948230266571, mae:0.5593013167381287
Seed: 123
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_96       Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.3838891
	speed: 0.0528s/iter; left time: 600.6532s
	iters: 200, epoch: 1 | loss: 0.3388499
	speed: 0.0374s/iter; left time: 421.9204s
	iters: 300, epoch: 1 | loss: 0.5163966
	speed: 0.0339s/iter; left time: 378.9587s
	iters: 400, epoch: 1 | loss: 0.3070354
	speed: 0.0314s/iter; left time: 347.7748s
	iters: 500, epoch: 1 | loss: 0.6959258
	speed: 0.0297s/iter; left time: 325.6398s
	iters: 600, epoch: 1 | loss: 0.4722950
	speed: 0.0279s/iter; left time: 303.0580s
	iters: 700, epoch: 1 | loss: 0.3543356
	speed: 0.0274s/iter; left time: 295.3347s
	iters: 800, epoch: 1 | loss: 0.3724368
	speed: 0.0264s/iter; left time: 281.4395s
	iters: 900, epoch: 1 | loss: 0.3119000
	speed: 0.0263s/iter; left time: 278.3361s
	iters: 1000, epoch: 1 | loss: 0.3245766
	speed: 0.0257s/iter; left time: 269.4005s
	iters: 1100, epoch: 1 | loss: 1.3636049
	speed: 0.0252s/iter; left time: 261.1224s
Epoch: 1 cost time: 28.6349458694458
Epoch: 1, Steps: 1147 | Train Loss: 0.4542221 Vali Loss: 0.4003107 Test Loss: 0.1788880
Validation loss decreased (inf --> 0.400311).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3703045
	speed: 0.0276s/iter; left time: 282.2292s
	iters: 200, epoch: 2 | loss: 0.3711791
	speed: 0.0231s/iter; left time: 234.1316s
	iters: 300, epoch: 2 | loss: 1.2447677
	speed: 0.0219s/iter; left time: 220.0119s
	iters: 400, epoch: 2 | loss: 0.3629710
	speed: 0.0213s/iter; left time: 211.4345s
	iters: 500, epoch: 2 | loss: 0.3038826
	speed: 0.0214s/iter; left time: 210.3904s
	iters: 600, epoch: 2 | loss: 0.3707208
	speed: 0.0234s/iter; left time: 227.3958s
	iters: 700, epoch: 2 | loss: 0.3006352
	speed: 0.0252s/iter; left time: 242.1714s
	iters: 800, epoch: 2 | loss: 0.2301466
	speed: 0.0264s/iter; left time: 251.9035s
	iters: 900, epoch: 2 | loss: 0.4540290
	speed: 0.0274s/iter; left time: 257.8101s
	iters: 1000, epoch: 2 | loss: 0.3760805
	speed: 0.0275s/iter; left time: 256.1327s
	iters: 1100, epoch: 2 | loss: 1.2292988
	speed: 0.0270s/iter; left time: 249.1204s
Epoch: 2 cost time: 30.900071382522583
Epoch: 2, Steps: 1147 | Train Loss: 0.4115299 Vali Loss: 0.3996583 Test Loss: 0.1719534
Validation loss decreased (0.400311 --> 0.399658).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2734459
	speed: 0.0367s/iter; left time: 332.9365s
	iters: 200, epoch: 3 | loss: 0.3033302
	speed: 0.0353s/iter; left time: 316.6349s
	iters: 300, epoch: 3 | loss: 0.5347874
	speed: 0.0311s/iter; left time: 276.1529s
	iters: 400, epoch: 3 | loss: 0.2419485
	speed: 0.0295s/iter; left time: 258.5376s
	iters: 500, epoch: 3 | loss: 0.3915340
	speed: 0.0298s/iter; left time: 258.7435s
	iters: 600, epoch: 3 | loss: 0.2694460
	speed: 0.0301s/iter; left time: 258.5055s
	iters: 700, epoch: 3 | loss: 0.2971855
	speed: 0.0292s/iter; left time: 247.4907s
	iters: 800, epoch: 3 | loss: 0.5025353
	speed: 0.0286s/iter; left time: 239.8091s
	iters: 900, epoch: 3 | loss: 0.4238190
	speed: 0.0282s/iter; left time: 233.4165s
	iters: 1000, epoch: 3 | loss: 0.3755932
	speed: 0.0275s/iter; left time: 224.8768s
	iters: 1100, epoch: 3 | loss: 1.1495930
	speed: 0.0274s/iter; left time: 221.1065s
Epoch: 3 cost time: 31.821369886398315
Epoch: 3, Steps: 1147 | Train Loss: 0.3901587 Vali Loss: 0.3957593 Test Loss: 0.1661969
Validation loss decreased (0.399658 --> 0.395759).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2690917
	speed: 0.0372s/iter; left time: 295.1660s
	iters: 200, epoch: 4 | loss: 0.2727569
	speed: 0.0316s/iter; left time: 247.7206s
	iters: 300, epoch: 4 | loss: 0.3282866
	speed: 0.0270s/iter; left time: 208.4612s
	iters: 400, epoch: 4 | loss: 0.2810601
	speed: 0.0243s/iter; left time: 185.3478s
	iters: 500, epoch: 4 | loss: 1.2619332
	speed: 0.0228s/iter; left time: 171.9781s
	iters: 600, epoch: 4 | loss: 0.2872150
	speed: 0.0222s/iter; left time: 164.9080s
	iters: 700, epoch: 4 | loss: 0.4709702
	speed: 0.0227s/iter; left time: 166.7152s
	iters: 800, epoch: 4 | loss: 0.2291499
	speed: 0.0230s/iter; left time: 166.5035s
	iters: 900, epoch: 4 | loss: 0.2687799
	speed: 0.0229s/iter; left time: 163.3640s
	iters: 1000, epoch: 4 | loss: 0.2640110
	speed: 0.0227s/iter; left time: 159.7319s
	iters: 1100, epoch: 4 | loss: 0.3015024
	speed: 0.0220s/iter; left time: 152.4998s
Epoch: 4 cost time: 25.517700910568237
Epoch: 4, Steps: 1147 | Train Loss: 0.3791121 Vali Loss: 0.3982003 Test Loss: 0.1689293
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6936308
	speed: 0.0234s/iter; left time: 158.9526s
	iters: 200, epoch: 5 | loss: 0.2239568
	speed: 0.0226s/iter; left time: 151.1650s
	iters: 300, epoch: 5 | loss: 0.2537941
	speed: 0.0232s/iter; left time: 152.7777s
	iters: 400, epoch: 5 | loss: 0.5643872
	speed: 0.0235s/iter; left time: 152.5216s
	iters: 500, epoch: 5 | loss: 0.2474638
	speed: 0.0236s/iter; left time: 150.6893s
	iters: 600, epoch: 5 | loss: 0.1969093
	speed: 0.0235s/iter; left time: 147.7087s
	iters: 700, epoch: 5 | loss: 0.2656100
	speed: 0.0234s/iter; left time: 144.7705s
	iters: 800, epoch: 5 | loss: 0.2558141
	speed: 0.0234s/iter; left time: 142.1125s
	iters: 900, epoch: 5 | loss: 0.4148611
	speed: 0.0233s/iter; left time: 139.5129s
	iters: 1000, epoch: 5 | loss: 0.4538814
	speed: 0.0233s/iter; left time: 136.8875s
	iters: 1100, epoch: 5 | loss: 0.2868766
	speed: 0.0235s/iter; left time: 136.1667s
Epoch: 5 cost time: 27.297178745269775
Epoch: 5, Steps: 1147 | Train Loss: 0.3733642 Vali Loss: 0.3999824 Test Loss: 0.1670727
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2508298
	speed: 0.0206s/iter; left time: 116.1723s
	iters: 200, epoch: 6 | loss: 0.2499858
	speed: 0.0207s/iter; left time: 114.4928s
	iters: 300, epoch: 6 | loss: 0.4163831
	speed: 0.0219s/iter; left time: 119.0659s
	iters: 400, epoch: 6 | loss: 0.3706366
	speed: 0.0223s/iter; left time: 118.7627s
	iters: 500, epoch: 6 | loss: 0.3532901
	speed: 0.0227s/iter; left time: 119.0952s
	iters: 600, epoch: 6 | loss: 0.2506419
	speed: 0.0231s/iter; left time: 118.5561s
	iters: 700, epoch: 6 | loss: 0.2874207
	speed: 0.0233s/iter; left time: 117.1499s
	iters: 800, epoch: 6 | loss: 0.2192727
	speed: 0.0234s/iter; left time: 115.3864s
	iters: 900, epoch: 6 | loss: 0.3782870
	speed: 0.0235s/iter; left time: 113.4797s
	iters: 1000, epoch: 6 | loss: 0.2274396
	speed: 0.0236s/iter; left time: 111.5361s
	iters: 1100, epoch: 6 | loss: 0.3669139
	speed: 0.0236s/iter; left time: 109.4528s
Epoch: 6 cost time: 27.256605625152588
Epoch: 6, Steps: 1147 | Train Loss: 0.3702848 Vali Loss: 0.3993436 Test Loss: 0.1670768
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3770770
	speed: 0.0340s/iter; left time: 152.5354s
	iters: 200, epoch: 7 | loss: 0.6116623
	speed: 0.0282s/iter; left time: 123.6358s
	iters: 300, epoch: 7 | loss: 0.2163821
	speed: 0.0257s/iter; left time: 110.4157s
	iters: 400, epoch: 7 | loss: 0.2282686
	speed: 0.0241s/iter; left time: 101.0256s
	iters: 500, epoch: 7 | loss: 0.2275593
	speed: 0.0246s/iter; left time: 100.5228s
	iters: 600, epoch: 7 | loss: 0.5707138
	speed: 0.0254s/iter; left time: 101.4237s
	iters: 700, epoch: 7 | loss: 0.2366407
	speed: 0.0263s/iter; left time: 102.2645s
	iters: 800, epoch: 7 | loss: 0.2316858
	speed: 0.0260s/iter; left time: 98.5965s
	iters: 900, epoch: 7 | loss: 0.3007270
	speed: 0.0254s/iter; left time: 93.6710s
	iters: 1000, epoch: 7 | loss: 0.4318654
	speed: 0.0248s/iter; left time: 89.1530s
	iters: 1100, epoch: 7 | loss: 0.4513146
	speed: 0.0239s/iter; left time: 83.5293s
Epoch: 7 cost time: 27.143803358078003
Epoch: 7, Steps: 1147 | Train Loss: 0.3686482 Vali Loss: 0.3990803 Test Loss: 0.1671661
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4769196
	speed: 0.0400s/iter; left time: 133.6357s
	iters: 200, epoch: 8 | loss: 0.3050572
	speed: 0.0313s/iter; left time: 101.5110s
	iters: 300, epoch: 8 | loss: 0.2984728
	speed: 0.0271s/iter; left time: 85.1106s
	iters: 400, epoch: 8 | loss: 0.2236934
	speed: 0.0250s/iter; left time: 76.1909s
	iters: 500, epoch: 8 | loss: 0.5505057
	speed: 0.0238s/iter; left time: 69.8761s
	iters: 600, epoch: 8 | loss: 0.4461372
	speed: 0.0232s/iter; left time: 65.9456s
	iters: 700, epoch: 8 | loss: 0.2382980
	speed: 0.0234s/iter; left time: 64.1762s
	iters: 800, epoch: 8 | loss: 0.2438385
	speed: 0.0236s/iter; left time: 62.2508s
	iters: 900, epoch: 8 | loss: 0.2104617
	speed: 0.0237s/iter; left time: 60.2116s
	iters: 1000, epoch: 8 | loss: 0.3243884
	speed: 0.0238s/iter; left time: 58.1770s
	iters: 1100, epoch: 8 | loss: 0.2700267
	speed: 0.0240s/iter; left time: 56.1968s
Epoch: 8 cost time: 27.70851159095764
Epoch: 8, Steps: 1147 | Train Loss: 0.3678870 Vali Loss: 0.4011340 Test Loss: 0.1683156
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.16619691252708435, mae:0.2256096750497818
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.2968871
	speed: 0.0262s/iter; left time: 298.2791s
	iters: 200, epoch: 1 | loss: 0.3006610
	speed: 0.0265s/iter; left time: 299.1896s
	iters: 300, epoch: 1 | loss: 1.1108508
	speed: 0.0251s/iter; left time: 280.9093s
	iters: 400, epoch: 1 | loss: 0.3441081
	speed: 0.0245s/iter; left time: 271.0041s
	iters: 500, epoch: 1 | loss: 0.4731704
	speed: 0.0245s/iter; left time: 269.2095s
	iters: 600, epoch: 1 | loss: 0.5519249
	speed: 0.0269s/iter; left time: 292.8857s
	iters: 700, epoch: 1 | loss: 0.2856960
	speed: 0.0275s/iter; left time: 295.6677s
	iters: 800, epoch: 1 | loss: 0.2825187
	speed: 0.0268s/iter; left time: 286.1949s
	iters: 900, epoch: 1 | loss: 0.2914452
	speed: 0.0263s/iter; left time: 278.1338s
	iters: 1000, epoch: 1 | loss: 0.2956704
	speed: 0.0259s/iter; left time: 270.8410s
	iters: 1100, epoch: 1 | loss: 0.3670810
	speed: 0.0255s/iter; left time: 264.6190s
Epoch: 1 cost time: 29.218042373657227
Epoch: 1, Steps: 1147 | Train Loss: 0.4529960 Vali Loss: 0.4019834 Test Loss: 0.1757245
Validation loss decreased (inf --> 0.401983).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2644194
	speed: 0.0240s/iter; left time: 245.8585s
	iters: 200, epoch: 2 | loss: 0.2904559
	speed: 0.0218s/iter; left time: 220.7432s
	iters: 300, epoch: 2 | loss: 0.2655984
	speed: 0.0210s/iter; left time: 210.7191s
	iters: 400, epoch: 2 | loss: 0.2950690
	speed: 0.0213s/iter; left time: 211.8020s
	iters: 500, epoch: 2 | loss: 0.2886750
	speed: 0.0220s/iter; left time: 215.8339s
	iters: 600, epoch: 2 | loss: 0.3387893
	speed: 0.0224s/iter; left time: 217.4287s
	iters: 700, epoch: 2 | loss: 0.2686343
	speed: 0.0225s/iter; left time: 216.1370s
	iters: 800, epoch: 2 | loss: 1.1998990
	speed: 0.0222s/iter; left time: 211.0498s
	iters: 900, epoch: 2 | loss: 0.3519213
	speed: 0.0218s/iter; left time: 205.5161s
	iters: 1000, epoch: 2 | loss: 0.2985386
	speed: 0.0216s/iter; left time: 201.6123s
	iters: 1100, epoch: 2 | loss: 0.4652332
	speed: 0.0215s/iter; left time: 197.9353s
Epoch: 2 cost time: 24.601784706115723
Epoch: 2, Steps: 1147 | Train Loss: 0.4105635 Vali Loss: 0.4018681 Test Loss: 0.1699677
Validation loss decreased (0.401983 --> 0.401868).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 1.2097651
	speed: 0.0266s/iter; left time: 241.0797s
	iters: 200, epoch: 3 | loss: 0.2202639
	speed: 0.0227s/iter; left time: 203.8264s
	iters: 300, epoch: 3 | loss: 0.3488759
	speed: 0.0212s/iter; left time: 188.3902s
	iters: 400, epoch: 3 | loss: 0.2833678
	speed: 0.0212s/iter; left time: 185.9652s
	iters: 500, epoch: 3 | loss: 0.4601261
	speed: 0.0214s/iter; left time: 185.9719s
	iters: 600, epoch: 3 | loss: 0.2680887
	speed: 0.0226s/iter; left time: 194.1421s
	iters: 700, epoch: 3 | loss: 0.2570029
	speed: 0.0231s/iter; left time: 196.1820s
	iters: 800, epoch: 3 | loss: 0.3208054
	speed: 0.0233s/iter; left time: 195.2463s
	iters: 900, epoch: 3 | loss: 0.3451653
	speed: 0.0234s/iter; left time: 193.2896s
	iters: 1000, epoch: 3 | loss: 0.1985541
	speed: 0.0235s/iter; left time: 191.9785s
	iters: 1100, epoch: 3 | loss: 0.4192778
	speed: 0.0236s/iter; left time: 190.7008s
Epoch: 3 cost time: 27.24143123626709
Epoch: 3, Steps: 1147 | Train Loss: 0.3884597 Vali Loss: 0.4009782 Test Loss: 0.1688086
Validation loss decreased (0.401868 --> 0.400978).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2763550
	speed: 0.0358s/iter; left time: 283.8057s
	iters: 200, epoch: 4 | loss: 0.2385306
	speed: 0.0275s/iter; left time: 215.4879s
	iters: 300, epoch: 4 | loss: 0.3046317
	speed: 0.0250s/iter; left time: 193.3919s
	iters: 400, epoch: 4 | loss: 0.2426043
	speed: 0.0252s/iter; left time: 192.5243s
	iters: 500, epoch: 4 | loss: 0.3597815
	speed: 0.0253s/iter; left time: 190.5368s
	iters: 600, epoch: 4 | loss: 0.3784040
	speed: 0.0249s/iter; left time: 185.0354s
	iters: 700, epoch: 4 | loss: 0.2987791
	speed: 0.0246s/iter; left time: 180.3663s
	iters: 800, epoch: 4 | loss: 0.2360670
	speed: 0.0243s/iter; left time: 175.9520s
	iters: 900, epoch: 4 | loss: 0.2288096
	speed: 0.0243s/iter; left time: 173.4435s
	iters: 1000, epoch: 4 | loss: 0.2895429
	speed: 0.0244s/iter; left time: 171.2205s
	iters: 1100, epoch: 4 | loss: 0.4973874
	speed: 0.0244s/iter; left time: 168.9604s
Epoch: 4 cost time: 28.09130334854126
Epoch: 4, Steps: 1147 | Train Loss: 0.3768411 Vali Loss: 0.4058681 Test Loss: 0.1665959
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2349650
	speed: 0.0392s/iter; left time: 266.0954s
	iters: 200, epoch: 5 | loss: 0.2235671
	speed: 0.0319s/iter; left time: 212.8750s
	iters: 300, epoch: 5 | loss: 0.2280144
	speed: 0.0289s/iter; left time: 190.2666s
	iters: 400, epoch: 5 | loss: 0.2671737
	speed: 0.0280s/iter; left time: 181.2717s
	iters: 500, epoch: 5 | loss: 1.1927922
	speed: 0.0269s/iter; left time: 171.6861s
	iters: 600, epoch: 5 | loss: 0.2574506
	speed: 0.0260s/iter; left time: 163.3426s
	iters: 700, epoch: 5 | loss: 0.2661360
	speed: 0.0260s/iter; left time: 160.6023s
	iters: 800, epoch: 5 | loss: 0.2798266
	speed: 0.0255s/iter; left time: 154.8646s
	iters: 900, epoch: 5 | loss: 0.2014884
	speed: 0.0248s/iter; left time: 148.2863s
	iters: 1000, epoch: 5 | loss: 0.3597442
	speed: 0.0241s/iter; left time: 141.6516s
	iters: 1100, epoch: 5 | loss: 0.2038602
	speed: 0.0237s/iter; left time: 136.9633s
Epoch: 5 cost time: 27.28887701034546
Epoch: 5, Steps: 1147 | Train Loss: 0.3710594 Vali Loss: 0.4074467 Test Loss: 0.1675278
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3493775
	speed: 0.0315s/iter; left time: 177.6305s
	iters: 200, epoch: 6 | loss: 0.3773626
	speed: 0.0286s/iter; left time: 158.3391s
	iters: 300, epoch: 6 | loss: 1.2339787
	speed: 0.0295s/iter; left time: 160.1182s
	iters: 400, epoch: 6 | loss: 0.3540859
	speed: 0.0288s/iter; left time: 153.8318s
	iters: 500, epoch: 6 | loss: 0.4087559
	speed: 0.0278s/iter; left time: 145.3984s
	iters: 600, epoch: 6 | loss: 0.2193922
	speed: 0.0267s/iter; left time: 136.9991s
	iters: 700, epoch: 6 | loss: 0.3453961
	speed: 0.0259s/iter; left time: 130.6545s
	iters: 800, epoch: 6 | loss: 0.3089419
	speed: 0.0255s/iter; left time: 125.9132s
	iters: 900, epoch: 6 | loss: 0.2517677
	speed: 0.0251s/iter; left time: 121.5786s
	iters: 1000, epoch: 6 | loss: 0.2321314
	speed: 0.0256s/iter; left time: 121.3666s
	iters: 1100, epoch: 6 | loss: 0.3248681
	speed: 0.0265s/iter; left time: 122.7302s
Epoch: 6 cost time: 30.83131432533264
Epoch: 6, Steps: 1147 | Train Loss: 0.3677693 Vali Loss: 0.4071572 Test Loss: 0.1654266
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3462836
	speed: 0.0353s/iter; left time: 158.6209s
	iters: 200, epoch: 7 | loss: 0.2022117
	speed: 0.0338s/iter; left time: 148.4007s
	iters: 300, epoch: 7 | loss: 0.3823766
	speed: 0.0334s/iter; left time: 143.1773s
	iters: 400, epoch: 7 | loss: 0.2465654
	speed: 0.0312s/iter; left time: 130.8928s
	iters: 500, epoch: 7 | loss: 0.1999518
	speed: 0.0306s/iter; left time: 125.1708s
	iters: 600, epoch: 7 | loss: 0.2215539
	speed: 0.0308s/iter; left time: 122.8989s
	iters: 700, epoch: 7 | loss: 0.2716336
	speed: 0.0321s/iter; left time: 124.9282s
	iters: 800, epoch: 7 | loss: 0.1933519
	speed: 0.0334s/iter; left time: 126.4146s
	iters: 900, epoch: 7 | loss: 0.3586476
	speed: 0.0332s/iter; left time: 122.5351s
	iters: 1000, epoch: 7 | loss: 1.2265199
	speed: 0.0320s/iter; left time: 114.8805s
	iters: 1100, epoch: 7 | loss: 0.6095496
	speed: 0.0311s/iter; left time: 108.4251s
Epoch: 7 cost time: 35.33287858963013
Epoch: 7, Steps: 1147 | Train Loss: 0.3663004 Vali Loss: 0.4080790 Test Loss: 0.1667019
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4375026
	speed: 0.0282s/iter; left time: 94.2450s
	iters: 200, epoch: 8 | loss: 0.2879115
	speed: 0.0241s/iter; left time: 78.0165s
	iters: 300, epoch: 8 | loss: 0.3452281
	speed: 0.0228s/iter; left time: 71.5444s
	iters: 400, epoch: 8 | loss: 0.5714501
	speed: 0.0207s/iter; left time: 62.9464s
	iters: 500, epoch: 8 | loss: 0.3992556
	speed: 0.0207s/iter; left time: 60.9930s
	iters: 600, epoch: 8 | loss: 0.2936059
	speed: 0.0215s/iter; left time: 61.0759s
	iters: 700, epoch: 8 | loss: 0.2102907
	speed: 0.0213s/iter; left time: 58.3162s
	iters: 800, epoch: 8 | loss: 0.4268050
	speed: 0.0216s/iter; left time: 57.1825s
	iters: 900, epoch: 8 | loss: 1.1663773
	speed: 0.0230s/iter; left time: 58.5857s
	iters: 1000, epoch: 8 | loss: 0.2544379
	speed: 0.0242s/iter; left time: 59.1584s
	iters: 1100, epoch: 8 | loss: 0.2574286
	speed: 0.0241s/iter; left time: 56.3361s
Epoch: 8 cost time: 27.664849996566772
Epoch: 8, Steps: 1147 | Train Loss: 0.3653634 Vali Loss: 0.4095119 Test Loss: 0.1670515
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.16880862414836884, mae:0.23028334975242615
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.3470238
	speed: 0.0399s/iter; left time: 453.8155s
	iters: 200, epoch: 1 | loss: 0.3930535
	speed: 0.0371s/iter; left time: 417.7927s
	iters: 300, epoch: 1 | loss: 0.3226670
	speed: 0.0351s/iter; left time: 391.8735s
	iters: 400, epoch: 1 | loss: 0.3225301
	speed: 0.0324s/iter; left time: 358.8411s
	iters: 500, epoch: 1 | loss: 0.4478513
	speed: 0.0304s/iter; left time: 333.0112s
	iters: 600, epoch: 1 | loss: 0.2804888
	speed: 0.0293s/iter; left time: 318.1743s
	iters: 700, epoch: 1 | loss: 0.3171831
	speed: 0.0283s/iter; left time: 305.1692s
	iters: 800, epoch: 1 | loss: 0.3113923
	speed: 0.0276s/iter; left time: 294.8496s
	iters: 900, epoch: 1 | loss: 0.3862303
	speed: 0.0272s/iter; left time: 287.1384s
	iters: 1000, epoch: 1 | loss: 0.3610930
	speed: 0.0274s/iter; left time: 286.9447s
	iters: 1100, epoch: 1 | loss: 0.4141816
	speed: 0.0273s/iter; left time: 282.8701s
Epoch: 1 cost time: 31.358445644378662
Epoch: 1, Steps: 1147 | Train Loss: 0.4540697 Vali Loss: 0.4048854 Test Loss: 0.1761218
Validation loss decreased (inf --> 0.404885).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2282407
	speed: 0.0271s/iter; left time: 277.3609s
	iters: 200, epoch: 2 | loss: 0.3689061
	speed: 0.0250s/iter; left time: 253.3908s
	iters: 300, epoch: 2 | loss: 0.3006387
	speed: 0.0243s/iter; left time: 243.2723s
	iters: 400, epoch: 2 | loss: 0.3750479
	speed: 0.0243s/iter; left time: 241.1891s
	iters: 500, epoch: 2 | loss: 0.2272153
	speed: 0.0265s/iter; left time: 260.4787s
	iters: 600, epoch: 2 | loss: 0.4501353
	speed: 0.0277s/iter; left time: 269.4315s
	iters: 700, epoch: 2 | loss: 0.4878821
	speed: 0.0272s/iter; left time: 262.1598s
	iters: 800, epoch: 2 | loss: 0.3807950
	speed: 0.0265s/iter; left time: 251.9418s
	iters: 900, epoch: 2 | loss: 0.3149483
	speed: 0.0263s/iter; left time: 247.6755s
	iters: 1000, epoch: 2 | loss: 0.5163060
	speed: 0.0271s/iter; left time: 252.3708s
	iters: 1100, epoch: 2 | loss: 0.2637335
	speed: 0.0271s/iter; left time: 249.9104s
Epoch: 2 cost time: 30.897728443145752
Epoch: 2, Steps: 1147 | Train Loss: 0.4103626 Vali Loss: 0.3943245 Test Loss: 0.1679486
Validation loss decreased (0.404885 --> 0.394325).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1984051
	speed: 0.0340s/iter; left time: 308.3459s
	iters: 200, epoch: 3 | loss: 0.2295231
	speed: 0.0282s/iter; left time: 253.0223s
	iters: 300, epoch: 3 | loss: 0.8757575
	speed: 0.0245s/iter; left time: 217.9273s
	iters: 400, epoch: 3 | loss: 0.3114238
	speed: 0.0239s/iter; left time: 209.6967s
	iters: 500, epoch: 3 | loss: 0.1839081
	speed: 0.0231s/iter; left time: 200.4490s
	iters: 600, epoch: 3 | loss: 0.2258635
	speed: 0.0228s/iter; left time: 195.4861s
	iters: 700, epoch: 3 | loss: 0.2519797
	speed: 0.0227s/iter; left time: 192.0137s
	iters: 800, epoch: 3 | loss: 0.2518424
	speed: 0.0225s/iter; left time: 188.7668s
	iters: 900, epoch: 3 | loss: 0.2658925
	speed: 0.0226s/iter; left time: 187.3355s
	iters: 1000, epoch: 3 | loss: 0.2767480
	speed: 0.0227s/iter; left time: 186.0201s
	iters: 1100, epoch: 3 | loss: 0.3685272
	speed: 0.0228s/iter; left time: 184.0241s
Epoch: 3 cost time: 26.254717111587524
Epoch: 3, Steps: 1147 | Train Loss: 0.3884811 Vali Loss: 0.3965855 Test Loss: 0.1658220
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4027181
	speed: 0.0367s/iter; left time: 291.0982s
	iters: 200, epoch: 4 | loss: 0.2112313
	speed: 0.0299s/iter; left time: 234.4383s
	iters: 300, epoch: 4 | loss: 0.2380458
	speed: 0.0281s/iter; left time: 217.2986s
	iters: 400, epoch: 4 | loss: 0.2659602
	speed: 0.0289s/iter; left time: 220.8051s
	iters: 500, epoch: 4 | loss: 0.3301624
	speed: 0.0280s/iter; left time: 210.6226s
	iters: 600, epoch: 4 | loss: 0.2545710
	speed: 0.0286s/iter; left time: 212.1309s
	iters: 700, epoch: 4 | loss: 0.2511096
	speed: 0.0291s/iter; left time: 212.9513s
	iters: 800, epoch: 4 | loss: 0.3493679
	speed: 0.0288s/iter; left time: 208.3205s
	iters: 900, epoch: 4 | loss: 0.2767193
	speed: 0.0286s/iter; left time: 203.9595s
	iters: 1000, epoch: 4 | loss: 0.2420465
	speed: 0.0280s/iter; left time: 196.9016s
	iters: 1100, epoch: 4 | loss: 0.2744541
	speed: 0.0275s/iter; left time: 190.6129s
Epoch: 4 cost time: 31.466013431549072
Epoch: 4, Steps: 1147 | Train Loss: 0.3770928 Vali Loss: 0.3948403 Test Loss: 0.1673832
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3228280
	speed: 0.0367s/iter; left time: 248.8988s
	iters: 200, epoch: 5 | loss: 0.2992894
	speed: 0.0296s/iter; left time: 198.1004s
	iters: 300, epoch: 5 | loss: 0.2466294
	speed: 0.0271s/iter; left time: 178.5500s
	iters: 400, epoch: 5 | loss: 0.1960179
	speed: 0.0285s/iter; left time: 184.6011s
	iters: 500, epoch: 5 | loss: 0.4229175
	speed: 0.0277s/iter; left time: 176.9956s
	iters: 600, epoch: 5 | loss: 0.2566585
	speed: 0.0266s/iter; left time: 167.2571s
	iters: 700, epoch: 5 | loss: 0.3439880
	speed: 0.0261s/iter; left time: 161.2332s
	iters: 800, epoch: 5 | loss: 0.3338249
	speed: 0.0257s/iter; left time: 156.1859s
	iters: 900, epoch: 5 | loss: 0.3118178
	speed: 0.0250s/iter; left time: 149.3960s
	iters: 1000, epoch: 5 | loss: 0.2190881
	speed: 0.0246s/iter; left time: 144.6429s
	iters: 1100, epoch: 5 | loss: 0.2417575
	speed: 0.0244s/iter; left time: 141.3355s
Epoch: 5 cost time: 28.130221605300903
Epoch: 5, Steps: 1147 | Train Loss: 0.3712582 Vali Loss: 0.4006663 Test Loss: 0.1692550
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5044392
	speed: 0.0338s/iter; left time: 190.5238s
	iters: 200, epoch: 6 | loss: 0.2815789
	speed: 0.0304s/iter; left time: 168.5296s
	iters: 300, epoch: 6 | loss: 0.2516720
	speed: 0.0283s/iter; left time: 154.1083s
	iters: 400, epoch: 6 | loss: 0.2707363
	speed: 0.0281s/iter; left time: 149.9824s
	iters: 500, epoch: 6 | loss: 0.2549002
	speed: 0.0257s/iter; left time: 134.4050s
	iters: 600, epoch: 6 | loss: 0.2223107
	speed: 0.0241s/iter; left time: 123.9736s
	iters: 700, epoch: 6 | loss: 0.2161407
	speed: 0.0226s/iter; left time: 113.9772s
	iters: 800, epoch: 6 | loss: 0.2691137
	speed: 0.0217s/iter; left time: 107.1219s
	iters: 900, epoch: 6 | loss: 0.2600556
	speed: 0.0210s/iter; left time: 101.5915s
	iters: 1000, epoch: 6 | loss: 0.2299624
	speed: 0.0206s/iter; left time: 97.4875s
	iters: 1100, epoch: 6 | loss: 0.2825654
	speed: 0.0205s/iter; left time: 94.8749s
Epoch: 6 cost time: 23.4236102104187
Epoch: 6, Steps: 1147 | Train Loss: 0.3681627 Vali Loss: 0.3992266 Test Loss: 0.1677318
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2485998
	speed: 0.0230s/iter; left time: 103.4550s
	iters: 200, epoch: 7 | loss: 0.3536053
	speed: 0.0211s/iter; left time: 92.5403s
	iters: 300, epoch: 7 | loss: 1.1143311
	speed: 0.0216s/iter; left time: 92.6556s
	iters: 400, epoch: 7 | loss: 0.2147218
	speed: 0.0214s/iter; left time: 89.6904s
	iters: 500, epoch: 7 | loss: 0.2627218
	speed: 0.0215s/iter; left time: 87.8482s
	iters: 600, epoch: 7 | loss: 0.2636220
	speed: 0.0216s/iter; left time: 86.0872s
	iters: 700, epoch: 7 | loss: 0.2410219
	speed: 0.0218s/iter; left time: 84.5955s
	iters: 800, epoch: 7 | loss: 0.3041763
	speed: 0.0217s/iter; left time: 82.1036s
	iters: 900, epoch: 7 | loss: 0.2308095
	speed: 0.0218s/iter; left time: 80.4828s
	iters: 1000, epoch: 7 | loss: 0.2144890
	speed: 0.0220s/iter; left time: 79.0232s
	iters: 1100, epoch: 7 | loss: 0.3926098
	speed: 0.0222s/iter; left time: 77.3655s
Epoch: 7 cost time: 25.627942085266113
Epoch: 7, Steps: 1147 | Train Loss: 0.3664603 Vali Loss: 0.3995611 Test Loss: 0.1693227
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.16794860363006592, mae:0.2287728637456894
Seed: 123
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_192      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.4777755
	speed: 0.0499s/iter; left time: 566.0342s
	iters: 200, epoch: 1 | loss: 0.4699516
	speed: 0.0354s/iter; left time: 397.8029s
	iters: 300, epoch: 1 | loss: 0.4576730
	speed: 0.0316s/iter; left time: 351.5195s
	iters: 400, epoch: 1 | loss: 0.3770469
	speed: 0.0289s/iter; left time: 319.0018s
	iters: 500, epoch: 1 | loss: 0.3742835
	speed: 0.0282s/iter; left time: 308.1529s
	iters: 600, epoch: 1 | loss: 0.8269901
	speed: 0.0292s/iter; left time: 316.2108s
	iters: 700, epoch: 1 | loss: 0.3134441
	speed: 0.0297s/iter; left time: 319.1233s
	iters: 800, epoch: 1 | loss: 0.5532177
	speed: 0.0289s/iter; left time: 306.9992s
	iters: 900, epoch: 1 | loss: 0.4551199
	speed: 0.0284s/iter; left time: 299.7567s
	iters: 1000, epoch: 1 | loss: 0.3140891
	speed: 0.0278s/iter; left time: 290.4971s
	iters: 1100, epoch: 1 | loss: 0.3267543
	speed: 0.0274s/iter; left time: 283.1768s
Epoch: 1 cost time: 31.250367403030396
Epoch: 1, Steps: 1144 | Train Loss: 0.5082782 Vali Loss: 0.4585591 Test Loss: 0.2142520
Validation loss decreased (inf --> 0.458559).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4666294
	speed: 0.0278s/iter; left time: 283.8077s
	iters: 200, epoch: 2 | loss: 0.3476244
	speed: 0.0234s/iter; left time: 236.3720s
	iters: 300, epoch: 2 | loss: 0.4506745
	speed: 0.0214s/iter; left time: 213.8574s
	iters: 400, epoch: 2 | loss: 0.3909674
	speed: 0.0200s/iter; left time: 198.1694s
	iters: 500, epoch: 2 | loss: 0.4682033
	speed: 0.0191s/iter; left time: 187.3407s
	iters: 600, epoch: 2 | loss: 0.4252842
	speed: 0.0189s/iter; left time: 183.4272s
	iters: 700, epoch: 2 | loss: 0.3713781
	speed: 0.0196s/iter; left time: 188.2430s
	iters: 800, epoch: 2 | loss: 0.3323613
	speed: 0.0214s/iter; left time: 203.6109s
	iters: 900, epoch: 2 | loss: 0.8321336
	speed: 0.0232s/iter; left time: 217.6254s
	iters: 1000, epoch: 2 | loss: 0.3659970
	speed: 0.0232s/iter; left time: 215.5505s
	iters: 1100, epoch: 2 | loss: 0.7721268
	speed: 0.0231s/iter; left time: 212.4679s
Epoch: 2 cost time: 26.515041828155518
Epoch: 2, Steps: 1144 | Train Loss: 0.4689252 Vali Loss: 0.4660574 Test Loss: 0.2223826
EarlyStopping counter: 1 out of 5
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4919087
	speed: 0.0361s/iter; left time: 326.5521s
	iters: 200, epoch: 3 | loss: 0.3583818
	speed: 0.0304s/iter; left time: 272.0768s
	iters: 300, epoch: 3 | loss: 0.3236983
	speed: 0.0289s/iter; left time: 255.5509s
	iters: 400, epoch: 3 | loss: 0.3423722
	speed: 0.0293s/iter; left time: 256.2871s
	iters: 500, epoch: 3 | loss: 0.8025413
	speed: 0.0284s/iter; left time: 246.0910s
	iters: 600, epoch: 3 | loss: 0.3817709
	speed: 0.0270s/iter; left time: 230.5765s
	iters: 700, epoch: 3 | loss: 0.3878723
	speed: 0.0261s/iter; left time: 221.0361s
	iters: 800, epoch: 3 | loss: 0.7201311
	speed: 0.0258s/iter; left time: 215.5161s
	iters: 900, epoch: 3 | loss: 0.4751702
	speed: 0.0255s/iter; left time: 210.6089s
	iters: 1000, epoch: 3 | loss: 0.3892576
	speed: 0.0252s/iter; left time: 205.5238s
	iters: 1100, epoch: 3 | loss: 0.3177857
	speed: 0.0251s/iter; left time: 201.9845s
Epoch: 3 cost time: 28.64962911605835
Epoch: 3, Steps: 1144 | Train Loss: 0.4464685 Vali Loss: 0.4560922 Test Loss: 0.2157347
Validation loss decreased (0.458559 --> 0.456092).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8640214
	speed: 0.0388s/iter; left time: 307.0879s
	iters: 200, epoch: 4 | loss: 0.3335967
	speed: 0.0361s/iter; left time: 282.1061s
	iters: 300, epoch: 4 | loss: 0.8082064
	speed: 0.0363s/iter; left time: 280.1942s
	iters: 400, epoch: 4 | loss: 0.3272969
	speed: 0.0332s/iter; left time: 252.4173s
	iters: 500, epoch: 4 | loss: 0.2833654
	speed: 0.0312s/iter; left time: 233.9535s
	iters: 600, epoch: 4 | loss: 1.0290796
	speed: 0.0309s/iter; left time: 228.8185s
	iters: 700, epoch: 4 | loss: 0.3942185
	speed: 0.0293s/iter; left time: 213.8651s
	iters: 800, epoch: 4 | loss: 0.3034350
	speed: 0.0294s/iter; left time: 212.0797s
	iters: 900, epoch: 4 | loss: 0.4966805
	speed: 0.0300s/iter; left time: 213.3288s
	iters: 1000, epoch: 4 | loss: 0.3999783
	speed: 0.0299s/iter; left time: 209.5666s
	iters: 1100, epoch: 4 | loss: 0.2918384
	speed: 0.0292s/iter; left time: 201.5280s
Epoch: 4 cost time: 33.17154574394226
Epoch: 4, Steps: 1144 | Train Loss: 0.4346753 Vali Loss: 0.4630280 Test Loss: 0.2170114
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2708775
	speed: 0.0260s/iter; left time: 175.7948s
	iters: 200, epoch: 5 | loss: 0.3816956
	speed: 0.0270s/iter; left time: 179.8802s
	iters: 300, epoch: 5 | loss: 0.3321769
	speed: 0.0269s/iter; left time: 176.6364s
	iters: 400, epoch: 5 | loss: 0.2728288
	speed: 0.0261s/iter; left time: 168.9236s
	iters: 500, epoch: 5 | loss: 0.8476298
	speed: 0.0256s/iter; left time: 163.0185s
	iters: 600, epoch: 5 | loss: 0.2925049
	speed: 0.0249s/iter; left time: 156.2041s
	iters: 700, epoch: 5 | loss: 0.4720607
	speed: 0.0241s/iter; left time: 148.8098s
	iters: 800, epoch: 5 | loss: 0.3413382
	speed: 0.0237s/iter; left time: 143.6924s
	iters: 900, epoch: 5 | loss: 0.3249427
	speed: 0.0234s/iter; left time: 139.4966s
	iters: 1000, epoch: 5 | loss: 0.2689007
	speed: 0.0230s/iter; left time: 134.8895s
	iters: 1100, epoch: 5 | loss: 0.9519843
	speed: 0.0232s/iter; left time: 133.5963s
Epoch: 5 cost time: 26.606523752212524
Epoch: 5, Steps: 1144 | Train Loss: 0.4283490 Vali Loss: 0.4597394 Test Loss: 0.2163495
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2964232
	speed: 0.0429s/iter; left time: 241.0373s
	iters: 200, epoch: 6 | loss: 0.3961426
	speed: 0.0405s/iter; left time: 223.8461s
	iters: 300, epoch: 6 | loss: 0.2624632
	speed: 0.0374s/iter; left time: 203.0078s
	iters: 400, epoch: 6 | loss: 0.3339111
	speed: 0.0347s/iter; left time: 184.5021s
	iters: 500, epoch: 6 | loss: 0.2916695
	speed: 0.0318s/iter; left time: 165.9024s
	iters: 600, epoch: 6 | loss: 0.3568039
	speed: 0.0296s/iter; left time: 151.6387s
	iters: 700, epoch: 6 | loss: 0.3336107
	speed: 0.0288s/iter; left time: 144.6627s
	iters: 800, epoch: 6 | loss: 0.5081266
	speed: 0.0277s/iter; left time: 136.3926s
	iters: 900, epoch: 6 | loss: 0.3499172
	speed: 0.0269s/iter; left time: 129.8148s
	iters: 1000, epoch: 6 | loss: 0.3288895
	speed: 0.0260s/iter; left time: 122.8589s
	iters: 1100, epoch: 6 | loss: 0.2727306
	speed: 0.0256s/iter; left time: 118.2361s
Epoch: 6 cost time: 29.343469381332397
Epoch: 6, Steps: 1144 | Train Loss: 0.4250320 Vali Loss: 0.4621975 Test Loss: 0.2156140
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.7800324
	speed: 0.0427s/iter; left time: 191.1694s
	iters: 200, epoch: 7 | loss: 0.3074227
	speed: 0.0375s/iter; left time: 164.2012s
	iters: 300, epoch: 7 | loss: 0.3406716
	speed: 0.0326s/iter; left time: 139.4517s
	iters: 400, epoch: 7 | loss: 0.4061068
	speed: 0.0303s/iter; left time: 126.5237s
	iters: 500, epoch: 7 | loss: 0.3601055
	speed: 0.0286s/iter; left time: 116.6713s
	iters: 600, epoch: 7 | loss: 0.3426194
	speed: 0.0270s/iter; left time: 107.2332s
	iters: 700, epoch: 7 | loss: 0.3441397
	speed: 0.0259s/iter; left time: 100.5255s
	iters: 800, epoch: 7 | loss: 0.3089261
	speed: 0.0255s/iter; left time: 96.1811s
	iters: 900, epoch: 7 | loss: 0.4157685
	speed: 0.0256s/iter; left time: 94.1065s
	iters: 1000, epoch: 7 | loss: 0.4535866
	speed: 0.0253s/iter; left time: 90.5065s
	iters: 1100, epoch: 7 | loss: 0.2972547
	speed: 0.0248s/iter; left time: 86.2557s
Epoch: 7 cost time: 28.203048706054688
Epoch: 7, Steps: 1144 | Train Loss: 0.4234537 Vali Loss: 0.4636889 Test Loss: 0.2172981
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3290368
	speed: 0.0465s/iter; left time: 154.8864s
	iters: 200, epoch: 8 | loss: 0.4249080
	speed: 0.0431s/iter; left time: 139.2848s
	iters: 300, epoch: 8 | loss: 0.4577585
	speed: 0.0377s/iter; left time: 118.0957s
	iters: 400, epoch: 8 | loss: 0.3794290
	speed: 0.0341s/iter; left time: 103.2738s
	iters: 500, epoch: 8 | loss: 0.2474171
	speed: 0.0317s/iter; left time: 92.8343s
	iters: 600, epoch: 8 | loss: 0.3117253
	speed: 0.0300s/iter; left time: 85.0283s
	iters: 700, epoch: 8 | loss: 0.3722107
	speed: 0.0285s/iter; left time: 77.9383s
	iters: 800, epoch: 8 | loss: 0.3211352
	speed: 0.0276s/iter; left time: 72.7272s
	iters: 900, epoch: 8 | loss: 0.3732934
	speed: 0.0271s/iter; left time: 68.5196s
	iters: 1000, epoch: 8 | loss: 0.2916466
	speed: 0.0266s/iter; left time: 64.6547s
	iters: 1100, epoch: 8 | loss: 0.2874877
	speed: 0.0262s/iter; left time: 61.0608s
Epoch: 8 cost time: 30.092957496643066
Epoch: 8, Steps: 1144 | Train Loss: 0.4224722 Vali Loss: 0.4617018 Test Loss: 0.2166871
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.21573467552661896, mae:0.2752703130245209
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.5765001
	speed: 0.0266s/iter; left time: 301.9866s
	iters: 200, epoch: 1 | loss: 0.4446262
	speed: 0.0253s/iter; left time: 284.7215s
	iters: 300, epoch: 1 | loss: 0.9295943
	speed: 0.0252s/iter; left time: 280.7029s
	iters: 400, epoch: 1 | loss: 0.3870080
	speed: 0.0244s/iter; left time: 269.3290s
	iters: 500, epoch: 1 | loss: 0.3862770
	speed: 0.0243s/iter; left time: 265.4772s
	iters: 600, epoch: 1 | loss: 0.4094077
	speed: 0.0242s/iter; left time: 262.4319s
	iters: 700, epoch: 1 | loss: 1.0633233
	speed: 0.0243s/iter; left time: 261.5062s
	iters: 800, epoch: 1 | loss: 0.4461557
	speed: 0.0242s/iter; left time: 257.1516s
	iters: 900, epoch: 1 | loss: 0.4259002
	speed: 0.0240s/iter; left time: 253.1417s
	iters: 1000, epoch: 1 | loss: 0.3679363
	speed: 0.0240s/iter; left time: 250.2237s
	iters: 1100, epoch: 1 | loss: 0.3393863
	speed: 0.0240s/iter; left time: 248.4249s
Epoch: 1 cost time: 27.634447813034058
Epoch: 1, Steps: 1144 | Train Loss: 0.5079556 Vali Loss: 0.4703622 Test Loss: 0.2222181
Validation loss decreased (inf --> 0.470362).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5217317
	speed: 0.0302s/iter; left time: 307.6851s
	iters: 200, epoch: 2 | loss: 0.3598603
	speed: 0.0274s/iter; left time: 276.5727s
	iters: 300, epoch: 2 | loss: 0.3325722
	speed: 0.0264s/iter; left time: 264.0642s
	iters: 400, epoch: 2 | loss: 0.3200476
	speed: 0.0260s/iter; left time: 256.9395s
	iters: 500, epoch: 2 | loss: 0.3461722
	speed: 0.0256s/iter; left time: 251.1814s
	iters: 600, epoch: 2 | loss: 0.3300509
	speed: 0.0252s/iter; left time: 244.7685s
	iters: 700, epoch: 2 | loss: 0.8140209
	speed: 0.0242s/iter; left time: 231.8486s
	iters: 800, epoch: 2 | loss: 0.3455823
	speed: 0.0232s/iter; left time: 219.8722s
	iters: 900, epoch: 2 | loss: 0.3747470
	speed: 0.0221s/iter; left time: 207.6240s
	iters: 1000, epoch: 2 | loss: 0.4509364
	speed: 0.0213s/iter; left time: 197.6285s
	iters: 1100, epoch: 2 | loss: 0.7842826
	speed: 0.0205s/iter; left time: 188.2423s
Epoch: 2 cost time: 23.48808193206787
Epoch: 2, Steps: 1144 | Train Loss: 0.4678340 Vali Loss: 0.4582617 Test Loss: 0.2141660
Validation loss decreased (0.470362 --> 0.458262).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3516625
	speed: 0.0361s/iter; left time: 326.6281s
	iters: 200, epoch: 3 | loss: 0.3981963
	speed: 0.0325s/iter; left time: 291.0879s
	iters: 300, epoch: 3 | loss: 0.3263149
	speed: 0.0344s/iter; left time: 304.4211s
	iters: 400, epoch: 3 | loss: 0.4386582
	speed: 0.0351s/iter; left time: 307.1891s
	iters: 500, epoch: 3 | loss: 0.2780383
	speed: 0.0358s/iter; left time: 309.4734s
	iters: 600, epoch: 3 | loss: 0.5994807
	speed: 0.0357s/iter; left time: 305.4365s
	iters: 700, epoch: 3 | loss: 0.4726561
	speed: 0.0344s/iter; left time: 290.9526s
	iters: 800, epoch: 3 | loss: 0.4663984
	speed: 0.0340s/iter; left time: 284.3980s
	iters: 900, epoch: 3 | loss: 0.3350672
	speed: 0.0324s/iter; left time: 267.1012s
	iters: 1000, epoch: 3 | loss: 0.8248627
	speed: 0.0313s/iter; left time: 254.9060s
	iters: 1100, epoch: 3 | loss: 0.3041106
	speed: 0.0302s/iter; left time: 243.3080s
Epoch: 3 cost time: 34.23296880722046
Epoch: 3, Steps: 1144 | Train Loss: 0.4456955 Vali Loss: 0.4663046 Test Loss: 0.2231854
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3225721
	speed: 0.0275s/iter; left time: 217.3568s
	iters: 200, epoch: 4 | loss: 0.3290200
	speed: 0.0252s/iter; left time: 196.5867s
	iters: 300, epoch: 4 | loss: 0.3170852
	speed: 0.0241s/iter; left time: 185.9335s
	iters: 400, epoch: 4 | loss: 0.4001136
	speed: 0.0236s/iter; left time: 179.2427s
	iters: 500, epoch: 4 | loss: 0.3148959
	speed: 0.0240s/iter; left time: 180.2780s
	iters: 600, epoch: 4 | loss: 0.3679002
	speed: 0.0237s/iter; left time: 175.8953s
	iters: 700, epoch: 4 | loss: 0.3642792
	speed: 0.0231s/iter; left time: 168.5079s
	iters: 800, epoch: 4 | loss: 0.3139914
	speed: 0.0233s/iter; left time: 168.1769s
	iters: 900, epoch: 4 | loss: 0.3782564
	speed: 0.0240s/iter; left time: 170.7697s
	iters: 1000, epoch: 4 | loss: 0.3428776
	speed: 0.0248s/iter; left time: 173.9280s
	iters: 1100, epoch: 4 | loss: 0.3425979
	speed: 0.0245s/iter; left time: 169.4826s
Epoch: 4 cost time: 28.05062699317932
Epoch: 4, Steps: 1144 | Train Loss: 0.4339364 Vali Loss: 0.4646934 Test Loss: 0.2205378
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3298157
	speed: 0.0322s/iter; left time: 217.9592s
	iters: 200, epoch: 5 | loss: 0.3357357
	speed: 0.0323s/iter; left time: 215.4171s
	iters: 300, epoch: 5 | loss: 0.4439546
	speed: 0.0326s/iter; left time: 214.2754s
	iters: 400, epoch: 5 | loss: 0.4364826
	speed: 0.0313s/iter; left time: 202.1363s
	iters: 500, epoch: 5 | loss: 0.3444649
	speed: 0.0289s/iter; left time: 184.0757s
	iters: 600, epoch: 5 | loss: 0.7914544
	speed: 0.0269s/iter; left time: 168.8166s
	iters: 700, epoch: 5 | loss: 0.3642235
	speed: 0.0253s/iter; left time: 156.2051s
	iters: 800, epoch: 5 | loss: 0.5274548
	speed: 0.0243s/iter; left time: 147.2746s
	iters: 900, epoch: 5 | loss: 0.3738535
	speed: 0.0236s/iter; left time: 140.7601s
	iters: 1000, epoch: 5 | loss: 0.3666355
	speed: 0.0230s/iter; left time: 135.0550s
	iters: 1100, epoch: 5 | loss: 0.8125314
	speed: 0.0226s/iter; left time: 130.2047s
Epoch: 5 cost time: 25.95169496536255
Epoch: 5, Steps: 1144 | Train Loss: 0.4277553 Vali Loss: 0.4667336 Test Loss: 0.2190159
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4234071
	speed: 0.0322s/iter; left time: 180.7433s
	iters: 200, epoch: 6 | loss: 0.3077693
	speed: 0.0283s/iter; left time: 156.0926s
	iters: 300, epoch: 6 | loss: 0.3566708
	speed: 0.0262s/iter; left time: 142.1870s
	iters: 400, epoch: 6 | loss: 0.3905720
	speed: 0.0252s/iter; left time: 133.9084s
	iters: 500, epoch: 6 | loss: 0.3579696
	speed: 0.0264s/iter; left time: 137.8206s
	iters: 600, epoch: 6 | loss: 0.8321631
	speed: 0.0274s/iter; left time: 140.3746s
	iters: 700, epoch: 6 | loss: 0.6510082
	speed: 0.0267s/iter; left time: 134.1929s
	iters: 800, epoch: 6 | loss: 0.3247528
	speed: 0.0261s/iter; left time: 128.6643s
	iters: 900, epoch: 6 | loss: 0.2519823
	speed: 0.0257s/iter; left time: 123.8251s
	iters: 1000, epoch: 6 | loss: 0.3430572
	speed: 0.0254s/iter; left time: 119.7863s
	iters: 1100, epoch: 6 | loss: 0.2839718
	speed: 0.0251s/iter; left time: 116.0938s
Epoch: 6 cost time: 29.04218101501465
Epoch: 6, Steps: 1144 | Train Loss: 0.4244826 Vali Loss: 0.4643440 Test Loss: 0.2196383
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3219707
	speed: 0.0352s/iter; left time: 157.7887s
	iters: 200, epoch: 7 | loss: 0.2381850
	speed: 0.0303s/iter; left time: 132.8048s
	iters: 300, epoch: 7 | loss: 0.3796423
	speed: 0.0283s/iter; left time: 121.0708s
	iters: 400, epoch: 7 | loss: 0.8707290
	speed: 0.0281s/iter; left time: 117.3755s
	iters: 500, epoch: 7 | loss: 0.2564354
	speed: 0.0271s/iter; left time: 110.3989s
	iters: 600, epoch: 7 | loss: 0.3371222
	speed: 0.0266s/iter; left time: 105.7727s
	iters: 700, epoch: 7 | loss: 0.3358407
	speed: 0.0269s/iter; left time: 104.3859s
	iters: 800, epoch: 7 | loss: 0.3365427
	speed: 0.0265s/iter; left time: 100.1876s
	iters: 900, epoch: 7 | loss: 0.4401374
	speed: 0.0261s/iter; left time: 96.1479s
	iters: 1000, epoch: 7 | loss: 0.3417636
	speed: 0.0257s/iter; left time: 92.0908s
	iters: 1100, epoch: 7 | loss: 0.3274656
	speed: 0.0254s/iter; left time: 88.3006s
Epoch: 7 cost time: 29.02585792541504
Epoch: 7, Steps: 1144 | Train Loss: 0.4230533 Vali Loss: 0.4651427 Test Loss: 0.2198516
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.21416603028774261, mae:0.27012428641319275
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.3160978
	speed: 0.0363s/iter; left time: 411.7924s
	iters: 200, epoch: 1 | loss: 0.3257461
	speed: 0.0346s/iter; left time: 388.7238s
	iters: 300, epoch: 1 | loss: 0.3615821
	speed: 0.0319s/iter; left time: 355.1170s
	iters: 400, epoch: 1 | loss: 0.4302423
	speed: 0.0300s/iter; left time: 331.7546s
	iters: 500, epoch: 1 | loss: 0.4092259
	speed: 0.0283s/iter; left time: 309.9078s
	iters: 600, epoch: 1 | loss: 0.5408553
	speed: 0.0269s/iter; left time: 291.9893s
	iters: 700, epoch: 1 | loss: 0.3470703
	speed: 0.0261s/iter; left time: 280.3042s
	iters: 800, epoch: 1 | loss: 0.7963728
	speed: 0.0250s/iter; left time: 265.9380s
	iters: 900, epoch: 1 | loss: 0.5074397
	speed: 0.0242s/iter; left time: 255.3519s
	iters: 1000, epoch: 1 | loss: 0.3898989
	speed: 0.0236s/iter; left time: 246.2624s
	iters: 1100, epoch: 1 | loss: 0.3200332
	speed: 0.0231s/iter; left time: 239.0180s
Epoch: 1 cost time: 26.03540873527527
Epoch: 1, Steps: 1144 | Train Loss: 0.5079286 Vali Loss: 0.4581905 Test Loss: 0.2218529
Validation loss decreased (inf --> 0.458191).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4415180
	speed: 0.0350s/iter; left time: 357.1960s
	iters: 200, epoch: 2 | loss: 0.3552123
	speed: 0.0300s/iter; left time: 302.5399s
	iters: 300, epoch: 2 | loss: 0.2828695
	speed: 0.0280s/iter; left time: 280.1506s
	iters: 400, epoch: 2 | loss: 0.3314925
	speed: 0.0270s/iter; left time: 267.6885s
	iters: 500, epoch: 2 | loss: 0.2581927
	speed: 0.0265s/iter; left time: 259.4423s
	iters: 600, epoch: 2 | loss: 0.8175688
	speed: 0.0261s/iter; left time: 252.8750s
	iters: 700, epoch: 2 | loss: 0.4241018
	speed: 0.0258s/iter; left time: 247.5809s
	iters: 800, epoch: 2 | loss: 0.8374080
	speed: 0.0262s/iter; left time: 248.8861s
	iters: 900, epoch: 2 | loss: 0.9770899
	speed: 0.0267s/iter; left time: 250.4658s
	iters: 1000, epoch: 2 | loss: 0.3812609
	speed: 0.0264s/iter; left time: 245.4765s
	iters: 1100, epoch: 2 | loss: 0.8645784
	speed: 0.0263s/iter; left time: 241.5178s
Epoch: 2 cost time: 29.871871948242188
Epoch: 2, Steps: 1144 | Train Loss: 0.4677077 Vali Loss: 0.4523637 Test Loss: 0.2137811
Validation loss decreased (0.458191 --> 0.452364).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4621529
	speed: 0.0281s/iter; left time: 254.4414s
	iters: 200, epoch: 3 | loss: 0.4370697
	speed: 0.0256s/iter; left time: 229.3402s
	iters: 300, epoch: 3 | loss: 0.5675582
	speed: 0.0247s/iter; left time: 218.4241s
	iters: 400, epoch: 3 | loss: 0.3763496
	speed: 0.0247s/iter; left time: 216.2404s
	iters: 500, epoch: 3 | loss: 0.2626655
	speed: 0.0251s/iter; left time: 217.6115s
	iters: 600, epoch: 3 | loss: 0.3040390
	speed: 0.0251s/iter; left time: 215.0049s
	iters: 700, epoch: 3 | loss: 0.3582353
	speed: 0.0250s/iter; left time: 211.6312s
	iters: 800, epoch: 3 | loss: 0.3736752
	speed: 0.0249s/iter; left time: 208.2653s
	iters: 900, epoch: 3 | loss: 0.3409109
	speed: 0.0249s/iter; left time: 205.1949s
	iters: 1000, epoch: 3 | loss: 0.3361123
	speed: 0.0247s/iter; left time: 201.1489s
	iters: 1100, epoch: 3 | loss: 0.8894940
	speed: 0.0243s/iter; left time: 195.6924s
Epoch: 3 cost time: 27.650068283081055
Epoch: 3, Steps: 1144 | Train Loss: 0.4448965 Vali Loss: 0.4532099 Test Loss: 0.2143875
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8679992
	speed: 0.0265s/iter; left time: 209.2596s
	iters: 200, epoch: 4 | loss: 0.8369188
	speed: 0.0256s/iter; left time: 200.2365s
	iters: 300, epoch: 4 | loss: 0.3343476
	speed: 0.0273s/iter; left time: 210.1538s
	iters: 400, epoch: 4 | loss: 0.2913718
	speed: 0.0283s/iter; left time: 215.3201s
	iters: 500, epoch: 4 | loss: 0.2969239
	speed: 0.0272s/iter; left time: 203.9495s
	iters: 600, epoch: 4 | loss: 0.3230952
	speed: 0.0262s/iter; left time: 194.2964s
	iters: 700, epoch: 4 | loss: 0.4407137
	speed: 0.0260s/iter; left time: 189.9762s
	iters: 800, epoch: 4 | loss: 0.4103466
	speed: 0.0257s/iter; left time: 185.5307s
	iters: 900, epoch: 4 | loss: 0.3130010
	speed: 0.0261s/iter; left time: 185.3886s
	iters: 1000, epoch: 4 | loss: 0.3173975
	speed: 0.0269s/iter; left time: 188.4809s
	iters: 1100, epoch: 4 | loss: 0.3166629
	speed: 0.0264s/iter; left time: 182.7148s
Epoch: 4 cost time: 30.235645055770874
Epoch: 4, Steps: 1144 | Train Loss: 0.4335096 Vali Loss: 0.4578059 Test Loss: 0.2175992
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3914787
	speed: 0.0168s/iter; left time: 113.5861s
	iters: 200, epoch: 5 | loss: 0.5445013
	speed: 0.0193s/iter; left time: 128.9358s
	iters: 300, epoch: 5 | loss: 0.3336416
	speed: 0.0205s/iter; left time: 134.6287s
	iters: 400, epoch: 5 | loss: 0.4555476
	speed: 0.0209s/iter; left time: 135.0020s
	iters: 500, epoch: 5 | loss: 0.2709961
	speed: 0.0212s/iter; left time: 134.9901s
	iters: 600, epoch: 5 | loss: 0.4145962
	speed: 0.0214s/iter; left time: 134.0065s
	iters: 700, epoch: 5 | loss: 0.4535626
	speed: 0.0215s/iter; left time: 132.3915s
	iters: 800, epoch: 5 | loss: 0.3946287
	speed: 0.0218s/iter; left time: 132.2684s
	iters: 900, epoch: 5 | loss: 0.3041033
	speed: 0.0221s/iter; left time: 131.7445s
	iters: 1000, epoch: 5 | loss: 0.3402921
	speed: 0.0223s/iter; left time: 130.5270s
	iters: 1100, epoch: 5 | loss: 0.3031550
	speed: 0.0224s/iter; left time: 129.2842s
Epoch: 5 cost time: 25.82784128189087
Epoch: 5, Steps: 1144 | Train Loss: 0.4273907 Vali Loss: 0.4619916 Test Loss: 0.2239681
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4228266
	speed: 0.0276s/iter; left time: 155.2575s
	iters: 200, epoch: 6 | loss: 0.3419206
	speed: 0.0240s/iter; left time: 132.3946s
	iters: 300, epoch: 6 | loss: 0.4509189
	speed: 0.0243s/iter; left time: 131.6833s
	iters: 400, epoch: 6 | loss: 0.2863398
	speed: 0.0245s/iter; left time: 130.3202s
	iters: 500, epoch: 6 | loss: 0.3845017
	speed: 0.0245s/iter; left time: 127.9681s
	iters: 600, epoch: 6 | loss: 0.2481598
	speed: 0.0248s/iter; left time: 126.9528s
	iters: 700, epoch: 6 | loss: 0.3613535
	speed: 0.0258s/iter; left time: 129.3978s
	iters: 800, epoch: 6 | loss: 0.3594495
	speed: 0.0253s/iter; left time: 124.4992s
	iters: 900, epoch: 6 | loss: 0.3307543
	speed: 0.0251s/iter; left time: 120.8214s
	iters: 1000, epoch: 6 | loss: 0.3526872
	speed: 0.0260s/iter; left time: 122.6720s
	iters: 1100, epoch: 6 | loss: 0.3148771
	speed: 0.0268s/iter; left time: 124.0018s
Epoch: 6 cost time: 31.201595783233643
Epoch: 6, Steps: 1144 | Train Loss: 0.4244083 Vali Loss: 0.4589253 Test Loss: 0.2184393
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3937160
	speed: 0.0263s/iter; left time: 117.8704s
	iters: 200, epoch: 7 | loss: 0.3208858
	speed: 0.0249s/iter; left time: 109.1137s
	iters: 300, epoch: 7 | loss: 0.2801330
	speed: 0.0245s/iter; left time: 104.7702s
	iters: 400, epoch: 7 | loss: 0.2551081
	speed: 0.0242s/iter; left time: 101.2607s
	iters: 500, epoch: 7 | loss: 0.7825930
	speed: 0.0241s/iter; left time: 98.2938s
	iters: 600, epoch: 7 | loss: 0.3504445
	speed: 0.0240s/iter; left time: 95.5715s
	iters: 700, epoch: 7 | loss: 0.3986623
	speed: 0.0240s/iter; left time: 92.9694s
	iters: 800, epoch: 7 | loss: 0.3321123
	speed: 0.0239s/iter; left time: 90.3029s
	iters: 900, epoch: 7 | loss: 0.2480263
	speed: 0.0247s/iter; left time: 90.6578s
	iters: 1000, epoch: 7 | loss: 0.4204667
	speed: 0.0246s/iter; left time: 88.1505s
	iters: 1100, epoch: 7 | loss: 0.4791301
	speed: 0.0243s/iter; left time: 84.5560s
Epoch: 7 cost time: 27.922553539276123
Epoch: 7, Steps: 1144 | Train Loss: 0.4228177 Vali Loss: 0.4578444 Test Loss: 0.2193154
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.2137811928987503, mae:0.2705831527709961
Seed: 123
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_336      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.6940255
	speed: 0.0566s/iter; left time: 639.1318s
	iters: 200, epoch: 1 | loss: 0.4609813
	speed: 0.0482s/iter; left time: 540.1713s
	iters: 300, epoch: 1 | loss: 0.4922739
	speed: 0.0397s/iter; left time: 440.9180s
	iters: 400, epoch: 1 | loss: 0.3847106
	speed: 0.0347s/iter; left time: 382.2464s
	iters: 500, epoch: 1 | loss: 0.9892122
	speed: 0.0315s/iter; left time: 343.6836s
	iters: 600, epoch: 1 | loss: 0.5265532
	speed: 0.0297s/iter; left time: 320.3835s
	iters: 700, epoch: 1 | loss: 0.4589528
	speed: 0.0284s/iter; left time: 303.9236s
	iters: 800, epoch: 1 | loss: 0.4079607
	speed: 0.0274s/iter; left time: 290.6459s
	iters: 900, epoch: 1 | loss: 0.3876151
	speed: 0.0269s/iter; left time: 282.5139s
	iters: 1000, epoch: 1 | loss: 0.4598133
	speed: 0.0264s/iter; left time: 274.8232s
	iters: 1100, epoch: 1 | loss: 0.4765555
	speed: 0.0260s/iter; left time: 268.0139s
Epoch: 1 cost time: 29.59730339050293
Epoch: 1, Steps: 1140 | Train Loss: 0.5617019 Vali Loss: 0.5306924 Test Loss: 0.2688269
Validation loss decreased (inf --> 0.530692).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4911060
	speed: 0.0360s/iter; left time: 366.2884s
	iters: 200, epoch: 2 | loss: 0.4242603
	speed: 0.0307s/iter; left time: 309.2498s
	iters: 300, epoch: 2 | loss: 0.4176349
	speed: 0.0287s/iter; left time: 285.8502s
	iters: 400, epoch: 2 | loss: 0.4529800
	speed: 0.0277s/iter; left time: 273.5640s
	iters: 500, epoch: 2 | loss: 0.8588431
	speed: 0.0266s/iter; left time: 259.3995s
	iters: 600, epoch: 2 | loss: 0.7872079
	speed: 0.0271s/iter; left time: 261.8231s
	iters: 700, epoch: 2 | loss: 0.3934541
	speed: 0.0271s/iter; left time: 259.5605s
	iters: 800, epoch: 2 | loss: 0.4036092
	speed: 0.0261s/iter; left time: 246.9509s
	iters: 900, epoch: 2 | loss: 0.4147421
	speed: 0.0255s/iter; left time: 239.0629s
	iters: 1000, epoch: 2 | loss: 0.3700762
	speed: 0.0251s/iter; left time: 232.8621s
	iters: 1100, epoch: 2 | loss: 0.7556770
	speed: 0.0248s/iter; left time: 227.3428s
Epoch: 2 cost time: 28.292615175247192
Epoch: 2, Steps: 1140 | Train Loss: 0.5219655 Vali Loss: 0.5479917 Test Loss: 0.2775838
EarlyStopping counter: 1 out of 5
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4708605
	speed: 0.0390s/iter; left time: 351.6822s
	iters: 200, epoch: 3 | loss: 0.3904576
	speed: 0.0384s/iter; left time: 342.5332s
	iters: 300, epoch: 3 | loss: 0.4423932
	speed: 0.0386s/iter; left time: 340.3472s
	iters: 400, epoch: 3 | loss: 0.4764457
	speed: 0.0365s/iter; left time: 318.1640s
	iters: 500, epoch: 3 | loss: 0.4527097
	speed: 0.0330s/iter; left time: 284.5488s
	iters: 600, epoch: 3 | loss: 0.4269946
	speed: 0.0313s/iter; left time: 266.9508s
	iters: 700, epoch: 3 | loss: 0.3602118
	speed: 0.0289s/iter; left time: 243.3363s
	iters: 800, epoch: 3 | loss: 0.4287233
	speed: 0.0268s/iter; left time: 223.0296s
	iters: 900, epoch: 3 | loss: 0.4538881
	speed: 0.0261s/iter; left time: 214.4822s
	iters: 1000, epoch: 3 | loss: 0.3740948
	speed: 0.0256s/iter; left time: 208.1546s
	iters: 1100, epoch: 3 | loss: 0.4200017
	speed: 0.0256s/iter; left time: 205.0302s
Epoch: 3 cost time: 29.245450258255005
Epoch: 3, Steps: 1140 | Train Loss: 0.4968439 Vali Loss: 0.5466322 Test Loss: 0.2741507
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6402926
	speed: 0.0414s/iter; left time: 326.3886s
	iters: 200, epoch: 4 | loss: 0.4238483
	speed: 0.0387s/iter; left time: 300.8059s
	iters: 300, epoch: 4 | loss: 0.4946557
	speed: 0.0368s/iter; left time: 282.7045s
	iters: 400, epoch: 4 | loss: 0.3810451
	speed: 0.0326s/iter; left time: 247.1702s
	iters: 500, epoch: 4 | loss: 0.3796409
	speed: 0.0298s/iter; left time: 223.2213s
	iters: 600, epoch: 4 | loss: 0.3911700
	speed: 0.0286s/iter; left time: 210.8682s
	iters: 700, epoch: 4 | loss: 0.6935437
	speed: 0.0275s/iter; left time: 199.9124s
	iters: 800, epoch: 4 | loss: 0.3264727
	speed: 0.0269s/iter; left time: 192.9592s
	iters: 900, epoch: 4 | loss: 0.6837712
	speed: 0.0260s/iter; left time: 184.2917s
	iters: 1000, epoch: 4 | loss: 0.6967134
	speed: 0.0254s/iter; left time: 177.0874s
	iters: 1100, epoch: 4 | loss: 0.6776584
	speed: 0.0253s/iter; left time: 174.3437s
Epoch: 4 cost time: 28.80959701538086
Epoch: 4, Steps: 1140 | Train Loss: 0.4837850 Vali Loss: 0.5451464 Test Loss: 0.2730585
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.8131246
	speed: 0.0458s/iter; left time: 308.8460s
	iters: 200, epoch: 5 | loss: 0.4931548
	speed: 0.0381s/iter; left time: 253.1779s
	iters: 300, epoch: 5 | loss: 0.4581785
	speed: 0.0327s/iter; left time: 214.0553s
	iters: 400, epoch: 5 | loss: 0.9431396
	speed: 0.0303s/iter; left time: 194.8585s
	iters: 500, epoch: 5 | loss: 0.3978876
	speed: 0.0287s/iter; left time: 181.8590s
	iters: 600, epoch: 5 | loss: 0.3634931
	speed: 0.0272s/iter; left time: 169.9532s
	iters: 700, epoch: 5 | loss: 0.4652578
	speed: 0.0261s/iter; left time: 160.4857s
	iters: 800, epoch: 5 | loss: 0.3742580
	speed: 0.0254s/iter; left time: 153.2408s
	iters: 900, epoch: 5 | loss: 0.6006860
	speed: 0.0255s/iter; left time: 151.2258s
	iters: 1000, epoch: 5 | loss: 0.4121267
	speed: 0.0252s/iter; left time: 147.4419s
	iters: 1100, epoch: 5 | loss: 0.3716729
	speed: 0.0250s/iter; left time: 143.6576s
Epoch: 5 cost time: 28.67621946334839
Epoch: 5, Steps: 1140 | Train Loss: 0.4768935 Vali Loss: 0.5487975 Test Loss: 0.2778784
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3684103
	speed: 0.0360s/iter; left time: 201.6462s
	iters: 200, epoch: 6 | loss: 0.5849083
	speed: 0.0349s/iter; left time: 191.9817s
	iters: 300, epoch: 6 | loss: 0.3236480
	speed: 0.0312s/iter; left time: 168.3817s
	iters: 400, epoch: 6 | loss: 0.4061507
	speed: 0.0284s/iter; left time: 150.3141s
	iters: 500, epoch: 6 | loss: 0.4193967
	speed: 0.0262s/iter; left time: 136.0572s
	iters: 600, epoch: 6 | loss: 0.6467605
	speed: 0.0251s/iter; left time: 128.2232s
	iters: 700, epoch: 6 | loss: 0.6565069
	speed: 0.0235s/iter; left time: 117.5115s
	iters: 800, epoch: 6 | loss: 0.3307118
	speed: 0.0229s/iter; left time: 112.1781s
	iters: 900, epoch: 6 | loss: 0.9317935
	speed: 0.0228s/iter; left time: 109.4518s
	iters: 1000, epoch: 6 | loss: 0.3800232
	speed: 0.0228s/iter; left time: 107.2734s
	iters: 1100, epoch: 6 | loss: 0.3316739
	speed: 0.0230s/iter; left time: 105.7058s
Epoch: 6 cost time: 26.378987550735474
Epoch: 6, Steps: 1140 | Train Loss: 0.4732429 Vali Loss: 0.5504968 Test Loss: 0.2787901
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.26882702112197876, mae:0.3123123347759247
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.5045459
	speed: 0.0290s/iter; left time: 328.0147s
	iters: 200, epoch: 1 | loss: 0.4846637
	speed: 0.0241s/iter; left time: 270.4127s
	iters: 300, epoch: 1 | loss: 0.5072121
	speed: 0.0224s/iter; left time: 248.1331s
	iters: 400, epoch: 1 | loss: 0.4816161
	speed: 0.0207s/iter; left time: 228.1774s
	iters: 500, epoch: 1 | loss: 0.4196034
	speed: 0.0207s/iter; left time: 226.0396s
	iters: 600, epoch: 1 | loss: 0.6244266
	speed: 0.0201s/iter; left time: 217.5749s
	iters: 700, epoch: 1 | loss: 0.7285118
	speed: 0.0207s/iter; left time: 221.3969s
	iters: 800, epoch: 1 | loss: 0.4690894
	speed: 0.0210s/iter; left time: 222.0992s
	iters: 900, epoch: 1 | loss: 0.4630615
	speed: 0.0210s/iter; left time: 220.7648s
	iters: 1000, epoch: 1 | loss: 0.3888642
	speed: 0.0210s/iter; left time: 218.8111s
	iters: 1100, epoch: 1 | loss: 0.8638185
	speed: 0.0221s/iter; left time: 227.5294s
Epoch: 1 cost time: 25.473214149475098
Epoch: 1, Steps: 1140 | Train Loss: 0.5609351 Vali Loss: 0.5324741 Test Loss: 0.2696287
Validation loss decreased (inf --> 0.532474).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5345324
	speed: 0.0326s/iter; left time: 331.3883s
	iters: 200, epoch: 2 | loss: 0.4728129
	speed: 0.0263s/iter; left time: 264.6200s
	iters: 300, epoch: 2 | loss: 0.4199377
	speed: 0.0239s/iter; left time: 238.0686s
	iters: 400, epoch: 2 | loss: 0.5007441
	speed: 0.0234s/iter; left time: 230.6053s
	iters: 500, epoch: 2 | loss: 0.6565706
	speed: 0.0231s/iter; left time: 225.1283s
	iters: 600, epoch: 2 | loss: 0.3325311
	speed: 0.0229s/iter; left time: 221.2813s
	iters: 700, epoch: 2 | loss: 0.4318666
	speed: 0.0230s/iter; left time: 219.9011s
	iters: 800, epoch: 2 | loss: 0.6472254
	speed: 0.0233s/iter; left time: 220.0028s
	iters: 900, epoch: 2 | loss: 0.6481975
	speed: 0.0233s/iter; left time: 218.2151s
	iters: 1000, epoch: 2 | loss: 0.3590069
	speed: 0.0232s/iter; left time: 214.5925s
	iters: 1100, epoch: 2 | loss: 0.7034113
	speed: 0.0234s/iter; left time: 214.1241s
Epoch: 2 cost time: 27.123120546340942
Epoch: 2, Steps: 1140 | Train Loss: 0.5180212 Vali Loss: 0.5372574 Test Loss: 0.2791524
EarlyStopping counter: 1 out of 5
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6773478
	speed: 0.0236s/iter; left time: 212.7898s
	iters: 200, epoch: 3 | loss: 0.7522017
	speed: 0.0201s/iter; left time: 179.6783s
	iters: 300, epoch: 3 | loss: 0.4486232
	speed: 0.0189s/iter; left time: 166.7690s
	iters: 400, epoch: 3 | loss: 0.7182183
	speed: 0.0178s/iter; left time: 155.4127s
	iters: 500, epoch: 3 | loss: 0.3639247
	speed: 0.0176s/iter; left time: 152.0712s
	iters: 600, epoch: 3 | loss: 0.4063470
	speed: 0.0182s/iter; left time: 154.7435s
	iters: 700, epoch: 3 | loss: 0.6688117
	speed: 0.0205s/iter; left time: 172.3295s
	iters: 800, epoch: 3 | loss: 0.4271276
	speed: 0.0209s/iter; left time: 174.0885s
	iters: 900, epoch: 3 | loss: 0.5254478
	speed: 0.0210s/iter; left time: 172.9489s
	iters: 1000, epoch: 3 | loss: 0.4239230
	speed: 0.0211s/iter; left time: 171.4253s
	iters: 1100, epoch: 3 | loss: 0.4446745
	speed: 0.0212s/iter; left time: 170.1541s
Epoch: 3 cost time: 24.364081621170044
Epoch: 3, Steps: 1140 | Train Loss: 0.4921991 Vali Loss: 0.5334017 Test Loss: 0.2793164
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6735528
	speed: 0.0357s/iter; left time: 281.1940s
	iters: 200, epoch: 4 | loss: 1.2846980
	speed: 0.0291s/iter; left time: 226.2959s
	iters: 300, epoch: 4 | loss: 0.3779427
	speed: 0.0268s/iter; left time: 206.2086s
	iters: 400, epoch: 4 | loss: 0.7995315
	speed: 0.0251s/iter; left time: 189.9131s
	iters: 500, epoch: 4 | loss: 0.7628160
	speed: 0.0241s/iter; left time: 180.0953s
	iters: 600, epoch: 4 | loss: 0.3814556
	speed: 0.0234s/iter; left time: 172.7039s
	iters: 700, epoch: 4 | loss: 0.3819143
	speed: 0.0227s/iter; left time: 165.4772s
	iters: 800, epoch: 4 | loss: 0.6367109
	speed: 0.0226s/iter; left time: 162.2268s
	iters: 900, epoch: 4 | loss: 0.3909009
	speed: 0.0227s/iter; left time: 160.7826s
	iters: 1000, epoch: 4 | loss: 0.3237904
	speed: 0.0226s/iter; left time: 157.9815s
	iters: 1100, epoch: 4 | loss: 0.4349261
	speed: 0.0225s/iter; left time: 155.0709s
Epoch: 4 cost time: 25.790319204330444
Epoch: 4, Steps: 1140 | Train Loss: 0.4779934 Vali Loss: 0.5597615 Test Loss: 0.2900633
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3659539
	speed: 0.0422s/iter; left time: 284.4024s
	iters: 200, epoch: 5 | loss: 0.3667280
	speed: 0.0401s/iter; left time: 266.5114s
	iters: 300, epoch: 5 | loss: 0.3823875
	speed: 0.0347s/iter; left time: 226.8720s
	iters: 400, epoch: 5 | loss: 0.6971483
	speed: 0.0309s/iter; left time: 199.1790s
	iters: 500, epoch: 5 | loss: 0.3695800
	speed: 0.0286s/iter; left time: 181.4448s
	iters: 600, epoch: 5 | loss: 0.4340437
	speed: 0.0272s/iter; left time: 169.6309s
	iters: 700, epoch: 5 | loss: 0.3371608
	speed: 0.0264s/iter; left time: 161.9619s
	iters: 800, epoch: 5 | loss: 0.4205197
	speed: 0.0259s/iter; left time: 156.2618s
	iters: 900, epoch: 5 | loss: 0.6138992
	speed: 0.0255s/iter; left time: 151.4496s
	iters: 1000, epoch: 5 | loss: 0.6954697
	speed: 0.0253s/iter; left time: 147.8376s
	iters: 1100, epoch: 5 | loss: 0.6141246
	speed: 0.0250s/iter; left time: 143.4671s
Epoch: 5 cost time: 28.48885154724121
Epoch: 5, Steps: 1140 | Train Loss: 0.4709928 Vali Loss: 0.5499680 Test Loss: 0.2889464
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4697693
	speed: 0.0386s/iter; left time: 215.9769s
	iters: 200, epoch: 6 | loss: 0.8837062
	speed: 0.0349s/iter; left time: 191.7777s
	iters: 300, epoch: 6 | loss: 0.3908216
	speed: 0.0332s/iter; left time: 179.3926s
	iters: 400, epoch: 6 | loss: 0.3882076
	speed: 0.0308s/iter; left time: 163.3405s
	iters: 500, epoch: 6 | loss: 0.3618721
	speed: 0.0278s/iter; left time: 144.4739s
	iters: 600, epoch: 6 | loss: 0.4024399
	speed: 0.0258s/iter; left time: 131.4016s
	iters: 700, epoch: 6 | loss: 0.6417472
	speed: 0.0242s/iter; left time: 120.8020s
	iters: 800, epoch: 6 | loss: 0.3882382
	speed: 0.0227s/iter; left time: 111.1792s
	iters: 900, epoch: 6 | loss: 0.3785993
	speed: 0.0222s/iter; left time: 106.6590s
	iters: 1000, epoch: 6 | loss: 0.3296836
	speed: 0.0220s/iter; left time: 103.3594s
	iters: 1100, epoch: 6 | loss: 0.3665094
	speed: 0.0220s/iter; left time: 101.1049s
Epoch: 6 cost time: 25.15713596343994
Epoch: 6, Steps: 1140 | Train Loss: 0.4671271 Vali Loss: 0.5474184 Test Loss: 0.2877703
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.2696285545825958, mae:0.31051477789878845
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.5193411
	speed: 0.0411s/iter; left time: 464.3625s
	iters: 200, epoch: 1 | loss: 0.6992477
	speed: 0.0323s/iter; left time: 362.2557s
	iters: 300, epoch: 1 | loss: 0.4774224
	speed: 0.0294s/iter; left time: 326.5709s
	iters: 400, epoch: 1 | loss: 0.7035161
	speed: 0.0268s/iter; left time: 295.1985s
	iters: 500, epoch: 1 | loss: 0.4808041
	speed: 0.0254s/iter; left time: 277.2704s
	iters: 600, epoch: 1 | loss: 0.5512392
	speed: 0.0248s/iter; left time: 268.3517s
	iters: 700, epoch: 1 | loss: 0.5314743
	speed: 0.0244s/iter; left time: 261.3977s
	iters: 800, epoch: 1 | loss: 0.5511063
	speed: 0.0249s/iter; left time: 263.7588s
	iters: 900, epoch: 1 | loss: 0.4146457
	speed: 0.0253s/iter; left time: 265.2221s
	iters: 1000, epoch: 1 | loss: 0.4312426
	speed: 0.0249s/iter; left time: 259.1267s
	iters: 1100, epoch: 1 | loss: 0.4972596
	speed: 0.0248s/iter; left time: 255.7480s
Epoch: 1 cost time: 28.616748571395874
Epoch: 1, Steps: 1140 | Train Loss: 0.5632564 Vali Loss: 0.5380661 Test Loss: 0.2725185
Validation loss decreased (inf --> 0.538066).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4550149
	speed: 0.0328s/iter; left time: 333.2819s
	iters: 200, epoch: 2 | loss: 0.4341386
	speed: 0.0276s/iter; left time: 278.0426s
	iters: 300, epoch: 2 | loss: 0.6136456
	speed: 0.0271s/iter; left time: 270.0551s
	iters: 400, epoch: 2 | loss: 0.3809479
	speed: 0.0260s/iter; left time: 256.3711s
	iters: 500, epoch: 2 | loss: 0.5169178
	speed: 0.0257s/iter; left time: 250.8554s
	iters: 600, epoch: 2 | loss: 0.6838936
	speed: 0.0254s/iter; left time: 245.1076s
	iters: 700, epoch: 2 | loss: 0.4218637
	speed: 0.0261s/iter; left time: 249.8937s
	iters: 800, epoch: 2 | loss: 0.4928537
	speed: 0.0258s/iter; left time: 244.1338s
	iters: 900, epoch: 2 | loss: 0.6752552
	speed: 0.0254s/iter; left time: 237.9143s
	iters: 1000, epoch: 2 | loss: 0.5478275
	speed: 0.0251s/iter; left time: 232.6812s
	iters: 1100, epoch: 2 | loss: 0.3468763
	speed: 0.0249s/iter; left time: 228.0942s
Epoch: 2 cost time: 28.458338022232056
Epoch: 2, Steps: 1140 | Train Loss: 0.5201280 Vali Loss: 0.5470450 Test Loss: 0.2774016
EarlyStopping counter: 1 out of 5
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3883216
	speed: 0.0180s/iter; left time: 162.1677s
	iters: 200, epoch: 3 | loss: 0.4128749
	speed: 0.0163s/iter; left time: 145.1642s
	iters: 300, epoch: 3 | loss: 0.3922645
	speed: 0.0158s/iter; left time: 139.3926s
	iters: 400, epoch: 3 | loss: 0.3658633
	speed: 0.0156s/iter; left time: 135.6768s
	iters: 500, epoch: 3 | loss: 0.3704661
	speed: 0.0161s/iter; left time: 138.4538s
	iters: 600, epoch: 3 | loss: 0.3890851
	speed: 0.0175s/iter; left time: 148.7736s
	iters: 700, epoch: 3 | loss: 0.3085876
	speed: 0.0185s/iter; left time: 155.9180s
	iters: 800, epoch: 3 | loss: 0.4160178
	speed: 0.0191s/iter; left time: 158.6719s
	iters: 900, epoch: 3 | loss: 0.9006273
	speed: 0.0194s/iter; left time: 159.2016s
	iters: 1000, epoch: 3 | loss: 0.9843421
	speed: 0.0196s/iter; left time: 159.1568s
	iters: 1100, epoch: 3 | loss: 0.4923292
	speed: 0.0198s/iter; left time: 158.7374s
Epoch: 3 cost time: 22.76249408721924
Epoch: 3, Steps: 1140 | Train Loss: 0.4929028 Vali Loss: 0.5468704 Test Loss: 0.2727751
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4103186
	speed: 0.0372s/iter; left time: 293.1528s
	iters: 200, epoch: 4 | loss: 0.6963587
	speed: 0.0312s/iter; left time: 242.5252s
	iters: 300, epoch: 4 | loss: 0.4064406
	speed: 0.0276s/iter; left time: 212.0075s
	iters: 400, epoch: 4 | loss: 0.3267157
	speed: 0.0257s/iter; left time: 195.0360s
	iters: 500, epoch: 4 | loss: 0.5410756
	speed: 0.0246s/iter; left time: 184.0169s
	iters: 600, epoch: 4 | loss: 0.6388500
	speed: 0.0241s/iter; left time: 177.9009s
	iters: 700, epoch: 4 | loss: 0.3836098
	speed: 0.0242s/iter; left time: 176.4647s
	iters: 800, epoch: 4 | loss: 0.4202283
	speed: 0.0239s/iter; left time: 171.5807s
	iters: 900, epoch: 4 | loss: 0.3940533
	speed: 0.0237s/iter; left time: 167.5929s
	iters: 1000, epoch: 4 | loss: 0.3803475
	speed: 0.0234s/iter; left time: 163.2661s
	iters: 1100, epoch: 4 | loss: 0.3953172
	speed: 0.0231s/iter; left time: 159.2331s
Epoch: 4 cost time: 26.952831983566284
Epoch: 4, Steps: 1140 | Train Loss: 0.4781929 Vali Loss: 0.5582630 Test Loss: 0.2789229
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4048481
	speed: 0.0394s/iter; left time: 265.6085s
	iters: 200, epoch: 5 | loss: 0.4724979
	speed: 0.0324s/iter; left time: 215.1100s
	iters: 300, epoch: 5 | loss: 0.6068705
	speed: 0.0290s/iter; left time: 189.6142s
	iters: 400, epoch: 5 | loss: 0.3671945
	speed: 0.0292s/iter; left time: 187.9097s
	iters: 500, epoch: 5 | loss: 0.3664324
	speed: 0.0277s/iter; left time: 175.6598s
	iters: 600, epoch: 5 | loss: 0.3540903
	speed: 0.0262s/iter; left time: 163.3011s
	iters: 700, epoch: 5 | loss: 0.4540929
	speed: 0.0262s/iter; left time: 161.1876s
	iters: 800, epoch: 5 | loss: 0.3280012
	speed: 0.0268s/iter; left time: 162.0739s
	iters: 900, epoch: 5 | loss: 0.5043518
	speed: 0.0264s/iter; left time: 156.6944s
	iters: 1000, epoch: 5 | loss: 0.6020848
	speed: 0.0260s/iter; left time: 151.8430s
	iters: 1100, epoch: 5 | loss: 0.3784963
	speed: 0.0255s/iter; left time: 146.5147s
Epoch: 5 cost time: 29.38422203063965
Epoch: 5, Steps: 1140 | Train Loss: 0.4713461 Vali Loss: 0.5583133 Test Loss: 0.2806032
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6891647
	speed: 0.0314s/iter; left time: 176.0039s
	iters: 200, epoch: 6 | loss: 0.5163220
	speed: 0.0283s/iter; left time: 155.8512s
	iters: 300, epoch: 6 | loss: 0.3777342
	speed: 0.0273s/iter; left time: 147.5495s
	iters: 400, epoch: 6 | loss: 0.4649391
	speed: 0.0262s/iter; left time: 138.8621s
	iters: 500, epoch: 6 | loss: 0.3773377
	speed: 0.0255s/iter; left time: 132.6710s
	iters: 600, epoch: 6 | loss: 0.3500147
	speed: 0.0245s/iter; left time: 125.1918s
	iters: 700, epoch: 6 | loss: 0.9391989
	speed: 0.0240s/iter; left time: 120.1437s
	iters: 800, epoch: 6 | loss: 0.4095117
	speed: 0.0237s/iter; left time: 116.2674s
	iters: 900, epoch: 6 | loss: 0.3661280
	speed: 0.0235s/iter; left time: 112.6766s
	iters: 1000, epoch: 6 | loss: 0.5015240
	speed: 0.0233s/iter; left time: 109.6495s
	iters: 1100, epoch: 6 | loss: 0.3948110
	speed: 0.0235s/iter; left time: 108.0452s
Epoch: 6 cost time: 26.933443546295166
Epoch: 6, Steps: 1140 | Train Loss: 0.4683904 Vali Loss: 0.5632527 Test Loss: 0.2800270
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.2725185453891754, mae:0.31669843196868896
Seed: 123
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_720      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.5523882
	speed: 0.0383s/iter; left time: 428.3541s
	iters: 200, epoch: 1 | loss: 0.4611990
	speed: 0.0306s/iter; left time: 339.1992s
	iters: 300, epoch: 1 | loss: 0.5917285
	speed: 0.0310s/iter; left time: 340.6854s
	iters: 400, epoch: 1 | loss: 0.5510556
	speed: 0.0312s/iter; left time: 339.1769s
	iters: 500, epoch: 1 | loss: 0.5371180
	speed: 0.0298s/iter; left time: 321.6077s
	iters: 600, epoch: 1 | loss: 0.6085846
	speed: 0.0287s/iter; left time: 307.0529s
	iters: 700, epoch: 1 | loss: 0.6181861
	speed: 0.0279s/iter; left time: 295.3842s
	iters: 800, epoch: 1 | loss: 0.5395775
	speed: 0.0275s/iter; left time: 288.0168s
	iters: 900, epoch: 1 | loss: 0.5716777
	speed: 0.0281s/iter; left time: 292.1439s
	iters: 1000, epoch: 1 | loss: 0.6186748
	speed: 0.0282s/iter; left time: 290.2437s
	iters: 1100, epoch: 1 | loss: 0.5636498
	speed: 0.0278s/iter; left time: 282.7966s
Epoch: 1 cost time: 31.52033758163452
Epoch: 1, Steps: 1128 | Train Loss: 0.6232166 Vali Loss: 0.6431857 Test Loss: 0.3491707
Validation loss decreased (inf --> 0.643186).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6329992
	speed: 0.0268s/iter; left time: 269.2264s
	iters: 200, epoch: 2 | loss: 0.6850309
	speed: 0.0228s/iter; left time: 226.8512s
	iters: 300, epoch: 2 | loss: 0.9001686
	speed: 0.0214s/iter; left time: 210.3619s
	iters: 400, epoch: 2 | loss: 0.5342100
	speed: 0.0209s/iter; left time: 203.4363s
	iters: 500, epoch: 2 | loss: 0.4846603
	speed: 0.0202s/iter; left time: 194.9816s
	iters: 600, epoch: 2 | loss: 0.4050928
	speed: 0.0206s/iter; left time: 196.9286s
	iters: 700, epoch: 2 | loss: 0.4869325
	speed: 0.0203s/iter; left time: 191.8443s
	iters: 800, epoch: 2 | loss: 0.8528204
	speed: 0.0202s/iter; left time: 189.3815s
	iters: 900, epoch: 2 | loss: 0.6216761
	speed: 0.0206s/iter; left time: 190.4403s
	iters: 1000, epoch: 2 | loss: 0.4278785
	speed: 0.0207s/iter; left time: 189.0792s
	iters: 1100, epoch: 2 | loss: 0.6093612
	speed: 0.0210s/iter; left time: 190.1058s
Epoch: 2 cost time: 23.896174669265747
Epoch: 2, Steps: 1128 | Train Loss: 0.5799663 Vali Loss: 0.6515740 Test Loss: 0.3514183
EarlyStopping counter: 1 out of 5
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6216230
	speed: 0.0245s/iter; left time: 218.9334s
	iters: 200, epoch: 3 | loss: 0.4066908
	speed: 0.0218s/iter; left time: 192.6871s
	iters: 300, epoch: 3 | loss: 0.5540121
	speed: 0.0212s/iter; left time: 184.5732s
	iters: 400, epoch: 3 | loss: 0.4426036
	speed: 0.0208s/iter; left time: 179.6612s
	iters: 500, epoch: 3 | loss: 0.4701598
	speed: 0.0206s/iter; left time: 175.8339s
	iters: 600, epoch: 3 | loss: 0.6392139
	speed: 0.0209s/iter; left time: 176.4938s
	iters: 700, epoch: 3 | loss: 0.5774763
	speed: 0.0213s/iter; left time: 177.0241s
	iters: 800, epoch: 3 | loss: 0.6192912
	speed: 0.0217s/iter; left time: 178.1417s
	iters: 900, epoch: 3 | loss: 0.5112707
	speed: 0.0218s/iter; left time: 176.9355s
	iters: 1000, epoch: 3 | loss: 0.4496520
	speed: 0.0219s/iter; left time: 175.7092s
	iters: 1100, epoch: 3 | loss: 0.5215431
	speed: 0.0220s/iter; left time: 174.3379s
Epoch: 3 cost time: 24.98610830307007
Epoch: 3, Steps: 1128 | Train Loss: 0.5503686 Vali Loss: 0.6715685 Test Loss: 0.3693773
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8019560
	speed: 0.0284s/iter; left time: 221.5743s
	iters: 200, epoch: 4 | loss: 0.5108135
	speed: 0.0266s/iter; left time: 205.0805s
	iters: 300, epoch: 4 | loss: 0.5841026
	speed: 0.0250s/iter; left time: 190.0623s
	iters: 400, epoch: 4 | loss: 0.5836291
	speed: 0.0244s/iter; left time: 183.2961s
	iters: 500, epoch: 4 | loss: 0.4717168
	speed: 0.0244s/iter; left time: 180.2024s
	iters: 600, epoch: 4 | loss: 0.5365472
	speed: 0.0243s/iter; left time: 177.0558s
	iters: 700, epoch: 4 | loss: 0.3988639
	speed: 0.0241s/iter; left time: 173.3723s
	iters: 800, epoch: 4 | loss: 0.6254569
	speed: 0.0242s/iter; left time: 171.7070s
	iters: 900, epoch: 4 | loss: 0.5298554
	speed: 0.0243s/iter; left time: 170.0899s
	iters: 1000, epoch: 4 | loss: 0.4940270
	speed: 0.0243s/iter; left time: 167.8492s
	iters: 1100, epoch: 4 | loss: 0.4780317
	speed: 0.0244s/iter; left time: 165.5230s
Epoch: 4 cost time: 27.544127702713013
Epoch: 4, Steps: 1128 | Train Loss: 0.5340282 Vali Loss: 0.6681963 Test Loss: 0.3753027
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4061869
	speed: 0.0333s/iter; left time: 221.7865s
	iters: 200, epoch: 5 | loss: 0.6144758
	speed: 0.0339s/iter; left time: 222.7162s
	iters: 300, epoch: 5 | loss: 0.4868265
	speed: 0.0331s/iter; left time: 214.0689s
	iters: 400, epoch: 5 | loss: 0.5298663
	speed: 0.0315s/iter; left time: 200.6648s
	iters: 500, epoch: 5 | loss: 0.7359840
	speed: 0.0286s/iter; left time: 179.2355s
	iters: 600, epoch: 5 | loss: 0.6997694
	speed: 0.0265s/iter; left time: 163.6132s
	iters: 700, epoch: 5 | loss: 0.5700501
	speed: 0.0254s/iter; left time: 154.1418s
	iters: 800, epoch: 5 | loss: 0.5531692
	speed: 0.0247s/iter; left time: 147.2026s
	iters: 900, epoch: 5 | loss: 0.5346193
	speed: 0.0240s/iter; left time: 140.7921s
	iters: 1000, epoch: 5 | loss: 0.5716867
	speed: 0.0234s/iter; left time: 135.2401s
	iters: 1100, epoch: 5 | loss: 0.4291543
	speed: 0.0235s/iter; left time: 133.4720s
Epoch: 5 cost time: 26.727924823760986
Epoch: 5, Steps: 1128 | Train Loss: 0.5260955 Vali Loss: 0.6843826 Test Loss: 0.3822167
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5435317
	speed: 0.0255s/iter; left time: 141.2710s
	iters: 200, epoch: 6 | loss: 0.5409140
	speed: 0.0238s/iter; left time: 129.3228s
	iters: 300, epoch: 6 | loss: 0.5547618
	speed: 0.0232s/iter; left time: 124.1016s
	iters: 400, epoch: 6 | loss: 0.4987026
	speed: 0.0225s/iter; left time: 117.9454s
	iters: 500, epoch: 6 | loss: 0.4404896
	speed: 0.0225s/iter; left time: 115.6489s
	iters: 600, epoch: 6 | loss: 0.7301582
	speed: 0.0220s/iter; left time: 110.7786s
	iters: 700, epoch: 6 | loss: 0.7562495
	speed: 0.0220s/iter; left time: 108.9128s
	iters: 800, epoch: 6 | loss: 0.4362967
	speed: 0.0232s/iter; left time: 112.1414s
	iters: 900, epoch: 6 | loss: 0.5287169
	speed: 0.0238s/iter; left time: 112.8371s
	iters: 1000, epoch: 6 | loss: 0.4006820
	speed: 0.0239s/iter; left time: 110.7868s
	iters: 1100, epoch: 6 | loss: 0.5243861
	speed: 0.0239s/iter; left time: 108.6685s
Epoch: 6 cost time: 27.15898633003235
Epoch: 6, Steps: 1128 | Train Loss: 0.5224550 Vali Loss: 0.6835806 Test Loss: 0.3859711
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.34917059540748596, mae:0.3845222592353821
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.5367440
	speed: 0.0298s/iter; left time: 333.1855s
	iters: 200, epoch: 1 | loss: 0.5743532
	speed: 0.0262s/iter; left time: 290.6427s
	iters: 300, epoch: 1 | loss: 0.7351159
	speed: 0.0248s/iter; left time: 272.1556s
	iters: 400, epoch: 1 | loss: 0.4710581
	speed: 0.0233s/iter; left time: 253.5476s
	iters: 500, epoch: 1 | loss: 0.4413381
	speed: 0.0226s/iter; left time: 243.1913s
	iters: 600, epoch: 1 | loss: 0.6605605
	speed: 0.0223s/iter; left time: 238.1773s
	iters: 700, epoch: 1 | loss: 0.5138330
	speed: 0.0226s/iter; left time: 239.0861s
	iters: 800, epoch: 1 | loss: 0.6269090
	speed: 0.0229s/iter; left time: 239.7385s
	iters: 900, epoch: 1 | loss: 0.6193873
	speed: 0.0230s/iter; left time: 239.1442s
	iters: 1000, epoch: 1 | loss: 0.8046069
	speed: 0.0232s/iter; left time: 238.4430s
	iters: 1100, epoch: 1 | loss: 0.5739405
	speed: 0.0233s/iter; left time: 237.2746s
Epoch: 1 cost time: 26.609253406524658
Epoch: 1, Steps: 1128 | Train Loss: 0.6230035 Vali Loss: 0.6413601 Test Loss: 0.3476324
Validation loss decreased (inf --> 0.641360).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4895167
	speed: 0.0289s/iter; left time: 290.8596s
	iters: 200, epoch: 2 | loss: 0.7583779
	speed: 0.0267s/iter; left time: 265.5429s
	iters: 300, epoch: 2 | loss: 0.6106094
	speed: 0.0253s/iter; left time: 249.1945s
	iters: 400, epoch: 2 | loss: 0.4979959
	speed: 0.0239s/iter; left time: 233.0587s
	iters: 500, epoch: 2 | loss: 0.5029303
	speed: 0.0217s/iter; left time: 209.5877s
	iters: 600, epoch: 2 | loss: 0.5382002
	speed: 0.0208s/iter; left time: 198.5301s
	iters: 700, epoch: 2 | loss: 0.6144556
	speed: 0.0208s/iter; left time: 196.3243s
	iters: 800, epoch: 2 | loss: 0.4827840
	speed: 0.0203s/iter; left time: 189.7997s
	iters: 900, epoch: 2 | loss: 0.6508408
	speed: 0.0199s/iter; left time: 184.4675s
	iters: 1000, epoch: 2 | loss: 0.6156860
	speed: 0.0199s/iter; left time: 182.2548s
	iters: 1100, epoch: 2 | loss: 0.4728797
	speed: 0.0211s/iter; left time: 190.6367s
Epoch: 2 cost time: 24.170936822891235
Epoch: 2, Steps: 1128 | Train Loss: 0.5771365 Vali Loss: 0.6730204 Test Loss: 0.3711225
EarlyStopping counter: 1 out of 5
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7057297
	speed: 0.0366s/iter; left time: 326.9071s
	iters: 200, epoch: 3 | loss: 0.4740407
	speed: 0.0356s/iter; left time: 314.0414s
	iters: 300, epoch: 3 | loss: 0.4872725
	speed: 0.0317s/iter; left time: 276.6249s
	iters: 400, epoch: 3 | loss: 0.4161234
	speed: 0.0295s/iter; left time: 254.2382s
	iters: 500, epoch: 3 | loss: 0.5095049
	speed: 0.0282s/iter; left time: 240.2127s
	iters: 600, epoch: 3 | loss: 0.4382320
	speed: 0.0275s/iter; left time: 231.8976s
	iters: 700, epoch: 3 | loss: 0.5425801
	speed: 0.0269s/iter; left time: 224.0954s
	iters: 800, epoch: 3 | loss: 0.4126791
	speed: 0.0262s/iter; left time: 215.3332s
	iters: 900, epoch: 3 | loss: 0.5884373
	speed: 0.0258s/iter; left time: 209.3867s
	iters: 1000, epoch: 3 | loss: 0.7818280
	speed: 0.0254s/iter; left time: 204.0621s
	iters: 1100, epoch: 3 | loss: 0.5488729
	speed: 0.0251s/iter; left time: 199.1276s
Epoch: 3 cost time: 28.412989139556885
Epoch: 3, Steps: 1128 | Train Loss: 0.5459815 Vali Loss: 0.6734268 Test Loss: 0.3781312
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4973297
	speed: 0.0415s/iter; left time: 323.8221s
	iters: 200, epoch: 4 | loss: 0.6140855
	speed: 0.0361s/iter; left time: 277.7365s
	iters: 300, epoch: 4 | loss: 0.5867826
	speed: 0.0333s/iter; left time: 253.1224s
	iters: 400, epoch: 4 | loss: 0.3925843
	speed: 0.0308s/iter; left time: 230.8467s
	iters: 500, epoch: 4 | loss: 0.4459403
	speed: 0.0291s/iter; left time: 215.4896s
	iters: 600, epoch: 4 | loss: 0.8283288
	speed: 0.0281s/iter; left time: 205.3613s
	iters: 700, epoch: 4 | loss: 0.6544226
	speed: 0.0273s/iter; left time: 196.6352s
	iters: 800, epoch: 4 | loss: 0.6965511
	speed: 0.0281s/iter; left time: 199.4227s
	iters: 900, epoch: 4 | loss: 0.5656892
	speed: 0.0285s/iter; left time: 199.7343s
	iters: 1000, epoch: 4 | loss: 0.4441782
	speed: 0.0280s/iter; left time: 193.4328s
	iters: 1100, epoch: 4 | loss: 0.6475112
	speed: 0.0276s/iter; left time: 187.7559s
Epoch: 4 cost time: 31.16229009628296
Epoch: 4, Steps: 1128 | Train Loss: 0.5301897 Vali Loss: 0.6893882 Test Loss: 0.3943634
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4882222
	speed: 0.0361s/iter; left time: 240.6323s
	iters: 200, epoch: 5 | loss: 0.4818937
	speed: 0.0330s/iter; left time: 216.4809s
	iters: 300, epoch: 5 | loss: 0.4274221
	speed: 0.0289s/iter; left time: 187.1044s
	iters: 400, epoch: 5 | loss: 0.4038592
	speed: 0.0261s/iter; left time: 166.2224s
	iters: 500, epoch: 5 | loss: 0.4729781
	speed: 0.0245s/iter; left time: 153.8579s
	iters: 600, epoch: 5 | loss: 0.5399500
	speed: 0.0234s/iter; left time: 144.5882s
	iters: 700, epoch: 5 | loss: 0.3924901
	speed: 0.0224s/iter; left time: 135.6987s
	iters: 800, epoch: 5 | loss: 0.5648406
	speed: 0.0216s/iter; left time: 128.7475s
	iters: 900, epoch: 5 | loss: 0.6767753
	speed: 0.0210s/iter; left time: 123.2468s
	iters: 1000, epoch: 5 | loss: 0.4251955
	speed: 0.0206s/iter; left time: 118.7435s
	iters: 1100, epoch: 5 | loss: 0.4848674
	speed: 0.0206s/iter; left time: 116.6680s
Epoch: 5 cost time: 23.37677812576294
Epoch: 5, Steps: 1128 | Train Loss: 0.5224922 Vali Loss: 0.6900313 Test Loss: 0.3954361
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6238295
	speed: 0.0195s/iter; left time: 108.2947s
	iters: 200, epoch: 6 | loss: 0.6428859
	speed: 0.0180s/iter; left time: 97.8284s
	iters: 300, epoch: 6 | loss: 0.7134586
	speed: 0.0171s/iter; left time: 91.5175s
	iters: 400, epoch: 6 | loss: 0.7187921
	speed: 0.0162s/iter; left time: 85.1606s
	iters: 500, epoch: 6 | loss: 0.4336878
	speed: 0.0167s/iter; left time: 85.9353s
	iters: 600, epoch: 6 | loss: 0.5547062
	speed: 0.0167s/iter; left time: 84.0510s
	iters: 700, epoch: 6 | loss: 0.5408601
	speed: 0.0168s/iter; left time: 82.8636s
	iters: 800, epoch: 6 | loss: 0.4468039
	speed: 0.0170s/iter; left time: 82.4226s
	iters: 900, epoch: 6 | loss: 0.5948828
	speed: 0.0171s/iter; left time: 80.8862s
	iters: 1000, epoch: 6 | loss: 0.4621681
	speed: 0.0173s/iter; left time: 80.1485s
	iters: 1100, epoch: 6 | loss: 0.4219590
	speed: 0.0177s/iter; left time: 80.1560s
Epoch: 6 cost time: 20.223745822906494
Epoch: 6, Steps: 1128 | Train Loss: 0.5190372 Vali Loss: 0.7000878 Test Loss: 0.4054306
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.34763234853744507, mae:0.3802362084388733
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.5677533
	speed: 0.0467s/iter; left time: 521.6577s
	iters: 200, epoch: 1 | loss: 0.6170573
	speed: 0.0401s/iter; left time: 444.6312s
	iters: 300, epoch: 1 | loss: 0.5114238
	speed: 0.0326s/iter; left time: 358.0563s
	iters: 400, epoch: 1 | loss: 0.5340352
	speed: 0.0284s/iter; left time: 308.4959s
	iters: 500, epoch: 1 | loss: 0.6431286
	speed: 0.0259s/iter; left time: 278.9501s
	iters: 600, epoch: 1 | loss: 0.6257086
	speed: 0.0248s/iter; left time: 264.5392s
	iters: 700, epoch: 1 | loss: 0.5240225
	speed: 0.0244s/iter; left time: 258.6745s
	iters: 800, epoch: 1 | loss: 0.5477765
	speed: 0.0244s/iter; left time: 255.9184s
	iters: 900, epoch: 1 | loss: 0.8790454
	speed: 0.0244s/iter; left time: 253.1627s
	iters: 1000, epoch: 1 | loss: 0.6753502
	speed: 0.0244s/iter; left time: 250.7838s
	iters: 1100, epoch: 1 | loss: 0.6151202
	speed: 0.0244s/iter; left time: 248.1563s
Epoch: 1 cost time: 27.61900281906128
Epoch: 1, Steps: 1128 | Train Loss: 0.6214354 Vali Loss: 0.6333901 Test Loss: 0.3570291
Validation loss decreased (inf --> 0.633390).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6306645
	speed: 0.0343s/iter; left time: 344.8925s
	iters: 200, epoch: 2 | loss: 0.5016576
	speed: 0.0280s/iter; left time: 279.1168s
	iters: 300, epoch: 2 | loss: 0.4758121
	speed: 0.0258s/iter; left time: 254.6089s
	iters: 400, epoch: 2 | loss: 0.8693861
	speed: 0.0246s/iter; left time: 240.2217s
	iters: 500, epoch: 2 | loss: 0.5052390
	speed: 0.0237s/iter; left time: 229.1687s
	iters: 600, epoch: 2 | loss: 0.4703421
	speed: 0.0241s/iter; left time: 230.3795s
	iters: 700, epoch: 2 | loss: 0.4720872
	speed: 0.0243s/iter; left time: 229.3264s
	iters: 800, epoch: 2 | loss: 0.5194252
	speed: 0.0242s/iter; left time: 225.8974s
	iters: 900, epoch: 2 | loss: 0.6172074
	speed: 0.0246s/iter; left time: 227.4906s
	iters: 1000, epoch: 2 | loss: 0.4528220
	speed: 0.0250s/iter; left time: 228.5349s
	iters: 1100, epoch: 2 | loss: 0.6704026
	speed: 0.0254s/iter; left time: 229.5761s
Epoch: 2 cost time: 28.909435987472534
Epoch: 2, Steps: 1128 | Train Loss: 0.5741916 Vali Loss: 0.6559197 Test Loss: 0.3651324
EarlyStopping counter: 1 out of 5
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5911458
	speed: 0.0195s/iter; left time: 173.9269s
	iters: 200, epoch: 3 | loss: 0.6282594
	speed: 0.0222s/iter; left time: 195.6660s
	iters: 300, epoch: 3 | loss: 0.4405827
	speed: 0.0205s/iter; left time: 178.5062s
	iters: 400, epoch: 3 | loss: 0.3937982
	speed: 0.0199s/iter; left time: 171.9700s
	iters: 500, epoch: 3 | loss: 0.6074200
	speed: 0.0200s/iter; left time: 170.4432s
	iters: 600, epoch: 3 | loss: 0.8172070
	speed: 0.0202s/iter; left time: 170.0730s
	iters: 700, epoch: 3 | loss: 0.4830840
	speed: 0.0208s/iter; left time: 173.4524s
	iters: 800, epoch: 3 | loss: 0.5824702
	speed: 0.0214s/iter; left time: 176.3934s
	iters: 900, epoch: 3 | loss: 0.4307595
	speed: 0.0219s/iter; left time: 177.8805s
	iters: 1000, epoch: 3 | loss: 0.4834272
	speed: 0.0222s/iter; left time: 178.4243s
	iters: 1100, epoch: 3 | loss: 0.4169270
	speed: 0.0225s/iter; left time: 178.4796s
Epoch: 3 cost time: 25.691677570343018
Epoch: 3, Steps: 1128 | Train Loss: 0.5448134 Vali Loss: 0.6790605 Test Loss: 0.3825566
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4951467
	speed: 0.0298s/iter; left time: 232.6664s
	iters: 200, epoch: 4 | loss: 0.6157017
	speed: 0.0252s/iter; left time: 194.2531s
	iters: 300, epoch: 4 | loss: 0.7217230
	speed: 0.0227s/iter; left time: 172.5108s
	iters: 400, epoch: 4 | loss: 0.4693939
	speed: 0.0220s/iter; left time: 164.6649s
	iters: 500, epoch: 4 | loss: 0.5014604
	speed: 0.0224s/iter; left time: 165.6603s
	iters: 600, epoch: 4 | loss: 0.4456197
	speed: 0.0222s/iter; left time: 161.8440s
	iters: 700, epoch: 4 | loss: 0.4645942
	speed: 0.0223s/iter; left time: 160.2007s
	iters: 800, epoch: 4 | loss: 0.4198964
	speed: 0.0222s/iter; left time: 157.7600s
	iters: 900, epoch: 4 | loss: 0.5840282
	speed: 0.0222s/iter; left time: 155.2508s
	iters: 1000, epoch: 4 | loss: 0.6365376
	speed: 0.0222s/iter; left time: 152.8438s
	iters: 1100, epoch: 4 | loss: 0.5995203
	speed: 0.0224s/iter; left time: 152.1170s
Epoch: 4 cost time: 25.383304595947266
Epoch: 4, Steps: 1128 | Train Loss: 0.5294158 Vali Loss: 0.6761456 Test Loss: 0.3992083
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6211741
	speed: 0.0413s/iter; left time: 275.6429s
	iters: 200, epoch: 5 | loss: 0.6240529
	speed: 0.0375s/iter; left time: 246.1199s
	iters: 300, epoch: 5 | loss: 0.4307167
	speed: 0.0327s/iter; left time: 211.4951s
	iters: 400, epoch: 5 | loss: 0.4558046
	speed: 0.0298s/iter; left time: 189.6621s
	iters: 500, epoch: 5 | loss: 0.5923118
	speed: 0.0278s/iter; left time: 174.5610s
	iters: 600, epoch: 5 | loss: 0.3852500
	speed: 0.0264s/iter; left time: 162.7989s
	iters: 700, epoch: 5 | loss: 0.4556559
	speed: 0.0257s/iter; left time: 155.8793s
	iters: 800, epoch: 5 | loss: 0.5851721
	speed: 0.0252s/iter; left time: 150.3285s
	iters: 900, epoch: 5 | loss: 0.4939699
	speed: 0.0252s/iter; left time: 147.6167s
	iters: 1000, epoch: 5 | loss: 0.4789927
	speed: 0.0251s/iter; left time: 144.9983s
	iters: 1100, epoch: 5 | loss: 0.4771086
	speed: 0.0247s/iter; left time: 140.0472s
Epoch: 5 cost time: 27.861433267593384
Epoch: 5, Steps: 1128 | Train Loss: 0.5213264 Vali Loss: 0.6825514 Test Loss: 0.4071440
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.7007101
	speed: 0.0403s/iter; left time: 223.5009s
	iters: 200, epoch: 6 | loss: 0.4002489
	speed: 0.0362s/iter; left time: 197.0273s
	iters: 300, epoch: 6 | loss: 0.4355235
	speed: 0.0318s/iter; left time: 169.7049s
	iters: 400, epoch: 6 | loss: 0.4017582
	speed: 0.0300s/iter; left time: 157.3548s
	iters: 500, epoch: 6 | loss: 0.5428110
	speed: 0.0287s/iter; left time: 147.3529s
	iters: 600, epoch: 6 | loss: 0.4178027
	speed: 0.0275s/iter; left time: 138.3772s
	iters: 700, epoch: 6 | loss: 0.5108433
	speed: 0.0266s/iter; left time: 131.3010s
	iters: 800, epoch: 6 | loss: 0.6144000
	speed: 0.0265s/iter; left time: 128.5271s
	iters: 900, epoch: 6 | loss: 0.4079875
	speed: 0.0273s/iter; left time: 129.6249s
	iters: 1000, epoch: 6 | loss: 0.5181054
	speed: 0.0279s/iter; left time: 129.5485s
	iters: 1100, epoch: 6 | loss: 0.5382864
	speed: 0.0282s/iter; left time: 128.2727s
Epoch: 6 cost time: 31.7724449634552
Epoch: 6, Steps: 1128 | Train Loss: 0.5175802 Vali Loss: 0.6905381 Test Loss: 0.4100940
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_123<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.3570290207862854, mae:0.3812447786331177
Seed: 456
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_96       Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.4239789
	speed: 0.0511s/iter; left time: 580.7221s
	iters: 200, epoch: 1 | loss: 0.4683646
	speed: 0.0422s/iter; left time: 475.2282s
	iters: 300, epoch: 1 | loss: 0.7569968
	speed: 0.0396s/iter; left time: 442.2774s
	iters: 400, epoch: 1 | loss: 0.3774422
	speed: 0.0386s/iter; left time: 427.0414s
	iters: 500, epoch: 1 | loss: 0.2829545
	speed: 0.0359s/iter; left time: 394.1970s
	iters: 600, epoch: 1 | loss: 0.4067634
	speed: 0.0338s/iter; left time: 366.9430s
	iters: 700, epoch: 1 | loss: 0.3899180
	speed: 0.0322s/iter; left time: 346.4477s
	iters: 800, epoch: 1 | loss: 0.2790990
	speed: 0.0310s/iter; left time: 331.1717s
	iters: 900, epoch: 1 | loss: 0.4081191
	speed: 0.0303s/iter; left time: 320.4663s
	iters: 1000, epoch: 1 | loss: 0.2642433
	speed: 0.0292s/iter; left time: 305.9692s
	iters: 1100, epoch: 1 | loss: 1.2239548
	speed: 0.0290s/iter; left time: 301.2623s
Epoch: 1 cost time: 33.14958643913269
Epoch: 1, Steps: 1147 | Train Loss: 0.4552174 Vali Loss: 0.4045364 Test Loss: 0.1723025
Validation loss decreased (inf --> 0.404536).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3071864
	speed: 0.0355s/iter; left time: 363.2665s
	iters: 200, epoch: 2 | loss: 0.5362002
	speed: 0.0333s/iter; left time: 337.5741s
	iters: 300, epoch: 2 | loss: 0.3770514
	speed: 0.0325s/iter; left time: 325.9745s
	iters: 400, epoch: 2 | loss: 0.2936765
	speed: 0.0335s/iter; left time: 332.8600s
	iters: 500, epoch: 2 | loss: 0.2607094
	speed: 0.0334s/iter; left time: 327.7415s
	iters: 600, epoch: 2 | loss: 0.2974936
	speed: 0.0323s/iter; left time: 313.6202s
	iters: 700, epoch: 2 | loss: 0.3209470
	speed: 0.0313s/iter; left time: 301.1826s
	iters: 800, epoch: 2 | loss: 1.2259065
	speed: 0.0300s/iter; left time: 285.3187s
	iters: 900, epoch: 2 | loss: 0.3022016
	speed: 0.0301s/iter; left time: 284.0517s
	iters: 1000, epoch: 2 | loss: 0.2594516
	speed: 0.0296s/iter; left time: 276.2346s
	iters: 1100, epoch: 2 | loss: 0.3068548
	speed: 0.0291s/iter; left time: 268.4980s
Epoch: 2 cost time: 33.2744300365448
Epoch: 2, Steps: 1147 | Train Loss: 0.4095764 Vali Loss: 0.4034759 Test Loss: 0.1761898
Validation loss decreased (0.404536 --> 0.403476).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2993683
	speed: 0.0377s/iter; left time: 342.2592s
	iters: 200, epoch: 3 | loss: 0.2188206
	speed: 0.0315s/iter; left time: 282.3697s
	iters: 300, epoch: 3 | loss: 0.3401784
	speed: 0.0284s/iter; left time: 251.8013s
	iters: 400, epoch: 3 | loss: 0.2655022
	speed: 0.0267s/iter; left time: 234.7226s
	iters: 500, epoch: 3 | loss: 0.2975010
	speed: 0.0256s/iter; left time: 222.0005s
	iters: 600, epoch: 3 | loss: 0.4385188
	speed: 0.0250s/iter; left time: 214.0789s
	iters: 700, epoch: 3 | loss: 0.2386839
	speed: 0.0245s/iter; left time: 207.9610s
	iters: 800, epoch: 3 | loss: 1.1245562
	speed: 0.0242s/iter; left time: 202.7147s
	iters: 900, epoch: 3 | loss: 0.3177425
	speed: 0.0237s/iter; left time: 195.7899s
	iters: 1000, epoch: 3 | loss: 0.2282448
	speed: 0.0233s/iter; left time: 190.6197s
	iters: 1100, epoch: 3 | loss: 0.3766679
	speed: 0.0230s/iter; left time: 185.8822s
Epoch: 3 cost time: 26.268659830093384
Epoch: 3, Steps: 1147 | Train Loss: 0.3873580 Vali Loss: 0.4087929 Test Loss: 0.1750216
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 1.0242530
	speed: 0.0383s/iter; left time: 304.1037s
	iters: 200, epoch: 4 | loss: 0.4672988
	speed: 0.0365s/iter; left time: 285.6306s
	iters: 300, epoch: 4 | loss: 1.1916969
	speed: 0.0343s/iter; left time: 265.4911s
	iters: 400, epoch: 4 | loss: 0.4497535
	speed: 0.0322s/iter; left time: 245.3754s
	iters: 500, epoch: 4 | loss: 0.4493106
	speed: 0.0307s/iter; left time: 231.3077s
	iters: 600, epoch: 4 | loss: 1.2518424
	speed: 0.0296s/iter; left time: 219.5639s
	iters: 700, epoch: 4 | loss: 0.2771203
	speed: 0.0282s/iter; left time: 206.4324s
	iters: 800, epoch: 4 | loss: 0.2269206
	speed: 0.0270s/iter; left time: 195.5637s
	iters: 900, epoch: 4 | loss: 0.2383753
	speed: 0.0270s/iter; left time: 192.5983s
	iters: 1000, epoch: 4 | loss: 0.2932903
	speed: 0.0258s/iter; left time: 181.4103s
	iters: 1100, epoch: 4 | loss: 0.2585170
	speed: 0.0250s/iter; left time: 173.1450s
Epoch: 4 cost time: 28.53218150138855
Epoch: 4, Steps: 1147 | Train Loss: 0.3756629 Vali Loss: 0.4057961 Test Loss: 0.1733975
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3809548
	speed: 0.0235s/iter; left time: 159.1207s
	iters: 200, epoch: 5 | loss: 0.2838611
	speed: 0.0267s/iter; left time: 178.6004s
	iters: 300, epoch: 5 | loss: 0.3330633
	speed: 0.0291s/iter; left time: 191.7741s
	iters: 400, epoch: 5 | loss: 0.2218005
	speed: 0.0304s/iter; left time: 197.2447s
	iters: 500, epoch: 5 | loss: 0.2891761
	speed: 0.0302s/iter; left time: 192.6090s
	iters: 600, epoch: 5 | loss: 0.2355298
	speed: 0.0289s/iter; left time: 181.4683s
	iters: 700, epoch: 5 | loss: 0.2171098
	speed: 0.0287s/iter; left time: 177.4396s
	iters: 800, epoch: 5 | loss: 0.2835375
	speed: 0.0281s/iter; left time: 170.8388s
	iters: 900, epoch: 5 | loss: 0.2499405
	speed: 0.0273s/iter; left time: 163.2108s
	iters: 1000, epoch: 5 | loss: 0.3058515
	speed: 0.0270s/iter; left time: 159.0300s
	iters: 1100, epoch: 5 | loss: 0.2090473
	speed: 0.0274s/iter; left time: 158.4175s
Epoch: 5 cost time: 31.53648090362549
Epoch: 5, Steps: 1147 | Train Loss: 0.3698617 Vali Loss: 0.4038083 Test Loss: 0.1698547
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 1.2075953
	speed: 0.0372s/iter; left time: 209.7802s
	iters: 200, epoch: 6 | loss: 0.2111067
	speed: 0.0300s/iter; left time: 166.2370s
	iters: 300, epoch: 6 | loss: 0.2515678
	speed: 0.0267s/iter; left time: 145.2529s
	iters: 400, epoch: 6 | loss: 0.2480676
	speed: 0.0249s/iter; left time: 132.6060s
	iters: 500, epoch: 6 | loss: 0.4192718
	speed: 0.0259s/iter; left time: 135.6203s
	iters: 600, epoch: 6 | loss: 0.3635903
	speed: 0.0254s/iter; left time: 130.3265s
	iters: 700, epoch: 6 | loss: 0.4580294
	speed: 0.0250s/iter; left time: 125.9334s
	iters: 800, epoch: 6 | loss: 0.3046453
	speed: 0.0247s/iter; left time: 121.9745s
	iters: 900, epoch: 6 | loss: 0.2831903
	speed: 0.0254s/iter; left time: 122.6955s
	iters: 1000, epoch: 6 | loss: 0.2413919
	speed: 0.0254s/iter; left time: 120.1656s
	iters: 1100, epoch: 6 | loss: 0.4472098
	speed: 0.0250s/iter; left time: 116.0080s
Epoch: 6 cost time: 28.731786251068115
Epoch: 6, Steps: 1147 | Train Loss: 0.3667930 Vali Loss: 0.4058828 Test Loss: 0.1725877
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2546730
	speed: 0.0390s/iter; left time: 175.2756s
	iters: 200, epoch: 7 | loss: 0.2936495
	speed: 0.0321s/iter; left time: 141.0350s
	iters: 300, epoch: 7 | loss: 0.3399812
	speed: 0.0289s/iter; left time: 123.9882s
	iters: 400, epoch: 7 | loss: 0.2160577
	speed: 0.0267s/iter; left time: 112.0521s
	iters: 500, epoch: 7 | loss: 0.3106657
	speed: 0.0263s/iter; left time: 107.4368s
	iters: 600, epoch: 7 | loss: 0.2688874
	speed: 0.0255s/iter; left time: 101.5997s
	iters: 700, epoch: 7 | loss: 0.2814804
	speed: 0.0250s/iter; left time: 97.0440s
	iters: 800, epoch: 7 | loss: 0.4806422
	speed: 0.0257s/iter; left time: 97.4162s
	iters: 900, epoch: 7 | loss: 0.2283611
	speed: 0.0249s/iter; left time: 91.8222s
	iters: 1000, epoch: 7 | loss: 0.2279035
	speed: 0.0249s/iter; left time: 89.5297s
	iters: 1100, epoch: 7 | loss: 0.2828561
	speed: 0.0248s/iter; left time: 86.4511s
Epoch: 7 cost time: 28.743209838867188
Epoch: 7, Steps: 1147 | Train Loss: 0.3649193 Vali Loss: 0.4060178 Test Loss: 0.1720465
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.17618976533412933, mae:0.23911979794502258
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.4855038
	speed: 0.0363s/iter; left time: 413.1923s
	iters: 200, epoch: 1 | loss: 0.3527194
	speed: 0.0293s/iter; left time: 330.8010s
	iters: 300, epoch: 1 | loss: 0.5071052
	speed: 0.0271s/iter; left time: 302.4874s
	iters: 400, epoch: 1 | loss: 0.4687661
	speed: 0.0261s/iter; left time: 288.7456s
	iters: 500, epoch: 1 | loss: 0.4609169
	speed: 0.0254s/iter; left time: 278.1498s
	iters: 600, epoch: 1 | loss: 0.3050206
	speed: 0.0246s/iter; left time: 267.5257s
	iters: 700, epoch: 1 | loss: 0.2623249
	speed: 0.0241s/iter; left time: 259.8556s
	iters: 800, epoch: 1 | loss: 1.2438753
	speed: 0.0238s/iter; left time: 254.2323s
	iters: 900, epoch: 1 | loss: 0.4264157
	speed: 0.0250s/iter; left time: 264.0721s
	iters: 1000, epoch: 1 | loss: 0.3077485
	speed: 0.0260s/iter; left time: 272.7374s
	iters: 1100, epoch: 1 | loss: 0.4262620
	speed: 0.0268s/iter; left time: 278.1209s
Epoch: 1 cost time: 31.272096395492554
Epoch: 1, Steps: 1147 | Train Loss: 0.4541598 Vali Loss: 0.4047391 Test Loss: 0.1794060
Validation loss decreased (inf --> 0.404739).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3115495
	speed: 0.0288s/iter; left time: 294.0119s
	iters: 200, epoch: 2 | loss: 0.4045084
	speed: 0.0256s/iter; left time: 259.1959s
	iters: 300, epoch: 2 | loss: 0.2599368
	speed: 0.0245s/iter; left time: 245.5417s
	iters: 400, epoch: 2 | loss: 0.2875002
	speed: 0.0240s/iter; left time: 238.4551s
	iters: 500, epoch: 2 | loss: 0.2427332
	speed: 0.0236s/iter; left time: 232.1729s
	iters: 600, epoch: 2 | loss: 0.2739670
	speed: 0.0233s/iter; left time: 226.3860s
	iters: 700, epoch: 2 | loss: 0.2961964
	speed: 0.0231s/iter; left time: 221.8609s
	iters: 800, epoch: 2 | loss: 0.3247750
	speed: 0.0229s/iter; left time: 217.8225s
	iters: 900, epoch: 2 | loss: 0.2710542
	speed: 0.0227s/iter; left time: 214.2138s
	iters: 1000, epoch: 2 | loss: 0.3920525
	speed: 0.0229s/iter; left time: 213.2800s
	iters: 1100, epoch: 2 | loss: 0.2757403
	speed: 0.0230s/iter; left time: 212.1360s
Epoch: 2 cost time: 26.4404239654541
Epoch: 2, Steps: 1147 | Train Loss: 0.4104770 Vali Loss: 0.3950616 Test Loss: 0.1701545
Validation loss decreased (0.404739 --> 0.395062).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3277563
	speed: 0.0289s/iter; left time: 262.1271s
	iters: 200, epoch: 3 | loss: 0.2430299
	speed: 0.0233s/iter; left time: 209.3484s
	iters: 300, epoch: 3 | loss: 0.2951044
	speed: 0.0217s/iter; left time: 192.2514s
	iters: 400, epoch: 3 | loss: 0.2564174
	speed: 0.0204s/iter; left time: 178.6773s
	iters: 500, epoch: 3 | loss: 0.2678693
	speed: 0.0196s/iter; left time: 170.2634s
	iters: 600, epoch: 3 | loss: 0.2894582
	speed: 0.0190s/iter; left time: 162.9088s
	iters: 700, epoch: 3 | loss: 0.4505919
	speed: 0.0197s/iter; left time: 167.3387s
	iters: 800, epoch: 3 | loss: 0.1853936
	speed: 0.0195s/iter; left time: 163.2022s
	iters: 900, epoch: 3 | loss: 0.3250878
	speed: 0.0192s/iter; left time: 158.5745s
	iters: 1000, epoch: 3 | loss: 0.3691041
	speed: 0.0189s/iter; left time: 154.5781s
	iters: 1100, epoch: 3 | loss: 0.4540744
	speed: 0.0186s/iter; left time: 150.4439s
Epoch: 3 cost time: 21.41866111755371
Epoch: 3, Steps: 1147 | Train Loss: 0.3880703 Vali Loss: 0.3964187 Test Loss: 0.1679013
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2564543
	speed: 0.0269s/iter; left time: 212.9541s
	iters: 200, epoch: 4 | loss: 0.2262360
	speed: 0.0300s/iter; left time: 234.9106s
	iters: 300, epoch: 4 | loss: 0.2036507
	speed: 0.0292s/iter; left time: 225.4709s
	iters: 400, epoch: 4 | loss: 0.3220627
	speed: 0.0270s/iter; left time: 205.9218s
	iters: 500, epoch: 4 | loss: 0.2819388
	speed: 0.0257s/iter; left time: 193.4572s
	iters: 600, epoch: 4 | loss: 0.3793591
	speed: 0.0251s/iter; left time: 186.3340s
	iters: 700, epoch: 4 | loss: 0.1866990
	speed: 0.0252s/iter; left time: 184.4308s
	iters: 800, epoch: 4 | loss: 0.2176247
	speed: 0.0248s/iter; left time: 179.2151s
	iters: 900, epoch: 4 | loss: 0.2921535
	speed: 0.0244s/iter; left time: 174.0782s
	iters: 1000, epoch: 4 | loss: 0.2237647
	speed: 0.0242s/iter; left time: 170.1055s
	iters: 1100, epoch: 4 | loss: 0.2284764
	speed: 0.0245s/iter; left time: 169.5667s
Epoch: 4 cost time: 28.20432710647583
Epoch: 4, Steps: 1147 | Train Loss: 0.3765040 Vali Loss: 0.3996307 Test Loss: 0.1691981
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2636937
	speed: 0.0403s/iter; left time: 273.3231s
	iters: 200, epoch: 5 | loss: 0.2163087
	speed: 0.0356s/iter; left time: 238.2329s
	iters: 300, epoch: 5 | loss: 0.2648098
	speed: 0.0321s/iter; left time: 211.3685s
	iters: 400, epoch: 5 | loss: 0.4020528
	speed: 0.0292s/iter; left time: 188.9877s
	iters: 500, epoch: 5 | loss: 0.2518967
	speed: 0.0277s/iter; left time: 176.9971s
	iters: 600, epoch: 5 | loss: 0.3054008
	speed: 0.0268s/iter; left time: 168.3267s
	iters: 700, epoch: 5 | loss: 0.3462227
	speed: 0.0262s/iter; left time: 161.8231s
	iters: 800, epoch: 5 | loss: 0.6133031
	speed: 0.0257s/iter; left time: 156.3206s
	iters: 900, epoch: 5 | loss: 0.4079435
	speed: 0.0254s/iter; left time: 151.8275s
	iters: 1000, epoch: 5 | loss: 0.4398946
	speed: 0.0251s/iter; left time: 147.6621s
	iters: 1100, epoch: 5 | loss: 0.2530780
	speed: 0.0249s/iter; left time: 143.8384s
Epoch: 5 cost time: 28.600737810134888
Epoch: 5, Steps: 1147 | Train Loss: 0.3705372 Vali Loss: 0.4031571 Test Loss: 0.1728400
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4399335
	speed: 0.0405s/iter; left time: 228.0990s
	iters: 200, epoch: 6 | loss: 0.2551091
	speed: 0.0338s/iter; left time: 187.1833s
	iters: 300, epoch: 6 | loss: 0.3362969
	speed: 0.0297s/iter; left time: 161.5631s
	iters: 400, epoch: 6 | loss: 0.2151773
	speed: 0.0277s/iter; left time: 147.9128s
	iters: 500, epoch: 6 | loss: 1.4518307
	speed: 0.0259s/iter; left time: 135.4640s
	iters: 600, epoch: 6 | loss: 0.2774673
	speed: 0.0252s/iter; left time: 129.3766s
	iters: 700, epoch: 6 | loss: 0.2911362
	speed: 0.0236s/iter; left time: 118.9768s
	iters: 800, epoch: 6 | loss: 0.2322886
	speed: 0.0222s/iter; left time: 109.8195s
	iters: 900, epoch: 6 | loss: 0.3461655
	speed: 0.0214s/iter; left time: 103.4483s
	iters: 1000, epoch: 6 | loss: 0.2669805
	speed: 0.0202s/iter; left time: 95.7148s
	iters: 1100, epoch: 6 | loss: 1.2100341
	speed: 0.0195s/iter; left time: 90.2849s
Epoch: 6 cost time: 22.176271438598633
Epoch: 6, Steps: 1147 | Train Loss: 0.3673784 Vali Loss: 0.4007199 Test Loss: 0.1704511
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3362049
	speed: 0.0339s/iter; left time: 152.0392s
	iters: 200, epoch: 7 | loss: 0.2161677
	speed: 0.0283s/iter; left time: 124.2242s
	iters: 300, epoch: 7 | loss: 0.2733195
	speed: 0.0264s/iter; left time: 113.1260s
	iters: 400, epoch: 7 | loss: 0.4417831
	speed: 0.0255s/iter; left time: 106.9692s
	iters: 500, epoch: 7 | loss: 0.2293670
	speed: 0.0253s/iter; left time: 103.3486s
	iters: 600, epoch: 7 | loss: 0.2210492
	speed: 0.0250s/iter; left time: 99.9182s
	iters: 700, epoch: 7 | loss: 0.2914534
	speed: 0.0249s/iter; left time: 96.8691s
	iters: 800, epoch: 7 | loss: 0.3879496
	speed: 0.0245s/iter; left time: 92.8124s
	iters: 900, epoch: 7 | loss: 0.2618382
	speed: 0.0240s/iter; left time: 88.6684s
	iters: 1000, epoch: 7 | loss: 0.2328613
	speed: 0.0239s/iter; left time: 85.6249s
	iters: 1100, epoch: 7 | loss: 0.1877187
	speed: 0.0236s/iter; left time: 82.4287s
Epoch: 7 cost time: 27.113584995269775
Epoch: 7, Steps: 1147 | Train Loss: 0.3659187 Vali Loss: 0.4009262 Test Loss: 0.1717943
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.17015457153320312, mae:0.23157422244548798
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.5404001
	speed: 0.0299s/iter; left time: 340.3817s
	iters: 200, epoch: 1 | loss: 0.3243271
	speed: 0.0261s/iter; left time: 294.2024s
	iters: 300, epoch: 1 | loss: 0.3872665
	speed: 0.0250s/iter; left time: 279.6097s
	iters: 400, epoch: 1 | loss: 0.3734264
	speed: 0.0249s/iter; left time: 275.5014s
	iters: 500, epoch: 1 | loss: 0.3141325
	speed: 0.0249s/iter; left time: 272.6788s
	iters: 600, epoch: 1 | loss: 0.4589970
	speed: 0.0248s/iter; left time: 269.4332s
	iters: 700, epoch: 1 | loss: 0.3586283
	speed: 0.0246s/iter; left time: 264.4705s
	iters: 800, epoch: 1 | loss: 0.5544888
	speed: 0.0243s/iter; left time: 259.6580s
	iters: 900, epoch: 1 | loss: 0.3277746
	speed: 0.0246s/iter; left time: 260.3254s
	iters: 1000, epoch: 1 | loss: 0.5706052
	speed: 0.0254s/iter; left time: 266.0692s
	iters: 1100, epoch: 1 | loss: 0.3135955
	speed: 0.0252s/iter; left time: 261.1015s
Epoch: 1 cost time: 28.87385606765747
Epoch: 1, Steps: 1147 | Train Loss: 0.4563578 Vali Loss: 0.4102055 Test Loss: 0.1758302
Validation loss decreased (inf --> 0.410206).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3680426
	speed: 0.0269s/iter; left time: 275.5088s
	iters: 200, epoch: 2 | loss: 0.3346770
	speed: 0.0257s/iter; left time: 260.5771s
	iters: 300, epoch: 2 | loss: 0.2956440
	speed: 0.0248s/iter; left time: 249.0129s
	iters: 400, epoch: 2 | loss: 0.3563868
	speed: 0.0244s/iter; left time: 241.8087s
	iters: 500, epoch: 2 | loss: 0.3204349
	speed: 0.0243s/iter; left time: 238.5654s
	iters: 600, epoch: 2 | loss: 0.2606475
	speed: 0.0239s/iter; left time: 232.7581s
	iters: 700, epoch: 2 | loss: 0.3956867
	speed: 0.0233s/iter; left time: 224.0943s
	iters: 800, epoch: 2 | loss: 0.3060594
	speed: 0.0224s/iter; left time: 213.0336s
	iters: 900, epoch: 2 | loss: 1.0501331
	speed: 0.0217s/iter; left time: 204.4419s
	iters: 1000, epoch: 2 | loss: 0.2677341
	speed: 0.0211s/iter; left time: 197.0846s
	iters: 1100, epoch: 2 | loss: 0.2406293
	speed: 0.0208s/iter; left time: 192.0195s
Epoch: 2 cost time: 23.854838371276855
Epoch: 2, Steps: 1147 | Train Loss: 0.4125007 Vali Loss: 0.4034750 Test Loss: 0.1720708
Validation loss decreased (0.410206 --> 0.403475).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4341462
	speed: 0.0355s/iter; left time: 322.4496s
	iters: 200, epoch: 3 | loss: 0.2850353
	speed: 0.0286s/iter; left time: 256.6855s
	iters: 300, epoch: 3 | loss: 0.2915893
	speed: 0.0267s/iter; left time: 236.9841s
	iters: 400, epoch: 3 | loss: 1.0774205
	speed: 0.0258s/iter; left time: 226.4911s
	iters: 500, epoch: 3 | loss: 0.3424482
	speed: 0.0253s/iter; left time: 219.2378s
	iters: 600, epoch: 3 | loss: 0.3575597
	speed: 0.0250s/iter; left time: 214.7662s
	iters: 700, epoch: 3 | loss: 0.3482871
	speed: 0.0251s/iter; left time: 212.6289s
	iters: 800, epoch: 3 | loss: 0.2678603
	speed: 0.0251s/iter; left time: 210.6648s
	iters: 900, epoch: 3 | loss: 0.2883665
	speed: 0.0248s/iter; left time: 205.0048s
	iters: 1000, epoch: 3 | loss: 0.2249127
	speed: 0.0245s/iter; left time: 200.1528s
	iters: 1100, epoch: 3 | loss: 0.3390066
	speed: 0.0241s/iter; left time: 194.6754s
Epoch: 3 cost time: 27.630313873291016
Epoch: 3, Steps: 1147 | Train Loss: 0.3899312 Vali Loss: 0.3971457 Test Loss: 0.1678869
Validation loss decreased (0.403475 --> 0.397146).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2593090
	speed: 0.0293s/iter; left time: 232.5813s
	iters: 200, epoch: 4 | loss: 0.3185458
	speed: 0.0268s/iter; left time: 210.1735s
	iters: 300, epoch: 4 | loss: 1.1377449
	speed: 0.0261s/iter; left time: 201.8192s
	iters: 400, epoch: 4 | loss: 0.2229045
	speed: 0.0258s/iter; left time: 197.2171s
	iters: 500, epoch: 4 | loss: 0.3528197
	speed: 0.0253s/iter; left time: 190.3132s
	iters: 600, epoch: 4 | loss: 0.3101664
	speed: 0.0245s/iter; left time: 182.3549s
	iters: 700, epoch: 4 | loss: 0.2821336
	speed: 0.0241s/iter; left time: 176.8955s
	iters: 800, epoch: 4 | loss: 0.2692601
	speed: 0.0239s/iter; left time: 172.4499s
	iters: 900, epoch: 4 | loss: 0.5596419
	speed: 0.0239s/iter; left time: 170.4222s
	iters: 1000, epoch: 4 | loss: 0.2671238
	speed: 0.0239s/iter; left time: 167.8450s
	iters: 1100, epoch: 4 | loss: 0.2293301
	speed: 0.0237s/iter; left time: 164.2411s
Epoch: 4 cost time: 27.19545030593872
Epoch: 4, Steps: 1147 | Train Loss: 0.3788178 Vali Loss: 0.3997387 Test Loss: 0.1682302
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2240422
	speed: 0.0255s/iter; left time: 173.1190s
	iters: 200, epoch: 5 | loss: 0.2328269
	speed: 0.0240s/iter; left time: 160.1508s
	iters: 300, epoch: 5 | loss: 0.4228056
	speed: 0.0248s/iter; left time: 163.5194s
	iters: 400, epoch: 5 | loss: 0.2705338
	speed: 0.0247s/iter; left time: 160.4427s
	iters: 500, epoch: 5 | loss: 0.3203490
	speed: 0.0253s/iter; left time: 161.4558s
	iters: 600, epoch: 5 | loss: 0.2706941
	speed: 0.0261s/iter; left time: 164.1146s
	iters: 700, epoch: 5 | loss: 0.2372695
	speed: 0.0255s/iter; left time: 157.9236s
	iters: 800, epoch: 5 | loss: 1.1962256
	speed: 0.0251s/iter; left time: 152.6303s
	iters: 900, epoch: 5 | loss: 0.3908896
	speed: 0.0246s/iter; left time: 147.3840s
	iters: 1000, epoch: 5 | loss: 0.2060159
	speed: 0.0240s/iter; left time: 141.0459s
	iters: 1100, epoch: 5 | loss: 0.3368075
	speed: 0.0234s/iter; left time: 135.2277s
Epoch: 5 cost time: 26.578319311141968
Epoch: 5, Steps: 1147 | Train Loss: 0.3727824 Vali Loss: 0.4001707 Test Loss: 0.1663940
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2360927
	speed: 0.0376s/iter; left time: 211.6680s
	iters: 200, epoch: 6 | loss: 2.0616267
	speed: 0.0304s/iter; left time: 168.0382s
	iters: 300, epoch: 6 | loss: 0.3222116
	speed: 0.0281s/iter; left time: 152.8244s
	iters: 400, epoch: 6 | loss: 1.1298733
	speed: 0.0271s/iter; left time: 144.5560s
	iters: 500, epoch: 6 | loss: 0.3409277
	speed: 0.0278s/iter; left time: 145.3896s
	iters: 600, epoch: 6 | loss: 0.2825124
	speed: 0.0275s/iter; left time: 141.2636s
	iters: 700, epoch: 6 | loss: 0.2727900
	speed: 0.0267s/iter; left time: 134.4181s
	iters: 800, epoch: 6 | loss: 0.2533813
	speed: 0.0261s/iter; left time: 128.8810s
	iters: 900, epoch: 6 | loss: 0.2020315
	speed: 0.0256s/iter; left time: 123.6927s
	iters: 1000, epoch: 6 | loss: 0.2098397
	speed: 0.0263s/iter; left time: 124.5841s
	iters: 1100, epoch: 6 | loss: 0.1844643
	speed: 0.0264s/iter; left time: 122.6077s
Epoch: 6 cost time: 29.981459617614746
Epoch: 6, Steps: 1147 | Train Loss: 0.3695235 Vali Loss: 0.3992852 Test Loss: 0.1669584
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2890533
	speed: 0.0222s/iter; left time: 99.6119s
	iters: 200, epoch: 7 | loss: 0.3756505
	speed: 0.0228s/iter; left time: 99.8572s
	iters: 300, epoch: 7 | loss: 0.3338433
	speed: 0.0284s/iter; left time: 121.7475s
	iters: 400, epoch: 7 | loss: 0.2748859
	speed: 0.0317s/iter; left time: 132.7053s
	iters: 500, epoch: 7 | loss: 0.3405466
	speed: 0.0337s/iter; left time: 137.9448s
	iters: 600, epoch: 7 | loss: 0.3059662
	speed: 0.0349s/iter; left time: 139.1589s
	iters: 700, epoch: 7 | loss: 0.4404781
	speed: 0.0350s/iter; left time: 136.2019s
	iters: 800, epoch: 7 | loss: 0.2134783
	speed: 0.0342s/iter; left time: 129.7223s
	iters: 900, epoch: 7 | loss: 0.2085474
	speed: 0.0329s/iter; left time: 121.2867s
	iters: 1000, epoch: 7 | loss: 0.3391591
	speed: 0.0316s/iter; left time: 113.5389s
	iters: 1100, epoch: 7 | loss: 0.2981762
	speed: 0.0304s/iter; left time: 106.1362s
Epoch: 7 cost time: 34.424487590789795
Epoch: 7, Steps: 1147 | Train Loss: 0.3679308 Vali Loss: 0.3998301 Test Loss: 0.1666969
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2764243
	speed: 0.0371s/iter; left time: 124.1261s
	iters: 200, epoch: 8 | loss: 0.2014241
	speed: 0.0308s/iter; left time: 99.7106s
	iters: 300, epoch: 8 | loss: 0.4019302
	speed: 0.0287s/iter; left time: 90.1245s
	iters: 400, epoch: 8 | loss: 0.2762513
	speed: 0.0275s/iter; left time: 83.7925s
	iters: 500, epoch: 8 | loss: 0.3107606
	speed: 0.0257s/iter; left time: 75.5052s
	iters: 600, epoch: 8 | loss: 0.4263285
	speed: 0.0250s/iter; left time: 71.1759s
	iters: 700, epoch: 8 | loss: 0.2575540
	speed: 0.0251s/iter; left time: 68.9014s
	iters: 800, epoch: 8 | loss: 0.2057479
	speed: 0.0252s/iter; left time: 66.6765s
	iters: 900, epoch: 8 | loss: 0.2333597
	speed: 0.0244s/iter; left time: 62.0676s
	iters: 1000, epoch: 8 | loss: 0.2954257
	speed: 0.0241s/iter; left time: 58.7606s
	iters: 1100, epoch: 8 | loss: 0.4228514
	speed: 0.0237s/iter; left time: 55.5181s
Epoch: 8 cost time: 27.163763761520386
Epoch: 8, Steps: 1147 | Train Loss: 0.3670234 Vali Loss: 0.3993057 Test Loss: 0.1667414
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.1678868681192398, mae:0.22617392241954803
Seed: 456
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_192      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.3788779
	speed: 0.0559s/iter; left time: 633.5537s
	iters: 200, epoch: 1 | loss: 0.4429659
	speed: 0.0440s/iter; left time: 494.1498s
	iters: 300, epoch: 1 | loss: 0.4945773
	speed: 0.0391s/iter; left time: 435.8917s
	iters: 400, epoch: 1 | loss: 0.3562197
	speed: 0.0350s/iter; left time: 386.2044s
	iters: 500, epoch: 1 | loss: 0.6962655
	speed: 0.0324s/iter; left time: 354.8615s
	iters: 600, epoch: 1 | loss: 0.4295695
	speed: 0.0307s/iter; left time: 333.2067s
	iters: 700, epoch: 1 | loss: 0.3877125
	speed: 0.0295s/iter; left time: 317.0171s
	iters: 800, epoch: 1 | loss: 0.3671521
	speed: 0.0281s/iter; left time: 299.1751s
	iters: 900, epoch: 1 | loss: 0.9261023
	speed: 0.0271s/iter; left time: 285.3389s
	iters: 1000, epoch: 1 | loss: 0.3531580
	speed: 0.0267s/iter; left time: 278.5456s
	iters: 1100, epoch: 1 | loss: 0.3755592
	speed: 0.0268s/iter; left time: 277.2587s
Epoch: 1 cost time: 30.51145076751709
Epoch: 1, Steps: 1144 | Train Loss: 0.5074947 Vali Loss: 0.4750893 Test Loss: 0.2212840
Validation loss decreased (inf --> 0.475089).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8337854
	speed: 0.0412s/iter; left time: 420.3482s
	iters: 200, epoch: 2 | loss: 0.3917511
	speed: 0.0360s/iter; left time: 363.3011s
	iters: 300, epoch: 2 | loss: 0.3541966
	speed: 0.0338s/iter; left time: 337.9671s
	iters: 400, epoch: 2 | loss: 0.4556432
	speed: 0.0328s/iter; left time: 324.1291s
	iters: 500, epoch: 2 | loss: 0.2813499
	speed: 0.0304s/iter; left time: 298.2486s
	iters: 600, epoch: 2 | loss: 0.4231265
	speed: 0.0290s/iter; left time: 281.2928s
	iters: 700, epoch: 2 | loss: 0.3790746
	speed: 0.0277s/iter; left time: 265.4202s
	iters: 800, epoch: 2 | loss: 0.3567887
	speed: 0.0266s/iter; left time: 252.3133s
	iters: 900, epoch: 2 | loss: 0.8758904
	speed: 0.0259s/iter; left time: 243.2123s
	iters: 1000, epoch: 2 | loss: 0.3827592
	speed: 0.0253s/iter; left time: 234.7585s
	iters: 1100, epoch: 2 | loss: 0.3884774
	speed: 0.0247s/iter; left time: 227.5611s
Epoch: 2 cost time: 28.265559196472168
Epoch: 2, Steps: 1144 | Train Loss: 0.4676789 Vali Loss: 0.4682584 Test Loss: 0.2240062
Validation loss decreased (0.475089 --> 0.468258).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3640970
	speed: 0.0295s/iter; left time: 267.0399s
	iters: 200, epoch: 3 | loss: 0.4948234
	speed: 0.0272s/iter; left time: 243.7614s
	iters: 300, epoch: 3 | loss: 0.2838629
	speed: 0.0258s/iter; left time: 228.4615s
	iters: 400, epoch: 3 | loss: 0.4201938
	speed: 0.0248s/iter; left time: 216.8873s
	iters: 500, epoch: 3 | loss: 0.3299464
	speed: 0.0244s/iter; left time: 211.1796s
	iters: 600, epoch: 3 | loss: 0.4571985
	speed: 0.0240s/iter; left time: 205.1997s
	iters: 700, epoch: 3 | loss: 0.4336348
	speed: 0.0239s/iter; left time: 201.6870s
	iters: 800, epoch: 3 | loss: 0.8151711
	speed: 0.0237s/iter; left time: 197.7114s
	iters: 900, epoch: 3 | loss: 0.4274492
	speed: 0.0232s/iter; left time: 191.4018s
	iters: 1000, epoch: 3 | loss: 0.6203235
	speed: 0.0232s/iter; left time: 188.8279s
	iters: 1100, epoch: 3 | loss: 0.8691068
	speed: 0.0233s/iter; left time: 187.4738s
Epoch: 3 cost time: 26.68298316001892
Epoch: 3, Steps: 1144 | Train Loss: 0.4446447 Vali Loss: 0.4654437 Test Loss: 0.2189262
Validation loss decreased (0.468258 --> 0.465444).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3381450
	speed: 0.0409s/iter; left time: 323.4771s
	iters: 200, epoch: 4 | loss: 0.2988288
	speed: 0.0392s/iter; left time: 306.3458s
	iters: 300, epoch: 4 | loss: 0.8781052
	speed: 0.0365s/iter; left time: 281.3070s
	iters: 400, epoch: 4 | loss: 0.8596896
	speed: 0.0336s/iter; left time: 255.8110s
	iters: 500, epoch: 4 | loss: 0.8640583
	speed: 0.0314s/iter; left time: 235.8843s
	iters: 600, epoch: 4 | loss: 0.5015444
	speed: 0.0303s/iter; left time: 224.8364s
	iters: 700, epoch: 4 | loss: 0.4570183
	speed: 0.0298s/iter; left time: 217.8397s
	iters: 800, epoch: 4 | loss: 0.7373670
	speed: 0.0288s/iter; left time: 207.4420s
	iters: 900, epoch: 4 | loss: 0.2616324
	speed: 0.0277s/iter; left time: 197.0539s
	iters: 1000, epoch: 4 | loss: 0.3490637
	speed: 0.0269s/iter; left time: 188.6619s
	iters: 1100, epoch: 4 | loss: 0.2704096
	speed: 0.0264s/iter; left time: 182.5624s
Epoch: 4 cost time: 30.301382303237915
Epoch: 4, Steps: 1144 | Train Loss: 0.4326707 Vali Loss: 0.4678189 Test Loss: 0.2223840
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3836502
	speed: 0.0287s/iter; left time: 194.2434s
	iters: 200, epoch: 5 | loss: 0.2331219
	speed: 0.0267s/iter; left time: 178.2098s
	iters: 300, epoch: 5 | loss: 0.3571279
	speed: 0.0292s/iter; left time: 191.7686s
	iters: 400, epoch: 5 | loss: 0.2506942
	speed: 0.0298s/iter; left time: 192.5264s
	iters: 500, epoch: 5 | loss: 0.3453305
	speed: 0.0280s/iter; left time: 177.9356s
	iters: 600, epoch: 5 | loss: 0.4088387
	speed: 0.0269s/iter; left time: 168.7075s
	iters: 700, epoch: 5 | loss: 0.7962490
	speed: 0.0259s/iter; left time: 159.3814s
	iters: 800, epoch: 5 | loss: 0.8170462
	speed: 0.0246s/iter; left time: 149.3513s
	iters: 900, epoch: 5 | loss: 0.9430253
	speed: 0.0240s/iter; left time: 143.2727s
	iters: 1000, epoch: 5 | loss: 0.3618200
	speed: 0.0234s/iter; left time: 136.9827s
	iters: 1100, epoch: 5 | loss: 0.3237003
	speed: 0.0229s/iter; left time: 131.9850s
Epoch: 5 cost time: 26.14111089706421
Epoch: 5, Steps: 1144 | Train Loss: 0.4264549 Vali Loss: 0.4656693 Test Loss: 0.2205010
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2466656
	speed: 0.0319s/iter; left time: 179.3724s
	iters: 200, epoch: 6 | loss: 0.3668914
	speed: 0.0254s/iter; left time: 140.3549s
	iters: 300, epoch: 6 | loss: 0.3232484
	speed: 0.0243s/iter; left time: 131.5375s
	iters: 400, epoch: 6 | loss: 0.3794276
	speed: 0.0259s/iter; left time: 137.5514s
	iters: 500, epoch: 6 | loss: 0.8152151
	speed: 0.0265s/iter; left time: 138.5604s
	iters: 600, epoch: 6 | loss: 0.3023562
	speed: 0.0252s/iter; left time: 129.2346s
	iters: 700, epoch: 6 | loss: 0.4274806
	speed: 0.0242s/iter; left time: 121.6391s
	iters: 800, epoch: 6 | loss: 0.4162302
	speed: 0.0242s/iter; left time: 118.8595s
	iters: 900, epoch: 6 | loss: 0.4459693
	speed: 0.0251s/iter; left time: 121.0551s
	iters: 1000, epoch: 6 | loss: 0.3588570
	speed: 0.0251s/iter; left time: 118.3894s
	iters: 1100, epoch: 6 | loss: 0.3913031
	speed: 0.0250s/iter; left time: 115.6999s
Epoch: 6 cost time: 28.758726119995117
Epoch: 6, Steps: 1144 | Train Loss: 0.4230940 Vali Loss: 0.4654002 Test Loss: 0.2218997
Validation loss decreased (0.465444 --> 0.465400).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 1.2993283
	speed: 0.0481s/iter; left time: 215.2513s
	iters: 200, epoch: 7 | loss: 0.3214598
	speed: 0.0373s/iter; left time: 163.3880s
	iters: 300, epoch: 7 | loss: 0.8479629
	speed: 0.0322s/iter; left time: 137.5955s
	iters: 400, epoch: 7 | loss: 0.4525524
	speed: 0.0291s/iter; left time: 121.6192s
	iters: 500, epoch: 7 | loss: 0.2673620
	speed: 0.0269s/iter; left time: 109.7721s
	iters: 600, epoch: 7 | loss: 0.4385277
	speed: 0.0256s/iter; left time: 101.6681s
	iters: 700, epoch: 7 | loss: 0.3272149
	speed: 0.0247s/iter; left time: 95.7480s
	iters: 800, epoch: 7 | loss: 0.2270204
	speed: 0.0255s/iter; left time: 96.4085s
	iters: 900, epoch: 7 | loss: 0.3608369
	speed: 0.0254s/iter; left time: 93.2799s
	iters: 1000, epoch: 7 | loss: 0.3635064
	speed: 0.0253s/iter; left time: 90.5388s
	iters: 1100, epoch: 7 | loss: 0.2769501
	speed: 0.0253s/iter; left time: 87.9097s
Epoch: 7 cost time: 29.03146982192993
Epoch: 7, Steps: 1144 | Train Loss: 0.4215162 Vali Loss: 0.4680055 Test Loss: 0.2235935
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3279305
	speed: 0.0346s/iter; left time: 115.3573s
	iters: 200, epoch: 8 | loss: 0.2947271
	speed: 0.0296s/iter; left time: 95.5477s
	iters: 300, epoch: 8 | loss: 0.4154563
	speed: 0.0266s/iter; left time: 83.2463s
	iters: 400, epoch: 8 | loss: 0.3550532
	speed: 0.0244s/iter; left time: 74.0786s
	iters: 500, epoch: 8 | loss: 0.3538060
	speed: 0.0229s/iter; left time: 67.3087s
	iters: 600, epoch: 8 | loss: 0.3436021
	speed: 0.0218s/iter; left time: 61.7068s
	iters: 700, epoch: 8 | loss: 1.1645286
	speed: 0.0206s/iter; left time: 56.3139s
	iters: 800, epoch: 8 | loss: 0.3767036
	speed: 0.0212s/iter; left time: 55.7115s
	iters: 900, epoch: 8 | loss: 0.3011615
	speed: 0.0214s/iter; left time: 54.1040s
	iters: 1000, epoch: 8 | loss: 0.3229899
	speed: 0.0217s/iter; left time: 52.8467s
	iters: 1100, epoch: 8 | loss: 0.4527518
	speed: 0.0216s/iter; left time: 50.4512s
Epoch: 8 cost time: 24.76440954208374
Epoch: 8, Steps: 1144 | Train Loss: 0.4206837 Vali Loss: 0.4672942 Test Loss: 0.2226055
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.7817305
	speed: 0.0280s/iter; left time: 61.3196s
	iters: 200, epoch: 9 | loss: 0.3266039
	speed: 0.0265s/iter; left time: 55.3552s
	iters: 300, epoch: 9 | loss: 0.4321877
	speed: 0.0260s/iter; left time: 51.6975s
	iters: 400, epoch: 9 | loss: 0.2991837
	speed: 0.0256s/iter; left time: 48.3138s
	iters: 500, epoch: 9 | loss: 0.2894323
	speed: 0.0244s/iter; left time: 43.6124s
	iters: 600, epoch: 9 | loss: 0.2946733
	speed: 0.0230s/iter; left time: 38.9110s
	iters: 700, epoch: 9 | loss: 0.2810990
	speed: 0.0220s/iter; left time: 35.0039s
	iters: 800, epoch: 9 | loss: 0.2983584
	speed: 0.0213s/iter; left time: 31.7399s
	iters: 900, epoch: 9 | loss: 0.2895357
	speed: 0.0207s/iter; left time: 28.8164s
	iters: 1000, epoch: 9 | loss: 0.4041976
	speed: 0.0209s/iter; left time: 26.9189s
	iters: 1100, epoch: 9 | loss: 0.3749866
	speed: 0.0212s/iter; left time: 25.2355s
Epoch: 9 cost time: 24.558147430419922
Epoch: 9, Steps: 1144 | Train Loss: 0.4201021 Vali Loss: 0.4682627 Test Loss: 0.2233218
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3931842
	speed: 0.0450s/iter; left time: 47.0619s
	iters: 200, epoch: 10 | loss: 0.2960311
	speed: 0.0430s/iter; left time: 40.6232s
	iters: 300, epoch: 10 | loss: 0.3893604
	speed: 0.0417s/iter; left time: 35.2178s
	iters: 400, epoch: 10 | loss: 0.7835954
	speed: 0.0410s/iter; left time: 30.5489s
	iters: 500, epoch: 10 | loss: 0.8163254
	speed: 0.0383s/iter; left time: 24.6813s
	iters: 600, epoch: 10 | loss: 0.3701685
	speed: 0.0351s/iter; left time: 19.1267s
	iters: 700, epoch: 10 | loss: 0.4500131
	speed: 0.0328s/iter; left time: 14.6061s
	iters: 800, epoch: 10 | loss: 0.2789369
	speed: 0.0308s/iter; left time: 10.6240s
	iters: 900, epoch: 10 | loss: 0.3121491
	speed: 0.0291s/iter; left time: 7.1393s
	iters: 1000, epoch: 10 | loss: 0.2836121
	speed: 0.0293s/iter; left time: 4.2465s
	iters: 1100, epoch: 10 | loss: 0.3219211
	speed: 0.0288s/iter; left time: 1.2952s
Epoch: 10 cost time: 32.829216718673706
Epoch: 10, Steps: 1144 | Train Loss: 0.4200209 Vali Loss: 0.4678067 Test Loss: 0.2232808
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.22189967334270477, mae:0.27703431248664856
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.8650533
	speed: 0.0385s/iter; left time: 437.0693s
	iters: 200, epoch: 1 | loss: 0.4113561
	speed: 0.0316s/iter; left time: 355.6562s
	iters: 300, epoch: 1 | loss: 0.3938915
	speed: 0.0263s/iter; left time: 293.4142s
	iters: 400, epoch: 1 | loss: 0.4479862
	speed: 0.0236s/iter; left time: 261.0466s
	iters: 500, epoch: 1 | loss: 0.3593389
	speed: 0.0222s/iter; left time: 242.6637s
	iters: 600, epoch: 1 | loss: 0.3971147
	speed: 0.0221s/iter; left time: 240.1036s
	iters: 700, epoch: 1 | loss: 0.4172902
	speed: 0.0228s/iter; left time: 244.5800s
	iters: 800, epoch: 1 | loss: 0.7878224
	speed: 0.0234s/iter; left time: 249.0665s
	iters: 900, epoch: 1 | loss: 0.4604460
	speed: 0.0230s/iter; left time: 242.3033s
	iters: 1000, epoch: 1 | loss: 0.3947177
	speed: 0.0226s/iter; left time: 235.4694s
	iters: 1100, epoch: 1 | loss: 0.4479080
	speed: 0.0222s/iter; left time: 229.4378s
Epoch: 1 cost time: 25.57801389694214
Epoch: 1, Steps: 1144 | Train Loss: 0.5073800 Vali Loss: 0.4561530 Test Loss: 0.2196106
Validation loss decreased (inf --> 0.456153).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4457448
	speed: 0.0312s/iter; left time: 318.5472s
	iters: 200, epoch: 2 | loss: 0.2993279
	speed: 0.0253s/iter; left time: 255.6326s
	iters: 300, epoch: 2 | loss: 0.3790748
	speed: 0.0232s/iter; left time: 231.8949s
	iters: 400, epoch: 2 | loss: 0.5553463
	speed: 0.0227s/iter; left time: 224.8878s
	iters: 500, epoch: 2 | loss: 0.8852546
	speed: 0.0218s/iter; left time: 213.4301s
	iters: 600, epoch: 2 | loss: 0.3704478
	speed: 0.0235s/iter; left time: 227.4048s
	iters: 700, epoch: 2 | loss: 0.3548937
	speed: 0.0253s/iter; left time: 242.3412s
	iters: 800, epoch: 2 | loss: 0.3465843
	speed: 0.0265s/iter; left time: 251.4567s
	iters: 900, epoch: 2 | loss: 0.7022743
	speed: 0.0263s/iter; left time: 247.1996s
	iters: 1000, epoch: 2 | loss: 0.4438740
	speed: 0.0261s/iter; left time: 243.0675s
	iters: 1100, epoch: 2 | loss: 0.5163626
	speed: 0.0260s/iter; left time: 239.1333s
Epoch: 2 cost time: 29.821325302124023
Epoch: 2, Steps: 1144 | Train Loss: 0.4666518 Vali Loss: 0.4606245 Test Loss: 0.2168569
EarlyStopping counter: 1 out of 5
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3018938
	speed: 0.0290s/iter; left time: 262.6060s
	iters: 200, epoch: 3 | loss: 0.3603995
	speed: 0.0241s/iter; left time: 215.8989s
	iters: 300, epoch: 3 | loss: 0.3471739
	speed: 0.0228s/iter; left time: 201.4131s
	iters: 400, epoch: 3 | loss: 0.2777851
	speed: 0.0233s/iter; left time: 203.9803s
	iters: 500, epoch: 3 | loss: 0.8204296
	speed: 0.0248s/iter; left time: 214.9384s
	iters: 600, epoch: 3 | loss: 0.2616986
	speed: 0.0250s/iter; left time: 214.0545s
	iters: 700, epoch: 3 | loss: 0.8768892
	speed: 0.0249s/iter; left time: 210.6717s
	iters: 800, epoch: 3 | loss: 0.6680331
	speed: 0.0249s/iter; left time: 207.8935s
	iters: 900, epoch: 3 | loss: 0.3478219
	speed: 0.0258s/iter; left time: 213.2641s
	iters: 1000, epoch: 3 | loss: 0.3178130
	speed: 0.0270s/iter; left time: 220.4215s
	iters: 1100, epoch: 3 | loss: 0.3948819
	speed: 0.0282s/iter; left time: 226.7113s
Epoch: 3 cost time: 32.89409136772156
Epoch: 3, Steps: 1144 | Train Loss: 0.4442978 Vali Loss: 0.4612151 Test Loss: 0.2180061
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3135403
	speed: 0.0257s/iter; left time: 202.9038s
	iters: 200, epoch: 4 | loss: 0.5290554
	speed: 0.0209s/iter; left time: 162.8453s
	iters: 300, epoch: 4 | loss: 0.3935134
	speed: 0.0188s/iter; left time: 144.6898s
	iters: 400, epoch: 4 | loss: 0.4507443
	speed: 0.0170s/iter; left time: 129.6452s
	iters: 500, epoch: 4 | loss: 0.4130840
	speed: 0.0166s/iter; left time: 124.5578s
	iters: 600, epoch: 4 | loss: 0.2849217
	speed: 0.0171s/iter; left time: 126.6434s
	iters: 700, epoch: 4 | loss: 0.2974292
	speed: 0.0173s/iter; left time: 126.4810s
	iters: 800, epoch: 4 | loss: 0.2987870
	speed: 0.0182s/iter; left time: 131.2754s
	iters: 900, epoch: 4 | loss: 0.2944469
	speed: 0.0189s/iter; left time: 134.5641s
	iters: 1000, epoch: 4 | loss: 0.3312764
	speed: 0.0195s/iter; left time: 136.5161s
	iters: 1100, epoch: 4 | loss: 0.3275399
	speed: 0.0199s/iter; left time: 137.8131s
Epoch: 4 cost time: 23.15359854698181
Epoch: 4, Steps: 1144 | Train Loss: 0.4320369 Vali Loss: 0.4627855 Test Loss: 0.2175099
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3648428
	speed: 0.0254s/iter; left time: 172.0499s
	iters: 200, epoch: 5 | loss: 0.3441473
	speed: 0.0228s/iter; left time: 151.6750s
	iters: 300, epoch: 5 | loss: 0.3456022
	speed: 0.0202s/iter; left time: 132.8774s
	iters: 400, epoch: 5 | loss: 0.7822272
	speed: 0.0196s/iter; left time: 126.4152s
	iters: 500, epoch: 5 | loss: 0.3401701
	speed: 0.0197s/iter; left time: 125.6921s
	iters: 600, epoch: 5 | loss: 0.5126652
	speed: 0.0198s/iter; left time: 124.2052s
	iters: 700, epoch: 5 | loss: 0.3637916
	speed: 0.0201s/iter; left time: 123.7313s
	iters: 800, epoch: 5 | loss: 0.3496815
	speed: 0.0223s/iter; left time: 135.0894s
	iters: 900, epoch: 5 | loss: 0.3019553
	speed: 0.0240s/iter; left time: 143.4143s
	iters: 1000, epoch: 5 | loss: 0.3448087
	speed: 0.0242s/iter; left time: 141.9474s
	iters: 1100, epoch: 5 | loss: 0.3585497
	speed: 0.0242s/iter; left time: 139.5243s
Epoch: 5 cost time: 27.816768169403076
Epoch: 5, Steps: 1144 | Train Loss: 0.4256073 Vali Loss: 0.4643454 Test Loss: 0.2184675
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3166414
	speed: 0.0303s/iter; left time: 170.3884s
	iters: 200, epoch: 6 | loss: 0.7492463
	speed: 0.0238s/iter; left time: 131.4383s
	iters: 300, epoch: 6 | loss: 0.3449768
	speed: 0.0219s/iter; left time: 118.5748s
	iters: 400, epoch: 6 | loss: 0.3489275
	speed: 0.0215s/iter; left time: 114.2215s
	iters: 500, epoch: 6 | loss: 0.3673691
	speed: 0.0212s/iter; left time: 110.8115s
	iters: 600, epoch: 6 | loss: 0.3522776
	speed: 0.0211s/iter; left time: 108.1582s
	iters: 700, epoch: 6 | loss: 0.3027598
	speed: 0.0217s/iter; left time: 108.7759s
	iters: 800, epoch: 6 | loss: 0.3618391
	speed: 0.0221s/iter; left time: 108.6228s
	iters: 900, epoch: 6 | loss: 0.2721283
	speed: 0.0224s/iter; left time: 107.9518s
	iters: 1000, epoch: 6 | loss: 0.2879834
	speed: 0.0230s/iter; left time: 108.4016s
	iters: 1100, epoch: 6 | loss: 0.2540590
	speed: 0.0231s/iter; left time: 106.8407s
Epoch: 6 cost time: 26.636961460113525
Epoch: 6, Steps: 1144 | Train Loss: 0.4222982 Vali Loss: 0.4637456 Test Loss: 0.2175751
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.21961046755313873, mae:0.274664968252182
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.6188446
	speed: 0.0183s/iter; left time: 208.0437s
	iters: 200, epoch: 1 | loss: 0.3462628
	speed: 0.0132s/iter; left time: 148.7646s
	iters: 300, epoch: 1 | loss: 0.3573149
	speed: 0.0134s/iter; left time: 149.5070s
	iters: 400, epoch: 1 | loss: 0.3616841
	speed: 0.0135s/iter; left time: 148.8866s
	iters: 500, epoch: 1 | loss: 0.4548105
	speed: 0.0136s/iter; left time: 148.8963s
	iters: 600, epoch: 1 | loss: 0.4392196
	speed: 0.0153s/iter; left time: 165.8550s
	iters: 700, epoch: 1 | loss: 0.3991958
	speed: 0.0166s/iter; left time: 178.4323s
	iters: 800, epoch: 1 | loss: 0.4403071
	speed: 0.0176s/iter; left time: 187.2699s
	iters: 900, epoch: 1 | loss: 0.3587022
	speed: 0.0183s/iter; left time: 193.1575s
	iters: 1000, epoch: 1 | loss: 0.5081829
	speed: 0.0189s/iter; left time: 197.3677s
	iters: 1100, epoch: 1 | loss: 0.3622497
	speed: 0.0194s/iter; left time: 200.1409s
Epoch: 1 cost time: 22.484455108642578
Epoch: 1, Steps: 1144 | Train Loss: 0.5090887 Vali Loss: 0.4641663 Test Loss: 0.2210240
Validation loss decreased (inf --> 0.464166).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5184053
	speed: 0.0322s/iter; left time: 328.6668s
	iters: 200, epoch: 2 | loss: 0.3431811
	speed: 0.0273s/iter; left time: 275.1735s
	iters: 300, epoch: 2 | loss: 0.5121078
	speed: 0.0241s/iter; left time: 241.0851s
	iters: 400, epoch: 2 | loss: 0.3077121
	speed: 0.0222s/iter; left time: 219.4820s
	iters: 500, epoch: 2 | loss: 0.3739038
	speed: 0.0219s/iter; left time: 214.2804s
	iters: 600, epoch: 2 | loss: 0.5130417
	speed: 0.0217s/iter; left time: 210.0331s
	iters: 700, epoch: 2 | loss: 0.4383086
	speed: 0.0236s/iter; left time: 226.8775s
	iters: 800, epoch: 2 | loss: 0.2872782
	speed: 0.0251s/iter; left time: 238.8373s
	iters: 900, epoch: 2 | loss: 0.8370488
	speed: 0.0263s/iter; left time: 246.8359s
	iters: 1000, epoch: 2 | loss: 0.5350711
	speed: 0.0274s/iter; left time: 255.0631s
	iters: 1100, epoch: 2 | loss: 0.3169553
	speed: 0.0282s/iter; left time: 259.1472s
Epoch: 2 cost time: 32.675140619277954
Epoch: 2, Steps: 1144 | Train Loss: 0.4692295 Vali Loss: 0.4643336 Test Loss: 0.2191858
EarlyStopping counter: 1 out of 5
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4822858
	speed: 0.0368s/iter; left time: 333.2531s
	iters: 200, epoch: 3 | loss: 0.3103482
	speed: 0.0294s/iter; left time: 263.2857s
	iters: 300, epoch: 3 | loss: 0.3220260
	speed: 0.0302s/iter; left time: 267.3598s
	iters: 400, epoch: 3 | loss: 0.7954550
	speed: 0.0283s/iter; left time: 247.6227s
	iters: 500, epoch: 3 | loss: 0.2885495
	speed: 0.0272s/iter; left time: 234.9316s
	iters: 600, epoch: 3 | loss: 0.3536527
	speed: 0.0264s/iter; left time: 225.3821s
	iters: 700, epoch: 3 | loss: 0.4321632
	speed: 0.0258s/iter; left time: 218.4918s
	iters: 800, epoch: 3 | loss: 0.4004289
	speed: 0.0257s/iter; left time: 215.0746s
	iters: 900, epoch: 3 | loss: 0.3882203
	speed: 0.0256s/iter; left time: 211.5931s
	iters: 1000, epoch: 3 | loss: 0.3109855
	speed: 0.0256s/iter; left time: 208.3462s
	iters: 1100, epoch: 3 | loss: 0.4100095
	speed: 0.0254s/iter; left time: 204.9282s
Epoch: 3 cost time: 29.48130965232849
Epoch: 3, Steps: 1144 | Train Loss: 0.4482588 Vali Loss: 0.4618117 Test Loss: 0.2123015
Validation loss decreased (0.464166 --> 0.461812).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3557293
	speed: 0.0248s/iter; left time: 196.1272s
	iters: 200, epoch: 4 | loss: 0.3297533
	speed: 0.0238s/iter; left time: 185.5870s
	iters: 300, epoch: 4 | loss: 0.3490433
	speed: 0.0260s/iter; left time: 200.8039s
	iters: 400, epoch: 4 | loss: 0.4295772
	speed: 0.0278s/iter; left time: 211.5989s
	iters: 500, epoch: 4 | loss: 0.4745094
	speed: 0.0290s/iter; left time: 217.7908s
	iters: 600, epoch: 4 | loss: 0.3214375
	speed: 0.0281s/iter; left time: 207.8900s
	iters: 700, epoch: 4 | loss: 0.5529932
	speed: 0.0276s/iter; left time: 201.6708s
	iters: 800, epoch: 4 | loss: 0.2863039
	speed: 0.0273s/iter; left time: 196.6195s
	iters: 900, epoch: 4 | loss: 0.8568324
	speed: 0.0270s/iter; left time: 192.0893s
	iters: 1000, epoch: 4 | loss: 0.2682233
	speed: 0.0268s/iter; left time: 187.9037s
	iters: 1100, epoch: 4 | loss: 0.8265420
	speed: 0.0266s/iter; left time: 183.8825s
Epoch: 4 cost time: 30.487900495529175
Epoch: 4, Steps: 1144 | Train Loss: 0.4370530 Vali Loss: 0.4572803 Test Loss: 0.2146358
Validation loss decreased (0.461812 --> 0.457280).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3240397
	speed: 0.0328s/iter; left time: 221.8884s
	iters: 200, epoch: 5 | loss: 0.3703104
	speed: 0.0308s/iter; left time: 205.1778s
	iters: 300, epoch: 5 | loss: 0.3057972
	speed: 0.0273s/iter; left time: 179.1912s
	iters: 400, epoch: 5 | loss: 0.4791881
	speed: 0.0257s/iter; left time: 166.1253s
	iters: 500, epoch: 5 | loss: 0.3429874
	speed: 0.0245s/iter; left time: 155.7254s
	iters: 600, epoch: 5 | loss: 0.2952538
	speed: 0.0244s/iter; left time: 153.0226s
	iters: 700, epoch: 5 | loss: 0.3013722
	speed: 0.0241s/iter; left time: 148.5831s
	iters: 800, epoch: 5 | loss: 0.3792943
	speed: 0.0242s/iter; left time: 146.8304s
	iters: 900, epoch: 5 | loss: 0.4382285
	speed: 0.0243s/iter; left time: 144.6738s
	iters: 1000, epoch: 5 | loss: 0.7111558
	speed: 0.0243s/iter; left time: 142.7072s
	iters: 1100, epoch: 5 | loss: 0.2721789
	speed: 0.0243s/iter; left time: 140.2345s
Epoch: 5 cost time: 27.949010610580444
Epoch: 5, Steps: 1144 | Train Loss: 0.4307739 Vali Loss: 0.4648944 Test Loss: 0.2160051
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3300683
	speed: 0.0249s/iter; left time: 139.7677s
	iters: 200, epoch: 6 | loss: 0.3636331
	speed: 0.0240s/iter; left time: 132.3777s
	iters: 300, epoch: 6 | loss: 0.2831020
	speed: 0.0248s/iter; left time: 134.6945s
	iters: 400, epoch: 6 | loss: 0.3470207
	speed: 0.0241s/iter; left time: 128.4747s
	iters: 500, epoch: 6 | loss: 0.3912658
	speed: 0.0235s/iter; left time: 122.8104s
	iters: 600, epoch: 6 | loss: 0.3482752
	speed: 0.0230s/iter; left time: 117.8236s
	iters: 700, epoch: 6 | loss: 0.3452668
	speed: 0.0225s/iter; left time: 112.8156s
	iters: 800, epoch: 6 | loss: 0.4102923
	speed: 0.0219s/iter; left time: 107.9996s
	iters: 900, epoch: 6 | loss: 0.3995102
	speed: 0.0220s/iter; left time: 106.1702s
	iters: 1000, epoch: 6 | loss: 0.9101387
	speed: 0.0226s/iter; left time: 106.8900s
	iters: 1100, epoch: 6 | loss: 0.3343900
	speed: 0.0230s/iter; left time: 106.1354s
Epoch: 6 cost time: 26.409316062927246
Epoch: 6, Steps: 1144 | Train Loss: 0.4275381 Vali Loss: 0.4630882 Test Loss: 0.2150838
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3263643
	speed: 0.0234s/iter; left time: 104.7796s
	iters: 200, epoch: 7 | loss: 0.7372161
	speed: 0.0228s/iter; left time: 99.8624s
	iters: 300, epoch: 7 | loss: 0.3407574
	speed: 0.0231s/iter; left time: 98.7466s
	iters: 400, epoch: 7 | loss: 0.3609521
	speed: 0.0222s/iter; left time: 92.5748s
	iters: 500, epoch: 7 | loss: 0.2713307
	speed: 0.0210s/iter; left time: 85.5613s
	iters: 600, epoch: 7 | loss: 0.4398223
	speed: 0.0202s/iter; left time: 80.3285s
	iters: 700, epoch: 7 | loss: 0.8173456
	speed: 0.0196s/iter; left time: 75.9419s
	iters: 800, epoch: 7 | loss: 0.3816243
	speed: 0.0191s/iter; left time: 72.0492s
	iters: 900, epoch: 7 | loss: 0.3412955
	speed: 0.0193s/iter; left time: 70.8808s
	iters: 1000, epoch: 7 | loss: 0.4241832
	speed: 0.0196s/iter; left time: 70.1159s
	iters: 1100, epoch: 7 | loss: 0.8018424
	speed: 0.0199s/iter; left time: 69.0921s
Epoch: 7 cost time: 22.99793815612793
Epoch: 7, Steps: 1144 | Train Loss: 0.4259495 Vali Loss: 0.4638861 Test Loss: 0.2158371
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3609424
	speed: 0.0351s/iter; left time: 116.8821s
	iters: 200, epoch: 8 | loss: 0.3012338
	speed: 0.0356s/iter; left time: 114.9381s
	iters: 300, epoch: 8 | loss: 0.3551118
	speed: 0.0351s/iter; left time: 109.8742s
	iters: 400, epoch: 8 | loss: 0.2991486
	speed: 0.0317s/iter; left time: 96.2629s
	iters: 500, epoch: 8 | loss: 0.3382286
	speed: 0.0295s/iter; left time: 86.6121s
	iters: 600, epoch: 8 | loss: 0.7451188
	speed: 0.0281s/iter; left time: 79.7158s
	iters: 700, epoch: 8 | loss: 0.4045426
	speed: 0.0277s/iter; left time: 75.6341s
	iters: 800, epoch: 8 | loss: 0.3212098
	speed: 0.0273s/iter; left time: 71.8039s
	iters: 900, epoch: 8 | loss: 0.3871768
	speed: 0.0268s/iter; left time: 67.9105s
	iters: 1000, epoch: 8 | loss: 0.3702002
	speed: 0.0263s/iter; left time: 64.0993s
	iters: 1100, epoch: 8 | loss: 0.3068951
	speed: 0.0261s/iter; left time: 60.9982s
Epoch: 8 cost time: 29.90998148918152
Epoch: 8, Steps: 1144 | Train Loss: 0.4251598 Vali Loss: 0.4650612 Test Loss: 0.2157709
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4203483
	speed: 0.0282s/iter; left time: 61.7635s
	iters: 200, epoch: 9 | loss: 0.3184792
	speed: 0.0249s/iter; left time: 52.0894s
	iters: 300, epoch: 9 | loss: 0.3146788
	speed: 0.0236s/iter; left time: 46.9045s
	iters: 400, epoch: 9 | loss: 0.2989113
	speed: 0.0233s/iter; left time: 43.9354s
	iters: 500, epoch: 9 | loss: 0.3290544
	speed: 0.0240s/iter; left time: 42.9733s
	iters: 600, epoch: 9 | loss: 0.3370714
	speed: 0.0233s/iter; left time: 39.3561s
	iters: 700, epoch: 9 | loss: 0.7468252
	speed: 0.0234s/iter; left time: 37.1659s
	iters: 800, epoch: 9 | loss: 0.2992347
	speed: 0.0234s/iter; left time: 34.7852s
	iters: 900, epoch: 9 | loss: 0.3652700
	speed: 0.0238s/iter; left time: 33.0106s
	iters: 1000, epoch: 9 | loss: 0.2618608
	speed: 0.0238s/iter; left time: 30.6745s
	iters: 1100, epoch: 9 | loss: 0.4991563
	speed: 0.0236s/iter; left time: 28.1077s
Epoch: 9 cost time: 27.111324787139893
Epoch: 9, Steps: 1144 | Train Loss: 0.4246826 Vali Loss: 0.4642451 Test Loss: 0.2157072
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.2146359235048294, mae:0.2724938690662384
Seed: 456
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_336      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.5077498
	speed: 0.0287s/iter; left time: 324.2865s
	iters: 200, epoch: 1 | loss: 0.7106694
	speed: 0.0221s/iter; left time: 247.7660s
	iters: 300, epoch: 1 | loss: 0.4891816
	speed: 0.0219s/iter; left time: 242.7264s
	iters: 400, epoch: 1 | loss: 0.3643243
	speed: 0.0221s/iter; left time: 243.5083s
	iters: 500, epoch: 1 | loss: 0.4557925
	speed: 0.0224s/iter; left time: 244.3839s
	iters: 600, epoch: 1 | loss: 0.4107344
	speed: 0.0241s/iter; left time: 260.5794s
	iters: 700, epoch: 1 | loss: 0.5118980
	speed: 0.0244s/iter; left time: 261.3988s
	iters: 800, epoch: 1 | loss: 0.4725419
	speed: 0.0242s/iter; left time: 256.9956s
	iters: 900, epoch: 1 | loss: 0.5679429
	speed: 0.0243s/iter; left time: 254.7681s
	iters: 1000, epoch: 1 | loss: 0.4359405
	speed: 0.0251s/iter; left time: 260.5740s
	iters: 1100, epoch: 1 | loss: 0.5172501
	speed: 0.0250s/iter; left time: 257.0206s
Epoch: 1 cost time: 28.4351167678833
Epoch: 1, Steps: 1140 | Train Loss: 0.5612075 Vali Loss: 0.5376090 Test Loss: 0.2738527
Validation loss decreased (inf --> 0.537609).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7927947
	speed: 0.0299s/iter; left time: 303.5063s
	iters: 200, epoch: 2 | loss: 0.7328959
	speed: 0.0258s/iter; left time: 259.3222s
	iters: 300, epoch: 2 | loss: 0.6864614
	speed: 0.0248s/iter; left time: 246.5885s
	iters: 400, epoch: 2 | loss: 0.4578659
	speed: 0.0251s/iter; left time: 247.4746s
	iters: 500, epoch: 2 | loss: 0.4316628
	speed: 0.0250s/iter; left time: 243.6043s
	iters: 600, epoch: 2 | loss: 0.4473563
	speed: 0.0248s/iter; left time: 239.5501s
	iters: 700, epoch: 2 | loss: 0.3938431
	speed: 0.0245s/iter; left time: 234.6647s
	iters: 800, epoch: 2 | loss: 0.3513424
	speed: 0.0244s/iter; left time: 230.5299s
	iters: 900, epoch: 2 | loss: 0.3488232
	speed: 0.0248s/iter; left time: 231.8480s
	iters: 1000, epoch: 2 | loss: 0.7776491
	speed: 0.0243s/iter; left time: 224.8608s
	iters: 1100, epoch: 2 | loss: 0.4220478
	speed: 0.0240s/iter; left time: 219.7703s
Epoch: 2 cost time: 27.413249254226685
Epoch: 2, Steps: 1140 | Train Loss: 0.5181180 Vali Loss: 0.5399706 Test Loss: 0.2782392
EarlyStopping counter: 1 out of 5
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4022888
	speed: 0.0367s/iter; left time: 331.4136s
	iters: 200, epoch: 3 | loss: 0.4700354
	speed: 0.0328s/iter; left time: 292.5766s
	iters: 300, epoch: 3 | loss: 0.4095870
	speed: 0.0295s/iter; left time: 260.2817s
	iters: 400, epoch: 3 | loss: 0.4233483
	speed: 0.0277s/iter; left time: 241.6301s
	iters: 500, epoch: 3 | loss: 0.4347656
	speed: 0.0266s/iter; left time: 229.6606s
	iters: 600, epoch: 3 | loss: 0.3892170
	speed: 0.0262s/iter; left time: 222.8886s
	iters: 700, epoch: 3 | loss: 0.3831261
	speed: 0.0257s/iter; left time: 216.2060s
	iters: 800, epoch: 3 | loss: 0.3567267
	speed: 0.0253s/iter; left time: 210.8570s
	iters: 900, epoch: 3 | loss: 0.3826416
	speed: 0.0251s/iter; left time: 206.5820s
	iters: 1000, epoch: 3 | loss: 0.3922980
	speed: 0.0246s/iter; left time: 199.5517s
	iters: 1100, epoch: 3 | loss: 0.5017353
	speed: 0.0242s/iter; left time: 194.0086s
Epoch: 3 cost time: 27.54237151145935
Epoch: 3, Steps: 1140 | Train Loss: 0.4919177 Vali Loss: 0.5489756 Test Loss: 0.2840077
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3436956
	speed: 0.0225s/iter; left time: 177.5786s
	iters: 200, epoch: 4 | loss: 0.4161077
	speed: 0.0214s/iter; left time: 166.7608s
	iters: 300, epoch: 4 | loss: 0.4271569
	speed: 0.0208s/iter; left time: 159.9952s
	iters: 400, epoch: 4 | loss: 0.6589733
	speed: 0.0199s/iter; left time: 151.2297s
	iters: 500, epoch: 4 | loss: 0.3649902
	speed: 0.0195s/iter; left time: 145.7347s
	iters: 600, epoch: 4 | loss: 0.4398262
	speed: 0.0216s/iter; left time: 159.4887s
	iters: 700, epoch: 4 | loss: 0.6742604
	speed: 0.0234s/iter; left time: 170.1301s
	iters: 800, epoch: 4 | loss: 0.4165229
	speed: 0.0237s/iter; left time: 170.3834s
	iters: 900, epoch: 4 | loss: 0.3786187
	speed: 0.0232s/iter; left time: 164.4434s
	iters: 1000, epoch: 4 | loss: 0.7364235
	speed: 0.0227s/iter; left time: 158.6284s
	iters: 1100, epoch: 4 | loss: 0.3709210
	speed: 0.0225s/iter; left time: 154.8181s
Epoch: 4 cost time: 25.757068872451782
Epoch: 4, Steps: 1140 | Train Loss: 0.4784194 Vali Loss: 0.5407054 Test Loss: 0.2826357
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 1.4150128
	speed: 0.0452s/iter; left time: 304.7719s
	iters: 200, epoch: 5 | loss: 0.3757176
	speed: 0.0420s/iter; left time: 279.0117s
	iters: 300, epoch: 5 | loss: 0.3364230
	speed: 0.0382s/iter; left time: 249.8606s
	iters: 400, epoch: 5 | loss: 0.3527018
	speed: 0.0346s/iter; left time: 222.9185s
	iters: 500, epoch: 5 | loss: 0.3539996
	speed: 0.0324s/iter; left time: 205.6084s
	iters: 600, epoch: 5 | loss: 0.6909300
	speed: 0.0308s/iter; left time: 192.5140s
	iters: 700, epoch: 5 | loss: 0.4042901
	speed: 0.0292s/iter; left time: 179.3553s
	iters: 800, epoch: 5 | loss: 0.3320700
	speed: 0.0277s/iter; left time: 167.0696s
	iters: 900, epoch: 5 | loss: 0.4197888
	speed: 0.0264s/iter; left time: 156.8486s
	iters: 1000, epoch: 5 | loss: 0.4496529
	speed: 0.0257s/iter; left time: 149.9099s
	iters: 1100, epoch: 5 | loss: 0.3473224
	speed: 0.0255s/iter; left time: 146.4451s
Epoch: 5 cost time: 29.474438428878784
Epoch: 5, Steps: 1140 | Train Loss: 0.4710115 Vali Loss: 0.5438830 Test Loss: 0.2841371
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3899924
	speed: 0.0359s/iter; left time: 200.8420s
	iters: 200, epoch: 6 | loss: 0.7053541
	speed: 0.0302s/iter; left time: 166.0100s
	iters: 300, epoch: 6 | loss: 0.5978624
	speed: 0.0284s/iter; left time: 153.4671s
	iters: 400, epoch: 6 | loss: 0.4448514
	speed: 0.0277s/iter; left time: 146.9319s
	iters: 500, epoch: 6 | loss: 0.3735838
	speed: 0.0273s/iter; left time: 141.8562s
	iters: 600, epoch: 6 | loss: 0.7205709
	speed: 0.0272s/iter; left time: 138.6053s
	iters: 700, epoch: 6 | loss: 0.3770593
	speed: 0.0265s/iter; left time: 132.6099s
	iters: 800, epoch: 6 | loss: 0.4451297
	speed: 0.0256s/iter; left time: 125.3844s
	iters: 900, epoch: 6 | loss: 0.3676033
	speed: 0.0249s/iter; left time: 119.3464s
	iters: 1000, epoch: 6 | loss: 0.4647466
	speed: 0.0243s/iter; left time: 114.3401s
	iters: 1100, epoch: 6 | loss: 0.3077311
	speed: 0.0239s/iter; left time: 110.0829s
Epoch: 6 cost time: 27.27564024925232
Epoch: 6, Steps: 1140 | Train Loss: 0.4673661 Vali Loss: 0.5512813 Test Loss: 0.2875041
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.27385279536247253, mae:0.3213528096675873
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.4643468
	speed: 0.0405s/iter; left time: 457.8085s
	iters: 200, epoch: 1 | loss: 0.4620568
	speed: 0.0371s/iter; left time: 415.5066s
	iters: 300, epoch: 1 | loss: 0.5720845
	speed: 0.0310s/iter; left time: 344.5309s
	iters: 400, epoch: 1 | loss: 0.8080177
	speed: 0.0281s/iter; left time: 308.9726s
	iters: 500, epoch: 1 | loss: 0.4557002
	speed: 0.0264s/iter; left time: 288.2177s
	iters: 600, epoch: 1 | loss: 0.4368672
	speed: 0.0256s/iter; left time: 276.0206s
	iters: 700, epoch: 1 | loss: 0.7431305
	speed: 0.0252s/iter; left time: 269.7900s
	iters: 800, epoch: 1 | loss: 0.4404505
	speed: 0.0247s/iter; left time: 262.0144s
	iters: 900, epoch: 1 | loss: 0.5250016
	speed: 0.0242s/iter; left time: 254.0073s
	iters: 1000, epoch: 1 | loss: 0.5557596
	speed: 0.0237s/iter; left time: 246.3963s
	iters: 1100, epoch: 1 | loss: 0.4364263
	speed: 0.0235s/iter; left time: 242.0551s
Epoch: 1 cost time: 26.942182302474976
Epoch: 1, Steps: 1140 | Train Loss: 0.5618132 Vali Loss: 0.5464045 Test Loss: 0.2722821
Validation loss decreased (inf --> 0.546404).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4286037
	speed: 0.0317s/iter; left time: 321.6131s
	iters: 200, epoch: 2 | loss: 0.7128174
	speed: 0.0284s/iter; left time: 285.3808s
	iters: 300, epoch: 2 | loss: 0.7541843
	speed: 0.0261s/iter; left time: 259.7206s
	iters: 400, epoch: 2 | loss: 0.4219473
	speed: 0.0253s/iter; left time: 249.7541s
	iters: 500, epoch: 2 | loss: 0.6470673
	speed: 0.0247s/iter; left time: 240.6106s
	iters: 600, epoch: 2 | loss: 0.4015264
	speed: 0.0239s/iter; left time: 230.5181s
	iters: 700, epoch: 2 | loss: 0.6189681
	speed: 0.0230s/iter; left time: 219.4250s
	iters: 800, epoch: 2 | loss: 0.4447421
	speed: 0.0231s/iter; left time: 218.9764s
	iters: 900, epoch: 2 | loss: 0.6996962
	speed: 0.0235s/iter; left time: 219.6765s
	iters: 1000, epoch: 2 | loss: 0.4563295
	speed: 0.0232s/iter; left time: 214.7609s
	iters: 1100, epoch: 2 | loss: 0.4232950
	speed: 0.0233s/iter; left time: 213.3230s
Epoch: 2 cost time: 26.696411609649658
Epoch: 2, Steps: 1140 | Train Loss: 0.5176001 Vali Loss: 0.5443192 Test Loss: 0.2838860
Validation loss decreased (0.546404 --> 0.544319).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4015582
	speed: 0.0406s/iter; left time: 366.6266s
	iters: 200, epoch: 3 | loss: 0.5537287
	speed: 0.0382s/iter; left time: 340.7643s
	iters: 300, epoch: 3 | loss: 0.3693942
	speed: 0.0380s/iter; left time: 335.1616s
	iters: 400, epoch: 3 | loss: 0.4997433
	speed: 0.0348s/iter; left time: 303.2394s
	iters: 500, epoch: 3 | loss: 0.6966294
	speed: 0.0322s/iter; left time: 277.5533s
	iters: 600, epoch: 3 | loss: 0.6343154
	speed: 0.0300s/iter; left time: 256.0002s
	iters: 700, epoch: 3 | loss: 0.4090789
	speed: 0.0282s/iter; left time: 237.5757s
	iters: 800, epoch: 3 | loss: 0.3765891
	speed: 0.0272s/iter; left time: 226.2948s
	iters: 900, epoch: 3 | loss: 0.5838060
	speed: 0.0260s/iter; left time: 213.3651s
	iters: 1000, epoch: 3 | loss: 0.4716201
	speed: 0.0250s/iter; left time: 203.2405s
	iters: 1100, epoch: 3 | loss: 0.4280726
	speed: 0.0250s/iter; left time: 200.8905s
Epoch: 3 cost time: 28.476324796676636
Epoch: 3, Steps: 1140 | Train Loss: 0.4915481 Vali Loss: 0.5460430 Test Loss: 0.2828900
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4594417
	speed: 0.0352s/iter; left time: 277.4207s
	iters: 200, epoch: 4 | loss: 0.6382099
	speed: 0.0299s/iter; left time: 232.5621s
	iters: 300, epoch: 4 | loss: 0.3387690
	speed: 0.0281s/iter; left time: 216.2095s
	iters: 400, epoch: 4 | loss: 0.4369017
	speed: 0.0272s/iter; left time: 206.5352s
	iters: 500, epoch: 4 | loss: 0.4646342
	speed: 0.0268s/iter; left time: 200.2017s
	iters: 600, epoch: 4 | loss: 0.6284510
	speed: 0.0265s/iter; left time: 195.6650s
	iters: 700, epoch: 4 | loss: 0.4512506
	speed: 0.0259s/iter; left time: 188.5699s
	iters: 800, epoch: 4 | loss: 0.3711701
	speed: 0.0252s/iter; left time: 180.7510s
	iters: 900, epoch: 4 | loss: 0.3251763
	speed: 0.0251s/iter; left time: 177.8405s
	iters: 1000, epoch: 4 | loss: 0.3646424
	speed: 0.0249s/iter; left time: 173.6598s
	iters: 1100, epoch: 4 | loss: 0.6500131
	speed: 0.0249s/iter; left time: 171.4936s
Epoch: 4 cost time: 28.967966318130493
Epoch: 4, Steps: 1140 | Train Loss: 0.4779834 Vali Loss: 0.5548996 Test Loss: 0.2838414
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3712529
	speed: 0.0452s/iter; left time: 304.4945s
	iters: 200, epoch: 5 | loss: 0.3655304
	speed: 0.0431s/iter; left time: 286.4328s
	iters: 300, epoch: 5 | loss: 0.4887114
	speed: 0.0406s/iter; left time: 265.7046s
	iters: 400, epoch: 5 | loss: 0.3984863
	speed: 0.0356s/iter; left time: 229.4415s
	iters: 500, epoch: 5 | loss: 0.3504179
	speed: 0.0322s/iter; left time: 204.3406s
	iters: 600, epoch: 5 | loss: 0.5135445
	speed: 0.0300s/iter; left time: 187.4879s
	iters: 700, epoch: 5 | loss: 0.6012838
	speed: 0.0284s/iter; left time: 174.5926s
	iters: 800, epoch: 5 | loss: 0.3842077
	speed: 0.0278s/iter; left time: 167.6706s
	iters: 900, epoch: 5 | loss: 0.6358126
	speed: 0.0274s/iter; left time: 162.5379s
	iters: 1000, epoch: 5 | loss: 0.4502211
	speed: 0.0271s/iter; left time: 158.0800s
	iters: 1100, epoch: 5 | loss: 0.4035350
	speed: 0.0268s/iter; left time: 154.0241s
Epoch: 5 cost time: 30.611353397369385
Epoch: 5, Steps: 1140 | Train Loss: 0.4708975 Vali Loss: 0.5563537 Test Loss: 0.2835788
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3823233
	speed: 0.0368s/iter; left time: 206.2024s
	iters: 200, epoch: 6 | loss: 0.3768317
	speed: 0.0357s/iter; left time: 196.1476s
	iters: 300, epoch: 6 | loss: 0.3767734
	speed: 0.0312s/iter; left time: 168.7459s
	iters: 400, epoch: 6 | loss: 0.3696189
	speed: 0.0291s/iter; left time: 154.3791s
	iters: 500, epoch: 6 | loss: 0.3492672
	speed: 0.0271s/iter; left time: 141.1765s
	iters: 600, epoch: 6 | loss: 0.6898974
	speed: 0.0257s/iter; left time: 130.9238s
	iters: 700, epoch: 6 | loss: 0.3695011
	speed: 0.0246s/iter; left time: 122.7752s
	iters: 800, epoch: 6 | loss: 0.6922840
	speed: 0.0240s/iter; left time: 117.4540s
	iters: 900, epoch: 6 | loss: 0.3232927
	speed: 0.0236s/iter; left time: 113.3231s
	iters: 1000, epoch: 6 | loss: 0.4195509
	speed: 0.0231s/iter; left time: 108.4162s
	iters: 1100, epoch: 6 | loss: 0.6276894
	speed: 0.0226s/iter; left time: 103.8710s
Epoch: 6 cost time: 25.6899094581604
Epoch: 6, Steps: 1140 | Train Loss: 0.4670823 Vali Loss: 0.5561172 Test Loss: 0.2847064
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5986731
	speed: 0.0410s/iter; left time: 182.9966s
	iters: 200, epoch: 7 | loss: 0.3102565
	speed: 0.0366s/iter; left time: 159.3970s
	iters: 300, epoch: 7 | loss: 0.3655504
	speed: 0.0326s/iter; left time: 139.0030s
	iters: 400, epoch: 7 | loss: 0.3834563
	speed: 0.0296s/iter; left time: 123.3486s
	iters: 500, epoch: 7 | loss: 0.4454142
	speed: 0.0278s/iter; left time: 112.7575s
	iters: 600, epoch: 7 | loss: 0.5877232
	speed: 0.0265s/iter; left time: 104.8972s
	iters: 700, epoch: 7 | loss: 0.9992044
	speed: 0.0255s/iter; left time: 98.4447s
	iters: 800, epoch: 7 | loss: 0.4094732
	speed: 0.0264s/iter; left time: 99.1764s
	iters: 900, epoch: 7 | loss: 0.3944943
	speed: 0.0273s/iter; left time: 99.9653s
	iters: 1000, epoch: 7 | loss: 0.3885748
	speed: 0.0275s/iter; left time: 97.8994s
	iters: 1100, epoch: 7 | loss: 0.4227797
	speed: 0.0273s/iter; left time: 94.4930s
Epoch: 7 cost time: 31.649022102355957
Epoch: 7, Steps: 1140 | Train Loss: 0.4654955 Vali Loss: 0.5633467 Test Loss: 0.2876760
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.2838859558105469, mae:0.3409867286682129
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.5095300
	speed: 0.0309s/iter; left time: 349.6255s
	iters: 200, epoch: 1 | loss: 0.4691699
	speed: 0.0263s/iter; left time: 294.5848s
	iters: 300, epoch: 1 | loss: 0.5198135
	speed: 0.0286s/iter; left time: 317.1677s
	iters: 400, epoch: 1 | loss: 0.5694671
	speed: 0.0287s/iter; left time: 315.5480s
	iters: 500, epoch: 1 | loss: 0.9497274
	speed: 0.0295s/iter; left time: 321.7914s
	iters: 600, epoch: 1 | loss: 0.4957379
	speed: 0.0293s/iter; left time: 316.5990s
	iters: 700, epoch: 1 | loss: 0.4687530
	speed: 0.0287s/iter; left time: 306.6175s
	iters: 800, epoch: 1 | loss: 0.4990393
	speed: 0.0282s/iter; left time: 298.8348s
	iters: 900, epoch: 1 | loss: 0.3666396
	speed: 0.0278s/iter; left time: 292.0398s
	iters: 1000, epoch: 1 | loss: 0.4545189
	speed: 0.0275s/iter; left time: 285.9798s
	iters: 1100, epoch: 1 | loss: 0.4595767
	speed: 0.0273s/iter; left time: 281.5118s
Epoch: 1 cost time: 31.206170797348022
Epoch: 1, Steps: 1140 | Train Loss: 0.5635285 Vali Loss: 0.5413809 Test Loss: 0.2691703
Validation loss decreased (inf --> 0.541381).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7696958
	speed: 0.0321s/iter; left time: 325.7240s
	iters: 200, epoch: 2 | loss: 0.4334292
	speed: 0.0273s/iter; left time: 274.1878s
	iters: 300, epoch: 2 | loss: 0.4153368
	speed: 0.0259s/iter; left time: 257.6838s
	iters: 400, epoch: 2 | loss: 0.4412560
	speed: 0.0250s/iter; left time: 246.0776s
	iters: 500, epoch: 2 | loss: 0.3920999
	speed: 0.0240s/iter; left time: 234.0411s
	iters: 600, epoch: 2 | loss: 0.4782993
	speed: 0.0237s/iter; left time: 228.5464s
	iters: 700, epoch: 2 | loss: 0.4393440
	speed: 0.0240s/iter; left time: 229.6005s
	iters: 800, epoch: 2 | loss: 0.6727319
	speed: 0.0235s/iter; left time: 222.7903s
	iters: 900, epoch: 2 | loss: 0.7252562
	speed: 0.0227s/iter; left time: 212.7066s
	iters: 1000, epoch: 2 | loss: 0.3938932
	speed: 0.0222s/iter; left time: 206.0341s
	iters: 1100, epoch: 2 | loss: 0.4022595
	speed: 0.0225s/iter; left time: 206.1383s
Epoch: 2 cost time: 26.18686056137085
Epoch: 2, Steps: 1140 | Train Loss: 0.5207600 Vali Loss: 0.5454508 Test Loss: 0.2828238
EarlyStopping counter: 1 out of 5
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3999957
	speed: 0.0247s/iter; left time: 223.1109s
	iters: 200, epoch: 3 | loss: 0.4349912
	speed: 0.0245s/iter; left time: 218.4789s
	iters: 300, epoch: 3 | loss: 0.5056936
	speed: 0.0277s/iter; left time: 243.9231s
	iters: 400, epoch: 3 | loss: 0.5353770
	speed: 0.0303s/iter; left time: 264.3503s
	iters: 500, epoch: 3 | loss: 0.6118851
	speed: 0.0317s/iter; left time: 273.7028s
	iters: 600, epoch: 3 | loss: 0.4396382
	speed: 0.0319s/iter; left time: 271.4365s
	iters: 700, epoch: 3 | loss: 0.3313710
	speed: 0.0321s/iter; left time: 270.4024s
	iters: 800, epoch: 3 | loss: 0.6766464
	speed: 0.0316s/iter; left time: 263.0412s
	iters: 900, epoch: 3 | loss: 0.4240270
	speed: 0.0308s/iter; left time: 253.3093s
	iters: 1000, epoch: 3 | loss: 0.4290728
	speed: 0.0300s/iter; left time: 243.6581s
	iters: 1100, epoch: 3 | loss: 0.4649386
	speed: 0.0292s/iter; left time: 234.0894s
Epoch: 3 cost time: 32.966843366622925
Epoch: 3, Steps: 1140 | Train Loss: 0.4953988 Vali Loss: 0.5412714 Test Loss: 0.2834836
Validation loss decreased (0.541381 --> 0.541271).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3863044
	speed: 0.0444s/iter; left time: 349.8662s
	iters: 200, epoch: 4 | loss: 0.4285801
	speed: 0.0426s/iter; left time: 331.4318s
	iters: 300, epoch: 4 | loss: 0.4244497
	speed: 0.0422s/iter; left time: 324.2292s
	iters: 400, epoch: 4 | loss: 0.3441250
	speed: 0.0379s/iter; left time: 286.9677s
	iters: 500, epoch: 4 | loss: 0.3564233
	speed: 0.0368s/iter; left time: 275.1115s
	iters: 600, epoch: 4 | loss: 0.4007395
	speed: 0.0350s/iter; left time: 258.4558s
	iters: 700, epoch: 4 | loss: 0.4479824
	speed: 0.0336s/iter; left time: 244.4958s
	iters: 800, epoch: 4 | loss: 0.4089171
	speed: 0.0340s/iter; left time: 243.9597s
	iters: 900, epoch: 4 | loss: 0.6243844
	speed: 0.0327s/iter; left time: 231.3963s
	iters: 1000, epoch: 4 | loss: 0.4168962
	speed: 0.0315s/iter; left time: 219.9384s
	iters: 1100, epoch: 4 | loss: 0.4320052
	speed: 0.0308s/iter; left time: 212.2400s
Epoch: 4 cost time: 34.8289692401886
Epoch: 4, Steps: 1140 | Train Loss: 0.4816034 Vali Loss: 0.5465937 Test Loss: 0.2815140
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.9709643
	speed: 0.0411s/iter; left time: 276.7229s
	iters: 200, epoch: 5 | loss: 0.3682708
	speed: 0.0323s/iter; left time: 214.6108s
	iters: 300, epoch: 5 | loss: 0.4084489
	speed: 0.0309s/iter; left time: 201.9305s
	iters: 400, epoch: 5 | loss: 0.4826537
	speed: 0.0304s/iter; left time: 196.1077s
	iters: 500, epoch: 5 | loss: 0.3702646
	speed: 0.0290s/iter; left time: 183.9926s
	iters: 600, epoch: 5 | loss: 0.4469452
	speed: 0.0280s/iter; left time: 174.8353s
	iters: 700, epoch: 5 | loss: 0.7605070
	speed: 0.0269s/iter; left time: 165.1042s
	iters: 800, epoch: 5 | loss: 0.3581404
	speed: 0.0256s/iter; left time: 154.7811s
	iters: 900, epoch: 5 | loss: 0.6544907
	speed: 0.0244s/iter; left time: 144.8567s
	iters: 1000, epoch: 5 | loss: 0.3947812
	speed: 0.0234s/iter; left time: 136.8404s
	iters: 1100, epoch: 5 | loss: 0.4061295
	speed: 0.0224s/iter; left time: 128.7429s
Epoch: 5 cost time: 25.28873634338379
Epoch: 5, Steps: 1140 | Train Loss: 0.4746456 Vali Loss: 0.5422828 Test Loss: 0.2848124
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4966736
	speed: 0.0261s/iter; left time: 146.4295s
	iters: 200, epoch: 6 | loss: 0.4317859
	speed: 0.0251s/iter; left time: 138.2421s
	iters: 300, epoch: 6 | loss: 0.4546687
	speed: 0.0243s/iter; left time: 131.3290s
	iters: 400, epoch: 6 | loss: 0.3910758
	speed: 0.0239s/iter; left time: 126.6445s
	iters: 500, epoch: 6 | loss: 0.4578072
	speed: 0.0236s/iter; left time: 122.6917s
	iters: 600, epoch: 6 | loss: 0.4662042
	speed: 0.0234s/iter; left time: 119.4304s
	iters: 700, epoch: 6 | loss: 0.3880890
	speed: 0.0232s/iter; left time: 116.2031s
	iters: 800, epoch: 6 | loss: 0.3665808
	speed: 0.0233s/iter; left time: 114.1643s
	iters: 900, epoch: 6 | loss: 0.8954479
	speed: 0.0234s/iter; left time: 112.3387s
	iters: 1000, epoch: 6 | loss: 0.6747496
	speed: 0.0233s/iter; left time: 109.6381s
	iters: 1100, epoch: 6 | loss: 0.6502433
	speed: 0.0232s/iter; left time: 106.6777s
Epoch: 6 cost time: 26.523560285568237
Epoch: 6, Steps: 1140 | Train Loss: 0.4714999 Vali Loss: 0.5485883 Test Loss: 0.2854230
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3800350
	speed: 0.0254s/iter; left time: 113.1546s
	iters: 200, epoch: 7 | loss: 0.3544004
	speed: 0.0241s/iter; left time: 105.1078s
	iters: 300, epoch: 7 | loss: 0.3660043
	speed: 0.0234s/iter; left time: 99.8205s
	iters: 400, epoch: 7 | loss: 0.5454206
	speed: 0.0231s/iter; left time: 96.0483s
	iters: 500, epoch: 7 | loss: 0.3940506
	speed: 0.0224s/iter; left time: 91.0120s
	iters: 600, epoch: 7 | loss: 0.4079081
	speed: 0.0220s/iter; left time: 87.1391s
	iters: 700, epoch: 7 | loss: 0.4515432
	speed: 0.0218s/iter; left time: 84.2081s
	iters: 800, epoch: 7 | loss: 0.6354131
	speed: 0.0224s/iter; left time: 84.1252s
	iters: 900, epoch: 7 | loss: 0.5075727
	speed: 0.0226s/iter; left time: 82.8768s
	iters: 1000, epoch: 7 | loss: 0.3599888
	speed: 0.0229s/iter; left time: 81.4573s
	iters: 1100, epoch: 7 | loss: 0.4025759
	speed: 0.0230s/iter; left time: 79.5559s
Epoch: 7 cost time: 26.29714584350586
Epoch: 7, Steps: 1140 | Train Loss: 0.4693690 Vali Loss: 0.5497975 Test Loss: 0.2887494
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4448275
	speed: 0.0264s/iter; left time: 87.8398s
	iters: 200, epoch: 8 | loss: 0.6439433
	speed: 0.0254s/iter; left time: 81.7602s
	iters: 300, epoch: 8 | loss: 0.3803301
	speed: 0.0251s/iter; left time: 78.3905s
	iters: 400, epoch: 8 | loss: 0.3419909
	speed: 0.0245s/iter; left time: 74.0866s
	iters: 500, epoch: 8 | loss: 0.3637528
	speed: 0.0240s/iter; left time: 70.0903s
	iters: 600, epoch: 8 | loss: 0.6209428
	speed: 0.0236s/iter; left time: 66.5758s
	iters: 700, epoch: 8 | loss: 0.3757334
	speed: 0.0229s/iter; left time: 62.4438s
	iters: 800, epoch: 8 | loss: 0.7680095
	speed: 0.0230s/iter; left time: 60.2306s
	iters: 900, epoch: 8 | loss: 0.3477122
	speed: 0.0233s/iter; left time: 58.6801s
	iters: 1000, epoch: 8 | loss: 0.3697951
	speed: 0.0246s/iter; left time: 59.5849s
	iters: 1100, epoch: 8 | loss: 0.4342023
	speed: 0.0250s/iter; left time: 57.9955s
Epoch: 8 cost time: 28.42037844657898
Epoch: 8, Steps: 1140 | Train Loss: 0.4686785 Vali Loss: 0.5489701 Test Loss: 0.2871985
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.2834835946559906, mae:0.3298102021217346
Seed: 456
GPU available True
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_720      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                3                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           5                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Task: long_term_forecast
Long Term Forecast
Exp: <class 'exp.exp_long_term_forecasting.Exp_Long_Term_Forecast'>
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.5184300
	speed: 0.0472s/iter; left time: 527.4683s
	iters: 200, epoch: 1 | loss: 0.5044640
	speed: 0.0346s/iter; left time: 383.0119s
	iters: 300, epoch: 1 | loss: 0.4930137
	speed: 0.0311s/iter; left time: 341.7861s
	iters: 400, epoch: 1 | loss: 0.6209915
	speed: 0.0295s/iter; left time: 320.5800s
	iters: 500, epoch: 1 | loss: 0.6801860
	speed: 0.0283s/iter; left time: 305.3506s
	iters: 600, epoch: 1 | loss: 0.4802276
	speed: 0.0274s/iter; left time: 292.1398s
	iters: 700, epoch: 1 | loss: 0.5730407
	speed: 0.0267s/iter; left time: 282.0500s
	iters: 800, epoch: 1 | loss: 0.7430943
	speed: 0.0262s/iter; left time: 274.4099s
	iters: 900, epoch: 1 | loss: 0.6106324
	speed: 0.0258s/iter; left time: 267.9151s
	iters: 1000, epoch: 1 | loss: 0.5137450
	speed: 0.0256s/iter; left time: 262.6852s
	iters: 1100, epoch: 1 | loss: 0.7195860
	speed: 0.0252s/iter; left time: 256.2230s
Epoch: 1 cost time: 28.34310507774353
Epoch: 1, Steps: 1128 | Train Loss: 0.6229869 Vali Loss: 0.6393293 Test Loss: 0.3409841
Validation loss decreased (inf --> 0.639329).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7437507
	speed: 0.0299s/iter; left time: 300.1405s
	iters: 200, epoch: 2 | loss: 0.5735871
	speed: 0.0272s/iter; left time: 270.3845s
	iters: 300, epoch: 2 | loss: 0.4487400
	speed: 0.0255s/iter; left time: 251.1586s
	iters: 400, epoch: 2 | loss: 0.5241022
	speed: 0.0248s/iter; left time: 241.5812s
	iters: 500, epoch: 2 | loss: 0.7419474
	speed: 0.0241s/iter; left time: 232.9108s
	iters: 600, epoch: 2 | loss: 0.5545225
	speed: 0.0241s/iter; left time: 229.8482s
	iters: 700, epoch: 2 | loss: 0.6218475
	speed: 0.0237s/iter; left time: 224.0999s
	iters: 800, epoch: 2 | loss: 0.5605544
	speed: 0.0244s/iter; left time: 228.6432s
	iters: 900, epoch: 2 | loss: 0.5375158
	speed: 0.0246s/iter; left time: 227.9663s
	iters: 1000, epoch: 2 | loss: 0.5058894
	speed: 0.0248s/iter; left time: 227.3882s
	iters: 1100, epoch: 2 | loss: 0.4519296
	speed: 0.0254s/iter; left time: 229.6168s
Epoch: 2 cost time: 28.9734148979187
Epoch: 2, Steps: 1128 | Train Loss: 0.5749665 Vali Loss: 0.6606649 Test Loss: 0.3593182
EarlyStopping counter: 1 out of 5
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4203142
	speed: 0.0375s/iter; left time: 334.3287s
	iters: 200, epoch: 3 | loss: 0.7271235
	speed: 0.0331s/iter; left time: 291.8234s
	iters: 300, epoch: 3 | loss: 0.6012349
	speed: 0.0279s/iter; left time: 243.5565s
	iters: 400, epoch: 3 | loss: 0.5609983
	speed: 0.0259s/iter; left time: 223.3403s
	iters: 500, epoch: 3 | loss: 0.4504725
	speed: 0.0252s/iter; left time: 215.0820s
	iters: 600, epoch: 3 | loss: 0.4915193
	speed: 0.0248s/iter; left time: 208.6638s
	iters: 700, epoch: 3 | loss: 0.6005096
	speed: 0.0245s/iter; left time: 203.9371s
	iters: 800, epoch: 3 | loss: 0.6013863
	speed: 0.0240s/iter; left time: 197.1316s
	iters: 900, epoch: 3 | loss: 0.6334496
	speed: 0.0234s/iter; left time: 189.8771s
	iters: 1000, epoch: 3 | loss: 0.6295419
	speed: 0.0229s/iter; left time: 183.4118s
	iters: 1100, epoch: 3 | loss: 0.7407188
	speed: 0.0225s/iter; left time: 178.1207s
Epoch: 3 cost time: 25.35916042327881
Epoch: 3, Steps: 1128 | Train Loss: 0.5420406 Vali Loss: 0.6907443 Test Loss: 0.3796807
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5864111
	speed: 0.0389s/iter; left time: 303.3158s
	iters: 200, epoch: 4 | loss: 0.4334697
	speed: 0.0357s/iter; left time: 274.9543s
	iters: 300, epoch: 4 | loss: 0.5005589
	speed: 0.0349s/iter; left time: 265.1665s
	iters: 400, epoch: 4 | loss: 0.4347383
	speed: 0.0333s/iter; left time: 249.6211s
	iters: 500, epoch: 4 | loss: 0.6113872
	speed: 0.0335s/iter; left time: 247.5634s
	iters: 600, epoch: 4 | loss: 0.4886543
	speed: 0.0310s/iter; left time: 226.2268s
	iters: 700, epoch: 4 | loss: 0.4594894
	speed: 0.0294s/iter; left time: 211.6943s
	iters: 800, epoch: 4 | loss: 0.5653499
	speed: 0.0279s/iter; left time: 198.2405s
	iters: 900, epoch: 4 | loss: 0.4157256
	speed: 0.0270s/iter; left time: 188.6310s
	iters: 1000, epoch: 4 | loss: 0.5924641
	speed: 0.0272s/iter; left time: 187.7951s
	iters: 1100, epoch: 4 | loss: 0.5907063
	speed: 0.0270s/iter; left time: 183.6280s
Epoch: 4 cost time: 30.554970264434814
Epoch: 4, Steps: 1128 | Train Loss: 0.5250629 Vali Loss: 0.6808981 Test Loss: 0.3875983
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4027987
	speed: 0.0273s/iter; left time: 182.3510s
	iters: 200, epoch: 5 | loss: 0.4320287
	speed: 0.0262s/iter; left time: 172.1223s
	iters: 300, epoch: 5 | loss: 0.4755445
	speed: 0.0257s/iter; left time: 166.1855s
	iters: 400, epoch: 5 | loss: 0.4162929
	speed: 0.0249s/iter; left time: 158.6290s
	iters: 500, epoch: 5 | loss: 0.4500173
	speed: 0.0243s/iter; left time: 152.3050s
	iters: 600, epoch: 5 | loss: 0.5246072
	speed: 0.0239s/iter; left time: 147.5975s
	iters: 700, epoch: 5 | loss: 0.4725032
	speed: 0.0233s/iter; left time: 141.6192s
	iters: 800, epoch: 5 | loss: 0.5293847
	speed: 0.0235s/iter; left time: 140.1581s
	iters: 900, epoch: 5 | loss: 0.6695654
	speed: 0.0231s/iter; left time: 135.6032s
	iters: 1000, epoch: 5 | loss: 0.4062191
	speed: 0.0228s/iter; left time: 131.4184s
	iters: 1100, epoch: 5 | loss: 0.5260740
	speed: 0.0228s/iter; left time: 129.0868s
Epoch: 5 cost time: 25.78312873840332
Epoch: 5, Steps: 1128 | Train Loss: 0.5170088 Vali Loss: 0.6907350 Test Loss: 0.3950865
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5769446
	speed: 0.0302s/iter; left time: 167.3018s
	iters: 200, epoch: 6 | loss: 0.3620118
	speed: 0.0249s/iter; left time: 135.5336s
	iters: 300, epoch: 6 | loss: 0.5052447
	speed: 0.0233s/iter; left time: 124.5856s
	iters: 400, epoch: 6 | loss: 0.4064862
	speed: 0.0232s/iter; left time: 121.4875s
	iters: 500, epoch: 6 | loss: 0.4536465
	speed: 0.0241s/iter; left time: 123.7528s
	iters: 600, epoch: 6 | loss: 0.5380607
	speed: 0.0238s/iter; left time: 120.1363s
	iters: 700, epoch: 6 | loss: 0.3653123
	speed: 0.0236s/iter; left time: 116.6655s
	iters: 800, epoch: 6 | loss: 0.4248616
	speed: 0.0232s/iter; left time: 112.2215s
	iters: 900, epoch: 6 | loss: 0.5497907
	speed: 0.0228s/iter; left time: 108.1384s
	iters: 1000, epoch: 6 | loss: 0.5838953
	speed: 0.0226s/iter; left time: 104.7244s
	iters: 1100, epoch: 6 | loss: 0.4922438
	speed: 0.0223s/iter; left time: 101.2604s
Epoch: 6 cost time: 25.397103548049927
Epoch: 6, Steps: 1128 | Train Loss: 0.5130691 Vali Loss: 0.6841897 Test Loss: 0.3940043
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.34098389744758606, mae:0.36882585287094116
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.5985007
	speed: 0.0293s/iter; left time: 328.0291s
	iters: 200, epoch: 1 | loss: 0.5531880
	speed: 0.0268s/iter; left time: 297.0001s
	iters: 300, epoch: 1 | loss: 0.5847226
	speed: 0.0260s/iter; left time: 285.2293s
	iters: 400, epoch: 1 | loss: 0.4965756
	speed: 0.0255s/iter; left time: 277.7938s
	iters: 500, epoch: 1 | loss: 0.5650383
	speed: 0.0253s/iter; left time: 272.6041s
	iters: 600, epoch: 1 | loss: 0.8980822
	speed: 0.0254s/iter; left time: 271.4851s
	iters: 700, epoch: 1 | loss: 0.7250376
	speed: 0.0247s/iter; left time: 261.8358s
	iters: 800, epoch: 1 | loss: 0.5084001
	speed: 0.0247s/iter; left time: 258.7154s
	iters: 900, epoch: 1 | loss: 0.6733347
	speed: 0.0241s/iter; left time: 249.9140s
	iters: 1000, epoch: 1 | loss: 0.5002292
	speed: 0.0236s/iter; left time: 242.8364s
	iters: 1100, epoch: 1 | loss: 0.7010216
	speed: 0.0233s/iter; left time: 237.0208s
Epoch: 1 cost time: 26.25045895576477
Epoch: 1, Steps: 1128 | Train Loss: 0.6233205 Vali Loss: 0.6567176 Test Loss: 0.3401574
Validation loss decreased (inf --> 0.656718).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7425750
	speed: 0.0297s/iter; left time: 298.3826s
	iters: 200, epoch: 2 | loss: 0.5386580
	speed: 0.0291s/iter; left time: 289.6808s
	iters: 300, epoch: 2 | loss: 0.6570297
	speed: 0.0274s/iter; left time: 270.0397s
	iters: 400, epoch: 2 | loss: 0.4811777
	speed: 0.0266s/iter; left time: 259.2397s
	iters: 500, epoch: 2 | loss: 0.4883801
	speed: 0.0261s/iter; left time: 251.8537s
	iters: 600, epoch: 2 | loss: 0.7303700
	speed: 0.0258s/iter; left time: 246.5445s
	iters: 700, epoch: 2 | loss: 0.5680504
	speed: 0.0256s/iter; left time: 242.2331s
	iters: 800, epoch: 2 | loss: 0.5752509
	speed: 0.0255s/iter; left time: 238.3012s
	iters: 900, epoch: 2 | loss: 0.4801388
	speed: 0.0253s/iter; left time: 234.4463s
	iters: 1000, epoch: 2 | loss: 0.4886193
	speed: 0.0250s/iter; left time: 228.9007s
	iters: 1100, epoch: 2 | loss: 0.6180172
	speed: 0.0247s/iter; left time: 223.9570s
Epoch: 2 cost time: 27.956772565841675
Epoch: 2, Steps: 1128 | Train Loss: 0.5762400 Vali Loss: 0.6776097 Test Loss: 0.3714388
EarlyStopping counter: 1 out of 5
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5919788
	speed: 0.0206s/iter; left time: 183.7633s
	iters: 200, epoch: 3 | loss: 0.4500725
	speed: 0.0172s/iter; left time: 151.6572s
	iters: 300, epoch: 3 | loss: 0.4499455
	speed: 0.0167s/iter; left time: 145.5656s
	iters: 400, epoch: 3 | loss: 0.6427209
	speed: 0.0176s/iter; left time: 151.4251s
	iters: 500, epoch: 3 | loss: 0.4227263
	speed: 0.0188s/iter; left time: 160.5358s
	iters: 600, epoch: 3 | loss: 0.5011479
	speed: 0.0213s/iter; left time: 179.7691s
	iters: 700, epoch: 3 | loss: 0.5057870
	speed: 0.0230s/iter; left time: 191.2303s
	iters: 800, epoch: 3 | loss: 0.4422853
	speed: 0.0241s/iter; left time: 198.5489s
	iters: 900, epoch: 3 | loss: 0.6535887
	speed: 0.0244s/iter; left time: 198.0843s
	iters: 1000, epoch: 3 | loss: 0.6158610
	speed: 0.0243s/iter; left time: 195.2342s
	iters: 1100, epoch: 3 | loss: 0.4250292
	speed: 0.0250s/iter; left time: 198.4771s
Epoch: 3 cost time: 28.40637993812561
Epoch: 3, Steps: 1128 | Train Loss: 0.5449664 Vali Loss: 0.6548709 Test Loss: 0.3795331
Validation loss decreased (0.656718 --> 0.654871).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5583913
	speed: 0.0355s/iter; left time: 276.8998s
	iters: 200, epoch: 4 | loss: 0.5339828
	speed: 0.0285s/iter; left time: 219.5369s
	iters: 300, epoch: 4 | loss: 0.4811893
	speed: 0.0289s/iter; left time: 219.2944s
	iters: 400, epoch: 4 | loss: 0.5765243
	speed: 0.0283s/iter; left time: 212.4075s
	iters: 500, epoch: 4 | loss: 0.5825015
	speed: 0.0274s/iter; left time: 202.4576s
	iters: 600, epoch: 4 | loss: 0.4474799
	speed: 0.0268s/iter; left time: 195.9102s
	iters: 700, epoch: 4 | loss: 0.4082507
	speed: 0.0266s/iter; left time: 191.7582s
	iters: 800, epoch: 4 | loss: 0.4708708
	speed: 0.0264s/iter; left time: 187.6665s
	iters: 900, epoch: 4 | loss: 0.8164556
	speed: 0.0263s/iter; left time: 183.7552s
	iters: 1000, epoch: 4 | loss: 0.5189615
	speed: 0.0261s/iter; left time: 179.9867s
	iters: 1100, epoch: 4 | loss: 0.4776302
	speed: 0.0259s/iter; left time: 176.2921s
Epoch: 4 cost time: 29.361250400543213
Epoch: 4, Steps: 1128 | Train Loss: 0.5292538 Vali Loss: 0.6641536 Test Loss: 0.3873690
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5307696
	speed: 0.0219s/iter; left time: 145.7390s
	iters: 200, epoch: 5 | loss: 0.4265907
	speed: 0.0219s/iter; left time: 143.5761s
	iters: 300, epoch: 5 | loss: 0.5102980
	speed: 0.0212s/iter; left time: 137.2574s
	iters: 400, epoch: 5 | loss: 0.4681994
	speed: 0.0216s/iter; left time: 137.4267s
	iters: 500, epoch: 5 | loss: 0.5020771
	speed: 0.0218s/iter; left time: 136.4200s
	iters: 600, epoch: 5 | loss: 0.4634241
	speed: 0.0219s/iter; left time: 135.0880s
	iters: 700, epoch: 5 | loss: 0.5065679
	speed: 0.0231s/iter; left time: 140.3524s
	iters: 800, epoch: 5 | loss: 0.8551197
	speed: 0.0233s/iter; left time: 139.2034s
	iters: 900, epoch: 5 | loss: 0.4178685
	speed: 0.0234s/iter; left time: 137.4656s
	iters: 1000, epoch: 5 | loss: 0.6875580
	speed: 0.0235s/iter; left time: 135.8535s
	iters: 1100, epoch: 5 | loss: 0.4790126
	speed: 0.0237s/iter; left time: 134.1314s
Epoch: 5 cost time: 26.823790073394775
Epoch: 5, Steps: 1128 | Train Loss: 0.5213225 Vali Loss: 0.6705909 Test Loss: 0.4013491
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4152834
	speed: 0.0224s/iter; left time: 123.8483s
	iters: 200, epoch: 6 | loss: 0.5212502
	speed: 0.0194s/iter; left time: 105.5319s
	iters: 300, epoch: 6 | loss: 0.4926414
	speed: 0.0185s/iter; left time: 98.8619s
	iters: 400, epoch: 6 | loss: 0.4424203
	speed: 0.0206s/iter; left time: 107.8410s
	iters: 500, epoch: 6 | loss: 0.5104513
	speed: 0.0194s/iter; left time: 99.6009s
	iters: 600, epoch: 6 | loss: 0.5227670
	speed: 0.0201s/iter; left time: 101.2906s
	iters: 700, epoch: 6 | loss: 0.5414596
	speed: 0.0196s/iter; left time: 96.6007s
	iters: 800, epoch: 6 | loss: 0.4530092
	speed: 0.0194s/iter; left time: 93.9821s
	iters: 900, epoch: 6 | loss: 0.4404369
	speed: 0.0211s/iter; left time: 99.8735s
	iters: 1000, epoch: 6 | loss: 0.5201666
	speed: 0.0217s/iter; left time: 100.6804s
	iters: 1100, epoch: 6 | loss: 0.5564505
	speed: 0.0220s/iter; left time: 99.9231s
Epoch: 6 cost time: 24.99229669570923
Epoch: 6, Steps: 1128 | Train Loss: 0.5173425 Vali Loss: 0.6803401 Test Loss: 0.4090506
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4301949
	speed: 0.0223s/iter; left time: 98.3531s
	iters: 200, epoch: 7 | loss: 0.5501986
	speed: 0.0207s/iter; left time: 89.1368s
	iters: 300, epoch: 7 | loss: 0.5521759
	speed: 0.0212s/iter; left time: 89.1691s
	iters: 400, epoch: 7 | loss: 0.5811062
	speed: 0.0213s/iter; left time: 87.8069s
	iters: 500, epoch: 7 | loss: 0.5098745
	speed: 0.0216s/iter; left time: 86.7078s
	iters: 600, epoch: 7 | loss: 0.4314218
	speed: 0.0214s/iter; left time: 83.7930s
	iters: 700, epoch: 7 | loss: 0.4387438
	speed: 0.0213s/iter; left time: 81.1545s
	iters: 800, epoch: 7 | loss: 0.3660853
	speed: 0.0212s/iter; left time: 78.6174s
	iters: 900, epoch: 7 | loss: 0.7646715
	speed: 0.0214s/iter; left time: 77.4677s
	iters: 1000, epoch: 7 | loss: 0.4489096
	speed: 0.0217s/iter; left time: 76.2353s
	iters: 1100, epoch: 7 | loss: 0.6083267
	speed: 0.0220s/iter; left time: 75.1555s
Epoch: 7 cost time: 25.062081336975098
Epoch: 7, Steps: 1128 | Train Loss: 0.5154840 Vali Loss: 0.6744292 Test Loss: 0.4048366
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.5373617
	speed: 0.0284s/iter; left time: 93.2954s
	iters: 200, epoch: 8 | loss: 0.5439259
	speed: 0.0253s/iter; left time: 80.6330s
	iters: 300, epoch: 8 | loss: 0.4126373
	speed: 0.0244s/iter; left time: 75.3692s
	iters: 400, epoch: 8 | loss: 0.5564585
	speed: 0.0236s/iter; left time: 70.4742s
	iters: 500, epoch: 8 | loss: 0.4789810
	speed: 0.0230s/iter; left time: 66.2295s
	iters: 600, epoch: 8 | loss: 0.4881551
	speed: 0.0219s/iter; left time: 61.0102s
	iters: 700, epoch: 8 | loss: 0.5923691
	speed: 0.0211s/iter; left time: 56.5391s
	iters: 800, epoch: 8 | loss: 0.5121389
	speed: 0.0207s/iter; left time: 53.6299s
	iters: 900, epoch: 8 | loss: 0.7419273
	speed: 0.0208s/iter; left time: 51.7633s
	iters: 1000, epoch: 8 | loss: 0.5125455
	speed: 0.0212s/iter; left time: 50.5171s
	iters: 1100, epoch: 8 | loss: 0.5507525
	speed: 0.0214s/iter; left time: 49.0030s
Epoch: 8 cost time: 24.39386510848999
Epoch: 8, Steps: 1128 | Train Loss: 0.5144639 Vali Loss: 0.6744285 Test Loss: 0.4060845
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.379533052444458, mae:0.3959351181983948
Use GPU: cuda:0
no_skip False
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456>>>>>>>>>>>>>>>>>>>>>>>>>>
data (52696, 21)
data (52696, 21)
data (52696, 21)
	iters: 100, epoch: 1 | loss: 0.6562575
	speed: 0.0462s/iter; left time: 516.5259s
	iters: 200, epoch: 1 | loss: 0.5549933
	speed: 0.0404s/iter; left time: 447.6463s
	iters: 300, epoch: 1 | loss: 0.6102371
	speed: 0.0344s/iter; left time: 377.3365s
	iters: 400, epoch: 1 | loss: 0.4652158
	speed: 0.0314s/iter; left time: 341.6083s
	iters: 500, epoch: 1 | loss: 0.8284974
	speed: 0.0283s/iter; left time: 304.7043s
	iters: 600, epoch: 1 | loss: 0.5482542
	speed: 0.0256s/iter; left time: 273.2909s
	iters: 700, epoch: 1 | loss: 0.5109439
	speed: 0.0236s/iter; left time: 250.2131s
	iters: 800, epoch: 1 | loss: 0.7854911
	speed: 0.0224s/iter; left time: 234.8801s
	iters: 900, epoch: 1 | loss: 0.5693781
	speed: 0.0215s/iter; left time: 222.7643s
	iters: 1000, epoch: 1 | loss: 0.8574212
	speed: 0.0209s/iter; left time: 215.1667s
	iters: 1100, epoch: 1 | loss: 0.5677929
	speed: 0.0211s/iter; left time: 214.5794s
Epoch: 1 cost time: 23.98797583580017
Epoch: 1, Steps: 1128 | Train Loss: 0.6231672 Vali Loss: 0.6396987 Test Loss: 0.3461137
Validation loss decreased (inf --> 0.639699).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5058238
	speed: 0.0281s/iter; left time: 282.5476s
	iters: 200, epoch: 2 | loss: 0.6458665
	speed: 0.0268s/iter; left time: 267.2032s
	iters: 300, epoch: 2 | loss: 0.4906094
	speed: 0.0264s/iter; left time: 260.5390s
	iters: 400, epoch: 2 | loss: 0.4847444
	speed: 0.0255s/iter; left time: 248.6727s
	iters: 500, epoch: 2 | loss: 0.5008821
	speed: 0.0249s/iter; left time: 240.5379s
	iters: 600, epoch: 2 | loss: 0.7302016
	speed: 0.0242s/iter; left time: 231.4539s
	iters: 700, epoch: 2 | loss: 0.7242149
	speed: 0.0231s/iter; left time: 218.4440s
	iters: 800, epoch: 2 | loss: 0.5105212
	speed: 0.0225s/iter; left time: 210.0749s
	iters: 900, epoch: 2 | loss: 0.4518537
	speed: 0.0221s/iter; left time: 204.6486s
	iters: 1000, epoch: 2 | loss: 0.4816359
	speed: 0.0219s/iter; left time: 200.7607s
	iters: 1100, epoch: 2 | loss: 0.5943154
	speed: 0.0219s/iter; left time: 198.5560s
Epoch: 2 cost time: 24.948274612426758
Epoch: 2, Steps: 1128 | Train Loss: 0.5735506 Vali Loss: 0.6466373 Test Loss: 0.3676105
EarlyStopping counter: 1 out of 5
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6872826
	speed: 0.0404s/iter; left time: 360.1296s
	iters: 200, epoch: 3 | loss: 0.5675292
	speed: 0.0397s/iter; left time: 350.6286s
	iters: 300, epoch: 3 | loss: 0.5780541
	speed: 0.0345s/iter; left time: 301.3556s
	iters: 400, epoch: 3 | loss: 0.7507633
	speed: 0.0321s/iter; left time: 276.9974s
	iters: 500, epoch: 3 | loss: 0.4326870
	speed: 0.0303s/iter; left time: 258.4674s
	iters: 600, epoch: 3 | loss: 0.5332248
	speed: 0.0287s/iter; left time: 242.1279s
	iters: 700, epoch: 3 | loss: 0.6271845
	speed: 0.0269s/iter; left time: 223.7429s
	iters: 800, epoch: 3 | loss: 0.4066604
	speed: 0.0259s/iter; left time: 212.6296s
	iters: 900, epoch: 3 | loss: 0.4841388
	speed: 0.0251s/iter; left time: 203.6004s
	iters: 1000, epoch: 3 | loss: 0.4892814
	speed: 0.0246s/iter; left time: 197.1910s
	iters: 1100, epoch: 3 | loss: 0.6113498
	speed: 0.0246s/iter; left time: 195.2907s
Epoch: 3 cost time: 28.19355845451355
Epoch: 3, Steps: 1128 | Train Loss: 0.5444312 Vali Loss: 0.6717115 Test Loss: 0.3879775
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4520817
	speed: 0.0438s/iter; left time: 341.2160s
	iters: 200, epoch: 4 | loss: 0.8140629
	speed: 0.0415s/iter; left time: 319.7291s
	iters: 300, epoch: 4 | loss: 0.5166284
	speed: 0.0354s/iter; left time: 268.6864s
	iters: 400, epoch: 4 | loss: 0.5054909
	speed: 0.0321s/iter; left time: 240.6208s
	iters: 500, epoch: 4 | loss: 0.5509462
	speed: 0.0286s/iter; left time: 211.6870s
	iters: 600, epoch: 4 | loss: 0.4510171
	speed: 0.0257s/iter; left time: 187.6394s
	iters: 700, epoch: 4 | loss: 0.4962120
	speed: 0.0243s/iter; left time: 174.5738s
	iters: 800, epoch: 4 | loss: 0.4568940
	speed: 0.0233s/iter; left time: 165.6397s
	iters: 900, epoch: 4 | loss: 0.6988035
	speed: 0.0226s/iter; left time: 158.2870s
	iters: 1000, epoch: 4 | loss: 0.5409966
	speed: 0.0220s/iter; left time: 151.5129s
	iters: 1100, epoch: 4 | loss: 0.4717838
	speed: 0.0217s/iter; left time: 147.5808s
Epoch: 4 cost time: 24.726359605789185
Epoch: 4, Steps: 1128 | Train Loss: 0.5291018 Vali Loss: 0.6638740 Test Loss: 0.3930680
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6845932
	speed: 0.0302s/iter; left time: 201.3437s
	iters: 200, epoch: 5 | loss: 0.5253864
	speed: 0.0277s/iter; left time: 181.6348s
	iters: 300, epoch: 5 | loss: 0.5035000
	speed: 0.0288s/iter; left time: 186.5474s
	iters: 400, epoch: 5 | loss: 0.4308459
	speed: 0.0292s/iter; left time: 186.1840s
	iters: 500, epoch: 5 | loss: 0.5146422
	speed: 0.0284s/iter; left time: 178.0875s
	iters: 600, epoch: 5 | loss: 0.4504609
	speed: 0.0271s/iter; left time: 167.4113s
	iters: 700, epoch: 5 | loss: 0.4700111
	speed: 0.0256s/iter; left time: 155.5208s
	iters: 800, epoch: 5 | loss: 0.5400249
	speed: 0.0251s/iter; left time: 149.7936s
	iters: 900, epoch: 5 | loss: 0.4630350
	speed: 0.0247s/iter; left time: 145.0230s
	iters: 1000, epoch: 5 | loss: 0.4379087
	speed: 0.0244s/iter; left time: 140.8744s
	iters: 1100, epoch: 5 | loss: 0.8055763
	speed: 0.0245s/iter; left time: 138.9822s
Epoch: 5 cost time: 27.80235266685486
Epoch: 5, Steps: 1128 | Train Loss: 0.5214491 Vali Loss: 0.6643092 Test Loss: 0.3915194
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6582092
	speed: 0.0265s/iter; left time: 147.0123s
	iters: 200, epoch: 6 | loss: 0.4342364
	speed: 0.0288s/iter; left time: 156.4855s
	iters: 300, epoch: 6 | loss: 0.5562785
	speed: 0.0314s/iter; left time: 167.5396s
	iters: 400, epoch: 6 | loss: 0.5495766
	speed: 0.0323s/iter; left time: 169.3375s
	iters: 500, epoch: 6 | loss: 0.4068291
	speed: 0.0311s/iter; left time: 159.6904s
	iters: 600, epoch: 6 | loss: 0.4678988
	speed: 0.0298s/iter; left time: 150.1022s
	iters: 700, epoch: 6 | loss: 0.4211046
	speed: 0.0289s/iter; left time: 142.9061s
	iters: 800, epoch: 6 | loss: 0.5682570
	speed: 0.0280s/iter; left time: 135.6415s
	iters: 900, epoch: 6 | loss: 0.4867927
	speed: 0.0271s/iter; left time: 128.5071s
	iters: 1000, epoch: 6 | loss: 0.5558140
	speed: 0.0263s/iter; left time: 122.1752s
	iters: 1100, epoch: 6 | loss: 0.5518703
	speed: 0.0258s/iter; left time: 117.3541s
Epoch: 6 cost time: 29.16484260559082
Epoch: 6, Steps: 1128 | Train Loss: 0.5177362 Vali Loss: 0.6640638 Test Loss: 0.3946667
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_noSkipFalse_FDCFalse_conv2d_456<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
mse:0.34611377120018005, mae:0.36865055561065674
