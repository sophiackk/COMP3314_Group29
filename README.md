## COMP3314_Group29
## The code of the paper "Reproducing 'A Closer Look at Transformers for Time Series Forecasting'"

The code was extended from the [time series models library](https://github.com/thuml/Time-Series-Library). All the transformers compared in the paper are using the implementation from this library except specific extensions described in the paper.

### Datasets
Please download the benchmark datasets according to the instructions in [time series models library](https://github.com/thuml/Time-Series-Library).

Benchmark CSVs (`ETTh1.csv`, `weather.csv`) and our synthetic CSVs are already included under `./data/`.

If you need to regenerate the synthetic data, use `data_provider/sim_dependent_data.py` and `sim_independent_data.py`.

The simulated datasets can be generated by the following two files in data_provider folder: sim_dependent_data.py and sim_independent_data.py.


### Usage
requirements.txt includes packages we installed in the virtual environment for running all experiments.

est_mi.py is for estimating Mutual information Scores of trained models. Results are stored in ./eval_results/mi_results.txt

To run MI analysis with Nvidia GPU, install CUDA support. Ensure torch.cuda.is_available() returns True.

Example:
```bash 
python est_mi.py \
  --task_name long_term_forecast \
  --is_training 0 \
  --model PatchTST \
  --model_id p2_PatchTST_ETTh1_96 \
  --data ETTh1 \
  --root_path ./data/ETT/ \
  --data_path ETTh1.csv \
  --features M \
  --seq_len 336 \
  --label_len 48 \
  --pred_len 96 \
  --enc_in 7 \
  --dec_in 7 \
  --c_out 7 \
  --d_model 512 \
  --n_heads 8 \
  --e_layers 2 \
  --d_layers 1 \
  --d_ff 2048 \
  --batch_size 2 \
  --use_gpu True \
  --gpu 0 \
  --checkpoints ./checkpoints
```

To evaluate mi score on models trained on synthetic dataset, add --extra_tag synthetic, which triggers the custom fallback in est_mi.py. Checkpoint directories must share the same suffix (e.g., PatchTST_gamma0.5_alpha0.2_pred192).

Example:
```bash
python est_mi.py \
  --task_name long_term_forecast \
  --is_training 0 \
  --model PatchTST \
  --model_id PatchTST_gamma0.5_alpha0.2_pred192 \
  --data custom \
  --root_path ./data/synthetic/ \
  --data_path gamma0.5_alpha0.2.csv \
  --features MS \
  --seq_len 336 \
  --label_len 48 \
  --pred_len 192 \
  --enc_in 2 \
  --dec_in 2 \
  --c_out 2 \
  --d_model 128 \
  --n_heads 8 \
  --e_layers 3 \
  --d_layers 1 \
  --d_ff 256 \
  --expand 2 \
  --d_conv 4 \
  --factor 1 \
  --embed timeF \
  --des synthetic_experiment_0 \
  --seed 2021 \
  --batch_size 8 \
  --use_gpu True \
  --gpu 0 \
  --extra_tag synthetic \
  --checkpoints ./checkpoints
```
